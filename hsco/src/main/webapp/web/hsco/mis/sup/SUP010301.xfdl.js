(function(){return function(){if(!this._is_form){return;}this.on_create=function(){var _a=null;if(Form==this.constructor){this.set_name("SUP010301");this.set_classname("SUP010301");this.set_titletext("개선요구사항등록");this._setFormPosition(0,0,1059,735);}_a=new Dataset("ds_cond",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"STDR_YEAR\" type=\"STRING\" size=\"256\"/><Column id=\"IX_CODE\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_validation",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"compId\" type=\"STRING\" size=\"256\"/><Column id=\"colId\" type=\"STRING\" size=\"256\"/><Column id=\"PK\" type=\"STRING\" size=\"256\"/><Column id=\"notNull\" type=\"STRING\" size=\"256\"/><Column id=\"type\" type=\"STRING\" size=\"256\"/><Column id=\"nlength\" type=\"STRING\" size=\"256\"/><Column id=\"from\" type=\"STRING\" size=\"256\"/><Column id=\"to\" type=\"STRING\" size=\"256\"/><Column id=\"lengthChkGb\" type=\"STRING\" size=\"256\"/><Column id=\"msgId\" type=\"STRING\" size=\"256\"/><Column id=\"expr\" type=\"STRING\" size=\"256\"/><Column id=\"func\" type=\"STRING\" size=\"256\"/></ColumnInfo><Rows><Row><Col id=\"compId\">ds_divDept</Col><Col id=\"notNull\">Y</Col><Col id=\"msgId\">부서</Col><Col id=\"colId\">DEPT_CODE</Col><Col id=\"PK\">Y</Col></Row><Row><Col id=\"compId\">ds_divDept</Col><Col id=\"colId\">SN</Col><Col id=\"PK\">Y</Col><Col id=\"notNull\">Y</Col><Col id=\"type\"/><Col id=\"nlength\"/><Col id=\"from\"/><Col id=\"to\"/><Col id=\"lengthChkGb\"/><Col id=\"msgId\">번호</Col><Col id=\"expr\"/><Col id=\"func\"/></Row><Row><Col id=\"compId\">ds_mngmtEvlImprvmTask</Col><Col id=\"colId\">SN</Col><Col id=\"PK\">Y</Col><Col id=\"notNull\">Y</Col><Col id=\"msgId\">번호</Col></Row><Row><Col id=\"compId\">ds_mngmtEvlImprvmTask</Col><Col id=\"colId\">LGSTR_MATTER</Col><Col id=\"PK\">[Undefined]</Col><Col id=\"notNull\">Y</Col><Col id=\"type\">[Undefined]</Col><Col id=\"nlength\">[Undefined]</Col><Col id=\"from\">[Undefined]</Col><Col id=\"to\">[Undefined]</Col><Col id=\"lengthChkGb\">[Undefined]</Col><Col id=\"msgId\">지적사항</Col><Col id=\"expr\">[Undefined]</Col><Col id=\"func\">[Undefined]</Col></Row><Row><Col id=\"compId\">ds_mngmtEvlImprvmTask</Col><Col id=\"colId\">DEPT_NM_LIST</Col><Col id=\"notNull\">Y</Col><Col id=\"msgId\">관리부서</Col></Row><Row><Col id=\"compId\">ds_cond</Col><Col id=\"colId\">STDR_YEAR</Col><Col id=\"notNull\">Y</Col><Col id=\"msgId\">검색 기준년도</Col></Row></Rows>");this.addChild(_a.name,_a);_a=new Dataset("ds_mngmtEvlStdrMaster",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"STDR_YEAR\" type=\"STRING\" size=\"256\"/><Column id=\"IX_CODE\" type=\"STRING\" size=\"256\"/><Column id=\"IX_NM\" type=\"STRING\" size=\"256\"/><Column id=\"SORT_ORDR\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_mngmtEvlImprvmTask",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"STDR_YEAR\" type=\"STRING\" size=\"256\"/><Column id=\"IX_CODE\" type=\"STRING\" size=\"256\"/><Column id=\"SN\" type=\"STRING\" size=\"256\"/><Column id=\"LGSTR_MATTER\" type=\"STRING\" size=\"256\"/><Column id=\"REGISTER_ID\" type=\"STRING\" size=\"256\"/><Column id=\"REGIST_DT\" type=\"STRING\" size=\"256\"/><Column id=\"UPDUSR_ID\" type=\"STRING\" size=\"256\"/><Column id=\"DEPT_CODE\" type=\"STRING\" size=\"256\"/><Column id=\"DEPT_NM\" type=\"STRING\" size=\"256\"/><Column id=\"DEPT_NM_LIST\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_taskTOma",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"STDR_YEAR\" type=\"STRING\" size=\"256\"/><Column id=\"IX_CODE\" type=\"STRING\" size=\"256\"/><Column id=\"SN\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_divDept",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"STDR_YEAR\" type=\"STRING\" size=\"256\"/><Column id=\"IX_CODE\" type=\"STRING\" size=\"256\"/><Column id=\"SN\" type=\"STRING\" size=\"256\"/><Column id=\"DEPT_CODE\" type=\"STRING\" size=\"256\"/><Column id=\"FILE_SN\" type=\"STRING\" size=\"256\"/><Column id=\"FLFL_AT\" type=\"STRING\" size=\"256\"/><Column id=\"REGISTER_ID\" type=\"STRING\" size=\"256\"/><Column id=\"REGIST_DT\" type=\"STRING\" size=\"256\"/><Column id=\"UPDUSR_ID\" type=\"STRING\" size=\"256\"/><Column id=\"UPDT_DT\" type=\"STRING\" size=\"256\"/><Column id=\"DEPT_NM\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_rowposition",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"SET_ROW\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_snCheck",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"STDR_YEAR\" type=\"STRING\" size=\"256\"/><Column id=\"IX_CODE\" type=\"STRING\" size=\"256\"/><Column id=\"SN\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Grid("grd_mngmtEvlImprvmTask","absolute","177","61",null,null,"28","0",this);_a.set_taborder("6");_a.set_binddataset("ds_mngmtEvlImprvmTask");_a.set_cellsizingtype("col");_a.set_autoenter("select");_a.set_autofittype("col");_a.set_autosizingtype("row");_a.set_extendsizetype("row");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"40\"/><Column size=\"500\"/><Column size=\"200\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"24\"/></Rows><Band id=\"head\"><Cell cssclass=\"Cellgrd_WF_HeadEssential\" text=\"순번\"/><Cell col=\"1\" cssclass=\"Cellgrd_WF_HeadEssential\" text=\"지적사항\"/><Cell col=\"2\" cssclass=\"Cellgrd_WF_HeadEssential\" text=\"관리부서\"/></Band><Band id=\"body\"><Cell edittype=\"expr:dataset.getRowType(currow)==Dataset.ROWTYPE_INSERT ? 'masknumber':'none'\" style=\"align: ;\" text=\"bind:SN\"/><Cell col=\"1\" edittype=\"text\" style=\"align:left middle;\" text=\"bind:LGSTR_MATTER\" wordwrap=\"char\" editlimit=\"2000\" editlengthunit=\"utf8\" autosizerow=\"limitmin\" autosizecol=\"default\"/><Cell col=\"2\" celltype=\"none\" edittype=\"expand\" style=\"align:left middle;\" text=\"bind:DEPT_NM_LIST\" wordwrap=\"char\" expandshow=\"show\" expandsize=\"20\" autosizerow=\"limitmin\" autosizecol=\"default\"/></Band></Format></Formats>");this.addChild(_a.name,_a);_a=new Div("div_search","absolute","0","0",null,"33","28",null,this);_a.set_taborder("0");_a.set_cssclass("div_WFSA_Box");this.addChild(_a.name,_a);_a=new Spin("div_YEAR","absolute","79","5","76","21",null,null,this.div_search);_a.set_taborder("0");_a.set_value("0");_a.set_cssclass("spn_WF_Essential");this.div_search.addChild(_a.name,_a);_a=new Static("Static05","absolute","0","5","15",null,null,"5",this.div_search);_a.set_taborder("1");_a.set_text("15");_a.set_visible("false");_a.style.set_background("#00ffff66");this.div_search.addChild(_a.name,_a);_a=new Static("Static36","absolute","102","0","38","5",null,null,this.div_search);_a.set_taborder("2");_a.set_text("5");_a.set_visible("false");_a.style.set_background("#fa794f66");_a.style.set_align("center middle");this.div_search.addChild(_a.name,_a);_a=new Static("Static37","absolute","102",null,"38","5",null,"0",this.div_search);_a.set_taborder("3");_a.set_text("5");_a.set_visible("false");_a.style.set_background("#fa794f66");_a.style.set_align("center middle");this.div_search.addChild(_a.name,_a);_a=new Static("sta_CNTRCT_NO00","absolute","15","5","64","21",null,null,this.div_search);_a.set_taborder("4");_a.set_text("기준년도");_a.set_wordwrap("char");_a.set_cssclass("sta_WFSA_Label");this.div_search.addChild(_a.name,_a);_a=new Static("Static01","absolute","139","5","15",null,null,"31",this.div_search);_a.set_taborder("5");_a.set_text("15");_a.set_visible("false");_a.style.set_background("#00ffff66");this.div_search.addChild(_a.name,_a);_a=new Static("Static04","absolute",null,"0","15",null,"13","0",this);_a.set_taborder("59");_a.set_text("15");_a.set_visible("false");_a.style.set_background("#1b3cd23c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Static("Static05","absolute",null,"0","13",null,"0","0",this);_a.set_taborder("60");_a.set_text("스\r\n크\r\n롤\r\n13");_a.set_visible("false");_a.style.set_background("#d07b173c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Static("Static01","absolute","0","33",null,"10","28",null,this);_a.set_taborder("61");_a.set_text("10");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Static("sta_title","absolute","0","41","177","19",null,null,this);_a.set_taborder("1");_a.set_text("평가지표");_a.set_cssclass("sta_WF_Title02");this.addChild(_a.name,_a);_a=new Static("Static00","absolute","0","56",null,"5","28",null,this);_a.set_taborder("63");_a.set_text("5");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Grid("grd_mngmtEvlStdrMaster","absolute","0","61","167",null,null,"0",this);_a.set_taborder("5");_a.set_binddataset("ds_mngmtEvlStdrMaster");_a.set_autoenter("select");_a.set_cellsizingtype("col");_a.set_autofittype("col");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"217\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"24\"/></Rows><Band id=\"head\"><Cell text=\"대분류 지표\"/></Band><Band id=\"body\"><Cell style=\"align:left middle;\" text=\"bind:IX_NM\"/></Band></Format></Formats>");this.addChild(_a.name,_a);_a=new Static("Static02","absolute","167","0","10",null,null,"10",this);_a.set_taborder("79");_a.set_text("10");_a.set_visible("false");_a.style.set_background("#00ffff66");this.addChild(_a.name,_a);_a=new Div("div_Dept","absolute",null,"176","184","184","60",null,this);_a.set_taborder("7");_a.set_text("Div00");_a.set_visible("false");this.addChild(_a.name,_a);_a=new Button("btn_addDept","absolute",null,"0","64","19","108",null,this.div_Dept);_a.set_taborder("0");_a.set_text("행추가");_a.set_cssclass("btn_WF_Gridadd");this.div_Dept.addChild(_a.name,_a);_a=new Button("btn_delDept","absolute",null,"0","64","19","41",null,this.div_Dept);_a.set_taborder("1");_a.set_text("행삭제");_a.set_cssclass("btn_WF_Griddel");this.div_Dept.addChild(_a.name,_a);_a=new Grid("GridDept","absolute","0","19",null,null,"0","0",this.div_Dept);_a.set_taborder("3");_a.set_autofittype("col");_a.set_binddataset("ds_divDept");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"80\"/><Column size=\"150\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"24\"/></Rows><Band id=\"head\"><Cell text=\"부서코드\"/><Cell col=\"1\" text=\"관리부서\"/></Band><Band id=\"body\"><Cell text=\"bind:DEPT_CODE\"/><Cell col=\"1\" text=\"bind:DEPT_NM\"/></Band></Format></Formats>");this.div_Dept.addChild(_a.name,_a);_a=new Button("btn_divClose","absolute","146","0","38","19",null,null,this.div_Dept);_a.set_taborder("2");_a.set_text("닫기");_a.set_cssclass("btn_WF_Grid");_a.style.set_font("8 Dotum");this.div_Dept.addChild(_a.name,_a);_a=new Static("sta_title00","absolute","177","41","200","19",null,null,this);_a.set_taborder("80");_a.set_text("지표별 개선요구사항 현황");_a.set_cssclass("sta_WF_Title02");this.addChild(_a.name,_a);_a=new Button("btn_COPY","absolute",null,"39","79","19","28",null,this);_a.set_taborder("81");_a.set_text("전년도복사");_a.set_cssclass("btn_WF_Process");this.addChild(_a.name,_a);_a=new Layout("default","",0,33,this.div_search,function(_b){_b.set_taborder("0");_b.set_cssclass("div_WFSA_Box");});this.div_search.addLayout(_a.name,_a);_a=new Layout("default","",184,184,this.div_Dept,function(_b){_b.set_taborder("7");_b.set_text("Div00");_b.set_visible("false");});this.div_Dept.addLayout(_a.name,_a);_a=new Layout("default","",1059,735,this,function(_b){_b.set_classname("SUP010301");_b.set_titletext("개선요구사항등록");});this.addLayout(_a.name,_a);_a=new BindItem("item10","div_search00.cmb_CNTRCT_MTH_CODE","value","ds_cditPrsszr","CNTRCT_MTH_CODE");this.addChild(_a.name,_a);_a.bind();_a=new BindItem("item1","div_search.div_YEAR","value","ds_cond","STDR_YEAR");this.addChild(_a.name,_a);_a.bind();_a=null;};this.addIncludeScript("SUP010301.xfdl","lib::comInclude.xjs");this.addIncludeScript("SUP010301.xfdl","mis_lib::misUtil.xjs");this.registerScript("SUP010301.xfdl",function(){this.saveRow= -1;this.checkDs=[this.ds_mngmtEvlImprvmTask,this.ds_divDept];this.SUP010301_oninit=function(_a,_b){this.fn_init_form();this.fn_init_dataset();};this.SUP010301_onload=function(_a,_b){this.ds_cond.clearData();var _c=this.ds_cond.addRow();this.ds_cond.setColumn(0,"STDR_YEAR",this.comUtils.getClientDate("YYYY"));this.fn_search();};this.fn_init_form=function(){this.gfn_initForm(this);this.fn_misFormInit(this);};this.fn_init_dataset=function(){this.gfn_initCondDs(this,this.div_search);};this.fn_search=function(){this.ds_mngmtEvlImprvmTask.clearData();this.ds_mngmtEvlStdrMaster.clearData();this.fn_transaction("SRCH");};this.fn_save=function(){if(!this.comUtils.isDatasetUpdated(this.ds_mngmtEvlImprvmTask)&&!this.comUtils.isDatasetUpdated(this.ds_divDept)){this.gfn_message("comm.데이터.변경.없음");return false;}if(!this.gfn_checkValidation_NoUpdChk(this.ds_mngmtEvlImprvmTask,this.ds_validation)){return;}if(!this.gfn_checkValidation_NoUpdChk(this.ds_divDept,this.ds_validation)){return;}this.saveRow=this.ds_mngmtEvlStdrMaster.rowposition;this.fn_transaction("SAVE");};this.fn_transaction=function(_a){switch(_a){case "SRCH":var _b="/hsco/mis/sup/SUP010301/mngmtEvlStdrMaster.do";var _c="input1=ds_cond";var _d="ds_mngmtEvlStdrMaster=output1";break;case "TaskSRCH":this.ds_cond.setColumn(0,"IX_CODE",this.ds_mngmtEvlStdrMaster.getColumn(this.ds_mngmtEvlStdrMaster.rowposition,"IX_CODE"));var _b="/hsco/mis/sup/SUP010301/mngmtEvlImprvmTaskList.do";var _c="input1=ds_cond";var _d="ds_mngmtEvlImprvmTask=output1 ds_divDept=output2";break;case "snCHECK":var _b="/hsco/mis/sup/SUP010301/snCheck.do";var _c="input1=ds_cond";var _d="ds_snCheck=output1";break;case "SAVE":var _b="hsco/mis/sup/SUP010301/mngmtEvlImprvmTaskCUD.do";var _c="input1=ds_mngmtEvlImprvmTask:U input2=ds_divDept:U";var _d="";break;case "mngmtEvlImprvmTaskCOPY":var _b="hsco/mis/sup/SUP010301/mngmtEvlImprvmTaskCOPY.do";var _c="input1=ds_cond";var _d="";break;}Ex.core.tran(this,_a,_b,_c,_d);};this.fn_callBack=function(_a,_b,_c){if(_b!=0){switch(_a){case "SRCH":break;case "TaskSRCH":break;case "SAVE":break;case "snCHECK":break;case "mngmtEvlImprvmTaskCOPY":this.fn_search();break;default:break;}}else{switch(_a){case "SRCH":if(this.saveRow> -1){this.ds_mngmtEvlStdrMaster.set_rowposition(this.saveRow);this.saveRow= -1;}this.fn_transaction("TaskSRCH");break;case "TaskSRCH":this.fn_transaction("snCHECK");this.div_Dept.set_visible(false);this.ds_mngmtEvlImprvmTask.applyChange();this.ds_divDept.applyChange();break;case "SAVE":this.gfn_message("success.처리.성공");this.fn_transaction("TaskSRCH");break;case "snCHECK":break;default:break;}}this.gfn_callback_message(_a,_b,_c);};this.fn_popupCallBack=function(_a,_b){var _c=this.ds_mngmtEvlImprvmTask.rowposition;var _d=this.ds_mngmtEvlImprvmTask.getColumn(_c,"STDR_YEAR");var _e=this.ds_mngmtEvlImprvmTask.getColumn(_c,"IX_CODE");var _f=this.ds_mngmtEvlImprvmTask.getColumn(_c,"SN");var _g=new Dataset();_g.loadXML(_b);if(_g){if(_g.getRowCount()>0){this.ds_divDept.deleteAll();for(var _k=0;_k<_g.getRowCount();_k++ ){var _h=_g.getColumn(_k,"DEPT_CODE");var _i=_g.getColumn(_k,"DEPT_NM");var _j=this.ds_divDept.addRow();this.ds_divDept.setColumn(_k,"STDR_YEAR",_d);this.ds_divDept.setColumn(_k,"IX_CODE",_e);this.ds_divDept.setColumn(_k,"SN",_f);this.ds_divDept.setColumn(_k,"DEPT_CODE",_h);this.ds_divDept.setColumn(_k,"DEPT_NM",_i);}this.fn_arrDep(this.ds_mngmtEvlImprvmTask.rowposition);}}};this.fn_insert=function(_a,_b){this.div_Dept.set_visible(false);this.ds_mngmtEvlImprvmTask.addRow();var _c=this.ds_mngmtEvlImprvmTask.rowcount-1;this.ds_mngmtEvlImprvmTask.setColumn(_c,"STDR_YEAR",this.ds_cond.getColumn(0,"STDR_YEAR"));this.ds_mngmtEvlImprvmTask.setColumn(_c,"IX_CODE",this.ds_cond.getColumn(0,"IX_CODE"));};this.fn_delete=function(_a,_b){this.div_Dept.set_visible(false);if(this.gfn_message("confirm.삭제여부")){this.ds_mngmtEvlImprvmTask.deleteRow(this.ds_mngmtEvlImprvmTask.rowposition);this.ds_divDept.deleteAll();}};this.fn_cancel=function(_a,_b){this.div_Dept.set_visible(false);if(this.gfn_message("confirm.취소여부")){this.ds_mngmtEvlImprvmTask.reset();this.ds_mngmtEvlImprvmTask.applyChange();}};this.grd_mngmtEvlImprvmTask_onexpandup=function(_a,_b){var _c=this.ds_mngmtEvlImprvmTask.rowposition;if(this.ds_mngmtEvlImprvmTask.getColumn(_c,"SN")){var _d=new Dataset();_d.copyData(this.ds_divDept,true);var _e={arg_0:this,inpDs:_d.saveXML(),inpDsColCd:"DEPT_CODE_MULTI"};this.gfn_popup("deptPop",400,400,"부서선택",_e,"com::deptCode_P01.xfdl","fn_popupCallBack",true);}else{this.gfn_message("comm.항목.입력.을","순번");}};this.div_Dept_Button_DeptSave_onclick=function(_a,_b){this.fn_transaction("DeptSAVE");};this.fn_arrDep=function(_a){var _b=new Array();for(i=0;i<this.ds_divDept.rowcount;i++ ){_b.push(this.ds_divDept.getColumn(i,"DEPT_NM"));}this.ds_mngmtEvlImprvmTask.setColumn(_a,"DEPT_NM_LIST",_b);this.ds_mngmtEvlImprvmTask.setColumn(_a,"DEPT_NM",_b.join(", "));};this.ds_mngmtEvlImprvmTask_cancolumnchange=function(_a,_b){if(_b.columnid=="SN"){if(this.ds_mngmtEvlImprvmTask.findRow("SN",_b.newvalue)!= -1){this.gfn_message("info.중복.재입력.요청","순번");return false;}}};this.deptCheck=function(_a,_b){var _c=this.ds_divDept.rowposition;if(this.ds_divDept.findRowExpr("SN=='"+_a+"'&& DEPT_CODE=='"+_b+"'")> -1){this.gfn_message("info.항목.중복.재입력.요청","부서");return false;}else{if(_b=='000000'){for(var _d=0;_d<this.ds_divDept.rowcount;_d++ ){if(this.ds_divDept.getColumn(_d,"SN")==_a){this.ds_divDept.deleteRow(_d);_d-- ;}}}return true;}};this.ds_mngmtEvlStdrMaster_canrowposchange=function(_a,_b){if(Ex.util.isUpdated(this.ds_mngmtEvlImprvmTask)||Ex.util.isUpdated(this.ds_divDept)){if(this.gfn_message("confirm.변경.취소.여부")){return true;}else{return false;}}};this.ds_mngmtEvlStdrMaster_onrowposchanged=function(_a,_b){this.fn_transaction("TaskSRCH");};this.ds_mngmtEvlImprvmTask_onrowposchanged=function(_a,_b){this.ds_divDept.filter("SN == '"+this.ds_mngmtEvlImprvmTask.getColumn(this.ds_mngmtEvlImprvmTask.rowposition,"SN")+"'");};this.btn_COPY_onclick=function(_a,_b){var _c=this.ds_mngmtEvlImprvmTask.rowcount;var _d=this.ds_cond.getColumn(this.ds_cond.rowposition,"STDR_YEAR");if(this.gfn_message("confirm.삭제.진행",_d+"년도 조회된 자료를 삭제한 후, "+(_d-1)+"년도의 정보로 덮어씁니다.")){this.fn_transaction("mngmtEvlImprvmTaskCOPY");return false;}};this.div_search_div_YEAR_onchanged=function(_a,_b){this.ds_cond.clearData();var _c=this.ds_cond.addRow();this.ds_cond.setColumn(0,"STDR_YEAR",_b.posttext);this.fn_search();};});this.on_initEvent=function(){this.ds_mngmtEvlStdrMaster.addEventHandler("oncolumnchanged",this.ds_mngmtEvlStdrMaster_oncolumnchanged,this);this.ds_mngmtEvlStdrMaster.addEventHandler("onrowposchanged",this.ds_mngmtEvlStdrMaster_onrowposchanged,this);this.ds_mngmtEvlStdrMaster.addEventHandler("canrowposchange",this.ds_mngmtEvlStdrMaster_canrowposchange,this);this.ds_mngmtEvlImprvmTask.addEventHandler("cancolumnchange",this.ds_mngmtEvlImprvmTask_cancolumnchange,this);this.ds_mngmtEvlImprvmTask.addEventHandler("onrowposchanged",this.ds_mngmtEvlImprvmTask_onrowposchanged,this);this.ds_divDept.addEventHandler("cancolumnchange",this.ds_divDept_cancolumnchange,this);this.ds_divDept.addEventHandler("oncolumnchanged",this.ds_divDept_oncolumnchanged,this);this.addEventHandler("onload",this.SUP010301_onload,this);this.addEventHandler("oninit",this.SUP010301_oninit,this);this.grd_mngmtEvlImprvmTask.addEventHandler("onexpandup",this.grd_mngmtEvlImprvmTask_onexpandup,this);this.div_search.div_YEAR.addEventHandler("ontextchanged",this.div_search_div_YEAR_onchanged,this);this.grd_mngmtEvlStdrMaster.addEventHandler("oncellclick",this.grd_mngmtEvlStdrMaster_oncellclick,this);this.div_Dept.btn_addDept.addEventHandler("onclick",this.div_Dept_btn_addDept_onclick,this);this.div_Dept.btn_delDept.addEventHandler("onclick",this.div_Dept_btn_delDept_onclick,this);this.div_Dept.btn_divClose.addEventHandler("onclick",this.div_Dept_btn_divClose_onclick,this);this.btn_COPY.addEventHandler("onclick",this.btn_COPY_onclick,this);};this.loadIncludeScript("SUP010301.xfdl");};})();