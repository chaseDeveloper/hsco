(function(){return function(){if(!this._is_form){return;}this.on_create=function(){var _a=null;if(Form==this.constructor){this.set_name("ACC030105_P01");this.set_classname("UI_ACC030105_P01");this.set_titletext("국세청자료 업로드");this.set_scrollbars("none");this._setFormPosition(0,0,920,418);}_a=new Dataset("DS_IMPORT",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo/>");this.addChild(_a.name,_a);_a=new Dataset("ds_cond",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"PUCHAS_SELNG_SE\" type=\"STRING\" size=\"256\"/><Column id=\"TAXBIL_CL\" type=\"STRING\" size=\"256\"/><Column id=\"PBLICTE_FROM_DE\" type=\"STRING\" size=\"256\"/><Column id=\"PBLICTE_TO_DE\" type=\"STRING\" size=\"256\"/><Column id=\"SUPLER_BIZRNO\" type=\"STRING\" size=\"256\"/><Column id=\"SUPLER_MTLTY\" type=\"STRING\" size=\"256\"/><Column id=\"STTEMNT_YEAR\" type=\"STRING\" size=\"256\"/><Column id=\"STTEMNT_HRSMN\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_validation",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"compId\" type=\"STRING\" size=\"256\"/><Column id=\"colId\" type=\"STRING\" size=\"256\"/><Column id=\"PK\" type=\"STRING\" size=\"256\"/><Column id=\"notNull\" type=\"STRING\" size=\"256\"/><Column id=\"type\" type=\"STRING\" size=\"256\"/><Column id=\"nlength\" type=\"STRING\" size=\"256\"/><Column id=\"from\" type=\"STRING\" size=\"256\"/><Column id=\"to\" type=\"STRING\" size=\"256\"/><Column id=\"lengthChkGb\" type=\"STRING\" size=\"256\"/><Column id=\"msgId\" type=\"STRING\" size=\"256\"/><Column id=\"expr\" type=\"STRING\" size=\"256\"/><Column id=\"func\" type=\"STRING\" size=\"256\"/></ColumnInfo><Rows><Row><Col id=\"compId\">ds_cond</Col><Col id=\"colId\">STTEMNT_YEAR</Col><Col id=\"from\"/><Col id=\"to\"/><Col id=\"msgId\">신고년도</Col><Col id=\"notNull\">Y</Col></Row><Row><Col id=\"compId\">ds_cond</Col><Col id=\"colId\">STTEMNT_HRSMN</Col><Col id=\"from\"/><Col id=\"to\"/><Col id=\"msgId\">신고기수</Col><Col id=\"notNull\">Y</Col></Row><Row><Col id=\"compId\">ds_cond</Col><Col id=\"colId\">PUCHAS_SELNG_SE</Col><Col id=\"notNull\">Y</Col><Col id=\"msgId\">매입구분</Col></Row><Row><Col id=\"compId\">ds_cond</Col><Col id=\"colId\">TAXBIL_CL</Col><Col id=\"notNull\">Y</Col><Col id=\"msgId\">계산서분류</Col></Row></Rows>");this.addChild(_a.name,_a);_a=new Static("sta_title01","absolute","15","18","132","19",null,null,this);_a.set_taborder("5");_a.set_text("국세청자료 업로드");_a.set_cssclass("sta_WF_Title01");_a.style.set_align("left middle");this.addChild(_a.name,_a);_a=new Static("Static51","absolute","0","40",null,"5","0",null,this);_a.set_taborder("6");_a.set_text("5");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Static("Static06","absolute","0","0",null,"15","0",null,this);_a.set_taborder("7");_a.set_text("15");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Static("Static05","absolute","0","0","15",null,null,"0",this);_a.set_taborder("8");_a.set_text("15");_a.set_visible("false");_a.style.set_background("#1b3cd23c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Static("Static00","absolute",null,"0","15",null,"0","0",this);_a.set_taborder("9");_a.set_text("15");_a.set_visible("false");_a.style.set_background("#1b3cd23c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Static("Static03","absolute","0",null,null,"15","0","0",this);_a.set_taborder("10");_a.set_text("15");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Button("Button23","absolute",null,"15","50","25","68",null,this);_a.set_taborder("1");_a.set_text("저장");_a.set_cssclass("btn_WF_CRUD");this.addChild(_a.name,_a);_a=new Button("Button02","absolute",null,"15","50","25","15",null,this);_a.set_taborder("2");_a.set_text("종료");_a.set_cssclass("btn_WF_CRUD");this.addChild(_a.name,_a);_a=new Button("btn_excelUpload","absolute","714","15","85","25",null,null,this);_a.set_taborder("0");_a.set_text("엑셀 업로드");_a.set_cssclass("btn_WF_CRUD");this.addChild(_a.name,_a);_a=new Grid("grd_EXCEL_01","absolute","15","88",null,null,"15","15",this);_a.set_taborder("4");_a.set_binddataset("DS_IMPORT");_a._setContents("<Formats><Format id=\"default\"></Format></Formats>");this.addChild(_a.name,_a);_a=new Div("div_search","absolute","15","45",null,"33","15",null,this);_a.set_taborder("3");_a.set_cssclass("div_WFSA_Box");this.addChild(_a.name,_a);_a=new Static("sta_EMPL_SE01","absolute","359","5","66","21",null,null,this.div_search);_a.set_taborder("2");_a.set_text("매입구분");_a.set_cssclass("sta_WFSA_Label");this.div_search.addChild(_a.name,_a);_a=new Combo("Combo00","absolute","430","5","96","21",null,null,this.div_search);this.div_search.addChild(_a.name,_a);var _b=new Dataset("Combo00_innerdataset",this.div_search.Combo00);_b._setContents("<ColumnInfo><Column id=\"codecolumn\" size=\"256\"/><Column id=\"datacolumn\" size=\"256\"/></ColumnInfo><Rows><Row><Col id=\"codecolumn\"/><Col id=\"datacolumn\">선택</Col></Row><Row><Col id=\"codecolumn\">1</Col><Col id=\"datacolumn\">매출</Col></Row><Row><Col id=\"codecolumn\">2</Col><Col id=\"datacolumn\">매입</Col></Row></Rows>");_a.set_innerdataset(_b);_a.set_taborder("0");_a.set_codecolumn("codecolumn");_a.set_datacolumn("datacolumn");_a.set_displayrowcount("20");_a.style.set_align("center middle");_a.set_index("-1");_a=new Static("sta_EMPL_SE00","absolute","541","5","82","21",null,null,this.div_search);_a.set_taborder("3");_a.set_text("계산서 분류");_a.set_cssclass("sta_WFSA_Label");this.div_search.addChild(_a.name,_a);_a=new Combo("Combo02","absolute","628","5","133","21",null,null,this.div_search);this.div_search.addChild(_a.name,_a);var _c=new Dataset("Combo02_innerdataset",this.div_search.Combo02);_c._setContents("<ColumnInfo><Column id=\"codecolumn\" size=\"256\"/><Column id=\"datacolumn\" size=\"256\"/></ColumnInfo><Rows><Row><Col id=\"codecolumn\"/><Col id=\"datacolumn\">선택</Col></Row><Row><Col id=\"codecolumn\">1</Col><Col id=\"datacolumn\">전자세금계산서</Col></Row><Row><Col id=\"codecolumn\">2</Col><Col id=\"datacolumn\">전자계산서</Col></Row></Rows>");_a.set_innerdataset(_c);_a.set_taborder("1");_a.set_codecolumn("codecolumn");_a.set_datacolumn("datacolumn");_a.set_displayrowcount("20");_a.style.set_align("center middle");_a.set_index("-1");_a=new Static("sta_EMPL_SE02","absolute","15","5","66","21",null,null,this.div_search);_a.set_taborder("4");_a.set_text("신고년도");_a.set_cssclass("sta_WFSA_Label");this.div_search.addChild(_a.name,_a);_a=new Spin("Spin00","absolute","86","5","70","21",null,null,this.div_search);_a.set_taborder("5");_a.set_value("0");this.div_search.addChild(_a.name,_a);_a=new Static("sta_EMPL_SE03","absolute","171","5","66","21",null,null,this.div_search);_a.set_taborder("6");_a.set_text("신고기수");_a.set_cssclass("sta_WFSA_Label");this.div_search.addChild(_a.name,_a);_a=new Combo("cmb_pblicteDeSe","absolute","242","5","102","21",null,null,this.div_search);this.div_search.addChild(_a.name,_a);var _d=new Dataset("cmb_pblicteDeSe_innerdataset",this.div_search.cmb_pblicteDeSe);_d._setContents("<ColumnInfo><Column id=\"codecolumn\" size=\"256\"/><Column id=\"datacolumn\" size=\"256\"/></ColumnInfo><Rows><Row><Col id=\"codecolumn\"/><Col id=\"datacolumn\">선택</Col></Row><Row><Col id=\"codecolumn\">1</Col><Col id=\"datacolumn\">1기예정</Col></Row><Row><Col id=\"codecolumn\">2</Col><Col id=\"datacolumn\">1기확정</Col></Row><Row><Col id=\"codecolumn\">3</Col><Col id=\"datacolumn\">2기예정</Col></Row><Row><Col id=\"codecolumn\">4</Col><Col id=\"datacolumn\">2기확정</Col></Row></Rows>");_a.set_innerdataset(_d);_a.set_taborder("7");_a.set_codecolumn("codecolumn");_a.set_datacolumn("datacolumn");_a.set_index("-1");_a=new Static("Static07","absolute","0","78",null,"10","0",null,this);_a.set_taborder("12");_a.set_text("10");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Layout("default","",0,33,this.div_search,function(_e){_e.set_taborder("3");_e.set_cssclass("div_WFSA_Box");});this.div_search.addLayout(_a.name,_a);_a=new Layout("default","",920,418,this,function(_e){_e.set_classname("UI_ACC030105_P01");_e.set_titletext("국세청자료 업로드");_e.set_scrollbars("none");});this.addLayout(_a.name,_a);_a=new BindItem("item15","div_detail03.Edit04","value","ds_actMastr","PRMPC_CODE");this.addChild(_a.name,_a);_a.bind();_a=new BindItem("item7","div_detail00.Edit00","value","ds_actMastr","BCNC_CODE");this.addChild(_a.name,_a);_a.bind();_a=new BindItem("item24","div_detail00.Edit01","value","ds_actMastr","BCNC_NM");this.addChild(_a.name,_a);_a.bind();_a=new BindItem("item25","div_detail03.Edit00","value","ds_actMastr","BSNS_CODE");this.addChild(_a.name,_a);_a.bind();_a=new BindItem("item6","div_search.Combo00","value","ds_cond","PUCHAS_SELNG_SE");this.addChild(_a.name,_a);_a.bind();_a=new BindItem("item2","div_search.Combo02","value","ds_cond","TAXBIL_CL");this.addChild(_a.name,_a);_a.bind();_a=new BindItem("item0","div_search.Spin00","value","ds_cond","STTEMNT_YEAR");this.addChild(_a.name,_a);_a.bind();_a=new BindItem("item1","div_search.cmb_pblicteDeSe","value","ds_cond","STTEMNT_HRSMN");this.addChild(_a.name,_a);_a.bind();_a=null;};this.addIncludeScript("ACC030105_P01.xfdl","lib::comInclude.xjs");this.registerScript("ACC030105_P01.xfdl",function(){this.ACC030105_P01_oninit=function(_a,_b){this.ds_cond.clearData();this.ds_cond.addRow();this.ds_cond.setColumn(0,"STTEMNT_YEAR",this.dateUtils.today().substr(0,4));this.ds_cond.setColumn(0,"STTEMNT_HRSMN","");this.ds_cond.setColumn(0,"PUCHAS_SELNG_SE","");this.ds_cond.setColumn(0,"TAXBIL_CL","");};this.ACC030105_P01_onload=function(_a,_b){};this.fn_save=function(_a,_b){if(!this.gfn_checkValidation_NoUpdChk(this.ds_cond,this.ds_validation)){return;}this.fn_transaction("SAVE");};this.fn_transaction=function(_a){switch(_a){case "SAVE":var _b="hsco/mis/acc/ACC030105/saveTaxBill.do";var _c="input1=ds_cond:A input2=DS_IMPORT:A";var _d="";break;}Ex.core.tran(this,_a,_b,_c,_d);};this.fn_callBack=function(_a,_b,_c){if(_b!=0){switch(_a){case "SAVE":this.gfn_message("fail.등록.실패");break;default:break;}}else{switch(_a){case "SAVE":this.gfn_message("success.정상등록");this.close("SAVE");break;default:break;}}this.gfn_callback_message(_a,_b,_c);};this.fn_close=function(){this.close();};this.btn_excelUpload_onclick=function(_a,_b){var _c={targetDs:this.DS_IMPORT,headSet:false,callBack:function(){this.grd_EXCEL_01.createFormat();}};this.fn_importExcel(_c);};this.fn_importExcel=function(_a){var _b,_c="_common_excel_import";_b=new nexacro.ExcelImportObject(_c,this);this[_c]=_b;_b.set_importtype(nexacro.ImportTypes.EXCEL);_b.addEventHandler("onsuccess",this._gfn_excelImport_onsuccess,this);_b.addEventHandler("onerror",this._gfn_excelImport_onerror,this);_b.set_importurl(application.services["svcurl"].url+"XImport.do");_b.user_callBack=null;_b.user_targetGrid=null;var _d=null;if(_a.targetDs){_d=_a.targetDs.name;}else if(_a.targetGrid){_b.user_targetGrid=_a.targetGrid.id;_d=_a.targetGrid.getBindDataset().name;}if(typeof _a.callBack=="function"){_b.user_callBack=_a.callBack;}_b.importData("","[command=getsheetdata;output=outDs;Body=!A7;]","["+_d+"=outDs]","");};});this.on_initEvent=function(){this.DS_IMPORT.addEventHandler("onload",this.DS_IMPORT_onload,this);this.addEventHandler("onload",this.ACC030105_P01_onload,this);this.addEventHandler("oninit",this.ACC030105_P01_oninit,this);this.Button23.addEventHandler("onclick",this.fn_save,this);this.Button02.addEventHandler("onclick",this.fn_close,this);this.btn_excelUpload.addEventHandler("onclick",this.btn_excelUpload_onclick,this);this.div_search.cmb_pblicteDeSe.addEventHandler("onitemchanged",this.div_SEARCH_cmb_pblicteDeSe_onitemchanged,this);};this.loadIncludeScript("ACC030105_P01.xfdl");};})();