(function(){return function(_a){var _b;this.registerScript(_a,function(){this.ds_accClosAt;this.ds_salClosAt;this.ds_inDsBudgetInfo;this.ds_outDSBudgetInfo;this.ds_misTemp;this.ds_jxlsInfo;this.ds_sancInfo;this.ds_sancUrl;this.fn_misFormInit=function(_c){var _d=false;function fn_keyupOnAutoSearch(_b,_e){if(_e.keycode==13){var _f=true;if(_b.toString()=="[object Combo]"){if(_d){_f=false;_d=false;}}if(_f){_c.fn_search();}}}function fn_dropdownOnAutoSearch(_b,_e){_d=true;}function fn_autoSearch(_e){var _f=_e.components.length;for(var _i=0;_i<_f;_i++ ){var _g=_e.components[_i];if(_g.name.toLowerCase().indexOf("div_search")> -1){_g.set_taborder(0);for(var _j=0;_j<_c.components[_i].components.length;_j++ ){var _h=_c.components[_i].components[_j];switch(_h.toString()){case "[object Edit]":case "[object MaskEdit]":case "[object Spin]":case "[object Calendar]":case "[object Div]":_h.addEventHandler("onkeyup",fn_keyupOnAutoSearch,_c);break;case "[object Combo]":if(!_h.getEventHandler("onkeyup",0)){_h.addEventHandler("onkeyup",fn_keyupOnAutoSearch,_c);_h.addEventHandler("ondropdown",fn_dropdownOnAutoSearch,_c);}break;}}}}}fn_keyupToNextObj=function(_b,_e){if(_e.keycode==13){_fn_focus_nextComp(_b);}};_fn_focus_nextComp=function(_b){var _e=_c.getNextComponent(_b,true);var _f=_e;var _g=0;var _h=_c.components.length;while(_g<_h){switch(_f.toString()){case "[object Edit]":case "[object MaskEdit]":case "[object Spin]":case "[object Calendar]":case "[object Combo]":_f.setFocus();return true;case "[object Form]":case "[object Div]":case "[object Tab]":case "[object Div]":case "[object Radio]":case "[object CheckBox]":case "[object Button]":if(_fn_focus_nextComp(_f)==true){return true;}}_f=_c.getNextComponent(_f);if(_e==_f){break;}_g++ ;}return false;};fn_autoFindObj=function(_e){if(_e==null){return;}for(var _g=0;_g<_e.components.length;_g++ ){var _f=_e.components.get_item(_g);switch(_f.toString()){case "[object Edit]":case "[object MaskEdit]":case "[object Spin]":case "[object Calendar]":case "[object Combo]":_f.addEventHandler("onkeyup",fn_keyupToNextObj,_c);break;case "[object Div]":case "[object Tab]":case "[object Tabpage]":if(_f.name.toLowerCase().indexOf("div_search")<0){fn_autoFindObj(_f);}break;case "[object Grid]":_f.set_nodatatext("자료가 존재하지 않습니다.");_f.set_autoenter("select");_f.set_cellsizingtype("col");_f.set_cellmovingtype("col");break;}}};function _onload(_b,_e){try{var _f=_b.getFirstComponent(true);_f.setFocus();}catch(_e){trace("error : "+_e.message);}}fn_autoSearch(_c);fn_autoFindObj(_c);};this.fn_misCallBackMsg=function(_b){if(_b.getRowCount()==0){this.gfn_message("info.조회.데이터.없음");}else{this.gfn_message("success.정상조회");}};this.fn_autoFileSn=function(_c,_d,_e,_f,_g,_h,_i,_j){try{if(_g.rowposition<0){this.gfn_message("comm.데이터.선택.없음");return false;}var _k=null;if(_f.getRowCount()>0){var _l=_g.getColumn(_g.rowposition,_i);if(this.comUtils.isNull(_l)){_k=_f.getColumn(0,"FILE_SN");}else{_k=_l;}}var _m=new Dataset("ds_fileInfo_tmp");_m.addColumn("SYS_SE_CODE","string");_m.addColumn("JOB_SE","string");_m.addColumn("DATASET_NAME","string");_m.addColumn("DATASET_ROW","string");_m.addColumn("TABLE_NAME","string");_m.addColumn("FILE_SN_COLUMN","string");_m.addColumn("SN_TYPE","string");_m.addColumn("FILE_SN","string");for(var _q=0;_q<_j.length;_q++ ){_m.addColumn(_j[_q],"string");}_m.set_useclientlayout(true);var _n=_m.addRow();_m.setColumn(_n,"SYS_SE_CODE",_c);_m.setColumn(_n,"JOB_SE",_d);_m.setColumn(_n,"TABLE_NAME",_h);_m.setColumn(_n,"FILE_SN_COLUMN",_i);_m.setColumn(_n,"DATASET_ROW",_g.rowposition);for(var _q=0;_q<_j.length;_q++ ){var _o=_g.rowposition;var _p=_g.getColumn(_o,_j[_q]);if(!this.comUtils.isNull(_p)){_m.setColumn(_n,_j[_q],_p);}}if(!this.comUtils.isNull(_k)){_m.setColumn(_n,"FILE_SN",_k);}if(!_e._form.af_fileManager){_e._form.addChild("af_fileManager",_e);}if(!_e._form.af_fileDataset){_e._form.addChild("af_fileDataset",_f);}if(!_e._form.af_misDataset){_e._form.addChild("af_misDataset",_g);}if(!_e._form.af_ds_fileInfo){_e._form.addChild("af_ds_fileInfo",_m);}_e._form.af_fileManager=_e;_e._form.af_fileDataset=_f;_e._form.af_misDataset=_g;_e._form.af_ds_fileInfo=_m;_e.addFiles(_e._allowTypes,null);}catch(e){alert(e.message);}};this.fn_onFileSelected=function(){var _c="autoFileSn";var _d="/hsco/mis/mis/MIS000000/saveAutoFileSn.do";var _e="input1=af_ds_fileInfo";var _f="af_ds_fileInfo=output1";Ex.core.tran(this,_c,_d,_e,_f,null,"autoFileSnCallback");};this.autoFileSnCallback=function(){try{var _c=this.af_ds_fileInfo.getColumn(0,"DATASET_NAME");var _d=this.af_ds_fileInfo.getColumn(0,"DATASET_ROW");var _e=this.af_ds_fileInfo.getColumn(0,"FILE_SN_COLUMN");var _f=this.af_ds_fileInfo.getColumn(0,"FILE_SN");var _g=this.af_ds_fileInfo.getColumn(0,"TABLE_CNT");if(_g!='0'){this.af_misDataset.set_updatecontrol(false);}this.af_misDataset.set_enableevent(false);this.af_misDataset.setColumn(_d,_e,_f);this.af_misDataset.set_enableevent(true);if(_g!='0'){this.af_misDataset.set_updatecontrol(true);}var _h=this.af_fileManager.hasFile();if(_h){this.af_fileManager.setFileSn(_f);if(this.af_fileDataset.getRowCount()==0){var _i=this.af_fileDataset.addRow();this.af_fileDataset.setColumn(_i,"FILE_SN",_f);}var _j="hsco/mis/mis/MIS000000/fileUpload.do";var _k="";var _l="af_fileDataset=fileList";this.af_fileManager.upload(_j,_k,_l);}}catch(e){alert(e.message);}};this.fn_onFileSuccess=function(){try{var _c=this.af_fileDataset.getColumn(0,"FILE_SN");this.fn_uploadCallback(_c);}catch(e){if(this.af_fileDataset&&this.File_UpDownManager){this.af_fileDataset.setColumn(0,"FILE_ORDR",null);var _d="selectAtchFile";var _e="/hsco/cmm/file/selectAtchmnFileList.do";var _f="input1=af_fileDataset";var _g="af_fileDataset=output1";Ex.core.tran(this,_d,_e,_f,_g);}}};this.fn_setDatasetType=function(_c,_d){_c.updatecontrol=false;for(i=0;i<_c.getRowCount();i++ ){_c.setRowType(i,_d);}_c.updatecontrol=true;};this.fn_isAccClosAt=function(_c,_d){if(typeof _c=="undefined"||String(_c).length<6){trace("잘못된 회계년월");return false;}this.ds_accClosAt=new Dataset("ds_accClosAt");var _e="accClosAt";var _f="hsco/mis/acc/ACC000000/accClosAt.do";var _g="";var _h="ds_accClosAt=output1";var _i="YYYYMM="+_c;Ex.core.tran(this,_e,_f,_g,_h,_i,"",false,false);if(this.ds_accClosAt.getRowCount()>0){if(_d=="C"){return (this.ds_accClosAt.getColumn(0,"CHIT_CLOSE_AT")=="1");}else if(_d=="S"){return (this.ds_accClosAt.getColumn(0,"STACNT_CLOS_AT")=="1");}else if(_d=="S2"){return (this.ds_accClosAt.getColumn(0,"SE_ACCNUT_CLOS_AT")=="1");}}return false;};this.fn_isSalClosAt=function(_c,_d){if(typeof _c=="undefined"||String(_c).length<6){trace("잘못된 지급년월");return false;}this.ds_salClosAt=new Dataset("ds_salClosAt");var _e="salClosAt";var _f="hsco/mis/sal/SAL000000/salClosAt.do";var _g="";var _h="ds_salClosAt=output1";var _i="PYMNT_YM="+_c+' SN='+_d;Ex.core.tran(this,_e,_f,_g,_h,_i,"",false,false);if(this.ds_salClosAt.getRowCount()>0){return (this.ds_salClosAt.getColumn(0,"CLOS_AT")=="1");}return false;};this.fn_getBudgetInfo=function(_c){this.ds_inDsBudgetInfo=new Dataset("ds_inDsBudgetInfo");this.ds_outDSBudgetInfo=new Dataset("ds_outDSBudgetInfo");if(_c.getRowCount()>0){this.ds_inDsBudgetInfo.copyData(_c);var _d="budgetInfo";var _e="hsco/mis/acc/ACC000000/budgetInfo.do";var _f="input1=ds_inDsBudgetInfo";var _g="ds_outDSBudgetInfo=output1";Ex.core.tran(this,_d,_e,_f,_g,"","",false,false);}return this.ds_outDSBudgetInfo;};this.fn_telMask=function(_c){var _d="###########";if(_c==null||typeof _c=="undefined"){return _d;}var _e=_c.length;if(_e<2){return _d;}if(_c.slice(0,2)=='02'){if(_e==9){_d="##-###-####";}else{_d="##-####-####";}}else{if(_e==10){_d="###-###-####";}else if(_e==11){_d="###-####-####";}else if(_e==7){_d="###-####";}else{_d="###########";}}return _d;};this.fn_getCusSmsMsg=function(_c){var _d;this.ds_misTemp=new Dataset("ds_misTemp");this.ds_misTemp.addColumn("MSSAGE_ID","string",10);this.ds_misTemp.addRow();this.ds_misTemp.setColumn(0,"MSSAGE_ID",_c);var _e="cusSmsMsg";var _f="hsco/mis/cus/CUS020107/mssageInfoR.do";var _g="input1=ds_misTemp";var _h="ds_misTemp=output1";Ex.core.tran(this,_e,_f,_g,_h,"","",false,false);if(this.ds_misTemp.getRowCount()>0){_d=this.ds_misTemp.getColumn(0,"MSSAGE_CN");}return _d;};this.fn_getCusMinwonSmsMsg=function(_c,_d,_e){this.ds_misTemp=new Dataset("ds_misTemp");this.ds_misTemp.addColumn("MSSAGE_ID","string",10);this.ds_misTemp.addColumn("RCEPT_NO","string",10);this.ds_misTemp.addColumn("CHRG_AT","string",10);this.ds_misTemp.addRow();this.ds_misTemp.setColumn(0,"MSSAGE_ID",_c);this.ds_misTemp.setColumn(0,"RCEPT_NO",_d);this.ds_misTemp.setColumn(0,"CHRG_AT",_e);var _f="cusSmsMsg";var _g="hsco/mis/cus/CUS020107/mssageMinwonInfoR.do";var _h="input1=ds_misTemp";var _i="ds_misTemp=output1";Ex.core.tran(this,_f,_g,_h,_i,"","",false,false);return this.ds_misTemp;};this.fn_copyData=function(_c,_d){_d.clearData();for(i=0;i<_c.getRowCount();i++ ){var _e=_d.addRow();_d.copyRow(_e,_c,i);}};this.fn_loadXml=function(_c,_d){var _e=new Dataset();_e.loadXML(_c);this.fn_copyData(_e,_d);};this.fn_setReadonly=function(_c,_d){if(_d!=null&&_d.indexOf(_c.name)> -1){return;}switch(_c.constructor){case Grid:_c.set_readonly(true);break;case Edit:_c.set_cssclass("edt_WF_Readonly");_c.set_readonly(true);break;case MaskEdit:_c.set_cssclass("msk_WF_Readonly");_c.set_readonly(true);break;case Calendar:_c.set_cssclass("cal_WF_Readonly");_c.set_readonly(true);break;case Combo:_c.set_cssclass("cmb_WF_Readonly");_c.set_readonly(true);break;case TextArea:_c.set_cssclass("txt_WF_Readonly");_c.set_readonly(true);break;case Spin:_c.set_cssclass("spn_WF_Readonly");_c.set_readonly(true);break;case CheckBox:_c.set_readonly(true);break;case Button:_c.set_enable(false);break;case Tab:for(var _f=0;_f<_c.getTabpageCount();_f++ ){this.fn_setReadonly(_c.tabpages[_f],_d);}break;case Form:case Div:case Tabpage:var _e=_c.components;for(var _f=0;_f<_e.length;_f++ ){this.fn_setReadonly(_e[_f],_d);}break;default:break;}};this.fn_getMisAuth=function(_c,_d){if(!_c.ds_misAuth){var _e=new Dataset("ds_misAuth");_c.addChild("ds_misAuth",_e);this.ds_misAuth.addColumn("AUTH_GRP_ID","string",10);this.ds_misAuth.addColumn("AUTH_CNT","string",10);this.ds_misAuth.set_useclientlayout(true);}_c.ds_misAuth.clearData();var _f=_c.ds_misAuth.addRow();_c.ds_misAuth.setColumn(_f,"AUTH_GRP_ID",_d);var _g="getMisAuth";var _h="hsco/mis/mis/MIS000000/getAuthGrp.do";var _i="input01=ds_misAuth";var _j="ds_misAuth=output01";Ex.core.tran(this,_g,_h,_i,_j,"","",false,false);var _k=_c.ds_misAuth.getColumn(0,"AUTH_CNT");return (_k=='1');};this.fn_getLastSanctnSttus=function(_c){this.ds_cond=new Dataset("ds_cond");this.ds_cond.addColumn("INNER_SANCTN_ID","string",254);this.ds_cond.addRow();this.ds_cond.setColumn(0,"INNER_SANCTN_ID",_c);this.ds_result=new Dataset("ds_result");var _d="innerSanctnId";var _e="hsco/mis/mis/MIS000000/selectLastSanctnSttus.do";var _f="input01=ds_cond";var _g="ds_result=output01";Ex.core.tran(this,_d,_e,_f,_g,"","",false,false);var _h=this.ds_result.getColumn(0,"LAST_SANCTN_STTUS");return _h;};this.fn_getEmpno=function(){return application.gds_userInfo.getColumn(0,"EMPNO");};this.fn_getEmpnm=function(){return application.gds_userInfo.getColumn(0,"USER_NM");};this.mis_messenger_send=function(_c,_d,_e,_f,_g,_h,_i,_j){try{if(!_d){this.gfn_message("comm.항목.입력.을","수신자사번");return false;}if(!_j){this.gfn_message("comm.항목.입력.을","알림제목");return false;}var _k=new Dataset;_k.set_id("ds_messngr");if(!this.dsntcnSndng){this.insertChild(0,"ds_messngr",_k);_k.addColumn("RCVER_USER_ID","string","256");_k.addColumn("RCVER_USER_NM","string","256");_k.addColumn("SENDER_USER_ID","string","256");_k.addColumn("SENDER_USER_NM","string","256");_k.addColumn("NTCN_SJ","string","256");_k.addColumn("LINK_ADRES","string","500");_k.addColumn("NTCN_CN","string","4000");}this.ds_messngr.clearData();this.ds_messngr.addRow();this.ds_messngr.setColumn(0,"RCVER_USER_ID",_d);this.ds_messngr.setColumn(0,"RCVER_USER_NM",_e);this.ds_messngr.setColumn(0,"SENDER_USER_ID",_f);this.ds_messngr.setColumn(0,"SENDER_USER_NM",_g);this.ds_messngr.setColumn(0,"NTCN_SJ",_j);this.ds_messngr.setColumn(0,"LINK_ADRES",_i);this.ds_messngr.setColumn(0,"NTCN_CN",_h);var _l="mis_messenger_send";var _m="hsco/mis/mis/MIS000000/NtcnSndngCUD.do";var _n="input1=ds_messngr:U";var _o="";Ex.core.tran(this,_l,_m,_n,_o,"","","fn_misCallBack",true);}catch(e){return false;}};this.fn_misCallBack=function(_c,_d,_e){if(_d!=0){this.gfn_callback_message(_c,_d,_e);}else{switch(_c){case "mis_messenger_send":this.gfn_message("success.알림발송.성공");break;}}};this.fn_dateStr=function(_c,_d,_e){if(this.comUtils.isNull(_c)){return null;}if(this.comUtils.isNull(_d)){_d="-";}if(_c.length!=8){return _c;}if(!this.comUtils.isNull(_e)){if(_e=="YYYY"){return _c.substr(0,4);}else if(_e=="MM"){return _c.substr(4,2);}else if(_e=="DD"){return _c.substr(6,2);}else if(_e=="YYYYMM"){return _c.substr(0,4)+_d+_c.substr(4,2);}}return _c.substr(0,4)+_d+_c.substr(4,2)+_d+_c.substr(6,2);};this.fn_numToHangul=function(_c){var _d=new Array("","일","이","삼","사","오","육","칠","팔","구");var _e=new Array("","십","백","천");var _f=new Array("","만","억","조");var _g=false;var _h=_c.toString();if(_c<0){_g=true;_h=_h.substring(1);}if(isNaN(_h)==true){return;}var _i=_h.length;var _j="";var _k=0;for(i=0;i<_h.length;i++ ){var _l=_d[_h.charAt(i)];if(_l!=""){_k++ ;_l+=_e[(_i-(i+1))%4];}if(_k!=0&&(_i-(i+1))%4==0){_k=0;_l=_l+_f[(_i-(i+1))/4];}_j+=_l;}if(_h!=0){_j=_j;}if(_g){_j="△"+_j;}return _j;};this.fn_callHandySanc=function(_c,_d,_e,_f,_g,_h,_i,_j,_k,_l){for(var _ak=0;_ak<_h.length;_ak++ ){var _m=_h[_ak];if(this.comUtils.isNull(_m)||_m=="null"||_m=="undefined"){_h[_ak]="";}}if(_i){for(var _al=0;_al<_i.length;_al++ ){var _n=_i[_al];if(this.comUtils.isNull(_n)||_n=="null"||_n=="undefined"){_i[_al]="";}}}var _o="SANCTN_NO";if(!this.comUtils.isNull(_k)){_o=_k;}if(_c.ds_handy_sanc){_c.removeChild("ds_handy_sanc");}var _p=new Dataset("ds_handy_sanc_tmp");_p.addColumn("USER_ID","string");_p.addColumn("EMP_CODE","string");_p.addColumn("DEPT_CODE","string");_p.addColumn("USER_KEY","string");_p.addColumn("EMPNO","string");_p.addColumn("MIS_KEY_LIST","string");_p.addColumn("SANCTN_COLUMN","string");_p.set_useclientlayout(true);var _q=_p.addRow();var _r=_g.join("|");_p.setColumn(_q,"MIS_KEY_LIST",_r);_p.setColumn(_q,"SANCTN_COLUMN",_o);_c.addChild("ds_handy_sanc",_p);if(_c.ds_mis_param){_c.removeChild("ds_mis_param");}var _s=new Dataset("ds_mis_param_tmp");_s.addColumn(_o,"string");_s.addColumn("TABLE_NAME","string");_s.addColumn("MIS_VAL_LIST","string");_s.set_useclientlayout(true);if(this.comUtils.isNull(_j)){var _t=_e.rowposition;var _u=_s.addRow();var _v=_e.getColumn(_t,_o);_s.setColumn(_u,_o,_v);_s.setColumn(_u,"TABLE_NAME",_f);var _w=new Array();for(var _am=0;_am<_g.length;_am++ ){var _x=_e.getColumn(_t,_g[_am]);_w[_am]=_x;}var _y=_w.join("|");_s.setColumn(_u,"MIS_VAL_LIST",_y);}else{for(var _an=0;_an<_e.getRowCount();_an++ ){var _z=_e.getColumn(_an,_j);if(_z=='1'){var _u=_s.addRow();var _v=_e.getColumn(_an,_o);_s.setColumn(_u,_o,_v);_s.setColumn(_u,"TABLE_NAME",_f);var _w=new Array();for(var _am=0;_am<_g.length;_am++ ){var _x=_e.getColumn(_an,_g[_am]);_w[_am]=_x;}var _y=_w.join("|");_s.setColumn(_u,"MIS_VAL_LIST",_y);}}if(_s.getRowCount()==0){return false;}}_c.addChild("ds_mis_param",_s);var _aa="saveSanctnData";var _ab="hsco/cmm/sanc/sanctn.do";var _ac="input1=ds_handy_sanc:A input2=ds_mis_param:A";var _ad="ds_handy_sanc=output1 ds_mis_param=output2";Ex.core.tran(_c,_aa,_ab,_ac,_ad,"","",true,false);if(_c.ds_handy_sanc.getRowCount()==0){return false;}var _v=_c.ds_mis_param.getColumn(0,_o);var _ae=_d;var _af=_c.ds_handy_sanc.getColumn(0,"DEPT_CODE");var _ag=_c.ds_handy_sanc.getColumn(0,"EMP_CODE");var _ah=_v;if(this.comUtils.isNull(_v)||this.comUtils.isNull(_ag)){this.gfn_message("info.처리불가","결재 연동정보를 확인할 수 없습니다. 조회 후 결재 진행부탁드립니다.");return false;}var _ai=_v+"|"+_h.join("|");var _aj=null;if(!this.comUtils.isNull(_i)){_aj=_i.join("|");}if(this.comUtils.isNull(_j)){_e.set_updatecontrol(false);_e.set_enableevent(false);_e.setColumn(_e.rowposition,_o,_v);_e.set_enableevent(true);_e.set_updatecontrol(true);}else{for(var _an=0;_an<_e.getRowCount();_an++ ){var _z=_e.getColumn(_an,_j);if(_z=='1'){_e.set_updatecontrol(false);_e.set_enableevent(false);_e.setColumn(_an,_o,_v);_e.set_enableevent(true);_e.set_updatecontrol(true);}}}this.fn_showHandyDocument(_c,_ae,_af,_ag,_ah,_ai,_aj,_l);};this.fn_callHandySanc2=function(_c,_d,_e,_f,_g,_h,_i,_j,_k,_l){for(var _ak=0;_ak<_h.length;_ak++ ){var _m=_h[_ak];if(this.comUtils.isNullEmpty(_m)||_m=="null"||_m=="undefined"){_h[_ak]=" ";}}if(_i){for(var _al=0;_al<_i.length;_al++ ){var _n=_i[_al];if(this.comUtils.isNullEmpty(_n)||_n=="null"||_n=="undefined"){_i[_al]=" ";}}}var _o="SANCTN_NO";if(!this.comUtils.isNull(_k)){_o=_k;}if(_c.ds_handy_sanc){_c.removeChild("ds_handy_sanc");}var _p=new Dataset("ds_handy_sanc_tmp");_p.addColumn("USER_ID","string");_p.addColumn("EMP_CODE","string");_p.addColumn("DEPT_CODE","string");_p.addColumn("USER_KEY","string");_p.addColumn("EMPNO","string");_p.addColumn("MIS_KEY_LIST","string");_p.addColumn("SANCTN_COLUMN","string");_p.addColumn("FORM_ID","string");_p.addColumn("SANCTN_SJ","string");_p.set_useclientlayout(true);var _q=_p.addRow();var _r=_g.join("|");_p.setColumn(_q,"MIS_KEY_LIST",_r);_p.setColumn(_q,"SANCTN_COLUMN",_o);_p.setColumn(_q,"FORM_ID",_d);if(_h.length>0){_p.setColumn(_q,"SANCTN_SJ",_h[0]);}_c.addChild("ds_handy_sanc",_p);if(_c.ds_mis_param){_c.removeChild("ds_mis_param");}var _s=new Dataset("ds_mis_param_tmp");_s.addColumn(_o,"string");_s.addColumn("TABLE_NAME","string");_s.addColumn("MIS_VAL_LIST","string");_s.set_useclientlayout(true);if(this.comUtils.isNull(_j)){var _t=_e.rowposition;var _u=_s.addRow();var _v=_e.getColumn(_t,_o);_s.setColumn(_u,_o,_v);_s.setColumn(_u,"TABLE_NAME",_f);var _w=new Array();for(var _am=0;_am<_g.length;_am++ ){var _x=_e.getColumn(_t,_g[_am]);_w[_am]=_x;}var _y=_w.join("|");_s.setColumn(_u,"MIS_VAL_LIST",_y);}else{for(var _an=0;_an<_e.getRowCount();_an++ ){var _z=_e.getColumn(_an,_j);if(_z=='1'){var _u=_s.addRow();var _v=_e.getColumn(_an,_o);_s.setColumn(_u,_o,_v);_s.setColumn(_u,"TABLE_NAME",_f);var _w=new Array();for(var _am=0;_am<_g.length;_am++ ){var _x=_e.getColumn(_an,_g[_am]);_w[_am]=_x;}var _y=_w.join("|");_s.setColumn(_u,"MIS_VAL_LIST",_y);}}if(_s.getRowCount()==0){return false;}}_c.addChild("ds_mis_param",_s);var _aa="saveSanctnData";var _ab="hsco/cmm/sanc/sanctn.do";var _ac="input1=ds_handy_sanc:A input2=ds_mis_param:A";var _ad="ds_handy_sanc=output1 ds_mis_param=output2";Ex.core.tran(_c,_aa,_ab,_ac,_ad,"","",true,false);if(_c.ds_handy_sanc.getRowCount()==0){return false;}var _v=_c.ds_mis_param.getColumn(0,_o);var _ae=_d;var _af=_c.ds_handy_sanc.getColumn(0,"DEPT_CODE");var _ag=_c.ds_handy_sanc.getColumn(0,"EMP_CODE");var _ah=_v;if(this.comUtils.isNull(_v)||this.comUtils.isNull(_ag)){this.gfn_message("info.처리불가","결재 연동정보를 확인할 수 없습니다. 조회 후 결재 진행부탁드립니다.");return false;}var _ai=_v+"|"+_h.join("|")+"|";var _aj=null;if(!this.comUtils.isNull(_i)){_aj=_i.join("|");_aj+="|";}if(this.comUtils.isNull(_j)){_e.set_updatecontrol(false);_e.set_enableevent(false);_e.setColumn(_e.rowposition,_o,_v);_e.set_enableevent(true);_e.set_updatecontrol(true);}else{for(var _an=0;_an<_e.getRowCount();_an++ ){var _z=_e.getColumn(_an,_j);if(_z=='1'){_e.set_updatecontrol(false);_e.set_enableevent(false);_e.setColumn(_an,_o,_v);_e.set_enableevent(true);_e.set_updatecontrol(true);}}}this.fn_showHandyDocument2(_c,_ae,_af,_ag,_ah,_ai,_aj,_l);};this.fn_showHandyDocument=function(_c,_d,_e,_f,_g,_h,_i,_j){var _k="http://10.50.10.100:8888/qdb-linkage/GianCall.do";if(this.wb_sanc){this.removeChild("wb_sanc");}var _l=new WebBrowser();_l.init("wb_sanc","absolute",0,0,1,1,null,null);this.addChild("wb_sanc",_l);_l.show();var _m=document.getElementById(_l._ifrm_elem._object_id);var _n;var _o;var _p;if(_m.contentDocument){_n=_m.contentDocument;_o=_n.getElementsByTagName('head')[0];_p=_n.getElementsByTagName('body')[0];}else if(_m.contentWindow){_n=_m.contentWindow.document;_o=_n.getElementsByTagName('head')[0];_p=_n.getElementsByTagName('body')[0];}if(!_o){_o=_n.createElement("head");_n.appendChild(_o);}if(!_p){_p=_n.createElement("body");_n.appendChild(_p);}var _q=_n.createElement("meta");_q.httpEquiv="Content-Type";_q.content="text/html; charset=utf-8";_o.appendChild(_q);var _r=_n.createElement("form");_r.id="sancForm";_r.name="sancForm";_r.action=_k;_r.method="post";_r.acceptCharset="utf-8";_p.appendChild(_r);var _s=_n.createElement("input");_s.type="hidden";_s.name="formid";_s.value=_d;_r.appendChild(_s);var _t=_n.createElement("input");_t.type="hidden";_t.name="deptcode";_t.value=_e;_r.appendChild(_t);var _u=_n.createElement("input");_u.type="hidden";_u.name="empcode";_u.value=_f;_r.appendChild(_u);var _v=_n.createElement("input");_v.type="hidden";_v.name="miskey";_v.value=_g;_r.appendChild(_v);var _w=_n.createElement("input");_w.type="hidden";_w.name="firstvalue";_w.value=_h;_r.appendChild(_w);if(!this.comUtils.isNull(_i)){var _x=_n.createElement("input");_x.type="hidden";_x.name="secondvalue";_x.value=_i;_r.appendChild(_x);}if(_j){for(var _ae=0;_ae<_j.getRowCount();_ae++ ){var _y=_j.getColumn(_ae,"ORGINL_FILE_NM");var _z=_j.getColumn(_ae,"FILE_SN");var _aa=_j.getColumn(_ae,"FILE_ORDR");var _ab=_n.createElement("input");_ab.type="hidden";_ab.name="attnames";_ab.value=_y;_r.appendChild(_ab);var _ac=_n.createElement("input");_ac.type="hidden";_ac.name="atturls";_ac.value="http://10.50.10.145/hsco/cmm/download/viewImage.do?FILE_SN="+_z+"&FILE_ORDR="+_aa+"";_r.appendChild(_ac);}}if(_n.getElementById('sancForm')){var _ad="결재 상신 후, 상단의 조회 버튼을 클릭하여 주시기 바랍니다.(상신된 건을 화면에서 수정하실 경우, 입력한 데이터가 유실될 수 있습니다)";_n.getElementById('sancForm').submit();this.gfn_message("info.처리불가",_ad);}};this.fn_showHandyDocument2=function(_c,_d,_e,_f,_g,_h,_i,_j){var _k="http://10.50.10.100:8888/jsp/INCLoadHelp.jsp";if(this.wb_sanc){this.removeChild("wb_sanc");}var _l=new WebBrowser();_l.init("wb_sanc","absolute",0,0,1,1,null,null);this.addChild("wb_sanc",_l);_l.show();var _m=document.getElementById(_l._ifrm_elem._object_id);var _n;var _o;var _p;if(_m.contentDocument){_n=_m.contentDocument;_o=_n.getElementsByTagName('head')[0];_p=_n.getElementsByTagName('body')[0];}else if(_m.contentWindow){_n=_m.contentWindow.document;_o=_n.getElementsByTagName('head')[0];_p=_n.getElementsByTagName('body')[0];}if(!_o){_o=_n.createElement("head");_n.appendChild(_o);}if(!_p){_p=_n.createElement("body");_n.appendChild(_p);}var _q=_n.createElement("meta");_q.httpEquiv="Content-Type";_q.content="text/html; charset=utf-8";_o.appendChild(_q);var _r=_n.createElement("form");_r.id="sancForm";_r.name="sancForm";_r.action=_k;_r.method="post";_r.acceptCharset="utf-8";_p.appendChild(_r);var _s=_n.createElement("input");_s.type="hidden";_s.name="FORMID";_s.value=_d;_r.appendChild(_s);var _t=_n.createElement("input");_t.type="hidden";_t.name="deptcode";_t.value=_e;_r.appendChild(_t);var _u=_n.createElement("input");_u.type="hidden";_u.name="EMPCD";_u.value=_f;_r.appendChild(_u);var _v=_n.createElement("input");_v.type="hidden";_v.name="MISKEY";_v.value=_g;_r.appendChild(_v);var _w=_n.createElement("input");_w.type="hidden";_w.name="DATAVALUE_A";_w.value=_h;_r.appendChild(_w);if(!this.comUtils.isNull(_i)){var _x=_n.createElement("input");_x.type="hidden";_x.name="DATAVALUE_B";_x.value=_i;_r.appendChild(_x);}if(_j){var _y="";for(var _ae=0;_ae<_j.getRowCount();_ae++ ){var _z=_j.getColumn(_ae,"ORGINL_FILE_NM");var _aa=_j.getColumn(_ae,"FILE_SN");var _ab=_j.getColumn(_ae,"FILE_ORDR");_y+=_z;_y+="!";_y+="http://10.50.10.145/hsco/cmm/download/viewImage.do?FILE_SN="+_aa+"&FILE_ORDR="+_ab+"";_y+="|";}if(_y!=""){var _ac=_n.createElement("input");_ac.type="hidden";_ac.name="ATTACHFILE";_ac.value=_y;_r.appendChild(_ac);}}if(_n.getElementById('sancForm')){var _ad="결재 상신 후, 상단의 조회 버튼을 클릭하여 주시기 바랍니다.(상신된 건을 화면에서 수정하실 경우, 입력한 데이터가 유실될 수 있습니다)";_n.getElementById('sancForm').submit();this.gfn_message("info.처리불가",_ad);}};this.fn_getByte=function(_c){var _d=_c.toString();var _e=0;var _f="";for(var _g=0;_g<_d.length;_g++ ){if(_d.charCodeAt(_g)>127){_e+=2;}else{_e+=1;}}return _e;};this.fn_getStringCheckByte=function(_c,_d){var _e="";if(!this.comUtils.isNull(_c)&&!this.comUtils.isNull(_d)){var _f=_c.toString();var _g=nexacro.toNumber(_d);var _h=0;for(var _i=0;_i<_f.length;_i++ ){if(_f.charCodeAt(_i)>127){_h+=2;}else{_h+=1;}if(_h>_g){break;}_e+=_f.charAt(_i);}}return _e;};this.fn_jxlsDownload=function(_c,_d,_e,_f){this.ds_jxlsInfo=new Dataset("ds_jxlsInfo");this.ds_jxlsInfo.addColumn("__TEMPLATE","string","256");this.ds_jxlsInfo.addColumn("__FILENAME","string","256");for(var _k in _f){this.ds_jxlsInfo.addColumn(_k,"string","256");}this.ds_jxlsInfo.addRow();this.ds_jxlsInfo.setColumn(0,"__TEMPLATE",_c);this.ds_jxlsInfo.setColumn(0,"__FILENAME",_d);for(var _k in _f){this.ds_jxlsInfo.setColumn(0,_k,_f[_k]);}_e+=" __DS_JXLS_INFO__=ds_jxlsInfo";var _g=Eco.getUniqueId("jxlsDownload_");var _h=new nexacro.ExtFileDownload(_g,this);this.addChild(_g,_h);var _i=Ex.core.setTranBaseInfo(this,"jxlsDownload","hsco/cmm/download/excel.do",_e,"");var _j=_i["strInDatasets"]+_e;_h.show();_h.download(application.gv_host+"hsco/cmm/download/excel.do",_d,_j);};this.fn_openSanc=function(_c){this.ds_sancInfo=new Dataset("ds_sancInfo");this.ds_sancUrl=new Dataset("ds_sancUrl");this.ds_sancInfo.addColumn("SANCTN_NO","string","256");this.ds_sancInfo.addRow();this.ds_sancInfo.setColumn(0,"SANCTN_NO",_c);var _d="sancURL";var _e="hsco/cmm/sanc/getSancURL.do";var _f="input1=ds_sancInfo";var _g="ds_sancUrl=output1";Ex.core.tran(this,_d,_e,_f,_g,"","",false,false);if(this.ds_sancUrl.getRowCount()>0){var _h=this.ds_sancUrl.getColumn(0,"LINK");if(_h){system.execBrowser(_h);}}};});this.loadIncludeScript(_a);_b=null;};})();