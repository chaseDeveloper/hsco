(function(){return function(){if(!this._is_form){return;}this.on_create=function(){var _a=null;if(Form==this.constructor){this.set_name("AUD040102");this.set_classname("AUD040102");this.set_titletext("청렴마일리지등록");this._setFormPosition(0,0,1059,735);}_a=new Dataset("DS_INTGTY_MLG_REGIST",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"APPLC_YEAR\" type=\"STRING\" size=\"256\"/><Column id=\"MLG_SN\" type=\"STRING\" size=\"256\"/><Column id=\"MLG_CODE\" type=\"STRING\" size=\"256\"/><Column id=\"DEPT_INDVDL_SE\" type=\"STRING\" size=\"256\"/><Column id=\"DEPT_CODE\" type=\"STRING\" size=\"256\"/><Column id=\"DEPT_NM\" type=\"STRING\" size=\"256\"/><Column id=\"EMPNM\" type=\"STRING\" size=\"256\"/><Column id=\"EMPNO\" type=\"STRING\" size=\"256\"/><Column id=\"APPLC_DE\" type=\"STRING\" size=\"256\"/><Column id=\"MLG_SCORE\" type=\"BIGDECIMAL\" size=\"256\"/><Column id=\"UPLMT_SCORE\" type=\"STRING\" size=\"256\"/><Column id=\"ATCH_FILE\" type=\"STRING\" size=\"256\"/><Column id=\"RM\" type=\"STRING\" size=\"256\"/><Column id=\"REGISTER_ID\" type=\"STRING\" size=\"256\"/><Column id=\"REGIST_DT\" type=\"DATE\" size=\"256\"/><Column id=\"UPDUSR_ID\" type=\"STRING\" size=\"256\"/><Column id=\"UPDT_DT\" type=\"DATE\" size=\"256\"/><Column id=\"MLG_SE\" type=\"STRING\" size=\"256\"/><Column id=\"MLG_KND\" type=\"STRING\" size=\"256\"/><Column id=\"MLG_DETAIL\" type=\"STRING\" size=\"256\"/><Column id=\"CSBY_ALLOT\" type=\"STRING\" size=\"256\"/><Column id=\"SEQ\" type=\"BIGDECIMAL\" size=\"256\"/><Column id=\"MXMM_VALUE\" type=\"STRING\" size=\"256\"/><Column id=\"JSSFC_NM\" type=\"STRING\" size=\"256\"/><Column id=\"HR_CLSF_NM\" type=\"STRING\" size=\"256\"/><Column id=\"OFCPS_NM\" type=\"STRING\" size=\"256\"/><Column id=\"JBLN_NM\" type=\"STRING\" size=\"256\"/><Column id=\"JSSFC_SE\" type=\"STRING\" size=\"256\"/><Column id=\"HR_CLSF_SE\" type=\"STRING\" size=\"256\"/><Column id=\"OFCPS_SE\" type=\"STRING\" size=\"256\"/><Column id=\"JBLN_SE\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_cond",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"BGN_APPLC_DE\" type=\"STRING\" size=\"256\"/><Column id=\"END_APPLC_DE\" type=\"STRING\" size=\"256\"/><Column id=\"DEPT_CODE\" type=\"STRING\" size=\"256\"/><Column id=\"EMPNO\" type=\"STRING\" size=\"256\"/><Column id=\"DEPT_INDVDL_SE\" type=\"STRING\" size=\"256\"/><Column id=\"MLG_KND\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_import2",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"Column0\" type=\"STRING\" size=\"256\"/><Column id=\"Column1\" type=\"STRING\" size=\"256\"/><Column id=\"Column2\" type=\"STRING\" size=\"256\"/><Column id=\"Column3\" type=\"STRING\" size=\"256\"/><Column id=\"Column4\" type=\"STRING\" size=\"256\"/><Column id=\"Column5\" type=\"STRING\" size=\"256\"/><Column id=\"Column6\" type=\"STRING\" size=\"256\"/><Column id=\"Column7\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_import",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"Column0\" type=\"STRING\" size=\"256\"/><Column id=\"Column1\" type=\"STRING\" size=\"256\"/><Column id=\"Column2\" type=\"STRING\" size=\"256\"/><Column id=\"Column3\" type=\"STRING\" size=\"256\"/><Column id=\"Column4\" type=\"STRING\" size=\"256\"/><Column id=\"Column5\" type=\"STRING\" size=\"256\"/><Column id=\"Column6\" type=\"STRING\" size=\"256\"/><Column id=\"Column7\" type=\"STRING\" size=\"256\"/><Column id=\"Column8\" type=\"STRING\" size=\"256\"/><Column id=\"Column9\" type=\"STRING\" size=\"256\"/><Column id=\"Column10\" type=\"STRING\" size=\"256\"/><Column id=\"Column11\" type=\"STRING\" size=\"256\"/><Column id=\"Column12\" type=\"STRING\" size=\"256\"/><Column id=\"Column13\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("DS_MLGKND",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"MLG_KND\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_cond00",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"ESTBS_YEAR\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_deptCode",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"DEPT_CODE\" type=\"STRING\" size=\"256\"/><Column id=\"DEPT_NM\" type=\"STRING\" size=\"256\"/><Column id=\"DEPT_SE\" type=\"STRING\" size=\"256\"/><Column id=\"FAXNO\" type=\"STRING\" size=\"256\"/><Column id=\"USE_AT\" type=\"STRING\" size=\"256\"/><Column id=\"RM\" type=\"STRING\" size=\"256\"/><Column id=\"GW_DEPT_ID\" type=\"STRING\" size=\"256\"/><Column id=\"REGISTER_ID\" type=\"STRING\" size=\"256\"/><Column id=\"REGIST_DT\" type=\"STRING\" size=\"256\"/><Column id=\"UPDUSR_ID\" type=\"STRING\" size=\"256\"/><Column id=\"UPDT_DT\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_deptCond",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"DEPT_CNM\" type=\"STRING\" size=\"256\"/><Column id=\"USE_AT\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_cond2",this);_a.set_useclientlayout("true");_a._setContents("<ColumnInfo><Column id=\"APPLC_YEAR\" type=\"STRING\" size=\"256\"/><Column id=\"MLG_CODE\" type=\"STRING\" size=\"256\"/><Column id=\"MLG_SE\" type=\"STRING\" size=\"256\"/><Column id=\"EMPNO\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_mlgScoreTotList",this);_a.set_useclientlayout("true");_a._setContents("<ColumnInfo><Column id=\"EMPNO\" type=\"STRING\" size=\"256\"/><Column id=\"MXMM_VALUE\" type=\"STRING\" size=\"256\"/><Column id=\"MLG_SCORE_TOT\" type=\"STRING\" size=\"256\"/><Column id=\"EMPNM\" type=\"STRING\" size=\"256\"/><Column id=\"CSBY_ALLOT\" type=\"STRING\" size=\"256\"/><Column id=\"MLG_SCORE\" type=\"STRING\" size=\"256\"/><Column id=\"DEPT_INDVDL_SE\" type=\"STRING\" size=\"256\"/><Column id=\"DEPT_CODE\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Div("div_Cont","absolute","0","33",null,null,"28","0",this);_a.set_taborder("1");this.addChild(_a.name,_a);_a=new Tab("AUD040102","absolute","0","36",null,null,"0","0",this.div_Cont);_a.set_taborder("0");_a.set_tabindex("0");_a.set_scrollbars("autoboth");_a.style.set_showextrabutton("false");_a.set_visible("true");this.div_Cont.addChild(_a.name,_a);_a=new Tabpage("T01",this.div_Cont.AUD040102);_a.set_text("개인별마일리지");this.div_Cont.AUD040102.addChild(_a.name,_a);_a=new Grid("grd_INTGTY_MLG_REGIST","absolute","1","29",null,null,"1","8",this.div_Cont.AUD040102.T01);_a.set_taborder("2");_a.set_binddataset("DS_INTGTY_MLG_REGIST");_a.set_autofittype("none");_a.set_autoenter("select");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"40\" band=\"left\"/><Column size=\"120\" band=\"left\"/><Column size=\"100\" band=\"left\"/><Column size=\"80\" band=\"left\"/><Column size=\"90\" band=\"left\"/><Column size=\"90\" band=\"left\"/><Column size=\"90\" band=\"left\"/><Column size=\"90\" band=\"left\"/><Column size=\"100\"/><Column size=\"53\"/><Column size=\"120\"/><Column size=\"150\"/><Column size=\"150\"/><Column size=\"70\"/><Column size=\"200\"/><Column size=\"80\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"24\"/><Row size=\"24\" band=\"summ\"/></Rows><Band id=\"head\"><Cell text=\"순번\"/><Cell col=\"1\" text=\"부서\"/><Cell col=\"2\" text=\"사번\"/><Cell col=\"3\" text=\"성명\"/><Cell col=\"4\" text=\"직종\"/><Cell col=\"5\" text=\"직급\"/><Cell col=\"6\" text=\"직위\"/><Cell col=\"7\" text=\"직렬\"/><Cell col=\"8\" text=\"적용일자\"/><Cell col=\"9\" text=\"코드\"/><Cell col=\"10\" text=\"분야\"/><Cell col=\"11\" text=\"평가항목\"/><Cell col=\"12\" text=\"평가기준\"/><Cell col=\"13\" text=\"점수\"/><Cell col=\"14\" text=\"비고\"/><Cell col=\"15\" text=\"1인상한점수\"/></Band><Band id=\"body\"><Cell text=\"expr:currow + 1\"/><Cell col=\"1\" displaytype=\"combo\" style=\"align:left;\" text=\"bind:DEPT_CODE\" combodataset=\"ds_deptCode\" combocodecol=\"DEPT_CODE\" combodatacol=\"DEPT_NM\"/><Cell col=\"2\" text=\"bind:EMPNO\"/><Cell col=\"3\" text=\"bind:EMPNM\"/><Cell col=\"4\" displaytype=\"normal\" text=\"bind:JSSFC_NM\"/><Cell col=\"5\" displaytype=\"normal\" text=\"bind:HR_CLSF_NM\"/><Cell col=\"6\" displaytype=\"normal\" text=\"bind:OFCPS_NM\"/><Cell col=\"7\" displaytype=\"normal\" text=\"bind:JBLN_NM\"/><Cell col=\"8\" displaytype=\"date\" text=\"bind:APPLC_DE\" calendardisplay=\"edit\" calendardisplaynulltype=\"none\"/><Cell col=\"9\" text=\"bind:MLG_CODE\"/><Cell col=\"10\" style=\"align:left;\" text=\"bind:MLG_SE\"/><Cell col=\"11\" style=\"align:left;\" text=\"bind:MLG_KND\"/><Cell col=\"12\" style=\"align:left;\" text=\"bind:MLG_DETAIL\"/><Cell col=\"13\" displaytype=\"number\" style=\"align:right;\" text=\"bind:MLG_SCORE\"/><Cell col=\"14\" style=\"align:left;padding:0 0 0 5;\" text=\"bind:RM\"/><Cell col=\"15\" style=\"align:right;\" text=\"bind:MXMM_VALUE\"/></Band><Band id=\"summary\"><Cell/><Cell col=\"1\"/><Cell col=\"2\"/><Cell col=\"3\"/><Cell col=\"4\"/><Cell col=\"5\"/><Cell col=\"6\"/><Cell col=\"7\"/><Cell col=\"8\"/><Cell col=\"9\"/><Cell col=\"10\"/><Cell col=\"11\"/><Cell col=\"12\"/><Cell col=\"13\" displaytype=\"number\" style=\"align:right;\" text=\"expr:dataset.getSum(&quot;MLG_SCORE&quot;)\"/><Cell col=\"14\"/><Cell col=\"15\"/></Band></Format></Formats>");this.div_Cont.AUD040102.T01.addChild(_a.name,_a);_a=new Button("Button00","absolute",null,"5","25","19","24",null,this.div_Cont.AUD040102.T01);_a.set_taborder("0");_a.set_cssclass("btn_WF_Gridexceldn");this.div_Cont.AUD040102.T01.addChild(_a.name,_a);_a=new Button("Button01","absolute",null,"5","25","19","0",null,this.div_Cont.AUD040102.T01);_a.set_taborder("1");_a.set_cssclass("btn_WF_Gridexcelup");this.div_Cont.AUD040102.T01.addChild(_a.name,_a);_a=new Static("Static05","absolute","39","0","999","5",null,null,this.div_Cont.AUD040102.T01);_a.set_taborder("3");_a.set_text("10");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.div_Cont.AUD040102.T01.addChild(_a.name,_a);_a=new Static("Static00","absolute","47","24","999","5",null,null,this.div_Cont.AUD040102.T01);_a.set_taborder("4");_a.set_text("10");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.div_Cont.AUD040102.T01.addChild(_a.name,_a);_a=new Static("sta_gnfdList","absolute","0","5","178","19",null,null,this.div_Cont.AUD040102.T01);_a.set_taborder("5");_a.set_text("개인별 마일리지 목록");_a.set_cssclass("sta_WF_Title02");_a.style.set_align("left middle");this.div_Cont.AUD040102.T01.addChild(_a.name,_a);_a=new Tabpage("T02",this.div_Cont.AUD040102);_a.set_text("부서별마일리지");this.div_Cont.AUD040102.addChild(_a.name,_a);_a=new Grid("grd_INTGTY_MLG_REGIST","absolute","0","29",null,null,"0","0",this.div_Cont.AUD040102.T02);_a.set_taborder("2");_a.set_binddataset("DS_INTGTY_MLG_REGIST");_a.set_autoenter("select");_a.set_autofittype("col");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"40\"/><Column size=\"120\"/><Column size=\"100\"/><Column size=\"60\"/><Column size=\"120\"/><Column size=\"150\"/><Column size=\"150\"/><Column size=\"50\"/><Column size=\"150\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"24\"/></Rows><Band id=\"head\"><Cell text=\"순번\"/><Cell col=\"1\" text=\"부서\"/><Cell col=\"2\" text=\"적용일자\"/><Cell col=\"3\" text=\"코드\"/><Cell col=\"4\" text=\"분야\"/><Cell col=\"5\" text=\"평가항목\"/><Cell col=\"6\" text=\"평가기준\"/><Cell col=\"7\" text=\"점수\"/><Cell col=\"8\" text=\"비고\"/></Band><Band id=\"body\"><Cell text=\"expr:currow + 1\"/><Cell col=\"1\" displaytype=\"combo\" edittype=\"none\" text=\"bind:DEPT_CODE\" combodataset=\"ds_deptCode\" combocodecol=\"DEPT_CODE\" combodatacol=\"DEPT_NM\"/><Cell col=\"2\" displaytype=\"date\" text=\"bind:APPLC_DE\" calendardisplaynulltype=\"none\"/><Cell col=\"3\" text=\"bind:MLG_CODE\"/><Cell col=\"4\" text=\"bind:MLG_SE\"/><Cell col=\"5\" text=\"bind:MLG_KND\"/><Cell col=\"6\" text=\"bind:MLG_DETAIL\"/><Cell col=\"7\" text=\"bind:MLG_SCORE\"/><Cell col=\"8\" style=\"align:left;padding:0 0 0 5;\" text=\"bind:RM\"/></Band></Format></Formats>");this.div_Cont.AUD040102.T02.addChild(_a.name,_a);_a=new Button("Button01","absolute",null,"5","25","19","0",null,this.div_Cont.AUD040102.T02);_a.set_taborder("1");_a.set_cssclass("btn_WF_Gridexcelup");this.div_Cont.AUD040102.T02.addChild(_a.name,_a);_a=new Button("Button00","absolute",null,"5","25","19","24",null,this.div_Cont.AUD040102.T02);_a.set_taborder("0");_a.set_cssclass("btn_WF_Gridexceldn");this.div_Cont.AUD040102.T02.addChild(_a.name,_a);_a=new Static("Static00","absolute","47","24","999","5",null,null,this.div_Cont.AUD040102.T02);_a.set_taborder("3");_a.set_text("10");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.div_Cont.AUD040102.T02.addChild(_a.name,_a);_a=new Static("Static05","absolute","39","0","999","5",null,null,this.div_Cont.AUD040102.T02);_a.set_taborder("4");_a.set_text("10");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.div_Cont.AUD040102.T02.addChild(_a.name,_a);_a=new Static("sta_gnfdList","absolute","0","5","178","19",null,null,this.div_Cont.AUD040102.T02);_a.set_taborder("5");_a.set_text("부서별 마일리지 목록");_a.set_cssclass("sta_WF_Title02");_a.style.set_align("left middle");this.div_Cont.AUD040102.T02.addChild(_a.name,_a);_a=new Div("div_SearchArea","absolute","0","0",null,"64","28",null,this);_a.set_taborder("0");_a.set_cssclass("div_WFSA_Box");this.addChild(_a.name,_a);_a=new Static("sta_RCEPT_DE","absolute","15","5","60","21",null,null,this.div_SearchArea);_a.set_taborder("7");_a.set_text("접수일자");_a.style.set_align("right middle");_a.set_cssclass("sta_WFSA_Label");this.div_SearchArea.addChild(_a.name,_a);_a=new Calendar("cal_BGN_APPLC_DE","absolute","85","5","110","21",null,null,this.div_SearchArea);this.div_SearchArea.addChild(_a.name,_a);_a.set_taborder("0");_a.set_dateformat("yyyy-MM-dd");_a.set_cssclass("cal_WF_Essential");_a.set_value("null");_a=new Static("Static04","absolute","200","5","10","21",null,null,this.div_SearchArea);_a.set_taborder("8");_a.set_text("~");this.div_SearchArea.addChild(_a.name,_a);_a=new Static("sta_DEPT","absolute","340","5","40","21",null,null,this.div_SearchArea);_a.set_taborder("9");_a.set_text("부서");_a.style.set_align("right middle");_a.set_cssclass("sta_WFSA_Label");this.div_SearchArea.addChild(_a.name,_a);_a=new Button("btn_Search_Dept00","absolute",null,"5","92","21","5",null,this.div_SearchArea);_a.set_taborder("5");_a.set_text("제외대상등록");_a.set_cssclass("btn_WF_Process");this.div_SearchArea.addChild(_a.name,_a);_a=new Div("div_EMP","absolute","676","5","180","21",null,null,this.div_SearchArea);_a.set_taborder("3");_a.set_async("false");_a.set_url("com::empno.xfdl");this.div_SearchArea.addChild(_a.name,_a);_a=new Static("sta_EMPL_SE01","absolute","603","5","60","21",null,null,this.div_SearchArea);_a.set_taborder("10");_a.set_text("사원번호");_a.style.set_align("right middle");_a.set_cssclass("sta_WFSA_Label");this.div_SearchArea.addChild(_a.name,_a);_a=new Div("div_DEPT","absolute","393","5","195","21",null,null,this.div_SearchArea);_a.set_taborder("2");_a.set_async("false");_a.set_url("com::deptCode.xfdl");this.div_SearchArea.addChild(_a.name,_a);_a=new Button("btn_Insert_mlg","absolute",null,"32","92","21","4",null,this.div_SearchArea);_a.set_taborder("4");_a.set_text("마일리지등록");_a.set_cssclass("btn_WF_Process");_a.set_visible("false");this.div_SearchArea.addChild(_a.name,_a);_a=new Static("sta_EMPL_SE00","absolute","15","37","60","21",null,null,this.div_SearchArea);_a.set_taborder("11");_a.set_text("평가항목");_a.set_cssclass("sta_WFSA_Label");_a.style.set_align("right middle");this.div_SearchArea.addChild(_a.name,_a);_a=new Combo("cmb_mlgKnd","absolute","85","36","240","21",null,null,this.div_SearchArea);this.div_SearchArea.addChild(_a.name,_a);_a.set_taborder("6");_a.set_innerdataset("@DS_MLGKND");_a.set_datacolumn("MLG_KND");_a.set_codecolumn("MLG_KND");_a=new Calendar("cal_END_APPLC_DE","absolute","215","5","110","21",null,null,this.div_SearchArea);this.div_SearchArea.addChild(_a.name,_a);_a.set_taborder("1");_a.set_dateformat("yyyy-MM-dd");_a.set_cssclass("cal_WF_Essential");_a=new Layout("default","",1019,698,this.div_Cont.AUD040102.T01,function(_b){_b.set_text("개인별마일리지");});this.div_Cont.AUD040102.T01.addLayout(_a.name,_a);_a=new Layout("default","",0,0,this.div_Cont.AUD040102.T02,function(_b){_b.set_text("부서별마일리지");});this.div_Cont.AUD040102.T02.addLayout(_a.name,_a);_a=new Layout("default","",1031,735,this.div_Cont,function(_b){_b.set_taborder("1");});this.div_Cont.addLayout(_a.name,_a);_a=new Layout("default","",1031,64,this.div_SearchArea,function(_b){_b.set_taborder("0");_b.set_cssclass("div_WFSA_Box");});this.div_SearchArea.addLayout(_a.name,_a);_a=new Layout("default","",1059,735,this,function(_b){_b.set_classname("AUD040102");_b.set_titletext("청렴마일리지등록");});this.addLayout(_a.name,_a);_a=new BindItem("item0","div_SearchArea.cal_BGN_APPLC_DE","value","ds_cond","BGN_APPLC_DE");this.addChild(_a.name,_a);_a.bind();_a=new BindItem("item1","div_SearchArea.cal_END_APPLC_DE","value","ds_cond","END_APPLC_DE");this.addChild(_a.name,_a);_a.bind();_a=new BindItem("item2","div_SearchArea.cmb_mlgKnd","value","ds_cond","MLG_KND");this.addChild(_a.name,_a);_a.bind();_a=null;};this.loadPreloadList=function(){this._addPreloadList("fdl","com::empno.xfdl");this._addPreloadList("fdl","com::deptCode.xfdl");};this.addIncludeScript("AUD040102.xfdl","lib::comInclude.xjs");this.addIncludeScript("AUD040102.xfdl","mis_lib::misUtil.xjs");this.registerScript("AUD040102.xfdl",function(){this.AUD040102_oninit=function(_a,_b){this.fn_init_form();this.fn_init_dataset();};this.AUD040102_onload=function(_a,_b){this.div_SearchArea.div_EMP.fn_setBind("ds_cond","EMPNO","EMPNM");this.div_SearchArea.div_DEPT.fn_setBind("ds_cond","DEPT_CODE");this.ds_cond.clearData();this.ds_cond.addRow();this.ds_cond.setColumn(0,"BGN_APPLC_DE",this.gfn_today().substring(0,4)+'0101');this.ds_cond.setColumn(0,"END_APPLC_DE",this.gfn_today());this.ds_cond.setColumn(0,"MLG_KND","전체");this.fn_select_mlg_regist_list();};this.fn_init_form=function(){this.gfn_initForm(this);this.fn_misFormInit(this);this.ds_cond00.clearData();var _a=this.ds_cond00.addRow();this.ds_cond00.setColumn(_a,"ESTBS_YEAR",this.gfn_today().substring(0,4));this.fn_transaction("selectMlgKnd");this.gfn_comboLoad(comboParams,callback);};this.fn_init_dataset=function(){};this.div_SearchArea_btn_Search_Dept00_onclick=function(_a,_b){var _c=system.clientToScreenX(this,10);var _d=system.clientToScreenY(this,10);var _e=new ChildFrame;_e.init("Popup1","absolute",_c,_d,400,400,null,null,"mis_aud::AUD040102_P01.xfdl");_e.set_openalign("center middle");_e.set_dragmovetype("all");_e.showModal(this.getOwnerFrame(),{},this,"fn_callback2");};this.fn_search=function(_a,_b){this.fn_select_mlg_regist_list();};this.fn_select_mlg_regist_list=function(){if(this.div_SearchArea.div_EMP.GetValue("EMPNO")){var _a=this.div_SearchArea.div_EMP.GetValue("EMPNO");}if(this.div_SearchArea.div_DEPT.GetValue("DEPT_CODE")){var _b=this.div_SearchArea.div_DEPT.GetValue("DEPT_CODE");}if(this.div_Cont.AUD040102.tabindex==0){this.DS_INTGTY_MLG_REGIST.clearData();this.ds_mlgScoreTotList.clearData();this.ds_cond.setColumn(0,"DEPT_INDVDL_SE","1");this.fn_transaction("selectMlgRegistList");}else if(this.div_Cont.AUD040102.tabindex==1){this.DS_INTGTY_MLG_REGIST.clearData();this.ds_cond.setColumn(0,"DEPT_INDVDL_SE","2");this.fn_transaction("selectMlgRegistDeptList");}};this.fn_transaction=function(_a){switch(_a){case "selectMlgKnd":var _b="hsco/mis/aud/AUD040102/selectMlgKnd.do";var _c="input01=ds_cond00";var _d="DS_MLGKND=output01";break;case "MlgRegistListCUD":var _b="hsco/mis/aud/AUD040102/MlgRegistListCUD.do";var _c="input02=DS_INTGTY_MLG_REGIST:U";var _d="";break;case "selectMlgRegistDeptList":var _b="hsco/mis/aud/AUD040102/selectMlgRegistDeptList.do";var _c="input04=ds_cond";var _d="DS_INTGTY_MLG_REGIST=output04";break;case "selectMlgRegistList":var _b="hsco/mis/aud/AUD040102/selectMlgRegistList.do";var _c="input01=ds_cond";var _d="DS_INTGTY_MLG_REGIST=output01";break;case "insertMlgRegistOfTraing":var _b="hsco/mis/aud/AUD040102/insertMlgRegistOfTraing.do";var _c="input01=ds_cond";var _d="DS_INTGTY_MLG_REGIST=output01";break;case "selectDeptCode":this.ds_deptCond.clearData();this.ds_deptCond.addRow();this.ds_deptCond.setColumn(0,"DEPT_CNM","");this.ds_deptCond.setColumn(0,"USE_AT","%");var _b="hsco/mis/hrm/HRM010101/selectDeptList.do";var _c="input1=ds_deptCond";var _d="ds_deptCode=output1";break;case "selectMlgScore":var _b="hsco/mis/aud/AUD040102/selectMlgScore.do";var _c="input1=DS_INTGTY_MLG_REGIST";var _d="ds_mlgScoreTotList=output1";break;}var _e="";Ex.core.tran(this,_a,_b,_c,_d,_e);};this.fn_callBack=function(_a,_b,_c){if(_b==0){switch(_a){case "selectMlgKnd":this.fn_transaction("selectDeptCode");break;case "MlgRegistListCUD":this.fn_select_mlg_regist_list();break;case "insertMlgRegistOfTraing":alert("처리되었습니다.");this.fn_select_mlg_regist_list();break;case "selectMlgScore":break;}}else{this.gfn_callback_message(_a,_b,_c);}};this.fn_insert=function(_a,_b){if(this.div_Cont.AUD040102.tabindex==0){var _c=system.clientToScreenX(this,10);var _d=system.clientToScreenY(this,10);var _e=new ChildFrame;_e.init("Popup2","absolute",_c,_d,700,300,null,null,"mis_aud::AUD040102_P02.xfdl");_e.set_openalign("center middle");_e.set_dragmovetype("all");_e.showModal(this.getOwnerFrame(),{},this,"fn_callback2");}else if(this.div_Cont.AUD040102.tabindex==1){var _c=system.clientToScreenX(this,10);var _d=system.clientToScreenY(this,10);var _e=new ChildFrame;_e.init("Popup3","absolute",_c,_d,700,300,null,null,"mis_aud::AUD040102_P04.xfdl");_e.set_openalign("center middle");_e.set_dragmovetype("all");_e.showModal(this.getOwnerFrame(),{},this,"fn_callback3");}};this.fn_delete=function(_a,_b){if(this.gfn_message("confirm.삭제여부")){var _c=this.DS_INTGTY_MLG_REGIST.rowposition;this.DS_INTGTY_MLG_REGIST.deleteRow(_c);}};this.fn_cancel=function(_a,_b){if(Ex.util.isUpdated(this.DS_INTGTY_MLG_REGIST)){if(this.gfn_message("confirm.취소여부")){this.DS_INTGTY_MLG_REGIST.reset();this.DS_INTGTY_MLG_REGIST.applyChange();return;}}else{this.gfn_message("comm.내역.변경.없음");}};this.fn_save=function(_a,_b){for(var _p=0;_p<this.DS_INTGTY_MLG_REGIST.rowcount;_p++ ){var _c=this.DS_INTGTY_MLG_REGIST.getColumn(_p,"APPLC_YEAR");var _d=this.DS_INTGTY_MLG_REGIST.getColumn(_p,"MLG_CODE");var _e=this.DS_INTGTY_MLG_REGIST.getColumn(_p,"MLG_SE");var _f=this.DS_INTGTY_MLG_REGIST.getColumn(_p,"EMPNO");var _g=this.DS_INTGTY_MLG_REGIST.getColumn(_p,"DEPT_CODE");var _h=this.DS_INTGTY_MLG_REGIST.getColumn(_p,"DEPT_INDVDL_SE");var _i=this.DS_INTGTY_MLG_REGIST.getColumn(_p,"MLG_SCORE");var _j=this.ds_mlgScoreTotList.getColumn(_p,"MXMM_VALUE");var _k=this.ds_mlgScoreTotList.getColumn(_p,"MLG_SCORE_TOT");var _l=nexacro.toNumber(_i)+nexacro.toNumber(_k);var _m=this.ds_mlgScoreTotList.getColumn(_p,"CSBY_ALLOT");var _n=nexacro.toNumber(nexacro.toNumber(_p)+1);if(_h=="1"){var _o=this.DS_INTGTY_MLG_REGIST.findRowExpr("APPLC_YEAR == '"+_c+"' && MLG_CODE == '"+_d+"' && MLG_SE == '"+_e+"' && EMPNO == '"+_f+"'",_n);if(_o> -1){_k+=nexacro.toNumber(this.ds_mlgScoreTotList.getColumn(_o,"MLG_SCORE"));if(_k>_j){this.gfn_message("errors.항목값.범위.이하","적용년도, 코드, 분야, 사원이 중복된 "+(_p+1)+"행과 "+(_o+1)+"행의 점수의 합 + 동분야총점의 합산점수|상한점수");return false;}}}else if(_h=="2"){var _o=this.DS_INTGTY_MLG_REGIST.findRowExpr("APPLC_YEAR == '"+_c+"' && MLG_CODE == '"+_d+"' && MLG_SE == '"+_e+"' && DEPT_CODE == '"+_g+"'",_n);if(_o> -1){_k+=nexacro.toNumber(this.ds_mlgScoreTotList.getColumn(_o,"MLG_SCORE"));if(_k>_j){this.gfn_message("errors.항목값.범위.이하","적용년도, 코드, 분야, 부서가 중복된 "+(_p+1)+"행과 "+(_o+1)+"행의 점수의 합 + 동분야총점의 합산점수|상한점수");return false;}}}if(!this.validationChk(_i,_j,_k,_l,_m,_p)){return false;}}if(this.ds_mlgScoreTotList.rowcount>0){this.DS_INTGTY_MLG_REGIST.set_updatecontrol(false);for(var _p=0;_p<this.DS_INTGTY_MLG_REGIST.rowcount;_p++ ){this.DS_INTGTY_MLG_REGIST.setRowType(_p,2);}this.DS_INTGTY_MLG_REGIST.set_updatecontrol(true);}if(this.gfn_message("confirm.저장.여부")){this.fn_transaction("MlgRegistListCUD");}};this.fn_callback2=function(_a,_b){if(_a=="Popup2"){this.fn_select_mlg_regist_list();}};this.fn_callback3=function(_a,_b){if(_a=="Popup3"){this.fn_select_mlg_regist_list();}};this.div_Cont_AUD040102_T01_grd_INTGTY_MLG_REGIST_oncelldblclick=function(_a,_b){var _c=this.DS_INTGTY_MLG_REGIST.rowposition;var _d=this.DS_INTGTY_MLG_REGIST.getColumn(_c,"MLG_SN");if(this.comUtils.isNull(_d)){this.gfn_message("errors.값확인.요청","저장된 정보가|저장 후 다시");return false;}var _e=system.clientToScreenX(this,10);var _f=system.clientToScreenY(this,10);var _g=new ChildFrame;_g.init("Popup2","absolute",_e,_f,700,300,null,null,"mis_aud::AUD040102_P02.xfdl");_g.set_openalign("center middle");_g.set_dragmovetype("all");_g.showModal(this.getOwnerFrame(),{val_applc_year:this.DS_INTGTY_MLG_REGIST.getColumn(this.DS_INTGTY_MLG_REGIST.rowposition,"APPLC_YEAR"),val_mlg_code:this.DS_INTGTY_MLG_REGIST.getColumn(this.DS_INTGTY_MLG_REGIST.rowposition,"MLG_CODE"),val_mlg_seq_no:this.DS_INTGTY_MLG_REGIST.getColumn(this.DS_INTGTY_MLG_REGIST.rowposition,"MLG_SN")},this,"fn_callback2");};this.div_Cont_AUD040102_onchanged=function(_a,_b){this.fn_select_mlg_regist_list();};this.div_Cont_AUD040102_T02_grd_INTGTY_MLG_REGIST_oncelldblclick=function(_a,_b){var _c=this.DS_INTGTY_MLG_REGIST.rowposition;var _d=this.DS_INTGTY_MLG_REGIST.getColumn(_c,"MLG_SN");if(this.comUtils.isNull(_d)){this.gfn_message("errors.값확인.요청","저장된 정보가|저장 후 다시");return false;}var _e=system.clientToScreenX(this,10);var _f=system.clientToScreenY(this,10);var _g=new ChildFrame;_g.init("Popup3","absolute",_e,_f,700,300,null,null,"mis_aud::AUD040102_P04.xfdl");_g.set_openalign("center middle");_g.set_dragmovetype("all");_g.showModal(this.getOwnerFrame(),{val_applc_year:this.DS_INTGTY_MLG_REGIST.getColumn(this.DS_INTGTY_MLG_REGIST.rowposition,"APPLC_YEAR"),val_mlg_code:this.DS_INTGTY_MLG_REGIST.getColumn(this.DS_INTGTY_MLG_REGIST.rowposition,"MLG_CODE"),val_mlg_seq_no:this.DS_INTGTY_MLG_REGIST.getColumn(this.DS_INTGTY_MLG_REGIST.rowposition,"MLG_SN")},this,"fn_callback3");};this.div_Cont_AUD040102_T01_Button00_onclick=function(_a,_b){this.gfn_exportExcel(this.div_Cont.AUD040102.T01.grd_INTGTY_MLG_REGIST,"grdIntgtyMlgRegist");};this.div_Cont_AUD040102_T01_Button01_onclick=function(_a,_b){this.DS_INTGTY_MLG_REGIST.clearData();var _c={targetDs:this.ds_import,headSet:false,callBack:this.excelImport_callBack1};this.gfn_importExcel(_c);};this.excelImport_callBack1=function(){if(this.ds_import.rowcount>1){var _a;this.DS_INTGTY_MLG_REGIST.updatecontrol=false;for(i=1;i<this.ds_import.rowcount;i++ ){var _b=this.ds_import.getColumn(i,"Column8");var _c=this.ds_import.getColumn(i,"Column9");var _d=this.ds_import.getColumn(i,"Column10");if(!this.comUtils.isNull(_b)&&!this.comUtils.isNull(_c)&&!this.comUtils.isNull(_d)){_a=this.DS_INTGTY_MLG_REGIST.addRow();var _e=this.ds_deptCode.findRow("DEPT_NM",this.ds_import.getColumn(i,"Column1"));if(_e> -1){var _f=this.ds_deptCode.getColumn(_e,"DEPT_CODE");this.DS_INTGTY_MLG_REGIST.setColumn(_a,"DEPT_CODE",_f);}this.DS_INTGTY_MLG_REGIST.setColumn(_a,"EMPNO",this.ds_import.getColumn(i,"Column2"));this.DS_INTGTY_MLG_REGIST.setColumn(_a,"EMPNM",this.ds_import.getColumn(i,"Column3"));this.DS_INTGTY_MLG_REGIST.setColumn(_a,"JSSFC_NM",this.ds_import.getColumn(i,"Column4"));this.DS_INTGTY_MLG_REGIST.setColumn(_a,"HR_CLSF_NM",this.ds_import.getColumn(i,"Column5"));this.DS_INTGTY_MLG_REGIST.setColumn(_a,"OFCPS_NM",this.ds_import.getColumn(i,"Column6"));this.DS_INTGTY_MLG_REGIST.setColumn(_a,"JBLN_NM",this.ds_import.getColumn(i,"Column7"));this.DS_INTGTY_MLG_REGIST.setColumn(_a,"APPLC_DE",this.ds_import.getColumn(i,"Column8"));var _g=this.DS_INTGTY_MLG_REGIST.getColumn(_a,"APPLC_DE");var _h=_g.replace(/[-]/g,"");this.DS_INTGTY_MLG_REGIST.setColumn(_a,"APPLC_DE",_h);this.DS_INTGTY_MLG_REGIST.setColumn(_a,"APPLC_YEAR",_h.substring(0,4));this.DS_INTGTY_MLG_REGIST.setColumn(_a,"MLG_CODE",this.ds_import.getColumn(i,"Column9"));this.DS_INTGTY_MLG_REGIST.setColumn(_a,"MLG_SE",this.ds_import.getColumn(i,"Column10"));this.DS_INTGTY_MLG_REGIST.setColumn(_a,"MLG_KND",this.ds_import.getColumn(i,"Column11"));this.DS_INTGTY_MLG_REGIST.setColumn(_a,"MLG_DETAIL",this.ds_import.getColumn(i,"Column12"));this.DS_INTGTY_MLG_REGIST.setColumn(_a,"MLG_SCORE",this.ds_import.getColumn(i,"Column13"));this.DS_INTGTY_MLG_REGIST.setColumn(_a,"RM",this.ds_import.getColumn(i,"Column14"));this.DS_INTGTY_MLG_REGIST.setColumn(_a,"DEPT_INDVDL_SE","1");this.DS_INTGTY_MLG_REGIST.setRowType(_a,Dataset.ROWTYPE_INSERT);}}this.DS_INTGTY_MLG_REGIST.updatecontrol=true;this.fn_transaction("selectMlgScore");}};this.div_Cont_AUD040102_T02_Button00_onclick=function(_a,_b){this.gfn_exportExcel(this.div_Cont.AUD040102.T02.grd_INTGTY_MLG_REGIST,"grdIntgtyMlgRegist");};this.div_Cont_AUD040102_T02_Button01_onclick=function(_a,_b){this.DS_INTGTY_MLG_REGIST.clearData();var _c={targetDs:this.ds_import2,headSet:false,callBack:this.excelImport_callBack2};this.gfn_importExcel(_c);};this.excelImport_callBack2=function(){if(this.ds_import2.rowcount>1){var _a;this.DS_INTGTY_MLG_REGIST.updatecontrol=false;for(i=1;i<this.ds_import2.rowcount;i++ ){_a=this.DS_INTGTY_MLG_REGIST.addRow();var _b=this.ds_deptCode.findRow("DEPT_NM",this.ds_import2.getColumn(i,"Column1"));if(_b> -1){var _c=this.ds_deptCode.getColumn(_b,"DEPT_CODE");this.DS_INTGTY_MLG_REGIST.setColumn(_a,"DEPT_CODE",_c);}this.DS_INTGTY_MLG_REGIST.setColumn(_a,"APPLC_DE",this.ds_import2.getColumn(i,"Column2"));var _d=this.DS_INTGTY_MLG_REGIST.getColumn(_a,"APPLC_DE");var _e=_d.replace(/[-]/g,"");this.DS_INTGTY_MLG_REGIST.setColumn(_a,"APPLC_DE",_e);this.DS_INTGTY_MLG_REGIST.setColumn(_a,"MLG_CODE",this.ds_import2.getColumn(i,"Column3"));this.DS_INTGTY_MLG_REGIST.setColumn(_a,"MLG_SE",this.ds_import2.getColumn(i,"Column4"));this.DS_INTGTY_MLG_REGIST.setColumn(_a,"MLG_KND",this.ds_import2.getColumn(i,"Column5"));this.DS_INTGTY_MLG_REGIST.setColumn(_a,"MLG_DETAIL",this.ds_import2.getColumn(i,"Column6"));this.DS_INTGTY_MLG_REGIST.setColumn(_a,"MLG_SCORE",this.ds_import2.getColumn(i,"Column7"));this.DS_INTGTY_MLG_REGIST.setColumn(_a,"RM",this.ds_import2.getColumn(i,"Column8"));this.DS_INTGTY_MLG_REGIST.setColumn(_a,"DEPT_INDVDL_SE","2");this.DS_INTGTY_MLG_REGIST.setColumn(_a,"APPLC_YEAR",_e.substring(0,4));this.DS_INTGTY_MLG_REGIST.setRowType(_a,Dataset.ROWTYPE_INSERT);}this.DS_INTGTY_MLG_REGIST.updatecontrol=true;this.fn_transaction("selectMlgScore");}};this.div_SearchArea_btn_Insert_mlg_onclick=function(_a,_b){this.fn_transaction("insertMlgRegistOfTraing");};this.validationChk=function(_a,_b,_c,_d,_e,_f){var _g=_a;var _h=_b;var _i=_c;var _j=_d;var _k=_e;var _l=nexacro.toNumber(nexacro.toNumber(_f)+1)+"행의 ";trace("mlgScore : "+_g+", mxmmValue : "+_h+", mlgScoreTot : "+_i+", val_tot : "+_j+", csbyAllot : "+_k);if(_k>=0){if(_g<0){this.gfn_message("errors.항목값.범위.이상",_l+"점수|0");return false;}if(_g>nexacro.toNumber(_k)){this.gfn_message("errors.항목값.범위.이하",_l+"점수|배점");return false;}if(_j>_h){this.gfn_message("errors.항목값.범위.이하",_l+"점수와 동분야총점의 합산점수|상한점수");return false;}}else if(_k<0){if(_g>0){this.gfn_message("errors.항목값.범위.미만",_l+"점수|0");return false;}if(_g<_k){this.gfn_message("errors.항목값.범위.이상",_l+"점수|배점");return false;}if(_j<_h){this.gfn_message("errors.항목값.범위.이상",_l+"점수와 동분야총점의 합산점수|상한점수");return false;}}return true;};});this.on_initEvent=function(){this.addEventHandler("onload",this.AUD040102_onload,this);this.addEventHandler("oninit",this.AUD040102_oninit,this);this.div_Cont.AUD040102.addEventHandler("onchanged",this.div_Cont_AUD040102_onchanged,this);this.div_Cont.AUD040102.T01.grd_INTGTY_MLG_REGIST.addEventHandler("oncelldblclick",this.div_Cont_AUD040102_T01_grd_INTGTY_MLG_REGIST_oncelldblclick,this);this.div_Cont.AUD040102.T01.Button00.addEventHandler("onclick",this.div_Cont_AUD040102_T01_Button00_onclick,this);this.div_Cont.AUD040102.T01.Button01.addEventHandler("onclick",this.div_Cont_AUD040102_T01_Button01_onclick,this);this.div_Cont.AUD040102.T02.grd_INTGTY_MLG_REGIST.addEventHandler("oncelldblclick",this.div_Cont_AUD040102_T02_grd_INTGTY_MLG_REGIST_oncelldblclick,this);this.div_Cont.AUD040102.T02.Button01.addEventHandler("onclick",this.div_Cont_AUD040102_T02_Button01_onclick,this);this.div_Cont.AUD040102.T02.Button00.addEventHandler("onclick",this.div_Cont_AUD040102_T02_Button00_onclick,this);this.div_SearchArea.cal_BGN_APPLC_DE.addEventHandler("onchanged",this.div_SearchArea_cal_BGN_ASK_DE_onchanged,this);this.div_SearchArea.btn_Search_Dept00.addEventHandler("onclick",this.div_SearchArea_btn_Search_Dept00_onclick,this);this.div_SearchArea.div_EMP.addEventHandler("onkeyup",this.div_SEARCH_div_EMP_onkeyup,this);this.div_SearchArea.btn_Insert_mlg.addEventHandler("onclick",this.div_SearchArea_btn_Insert_mlg_onclick,this);this.div_SearchArea.cal_END_APPLC_DE.addEventHandler("onchanged",this.div_SearchArea_cal_END_ASK_DE_onchanged,this);};this.loadIncludeScript("AUD040102.xfdl");this.loadPreloadList();};})();