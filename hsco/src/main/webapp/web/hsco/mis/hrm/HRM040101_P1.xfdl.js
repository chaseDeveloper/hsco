(function(){return function(){if(!this._is_form){return;}this.on_create=function(){var _a=null;if(Form==this.constructor){this.set_name("HRM040101_P1");this.set_classname("HRM040101_P1");this.set_titletext("직원표창현황");this.set_scrollbars("none");this._setFormPosition(0,0,1080,750);}_a=new Dataset("ds_cond_pop",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"DEPT_CODE\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_deptCode",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"DEPT_CODE\" type=\"STRING\" size=\"256\"/><Column id=\"DEPT_NM\" type=\"STRING\" size=\"256\"/><Column id=\"DEPT_NM2\" type=\"STRING\" size=\"256\"/><Column id=\"DEPT_SE\" type=\"STRING\" size=\"256\"/><Column id=\"UPPER_DEPT_CODE\" type=\"STRING\" size=\"256\"/><Column id=\"LVL\" type=\"STRING\" size=\"256\"/><Column id=\"TEAM_CNT\" type=\"STRING\" size=\"256\"/><Column id=\"EMPNO\" type=\"STRING\" size=\"256\"/><Column id=\"EMPNM\" type=\"STRING\" size=\"256\"/><Column id=\"JSSFC_SE\" type=\"STRING\" size=\"256\"/><Column id=\"JSSFC_SE_NM\" type=\"STRING\" size=\"256\"/><Column id=\"HR_CLSF_SE\" type=\"STRING\" size=\"256\"/><Column id=\"HR_CLSF_SE_NM\" type=\"STRING\" size=\"256\"/><Column id=\"RSPOFC_SE\" type=\"STRING\" size=\"256\"/><Column id=\"RSPOFC_SE_NM\" type=\"STRING\" size=\"256\"/><Column id=\"LXTN_NO\" type=\"STRING\" size=\"256\"/><Column id=\"RWARD_DETAIL1\" type=\"STRING\" size=\"256\"/><Column id=\"RWARD_DETAIL2\" type=\"STRING\" size=\"256\"/><Column id=\"OPERTN_OFFIC_DETAIL1\" type=\"STRING\" size=\"256\"/><Column id=\"OPERTN_OFFIC_DETAIL2\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_teamCode",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"DEPT_CODE\" type=\"STRING\" size=\"256\"/><Column id=\"TEAM_CODE\" type=\"STRING\" size=\"256\"/><Column id=\"TEAM_NM\" type=\"STRING\" size=\"256\"/><Column id=\"TEAM_NM2\" type=\"STRING\" size=\"256\"/><Column id=\"UPPER_TEAM_CODE\" type=\"STRING\" size=\"256\"/><Column id=\"USE_AT\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_teamConstnt",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"CHK\" type=\"STRING\" size=\"256\"/><Column id=\"DEPT_CODE\" type=\"STRING\" size=\"256\"/><Column id=\"TEAM_CODE\" type=\"STRING\" size=\"256\"/><Column id=\"EMPNO\" type=\"STRING\" size=\"256\"/><Column id=\"EMPNM\" type=\"STRING\" size=\"256\"/><Column id=\"JSSFC_SE\" type=\"STRING\" size=\"256\"/><Column id=\"JSSFC_SE_NM\" type=\"STRING\" size=\"256\"/><Column id=\"HR_CLSF_SE\" type=\"STRING\" size=\"256\"/><Column id=\"HR_CLSF_SE_NM\" type=\"STRING\" size=\"256\"/><Column id=\"RSPOFC_SE\" type=\"STRING\" size=\"256\"/><Column id=\"RSPOFC_SE_NM\" type=\"STRING\" size=\"256\"/><Column id=\"LXTN_NO\" type=\"STRING\" size=\"256\"/><Column id=\"TELNO_2\" type=\"STRING\" size=\"256\"/><Column id=\"OFCPSCD_NM\" type=\"STRING\" size=\"256\"/><Column id=\"RWARD_DETAIL1\" type=\"STRING\" size=\"256\"/><Column id=\"RWARD_DETAIL2\" type=\"STRING\" size=\"256\"/><Column id=\"OPERTN_OFFIC_DETAIL1\" type=\"STRING\" size=\"256\"/><Column id=\"OPERTN_OFFIC_DETAIL2\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_data",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("");this.addChild(_a.name,_a);_a=new Dataset("ds_executive",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"EMPNO\" type=\"STRING\" size=\"256\"/><Column id=\"EMPNM\" type=\"STRING\" size=\"256\"/><Column id=\"JSSFC_SE\" type=\"STRING\" size=\"256\"/><Column id=\"JSSFC_SE_NM\" type=\"STRING\" size=\"256\"/><Column id=\"HR_CLSF_SE\" type=\"STRING\" size=\"256\"/><Column id=\"HR_CLSF_SE_NM\" type=\"STRING\" size=\"256\"/><Column id=\"RSPOFC_SE\" type=\"STRING\" size=\"256\"/><Column id=\"RSPOFC_SE_NM\" type=\"STRING\" size=\"256\"/><Column id=\"LXTN_NO\" type=\"STRING\" size=\"256\"/><Column id=\"TELNO_2\" type=\"STRING\" size=\"256\"/><Column id=\"OFCPSCD_NM\" type=\"STRING\" size=\"256\"/><Column id=\"RWARD_DETAIL1\" type=\"STRING\" size=\"256\"/><Column id=\"RWARD_DETAIL2\" type=\"STRING\" size=\"256\"/><Column id=\"OPERTN_OFFIC_DETAIL1\" type=\"STRING\" size=\"256\"/><Column id=\"OPERTN_OFFIC_DETAIL2\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Grid("grd","absolute","15","76",null,null,"15","15",this);_a.set_taborder("0");_a.set_binddataset("ds_data");_a.set_autoenter("select");_a.set_cellsizingtype("col");_a.set_autoupdatetype("comboselect");_a.set_treeinitstatus("expand,all");_a.set_treeusecheckbox("false");_a.set_selecttype("cell");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"40\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"24\"/></Rows><Band id=\"head\"><Cell/></Band><Band id=\"body\"><Cell/></Band></Format></Formats>");this.addChild(_a.name,_a);_a=new Static("Static06","absolute","15","0",null,"15","15",null,this);_a.set_taborder("3");_a.set_text("15");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Static("Static05","absolute","0","0","15",null,null,"0",this);_a.set_taborder("4");_a.set_text("15");_a.set_visible("false");_a.style.set_background("#1b3cd23c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Static("Static00","absolute",null,"0","15",null,"0","0",this);_a.set_taborder("5");_a.set_text("15");_a.set_visible("false");_a.style.set_background("#1b3cd23c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Button("btn_close","absolute",null,"15","50","25","15",null,this);_a.set_taborder("18");_a.set_text("종료");_a.set_cssclass("btn_WF_CRUD");this.addChild(_a.name,_a);_a=new Static("Static11","absolute","15","40",null,"10","15",null,this);_a.set_taborder("19");_a.set_text("10");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Button("btn_search","absolute",null,"15","50","25","68",null,this);_a.set_taborder("25");_a.set_text("조회");_a.set_cssclass("btn_WF_CRUD");this.addChild(_a.name,_a);_a=new Static("Static04","absolute","15","50","92","21",null,null,this);_a.set_taborder("28");_a.set_text("현황");_a.set_cssclass("sta_WF_Title02");this.addChild(_a.name,_a);_a=new Static("Static01","absolute","15","71",null,"5","15",null,this);_a.set_taborder("29");_a.set_text("5");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Static("Static02","absolute","15",null,null,"15","15","0",this);_a.set_taborder("30");_a.set_text("15");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Static("sta_acntCode","absolute","15","20","400","19",null,null,this);_a.set_taborder("34");_a.set_cssclass("sta_WF_Title01");this.addChild(_a.name,_a);_a=new Button("btn_excel","absolute",null,"50","102","21","15",null,this);_a.set_taborder("35");_a.set_text("엑셀파일 전환");this.addChild(_a.name,_a);_a=new Layout("default","",1080,750,this,function(_b){_b.set_classname("HRM040101_P1");_b.set_titletext("직원표창현황");_b.set_scrollbars("none");});this.addLayout(_a.name,_a);_a=null;};this.addIncludeScript("HRM040101_P1.xfdl","lib::comInclude.xjs");this.addIncludeScript("HRM040101_P1.xfdl","mis_lib::misUtil.xjs");this.registerScript("HRM040101_P1.xfdl",function(){var _a="";this.HRM040101_P1_oninit=function(_b,_c){this.fn_init_form();this.fn_init_dataset();};this.HRM040101_P1_onload=function(_b,_c){};this.fn_init_form=function(){this.gfn_initForm(this);this.fn_misFormInit(this);this.ds_cond_pop.clearData();var _b=this.ds_cond_pop.addRow();_a=this.getOwnerFrame().type;if(_a=="RWARD_CNFER"){this.sta_acntCode.set_text("직원표창현황");}else{this.sta_acntCode.set_text("직원연수현황");this.set_titletext("직원연수현황");}this.fn_search();};this.fn_init_dataset=function(){};this.fn_search=function(){this.ds_deptCode.clearData();this.ds_teamCode.clearData();this.ds_teamConstnt.clearData();this.fn_transaction("select");};this.fn_transaction=function(_b){switch(_b){case "select":var _c="hsco/mis/hrm/HRM040101_P1/select.do";var _d="input1=ds_cond_pop";var _e="ds_deptCode=output1 ds_teamCode=output2 ds_teamConstnt=output3 ds_executive=output4";break;}Ex.core.tran(this,_b,_c,_d,_e);};this.fn_callBack=function(_b,_c,_d){if(_c!=0){this.gfn_callback_message(_b,_c,_d);}if(_c==0){switch(_b){case "select":this.fn_makeGrid();break;}}};this.btn_search_onclick=function(_b,_c){this.fn_search();};this.btn_close_onclick=function(_b,_c){this.close();};this.fn_makeGrid=function(){this.ds_deptCode.set_enableevent(false);this.ds_teamCode.set_enableevent(false);this.ds_teamConstnt.set_enableevent(false);this.ds_data.set_enableevent(false);this.grd.set_enableevent(false);try{this.grd.createFormat();var _b=this.grd.appendContentsRow("head");var _c=this.grd.appendContentsRow("head");var _d=this.grd.appendContentsRow("head");var _e=this.grd.appendContentsRow("head");this.grd.setFormatRowProperty(_b,"size",40);this.grd.setFormatRowProperty(_c,"size",40);this.grd.setFormatRowProperty(_d,"size",40);this.grd.setFormatRowProperty(_e,"size",40);this.grd.setCellProperty("Head",0,"background","#ffffffff");this.grd.setCellProperty("Head",0,"background2","#ffffffff");this.grd.setCellProperty("Head",0,"line","1 solid #ffffffff, 1 solid #dedee0ff");this.grd.setCellProperty("Head",0+this.grd.getFormatColCount(),"background","#ffffffff");this.grd.setCellProperty("Head",0+this.grd.getFormatColCount(),"background2","#ffffffff");this.grd.setCellProperty("Head",0+this.grd.getFormatColCount(),"line","1 solid #ffffffff, 1 solid #dedee0ff");this.grd.setCellProperty("Head",0+this.grd.getFormatColCount()*2,"background","#ffffffff");this.grd.setCellProperty("Head",0+this.grd.getFormatColCount()*2,"background2","#ffffffff");this.grd.setCellProperty("Head",0+this.grd.getFormatColCount()*2,"line","1 solid #ffffffff, 1 solid #dedee0ff");this.grd.setCellProperty("Head",0+this.grd.getFormatColCount()*3,"background","#ffffffff");this.grd.setCellProperty("Head",0+this.grd.getFormatColCount()*3,"background2","#ffffffff");this.grd.setCellProperty("Head",0+this.grd.getFormatColCount()*3,"line","1 solid #ffffffff, 1 solid #dedee0ff");var _f=this.grd.appendContentsRow("head");var _g=this.grd.appendContentsRow("head");var _h=this.grd.appendContentsRow("head");var _i=this.grd.appendContentsRow("head");var _j=this.grd.appendContentsRow("head");var _k=this.grd.appendContentsRow("body");this.grd.setFormatRowProperty(_f,"size",40);this.grd.setFormatRowProperty(_g,"size",40);this.grd.setFormatRowProperty(_h,"size",40);this.grd.setFormatRowProperty(_i,"size",40);this.grd.setFormatRowProperty(_j,"size",40);this.grd.setFormatRowProperty(_k,"size",40);this.grd.setFormatColProperty(0,"size",10);this.grd.setCellProperty("Head",0+this.grd.getFormatColCount()*4,"background","#ffffffff");this.grd.setCellProperty("Head",0+this.grd.getFormatColCount()*4,"background2","#ffffffff");this.grd.setCellProperty("Head",0+this.grd.getFormatColCount()*4,"line","1 solid #ffffffff, 1 solid #dedee0ff");this.grd.setCellProperty("Head",0+this.grd.getFormatColCount()*5,"background","#ffffffff");this.grd.setCellProperty("Head",0+this.grd.getFormatColCount()*5,"background2","#ffffffff");this.grd.setCellProperty("Head",0+this.grd.getFormatColCount()*5,"line","1 solid #ffffffff, 1 solid #dedee0ff");this.grd.setCellProperty("Head",0+this.grd.getFormatColCount()*6,"background","#ffffffff");this.grd.setCellProperty("Head",0+this.grd.getFormatColCount()*6,"background2","#ffffffff");this.grd.setCellProperty("Head",0+this.grd.getFormatColCount()*6,"line","1 solid #ffffffff, 1 solid #dedee0ff");this.grd.setCellProperty("Head",0+this.grd.getFormatColCount()*7,"background","#ffffffff");this.grd.setCellProperty("Head",0+this.grd.getFormatColCount()*7,"background2","#ffffffff");this.grd.setCellProperty("Head",0+this.grd.getFormatColCount()*7,"line","1 solid #ffffffff, 1 solid #dedee0ff");this.grd.setCellProperty("Head",0+this.grd.getFormatColCount()*8,"background","#ffffffff");this.grd.setCellProperty("Head",0+this.grd.getFormatColCount()*9,"background2","#ffffffff");var _l=0;for(var _an=0;_an<this.ds_deptCode.getRowCount();_an++ ){var _m=this.ds_deptCode.getColumn(_an,"LVL");if(_m==1){continue;}var _n=this.ds_deptCode.getColumn(_an,"DEPT_CODE");var _o=this.ds_deptCode.getColumn(_an,"DEPT_NM");var _p=nexacro.toNumber(this.ds_deptCode.getColumn(_an,"TEAM_CNT"),0,0,0);var _q=this.ds_deptCode.getColumn(_an,"EMPNO");var _r=this.ds_deptCode.getColumn(_an,"EMPNM");var _s=this.ds_deptCode.getColumn(_an,"RSPOFC_SE_NM");var _t;var _u;if(_a=="RWARD_CNFER"){_t=this.ds_deptCode.getColumn(_an,"RWARD_DETAIL1");_u=this.ds_deptCode.getColumn(_an,"RWARD_DETAIL2");}else{_t=this.ds_deptCode.getColumn(_an,"OPERTN_OFFIC_DETAIL1");_u=this.ds_deptCode.getColumn(_an,"OPERTN_OFFIC_DETAIL2");}var _v=String.fromCharCode(10);var _w=_s+_v+_r;if(!_q){_w="";_t="";_u="";}if(_t!=null&&_t!=""){_t=_t.replace(/\\n/g,_v);}if(_u!=null&&_u!=""){_u=_u.replace(/\\n/g,_v);}if(_p>0){for(var _ao=0;_ao<this.ds_teamCode.getRowCount();_ao++ ){var _x=this.ds_teamCode.getColumn(_ao,"DEPT_CODE");if(_n==_x){var _y=this.ds_teamCode.getColumn(_ao,"TEAM_CODE");var _z=this.ds_teamCode.getColumn(_ao,"TEAM_NM");this.ds_data.addColumn("d_"+_n+_y);var _aa=this.grd.appendContentsCol();var _ab=nexacro.toNumber(_n.length,0)*15<100?100:nexacro.toNumber(_n.length,0)*15;this.grd.setFormatColProperty(_aa,"size",_ab);var _ac="";var _ad="";var _ae="";var _af="";if(_l<this.ds_executive.rowcount){var _q=this.ds_executive.getColumn(_l,"EMPNO");var _r=this.ds_executive.getColumn(_l,"EMPNM");var _af=this.ds_executive.getColumn(_l,"RSPOFC_SE_NM");if(_a=="RWARD_CNFER"){_ad=this.ds_executive.getColumn(_l,"RWARD_DETAIL1");_ae=this.ds_executive.getColumn(_l,"RWARD_DETAIL2");}else{_ad=this.ds_executive.getColumn(_l,"OPERTN_OFFIC_DETAIL1");_ae=this.ds_executive.getColumn(_l,"OPERTN_OFFIC_DETAIL2");}var _v=String.fromCharCode(10);var _ac=_r;if(!_q){_ac="";_ad="";_ae="";}if(_ad!=null&&_ad!=""){_ad=_ad.replace(/\\n/g,_v);}if(_ae!=null&&_ae!=""){_ae=_ae.replace(/\\n/g,_v);}_l++ ;}this.grd.setCellProperty("Head",_aa,"text",_af);this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount(),"text",_ac);this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*2,"text",_ad);this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*3,"text",_ae);this.grd.setCellProperty("Head",_aa,"line","1 solid #dedee0ff, 1 solid #dedee0ff");this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount(),"font","9 Gulim");this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*2,"font","9 Gulim");this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*3,"font","9 Gulim");this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*4,"line","1 solid #dedee0ff, 1 solid #dedee0ff");this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount(),"background","#ffffffff");this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount(),"background2","#ffffffff");this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*2,"background","paleturquoise");this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*2,"background2","paleturquoise");this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*3,"background","mistyrose");this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*3,"background2","mistyrose");this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*4,"text",_o);this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*5,"text",_w);this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*6,"text",_t);this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*7,"text",_u);this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*8,"text",_z);this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*4,"line","1 solid #dedee0ff, 1 solid #dedee0ff");this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*5,"font","9 Gulim");this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*6,"font","9 Gulim");this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*7,"font","9 Gulim");this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*8,"line","1 solid #dedee0ff, 1 solid #dedee0ff");this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*5,"background","#ffffffff");this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*5,"background2","#ffffffff");this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*6,"background","paleturquoise");this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*6,"background2","paleturquoise");this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*7,"background","mistyrose");this.grd.setCellProperty("Head",_aa+this.grd.getFormatColCount()*7,"background2","mistyrose");this.grd.setCellProperty("Body",_aa,"text","bind:"+"d_"+_n+_y);}}}var _ag=this.grd.appendContentsCol();this.grd.setFormatColProperty(_ag,"size",10);this.grd.setCellProperty("Head",_ag,"background","#ffffffff");this.grd.setCellProperty("Head",_ag,"background2","#ffffffff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount(),"background","#ffffffff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount(),"background2","#ffffffff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount()*2,"background","#ffffffff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount()*2,"background2","#ffffffff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount()*3,"background","#ffffffff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount()*3,"background2","#ffffffff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount()*4,"background","#ffffffff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount()*4,"background2","#ffffffff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount()*5,"background","#ffffffff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount()*5,"background2","#ffffffff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount()*5,"background","#ffffffff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount()*5,"background2","#ffffffff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount()*6,"background","#ffffffff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount()*6,"background2","#ffffffff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount()*7,"background","#ffffffff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount()*7,"background2","#ffffffff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount()*8,"background","#ffffffff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount()*8,"background2","#ffffffff");this.grd.setCellProperty("Head",_ag,"line","1 solid #ffffffff, 1 solid #dedee0ff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount(),"line","1 solid #ffffffff, 1 solid #dedee0ff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount()*2,"line","1 solid #ffffffff, 1 solid #dedee0ff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount()*4,"line","1 solid #ffffffff, 1 solid #dedee0ff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount()*5,"line","1 solid #ffffffff, 1 solid #dedee0ff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount()*6,"line","1 solid #ffffffff, 1 solid #dedee0ff");this.grd.setCellProperty("Head",_ag+this.grd.getFormatColCount()*7,"line","1 solid #ffffffff, 1 solid #dedee0ff");}for(var _ap=0;_ap<this.ds_teamConstnt.getRowCount();_ap++ ){var _q=this.ds_teamConstnt.getColumn(_ap,"EMPNO");var _r=this.ds_teamConstnt.getColumn(_ap,"EMPNM");var _ah=this.comUtils.isNullThen(this.ds_teamConstnt.getColumn(_ap,"OFCPSCD_NM")," ");var _n=this.ds_teamConstnt.getColumn(_ap,"DEPT_CODE");var _y=this.ds_teamConstnt.getColumn(_ap,"TEAM_CODE");if(!_y){_y="00";}var _t;var _u;if(_a=="RWARD_CNFER"){_t=this.ds_teamConstnt.getColumn(_ap,"RWARD_DETAIL1");_u=this.ds_teamConstnt.getColumn(_ap,"RWARD_DETAIL2");}else{_t=this.ds_teamConstnt.getColumn(_ap,"OPERTN_OFFIC_DETAIL1");_u=this.ds_teamConstnt.getColumn(_ap,"OPERTN_OFFIC_DETAIL2");}var _v=String.fromCharCode(10);var _w=_s+_v+_r;if(!_q){_w="";_t="";_u="";}else{if(_t!=null&&_t!=""){_t=_t.replace(/\\n/g,_v);}else{_t=" ";}if(_u!=null&&_u!=""){_u=_u.replace(/\\n/g,_v);}else{_u=" ";}}var _v=String.fromCharCode(10);var _w=_ah+_v+_r;if(!_q){_w="";}var _ai=this.ds_data.findRowExpr("d_"+_n+_y+" == null");if(_ai== -1){var _aj=this.ds_data.addRow();this.ds_data.setColumn(_aj,"d_"+_n+_y,_w);var _ak=this.ds_data.addRow();this.ds_data.setColumn(_ak,"d_"+_n+_y,_t);var _al=this.ds_data.addRow();this.ds_data.setColumn(_al,"d_"+_n+_y,_u);}else{this.ds_data.setColumn(_ai,"d_"+_n+_y,_w);this.ds_data.setColumn(_ai+1,"d_"+_n+_y,_t);this.ds_data.setColumn(_ai+2,"d_"+_n+_y,_u);}}var _am=0;for(var _aq=0;_aq<this.grd.getFormatColCount();_aq++ ){if(this.grd.getCellProperty("Head",_aq+this.grd.getFormatColCount()*8,"background")!="#ffffffff"){this.grd.setCellProperty('Body',_aq,'background','EXPR(currow%3==0?"#ffffffff":currow%3==1?(dataset.getColumn(currow-1,dataset.getColID('+_am+'))==null?"#ffffffff":"paleturquoise"):(dataset.getColumn(currow-2,dataset.getColID('+_am+'))==null?"#ffffffff":"mistyrose"))');this.grd.setCellProperty('Body',_aq,'background2','EXPR(currow%3==0?"#ffffffff":currow%3==1?(dataset.getColumn(currow-1,dataset.getColID('+_am+'))==null?"#ffffffff":"paleturquoise"):(dataset.getColumn(currow-2,dataset.getColID('+_am+'))==null?"#ffffffff":"mistyrose"))');_am++ ;}}this.fn_mergeCell('7');this.fn_mergeCell('6');this.fn_mergeCell('5');this.fn_mergeCell('4');this.grd.mergeContentsCell("Head",0,this.ds_executive.rowcount+2,3,this.grd.getFormatColCount()-2,this.ds_executive.rowcount+2,false);this.grd.setCellProperty("Head",this.ds_executive.rowcount+2,"background","#ffffffff");this.grd.setCellProperty("Head",this.ds_executive.rowcount+2,"background2","#ffffffff");this.grd.setCellProperty("Head",this.ds_executive.rowcount+2,"line","1 solid #dedee0ff, 1 solid #dedee0ff");}catch(e){alert(e.message);}this.ds_deptCode.set_enableevent(true);this.ds_teamCode.set_enableevent(true);this.ds_teamConstnt.set_enableevent(true);this.ds_data.set_enableevent(true);this.grd.set_enableevent(true);this.ds_data.set_rowposition(0);};this.Button00_onclick=function(_b,_c){this.fn_exportExcel(this.grd,"excelFile");};this.fn_exportExcel=function(_b,_c,_d){this.setWaitCursor(true,true);var _e="obj_commonExport";var _f=new ExcelExportObject();var _g=new Date();var _h;var _i=application.services["svcurl"].url+"XExportImport.do";var _j="";_f.set_name(_e);_f.addEventHandler("onsuccess",this._gfn_exportExcelEnd,this);_f.addEventHandler("onerror",this._gfn_exportExcelEndError,this);_f.clearExportItems(nexacro.ExportTypes.EXCEL2007);if(!this.comUtils.isNullEmpty(_c)){_c=_g.getTime()+"_"+_c;}else{_c=_g.getTime();}if(_b instanceof Grid){_h="Sheet1!A1";_f.addExportItem(nexacro.ExportItemTypes.GRID,_b,_h,"allband","allrecord","suppress","onlyvalue","none","color","both","cellline");}else{for(var _l=0;_l<_b.length;_l++ ){_h="A"+(_l+1);oGrid=obj[_l];_f.addExportItem(nexacro.ExportItemTypes.GRID,_b,_h+"!A1","allband","allrecord","suppress","none","background","font","both");}}_f.set_exporttype(nexacro.ExportTypes.EXCEL2007);_f.set_exportfilename(_c);_f.set_exporturl(_i);if(!_d){_j="cntn_file=N";}else{_j="cntn_file=Y svcurl="+application.services["svcurl"].url+" extrSantn="+_d;}var _k=_f.exportData(_j);};this.fn_mergeCell=function(_b){var _c= -1;for(var _g=this.grd.getFormatColCount()*5-1;_g>=this.grd.getFormatColCount()*4;_g-- ){var _d=this.grd.getCellProperty("Head",_g-1,"text");var _e=this.grd.getCellProperty("Head",_g,"text");var _f=this.grd.getCellProperty("Head",_g+1,"text");if(this.comUtils.isNullEmpty(_f)&&_e==_d&&_c== -1){_c=_g;}if(this.comUtils.isNullEmpty(_d)&&_c!= -1){if(_b=='4'){this.grd.mergeContentsCell("Head",4,_g-this.grd.getFormatColCount()*4,4,_c-this.grd.getFormatColCount()*4,_g,false);}else if(_b=='5'){this.grd.mergeContentsCell("Head",5,_g-this.grd.getFormatColCount()*4,5,_c-this.grd.getFormatColCount()*4,_g+this.grd.getFormatColCount(),false);}else if(_b=='6'){this.grd.mergeContentsCell("Head",6,_g-this.grd.getFormatColCount()*4,6,_c-this.grd.getFormatColCount()*4,_g+this.grd.getFormatColCount()*2,false);}else if(_b=='7'){this.grd.mergeContentsCell("Head",7,_g-this.grd.getFormatColCount()*4,7,_c-this.grd.getFormatColCount()*4,_g+this.grd.getFormatColCount()*3,false);}_c= -1;}}};});this.on_initEvent=function(){this.addEventHandler("onload",this.HRM040101_P1_onload,this);this.addEventHandler("oninit",this.HRM040101_P1_oninit,this);this.btn_close.addEventHandler("onclick",this.btn_close_onclick,this);this.btn_search.addEventHandler("onclick",this.btn_search_onclick,this);this.btn_excel.addEventHandler("onclick",this.Button00_onclick,this);};this.loadIncludeScript("HRM040101_P1.xfdl");};})();