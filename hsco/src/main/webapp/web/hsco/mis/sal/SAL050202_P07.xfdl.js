(function(){return function(){if(!this._is_form){return;}this.on_create=function(){var _a=null;if(Form==this.constructor){this.set_name("SAL050202_P02");this.set_classname("SAL050202_P02");this.set_titletext("기부조정관리");this._setFormPosition(0,0,1000,480);}_a=new Dataset("ds_cond00",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"EMPNO\" type=\"STRING\" size=\"256\"/><Column id=\"EXCCLC_YEAR\" type=\"STRING\" size=\"256\"/><Column id=\"EXCCLC_SE\" type=\"STRING\" size=\"256\"/><Column id=\"FORMAT_CODE\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_validation",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"compId\" type=\"STRING\" size=\"256\"/><Column id=\"colId\" type=\"STRING\" size=\"256\"/><Column id=\"PK\" type=\"STRING\" size=\"256\"/><Column id=\"notNull\" type=\"STRING\" size=\"256\"/><Column id=\"type\" type=\"STRING\" size=\"256\"/><Column id=\"nlength\" type=\"STRING\" size=\"256\"/><Column id=\"from\" type=\"STRING\" size=\"256\"/><Column id=\"to\" type=\"STRING\" size=\"256\"/><Column id=\"lengthChkGb\" type=\"STRING\" size=\"256\"/><Column id=\"msgId\" type=\"STRING\" size=\"256\"/><Column id=\"expr\" type=\"STRING\" size=\"256\"/><Column id=\"func\" type=\"STRING\" size=\"256\"/></ColumnInfo><Rows><Row><Col id=\"colId\">EXCCLC_YEAR</Col><Col id=\"compId\">ds_cond00</Col><Col id=\"PK\">Y</Col><Col id=\"notNull\">Y</Col></Row><Row><Col id=\"compId\">ds_cond00</Col><Col id=\"colId\">EXCCLC_SE</Col><Col id=\"PK\">Y</Col><Col id=\"notNull\">Y</Col></Row><Row><Col id=\"compId\">ds_cond00</Col><Col id=\"colId\">EMPNO</Col><Col id=\"PK\">Y</Col><Col id=\"notNull\">Y</Col></Row><Row><Col id=\"colId\">EXCCLC_YEAR</Col><Col id=\"compId\">ds_yndCntrMdat</Col><Col id=\"notNull\">Y</Col><Col id=\"msgId\">공제년도</Col></Row><Row><Col id=\"colId\">EXCCLC_SE</Col><Col id=\"compId\">ds_yndCntrMdat</Col><Col id=\"notNull\">Y</Col><Col id=\"msgId\">공제구분</Col></Row><Row><Col id=\"colId\">EMPNO</Col><Col id=\"compId\">ds_yndCntrMdat</Col><Col id=\"notNull\">Y</Col><Col id=\"msgId\">사원번호</Col></Row><Row><Col id=\"colId\">EMPNM</Col><Col id=\"compId\">ds_yndCntrMdat</Col><Col id=\"notNull\">Y</Col><Col id=\"msgId\">사원명</Col></Row><Row><Col id=\"colId\">CNTR_YEAR</Col><Col id=\"compId\">ds_yndCntrMdat</Col><Col id=\"notNull\">Y</Col><Col id=\"msgId\">기부년도</Col></Row><Row><Col id=\"colId\">CNTR_TY</Col><Col id=\"compId\">ds_yndCntrMdat</Col><Col id=\"notNull\">Y</Col><Col id=\"msgId\">기부유형</Col></Row><Row><Col id=\"colId\">CNTR_AMOUNT</Col><Col id=\"compId\">ds_yndCntrMdat</Col><Col id=\"notNull\">Y</Col><Col id=\"msgId\">기부금액</Col></Row><Row><Col id=\"colId\">PRVYY_DDC</Col><Col id=\"compId\">ds_yndCntrMdat</Col><Col id=\"notNull\">Y</Col><Col id=\"msgId\">전년공제</Col></Row><Row><Col id=\"colId\">DDC_TRGET</Col><Col id=\"compId\">ds_yndCntrMdat</Col><Col id=\"notNull\">Y</Col><Col id=\"msgId\">공제대상</Col></Row></Rows>");this.addChild(_a.name,_a);_a=new Dataset("ds_hrm013",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"CODE\" type=\"STRING\" size=\"256\"/><Column id=\"CODE_NM\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_sal027",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"CODE\" type=\"STRING\" size=\"256\"/><Column id=\"CODE_NM\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_yndCntrMdat",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"EXCCLC_YEAR\" type=\"STRING\" size=\"256\"/><Column id=\"EXCCLC_SE\" type=\"STRING\" size=\"256\"/><Column id=\"EMPNO\" type=\"STRING\" size=\"256\"/><Column id=\"CNTR_YEAR\" type=\"STRING\" size=\"256\"/><Column id=\"CNTR_TY\" type=\"STRING\" size=\"256\"/><Column id=\"EMPNM\" type=\"STRING\" size=\"256\"/><Column id=\"CNTR_AMOUNT\" type=\"BIGDECIMAL\" size=\"256\"/><Column id=\"PRVYY_DDC\" type=\"BIGDECIMAL\" size=\"256\"/><Column id=\"DDC_TRGET\" type=\"BIGDECIMAL\" size=\"256\"/><Column id=\"CRRSPND_DDC\" type=\"BIGDECIMAL\" size=\"256\"/><Column id=\"EXTSH_AMOUNT\" type=\"BIGDECIMAL\" size=\"256\"/><Column id=\"CYFD_AMOUNT\" type=\"BIGDECIMAL\" size=\"256\"/><Column id=\"END_YEAR\" type=\"STRING\" size=\"256\"/><Column id=\"CLOS_AT\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_sal005",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"CODE\" type=\"STRING\" size=\"256\"/><Column id=\"CODE_NM\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_yndse",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"code\" type=\"STRING\" size=\"256\"/><Column id=\"name\" type=\"STRING\" size=\"256\"/></ColumnInfo><Rows><Row><Col id=\"code\">1</Col><Col id=\"name\">연말정산</Col></Row><Row><Col id=\"code\">2</Col><Col id=\"name\">중도퇴직정산</Col></Row></Rows>");this.addChild(_a.name,_a);_a=new Static("Static06","absolute","4","0",null,"15","4",null,this);_a.set_taborder("1");_a.set_text("15");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Static("sta_title","absolute","15","17","125","21",null,null,this);_a.set_taborder("2");_a.set_text("연말정산 기부금");_a.set_cssclass("sta_WF_Title01");this.addChild(_a.name,_a);_a=new Static("Static12","absolute","34","40",null,"5","34",null,this);_a.set_taborder("3");_a.set_text("5");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Static("Static05","absolute","0","2","15","438",null,null,this);_a.set_taborder("4");_a.set_text("15");_a.set_visible("false");_a.style.set_background("#1b3cd23c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Static("Static00","absolute",null,null,"15","438","0","128",this);_a.set_taborder("5");_a.set_text("15");_a.set_visible("false");_a.style.set_background("#1b3cd23c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Grid("grd_yndExcclcCtbny","absolute","15","45",null,null,"15","16",this);_a.set_taborder("6");_a.set_binddataset("ds_yndCntrMdat");_a.set_autofittype("col");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"56\"/><Column size=\"67\"/><Column size=\"98\"/><Column size=\"86\"/><Column size=\"58\"/><Column size=\"96\"/><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"24\"/><Row size=\"24\" band=\"summ\"/></Rows><Band id=\"head\"><Cell text=\"정산년도\"/><Cell col=\"1\" text=\"정산구분\"/><Cell col=\"2\" text=\"사번\"/><Cell col=\"3\" text=\"사원명\"/><Cell col=\"4\" text=\"기부년도\"/><Cell col=\"5\" text=\"기부유형\"/><Cell col=\"6\" text=\"기부금액\"/><Cell col=\"7\" text=\"전년공제\"/><Cell col=\"8\" text=\"공제대상\"/><Cell col=\"9\" text=\"해당공제\"/><Cell col=\"10\" text=\"소멸금액\"/><Cell col=\"11\" text=\"이월금액\"/></Band><Band id=\"body\"><Cell edittype=\"none\" text=\"bind:EXCCLC_YEAR\"/><Cell col=\"1\" displaytype=\"combo\" edittype=\"none\" text=\"bind:EXCCLC_SE\" combodataset=\"ds_yndse\" combocodecol=\"code\" combodatacol=\"name\"/><Cell col=\"2\" edittype=\"none\" text=\"bind:EMPNO\" expandshow=\"hide\" expandsize=\"20\"/><Cell col=\"3\" text=\"bind:EMPNM\" expandshow=\"hide\" expandsize=\"20\"/><Cell col=\"4\" edittype=\"expr:EXCCLC_YEAR==CNTR_YEAR?&quot;none&quot;:&quot;normal&quot;\" text=\"bind:CNTR_YEAR\"/><Cell col=\"5\" displaytype=\"combo\" edittype=\"expr:EXCCLC_YEAR==CNTR_YEAR?&quot;none&quot;:&quot;combo&quot;\" text=\"bind:CNTR_TY\" combodataset=\"ds_sal005\" combocodecol=\"CODE\" combodatacol=\"CODE_NM\"/><Cell col=\"6\" displaytype=\"number\" edittype=\"expr:EXCCLC_YEAR==CNTR_YEAR?&quot;none&quot;:&quot;normal&quot;\" editfilter=\"number\" style=\"align:right;\" text=\"bind:CNTR_AMOUNT\"/><Cell col=\"7\" displaytype=\"number\" edittype=\"expr:EXCCLC_YEAR==CNTR_YEAR?&quot;none&quot;:&quot;normal&quot;\" editfilter=\"number\" style=\"align:right;\" text=\"bind:PRVYY_DDC\"/><Cell col=\"8\" displaytype=\"number\" edittype=\"expr:EXCCLC_YEAR==CNTR_YEAR?&quot;none&quot;:&quot;normal&quot;\" editfilter=\"number\" style=\"align:right;\" text=\"bind:DDC_TRGET\"/><Cell col=\"9\" displaytype=\"number\" edittype=\"none\" editfilter=\"number\" style=\"align:right;\" text=\"bind:CRRSPND_DDC\"/><Cell col=\"10\" displaytype=\"number\" edittype=\"none\" editfilter=\"number\" style=\"align:right;\" text=\"bind:EXTSH_AMOUNT\"/><Cell col=\"11\" displaytype=\"number\" edittype=\"none\" editfilter=\"number\" style=\"align:right;\" text=\"bind:CYFD_AMOUNT\"/></Band><Band id=\"summary\"><Cell/><Cell col=\"1\"/><Cell col=\"2\"/><Cell col=\"3\"/><Cell col=\"4\"/><Cell col=\"5\"/><Cell col=\"6\"/><Cell col=\"7\"/><Cell col=\"8\"/><Cell col=\"9\"/><Cell col=\"10\"/><Cell col=\"11\"/></Band></Format></Formats>");this.addChild(_a.name,_a);_a=new Button("btn_Close","absolute","935","15","50","25",null,null,this);_a.set_taborder("10");_a.set_text("닫기");_a.set_cssclass("btn_WF_CRUD");this.addChild(_a.name,_a);_a=new Button("btn_Save","absolute","883","15","50","25",null,null,this);_a.set_taborder("11");_a.set_text("저장");_a.set_cssclass("btn_WF_CRUD");this.addChild(_a.name,_a);_a=new Button("btn_Del","absolute","831","15","50","25",null,null,this);_a.set_taborder("12");_a.set_text("삭제");_a.set_cssclass("btn_WF_CRUD");this.addChild(_a.name,_a);_a=new Static("Static01","absolute","0.4%","465",null,"15","0.4%",null,this);_a.set_taborder("13");_a.set_text("15");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Button("btn_Ins00","absolute","779","15","50","25",null,null,this);_a.set_taborder("14");_a.set_text("신규");_a.set_cssclass("btn_WF_CRUD");this.addChild(_a.name,_a);_a=new Static("sta_title00","absolute","128","17","414","21",null,null,this);_a.set_taborder("15");_a.set_text("(해당공제, 소멸금액, 이월금액은 시뮬레이션시 다시 계산 됩니다.)");_a.set_cssclass("sta_WF_Title01");_a.style.set_background("left middle");_a.style.set_font("10 Gulim");this.addChild(_a.name,_a);_a=new Layout("default","",1000,480,this,function(_b){_b.set_classname("SAL050202_P02");_b.set_titletext("기부조정관리");});this.addLayout(_a.name,_a);_a=null;};this.addIncludeScript("SAL050202_P07.xfdl","lib::comInclude.xjs");this.registerScript("SAL050202_P07.xfdl",function(){var _a=this.parent.EMPNO;var _b=this.parent.EXCCLCYEAR;var _c=this.parent.EXCCLCSE;var _d=this.parent.EMPNM;this.SAL050202_P02_oninit=function(_e,_f){this.fn_init_form();this.fn_init_dataset();};this.SAL050202_P02_onload=function(_e,_f){this.fn_loadCombo();this.fn_search();};this.fn_loadCombo=function(){var _e=[["ds_sal005","SAL005",1,""]];this.gfn_comboLoad(_e,this.fn_callbackAfter);};this.fn_init_form=function(){this.gfn_initForm(this);};this.fn_init_dataset=function(){this.gfn_initCondDs(this,this.div_search);};this.fn_search=function(){this.ds_yndCntrMdat.clearData();this.ds_cond00.clearData();this.ds_cond00.addRow();this.ds_cond00.setColumn(0,"EMPNO",_a);this.ds_cond00.setColumn(0,"EXCCLC_YEAR",_b);this.ds_cond00.setColumn(0,"EXCCLC_SE",_c);this.fn_transaction("selectYndcntrmdatList");};this.btn_Save_onclick=function(){if(!this.gfn_checkValidation(this.ds_yndCntrMdat,this.ds_validation)){return;}for(var _g=0;_g<this.ds_yndCntrMdat.getRowCount();_g++ ){var _e=this.ds_yndCntrMdat.getColumn(_g,"CNTR_YEAR");var _f=this.ds_yndCntrMdat.getColumn(_g,"CNTR_TY");if(this.ds_yndCntrMdat.findRowExpr("CNTR_YEAR=='"+_e+"' && CNTR_TY=='"+_f+"'",0,_g)> -1||this.ds_yndCntrMdat.findRowExpr("CNTR_YEAR=='"+_e+"' && CNTR_TY=='"+_f+"'",_g+1)> -1){this.gfn_message("comm.err","동일한 년도에 동일한 기부유형을 선택 할 수 없습니다.");return;}}if(this.gfn_message("confirm.저장.여부")){this.fn_transaction("YndcntrmdatCUD");}};this.fn_transaction=function(_e){switch(_e){case "selectYndcntrmdatList":var _f="hsco/mis/sal/SAL050202/selectYndcntrmdatList.do";var _g="input1=ds_cond00";var _h="ds_yndCntrMdat=output1";break;case "YndcntrmdatCUD":var _f="hsco/mis/sal/SAL050202/YndcntrmdatCUD.do";var _g="input2=ds_yndCntrMdat:U";var _h="";break;}Ex.core.tran(this,_e,_f,_g,_h);};this.fn_callBack=function(_e,_f,_g){if(_f!=0){this.gfn_callback_message(_e,_f,_g);}else{switch(_e){case "selectYndcntrmdatList":break;case "YndcntrmdatCUD":this.fn_search();break;}}};this.btn_Del_onclick=function(){if(this.gfn_message("confirm.삭제여부")){var _e=this.ds_yndCntrMdat.rowposition;this.ds_yndCntrMdat.deleteRow(_e);}};this.btn_Close_onclick=function(_e,_f){this.close();};this.btn_Ins_onclick=function(_e,_f){var _g=this.ds_yndCntrMdat.addRow();this.ds_yndCntrMdat.setColumn(_g,"EXCCLC_YEAR",_b);this.ds_yndCntrMdat.setColumn(_g,"EXCCLC_SE",_c);this.ds_yndCntrMdat.setColumn(_g,"EMPNO",_a);this.ds_yndCntrMdat.setColumn(_g,"EMPNM",_d);};this.ds_yndCntrMdat_oncolumnchanged=function(_e,_f){switch(_f.columnid){case "CNTR_YEAR":if(_f.newvalue>=_b){this.gfn_message("comm.err","정산년도 ("+_b+") 이전 년도만 입력 가능 합니다.");_e.setColumn(_f.row,"CNTR_YEAR","");return;}case "CNTR_TY":if(_e.getColumn(_f.row,"CNTR_TY")=="10"&&_e.getColumn(_f.row,"CNTR_YEAR")<"2013"){this.gfn_message("comm.err","법정기부금은 2013년 이후 부터 등록 가능합니다.");_e.setColumn(_f.row,"CNTR_TY","");return;}if(_e.getColumn(_f.row,"CNTR_TY")=="20"||_e.getColumn(_f.row,"CNTR_TY")=="42"){this.gfn_message("comm.err","정치자금기부금, 우리사주조합기부금은 이월내역을 등록 할 수 없습니다.");_e.setColumn(_f.row,"CNTR_TY","");return;}if((_e.getColumn(_f.row,"CNTR_TY")=="40"||_e.getColumn(_f.row,"CNTR_TY")=="41")&&_e.getColumn(_f.row,"CNTR_YEAR")<"2011"){this.gfn_message("comm.err","지정기부금은 2011년 이후 부터 등록 가능합니다.");_e.setColumn(_f.row,"CNTR_TY","");return;}if(_e.getColumn(_f.row,"CNTR_TY")=="21"){this.gfn_message("comm.err","진흥기금은 공제 대상이 아닙니다.");_e.setColumn(_f.row,"CNTR_TY","");return;}var _g=_e.getColumn(_f.row,"CNTR_YEAR");var _h=_e.getColumn(_f.row,"CNTR_TY");if(this.ds_yndCntrMdat.findRowExpr("CNTR_YEAR=='"+_g+"' && CNTR_TY=='"+_h+"'",0,_f.row)> -1||this.ds_yndCntrMdat.findRowExpr("CNTR_YEAR=='"+_g+"' && CNTR_TY=='"+_h+"'",_f.row+1)> -1){this.gfn_message("comm.err","동일한 년도에 동일한 기부유형을 선택 할 수 없습니다.");_e.setColumn(_f.row,"CNTR_TY","");return;}break;case "CNTR_AMOUNT":case "PRVYY_DDC":case "DDC_TRGET":_e.setColumn(_f.row,"DDC_TRGET",_e.getColumn(_f.row,"CNTR_AMOUNT")*1-_e.getColumn(_f.row,"PRVYY_DDC")*1);break;}};});this.on_initEvent=function(){this.ds_yndCntrMdat.addEventHandler("oncolumnchanged",this.ds_yndCntrMdat_oncolumnchanged,this);this.addEventHandler("oninit",this.SAL050202_P02_oninit,this);this.addEventHandler("onload",this.SAL050202_P02_onload,this);this.btn_Close.addEventHandler("onclick",this.btn_Close_onclick,this);this.btn_Save.addEventHandler("onclick",this.btn_Save_onclick,this);this.btn_Del.addEventHandler("onclick",this.btn_Del_onclick,this);this.btn_Ins00.addEventHandler("onclick",this.btn_Ins_onclick,this);};this.loadIncludeScript("SAL050202_P07.xfdl");};})();