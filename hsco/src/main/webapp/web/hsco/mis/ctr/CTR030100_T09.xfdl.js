(function(){return function(){if(!this._is_form){return;}this.on_create=function(){var _a=null;if(Form==this.constructor){this.set_name("CTR030100_T09");this.set_classname("CTR030100_T09");this.set_titletext("첨부파일");this._setFormPosition(0,0,1031,400);}_a=new Grid("grd_cmmnAtchmnfl","absolute","0","35",null,null,"0","0",this);_a.set_taborder("57");_a.set_binddataset("ds_fileList");_a.set_cellsizingtype("col");_a.set_autoenter("select");_a.set_autofittype("col");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"40\"/><Column size=\"65\"/><Column size=\"300\"/><Column size=\"80\"/><Column size=\"80\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"40\"/></Rows><Band id=\"head\"><Cell displaytype=\"checkbox\" edittype=\"checkbox\"/><Cell col=\"1\" text=\"파일형식\"/><Cell col=\"2\" celltype=\"head\" text=\"파일명\"/><Cell col=\"3\" text=\"확장자\"/><Cell col=\"4\" text=\"사이즈\"/></Band><Band id=\"body\"><Cell displaytype=\"checkbox\" edittype=\"checkbox\" text=\"bind:CHK\"/><Cell col=\"1\" displaytype=\"image\" text=\"bind:FILE_IMAGE\" autosizerow=\"limitmin\" autosizecol=\"limitmin\"/><Cell col=\"2\" displaytype=\"normal\" style=\"align:left middle;\" text=\"bind:ORGINL_FILE_NM\"/><Cell col=\"3\" text=\"bind:FILE_EXTSN\"/><Cell col=\"4\" text=\"bind:FILE_MG\"/></Band></Format></Formats>");this.addChild(_a.name,_a);_a=new Static("sta_title","absolute","0","11","120","19",null,null,this);_a.set_taborder("58");_a.set_text("첨부파일");_a.set_cssclass("sta_WF_Title02");this.addChild(_a.name,_a);_a=new Static("Static00","absolute","0","1",null,"10","0",null,this);_a.set_taborder("59");_a.set_text("10");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Static("Static08","absolute","0","30",null,"5","0",null,this);_a.set_taborder("60");_a.set_text("5");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Button("btn_fileUpload","absolute",null,"58","167","21","0",null,this);_a.set_taborder("61");_a.set_text("첨부파일 업로드/다운로드");_a.set_cssclass("btn_WF_Process");_a.set_visible("false");this.addChild(_a.name,_a);_a=new Button("btn_delFiles","absolute",null,"11","67","19","160",null,this);_a.set_taborder("62");_a.set_text("선택삭제");_a.set_cssclass("btn_WF_Process");this.addChild(_a.name,_a);_a=new Button("btn_uploadFiles","absolute",null,"11","68","19","88",null,this);_a.set_taborder("63");_a.set_text("파일업로드");_a.set_cssclass("btn_WF_Process");this.addChild(_a.name,_a);_a=new Button("btn_downFiles","absolute",null,"11","85","19","0",null,this);_a.set_taborder("64");_a.set_text("선택다운로드");_a.set_cssclass("btn_WF_Process");this.addChild(_a.name,_a);_a=new Layout("default","",1031,400,this,function(_b){_b.set_classname("CTR030100_T09");_b.set_titletext("첨부파일");});this.addLayout(_a.name,_a);_a=null;};this.addIncludeScript("CTR030100_T09.xfdl","lib::comInclude.xjs");this.addIncludeScript("CTR030100_T09.xfdl","mis_lib::misUtil.xjs");this.registerScript("CTR030100_T09.xfdl",function(){this.CTR030100_T09_oninit=function(_a,_b){this.fn_init_form();this.fn_init_dataset();};this.CTR030100_T09_onload=function(_a,_b){};this.fn_init_form=function(){this.gfn_initForm(this);this.fn_misFormInit(this);};this.fn_init_dataset=function(){};this.fn_save_fileSn=function(){this.fn_transaction("saveNewFileSn");};this.fn_transaction=function(_a){switch(_a){case "saveNewFileSn":var _b="hsco/mis/ctr/CTR030100/saveNewFileSn.do";var _c="input1=ds_saveFileSn:U";var _d="ds_saveFileSn=output1";break;}Ex.core.tran(this,_a,_b,_c,_d);};this.fn_callBack=function(_a,_b,_c){if(_b!='0'){this.gfn_callback_message(_a,_b,_c);}if(_b=='0'){switch(_a){case "saveNewFileSn":var _d=this.parent.parent.ds_saveFileSn.getColumn(0,"FILE_SN");var _e="MIS";var _f="CTR";this.parent.parent.ds_cntrct.set_updatecontrol(false);this.parent.parent.ds_cntrct.setColumn(0,"FILE_SN",_d);this.parent.parent.ds_cntrct.set_updatecontrol(true);var _g=this.parent.parent.ds_fileSn.addRow();this.parent.parent.ds_fileSn.setColumn(_g,"FILE_SN",_d);this.parent.parent.ds_fileSn.setColumn(_g,"SYS_SE_CODE",_e);this.parent.parent.ds_fileSn.setColumn(_g,"JOB_SE",_f);this.file_upload_popup();break;}}};this.fn_popupCallBack=function(_a,_b){if(_a=="COM010300_P01"){this.parent.parent.fn_search_tp6();}};this.btn_fileUpload_onclick=function(_a,_b){if(this.parent.parent.ds_cntrct.getRowCount()==0){this.gfn_message("info.진행가능","계약정보 '추가' 혹은 '조회'");return false;}var _c=this.parent.parent.ds_cntrct.getColumn(0,"BSNS_CODE");var _d=this.parent.parent.ds_cntrct.getColumn(0,"CNTRCT_NO");var _e=this.parent.parent.ds_cntrct.getColumn(0,"FILE_SN");var _f="MIS";var _g="CTR";if(this.comUtils.isNull(_e)){this.parent.parent.ds_saveFileSn.clearData();var _h=this.parent.parent.ds_saveFileSn.addRow();this.parent.parent.ds_saveFileSn.setColumn(_h,"BSNS_CODE",_c);this.parent.parent.ds_saveFileSn.setColumn(_h,"CNTRCT_NO",_d);this.parent.parent.ds_saveFileSn.setColumn(_h,"SYS_SE_CODE",_f);this.parent.parent.ds_saveFileSn.setColumn(_h,"JOB_SE",_g);this.fn_save_fileSn();}else{this.parent.parent.ds_fileSn.clearData();var _h=this.parent.parent.ds_fileSn.addRow();this.parent.parent.ds_fileSn.setColumn(_h,"FILE_SN",_e);this.parent.parent.ds_fileSn.setColumn(_h,"SYS_SE_CODE",_f);this.parent.parent.ds_fileSn.setColumn(_h,"JOB_SE",_g);this.file_upload_popup();}};this.file_upload_popup=function(){var _a={arg_0:this,arg_1:this.parent.parent.ds_files,arg_2:this.parent.parent.ds_fileSn};this.gfn_popup("COM010300_P01",694,528,"업로드파일 선택 / 다운로드",_a,"com::COM010300_P01.xfdl","fn_popupCallBack",true);};this.btn_delFiles_onclick=function(_a,_b){var _c=this.parent.parent.ds_fileList.findRow("CHK","1");if(_c<0){this.gfn_message("comm.데이터.선택.없음");return;}if(!this.gfn_message("confirm.선택파일.삭제여부","들")){return false;}for(var _i=this.parent.parent.ds_fileList.getRowCount()-1;_i>=0;_i-- ){var _d=this.parent.parent.ds_fileList.getColumn(_i,"CHK");if(_d=='1'){this.parent.parent.ds_fileList.deleteRow(_i);}}var _e="deleteFile";var _f="hsco/mis/mis/MIS000000/deleteFile.do";var _g="input1=ds_fileList:U";var _h="ds_fileList=output1";Ex.core.tran(this,_e,_f,_g,_h);};this.btn_uploadFiles_onclick=function(_a,_b){this.fn_autoFileSn("MIS","CTR",this.parent.parent.File_UpDownManager,this.parent.parent.ds_fileList,this.parent.parent.ds_cntrct,"TBCTR_CNTRCT","FILE_SN",["CNTRCT_NO"]);};this.btn_downFiles_onclick=function(_a,_b){var _c=this.parent.parent.ds_fileList.findRow("CHK","1");if(_c<0){this.gfn_message("comm.데이터.선택.없음");return;}for(var _h=0;_h<this.parent.parent.ds_fileList.getRowCount();_h++ ){var _d=this.parent.parent.ds_fileList.getColumn(_h,"FILE_SN");var _e=this.parent.parent.ds_fileList.getColumn(_h,"FILE_ORDR");var _f=this.parent.parent.ds_fileList.getColumn(_h,"ORGINL_FILE_NM");var _g=this.parent.parent.ds_fileList.getColumn(_h,"CHK");if(_g=='1'){this.parent.parent.File_UpDownManager.download(_d,_e,_f);}}};});this.on_initEvent=function(){this.addEventHandler("onload",this.CTR030100_T09_onload,this);this.addEventHandler("oninit",this.CTR030100_T09_oninit,this);this.btn_fileUpload.addEventHandler("onclick",this.btn_fileUpload_onclick,this);this.btn_delFiles.addEventHandler("onclick",this.btn_delFiles_onclick,this);this.btn_uploadFiles.addEventHandler("onclick",this.btn_uploadFiles_onclick,this);this.btn_downFiles.addEventHandler("onclick",this.btn_downFiles_onclick,this);};this.loadIncludeScript("CTR030100_T09.xfdl");};})();