(function(){return function(){if(!this._is_form){return;}this.on_create=function(){var _a=null;if(Form==this.constructor){this.set_name("ITM060200");this.set_classname("codeMng");this.set_titletext("전산실출입");this._setFormPosition(0,0,1059,735);}_a=new Dataset("ds_grid",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"SN\" type=\"BIGDECIMAL\" size=\"11\"/><Column id=\"CMPTRM_CMG_DT\" type=\"STRING\" size=\"10\"/><Column id=\"CMPTRM_GNOT_DT\" type=\"STRING\" size=\"10\"/><Column id=\"CMPTRM_CMG_PRMISNER\" type=\"STRING\" size=\"30\"/><Column id=\"CMPTRM_CGPN_ENTRPS\" type=\"STRING\" size=\"100\"/><Column id=\"CMPTRM_CGPN\" type=\"STRING\" size=\"30\"/><Column id=\"CMPTRM_CMG_PRVONSH\" type=\"STRING\" size=\"100\"/><Column id=\"RM\" type=\"STRING\" size=\"200\"/><Column id=\"REGISTER_ID\" type=\"STRING\" size=\"12\"/><Column id=\"REGIST_DT\" type=\"DATE\" size=\"255\"/><Column id=\"UPDUSR_ID\" type=\"STRING\" size=\"12\"/><Column id=\"UPDT_DT\" type=\"DATE\" size=\"255\"/><Column id=\"CMPTRM_CMG_DT_M\" type=\"STRING\" size=\"4\"/><Column id=\"CMPTRM_GNOT_DT_M\" type=\"STRING\" size=\"4\"/><Column id=\"SERVC_ENTRPS_CODE\" type=\"STRING\" size=\"13\"/><Column id=\"IT_EMP\" type=\"STRING\" size=\"3\"/><Column id=\"SERVC_ENTRPS_CODE_NM\" type=\"STRING\" size=\"256\"/><Column id=\"IT_EMP_NM\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_cond",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"CMPTRM_CMG_DT_F\" type=\"STRING\" size=\"8\"/><Column id=\"CMPTRM_CMG_DT_T\" type=\"STRING\" size=\"8\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Div("div_search","absolute","0%","0",null,"33","2.64%",null,this);_a.set_taborder("0");_a.set_cssclass("div_WFSA_Box");_a.set_scrollbars("none");this.addChild(_a.name,_a);_a=new Static("Static04","absolute","15","5","63","21",null,null,this.div_search);_a.set_taborder("18");_a.set_text("출입일자");_a.set_cssclass("sta_WFSA_Label");_a.style.set_background("URL('theme://images/sta_WFSA_Label.png') left middle");this.div_search.addChild(_a.name,_a);_a=new Calendar("cal_cmgDeBegin","absolute","86","5","110","21",null,null,this.div_search);this.div_search.addChild(_a.name,_a);_a.set_taborder("0");_a.set_value("20150710");_a.set_dateformat("yyyy-MM-dd");_a.set_cssclass("cal_WF_Essential");_a=new Static("Static05","absolute","206","5","37","21",null,null,this.div_search);_a.set_taborder("20");_a.set_text("~");this.div_search.addChild(_a.name,_a);_a=new Calendar("cal_cmgDeEnd","absolute","222","5","110","21",null,null,this.div_search);this.div_search.addChild(_a.name,_a);_a.set_taborder("1");_a.set_value("20150710");_a.set_dateformat("yyyy-MM-dd");_a.set_cssclass("cal_WF_Essential");_a=new Static("Static00","absolute","97.36%","0",null,"735","1.23%",null,this);_a.set_taborder("1");_a.set_text("15");_a.set_visible("false");_a.style.set_background("#1b3cd23c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Static("Static01","absolute","98.77%","0",null,"735","0%",null,this);_a.set_taborder("2");_a.set_text("스\r\n크\r\n롤\r\n13");_a.set_visible("false");_a.style.set_background("#d07b173c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Grid("grd","absolute","0%","67",null,null,"2.64%","7",this);_a.set_taborder("3");_a.set_binddataset("ds_grid");_a.set_autoenter("select");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"37\"/><Column size=\"120\"/><Column size=\"58\"/><Column size=\"120\"/><Column size=\"57\"/><Column size=\"94\"/><Column size=\"120\"/><Column size=\"73\"/><Column size=\"237\"/><Column size=\"114\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"24\"/></Rows><Band id=\"head\"><Cell style=\"font:9 돋움;\" text=\"순번\"/><Cell col=\"1\" style=\"font:9 돋움;\" text=\"입실일자\"/><Cell col=\"2\" style=\"font:9 돋움;\" text=\"일실일시\"/><Cell col=\"3\" style=\"font:9 돋움;\" text=\"퇴실일자\"/><Cell col=\"4\" style=\"font:9 돋움;\" text=\"퇴실일시\"/><Cell col=\"5\" style=\"font:9 돋움;\" text=\"출입허가자\"/><Cell col=\"6\" style=\"font:9 돋움;\" text=\"출입인소속\"/><Cell col=\"7\" style=\"font:9 돋움;\" text=\"출입인\"/><Cell col=\"8\" style=\"font:9 돋움;\" text=\"사유\"/><Cell col=\"9\" style=\"font:9 돋움;\" text=\"비고\"/></Band><Band id=\"body\"><Cell text=\"bind:SN\"/><Cell col=\"1\" displaytype=\"date\" edittype=\"date\" text=\"bind:CMPTRM_CMG_DT\"/><Cell col=\"2\" edittype=\"text\" editfilter=\"number\" text=\"bind:CMPTRM_CMG_DT_M\" mask=\"##:##\" editlimit=\"4\"/><Cell col=\"3\" displaytype=\"date\" edittype=\"date\" text=\"bind:CMPTRM_GNOT_DT\"/><Cell col=\"4\" edittype=\"text\" editfilter=\"number\" text=\"bind:CMPTRM_GNOT_DT_M\" mask=\"##:##\" editlimit=\"4\"/><Cell col=\"5\" displaytype=\"text\" edittype=\"text\" text=\"bind:CMPTRM_CMG_PRMISNER\"/><Cell col=\"6\" displaytype=\"text\" edittype=\"text\" text=\"bind:CMPTRM_CGPN_ENTRPS\"/><Cell col=\"7\" displaytype=\"text\" edittype=\"text\" text=\"bind:CMPTRM_CGPN\" expandshow=\"show\"/><Cell col=\"8\" displaytype=\"text\" edittype=\"text\" style=\"align:left;\" text=\"bind:CMPTRM_CMG_PRVONSH\"/><Cell col=\"9\" displaytype=\"text\" edittype=\"text\" style=\"align:left;\" text=\"bind:RM\"/></Band></Format></Formats>");this.addChild(_a.name,_a);_a=new Static("Static02","absolute","0%","33",null,"10","2.64%",null,this);_a.set_taborder("4");_a.set_text("10");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Button("btn_excelDown00","absolute",null,"43","26","19","28",null,this);_a.set_taborder("5");_a.set_cssclass("btn_WF_Gridexceldn");this.addChild(_a.name,_a);_a=new Static("Static06","absolute","0%","62",null,"5","-0.57%",null,this);_a.set_taborder("6");_a.set_text("5");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Layout("default","",0,33,this.div_search,function(_b){_b.set_taborder("0");_b.set_cssclass("div_WFSA_Box");_b.set_scrollbars("none");});this.div_search.addLayout(_a.name,_a);_a=new Layout("default","",1059,735,this,function(_b){_b.set_classname("codeMng");_b.set_titletext("전산실출입");});this.addLayout(_a.name,_a);_a=new BindItem("item0","Div01.cal_F","value","ds_cond","CMPTRM_CMG_DT_F");this.addChild(_a.name,_a);_a.bind();_a=new BindItem("item1","Div01.cal_T","value","ds_cond","CMPTRM_CMG_DT_T");this.addChild(_a.name,_a);_a.bind();_a=new BindItem("item2","div_search.cal_cmgDeBegin","value","ds_cond","CMPTRM_CMG_DT_F");this.addChild(_a.name,_a);_a.bind();_a=new BindItem("item3","div_search.cal_cmgDeEnd","value","ds_cond","CMPTRM_CMG_DT_T");this.addChild(_a.name,_a);_a.bind();_a=null;};this.addIncludeScript("ITM060200.xfdl","lib::comInclude.xjs");this.addIncludeScript("ITM060200.xfdl","pms_lib::pmsUtilInclude.xjs");this.registerScript("ITM060200.xfdl",function(){this.ITM060200_oninit=function(_a,_b){this.fn_init_form();this.fn_init_dataset();this.fn_init();};this.ITM060200_onload=function(_a,_b){var _c=new String(this.dateUtils.today());this.div_search.cal_cmgDeBegin.set_value(_c.substring(0,6)+"01");this.div_search.cal_cmgDeEnd.set_value(this.dateUtils.today());this.ds_cond.clearData();var _d=this.ds_cond.addRow();this.ds_cond.setColumn(_d,"CMPTRM_CMG_DT_F",_c.substring(0,6)+"01");this.ds_cond.setColumn(_d,"CMPTRM_CMG_DT_T",this.dateUtils.today());this.fn_search();};this.fn_init_form=function(){this.gfn_initForm(this);this.checkDs.push(this.ds_grid);};this.fn_init_dataset=function(){};this.fn_search=function(){if(this.div_search.cal_cmgDeBegin.value==''){alert('변경일자를 입력 하세요.');return false;}if(this.div_search.cal_cmgDeEnd.value==''){alert('변경일자를 입력 하세요.');return false;}this.ds_grid.clearData();this.fn_transaction("selectList");};this.fn_transaction=function(_a){switch(_a){case "selectList":var _b="/hsco/etc/itm/ITM060200/ITM060200List.do";var _c="input1=ds_cond";var _d="ds_grid=output1";break;case "saveList":var _b="/hsco/etc/itm/ITM060200/ITM060200CUD.do";var _e="input1=ds_grid:U";var _c=_e;var _d="";break;}Ex.core.tran(this,_a,_b,_c,_d,"");};this.fn_callBack=function(_a,_b,_c){if(_b<0){this.gfn_callBackMsg(_a,_b,_c);return;}switch(_a){case "saveList":this.gfn_callBackMsg(_a,_b,_c);this.fn_transaction("selectList");break;case "saveDetailList":this.gfn_callBackMsg(_a,_b,_c);break;default:break;}};this.fn_insert=function(_a,_b){if(this.fn_check()){var _c=this.ds_grid.getRowType(this.ds_grid.rowposition);var _d=this.ds_grid.addRow();}};this.fn_delete=function(){var _a=this.ds_grid.rowposition;var _b=this.ds_grid.getRowType(_a);this.ds_grid.deleteRow(_a);};this.fn_save=function(){if(!this.comUtils.isDatasetUpdated(this.ds_grid)){alert("저장할 내역이 없습니다.");return false;}if(application.confirm("변경된 내용을 저장하시겠습니까?")){if(this.fn_check()){this.fn_transaction("saveList");}}};this.fn_check=function(){var _a="";var _b="";var _c=this.ds_grid.rowposition;if(_c> -1){dt=this.ds_grid.getColumn(_c,"CMPTRM_CMG_DT");if(!dt){alert("입실일시는 필수입력 사항입니다.");return false;}else{return true;}}else{return true;}};this.btn_excel_down00_onclick=function(_a,_b){this.gfn_exportExcel(this.grd,"exportExl");};this.grd_onheadclick=function(_a,_b){this.gfn_gridSort(_a,_b);};this.fn_print=function(){var _a=new this.cf_Opts();var _b='/etc/itm/ITM060200.jrf';var _c;var _d="전산실출입대장";_c="SANCTN_SJ=SANCTN_SJ,"+"SANCTN_ETC=SANCTN_ETC,"+"SANCTN_CN=SANCTN_CN,";_a.setToolbar(false);_a.setScale(100);_a.setArgs("title",_d);_a.setArgs("user","홍길동");_a.setReportPath(_b);_a.setSaveFilename(_d);_a.setLocalDs(["ds_grid",this.ds_grid]);var _e={arg_0:this,opts:_a};var _f=function(_g,_h){trace('this.fn_print() - fn_cb');};this.gfn_popup("prjReportPouup",884,735,_d,_e,"common::frmReportPopup.xfdl",_f);};this.fn_popupCallBack=function(_a,_b){if(_a=="Popup1"){var _c=new Dataset();var _d=_c.loadXML(_b);if(_d){var _e=_c.getColumn(0,"ENTRPS_NM");var _f=_c.getColumn(0,"IT_EMP_NM");var _g=_c.getColumn(0,"SERVC_ENTRPS_CODE");var _h=_c.getColumn(0,"IT_EMP");var _i=this.ds_grid.rowposition;this.ds_grid.setColumn(_i,"CMPTRM_CGPN_ENTRPS",_e);this.ds_grid.setColumn(_i,"CMPTRM_CGPN",_f);this.ds_grid.setColumn(_i,"SERVC_ENTRPS_CODE",_g);this.ds_grid.setColumn(_i,"IT_EMP",_h);}}};this.grd_onexpandup=function(_a,_b){if(_b.col=='7'){this.gfn_popup("Popup1",400,400,"",{sport_stle:"%"},"etc_itm::ITM060200_P01.xfdl","fn_popupCallBack",true);}};});this.on_initEvent=function(){this.addEventHandler("oninit",this.ITM060200_oninit,this);this.addEventHandler("onload",this.ITM060200_onload,this);this.grd.addEventHandler("onheadclick",this.grd_onheadclick,this);this.grd.addEventHandler("onexpandup",this.grd_onexpandup,this);this.btn_excelDown00.addEventHandler("onclick",this.btn_excel_down00_onclick,this);};this.loadIncludeScript("ITM060200.xfdl");};})();