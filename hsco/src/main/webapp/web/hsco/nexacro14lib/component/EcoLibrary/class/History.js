if(!JsNamespace.exist("Eco.History")){if(nexacro.Browser=="Runtime"){}else{JsNamespace.declare("Eco.History",{hashcnt:0,init:function(_a,_b){var _c=Eco.History;var _d=_c.getLocationHash();_c.currentHash=_d;_c.historyChangeListener=_a;_c.historyChangeListenerScope=_b;var _e=JsNamespace.getGlobalContext();_e=window.top;document.onkeydown=function(_f){key=(_f)?_f.keyCode:event.keyCode;if(key==8){if(_f){_f.preventDefault();}else{}}};if("onhashchange" in _e){if(_e.addEventListener){_e.addEventListener('hashchange',_c.checkLocationHash,false);}else{_e.attachEvent('onhashchange',_c.checkLocationHash);}}else{_e.setInterval(function(){_c.checkLocationHash();},50);}},getLocationHash:function(){var _a=JsNamespace.getGlobalContext();_a=window.top;return _a.location.hash.slice(1);},checkLocationHash:function(){var _a=Eco.History;var _b=_a.getLocationHash();if(_b==_a.currentHash){return;}_a.currentHash=_b;var _c=_a.getData(_b);_a.historyChangeListener.call(_a.historyChangeListenerScope,_b,_c);},setLocationHash:function(_a,_b){var _c=Eco.History;sessionStorage.setItem(_a,Eco.Json.encode(_b));_c.currentHash=_a;var _d=JsNamespace.getGlobalContext();_d=window.top;if(Eco.isEmpty(_a)){var _e=true;if(_e){if('pushState' in _d.history){_d.history.pushState("",document.title,_d.location.pathname+_d.location.search);}else{_d.location.href="index.html";}}else{}}else{_d.location.hash=_a;}},back:function(_a){var _b=JsNamespace.getGlobalContext();if(Eco.isEmpty(_a)){_a= -1;}_b.history.go(_a);},forward:function(){var _a=JsNamespace.getGlobalContext();_a.history.go(1);},getData:function(_a){var _b=sessionStorage.getItem(_a);if(!Eco.isEmpty(_b)){_b=Eco.Json.decode(_b);}return _b;}});if(typeof sessionStorage==="undefined"){(function(_a){var _b=_a;try{while(_b!==_b.top){_b=_b.top;}}catch(i){}var _c=(function(_j,_k){return {decode:function(_l,_m){return this.encode(_l,_m);},encode:function(_l,_m){for(var _n=_l.length,_o=_m.length,_p=[],_q=[],_r=0,_s=0,_t=0,_u=0,_v;_r<256; ++_r){_q[_r]=_r;}for(_r=0;_r<256; ++_r){_s=(_s+(_v=_q[_r])+_l.charCodeAt(_r%_n))%256;_q[_r]=_q[_s];_q[_s]=_v;}for(_s=0;_t<_o; ++_t){_r=_t%256;_s=(_s+(_v=_q[_r]))%256;_n=_q[_r]=_q[_s];_q[_s]=_v;_p[_u++ ]=_j(_m.charCodeAt(_t)^_q[(_n+_v)%256]);}return _p.join("");},key:function(_l){for(var _m=0,_n=[];_m<_l; ++_m){_n[_m]=_j(1+((_k()*255)<<0));}return _n.join("");}};})(_a.String.fromCharCode,_a.Math.random);var _d=(function(_j){function o(_k,_l,_m){this._i=(this._data=_m||"").length;if(this._key=_l){this._storage=_k;}else{this._storage={_key:_k||""};this._key="_key";}}o.prototype.c=String.fromCharCode(1);o.prototype._c=".";o.prototype.clear=function(){this._storage[this._key]=this._data;};o.prototype.del=function(_k){var _l=this.get(_k);if(_l!==null){this._storage[this._key]=this._storage[this._key].replace(e.call(this,_k,_l),"");}};o.prototype.escape=_j.escape;o.prototype.get=function(_k){var _l=this._storage[this._key],_m=this.c,_n=_l.indexOf(_k=_m.concat(this._c,this.escape(_k),_m,_m),this._i),_o=null;if( -1<_n){_n=_l.indexOf(_m,_n+_k.length-1)+1;_o=_l.substring(_n,_n=_l.indexOf(_m,_n));_o=this.unescape(_l.substr( ++_n,_o));}return _o;};o.prototype.key=function(){var _k=this._storage[this._key],_l=this.c,_m=_l+this._c,_n=this._i,_o=[],_p=0,_q=0;while( -1<(_n=_k.indexOf(_m,_n))){_o[_q++ ]=this.unescape(_k.substring(_n+=2,_p=_k.indexOf(_l,_n)));_n=_k.indexOf(_l,_p)+2;_p=_k.indexOf(_l,_n);_n=1+_p+1*_k.substring(_n,_p);}return _o;};o.prototype.set=function(_k,_l){this.del(_k);this._storage[this._key]+=e.call(this,_k,_l);};o.prototype.unescape=_j.unescape;function e(_k,_l){var _m=this.c;return _m.concat(this._c,this.escape(_k),_m,_m,(_l=this.escape(_l)).length,_m,_l);}return o;})(_a);if(Object.prototype.toString.call(_a.opera)==="[object Opera]"){history.navigationMode="compatible";_d.prototype.escape=_a.encodeURIComponent;_d.prototype.unescape=_a.decodeURIComponent;}function l(){function r(){_k.cookie=["sessionStorage="+_a.encodeURIComponent(_i=_c.key(128))].join(";");_e=_c.encode(_i,_e);_d=new _d(_b,"name",_b.name);}var _j=_b.name,_k=_b.document,_l=/\bsessionStorage\b=([^;]+)(;|$)/,_m=_l.exec(_k.cookie),_n;if(_m){_i=_a.decodeURIComponent(_m[1]);_e=_c.encode(_i,_e);_d=new _d(_b,"name");for(var _o=_d.key(),_n=0,_p=_o.length,_q={};_n<_p; ++_n){if((_m=_o[_n]).indexOf(_e)===0){_f.push(_m);_q[_m]=_d.get(_m);_d.del(_m);}}_d=new _d.constructor(_b,"name",_b.name);if(0<(this.length=_f.length)){for(_n=0,_p=_f.length,c=_d.c,_m=[];_n<_p; ++_n){_m[_n]=c.concat(_d._c,_d.escape(_o=_f[_n]),c,c,(_o=_d.escape(_q[_o])).length,c,_o);}_b.name+=_m.join("");}}else{r();if(!_l.exec(_k.cookie)){_f=null;}}}l.prototype={length:0,key:function(_j){if(typeof _j!=="number"||_j<0||_f.length<=_j){throw "Invalid argument";}return _f[_j];},getItem:function(_j){_j=_e+_j;if(_h.call(_g,_j)){return _g[_j];}var _k=_d.get(_j);if(_k!==null){_k=_g[_j]=_c.decode(_i,_k);}return _k;},setItem:function(_j,_k){this.removeItem(_j);_j=_e+_j;_d.set(_j,_c.encode(_i,_g[_j]=""+_k));this.length=_f.push(_j);},removeItem:function(_j){var _k=_d.get(_j=_e+_j);if(_k!==null){delete _g[_j];_d.del(_j);this.length=_f.remove(_j);}},clear:function(){_d.clear();_g={};_f.length=0;}};var _e=_b.document.domain,_f=[],_g={},_h=_g.hasOwnProperty,_i;_f.remove=function(_j){var _k=this.indexOf(_j);if( -1<_k){this.splice(_k,1);}return this.length;};if(!_f.indexOf){_f.indexOf=function(_j){for(var _k=0,_l=this.length;_k<_l; ++_k){if(this[_k]===_j){return _k;}}return  -1;};}if(_b.sessionStorage){l=function(){};l.prototype=_b.sessionStorage;}l=new l;if(_f!==null){_a.sessionStorage=l;}})(JsNamespace.getGlobalContext());};}}