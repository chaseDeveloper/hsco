if(!JsNamespace.exist("Eco.XpCompEvent")){JsNamespace.declare("Eco.XpCompEvent",{"add":function(_a,_b,_c){for(var _d in _b){if(_b.hasOwnProperty(_d)){_a.addEventHandler(_d,_b[_d],_c);}}},"remove":function(_a,_b,_c){for(var _d in _b){if(_b.hasOwnProperty(_d)){_a.removeEventHandler(_d,_b[_d],_c);}}},"getPoint":function(_a,_b){if(!_b&&_a.fromobject){var _c=Eco.XPComp.getTopLevelForm(_a.fromobject);var _d=Eco.XPComp.PositionSize.convertXY(_c,[_a.screenX,_a.screenY]);return new Eco.Point(_d[0],_d[1]);}else{return new Eco.Point(_a.screenX,_a.screenY);}},"getOffset":function(_a,_b){if(_b==_a.fromobject){return new Eco.Point(_a.clientX,_a.clientY);}else{var _c=Eco.XPComp.PositionSize.convertXY(_b,[_a.screenX,_a.screenY]);return new Eco.Point(_c[0],_c[1]);}},"makeDraggable":function(_a,_b,_c,_d,_e,_f){if(Eco.isObject(_b)){_a._dragFuncs={"draggingFunc":_b.dragging,"draggingStartFunc":_b.start,"draggingEndFunc":_b.end,"args":_d,"isOffsetFromStart":_e};}else{_a._dragFuncs={"draggingFunc":_b,"args":_d,"isOffsetFromStart":_e};}Eco.XpCompEvent.add(_a,{"onlbuttondown":Eco.XpCompEvent.dragDownHandler,"onlbuttonup":Eco.XpCompEvent.dragUpHandler},_c);var _g=Eco.XPComp.getTopLevelForm(_a.parent);_a.__topForm=_g;if(_g.findEventHandler("onmousemove",Eco.XpCompEvent.dragMoveHandler)<0){_g.__makeDraggableTargets={};_g.addEventHandler("onmousemove",Eco.XpCompEvent.dragMoveHandler,_c);}var _h=_a._unique_id;var _g=Eco.XPComp.getTopLevelForm(_a.parent);_g.__makeDraggableTargets[_h]=true;if(_f){_a._delayDragProc=true;}else{_a._delayDragProc=null;}},"clearDraggable":function(_a){if(_a._dragFuncs){_a._dragFuncs=null;_a._delayDragProc=null;Eco.XpCompEvent.remove(_a,{"onlbuttondown":Eco.XpCompEvent.dragDownHandler,"onlbuttonup":Eco.XpCompEvent.dragUpHandler});var _b=Eco.XPComp.getTopLevelForm(_a.parent);var _c=_a._unique_id;var _d=false;var _e=_b.__makeDraggableTargets;for(var _f in _e){if(_e.hasOwnProperty(_f)){if(_f==_c){delete _e[_f];}else{_d=true;}}}if(!_d&&_b.findEventHandler("onmousemove",Eco.XpCompEvent.dragMoveHandler)> -1){delete _b.__makeDraggableTargets;delete _b.__makeDraggableCurComp;_b.removeEventHandler("onmousemove",Eco.XpCompEvent.dragMoveHandler);}}},"dragDownHandler":function(_a,_b){Eco.XpCompEvent._lockMouseEvent(_a.__topForm);var _c=Eco.XpCompEvent.getPoint(_b,true);_a._drag={"startPt":_c,"offsetX":0,"offsetY":0,"isOffsetFromStart":false};var _d=Eco.XPComp.getTopLevelForm(_a.parent);_d.__makeDraggableCurComp=_a;var _e=_a._dragFuncs,_f;if(_e){if(_e.isOffsetFromStart===true){_a._drag.isOffsetFromStart=true;}_f=_e.args;_e=_e.draggingStartFunc;}if(_e){var _g=[];if(_f){_g=_g.concat(_f);}var _h=_e.apply(this,_g);if(_h===false){_a._drag=null;}}},"dragUpHandler":function(_a,_b){var _c=_a._drag;var _d=Eco.XPComp.getTopLevelForm(_a.parent);_d.__makeDraggableCurComp=null;if(_c){Eco.XpCompEvent.cancelAnimationFrame(_a._reqDragId);_a._reqDragId=null;_a._drag=null;var _e=_a._dragFuncs,_f;if(_e){_f=_e.args;_e=_e.draggingEndFunc;}if(_e){var _g=[];if(_f){_g=_g.concat(_f);}_e.apply(this,_g);}}},"dragMoveHandler":function(_a,_b){var _c=_a.__makeDraggableCurComp;if(_c){var _d=_c._drag;if(_d){var _e=Eco.XpCompEvent.getPoint(_b,true);_c._dragCurPt=_e;if(_c._delayDragProc){Eco.XpCompEvent.cancelAnimationFrame(_c._reqDragId);_c._reqDragId=null;}_c._reqDragId=Eco.XpCompEvent.requestAnimationFrame(Eco.XpCompEvent._dragProcess,this,_c);}}},"_dragProcess":function(_a){var _b=_a._dragCurPt,_c=_a._drag;if(_c==null){return;}_c.offsetX=_b.x-_c.startPt.x;_c.offsetY=_b.y-_c.startPt.y;if(!_c.isOffsetFromStart){_c.startPt=_b;}var _d=_a._dragFuncs,_e;if(_d){_e=_d.args;_d=_d.draggingFunc;}if(_d){var _f=[_c.offsetX,_c.offsetY];if(_e){_f=_f.concat(_e);}_d.apply(this,_f);}},"_lockMouseEvent":function(_a){var _b=_a._getWindow();_b._mouseLockComp=_a;_b._on_sys_lbuttonup=Eco.XpCompEvent._on_default_sys_lbuttonup;_b._on_sys_mousemove=Eco.XpCompEvent._on_default_sys_mousemove;},"_on_default_sys_lbuttonup":function(_a,_b,_c,_d,_e,_f,_g,_h,_i){nexacro.Window.prototype._on_default_sys_lbuttonup.call(this,_a,_b,_c,_d,_e,_f,_g,_h,_i);this._on_sys_lbuttonup=nexacro.Window.prototype._on_default_sys_lbuttonup;this._on_sys_mousemove=nexacro.Window.prototype._on_default_sys_mousemove;this._mouseLockComp=null;},"_on_default_sys_mousemove":function(_a,_b,_c,_d,_e,_f,_g,_h,_i){_a=this._mouseLockComp._control_element;nexacro.Window.prototype._on_default_sys_mousemove.call(this,_a,_b,_c,_d,_e,_f,_g,_h,_i);},"makeRepeatable":function(_a,_b,_c,_d){if(Eco.isObject(_b)){_a._repeatFuncs={"repeatStartFunc":_b.start,"repeatEndFunc":_b.end,"repeatingFunc":_b.repeating,"repeatStopFunc":_b.repeatingStop,"args":_d};}else{_a._repeatFuncs={"repeatingFunc":_b,"args":_d};}Eco.XpCompEvent.add(_a,{"onlbuttondown":Eco.XpCompEvent.repeatDownHandler,"onlbuttonup":Eco.XpCompEvent.repeatUpHandler,"onmouseenter":Eco.XpCompEvent.repeatEnterHandler,"onmouseleave":Eco.XpCompEvent.repeatLeaveHandler},_c);},"clearRepeatable":function(_a){if(_a._repeatFuncs){_a._repeatFuncs=null;Eco.XpCompEvent.remove(_a,{"onlbuttondown":Eco.XpCompEvent.repeatDownHandler,"onlbuttonup":Eco.XpCompEvent.repeatUpHandler,"onmouseenter":Eco.XpCompEvent.repeatEnterHandler,"onmouseleave":Eco.XpCompEvent.repeatLeaveHandler});}},"cancelRepeatable":function(_a){var _b=_a._repeat;if(_b){Eco.XpCompEvent.cancelAnimationFrame(_a._reqRepeatId);_a._reqRepeatId=null;_a._repeat=null;}},"repeatDownHandler":function(_a,_b){_a._repeat={"curPoint":Eco.XpCompEvent.getOffset(_b,_a.parent)};var _c=_a._repeatFuncs,_d,_e;if(_c){_e=_c.args;_c=_c.repeatStartFunc;if(!_c){_c=null;}}if(_c){var _f=_a._repeat.curPoint;_d=[_f.x,_f.y];if(_e){_d=_d.concat(_e);}_c.apply(this,_d);}Eco.XpCompEvent._repeatProcess.call(this,_a);},"repeatUpHandler":function(_a,_b){Eco.XpCompEvent.cancelRepeatable(_a);var _c=_a._repeatFuncs,_d;if(_c){_d=_c.args;_c=_c.repeatEndFunc;if(!_c){_c=null;}}if(_c){if(!_d){_d=[];}_c.apply(this,_d);}},"repeatEnterHandler":function(_a,_b){var _c=_a._repeat;if(_c&&_c.curPoint){var _d=Eco.XpCompEvent.getOffset(_b,_a.parent);_c.curPoint=_d;if(_a._reqRepeatId===null){Eco.XpCompEvent._repeatProcess.call(this,_a);}}else{_a._repeat=null;}},"repeatLeaveHandler":function(_a,_b){var _c=_a._repeat;if(_c&&_c.curPoint){Eco.XpCompEvent.cancelAnimationFrame(_a._reqRepeatId);_a._reqRepeatId=null;var _d=_a._repeatFuncs,_e;if(_d){_e=_d.args;_d=_d.repeatStopFunc;if(!_d){_d=null;}}if(_d){if(!_e){_e=[];}_d.apply(this,_e);}}else{_a._repeat=null;}},"repeatMoveHandler":function(_a,_b){var _c=_a._repeat;if(_c&&_c.objRect){var _d=Eco.XpCompEvent.getOffset(_b,_a.parent);if(_c.objRect.contains(_d)){_c.curPoint=_d;if(_a._reqRepeatId===null){Eco.XpCompEvent._repeatProcess.call(this,_a);}}else{Eco.XpCompEvent.cancelAnimationFrame(_a._reqRepeatId);_a._reqRepeatId=null;var _e=_a._repeatFuncs,_f;if(_e){_f=_e.args;_e=_e.repeatStopFunc;if(!_e){_e=null;}}if(_e){if(!_f){_f=[];}_e.apply(this,_f);}}}else{_a._repeat=null;}},"_repeatProcess":function(_a){_a._reqRepeatId=Eco.XpCompEvent.requestAnimationFrame(Eco.XpCompEvent._repeatProcess,this,_a);var _b=_a._repeatFuncs,_c,_d;if(_b){_d=_b.args;_b=_b.repeatingFunc;if(!_b){_b=null;}}if(_b){var _e=_a._repeat;if(_e&&_e.curPoint){_c=[_e.curPoint.x,_e.curPoint.y];}else{_c=[ -1, -1];}if(_d){_c=_c.concat(_d);}_b.apply(this,_c);}},"requestAnimationFrame":function(_a,_b){var _c;if(arguments.length>2){_c=Eco.array.toArray(arguments,2);}else{_c=[];}var _d=nexacro._init_platform_runtime;var _e=Eco.XpCompEvent._requestAnimationFrameUseSetTimer;if(_e===undefined){_e=false;}var _f=Eco.XpCompEvent._requestAnimationFrame;if(!_f){if(_d){_f=function(_j,_a,_l){var _n=_l.lastTime;var _o=new Date().getTime();var _p=Math.max(0,16-(_o-_n));var _m=nexacro.OnceCallbackTimer.callonce(_j,_a,_p);_l.lastTime=_o+_p;return _m;};}else{var _g=JsNamespace.getGlobalContext();_f=_g.requestAnimationFrame;if(!_f){var _h=['ms','moz','webkit','o'];for(var _n=0;_n<_h.length&&!_f; ++_n){_f=_g[_h[_n]+'RequestAnimationFrame'];}if(!_f){_f=function(_a,_l){var _o=_l.lastTime;var _p=new Date().getTime();var _q=Math.max(0,16-(_p-_o));var _i=_g.setTimeout(_a,_q);_l.lastTime=_p+_q;return _i;};Eco.XpCompEvent._requestAnimationFrameUseSetTimer=true;_e=true;}}}Eco.XpCompEvent._requestAnimationFrame=_f;}if(!Eco.XpCompEvent._requestAnimationFrameLastTimeInfo){Eco.XpCompEvent._requestAnimationFrameLastTimeInfo={};}var _i;if(_d){var _j=Eco.XpCompEvent._getRequestAnimationFrameForm(_b);var _k=_a.toString();var _l=Eco.XpCompEvent._requestAnimationFrameLastTimeInfo[_k];if(_l===undefined){Eco.XpCompEvent._requestAnimationFrameLastTimeInfo[_a.toString()]={'lastTime':0,'timers':[]};_l=Eco.XpCompEvent._requestAnimationFrameLastTimeInfo[_k];}var _m=_f(_j,function(){_a.apply(_b,_c);},_l);_i=_m._handle;_l.id=_i;_l.timers.push(_m);}else if(_e){var _k=_a.toString();var _l=Eco.XpCompEvent._requestAnimationFrameLastTimeInfo[_a.toString()];if(_l===undefined){Eco.XpCompEvent._requestAnimationFrameLastTimeInfo[_k]={'lastTime':0};_l=Eco.XpCompEvent._requestAnimationFrameLastTimeInfo[_k];}_i=_f(function(){_a.apply(_b,_c);},_l);_l.id=_i;}else{_i=_f(function(){_a.apply(_b,_c);});}return _i;},"_getRequestAnimationFrameForm":function(_a){var _b;if(_a._getReferenceContext){_b=_a._getReferenceContext();}else{var _c=application.mainframe.all[0];do{if(_c instanceof ChildFrame){break;}_c=_c.all[0];}while(true)_b=_c.form;}return _b;},"cancelAnimationFrame":function(_a){var _b=Eco.XpCompEvent._cancelAnimationFrame;if(!_b){if(nexacro._init_platform_runtime){_b=function(_a){var _e=Eco.XpCompEvent._requestAnimationFrameLastTimeInfo;if(_e){for(var _g in _e){if(_e.hasOwnProperty(_g)){if(_a==_e[_g].id){var _f=_e[_g].timers;for(var _h=0,_i=_f.length;_h<_i;_h++ ){_f[_h].destroy();_f[_h]=null;}_e[_g]=null;delete _e[_g];break;}}}}};}else{var _c=JsNamespace.getGlobalContext();_b=_c.cancelAnimationFrame;if(!_b){var _d=['ms','moz','webkit','o'];for(var _e=0;_e<_d.length&&!_b; ++_e){_b=_c[_d[_e]+'CancelAnimationFrame']||_c[_d[_e]+'CancelRequestAnimationFrame'];}if(!_b){_b=function(_a){_c.clearTimeout(_a);var _f=Eco.XpCompEvent._requestAnimationFrameLastTimeInfo;if(_f){for(var _g in _f){if(_f.hasOwnProperty(_g)){if(_a==_f[_g].id){_f[_g]=null;delete _f[_g];break;}}}}};}}}Eco.XpCompEvent._cancelAnimationFrame=_b;}_b(_a);}});}