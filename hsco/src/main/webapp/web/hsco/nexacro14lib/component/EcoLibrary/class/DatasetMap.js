if(!JsNamespace.exist("Eco.DatasetMap")){JsNamespace.declareClass("Eco.DatasetMap",{initialize:function(){this.clear();this._indexMapNeedRefresh=true;return this;},clear:function(){if(!this.datas||this.datas.length){this.datas=[];this.keyMap={};this._indexMap=null;this._rebuildIndexMap=true;}},containsKey:function(_a){return this.keyMap.hasOwnProperty(_a+"");},findRowByKey:function(_a){if(this._rebuildIndexMap){var _b={},_c=this.datas,_d;for(var _f=0,_g=_c.length;_f<_g;_f++ ){_d=_c[_f];_b[_d.key]=_f;}this._indexMap=_b;this._rebuildIndexMap=false;}var _e=this._indexMap[_a+""];return _e==null? -1:_e;},insert:function(_a,_b,_c,_d){if(this.containsKey(_b)){return;}_c.key=_b+"";if(_d===false){this.keyMap[_b+""]=_c;this.datas[_a]=_c;}if(_d||(_a> -1&&_a<this.datas.length)){this.keyMap[_b+""]=_c;this.datas.splice(_a,0,_c);}else{this.add(_b,_c);}this._rebuildIndexMap=true;},add:function(_a,_b){_a=_a+"";if(this.containsKey(_a)){return;}_b.key=_a;this.keyMap[_a]=_b;this.datas.push(_b);this._rebuildIndexMap=true;},removeAt:function(_a){var _b=this.datas[_a];if(!_b){return false;}var _c=_b.key;if(!this.containsKey(_c)){return false;}delete this.keyMap[_c];this.datas.splice(_a,1);this._rebuildIndexMap=true;},removeAtKey:function(_a){_a=_a+"";if(!this.containsKey(_a)){return false;}var _b=this.findRowByKey(_a);if(_b== -1){return false;}delete this.keyMap[_a];this.datas.splice(_b,1);this._rebuildIndexMap=true;},buildDataWithDataset:function(_a,_b,_c,_d){this.clear();var _e,_f,_g=this.datas,_h=this.keyMap;for(var _i=0,_j=_a.rowcount;_i<_j;_i++ ){_e=_a.getColumn(_i,_b)+"";_f=_c.call(_d,_a,_i,_e);_f.key=_e;_g[_i]=_f;_h[_e]=_f;}this._rebuildIndexMap=true;},getAt:function(_a){return this.datas[_a];},getByKey:function(_a){return this.keyMap[_a];},moveRow:function(_a,_b){var _c=this.datas.length;if(_a<0||_a>=_c){return;}if(_b<0||_b>_c){return;}if(_a>_b){var _d=this.datas[_a];this.datas.splice(_b,0,_d);this.datas.splice(_a+1,1);this._rebuildIndexMap=true;}else if(_a<_b){var _d=this.datas[_a];this.datas.splice(_a,1);this.datas.splice(_b-1,0,_d);this._rebuildIndexMap=true;}}});}