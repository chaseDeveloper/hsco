if(!window.RichTextEditor){throw new Error("RichTextEditor is not defined !!");}if(!RichTextEditor.Highlight){throw new Error("RichTextEditor.Highlight is not defined !!");}if(!RichTextEditor.Highlight.ParseJavaScript){RichTextEditor.Highlight.ParseJavaScript={init:function(){var _a=arguments[0];var _b=_a.indentUnit;var _c=_a.tokenizeJavaScript;var _d={"atom":true,"number":true,"variable":true,"string":true,"regexp":true};var _e=false;function JSLexical(_f,_g,_h,_i,_j,_k){this.indented=_f;this.column=_g;this.type=_h;if(_i!=null){this.align=_i;}this.prev=_j;this.info=_k;}function indentJS(_f){return function(_g){var _h=_g&&_g.charAt(0),_i=_f.type;var _j=_h==_i;if(_i=="vardef"){return _f.indented+4;}else if(_i=="form"&&_h=="{"){return _f.indented;}else if(_i=="stat"||_i=="form"){return _f.indented+_b;}else if(_f.info=="switch"&&!_j){return _f.indented+(/^(?:case|default)\b/.test(_g)?_b:2*_b);}else if(_f.align){return _f.column-(_j?1:0);}else{return _f.indented+(_j?0:_b);}};}function parseJS(_f,_g){var _h=_c(_f);var _i=[_e?expressions:statements];var _j=null;var _k=new JSLexical((_g||0)-_b,0,"block",false);var _l=0;var _m=0;var _n,_o;var _p={next:next,copy:copy};function next(){while(_i[_i.length-1].lex){_i.pop()();}var _q=_h.next();if(_q.type=="whitespace"&&_l==0){_m=_q.value.length;}_l+=_q.value.length;if(_q.content=="\n"){_m=_l=0;if(!("align" in _k)){_k.align=false;}_q.indentation=indentJS(_k);}if(_q.type=="whitespace"||_q.type=="comment"){return _q;}if(!("align" in _k)){_k.align=true;}while(true){_n=_o=false;_i.pop()(_q.type,_q.content);if(_n){if(_o){_q.style=_o;}else if(_q.type=="variable"&&inScope(_q.content)){_q.style="js-localvariable";}return _q;}}}function copy(){var _q=_j,_r=_k,_s=_i.concat([]),_t=_h.state;return function copyParser(_f){_j=_q;_k=_r;_i=_s.concat([]);_l=_m=0;_h=_c(_f,_t);return _p;};}function push(_q){for(var _r=_q.length-1;_r>=0;_r-- ){_i.push(_q[_r]);}}function cont(){push(arguments);_n=true;}function pass(){push(arguments);_n=false;}function mark(_q){_o=_q;}function pushcontext(){_j={prev:_j,vars:{"this":true,"arguments":true}};}function popcontext(){_j=_j.prev;}function register(_q){if(_j){mark("js-variabledef");_j.vars[_q]=true;}}function inScope(_q){var _r=_j;while(_r){if(_r.vars[_q]){return true;}_r=_r.prev;}return false;}function pushlex(_q,_r){var _s=function(){_k=new JSLexical(_m,_l,_q,null,_k,_r);};_s.lex=true;return _s;}function poplex(){if(_k.type==")"){_m=_k.indented;}_k=_k.prev;}poplex.lex=true;function expect(_q){return function expecting(_r){if(_r==_q){cont();}else if(_q==";"){pass();}else{cont(arguments.callee);}};}function statements(_q){return pass(statement,statements);}function expressions(_q){return pass(expression,expressions);}function statement(_q){if(_q=="var"){cont(pushlex("vardef"),vardef1,expect(";"),poplex);}else if(_q=="keyword a"){cont(pushlex("form"),expression,statement,poplex);}else if(_q=="keyword b"){cont(pushlex("form"),statement,poplex);}else if(_q=="{"){cont(pushlex("}"),block,poplex);}else if(_q==";"){cont();}else if(_q=="function"){cont(functiondef);}else if(_q=="for"){cont(pushlex("form"),expect("("),pushlex(")"),forspec1,expect(")"),poplex,statement,poplex);}else if(_q=="variable"){cont(pushlex("stat"),maybelabel);}else if(_q=="switch"){cont(pushlex("form"),expression,pushlex("}","switch"),expect("{"),block,poplex,poplex);}else if(_q=="case"){cont(expression,expect(":"));}else if(_q=="default"){cont(expect(":"));}else if(_q=="catch"){cont(pushlex("form"),pushcontext,expect("("),funarg,expect(")"),statement,poplex,popcontext);}else{pass(pushlex("stat"),expression,expect(";"),poplex);}}function expression(_q){if(_d.hasOwnProperty(_q)){cont(maybeoperator);}else if(_q=="function"){cont(functiondef);}else if(_q=="keyword c"){cont(expression);}else if(_q=="("){cont(pushlex(")"),expression,expect(")"),poplex,maybeoperator);}else if(_q=="operator"){cont(expression);}else if(_q=="["){cont(pushlex("]"),commasep(expression,"]"),poplex,maybeoperator);}else if(_q=="{"){cont(pushlex("}"),commasep(objprop,"}"),poplex,maybeoperator);}else{cont();}}function maybeoperator(_q,_r){if(_q=="operator"&&/\+\+|--/.test(_r)){cont(maybeoperator);}else if(_q=="operator"){cont(expression);}else if(_q==";"){pass();}else if(_q=="("){cont(pushlex(")"),commasep(expression,")"),poplex,maybeoperator);}else if(_q=="."){cont(property,maybeoperator);}else if(_q=="["){cont(pushlex("]"),expression,expect("]"),poplex,maybeoperator);}}function maybelabel(_q){if(_q==":"){cont(poplex,statement);}else{pass(maybeoperator,expect(";"),poplex);}}function property(_q){if(_q=="variable"){mark("js-property");cont();}}function objprop(_q){if(_q=="variable"){mark("js-property");}if(_d.hasOwnProperty(_q)){cont(expect(":"),expression);}}function commasep(_q,_r){function proceed(_s){if(_s==","){cont(_q,proceed);}else if(_s==_r){cont();}else{cont(expect(_r));}}return function commaSeparated(_s){if(_s==_r){cont();}else{pass(_q,proceed);}};}function block(_q){if(_q=="}"){cont();}else{pass(statement,block);}}function vardef1(_q,_r){if(_q=="variable"){register(_r);cont(vardef2);}else{cont();}}function vardef2(_q,_r){if(_r=="="){cont(expression,vardef2);}else if(_q==","){cont(vardef1);}}function forspec1(_q){if(_q=="var"){cont(vardef1,forspec2);}else if(_q==";"){pass(forspec2);}else if(_q=="variable"){cont(formaybein);}else{pass(forspec2);}}function formaybein(_q,_r){if(_r=="in"){cont(expression);}else{cont(maybeoperator,forspec2);}}function forspec2(_q,_r){if(_q==";"){cont(forspec3);}else if(_r=="in"){cont(expression);}else{cont(expression,expect(";"),forspec3);}}function forspec3(_q){if(_q==")"){pass();}else{cont(expression);}}function functiondef(_q,_r){if(_q=="variable"){register(_r);cont(functiondef);}else if(_q=="("){cont(pushlex(")"),pushcontext,commasep(funarg,")"),poplex,statement,popcontext);}}function funarg(_q,_r){if(_q=="variable"){register(_r);cont();}}return _p;}return {make:parseJS,electricChars:"{}:",configure:function(_f){if(_f.json!=null){_e=_f.json;}}};}};}