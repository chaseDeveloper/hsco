(function(){return function(){if(!this._is_form){return;}this.on_create=function(){var _a=null;if(Form==this.constructor){this.set_name("PRJ020102");this.set_classname("PRJ020102");this.set_titletext("PRJ020102_공통코드관리");this._setFormPosition(0,0,1059,735);}_a=new Dataset("ds_xls",this);_a.set_useclientlayout("1");_a._setContents("<ColumnInfo><Column id=\"BSNS_CL\" type=\"STRING\" size=\"3\"/><Column id=\"BSNS_CMMN_CODE\" type=\"STRING\" size=\"6\"/><Column id=\"LCLAS_NM\" type=\"STRING\" size=\"100\"/><Column id=\"MLSFC_NM\" type=\"STRING\" size=\"100\"/><Column id=\"SCLAS_NM\" type=\"STRING\" size=\"100\"/><Column id=\"RM\" type=\"STRING\" size=\"200\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_validation",this);_a._setContents("<ColumnInfo><Column id=\"compId\" type=\"STRING\" size=\"256\"/><Column id=\"colId\" type=\"STRING\" size=\"256\"/><Column id=\"PK\" type=\"STRING\" size=\"256\"/><Column id=\"notNull\" type=\"STRING\" size=\"256\"/><Column id=\"type\" type=\"STRING\" size=\"256\"/><Column id=\"nlength\" type=\"STRING\" size=\"256\"/><Column id=\"from\" type=\"STRING\" size=\"256\"/><Column id=\"to\" type=\"STRING\" size=\"256\"/><Column id=\"lengthChkGb\" type=\"STRING\" size=\"256\"/><Column id=\"msgId\" type=\"STRING\" size=\"256\"/><Column id=\"expr\" type=\"STRING\" size=\"256\"/><Column id=\"func\" type=\"STRING\" size=\"256\"/></ColumnInfo><Rows><Row><Col id=\"compId\">ds_1</Col><Col id=\"colId\">CODE</Col><Col id=\"notNull\">Y</Col><Col id=\"msgId\">코드</Col></Row><Row><Col id=\"compId\">ds_1</Col><Col id=\"colId\">CODE_NM</Col><Col id=\"notNull\">Y</Col><Col id=\"msgId\">용지구분</Col></Row><Row><Col id=\"compId\">ds_2</Col><Col id=\"colId\">CODE</Col><Col id=\"notNull\">Y</Col><Col id=\"msgId\">코드</Col></Row><Row><Col id=\"compId\">ds_2</Col><Col id=\"colId\">CODE_NM</Col><Col id=\"notNull\">Y</Col><Col id=\"msgId\">공급유형</Col></Row><Row><Col id=\"compId\">ds_3</Col><Col id=\"colId\">CODE</Col><Col id=\"notNull\">Y</Col><Col id=\"msgId\">코드</Col></Row><Row><Col id=\"compId\">ds_3</Col><Col id=\"colId\">CODE_NM</Col><Col id=\"notNull\">Y</Col><Col id=\"msgId\">공급유형상세</Col></Row></Rows>");this.addChild(_a.name,_a);_a=new Dataset("ds_cond1",this);_a._setContents("<ColumnInfo><Column id=\"LVL\" type=\"INT\" size=\"1\"/><Column id=\"SAL_SE\" type=\"STRING\" size=\"1\"/><Column id=\"CODE\" type=\"STRING\" size=\"6\"/><Column id=\"CODE_NM\" type=\"STRING\" size=\"100\"/><Column id=\"UPPER_CODE\" type=\"STRING\" size=\"6\"/><Column id=\"USE_AT\" type=\"STRING\" size=\"1\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_PRJ011",this);_a._setContents("");this.addChild(_a.name,_a);_a=new Dataset("ds_tmp",this);_a._setContents("");this.addChild(_a.name,_a);_a=new Dataset("ds_0",this);_a.set_useclientlayout("1");_a._setContents("<ColumnInfo><Column id=\"LVL\" type=\"INT\" size=\"1\"/><Column id=\"SAL_SE\" type=\"STRING\" size=\"1\"/><Column id=\"CODE\" type=\"STRING\" size=\"6\"/><Column id=\"CODE_NM\" type=\"STRING\" size=\"100\"/><Column id=\"UPPER_CODE\" type=\"STRING\" size=\"6\"/><Column id=\"USE_AT\" type=\"STRING\" size=\"1\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_1",this);_a.set_useclientlayout("1");_a._setContents("<ColumnInfo><Column id=\"LVL\" type=\"INT\" size=\"1\"/><Column id=\"SAL_SE\" type=\"STRING\" size=\"1\"/><Column id=\"CODE\" type=\"STRING\" size=\"6\"/><Column id=\"CODE_NM\" type=\"STRING\" size=\"100\"/><Column id=\"UPPER_CODE\" type=\"STRING\" size=\"6\"/><Column id=\"USE_AT\" type=\"STRING\" size=\"1\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_2",this);_a.set_useclientlayout("1");_a._setContents("<ColumnInfo><Column id=\"LVL\" type=\"INT\" size=\"1\"/><Column id=\"SAL_SE\" type=\"STRING\" size=\"1\"/><Column id=\"CODE\" type=\"STRING\" size=\"6\"/><Column id=\"CODE_NM\" type=\"STRING\" size=\"100\"/><Column id=\"UPPER_CODE\" type=\"STRING\" size=\"6\"/><Column id=\"USE_AT\" type=\"STRING\" size=\"1\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_3",this);_a.set_useclientlayout("1");_a._setContents("<ColumnInfo><Column id=\"LVL\" type=\"INT\" size=\"1\"/><Column id=\"SAL_SE\" type=\"STRING\" size=\"1\"/><Column id=\"CODE\" type=\"STRING\" size=\"6\"/><Column id=\"CODE_NM\" type=\"STRING\" size=\"100\"/><Column id=\"UPPER_CODE\" type=\"STRING\" size=\"6\"/><Column id=\"USE_AT\" type=\"STRING\" size=\"1\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Static("sta_gud_v01","absolute",null,"0","28",null,"0","0",this);_a.set_text("28");_a.set_visible("0");_a.style.set_background("#1b3cd23c");_a.style.set_align("center");this.addChild(_a.name,_a);_a=new Div("div_search","absolute","0","0",null,"33","28",null,this);_a.set_taborder("1");_a.set_cssclass("div_WFSA_Box");this.addChild(_a.name,_a);_a=new Static("sta_1","absolute","15","5","60","21",null,null,this.div_search);_a.set_text("판매구분");_a.set_cssclass("sta_WFSA_Label");this.div_search.addChild(_a.name,_a);_a=new Combo("cmb_1","absolute","80","5","140","21",null,null,this.div_search);this.div_search.addChild(_a.name,_a);_a.set_taborder("1");_a.set_innerdataset("@ds_PRJ011");_a.set_codecolumn("CODE");_a.set_datacolumn("CODE_NM");_a=new Button("btn_xls_dn","absolute",null,"5","25","21","32",null,this.div_search);_a.set_taborder("11");_a.set_cssclass("btn_WF_Gridexceldn");_a.set_visible("0");this.div_search.addChild(_a.name,_a);_a=new Button("btn_xls_up","absolute",null,"5","25","21","5",null,this.div_search);_a.set_taborder("12");_a.set_cssclass("btn_WF_Gridexcelup");_a.set_visible("0");this.div_search.addChild(_a.name,_a);_a=new Div("div_work","absolute","0","33",null,null,"28","0",this);_a.set_taborder("2");this.addChild(_a.name,_a);_a=new Div("div_1","absolute","0","0","360",null,null,"0",this.div_work);_a.set_taborder("1");this.div_work.addChild(_a.name,_a);_a=new Static("sta_gud_v01","absolute",null,"0","10",null,"0","0",this.div_work.div_1);_a.set_text("10");_a.set_visible("0");_a.style.set_background("#1b3cd23c");_a.style.set_align("center");this.div_work.div_1.addChild(_a.name,_a);_a=new Static("sta_gud_h01","absolute","0","0",null,"10","0",null,this.div_work.div_1);_a.set_text("10");_a.set_visible("0");_a.style.set_background("#dc143c3c");_a.style.set_align("center");this.div_work.div_1.addChild(_a.name,_a);_a=new Static("sta_gud_h02","absolute","0","29",null,"5","0",null,this.div_work.div_1);_a.set_text("5");_a.set_visible("0");_a.style.set_background("#dc143c3c");_a.style.set_align("center");this.div_work.div_1.addChild(_a.name,_a);_a=new Static("sta_1","absolute","0","10","200","19",null,null,this.div_work.div_1);_a.set_text("대분류");_a.set_cssclass("sta_WF_Title01");_a.style.set_background("transparent URL('theme://images/sta_WF_Title02.png') left middle");this.div_work.div_1.addChild(_a.name,_a);_a=new Grid("grd_1","absolute","0","34",null,null,"10","0",this.div_work.div_1);_a.set_taborder("1");_a.set_binddataset("ds_1");_a.set_autofittype("col");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"60\"/><Column size=\"285\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"24\"/></Rows><Band id=\"head\"><Cell cssclass=\"Cellgrd_WF_HeadEssential\" text=\"코드\"/><Cell col=\"1\" text=\"용지구분\"/></Band><Band id=\"body\"><Cell edittype=\"expr:dataset.getRowType(currow)==2 ? 'normal' : ''\" text=\"bind:CODE\" editlimit=\"0\"/><Cell col=\"1\" edittype=\"text\" style=\"align:left;\" text=\"bind:CODE_NM\" editlimit=\"0\" editimemode=\"hangul\"/></Band></Format></Formats>");this.div_work.div_1.addChild(_a.name,_a);_a=new Div("div_2","absolute","360","0","350",null,null,"0",this.div_work);_a.set_taborder("2");this.div_work.addChild(_a.name,_a);_a=new Static("sta_gud_h01","absolute","0","0",null,"10","0",null,this.div_work.div_2);_a.set_text("10");_a.set_visible("0");_a.style.set_background("#dc143c3c");_a.style.set_align("center");this.div_work.div_2.addChild(_a.name,_a);_a=new Static("sta_gud_h02","absolute","0","29",null,"5","0",null,this.div_work.div_2);_a.set_text("5");_a.set_visible("0");_a.style.set_background("#dc143c3c");_a.style.set_align("center");this.div_work.div_2.addChild(_a.name,_a);_a=new Static("sta_1","absolute","0","10","200","19",null,null,this.div_work.div_2);_a.set_text("중분류");_a.set_cssclass("sta_WF_Title02");this.div_work.div_2.addChild(_a.name,_a);_a=new Grid("grd_2","absolute","0","34",null,null,"0","0",this.div_work.div_2);_a.set_taborder("0");_a.set_binddataset("ds_2");_a.set_autofittype("col");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"60\"/><Column size=\"289\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"24\"/></Rows><Band id=\"head\"><Cell cssclass=\"Cellgrd_WF_HeadEssential\" text=\"코드\"/><Cell col=\"1\" text=\"공급유형\"/></Band><Band id=\"body\"><Cell edittype=\"expr:dataset.getRowType(currow)==2 ? 'normal' : ''\" text=\"bind:CODE\" editlimit=\"0\"/><Cell col=\"1\" edittype=\"text\" style=\"align:left;\" text=\"bind:CODE_NM\" editlimit=\"0\" editimemode=\"hangul\"/></Band></Format></Formats>");this.div_work.div_2.addChild(_a.name,_a);_a=new Button("btn_21","absolute",null,"10","64","19","67",null,this.div_work.div_2);_a.set_taborder("1");_a.set_text("행추가");_a.set_cssclass("btn_WF_Gridadd");this.div_work.div_2.addChild(_a.name,_a);_a=new Button("btn_22","absolute",null,"10","64","19","0",null,this.div_work.div_2);_a.set_taborder("2");_a.set_text("행삭제");_a.set_cssclass("btn_WF_Griddel");this.div_work.div_2.addChild(_a.name,_a);_a=new Div("div_3","absolute","710","0",null,null,"0","0",this.div_work);_a.set_taborder("3");this.div_work.addChild(_a.name,_a);_a=new Static("sta_gud_v01","absolute","0","0","10",null,null,"0",this.div_work.div_3);_a.set_text("10");_a.set_visible("0");_a.style.set_background("#1b3cd23c");_a.style.set_align("center");this.div_work.div_3.addChild(_a.name,_a);_a=new Static("sta_gud_h01","absolute","0","0",null,"10","0",null,this.div_work.div_3);_a.set_text("10");_a.set_visible("0");_a.style.set_background("#dc143c3c");_a.style.set_align("center");this.div_work.div_3.addChild(_a.name,_a);_a=new Static("sta_gud_h02","absolute","0","29",null,"5","0",null,this.div_work.div_3);_a.set_text("5");_a.set_visible("0");_a.style.set_background("#dc143c3c");_a.style.set_align("center");this.div_work.div_3.addChild(_a.name,_a);_a=new Static("sta_1","absolute","10","10","200","19",null,null,this.div_work.div_3);_a.set_text("소분류");_a.set_cssclass("sta_WF_Title03");_a.style.set_background("transparent URL('theme://images/sta_WF_Title02.png') left middle");this.div_work.div_3.addChild(_a.name,_a);_a=new Grid("grd_3","absolute","10","34",null,null,"0","0",this.div_work.div_3);_a.set_taborder("0");_a.set_binddataset("ds_3");_a.set_autofittype("col");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"60\"/><Column size=\"248\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"24\"/></Rows><Band id=\"head\"><Cell cssclass=\"Cellgrd_WF_HeadEssential\" text=\"코드\"/><Cell col=\"1\" text=\"공급유형상세\"/></Band><Band id=\"body\"><Cell edittype=\"expr:dataset.getRowType(currow)==2 ? 'normal' : ''\" text=\"bind:CODE\" editlimit=\"0\"/><Cell col=\"1\" edittype=\"text\" style=\"align:left;\" text=\"bind:CODE_NM\" editlimit=\"0\" editimemode=\"hangul\"/></Band></Format></Formats>");this.div_work.div_3.addChild(_a.name,_a);_a=new Button("btn_31","absolute",null,"10","64","19","67",null,this.div_work.div_3);_a.set_taborder("1");_a.set_text("행추가");_a.set_cssclass("btn_WF_Gridadd");this.div_work.div_3.addChild(_a.name,_a);_a=new Button("btn_32","absolute",null,"10","64","19","0",null,this.div_work.div_3);_a.set_taborder("2");_a.set_text("행삭제");_a.set_cssclass("btn_WF_Griddel");this.div_work.div_3.addChild(_a.name,_a);_a=new Grid("grd_xls","absolute","0",null,null,"0","0",null,this);_a.set_taborder("4");_a.set_binddataset("ds_xls");_a.getSetter("autofittype2").set("col");_a.getSetter("top2").set("105");_a.getSetter("bottom2").set("181");_a.set_visible("0");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"30\"/><Column size=\"40\"/><Column size=\"90\"/><Column size=\"150\"/><Column size=\"150\"/><Column size=\"150\"/><Column size=\"350\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"24\" band=\"head\"/><Row size=\"24\"/><Row size=\"24\" band=\"summ\"/></Rows><Band id=\"head\"><Cell row=\"0\" col=\"0\" colspan=\"7\" style=\"background:yellow;\" text=\"공통코드\"/><Cell row=\"1\" col=\"0\" style=\"background:yellow;\" text=\"순번\"/><Cell row=\"1\" col=\"1\" style=\"background:yellow;\" text=\"분류\"/><Cell row=\"1\" col=\"2\" style=\"background:yellow;\" text=\"코드\"/><Cell row=\"1\" col=\"3\" style=\"background:yellow;\" text=\"대분류명\"/><Cell row=\"1\" col=\"4\" style=\"background:yellow;\" text=\"중분류명\"/><Cell row=\"1\" col=\"5\" style=\"background:yellow;\" text=\"소분류명\"/><Cell row=\"1\" col=\"6\" style=\"background:yellow;\" text=\"비고\"/></Band><Band id=\"body\"><Cell col=\"0\" expr=\"currow+1\"/><Cell col=\"1\" text=\"bind:BSNS_CL\" displaytype=\"combo\" combodataset=\"ds_PRJ011\" combocodecol=\"CODE\" combodatacol=\"CODE_NM\"/><Cell col=\"2\" text=\"bind:BSNS_CMMN_CODE\"/><Cell col=\"3\" text=\"bind:LCLAS_NM\" style=\"align:left;\"/><Cell col=\"4\" text=\"bind:MLSFC_NM\" style=\"align:left;\"/><Cell col=\"5\" text=\"bind:SCLAS_NM\" style=\"align:left;\"/><Cell col=\"6\" text=\"bind:RM\" style=\"align:left;\"/></Band><Band id=\"summary\"><Cell col=\"0\"/><Cell col=\"1\" colspan=\"5\" style=\"align:left;\" text=\"   \"/></Band></Format></Formats>");this.addChild(_a.name,_a);_a=new Layout("default","",0,33,this.div_search,function(_b){_b.set_taborder("1");_b.set_cssclass("div_WFSA_Box");});this.div_search.addLayout(_a.name,_a);_a=new Layout("default","",360,0,this.div_work.div_1,function(_b){_b.set_taborder("1");});this.div_work.div_1.addLayout(_a.name,_a);_a=new Layout("default","",350,0,this.div_work.div_2,function(_b){_b.set_taborder("2");});this.div_work.div_2.addLayout(_a.name,_a);_a=new Layout("default","",0,0,this.div_work.div_3,function(_b){_b.set_taborder("3");});this.div_work.div_3.addLayout(_a.name,_a);_a=new Layout("default","",0,0,this.div_work,function(_b){_b.set_taborder("2");});this.div_work.addLayout(_a.name,_a);_a=new Layout("default","",1059,735,this,function(_b){_b.set_classname("PRJ020102");_b.set_titletext("PRJ020102_공통코드관리");});this.addLayout(_a.name,_a);_a=new BindItem("item01","div_search.cmb_1","value","ds_cond1","BSNS_CL");this.addChild(_a.name,_a);_a.bind();_a=null;};this.addIncludeScript("PRJ020102.xfdl","pms_lib::pmsUtilInclude.xjs");this.registerScript("PRJ020102.xfdl",function(){this.PRJ020102_oninit=function(_a,_b){this.fn_init();this.fn_init_form();this.fn_init_dataset();this.form_id=application.gv_curFormId+'_';var _c;};this.PRJ020102_onload=function(_a,_b){this.fn_loadCombo();};this.fn_init_form=function(){};this.fn_init_dataset=function(){this.gfn_initCondDs(this,this.div_search);this.checkDs.push(this.ds_1);this.checkDs.push(this.ds_2);this.checkDs.push(this.ds_3);};this.fn_loadCombo=function(){var _a=[['ds_PRJ011','PRJ011',1,'']];var _b=function(_c,_d,_e){this.ds_PRJ011.set_filterstr('CODE < 3');this.fn_search();};this.gfn_comboLoad(_a,_b);};this.fn_search=function(){if(!this.gfn_checkValidation(this.div_search,this.ds_validation)){return;}this.ds_cond1.setColumn(0,"LVL",0);this.ds_cond1.setColumn(0,"SAL_SE",this.div_search.cmb_1.value);console.log(this.div_search.cmb_1.value);this.fn_transaction("mList",0);};this.fn_getList=function(_a){if(!_a){_a=1;}var _b=this.ds_cond1;var _c=_b.rowposition;var _d;switch(_a){case 1:break;case 2:_d=this.ds_1;sCols="CD1=CD1,"+"CD2=CD2,";break;case 3:_d=this.ds_2;sCols="CD1=CD1,"+"CD2=CD2,";break;}if(_d){if(_d.rowcount<1){return;}_b.copyRow(_c,_d,_d.rowposition,sCols);}_b.setColumn(_c,"LVL",_a);_b.setColumn(_c,"BSNS_CL",this.div_search.cmb_1.value);this.fn_transaction("mList",_a);};this.fn_save=function(){if(this.comUtils.isDatasetUpdated(this.ds_1)&&!this.gfn_checkValidation(this.ds_1,this.ds_validation)){return;}if(this.comUtils.isDatasetUpdated(this.ds_2)&&!this.gfn_checkValidation(this.ds_2,this.ds_validation)){return;}if(this.comUtils.isDatasetUpdated(this.ds_3)&&!this.gfn_checkValidation(this.ds_3,this.ds_validation)){return;}if(!this.gfn_message("confirm.저장.여부")){return;}this.fn_transaction("save",0);};this.fn_transaction=function(_a,_b){if(this.ds_cond1.rowcount<1){return;}var _c;var _d;var _e="hsco/pms/prj/PRJ020102/"+_a+".do";var _f="";var _g="";switch(_a){case "mList":_f="input1=ds_cond1";_g="ds_"+_b+"=output1";switch(_b){case 1:this.ds_1.clearData();case 2:this.ds_2.clearData();case 3:this.ds_3.clearData();}break;case "save":_f="input1=ds_1:U";_f+=" input2=ds_2:U";_f+=" input3=ds_3:U";break;case "xlsList":_g="ds_xls=output1";break;case "xSave":_f="input1=ds_x1s";break;}if(_d){this.ds_cond1.copyRow(0,_c,_c.rowposition,_d);}Ex.core.tran(this,_a,_e,_f,_g);};this.fn_callBack=function(_a,_b,_c){this.debug("fn_callBack() - "+_a+','+_b+','+_c);if(_b!=0){return this.gfn_callback_message(_a,_b,_c);}switch(_a){case "mList":this.ds_0.filter("LVL == 1");this.ds_1.copyData(this.ds_0,true);this.ds_1.getColumn(this.ds_1.rowposition,"CODE");var _d="LVL == 2 && UPPER_CODE == '"+this.ds_1.getColumn(this.ds_1.rowposition,"CODE")+"'";this.ds_0.filter(_d);this.ds_2.copyData(this.ds_0,true);_d="LVL == 3 && UPPER_CODE == '"+this.ds_2.getColumn(this.ds_2.rowposition,"CODE")+"'";this.ds_0.filter(_d);this.ds_3.copyData(this.ds_0,true);break;case "mList1":break;case "mList2":break;case "save":this.ds_cond1.setColumn(0,"LVL",0);this.ds_cond1.setColumn(0,"SAL_SE",this.div_search.cmb_1.value);this.fn_transaction("mList",0);break;case "save1":this.fn_getList(1);break;case "save2":this.fn_getList(2);break;case "save3":this.fn_getList(3);break;case "xlsList":this.fn_xls_dn_post(this.ds_xls);break;case "xSave":this.fn_search();this.gfn_message("success.작업완료.성공","엑셀 업로드");break;}};this.fn_insert=function(_a){this.fn_insertDS(this.ds_1);};this.fn_delete=function(_a){this.fn_deleteDS(this.ds_1);};this.fn_insertDS=function(_a){var _b;switch(_a){case this.ds_1:_b=this.ds_cond1;break;case this.ds_2:_b=this.ds_1;if(_b.rowcount<1){return;}break;case this.ds_3:_b=this.ds_2;if(_b.rowcount<1){return;}break;}if(Dataset.ROWTYPE_INSERT==_b.getRowType(_b.rowposition)){return;}var _c;var _d;var _e;var _f=_a.addRow();_a.setColumn(_f,"SAL_SE",this.div_search.cmb_1.value);_a.setColumn(_f,"USE_AT",'1');switch(_a){case this.ds_1:_c=1;break;case this.ds_2:_c=2;_a.setColumn(_f,"UPPER_CODE",this.ds_1.getColumn(this.ds_1.rowposition,"CODE"));break;case this.ds_3:_c=3;_a.setColumn(_f,"UPPER_CODE",this.ds_2.getColumn(this.ds_2.rowposition,"CODE"));break;}switch(_a){case this.ds_1:this.ds_2.clearData();case this.ds_2:this.ds_3.clearData();}};this.fn_deleteDS=function(_a){switch(_a){case this.ds_1:if(this.ds_2.rowcount>0){return this.alert("하위코드가 존재합니다.");}break;case this.ds_2:if(this.ds_3.rowcount>0){return this.alert("하위코드가 존재합니다.");}break;}_a.deleteRow(_a.rowposition);};this.fn_checkUpdated=function(_a){if(!this.checkDs){return false;}for(var _c=0;_c<this.checkDs.length;_c++ ){if(this.comUtils.isDatasetUpdated(this.checkDs[_c])){if(!_a){return true;}var _b=this.gfn_message("confirm.변경.취소.여부");if(!_b){this.checkDs[_c].reset();}return _b;}}};this.ds_onrowposchanged=function(_a,_b){if(_a.rowcount<1){return;}switch(_a){case this.ds_1:var _c="LVL == 2 && UPPER_CODE == '"+this.ds_1.getColumn(this.ds_1.rowposition,"CODE")+"'";this.ds_0.filter(_c);this.ds_2.copyData(this.ds_0,true);break;case this.ds_2:var _c="LVL == 3 && UPPER_CODE == '"+this.ds_2.getColumn(this.ds_2.rowposition,"CODE")+"'";this.ds_0.filter(_c);this.ds_3.copyData(this.ds_0,true);break;}};this.ds_cancolumnchange=function(_a,_b){if(_a.rowcount<1){return;}var _c;var _d=_b.newvalue;switch(_b.columnid){case 'CD1':_c=_a.name!='ds_1'?null:_b.columnid;break;case 'CD2':_c=_a.name!='ds_2'?null:_b.columnid;break;case 'CD3':_c=_a.name!='ds_3'?null:_b.columnid;break;default:return;}var _e=_a.findRowExpr(_c+" == '"+_d+"'");if( -1<_e){alert('중복 오류 : '+_d);return false;}};this.btn_21_onclick=function(_a,_b){this.fn_insertDS(this.ds_2);};this.btn_22_onclick=function(_a,_b){this.fn_deleteDS(this.ds_2);};this.btn_23_onclick=function(_a,_b){if(!this.gfn_checkValidation(this.ds_2,this.ds_validation)){return;}this.fn_transaction("save",2);};this.btn_31_onclick=function(_a,_b){this.fn_insertDS(this.ds_3);};this.btn_32_onclick=function(_a,_b){this.fn_deleteDS(this.ds_3);};this.btn_33_onclick=function(_a,_b){if(!this.gfn_checkValidation(this.ds_3,this.ds_validation)){return;}this.fn_transaction("save",3);};this.btn_xls_dn_onclick=function(_a,_b){this.fn_transaction("xlsList");};this.fn_xls_dn_post=function(_a){if(_a.rowcount<1){for(var _b=0;_b<8;_b++ ){_a.addRow();}}this.grd_xls.set_visible(0);this.grd_xls.set_visible(1);this.gfn_exportExcel(this.grd_xls,"exportExl");};this.g_xls_Cols_list='RN BSNS_CL BSNS_CMMN_CODE LCLAS_NM MLSFC_NM SCLAS_NM RM'.split(' ');this.g_xls_Cols;this.btn_xls_up_onclick=function(_a,_b){var _c=this.ds_xls;var _d=this.ds_tmp;_c.clearData();var _e=function(){if(!this.g_xls_Cols){var _g=this.g_xls_Cols_list;for(var _k=0;_k<_g.length;_k++ ){_g[_k]=_g[_k]+'=Column'+_k+',';}this.g_xls_Cols=_g.join('\n');}this.debug(_d.saveCSV());var _h,_i,_j;for(var _k=0;_k<_d.rowcount;_k++ ){_i=_d.getColumn(_k,'Column0');if(0==(parseInt(_i)||0)){continue;}this.debug(_k+':'+(parseInt(_i)||0)+'='+_i);_h=_c.addRow();_c.copyRow(_h,_d,_k,this.g_xls_Cols);_j=_c.getColumn(_h,'BSNS_CL');_c.setColumn(_h,'BSNS_CL',_j=='주택'?2:1);_j=''+_c.getColumn(_h,'BSNS_CMMN_CODE');_c.setColumn(_h,'BSNS_CMMN_CODE',_j.padLeft(6,'0'));}_c.set_keystring('S:+BSNS_CL+BSNS_CMMN_CODE');this.fn_transaction("xSave");};var _f={targetDs:_d,headSet:false,callBack:_e};this.gfn_importExcel(_f);};this.div_work_div_2_sta_gud_h02_onclick=function(_a,_b){};});this.on_initEvent=function(){this.ds_0.addEventHandler("onrowposchanged",this.ds_onrowposchanged,this);this.ds_0.addEventHandler("cancolumnchange",this.ds_cancolumnchange,this);this.ds_1.addEventHandler("onrowposchanged",this.ds_onrowposchanged,this);this.ds_2.addEventHandler("onrowposchanged",this.ds_onrowposchanged,this);this.ds_3.addEventHandler("onrowposchanged",this.ds_onrowposchanged,this);this.ds_3.addEventHandler("cancolumnchange",this.ds_cancolumnchange,this);this.addEventHandler("onload",this.PRJ020102_onload,this);this.addEventHandler("oninit",this.PRJ020102_oninit,this);this.div_search.cmb_1.addEventHandler("onitemchanged",this.fn_search,this);this.div_search.btn_xls_dn.addEventHandler("onclick",this.btn_xls_dn_onclick,this);this.div_search.btn_xls_up.addEventHandler("onclick",this.btn_xls_up_onclick,this);this.div_work.div_2.sta_gud_h02.addEventHandler("onclick",this.div_work_div_2_sta_gud_h02_onclick,this);this.div_work.div_2.btn_21.addEventHandler("onclick",this.btn_21_onclick,this);this.div_work.div_2.btn_22.addEventHandler("onclick",this.btn_22_onclick,this);this.div_work.div_3.btn_31.addEventHandler("onclick",this.btn_31_onclick,this);this.div_work.div_3.btn_32.addEventHandler("onclick",this.btn_32_onclick,this);};this.loadIncludeScript("PRJ020102.xfdl");};})();