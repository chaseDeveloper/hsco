(function(){return function(){if(!this._is_form){return;}this.on_create=function(){var _a=null;if(Form==this.constructor){this.set_name("PRJ050701");this.set_classname("PRJ050701");this.set_titletext("PRJ050701_메뉴제거_일위대가관리");this._setFormPosition(0,0,1059,735);}_a=new Dataset("ds_cnst",this);_a.set_useclientlayout("1");_a._setContents("<ColumnInfo><Column id=\"BSNS_CODE\" type=\"STRING\" size=\"5\"/><Column id=\"CNTRCT_NO\" type=\"STRING\" size=\"11\"/><Column id=\"CNST_CODE\" type=\"STRING\" size=\"4\"/><Column id=\"CL_SE\" type=\"STRING\" size=\"3\"/><Column id=\"CNST_NM_LRGE\" type=\"STRING\" size=\"50\"/><Column id=\"CNST_NM_MIDDL\" type=\"STRING\" size=\"50\"/><Column id=\"STRWRK_DE\" type=\"STRING\" size=\"8\"/><Column id=\"COMPET_DE\" type=\"STRING\" size=\"8\"/><Column id=\"PLAN_FAIR_RT\" type=\"BIGDECIMAL\" size=\"8\"/><Column id=\"DETAIL_FAIR_AT\" type=\"STRING\" size=\"1\"/><Column id=\"CODE_NM\" type=\"STRING\" size=\"50\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_1",this);_a.set_useclientlayout("1");_a._setContents("<ColumnInfo><Column id=\"BSNS_CODE\" type=\"STRING\" size=\"5\"/><Column id=\"CNTRCT_NO\" type=\"STRING\" size=\"11\"/><Column id=\"REPORT_DE\" type=\"STRING\" size=\"8\"/><Column id=\"CNST_CODE\" type=\"STRING\" size=\"4\"/><Column id=\"SN\" type=\"BIGDECIMAL\" size=\"11\"/><Column id=\"PRDNM\" type=\"STRING\" size=\"200\"/><Column id=\"STNDRD\" type=\"STRING\" size=\"200\"/><Column id=\"UNIT_NM\" type=\"STRING\" size=\"15\"/><Column id=\"QY\" type=\"BIGDECIMAL\" size=\"12\"/><Column id=\"MATRL_CT_UNTPC\" type=\"BIGDECIMAL\" size=\"16\"/><Column id=\"MATRL_CT_AMOUNT\" type=\"BIGDECIMAL\" size=\"16\"/><Column id=\"LBRC_CT_UNTPC\" type=\"BIGDECIMAL\" size=\"16\"/><Column id=\"LBRC_CT_AMOUNT\" type=\"BIGDECIMAL\" size=\"16\"/><Column id=\"EXPENS_UNTPC\" type=\"BIGDECIMAL\" size=\"16\"/><Column id=\"EXPENS_AMOUNT\" type=\"BIGDECIMAL\" size=\"16\"/><Column id=\"S_UNTPC\" type=\"BIGDECIMAL\" size=\"16\"/><Column id=\"S_AMOUNT\" type=\"BIGDECIMAL\" size=\"16\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_xls",this);_a.set_useclientlayout("1");_a._setContents("<ColumnInfo><Column id=\"BSNS_CODE\" type=\"STRING\" size=\"5\"/><Column id=\"CNTRCT_NO\" type=\"STRING\" size=\"11\"/><Column id=\"CNTRCT_NM\" type=\"STRING\" size=\"100\"/><Column id=\"CNST_CODE\" type=\"STRING\" size=\"4\"/><Column id=\"CODE_NM\" type=\"STRING\" size=\"50\"/><Column id=\"REPORT_DE\" type=\"STRING\" size=\"8\"/><Column id=\"CNST_CODE\" type=\"STRING\" size=\"4\"/><Column id=\"SN\" type=\"BIGDECIMAL\" size=\"11\"/><Column id=\"CL_SE\" type=\"STRING\" size=\"3\"/><Column id=\"PRDNM\" type=\"STRING\" size=\"200\"/><Column id=\"STNDRD\" type=\"STRING\" size=\"200\"/><Column id=\"UNIT_NM\" type=\"STRING\" size=\"15\"/><Column id=\"QY\" type=\"BIGDECIMAL\" size=\"12\"/><Column id=\"MATRL_CT_UNTPC\" type=\"BIGDECIMAL\" size=\"16\"/><Column id=\"MATRL_CT_AMOUNT\" type=\"BIGDECIMAL\" size=\"16\"/><Column id=\"LBRC_CT_UNTPC\" type=\"BIGDECIMAL\" size=\"16\"/><Column id=\"LBRC_CT_AMOUNT\" type=\"BIGDECIMAL\" size=\"16\"/><Column id=\"EXPENS_UNTPC\" type=\"BIGDECIMAL\" size=\"16\"/><Column id=\"EXPENS_AMOUNT\" type=\"BIGDECIMAL\" size=\"16\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_x0",this);_a.getSetter("updatecontrol2").set("0");_a.set_useclientlayout("1");_a._setContents("<ColumnInfo><Column id=\"BSNS_CODE\" type=\"STRING\" size=\"5\"/><Column id=\"CNTRCT_NO\" type=\"STRING\" size=\"11\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_x1",this);_a.getSetter("updatecontrol2").set("0");_a.set_useclientlayout("1");_a._setContents("<ColumnInfo><Column id=\"BSNS_CODE\" type=\"STRING\" size=\"5\"/><Column id=\"CNTRCT_NO\" type=\"STRING\" size=\"11\"/><Column id=\"CNTRCT_NM\" type=\"STRING\" size=\"100\"/><Column id=\"CNST_CODE\" type=\"STRING\" size=\"4\"/><Column id=\"CODE_NM\" type=\"STRING\" size=\"50\"/><Column id=\"REPORT_DE\" type=\"STRING\" size=\"8\"/><Column id=\"CNST_CODE\" type=\"STRING\" size=\"4\"/><Column id=\"SN\" type=\"BIGDECIMAL\" size=\"11\"/><Column id=\"CL_SE\" type=\"STRING\" size=\"3\"/><Column id=\"PRDNM\" type=\"STRING\" size=\"200\"/><Column id=\"STNDRD\" type=\"STRING\" size=\"200\"/><Column id=\"UNIT_NM\" type=\"STRING\" size=\"15\"/><Column id=\"QY\" type=\"BIGDECIMAL\" size=\"12\"/><Column id=\"MATRL_CT_UNTPC\" type=\"BIGDECIMAL\" size=\"16\"/><Column id=\"MATRL_CT_AMOUNT\" type=\"BIGDECIMAL\" size=\"16\"/><Column id=\"LBRC_CT_UNTPC\" type=\"BIGDECIMAL\" size=\"16\"/><Column id=\"LBRC_CT_AMOUNT\" type=\"BIGDECIMAL\" size=\"16\"/><Column id=\"EXPENS_UNTPC\" type=\"BIGDECIMAL\" size=\"16\"/><Column id=\"EXPENS_AMOUNT\" type=\"BIGDECIMAL\" size=\"16\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_validation",this);_a._setContents("<ColumnInfo><Column id=\"compId\" type=\"STRING\" size=\"256\"/><Column id=\"colId\" type=\"STRING\" size=\"256\"/><Column id=\"PK\" type=\"STRING\" size=\"256\"/><Column id=\"notNull\" type=\"STRING\" size=\"256\"/><Column id=\"type\" type=\"STRING\" size=\"256\"/><Column id=\"nlength\" type=\"STRING\" size=\"256\"/><Column id=\"from\" type=\"STRING\" size=\"256\"/><Column id=\"to\" type=\"STRING\" size=\"256\"/><Column id=\"lengthChkGb\" type=\"STRING\" size=\"256\"/><Column id=\"msgId\" type=\"STRING\" size=\"256\"/><Column id=\"expr\" type=\"STRING\" size=\"256\"/><Column id=\"func\" type=\"STRING\" size=\"256\"/></ColumnInfo><Rows><Row><Col id=\"compId\"/><Col id=\"colId\"/><Col id=\"notNull\"/><Col id=\"msgId\"/></Row></Rows>");this.addChild(_a.name,_a);_a=new Dataset("ds_cond1",this);_a._setContents("<ColumnInfo><Column id=\"BSNS_CODE\" type=\"STRING\" size=\"5\"/><Column id=\"CNTRCT_NO\" type=\"STRING\" size=\"11\"/><Column id=\"CNTRCT_NM\" type=\"STRING\" size=\"100\"/><Column id=\"REPORT_YM\" type=\"STRING\" size=\"6\"/><Column id=\"REPORT_DE\" type=\"STRING\" size=\"8\"/><Column id=\"CTR_GB\" type=\"BIGDECIMAL\" size=\"11\"/><Column id=\"CNST_CODE\" type=\"STRING\" size=\"4\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_PRJ010",this);_a._setContents("");this.addChild(_a.name,_a);_a=new Dataset("ds_PRJ016",this);_a._setContents("");this.addChild(_a.name,_a);_a=new Dataset("ds_tmp",this);_a._setContents("");this.addChild(_a.name,_a);_a=new Dataset("ds_ctr",this);_a.getSetter("onrowposchanged2").set("ds_onrowposchanged");_a._setContents("<ColumnInfo><Column id=\"CNTRCT_NO\" type=\"STRING\" size=\"11\"/><Column id=\"CNTRCT_NM\" type=\"STRING\" size=\"100\"/><Column id=\"NO_NM\" type=\"STRING\" size=\"120\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_BSNS",this);_a.set_useclientlayout("0");_a._setContents("<ColumnInfo><Column id=\"BSNS_CODE\" type=\"string\" size=\"5\"/><Column id=\"BSNS_NM\" type=\"string\" size=\"100\"/><Column id=\"BSNS_ALL_NM\" type=\"string\" size=\"100\"/><Column id=\"BSNS_TY\" type=\"string\" size=\"3\"/><Column id=\"RM\" type=\"string\" size=\"200\"/><Column id=\"STRWRK_DE\" type=\"string\" size=\"8\"/><Column id=\"COMPET_DE\" type=\"string\" size=\"8\"/><Column id=\"BSNS_CONFM_DE\" type=\"string\" size=\"8\"/><Column id=\"MVN_DE\" type=\"string\" size=\"8\"/><Column id=\"RN\" type=\"string\" size=\"8\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_ctrDtl",this);_a._setContents("<ColumnInfo><Column id=\"BSNS_CODE\" type=\"STRING\" size=\"5\"/><Column id=\"CNTRCT_NO\" type=\"STRING\" size=\"11\"/><Column id=\"CNTRCT_SE\" type=\"STRING\" size=\"3\"/><Column id=\"CNTRCT_NM\" type=\"STRING\" size=\"100\"/><Column id=\"TOT_CNTRCT_AMOUNT\" type=\"BIGDECIMAL\" size=\"16\"/><Column id=\"CNTRCT_DE\" type=\"STRING\" size=\"8\"/><Column id=\"STRWRK_DE\" type=\"STRING\" size=\"8\"/><Column id=\"COMPET_DE\" type=\"STRING\" size=\"8\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Static("sta_gud_v01","absolute",null,"0","28",null,"0","0",this);_a.set_text("28");_a.set_visible("0");_a.style.set_background("#1b3cd23c");_a.style.set_align("center");this.addChild(_a.name,_a);_a=new Grid("grd_xls","absolute","0",null,null,"0","0",null,this);_a.set_taborder("4");_a.set_binddataset("ds_xls");_a.getSetter("autofittype2").set("col");_a.getSetter("top2").set("105");_a.getSetter("bottom2").set("181");_a.set_visible("0");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"70\"/><Column size=\"70\"/><Column size=\"120\"/><Column size=\"50\"/><Column size=\"90\"/><Column size=\"90\"/><Column size=\"50\"/><Column size=\"60\"/><Column size=\"60\"/><Column size=\"90\"/><Column size=\"60\"/><Column size=\"90\"/><Column size=\"60\"/><Column size=\"90\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"24\" band=\"head\"/><Row size=\"24\" band=\"head\"/><Row size=\"24\" band=\"head\"/><Row size=\"24\" band=\"head\"/><Row size=\"24\" band=\"head\"/><Row size=\"24\"/><Row size=\"24\" band=\"summ\"/><Row size=\"24\" band=\"summ\"/><Row size=\"24\" band=\"summ\"/><Row size=\"24\" band=\"summ\"/><Row size=\"24\" band=\"summ\"/><Row size=\"24\" band=\"summ\"/></Rows><Band id=\"head\"><Cell row=\"0\" col=\"0\" style=\"background:yellow;\" colspan=\"14\" text=\"표준공종코드자료 등록(수급자용)\"/><Cell row=\"1\" col=\"0\" style=\"background:yellow;\" text=\"사업코드 :\"/><Cell row=\"1\" col=\"1\" style=\"background:yellow;align:left;\" expr=\"dataset.parent.g_xls_BsnsCode\" colspan=\"3\"/><Cell row=\"1\" col=\"4\" style=\"background:yellow;\" text=\"계약번호 :\"/><Cell row=\"1\" col=\"5\" style=\"background:yellow;align:left;\" expr=\"dataset.parent.g_xls_ctr_no\" colspan=\"3\"/><Cell row=\"1\" col=\"8\" text=\"담당자\"/><Cell row=\"1\" col=\"9\" colspan=\"2\"/><Cell row=\"1\" col=\"11\" text=\"연락처\"/><Cell row=\"1\" col=\"12\" colspan=\"2\"/><Cell row=\"2\" col=\"0\" style=\"background:yellow;\" text=\"사 업 명 :\"/><Cell row=\"2\" col=\"1\" style=\"background:yellow;align:left;\" expr=\"dataset.parent.g_xls_BsnsName\" colspan=\"3\"/><Cell row=\"2\" col=\"4\" style=\"background:yellow;\" text=\"계 약 명 :\"/><Cell row=\"2\" col=\"5\" style=\"background:yellow;align:left;\" expr=\"dataset.parent.g_xls_ctr_nm\" colspan=\"3\"/><Cell row=\"2\" col=\"8\" style=\"background:yellow;\" text=\"용역사\"/><Cell row=\"2\" col=\"9\" style=\"background:yellow;\" colspan=\"2\"/><Cell row=\"2\" col=\"11\" style=\"background:yellow;\" text=\"대표자\"/><Cell row=\"2\" col=\"12\" style=\"background:yellow;\" colspan=\"2\"/><Cell row=\"3\" col=\"0\" style=\"background:yellow;\" text=\"공종코드\" colspan=\"3\"/><Cell row=\"3\" col=\"3\" style=\"background:yellow;\" text=\"공종코드에 따른 일위대가 자료 등록\" colspan=\"11\"/><Cell row=\"4\" col=\"0\" style=\"background:lightgrey;\" text=\"공종코드\" rowspan=\"2\"/><Cell row=\"4\" col=\"1\" style=\"background:lightgrey;\" text=\"분류구분\" rowspan=\"2\"/><Cell row=\"4\" col=\"2\" style=\"background:lightgrey;\" text=\"공종명\" rowspan=\"2\"/><Cell row=\"4\" col=\"3\" style=\"background:lightgrey;\" text=\"순번\" rowspan=\"2\"/><Cell row=\"4\" col=\"4\" style=\"background:lightgrey;\" text=\"품명\" rowspan=\"2\"/><Cell row=\"4\" col=\"5\" style=\"background:lightgrey;\" text=\"규격\" rowspan=\"2\"/><Cell row=\"4\" col=\"6\" style=\"background:lightgrey;\" text=\"단위\" rowspan=\"2\"/><Cell row=\"4\" col=\"7\" style=\"background:lightgrey;\" text=\"수량\" rowspan=\"2\"/><Cell row=\"4\" col=\"8\" style=\"background:lightgrey;\" text=\"재료비\" colspan=\"2\"/><Cell row=\"4\" col=\"10\" style=\"background:lightgrey;\" text=\"노무비\" colspan=\"2\"/><Cell row=\"4\" col=\"12\" style=\"background:lightgrey;\" text=\"경비\" colspan=\"2\"/><Cell row=\"5\" col=\"8\" style=\"background:lightgrey;\" text=\"단가\"/><Cell row=\"5\" col=\"9\" style=\"background:lightgrey;\" text=\"금액\"/><Cell row=\"5\" col=\"10\" style=\"background:lightgrey;\" text=\"단가\"/><Cell row=\"5\" col=\"11\" style=\"background:lightgrey;\" text=\"단가\"/><Cell row=\"5\" col=\"12\" style=\"background:lightgrey;\" text=\"단가\"/><Cell row=\"5\" col=\"13\" style=\"background:lightgrey;\" text=\"단가\"/></Band><Band id=\"body\"><Cell col=\"0\" text=\"bind:CNST_CODE\"/><Cell col=\"1\" displaytype=\"combo\" text=\"bind:CL_SE\" combodataset=\"ds_PRJ010\" combocodecol=\"CODE\" combodatacol=\"CODE_NM\"/><Cell col=\"2\" style=\"align:left;\" text=\"bind:CODE_NM\"/><Cell col=\"3\" text=\"bind:SN\"/><Cell col=\"4\" style=\"align:left;padding:0 5 0 5;\" text=\"bind:PRDNM\"/><Cell col=\"5\" style=\"align:left;padding:0 5 0 5;\" text=\"bind:STNDRD\"/><Cell col=\"6\" style=\"align:left;padding:0 5 0 5;\" text=\"bind:UNIT_NM\"/><Cell col=\"7\" style=\"align:left;padding:0 5 0 5;\" text=\"bind:QY\"/><Cell col=\"8\" displaytype=\"number\" mask=\"#,###\" style=\"align:right;padding:0 5 0 0;\" text=\"bind:QY\"/><Cell col=\"9\" displaytype=\"number\" mask=\"#,###\" style=\"align:right;padding:0 5 0 0;\" text=\"bind:MATRL_CT_UNTPC\"/><Cell col=\"10\" displaytype=\"number\" mask=\"#,###\" style=\"align:right;padding:0 5 0 0;\" text=\"bind:MATRL_CT_AMOUNT\"/><Cell col=\"11\" displaytype=\"number\" mask=\"#,###\" style=\"align:right;padding:0 5 0 0;\" text=\"bind:LBRC_CT_UNTPC\"/><Cell col=\"12\" displaytype=\"number\" mask=\"#,###\" style=\"align:right;padding:0 5 0 0;\" text=\"bind:LBRC_CT_AMOUNT\"/><Cell col=\"13\" displaytype=\"number\" mask=\"#,###\" style=\"align:right;padding:0 5 0 0;\" text=\"bind:EXPENS_UNTPC\"/><Cell col=\"14\" displaytype=\"number\" mask=\"#,###\" style=\"align:right;padding:0 5 0 0;\" text=\"bind:EXPENS_AMOUNT\"/></Band><Band id=\"summary\"><Cell row=\"0\" col=\"0\" colspan=\"14\"/><Cell row=\"1\" col=\"0\" text=\"\"/><Cell row=\"1\" col=\"1\" colspan=\"13\" style=\"align:left;\" text=\"* 작성요령\"/><Cell row=\"2\" col=\"0\" text=\"\"/><Cell row=\"2\" col=\"1\" colspan=\"13\" style=\"align:left;\" text=\"   1. 사업코드/사업명/계약번호/계약명 수정불가\"/><Cell row=\"3\" col=\"0\" text=\"\"/><Cell row=\"3\" col=\"1\" colspan=\"13\" style=\"align:left;\" text=\"   2. 순번은 시리얼번호를 부여한다(3자리 숫자) : 하나의 공정에 N개의 순번이 부여될 수 있다(행 삽입으로 등록)\"/><Cell row=\"4\" col=\"0\" text=\"\"/><Cell row=\"4\" col=\"1\" colspan=\"13\" style=\"align:left;\" text=\"   3. 품명~금액 자료를 등록한다.\"/><Cell row=\"5\" col=\"0\" text=\"\"/><Cell row=\"5\" col=\"1\" colspan=\"13\" style=\"align:left;\" text=\"   4. 공종코드:순번=1:N\"/></Band></Format></Formats>");this.addChild(_a.name,_a);_a=new Grid("grd_cd","absolute","0",null,null,"0","0",null,this);_a.set_taborder("5");_a.set_binddataset("ds_cnst");_a.getSetter("autofittype2").set("col");_a.getSetter("top2").set("105");_a.getSetter("bottom2").set("181");_a.set_visible("0");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"90\"/><Column size=\"70\"/><Column size=\"180\"/><Column size=\"120\"/><Column size=\"120\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"24\" band=\"head\"/><Row size=\"24\"/><Row size=\"24\" band=\"summ\"/></Rows><Band id=\"head\"><Cell row=\"0\" col=\"0\" style=\"background:yellow;\" text=\"표준공종코드표\" colspan=\"4\"/><Cell row=\"1\" col=\"0\" style=\"background:yellow;\" text=\"공종코드\"/><Cell row=\"1\" col=\"1\" style=\"background:yellow;\" text=\"분류구분\"/><Cell row=\"1\" col=\"2\" style=\"background:yellow;\" text=\"공종코드명\"/><Cell row=\"1\" col=\"3\" style=\"background:yellow;\" text=\"착공일자\"/><Cell row=\"1\" col=\"4\" style=\"background:yellow;\" text=\"준공일자\"/></Band><Band id=\"body\"><Cell col=\"0\" style=\"background:yellow;background2:yellow;\" text=\"bind:CNST_CODE\"/><Cell col=\"1\" style=\"background:yellow;background2:yellow;\" text=\"bind:CL_SE\" displaytype=\"combo\" combodataset=\"ds_PRJ010\" combocodecol=\"CODE\" combodatacol=\"CODE_NM\"/><Cell col=\"2\" style=\"background:yellow;background2:yellow;\" text=\"bind:CODE_NM\"/><Cell col=\"3\" style=\"background:yellow;background2:yellow;\" displaytype=\"date\" calendardisplaynulltype=\"none\" text=\"bind:STRWRK_DE\"/><Cell col=\"4\" style=\"background:yellow;background2:yellow;\" displaytype=\"date\" calendardisplaynulltype=\"none\" text=\"bind:COMPET_DE\"/></Band><Band id=\"summary\"><Cell/><Cell col=\"0\"/><Cell col=\"1\" colspan=\"3\" style=\"align:left;\" text=\"   * 공종코드 입력시에 표준공종코드표 참조\"/></Band></Format></Formats>");this.addChild(_a.name,_a);_a=new Div("div_work","absolute","0","32",null,null,"28","0",this);_a.set_taborder("7");this.addChild(_a.name,_a);_a=new Div("div_1","absolute","0","233",null,null,"0","0",this.div_work);_a.set_taborder("12");this.div_work.addChild(_a.name,_a);_a=new Static("sta_1","absolute","0","14","126","19",null,null,this.div_work.div_1);_a.set_taborder("9");_a.set_text("일위대가표");_a.set_cssclass("sta_WF_Title02");_a.getSetter("visible2").set("0");this.div_work.div_1.addChild(_a.name,_a);_a=new Button("btn_32","absolute",null,"12","64","19","138",null,this.div_work.div_1);_a.set_taborder("11");_a.set_text("행삭제");_a.set_cssclass("btn_WF_Griddel");this.div_work.div_1.addChild(_a.name,_a);_a=new Button("btn_31","absolute",null,"12","64","19","205",null,this.div_work.div_1);_a.set_taborder("12");_a.set_text("행추가");_a.set_cssclass("btn_WF_Gridadd");this.div_work.div_1.addChild(_a.name,_a);_a=new Button("btn_33","absolute",null,"12","66","19","0",null,this.div_work.div_1);_a.set_taborder("13");_a.set_text("파일첨부");_a.set_cssclass("btn_WF_Process");this.div_work.div_1.addChild(_a.name,_a);_a=new Static("sta_gud_h01","absolute","0","2",null,"10","0",null,this.div_work.div_1);_a.set_taborder("14");_a.set_text("10");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center");this.div_work.div_1.addChild(_a.name,_a);_a=new Static("sta_gud_h02","absolute","0","31",null,"5","0",null,this.div_work.div_1);_a.set_taborder("15");_a.set_text("5");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center");this.div_work.div_1.addChild(_a.name,_a);_a=new Button("btn_00","absolute",null,"12","66","19","69",null,this.div_work.div_1);_a.set_taborder("16");_a.set_text("일괄등록");_a.set_cssclass("btn_WF_Process");this.div_work.div_1.addChild(_a.name,_a);_a=new Grid("grd_1","absolute","0","36",null,null,"0","0",this.div_work.div_1);_a.set_taborder("18");_a.set_binddataset("ds_1");_a.set_autofittype("col");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"50\"/><Column size=\"80\"/><Column size=\"80\"/><Column size=\"50\"/><Column size=\"50\"/><Column size=\"50\"/><Column size=\"50\"/><Column size=\"50\"/><Column size=\"50\"/><Column size=\"50\"/><Column size=\"50\"/><Column size=\"50\"/><Column size=\"50\"/></Columns><Rows><Row size=\"18\" band=\"head\"/><Row size=\"18\" band=\"head\"/><Row size=\"24\"/><Row size=\"24\" band=\"summ\"/></Rows><Band id=\"head\"><Cell rowspan=\"2\" text=\"순번\"/><Cell col=\"1\" rowspan=\"2\" text=\"품명\"/><Cell col=\"2\" rowspan=\"2\" text=\"규격\"/><Cell col=\"3\" rowspan=\"2\" text=\"단위\"/><Cell col=\"4\" rowspan=\"2\" text=\"수량\"/><Cell col=\"5\" colspan=\"2\" text=\"재료비\"/><Cell col=\"7\" colspan=\"2\" text=\"노무비\"/><Cell col=\"9\" colspan=\"2\" text=\"경비\"/><Cell col=\"11\" colspan=\"2\" text=\"합계\"/><Cell row=\"1\" col=\"5\" text=\"단가\"/><Cell row=\"1\" col=\"6\" text=\"금액\"/><Cell row=\"1\" col=\"7\" text=\"단가\"/><Cell row=\"1\" col=\"8\" text=\"금액\"/><Cell row=\"1\" col=\"9\" text=\"단가\"/><Cell row=\"1\" col=\"10\" text=\"금액\"/><Cell row=\"1\" col=\"11\" text=\"단가\"/><Cell row=\"1\" col=\"12\" text=\"금액\"/></Band><Band id=\"body\"><Cell text=\"bind:SN\"/><Cell col=\"1\" edittype=\"text\" style=\"align:left;padding: ;\" text=\"bind:PRDNM\" editdisplay=\"display\"/><Cell col=\"2\" edittype=\"text\" style=\"align:left;padding: ;\" text=\"bind:STNDRD\" editdisplay=\"display\"/><Cell col=\"3\" edittype=\"text\" style=\"align:left;padding: ;\" text=\"bind:UNIT_NM\" editdisplay=\"display\"/><Cell col=\"4\" displaytype=\"number\" edittype=\"masknumber\" style=\"align:right;padding: ;\" text=\"bind:QY\" mask=\"#,##0\" editdisplay=\"display\"/><Cell col=\"5\" displaytype=\"number\" edittype=\"masknumber\" style=\"align:right;padding: ;\" text=\"bind:MATRL_CT_UNTPC\" mask=\"#,##0\" editdisplay=\"display\"/><Cell col=\"6\" displaytype=\"number\" edittype=\"masknumber\" style=\"align:right;padding: ;\" text=\"bind:MATRL_CT_AMOUNT\" mask=\"#,##0\" editdisplay=\"display\"/><Cell col=\"7\" displaytype=\"number\" edittype=\"masknumber\" style=\"align:right;padding: ;\" text=\"bind:LBRC_CT_UNTPC\" mask=\"#,##0\" editdisplay=\"display\"/><Cell col=\"8\" displaytype=\"number\" edittype=\"masknumber\" style=\"align:right;padding: ;\" text=\"bind:LBRC_CT_AMOUNT\" mask=\"#,##0\" editdisplay=\"display\"/><Cell col=\"9\" displaytype=\"number\" edittype=\"masknumber\" style=\"align:right;padding: ;\" text=\"bind:EXPENS_UNTPC\" mask=\"#,##0\" editdisplay=\"display\"/><Cell col=\"10\" displaytype=\"number\" edittype=\"masknumber\" style=\"align:right;padding: ;\" text=\"bind:EXPENS_AMOUNT\" mask=\"#,##0\" editdisplay=\"display\"/><Cell col=\"11\" displaytype=\"number\" style=\"align:right;padding:0 5 0 0;\" text=\"bind:S_UNTPC\" mask=\"#,##0\"/><Cell col=\"12\" displaytype=\"number\" style=\"align:right;padding:0 5 0 0;\" text=\"bind:S_AMOUNT\" mask=\"#,##0\"/></Band><Band id=\"summary\"><Cell colspan=\"4\" text=\"합계\"/><Cell col=\"4\" displaytype=\"number\" style=\"align:right;padding:0 5 0 0;\" expr=\"dataset.getSum('parseInt(QY)||0')\" mask=\"#,##0\"/><Cell col=\"5\" displaytype=\"number\" style=\"align:right;padding:0 5 0 0;\" expr=\"dataset.getSum('parseInt(MATRL_CT_UNTPC)||0')\" mask=\"#,##0\"/><Cell col=\"6\" displaytype=\"number\" style=\"align:right;padding:0 5 0 0;\" expr=\"dataset.getSum('parseInt(MATRL_CT_AMOUNT)||0')\" mask=\"#,##0\"/><Cell col=\"7\" displaytype=\"number\" style=\"align:right;padding:0 5 0 0;\" expr=\"dataset.getSum('parseInt(LBRC_CT_UNTPC)||0')\" mask=\"#,##0\"/><Cell col=\"8\" displaytype=\"number\" style=\"align:right;padding:0 5 0 0;\" expr=\"dataset.getSum('parseInt(LBRC_CT_AMOUNT)||0')\" mask=\"#,##0\"/><Cell col=\"9\" displaytype=\"number\" style=\"align:right;padding:0 5 0 0;\" expr=\"dataset.getSum('parseInt(EXPENS_UNTPC)||0')\" mask=\"#,##0\"/><Cell col=\"10\" displaytype=\"number\" style=\"align:right;padding:0 5 0 0;\" expr=\"dataset.getSum('parseInt(EXPENS_AMOUNT)||0')\" mask=\"#,##0\"/><Cell col=\"11\" displaytype=\"number\" style=\"align:right;padding:0 5 0 0;\" expr=\"dataset.getSum('parseInt(S_UNTPC)||0')\" mask=\"#,##0\"/><Cell col=\"12\" displaytype=\"number\" style=\"align:right;padding:0 5 0 0;\" expr=\"dataset.getSum('parseInt(S_AMOUNT)||0')\" mask=\"#,##0\"/></Band></Format></Formats>");this.div_work.div_1.addChild(_a.name,_a);_a=new Static("sta_1","absolute","0","13","200","19",null,null,this.div_work);_a.set_taborder("13");_a.set_text("계약목록(공사)");_a.set_cssclass("sta_WF_Title02");this.div_work.addChild(_a.name,_a);_a=new Static("sta_gud_h01","absolute","0","1",null,"10","0",null,this.div_work);_a.set_taborder("14");_a.set_text("10");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center");this.div_work.addChild(_a.name,_a);_a=new Static("sta_gud_h02","absolute","0","30",null,"5","0",null,this.div_work);_a.set_taborder("15");_a.set_text("5");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center");this.div_work.addChild(_a.name,_a);_a=new Grid("grd_ctr","absolute","0","35",null,"200","210",null,this.div_work);_a.set_taborder("16");_a.set_binddataset("ds_ctr");_a.set_autofittype("col");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"100\"/><Column size=\"0\"/><Column size=\"150\"/><Column size=\"90\"/><Column size=\"70\"/><Column size=\"70\"/><Column size=\"70\"/><Column size=\"70\"/></Columns><Rows><Row size=\"18\" band=\"head\"/><Row size=\"18\" band=\"head\"/><Row size=\"24\"/><Row size=\"24\" band=\"summ\"/></Rows><Band id=\"head\"><Cell rowspan=\"2\" text=\"계약번호\"/><Cell col=\"1\" rowspan=\"2\" text=\"계약구분\"/><Cell col=\"2\" rowspan=\"2\" text=\"계약명\"/><Cell col=\"3\" rowspan=\"2\" text=\"계약금액\"/><Cell col=\"4\" rowspan=\"2\" text=\"계약일자\"/><Cell col=\"5\" colspan=\"2\" text=\"공사계획기간\"/><Cell col=\"7\" rowspan=\"2\" text=\"첨부파일명\"/><Cell row=\"1\" col=\"5\" text=\"착공일자\"/><Cell row=\"1\" col=\"6\" text=\"준공일자\"/></Band><Band id=\"body\"><Cell text=\"bind:CNTRCT_NO\"/><Cell col=\"1\" displaytype=\"combo\" combodataset=\"ds_PRJ017\" combocodecol=\"CODE\" combodatacol=\"CODE_NM\"/><Cell col=\"2\" style=\"align:left;padding:0 5 0 5;\" text=\"bind:CNTRCT_NM\"/><Cell col=\"3\" displaytype=\"number\" style=\"align:right;padding:0 5 0 0;\" text=\"bind:TOT_CNTRCT_AMOUNT\" mask=\"#,##0\"/><Cell col=\"4\" displaytype=\"date\" text=\"bind:CNTRCT_DE\" calendardisplaynulltype=\"none\"/><Cell col=\"5\" displaytype=\"date\" text=\"bind:STRWRK_DE\" calendardisplaynulltype=\"none\"/><Cell col=\"6\" displaytype=\"date\" text=\"bind:COMPET_DE\" calendardisplaynulltype=\"none\"/><Cell col=\"7\"/></Band><Band id=\"summary\"><Cell colspan=\"3\" style=\"align:center;line:1 solid #ffd8cdff,0 none #e0e0e0ff;selectline:1 solid #FFD8CD,0 none #e0e0e0ff;\" text=\"합계\"/><Cell col=\"3\" displaytype=\"number\" style=\"align:right;\" text=\"expr:dataset.getSum('parseInt(TOT_CNTRCT_AMOUNT)||0')\" mask=\"#,##0\"/><Cell col=\"4\" colspan=\"4\"/></Band></Format></Formats>");this.div_work.addChild(_a.name,_a);_a=new Div("div_00","absolute",null,"0","200","235","0",null,this.div_work);_a.set_taborder("17");this.div_work.addChild(_a.name,_a);_a=new Static("sta_1","absolute","0","14","126","19",null,null,this.div_work.div_00);_a.set_taborder("26");_a.set_text("수급자");_a.set_cssclass("sta_WF_Title02");_a.getSetter("visible2").set("0");this.div_work.div_00.addChild(_a.name,_a);_a=new Static("sta_gud_h01","absolute","0","1",null,"10","0",null,this.div_work.div_00);_a.set_taborder("27");_a.set_text("10");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center");this.div_work.div_00.addChild(_a.name,_a);_a=new Static("sta_gud_h02","absolute","0","30",null,"5","0",null,this.div_work.div_00);_a.set_taborder("28");_a.set_text("5");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center");this.div_work.div_00.addChild(_a.name,_a);_a=new Grid("grd_ctrDtl","absolute","0","35",null,null,"0","0",this.div_work.div_00);_a.set_taborder("29");_a.set_binddataset("ds_ctrDtl");_a.set_autofittype("col");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"150\"/><Column size=\"60\"/></Columns><Rows><Row size=\"36\" band=\"head\"/><Row size=\"24\"/></Rows><Band id=\"head\"><Cell text=\"업체명\"/><Cell col=\"1\" text=\"대표자\"/></Band><Band id=\"body\"><Cell style=\"align:left;padding:0 5 0 5;\" text=\"bind:BCNC_NM\"/><Cell col=\"1\" style=\"align:left;padding:0 5 0 5;\" text=\"bind:RPRSNTV\"/></Band></Format></Formats>");this.div_work.div_00.addChild(_a.name,_a);_a=new Grid("grd_xls00","absolute","0","0",null,"0","0",null,this);_a.set_taborder("8");_a.set_binddataset("ds_1");_a.set_visible("false");_a.getSetter("autofittype2").set("col");_a.getSetter("top2").set("305");_a.getSetter("bottom2").set("81");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"70\"/><Column size=\"90\"/><Column size=\"70\"/><Column size=\"90\"/><Column size=\"50\"/><Column size=\"90\"/><Column size=\"70\"/><Column size=\"120\"/><Column size=\"90\"/><Column size=\"150\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"24\" band=\"head\"/><Row size=\"24\" band=\"head\"/><Row size=\"24\" band=\"head\"/><Row size=\"24\"/><Row size=\"24\" band=\"summ\"/><Row size=\"24\" band=\"summ\"/><Row size=\"24\" band=\"summ\"/><Row size=\"24\" band=\"summ\"/><Row size=\"24\" band=\"summ\"/><Row size=\"24\" band=\"summ\"/></Rows><Band id=\"head\"><Cell row=\"0\" col=\"0\" style=\"background:yellow;\" colspan=\"10\" text=\"용역참여자 등록\"/><Cell row=\"1\" col=\"0\" style=\"background:yellow;\" text=\"사업명:\"/><Cell row=\"1\" col=\"1\" style=\"background:yellow;align:left;\" expr=\"dataset.parent.g_xls_BsnsName\" colspan=\"2\"/><Cell row=\"1\" col=\"3\" style=\"background:yellow;\" text=\"용역사명:\"/><Cell row=\"1\" col=\"4\" style=\"background:yellow;align:left;\" expr2=\"dataset.parent.g_xls_BsnsName\" colspan=\"2\"/><Cell row=\"1\" col=\"6\" text=\"담당자\"/><Cell row=\"1\" col=\"7\" colspan=\"1\"/><Cell row=\"1\" col=\"8\" text=\"연락처\"/><Cell row=\"1\" col=\"9\" colspan=\"1\"/><Cell row=\"2\" col=\"0\" style=\"background:yellow;\" text=\"계약명:\"/><Cell row=\"2\" col=\"1\" style=\"background:yellow;align:left;\" expr=\"dataset.parent.g_xls_ctr_nm\" colspan=\"2\"/><Cell row=\"2\" col=\"3\" style=\"background:yellow;\" text=\"용역기간:\"/><Cell row=\"2\" col=\"4\" style=\"background:yellow;align:left;\" expr=\"dataset.parent.g_xls_ctr_dur\" colspan=\"2\"/><Cell row=\"2\" col=\"6\" style=\"background:yellow;\" text=\"수급자\"/><Cell row=\"2\" col=\"7\" style=\"background:yellow;\" colspan=\"1\"/><Cell row=\"2\" col=\"8\" style=\"background:yellow;\" text=\"대표\"/><Cell row=\"2\" col=\"9\" style=\"background:yellow;\" colspan=\"1\"/><Cell row=\"3\" col=\"0\" text=\"순번\" cssclass=\"Cellgrd_WF_HeadEssential\"/><Cell row=\"3\" col=\"1\" text=\"기술분야\"/><Cell row=\"3\" col=\"2\" text=\"성명\"/><Cell row=\"3\" col=\"3\" text=\"생년월일\"/><Cell row=\"3\" col=\"4\" text=\"성별\"/><Cell row=\"3\" col=\"5\" text=\"기술자격\"/><Cell row=\"3\" col=\"6\" text=\"등급\"/><Cell row=\"3\" col=\"7\" text=\"업무내용\"/><Cell row=\"3\" col=\"8\" text=\"소속\"/><Cell row=\"3\" col=\"9\" text=\"첨부증빙\"/></Band><Band id=\"body\"><Cell col=\"0\" text=\"bind:PRTCPNT_NO\"/><Cell col=\"1\" edittype=\"text\" style=\"align:left;padding:0 5 0 5;\" editimemode=\"hangul\" editlimit=\"0\" text=\"bind:TCHNLGY_REALM\"/><Cell col=\"2\" edittype=\"text\" style=\"align:left;padding:0 5 0 5;\" editimemode=\"hangul\" editlimit=\"0\" text=\"bind:NM\"/><Cell col=\"3\" displaytype=\"date\" text=\"bind:BRTHDY\" calendardisplaynulltype=\"none\"/><Cell col=\"4\" displaytype=\"combo\" edittype=\"combo\" text=\"bind:SEXDSTN\" combodataset=\"ds_COM005\" combocodecol=\"CODE\" combodatacol=\"CODE_NM\"/><Cell col=\"5\" edittype=\"text\" style=\"align:left;padding:0 5 0 5;\" editimemode=\"hangul\" editlimit=\"0\" text=\"bind:TCHNLGY_QUALF\"/><Cell col=\"6\" edittype=\"text\" style=\"align:left;padding:0 5 0 5;\" editimemode=\"hangul\" editlimit=\"0\" text=\"bind:TCHNLGY_GRAD\"/><Cell col=\"7\" edittype=\"text\" style=\"align:left;padding:0 5 0 5;\" editimemode=\"hangul\" editlimit=\"0\" text=\"bind:JOB_CN\"/><Cell col=\"8\" edittype=\"text\" style=\"align:left;padding:0 5 0 5;\" editimemode=\"hangul\" editlimit=\"0\" text=\"bind:PSITN\"/><Cell col=\"9\" displaytype=\"date\" text=\"bind:REGIST_DE\" calendardisplaynulltype=\"none\"/></Band><Band id=\"summary\"><Cell row=\"0\" col=\"0\" colspan=\"10\"/><Cell row=\"1\" col=\"0\" text=\"\"/><Cell row=\"1\" col=\"1\" colspan=\"09\" style=\"align:left;\" text=\"* 작성요령\"/><Cell row=\"2\" col=\"0\" text=\"\"/><Cell row=\"2\" col=\"1\" colspan=\"09\" style=\"align:left;\" text=\"   1. 기술분야 ~ 첨부증빙까지 입력한다.\"/><Cell row=\"3\" col=\"0\" text=\"\"/><Cell row=\"3\" col=\"1\" colspan=\"09\" style=\"align:left;\" text=\"   2. 순번:순서를 바꾸면 안되며 추가하려면 마지막번호 다음번호를 입력한다.(숫자)\"/><Cell row=\"4\" col=\"0\" text=\"\"/><Cell row=\"4\" col=\"1\" colspan=\"09\" style=\"align:left;\" text=\"   3. 성명/생년월일/성별:각각 입력한다. 생년월일은 2011.05.25의 형식이며 성별은 남,여로 입력한다.\"/><Cell row=\"5\" col=\"0\" text=\"\"/><Cell row=\"5\" col=\"1\" colspan=\"09\" style=\"align:left;\" text=\"   4. 기술분야:사업책임기술자, 분야별책임기술자, 용역기술자를 구분하여 입력한다.(텍스트)\"/><Cell row=\"6\" col=\"0\" text=\"\"/><Cell row=\"6\" col=\"1\" colspan=\"09\" style=\"align:left;\" text=\"   5. 기술자격/등급/업무내용/소속은 각각 텍스트로 입력한다.\"/><Cell row=\"7\" col=\"0\" text=\"\"/><Cell row=\"7\" col=\"1\" colspan=\"09\" style=\"align:left;\" text=\"   6. 첨부증빙은 대표 하나만 텍스트로 입력하고 본 엑셀파일 제출 시에 각 증빙별로 이미지 파일을 제출한다.(이미지 파일명은 첨부 증빙명과 동일 해야 한다.\"/></Band></Format></Formats>");this.addChild(_a.name,_a);_a=new Div("div_search","absolute","0","0",null,"33","28",null,this);_a.set_taborder("9");_a.set_cssclass("div_WFSA_Box");this.addChild(_a.name,_a);_a=new Combo("cmb_bsns_code","absolute","79","5","350","21",null,null,this.div_search);this.div_search.addChild(_a.name,_a);_a.set_taborder("4");_a.set_innerdataset("ds_BSNS");_a.set_codecolumn("BSNS_CODE");_a.set_datacolumn("BSNS_NM");_a.set_displayrowcount("15");_a=new Static("sta_CL_SE","absolute","15","6","59","20",null,null,this.div_search);_a.set_taborder("5");_a.set_text("사업코드");_a.set_cssclass("sta_WFSA_Label");this.div_search.addChild(_a.name,_a);_a=new Layout("default","",0,0,this.div_work.div_1,function(_b){_b.set_taborder("12");});this.div_work.div_1.addLayout(_a.name,_a);_a=new Layout("default","",200,235,this.div_work.div_00,function(_b){_b.set_taborder("17");});this.div_work.div_00.addLayout(_a.name,_a);_a=new Layout("default","",0,0,this.div_work,function(_b){_b.set_taborder("7");});this.div_work.addLayout(_a.name,_a);_a=new Layout("default","",0,33,this.div_search,function(_b){_b.set_taborder("9");_b.set_cssclass("div_WFSA_Box");});this.div_search.addLayout(_a.name,_a);_a=new Layout("default","",1059,735,this,function(_b){_b.set_classname("PRJ050701");_b.set_titletext("PRJ050701_메뉴제거_일위대가관리");});this.addLayout(_a.name,_a);_a=null;};this.addIncludeScript("PRJ050701.xfdl","pms_lib::pmsUtilInclude.xjs");this.registerScript("PRJ050701.xfdl",function(){var _a;var _b;var _c;var _d;this.g_xls_BsnsCode;this.g_xls_BsnsName;this.g_xls_ctr_no;this.g_xls_ctr_nm;this.PRJ050701_oninit=function(_e,_f){this.fn_init();this.fn_init_form();this.fn_init_dataset();var _g;};this.PRJ050701_onload=function(_e,_f){this.fn_loadCombo();};this.fn_init_form=function(){};this.fn_init_dataset=function(){this.gfn_initCondDs(this,this.div_search);this.checkDs.push(this.ds_1);};this.fn_loadCombo=function(){var _e=[['ds_PRJ010','PRJ010',1,''],['ds_PRJ016','PRJ016',1,'']];var _f=null;this.gfn_comboLoad(_e,_f);this.fn_fill_combo(this.div_search.cmb_bsns_code,"hsco/pms/prj/bsnsCdList.do","전체",null);};this.fn_search=function(){var _e=this.ds_BSNS.getColumn(this.ds_BSNS.rowposition,"BSNS_CODE")||'';if(_e==''){return;}this.ds_cond1.setColumn(0,"BSNS_CODE",_e);this.ds_cond1.setColumn(0,"CTR_GB","1");this.ds_ctr.clearData();this.ds_ctrDtl.clearData();this.ds_1.clearData();this.fn_transaction("ctrList");};this.fn_save=function(){if(this.gfn_message("confirm.저장.여부")){this.fn_transaction("save");}};this.fn_transaction=function(_e){if(this.ds_cond1.rowcount<1){return;}var _f=this.ds_cond1;var _g;var _h;var _i="hsco/pms/prj/PRJ050701/"+_e+".do";var _j="input1=ds_cond1";var _k="";switch(_e){case "ctrList":_i="hsco/pms/prj/ctrList.do";_j="input1=ds_cond1";_k="ds_ctr=output1";break;case "ctrDtlList":_i="hsco/pms/prj/ctrDtlList.do";_j="input1=ds_cond1";_k="ds_ctrDtl=output1";break;case "mList":_g=this.ds_cnst;_h="REPORT_DE=REPORT_DE,"+"CNST_CODE=CNST_CODE,";_f.setColumn(0,'REPORT_DE',this.div_work.cal_3.value);_j="input1=ds_cond1";_k="ds_1=output1";break;case "save":_j="input1=ds_1:U";break;case "xlsList":_k="ds_xls=output1";break;case "xSave":_j="input0=ds_x0";_j+=" input1=ds_x1:U";break;}this.fn_clearData(_e);if(_h){_f.copyRow(0,_g,_g.rowposition,_h);}Ex.core.tran(this,_e,_i,_j,_k);};this.fn_clearData=function(_e){switch(_e){case "ctrList":this.ds_ctr.clearData();case "mList":this.ds_1.clearData();case "xlsList":this.ds_xls.clearData();break;}};this.fn_callBack=function(_e,_f,_g){if(_f!=0){return this.gfn_callback_message(_e,_f,_g);}switch(_e){case "ctrList":if(this.ds_ctr.rowcount==0){this.div_work.cmb_4.set_enable(false);}else{this.div_work.cmb_4.set_enable(true);this.div_work.cmb_4.set_index(0);this.fn_transaction("cnstList");}break;case "mList":break;case "save":this.fn_transaction("mList");break;case "xlsList":this.fn_xls_dn_post(this.ds_xls);break;case "xSave":this.fn_search();this.gfn_message("success.작업완료.성공","엑셀 업로드");break;}};this.fn_insert=function(_e){this.fn_insertDS(this.ds_1);};this.fn_delete=function(_e){this.fn_deleteDS(this.ds_1);};this.fn_insertDS=function(_e){var _f=this.ds_cnst;if(!_f.getColumn(_f.rowposition,'CNST_CODE')){return;}var _g=_e.addRow();var _h="BSNS_CODE=BSNS_CODE,"+"CNTRCT_NO=CNTRCT_NO,"+"CNST_CODE=CNST_CODE,";;_e.setColumn(_g,'REPORT_DE',this.div_work.cal_3.value);_e.copyRow(_g,_f,_f.rowposition,_h);};this.fn_deleteDS=function(_e){_e.deleteRow(_e.rowposition);};this.ds_onrowposchanged=function(_e,_f){if(_e.rowcount<1){return;}switch(_e){case this.ds_cnst:return this.fn_transaction("mList");}};this.btn_CtrPopup_onclick=function(_e,_f){this.fn_PopupCtr();};this.fn_PopupCtr=function(){var _e=function(_g,_h){if(!_h){return;}var _i=new Dataset();nRowCnt=_i.loadXML(_h);if(nRowCnt<1){return;}var _j=this.ds_cond1;var _k=_j.rowposition;if(_j.rowcount<1){_k=_j.addRow();}_j.copyRow(_k,_i,0,'BSNS_CODE=BSNS_CODE,'+'CNTRCT_NO=CNTRCT_NO,'+'CNTRCT_NM=CNTRCT_NM,');application.setPrivateProfile(this.form_id+'BSNS_CODE',_j.getColumn(_k,'BSNS_CODE'));application.setPrivateProfile(this.form_id+'CNTRCT_NO',_j.getColumn(_k,'CNTRCT_NO'));application.setPrivateProfile(this.form_id+'CNTRCT_NM',_j.getColumn(_k,'CNTRCT_NM'));this.fn_search();};var _f={BSNS_CODE:this.div_PRJ.getCode(),BSNS_NM:this.div_PRJ.getLabel()};this.gfn_popup('popCtrDtl',800,500,'',_f,"pms_prj::popCtrDtl.xfdl",_e,1);};this.btn_cd_dn_onclick=function(_e,_f){if(this.ds_cnst.rowcount<1){this.gfn_message("info.데이터.없음");return;}this.gfn_exportExcel(this.grd_cd,"exportExl");};this.btn_xls_dn_onclick=function(_e,_f){this.fn_transaction("xlsList");};this.fn_xls_dn_post=function(_e){if(this.ds_1.rowcount<1){var _f='공종코드|\n 1건';this.gfn_message("errors.항목.입력값.이상",_f);return;}if(_e.rowcount<1){for(var _g=0;_g<8;_g++ ){_e.addRow();}}this.g_xls_BsnsCode=this.div_PRJ.getCode();this.g_xls_BsnsName=this.div_PRJ.getLabel();var _e=this.ds_cond1;this.g_xls_ctr_no=_e.getColumn(0,'CNTRCT_NO');this.g_xls_ctr_nm=_e.getColumn(0,'CNTRCT_NM');this.grd_xls.set_visible(0);this.grd_xls.set_visible(1);this.gfn_exportExcel(this.grd_xls,"exportExl");};this.g_xls_Cols_list='CNST_CODE CL_SE CODE_NM SN PRDNM STNDRD UNIT_NM QY MATRL_CT_UNTPC MATRL_CT_AMOUNT LBRC_CT_UNTPC LBRC_CT_AMOUNT EXPENS_UNTPC EXPENS_AMOUNT'.split(' ');this.g_xls_Cols;this.btn_xls_up_onclick=function(_e,_f){if(!this.gfn_message("confirm.삭제.진행","기존 자료가 삭제 됩니다")){return;}var _g=this.ds_xls;var _h=this.ds_tmp;_g.clearData();var _i=function(){if(!this.g_xls_Cols){var _k=this.g_xls_Cols_list;for(var _u=0;_u<_k.length;_u++ ){_k[_u]=_k[_u]+'=Column'+_u+',';}this.g_xls_Cols=_k.join('\n');}var _l=this.div_PRJ.getCode();var _m=this.div_PRJ.getLabel();var _n=this.div_search.edt_1.value;var _o=this.div_work.cal_3.value;var _p,_q;for(var _u=0;_u<_h.rowcount;_u++ ){_q=_h.getColumn(_u,'Column0');if(0==(parseInt(_q)||0)){continue;}this.debug(_u+':'+(parseInt(_q)||0)+'='+_q);_p=_g.addRow();_g.copyRow(_p,_h,_u,this.g_xls_Cols);_g.setColumn(_p,'BSNS_CODE',_l);_g.setColumn(_p,'CNTRCT_NO',_n);_g.setColumn(_p,'REPORT_DE',_o);}_g.set_keystring('S:+CNST_CODE+CL_SE+SN');var _r;var _s=this.ds_x0;var _t=this.ds_x1;_s.clearData();_p=_s.addRow();_s.setColumn(_p,'BSNS_CODE',_l);_s.setColumn(_p,'CNTRCT_NO',_n);_s.setColumn(_p,'REPORT_DE',_o);_t.clearData();for(var _u=0;_u<_g.rowcount;_u++ ){_r=_g.getColumn(_u,'SN');_p=_t.findRowExpr('SN=='+_r);if(_r){_t.copyRow(_t.addRow(),_g,_u);}}this.fn_transaction("xSave");};var _j={targetDs:_h,headSet:false,callBack:_i};this.gfn_importExcel(_j);};this.fn_bsnsChanged=function(_e,_f){var _g=_e.index||0;if(this.ds_BSNS.rowcount==0){return false;}this.ds_BSNS.set_rowposition(_g);};this.ds_ctr_onrowposchanged=function(_e,_f){this.ds_cond1.setColumn(0,"CNTRCT_NO",this.ds_ctr.getColumn(this.ds_ctr.rowposition,"CNTRCT_NO"));this.fn_transaction("ctrDtlList");this.fn_transaction("mList");};this.btn_1_onclick=function(_e,_f){var _g=this.ds_1.addRow();};this.btn_2_onclick=function(_e,_f){this.ds_1.deleteRow(this.ds_1.rowposition);};this.btn_3_onclick=function(_e,_f){this.gfn_popup("PRJ050701_P01",1024,733,"","","pms_prj05::PRJ050701_P01.xfdl","",true);};});this.on_initEvent=function(){this.ds_cnst.addEventHandler("onrowposchanged",this.ds_onrowposchanged,this);this.ds_ctr.addEventHandler("onrowposchanged",this.ds_ctr_onrowposchanged,this);this.ds_BSNS.addEventHandler("onrowposchanged",this.ds_onrowposchanged,this);this.ds_BSNS.addEventHandler("canrowposchange",this.ds_canrowposchange,this);this.addEventHandler("onload",this.PRJ050701_onload,this);this.addEventHandler("oninit",this.PRJ050701_oninit,this);this.div_work.div_1.btn_32.addEventHandler("onclick",this.btn_2_onclick,this);this.div_work.div_1.btn_31.addEventHandler("onclick",this.btn_1_onclick,this);this.div_work.div_1.btn_33.addEventHandler("onclick",this.btn_3_onclick,this);this.div_work.div_1.btn_00.addEventHandler("onclick",this.btn_3_onclick,this);this.div_search.cmb_bsns_code.addEventHandler("onitemchanged",this.fn_bsnsChanged,this);};this.loadIncludeScript("PRJ050701.xfdl");};})();