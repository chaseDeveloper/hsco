(function(){return function(){if(!this._is_form){return;}this.on_create=function(){var _a=null;if(Form==this.constructor){this.set_name("GridFilter");this.set_classname("GridFilter");this.set_titletext("New Form");this._setFormPosition(0,0,1024,768);}_a=new Dataset("ds_sample2",this);_a.set_enableevent("true");_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_preload("true");_a.set_updatecontrol("true");_a.set_useclientlayout("false");_a._setContents("<ColumnInfo><Column id=\"col1\" size=\"256\" type=\"STRING\"/><Column id=\"col2\" size=\"256\" type=\"STRING\"/><Column id=\"col3\" size=\"256\" type=\"STRING\"/><Column id=\"col4\" size=\"256\" type=\"STRING\"/><Column id=\"col5\" size=\"256\" type=\"STRING\"/><Column id=\"col6\" size=\"256\" type=\"STRING\"/><Column id=\"col7\" size=\"256\" type=\"INT\"/></ColumnInfo><Rows><Row><Col id=\"col1\">AnyCall</Col><Col id=\"col2\">2</Col><Col id=\"col3\">2G</Col><Col id=\"col4\">SCH-W420</Col><Col id=\"col5\">20081223</Col><Col id=\"col6\">235000</Col><Col id=\"col7\">320000</Col></Row><Row><Col id=\"col1\">AnyCall</Col><Col id=\"col2\">2</Col><Col id=\"col3\">3G</Col><Col id=\"col4\">SCH-M490</Col><Col id=\"col5\">20090111</Col><Col id=\"col6\">353000</Col><Col id=\"col7\">420000</Col></Row><Row><Col id=\"col1\">AnyCall</Col><Col id=\"col2\">2</Col><Col id=\"col3\">3G</Col><Col id=\"col4\">SCH-W270</Col><Col id=\"col5\">20090209</Col><Col id=\"col6\">498000</Col><Col id=\"col7\">680000</Col></Row><Row><Col id=\"col1\">AnyCall</Col><Col id=\"col2\">1</Col><Col id=\"col3\">2G</Col><Col id=\"col4\">SCH-W570</Col><Col id=\"col5\">20081201</Col><Col id=\"col6\">351000</Col><Col id=\"col7\">510000</Col></Row><Row><Col id=\"col1\">AnyCall</Col><Col id=\"col2\">1</Col><Col id=\"col3\">3G</Col><Col id=\"col4\">SCH-W550</Col><Col id=\"col5\">20090125</Col><Col id=\"col6\">150000</Col><Col id=\"col7\">610000</Col></Row><Row><Col id=\"col1\">AnyCall</Col><Col id=\"col2\">1</Col><Col id=\"col3\">3G</Col><Col id=\"col4\">SCH-W750</Col><Col id=\"col5\">20090225</Col><Col id=\"col6\">589000</Col><Col id=\"col7\">860000</Col></Row><Row><Col id=\"col1\">cyon</Col><Col id=\"col2\">2</Col><Col id=\"col3\">2G</Col><Col id=\"col4\">LG-KH2100</Col><Col id=\"col5\"/><Col id=\"col6\">256000</Col><Col id=\"col7\">370000</Col></Row><Row><Col id=\"col1\">cyon</Col><Col id=\"col2\">2</Col><Col id=\"col3\">3G</Col><Col id=\"col4\">LG-KU6000</Col><Col id=\"col5\">20090212</Col><Col id=\"col6\">430000</Col><Col id=\"col7\">590000</Col></Row><Row><Col id=\"col1\">cyon</Col><Col id=\"col2\">1</Col><Col id=\"col3\">2G</Col><Col id=\"col4\">LG-KU9100</Col><Col id=\"col5\">20081205</Col><Col id=\"col6\">360000</Col><Col id=\"col7\">630000</Col></Row><Row><Col id=\"col1\">cyon</Col><Col id=\"col2\">1</Col><Col id=\"col3\">3G</Col><Col id=\"col4\">LG-KH8000</Col><Col id=\"col5\"/><Col id=\"col6\">470000</Col><Col id=\"col7\">720000</Col></Row><Row><Col id=\"col1\">cyon</Col><Col id=\"col2\">1</Col><Col id=\"col3\">3G</Col><Col id=\"col4\">LG-KH6500</Col><Col id=\"col5\">20090219</Col><Col id=\"col6\">560000</Col><Col id=\"col7\">840000</Col></Row><Row><Col id=\"col1\">팬택&amp;큐리</Col><Col id=\"col2\">2</Col><Col id=\"col3\">2G</Col><Col id=\"col4\">canU-S1000</Col><Col id=\"col5\">20090303</Col><Col id=\"col6\">270000</Col><Col id=\"col7\">410000</Col></Row><Row><Col id=\"col1\">팬택&amp;큐리</Col><Col id=\"col2\">1</Col><Col id=\"col3\">3G</Col><Col id=\"col4\">canU801EX</Col><Col id=\"col5\"/><Col id=\"col6\"/><Col id=\"col7\">600000</Col></Row><Row><Col id=\"col1\">팬택&amp;큐리</Col><Col id=\"col2\">1</Col><Col id=\"col3\">3G</Col><Col id=\"col4\">canU502S</Col><Col id=\"col5\">20090109</Col><Col id=\"col6\">300000</Col><Col id=\"col7\"/></Row></Rows>");this.addChild(_a.name,_a);_a=new Dataset("ds_type",this);_a.set_enableevent("true");_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_preload("true");_a.set_updatecontrol("true");_a.set_useclientlayout("false");_a._setContents("<ColumnInfo><Column id=\"code\" size=\"256\" type=\"STRING\"/><Column id=\"value\" size=\"256\" type=\"STRING\"/></ColumnInfo><Rows><Row><Col id=\"code\">1</Col><Col id=\"value\">폴더</Col></Row><Row><Col id=\"code\">2</Col><Col id=\"value\">슬라이드</Col></Row></Rows>");this.addChild(_a.name,_a);_a=new Dataset("ds_sample",this);_a.set_enableevent("true");_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_preload("true");_a.set_updatecontrol("true");_a.set_useclientlayout("false");_a._setContents("<ColumnInfo><Column id=\"col1\" size=\"256\" type=\"STRING\"/><Column id=\"col2\" size=\"256\" type=\"STRING\"/><Column id=\"col3\" size=\"256\" type=\"STRING\"/><Column id=\"col4\" size=\"256\" type=\"STRING\"/><Column id=\"col5\" size=\"256\" type=\"STRING\"/><Column id=\"col6\" size=\"256\" type=\"INT\"/><Column id=\"col7\" size=\"256\" type=\"INT\"/></ColumnInfo><Rows><Row><Col id=\"col1\">AnyCall</Col><Col id=\"col2\">2</Col><Col id=\"col3\">2G</Col><Col id=\"col4\">SCH-W420</Col><Col id=\"col5\">20081223</Col><Col id=\"col6\">235000</Col><Col id=\"col7\">320000</Col></Row><Row><Col id=\"col1\">AnyCall</Col><Col id=\"col2\">2</Col><Col id=\"col3\">3G</Col><Col id=\"col4\">SCH-M490</Col><Col id=\"col5\">20090111</Col><Col id=\"col6\">353000</Col><Col id=\"col7\">420000</Col></Row><Row><Col id=\"col1\">AnyCall</Col><Col id=\"col2\">2</Col><Col id=\"col3\">3G</Col><Col id=\"col4\">SCH-W270</Col><Col id=\"col5\">20090209</Col><Col id=\"col6\">498000</Col><Col id=\"col7\">680000</Col></Row><Row><Col id=\"col1\">AnyCall</Col><Col id=\"col2\">1</Col><Col id=\"col3\">2G</Col><Col id=\"col4\">SCH-W570</Col><Col id=\"col5\">20081201</Col><Col id=\"col6\">351000</Col><Col id=\"col7\">510000</Col></Row><Row><Col id=\"col1\">AnyCall</Col><Col id=\"col2\">1</Col><Col id=\"col3\">3G</Col><Col id=\"col4\">SCH-W550</Col><Col id=\"col5\">20090125</Col><Col id=\"col6\">150000</Col><Col id=\"col7\">610000</Col></Row><Row><Col id=\"col1\">AnyCall</Col><Col id=\"col2\">1</Col><Col id=\"col3\">3G</Col><Col id=\"col4\">SCH-W750</Col><Col id=\"col5\">20090225</Col><Col id=\"col6\">589000</Col><Col id=\"col7\">860000</Col></Row><Row><Col id=\"col1\">cyon</Col><Col id=\"col2\">2</Col><Col id=\"col3\">2G</Col><Col id=\"col4\">LG-KH2100</Col><Col id=\"col5\"/><Col id=\"col6\">256000</Col><Col id=\"col7\">370000</Col></Row><Row><Col id=\"col1\">cyon</Col><Col id=\"col2\">2</Col><Col id=\"col3\">3G</Col><Col id=\"col4\">LG-KU6000</Col><Col id=\"col5\">20090212</Col><Col id=\"col6\">430000</Col><Col id=\"col7\">590000</Col></Row><Row><Col id=\"col1\">cyon</Col><Col id=\"col2\">1</Col><Col id=\"col3\">2G</Col><Col id=\"col4\">LG-KU9100</Col><Col id=\"col5\">20081205</Col><Col id=\"col6\">360000</Col><Col id=\"col7\">630000</Col></Row><Row><Col id=\"col1\">cyon</Col><Col id=\"col2\">1</Col><Col id=\"col3\">3G</Col><Col id=\"col4\">LG-KH8000</Col><Col id=\"col5\"/><Col id=\"col6\">470000</Col><Col id=\"col7\">720000</Col></Row><Row><Col id=\"col1\">cyon</Col><Col id=\"col2\">1</Col><Col id=\"col3\">3G</Col><Col id=\"col4\">LG-KH6500</Col><Col id=\"col5\">20090219</Col><Col id=\"col6\">560000</Col><Col id=\"col7\">840000</Col></Row><Row><Col id=\"col1\">팬택&amp;큐리</Col><Col id=\"col2\">2</Col><Col id=\"col3\">2G</Col><Col id=\"col4\">canU-S1000</Col><Col id=\"col5\">20090303</Col><Col id=\"col6\">270000</Col><Col id=\"col7\">410000</Col></Row><Row><Col id=\"col1\">팬택&amp;큐리</Col><Col id=\"col2\">1</Col><Col id=\"col3\">3G</Col><Col id=\"col4\">canU801EX</Col><Col id=\"col5\"/><Col id=\"col6\"/><Col id=\"col7\">600000</Col></Row><Row><Col id=\"col1\">팬택&amp;큐리</Col><Col id=\"col2\">1</Col><Col id=\"col3\">3G</Col><Col id=\"col4\">canU502S</Col><Col id=\"col5\">20090109</Col><Col id=\"col6\">300000</Col><Col id=\"col7\"/></Row></Rows>");this.addChild(_a.name,_a);_a=new Grid("grd_sample","absolute","10","50","582","294",null,null,this);_a.set_taborder("0");_a.set_binddataset("ds_sample");_a.set_cellsizingtype("col");_a.set_cellmovingtype("col");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"24\" band=\"head\"/><Row size=\"24\"/></Rows><Band id=\"head\"><Cell colspan=\"4\" text=\"Merge1\"/><Cell col=\"4\" rowspan=\"2\" text=\"col5\"/><Cell col=\"5\" colspan=\"2\" text=\"Merge2\"/><Cell row=\"1\" text=\"col1\"/><Cell row=\"1\" col=\"1\" text=\"col2\"/><Cell row=\"1\" col=\"2\" text=\"col3\"/><Cell row=\"1\" col=\"3\" text=\"col4\"/><Cell row=\"1\" col=\"5\" text=\"col6\"/><Cell row=\"1\" col=\"6\" text=\"col7\"/></Band><Band id=\"body\"><Cell text=\"bind:col1\"/><Cell col=\"1\" displaytype=\"combo\" text=\"bind:col2\" combodataset=\"ds_type\" combocodecol=\"code\" combodatacol=\"value\"/><Cell col=\"2\" text=\"bind:col3\"/><Cell col=\"3\" text=\"bind:col4\"/><Cell col=\"4\" displaytype=\"date\" text=\"bind:col5\"/><Cell col=\"5\" displaytype=\"number\" style=\"align:right;\" text=\"bind:col6\"/><Cell col=\"6\" displaytype=\"normal\" style=\"align:right;\" text=\"bind:col7\"/></Band></Format></Formats>");this.addChild(_a.name,_a);_a=new Grid("grd_sample2","absolute","10","386","582","294",null,null,this);_a.set_taborder("1");_a.set_binddataset("ds_sample2");_a.set_cellsizingtype("col");_a.set_cellmovingtype("col");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"24\" band=\"head\"/><Row size=\"24\"/></Rows><Band id=\"head\"><Cell colspan=\"4\" text=\"Merge1\"/><Cell col=\"4\" rowspan=\"2\" text=\"col5\"/><Cell col=\"5\" colspan=\"2\" text=\"Merge2\"/><Cell row=\"1\" text=\"col1\"/><Cell row=\"1\" col=\"1\" text=\"col2\"/><Cell row=\"1\" col=\"2\" text=\"col3\"/><Cell row=\"1\" col=\"3\" text=\"col4\"/><Cell row=\"1\" col=\"5\" text=\"col6\"/><Cell row=\"1\" col=\"6\" text=\"col7\"/></Band><Band id=\"body\"><Cell text=\"bind:col1\"/><Cell col=\"1\" displaytype=\"combo\" text=\"bind:col2\" combodataset=\"ds_type\" combocodecol=\"code\" combodatacol=\"value\"/><Cell col=\"2\" text=\"bind:col3\"/><Cell col=\"3\" text=\"bind:col4\"/><Cell col=\"4\" displaytype=\"date\" text=\"bind:col5\"/><Cell col=\"5\" displaytype=\"number\" style=\"align:right;\" text=\"bind:col6\"/><Cell col=\"6\" displaytype=\"normal\" style=\"align:right;\" text=\"bind:col7\"/></Band></Format></Formats>");this.addChild(_a.name,_a);_a=new Button("btn_filter","absolute","518","362","72","20",null,null,this);_a.set_taborder("2");_a.set_text("필터사용");this.addChild(_a.name,_a);_a=new Static("Static00","absolute","13","31","561","12",null,null,this);_a.set_taborder("3");_a.set_text("Grid Head Cell 에 마우스를 올리면 필터버튼이 생성됨 (merge cell 제외)");_a.style.set_font("Dotum,9, bold");this.addChild(_a.name,_a);_a=new Layout("default","",1024,768,this,function(_b){_b.set_classname("GridFilter");_b.set_titletext("New Form");});this.addLayout(_a.name,_a);_a=null;};this.loadPreloadList=function(){this._addPreloadList("data","","ds_sample2");this._addPreloadList("data","","ds_type");this._addPreloadList("data","","ds_sample");};this.registerScript("GridFilter.xfdl",function(){this.GridFilter_onload=function(_a,_b){this.initGridHeadOverFilter(this.grd_sample);this.initGridHeadAppendFilter(this.grd_sample2);};this.btn_filter_onclick=function(_a,_b){Eco.Logger.startElapsed();var _c=Eco.XComp.getUserProperty(_a,"showFilter");if(_c){this.hideHeadAppendFilter(this.grd_sample2);}else{this.showHeadAppendFilter(this.grd_sample2);}_c=_c?false:true;var _d=_c?"필터제거":"필터사용";_a.set_text(_d);Eco.XComp.setUserProperty(_a,"showFilter",_c);Eco.Logger.debug({message:"end",elapsed:true});};this.initGridHeadOverFilter=function(_a){if(Eco.XComp.getUserProperty(_a,"initGridHeadOverFilter")){return;}Eco.XComp.setUserProperty(_a,"overFilterCompNameList",[]);Eco.XComp.setUserProperty(_a,"filterInfos",{});_a.addEventHandler("onmousemove",this.filterGridOnMouseMoveHandler,this);_a.addEventHandler("onhscroll",this.arrangeOverFilterComps,this);this.setUserGridOnCellMoved(_a,this.arrangeOverFilterComps,this);this.setUserGridOnColResized(_a,this.arrangeOverFilterComps,this);var _b=_a.parent;var _c=Eco.XComp.getUserProperty(_b,"overFilterPopupDiv");if(Eco.isUndefined(_c)){var _d=Eco.getUniqueId("pdiv_");_c=new PopupDiv();_c.init(_d,"absolute",0,0,200,150);_b.addChild(_c.name,_c);_c.set_url("Sample::GridFilterPop.xfdl");_c.set_scrollbars("none");_c.style.set_background_color("#e8e8e8ff");_c.style.set_border("1px solid gray");_c.addEventHandler("oncloseup",this.filterPdivOnCloseUpHandler,this);_c.show();Eco.XComp.setUserProperty(_b,"overFilterPopupDiv",_c);}var _e=new ImageViewer();var _d=Eco.getUniqueId("img_");var _f=this.FILTER_ENABLE_IMAGE_SIZE;_e.init(_d,"absolute",0,0,_f[0],_f[1]);_e.style.set_background("transparent URL('"+this.FILTER_ENABLE_IMAGE_URL+"') center middle");_e.style.set_border("0px none #ffffffff");_e.style.set_cursor("hand");_e.set_visible(false);_e.addEventHandler("onclick",this.filterImgOnClickHandler,this);_a.parent.addChild(_e.name,_e);_e.show();Eco.XComp.setUserProperty(_e,"grid",_a);Eco.XComp.setUserProperty(_e,"overFilterPopupDiv",_c);Eco.XComp.setUserProperty(_a,"filterEnableImage",_e);Eco.XComp.setUserProperty(_a,"initGridHeadOverFilter",true);};this.filterImgOnClickHandler=function(_a,_b){var _c=Eco.XComp.getUserProperty(_a,"grid");var _d=Eco.XComp.getUserProperty(_a,"overFilterPopupDiv");var _e=_c.parent;var _f=Eco.XComp.getUserProperty(_a,"refCell");var _g=this.getBodyCellIndex(_c,this.getCellObjectIndex(_f));var _h=_c.getCellProperty("body",_g,"displaytype");var _i=this.getBindColumnNameByIndex(_c,_g);var _j;var _k=this.getFilterInfo(_c,_i);var _l,_m;if(_h=="combo"){_j="combo";_l=150;_m=150;}else if(_h=="date"){_j="date";_l=280;_m=172;}else if(_h=="number"||_h=="currency"){_j="number";_l=280;_m=172;}else{var _n=Eco.XComp.lookup(_e,_c.binddataset);var _o=_n.getColumnInfo(_i).type;switch(_o){case 'INT':case 'FLOAT':case 'BIGDECIMAL':_j="number";break;default:_j="default";}_l=280;_m=172;}Eco.XComp.setUserProperty(_d,"grid",_c);Eco.XComp.setUserProperty(_d,"refCell",_f);Eco.XComp.setUserProperty(_d,"filterHeadCellIndex",this.getCellObjectIndex(_f));Eco.XComp.setUserProperty(_d,"filterColumnName",_i);_d.setFilterInfo(_j,_k);_d.trackPopupByComponent(_a,0,_a.getOffsetHeight(),_l,_m);};this.filterPdivOnCloseUpHandler=function(_a,_b){var _c=Eco.XComp.getUserProperty(_a,"grid");var _d=_c.parent;var _e=Eco.XComp.getUserProperty(_c,"filterEnableImage");_e.set_visible(false);var _f=Eco.XComp.getUserProperty(_a,"filterHeadCellIndex");var _g=this.getBodyCellIndex(_c,_f);var _h=this.getBindColumnNameByIndex(_c,_g);var _i=this.getFilterInfo(_c,_h);var _j=_c.name+"_filterApplyImage_"+_f;var _k=_d.components[_j];if(Eco.isEmpty(_i)){if(!Eco.isEmpty(_k)){_k.set_visible(false);Eco.XComp.setUserProperty(_k,"filtered",false);}}else{if(Eco.isEmpty(_k)){var _l=this.FILTER_APPLY_IMAGE_SIZE;_k=new ImageViewer();_k.init(_j,"absolute",0,0,_l[0],_l[1]);_k.set_image(this.FILTER_APPLY_IMAGE_URL);_k.style.set_background("transparent");_k.style.set_border("0px none #ffffffff");_k.style.set_cursor("hand");_k.set_visible(false);_d.addChild(_k.name,_k);_k.show();_k.moveToNext(_e);Eco.XComp.setUserProperty(_k,"gridBindColumn",_h);var _m=Eco.XComp.getUserProperty(_c,"overFilterCompNameList");_m.push(_k.name);}var _n=this.getCompXYFromGridHeadCellRight(_c,_f,_k);if(_n[0]> -1&&_n[1]> -1){_k.move(_n[0],_n[1]);_k.set_visible(true);}else{_k.set_visible(false);}Eco.XComp.setUserProperty(_k,"filtered",true);Eco.XComp.setUserProperty(_k,"refCell",this.getGridCellObject(_c,"head",_f));}};this.filterGridOnMouseMoveHandler=function(_a,_b){var _c=Eco.XComp.getUserProperty(_a,"filterEnableImage");var _d=Eco.XComp.getUserProperty(_c,"overFilterPopupDiv");if(_d.visible){return;}if(this.isGridColResizing(_a)&&_b.row== -1){_c.set_visible(false);return;}var _e=_b.clientX;var _f=_b.clientY;var _g=_a.getRealRowFullSize("head");if(_f<_g){var _h=_b.cell;if(_h<0){_c.set_visible(false);return;}if(this.getBodyCellIndex(_a,_h)> -1){var _i=this.getCompXYFromGridHeadCellRight(_a,_h,_c);if(_i[0]> -1&&_i[1]> -1){_c.move(_i[0],_i[1]);_c.set_visible(true);}else{_c.set_visible(false);}var _j=this.getGridCellObject(_a,"head",_h);Eco.XComp.setUserProperty(_c,"refCell",_j);}else{_c.set_visible(false);}}else{_c.set_visible(false);}};this.getCompXYFromGridHeadCellRight=function(_a,_b,_c){var _d=_a.getCellProperty("head",_b,"col");var _e=_a.getFormatColProperty(_d,"band");var _f=Eco.decode(_e,"left", -1,"right", -2,0);var _g=_a.getCellRect( -1,_b,_f);var _h=Eco.XComp.PositionSize.getCurrentScrollBarSize(_a,"vert");var _i=_a.getOffsetLeft();var _j=_a.getOffsetTop();var _k=_i+_a.getOffsetWidth()-_h;var _l= -1,_m= -1;if(_i+_g.left<_k){var _n=_g.left;var _o=_g.right;if(_n<_i){_n=0;}if(_i+_o>_k){_o=_k-_i;}_l=_i+_n+((_o-_n)-_c.getOffsetWidth());_m=_j+_g.top+Math.round((_g.height-_c.getOffsetHeight())/2);if(_l<_i){_l= -1;}if(_m<_j){_m= -1;}}return [_l,_m];};this.arrangeOverFilterComps=function(_a){var _b=_a.parent;var _c=_b.components;var _d,_e=Eco.XComp.getUserProperty(_a,"overFilterCompNameList");var _f,_g,_h;for(var _i=0;_i<_e.length;_i++ ){_d=_c[_e[_i]];_g=Eco.XComp.getUserProperty(_d,"gridBindColumn");if(_a.getBindCellIndex("body",_g)<0){Eco.array.removeAt(_c,_i);_h=_b.removeChild(_d.name);_h.destroy();_i-- ;}else{if(_d&&Eco.XComp.getUserProperty(_d,"filtered")){refCell=Eco.XComp.getUserProperty(_d,"refCell");_f=this.getCompXYFromGridHeadCellRight(_a,this.getCellObjectIndex(refCell),_d);if(_f[0]> -1&&_f[1]> -1){_d.move(_f[0],_f[1]);_d.set_visible(true);}else{_d.set_visible(false);}}}}};this.removeOverFilterComps=function(_a){var _b=_a.parent;var _c=_b.components;var _d,_e=Eco.XComp.getUserProperty(_a,"overFilterCompNameList");var _f;for(var _g=0,_h=_e.length;_g<_h;_g++ ){_d=_c[_e[_g]];if(_d){_f=_b.removeChild(_d.name);_f.destroy();}}Eco.XComp.setUserProperty(_a,"overFilterCompNameList",[]);this.clearFilter(_a);};this.initGridHeadAppendFilter=function(_a){if(Eco.XComp.getUserProperty(_a,"initGridHeadAppendFilter")){return;}Eco.XComp.setUserProperty(_a,"appendFilterCompNameList",[]);Eco.XComp.setUserProperty(_a,"filterInfos",{});this.setUserGridOnCellMoved(_a,this.arrangeAppendFilterComps,this);this.setUserGridOnColResized(_a,this.arrangeAppendFilterComps,this);_a.addEventHandler("onhscroll",this.arrangeAppendFilterComps,this);Eco.XComp.setUserProperty(_a,"initGridHeadAppendFilter",true);};this.showHeadAppendFilter=function(_a){var _b=Eco.XComp.getUserProperty(_a,"appendHeadRowIndex");if(Eco.isUndefined(_b)){_b=_a.appendContentsRow("head");Eco.XComp.setUserProperty(_a,"appendHeadRowIndex",_b);this.arrangeAppendFilterComps(_a);}};this.hideHeadAppendFilter=function(_a){var _b=Eco.XComp.getUserProperty(_a,"appendHeadRowIndex");if(!Eco.isUndefined(_b)){_a.deleteContentsRow("head",_b);var _c=_a.parent.components;var _d,_e=Eco.XComp.getUserProperty(_a,"appendFilterCompNameList");for(var _f=0,_g=_e.length;_f<_g;_f++ ){_d=_c[_e[_f]];if(_d){_d.set_visible(false);_d.initValue();}}Eco.XComp.deleteUserProperty(_a,"appendHeadRowIndex");this.clearFilter(_a);}};this.arrangeAppendFilterComps=function(_a,_b){var _c=Eco.XComp.getUserProperty(_a,"appendHeadRowIndex");if(Eco.isUndefined(_c)){return;}var _d=0;if(_b){switch(_b.type){case 'trackfirstover':case 'tracklastover':case 'trackstart':return;break;case 'track':case 'pageleft':case 'pageright':Eco.XComp.Event.requestAnimationFrame(this.arrangeAppendFilterComps,this,_a);return;break;}}var _e=_a.parent;var _f=Eco.XComp.getUserProperty(_a,"appendFilterCompNameList");var _g,_h=_e.components;for(var _an=0,_al=_f.length;_an<_al;_an++ ){_g=_h[_f[_an]];if(_g){_g.set_visible(false);}}var _i=Eco.XComp.getUserProperty(_a,"filterInfos");var _j=_a.getOffsetLeft();var _k=_a.getOffsetTop();var _l=_a.getOffsetWidth();var _m=[_j,_k,_j+_l,_k+_a.getOffsetBottom()];var _n=Eco.XComp.Style.getBorderWidth(_a);var _o=_a.vscrollbar?_a.vscrollbar.getOffsetWidth():0;var _p,_q=[];var _r=_a.getCellCount("head");var _s,_t,_g,_u,_v,_w;var _x,_y,_z,_aa;var _ab,_ac,_ad,_ae;var _af=_a.hscrollbar?_a.hscrollbar.pos:0;var _ag=_a.hscrollbar?_a.hscrollbar.max:0;var _ah=_a.vscrollbar?_a.vscrollbar.getOffsetWidth():0;var _ai=0;var _aj=_a.getOffsetWidth()-_ah;var _ak=[];for(var _an=0;_an<_r;_an++ ){if(_a.getCellProperty("head",_an,"row")==_c){_x=_a.getCellProperty("head",_an,"col");_z=_a.getFormatColProperty(_x,"band");if(_z=="body"){continue;}_p=_a.getCellRect( -1,_an,Eco.decode(_z,"left", -1,"right", -2,0));if(_z=="left"){_ab=_p.left;r=_p.right;_ai=Math.max(_ai,_p.right);}else if(_z=="right"){_ab=_p.left-_ag;_aj=Math.min(_aj,_ab);}_ak.push({'cell':_an,'left':_ab,'top':_p.top,'width':_p.width,'height':_p.height});}}for(var _an=0;_an<_r;_an++ ){if(_a.getCellProperty("head",_an,"row")==_c){_x=_a.getCellProperty("head",_an,"col");_z=_a.getFormatColProperty(_x,"band");if(_z=="body"){_p=_a.getCellRect( -1,_an,0);_ab=_p.left;r=_p.right;if(r>_ai&&_ab<_aj){if(_ab<_ai){_ab=_ai;}if(r>_aj){r=_aj;}_ad=r-_ab;if(_ad>=50){_ak.push({'cell':_an,'left':_ab,'top':_p.top,'width':r-_ab,'height':_p.height});}}}}}var _al=_ak.length;var _w;for(var _an=0;_an<_al;_an++ ){_w=_ak[_an];_s=this.getBodyCellIndex(_a,_w.cell);_t=this.getBindColumnNameByIndex(_a,_s);_v=_a.getCellProperty("body",_s,"displaytype");if(Eco.isUndefined(_v)){_v="normal";}_u=_a.name+"_headAppendComp"+_an;if(Eco.array.indexOf(_f,_u)<0){_f.push(_u);_g=new Div(_u,"absolute",0,0,0,0);_g.style.set_border("0px none #ffffff");_g.set_scrollbars("none");_g.set_async(false);_g.set_visible(false);_e.addChild(_g.name,_g);_g.set_url("Sample::GridFilterDiv.xfdl");_g.show();}else{_g=_e.components[_u];_g.initValue();}Eco.XComp.setUserProperty(_g,"grid",_a);Eco.XComp.setUserProperty(_g,"refCell",this.getGridCellObject(_a,"head",_w.cell));Eco.XComp.setUserProperty(_g,"displayType",_v);Eco.XComp.setUserProperty(_g,"filterColumnName",_t);Eco.XComp.setUserProperty(_g,"filterInfo",_i[_t]);_g.setFilterInfo();_ab=_m[0]+_w.left;_ac=_m[1]+_w.top+_n[1];_ad=_w.width-1;_ae=_w.height-1;_g.move(_ab,_ac,_ad,_ae);_g.set_visible(true);}var _am=Eco.XComp.getUserProperty(_a,"currentFocusDiv");if(!Eco.isEmpty(_am)){_am.setFocus();}};this.removeAppendFilterComps=function(_a){var _b=_a.parent;var _c=_b.components;var _d,_e=Eco.XComp.getUserProperty(_a,"appendFilterCompNameList");var _f;for(var _g=0,_h=_e.length;_g<_h;_g++ ){_d=_c[_e[_g]];if(_d){_f=_b.removeChild(_d.name);_f.destroy();}}};this.FILTER_ENABLE_IMAGE_URL="Images::grd_filter_combo.png";this.FILTER_ENABLE_IMAGE_SIZE=[17,15];this.FILTER_APPLY_IMAGE_URL="Images::grd_filter_check.png";this.FILTER_APPLY_IMAGE_SIZE=[17,15];this.getFilterInfo=function(_a,_b){var _c=Eco.XComp.getUserProperty(_a,"filterInfos");return _c[_b];};this.setFilterInfo=function(_a,_b,_c){var _d=Eco.XComp.getUserProperty(_a,"filterInfos");_d[_b]=_c;};this.removeFilterInfo=function(_a,_b){var _c=Eco.XComp.getUserProperty(_a,"filterInfos");var _d=_c[_b];if(!Eco.isUndefined(_d)){_d=null;delete _c[_b];}};this.executeFilter=function(_a){var _b=Eco.XComp.lookup(_a.parent,_a.binddataset);var _c="";var _d=Eco.XComp.getUserProperty(_a,"filterInfos");var _e;var _f,_g,_h;for(var _i in _d){if(_d.hasOwnProperty(_i)){if(!Eco.isEmpty(_c)){_c+=" && ";}_e=_d[_i];_g=_b.getColumnInfo(_i).type;_c+="(";for(var _j=0,_k=_e.length;_j<_k;_j++ ){_f=_e[_j];_h=_f.logic;if(_j>0){if(_h=="and"){_c+=" && ";}else if(_h=="or"){_c+=" || ";}}_c+=this.getFilterExprString(_i,_g,_f.operator,_f.value);}_c+=")";}}_b.filter(_c);};this.clearFilter=function(_a){var _b=Eco.XComp.lookup(_a.parent,_a.binddataset);_b.filter("");Eco.XComp.setUserProperty(_a,"filterInfos",{});};this.getFilterExprString=function(_a,_b,_c,_d){var _e="";switch(_c){case 'equal':_e="=="+(_b=="STRING"?nexacro.wrapQuote(_d):_d);break;case 'notEqual':_e="!="+(_b=="STRING"?nexacro.wrapQuote(_d):_d);break;case 'greaterThan':_e=">"+(_b=="STRING"?nexacro.wrapQuote(_d):_d);break;case 'greaterThanOrEqual':_e=">="+(_b=="STRING"?nexacro.wrapQuote(_d):_d);break;case 'lessThan':_e="<"+(_b=="STRING"?nexacro.wrapQuote(_d):_d);break;case 'lessThanOrEqual':_e="<="+(_b=="STRING"?nexacro.wrapQuote(_d):_d);break;case 'startWith':_e=".toString().substr(0, "+_d.length+") == '"+_d+"'";break;case 'endWith':_e=".toString().substr("+_a+".toString().length-"+_d.length+") == '"+_d+"'";break;case 'contains':_e=".toString().search('"+_d+"') > -1";break;}if(!Eco.isEmpty(_e)){_e=_a+_e;}return _e;};this.getGridCellObject=function(_a,_b,_c){var _d;var _e=_a._curFormat;if(_e){if(_b=="head"){_d=_e._headcells[_c];}else if(_b=="body"){_d=_e._bodycells[_c];}else if(_b=="summ"||_b=="summary"){_d=_e._summcells[_c];}}return _d;};this.getCellObjectIndex=function(_a){return _a._cellidx;};this.getBindColumnNameByIndex=function(_a,_b){var _c="";var _d="";var _e=_a.getCellProperty("body",_b,"subcell");if(_e>0){_c=_a.getSubCellProperty("body",_b,0,"text");}else{_c=_a.getCellProperty("body",_b,"text");}if(!Eco.isEmpty(_c)){if(_c.search(/^BIND\(/)> -1){_d=_c.replace(/^BIND\(/,"");_d=_d.substr(0,_d.length-1);}else if(_c.search(/^bind:/)> -1){_d=_c.replace(/^bind:/,"");}}return _d;};this.getBodyCellIndex=function(_a,_b,_c){var _d=0;for(var _o=0,_p=_a.getCellCount("head");_o<_p;_o++ ){var _e=_a.getCellProperty("head",_o,"row");if(_d<_e){_d=_e;}}var _f=0;for(var _o=0,_p=_a.getCellCount("body");_o<_p;_o++ ){var _e=_a.getCellProperty("body",_o,"row");if(_f<_e){_f=_e;}}if(_d==0&&_f==0){return _b;}var _g= -1;var _h= -1;var _i=parseInt(_a.getCellProperty("head",_b,"row"));var _j=parseInt(_a.getCellProperty("head",_b,"col"));var _k=parseInt(_a.getCellProperty("head",_b,"colspan"));if(_d>_f){_h=_i-(_d-_f);_h=(_h<0?0:_h);}else{_h=_i;}var _l,_m,_n;for(var _o=0,_p=_a.getCellCount("body");_o<_p;_o++ ){_l=parseInt(_a.getCellProperty("body",_o,"row"));_m=parseInt(_a.getCellProperty("body",_o,"col"));_n=parseInt(_a.getCellProperty("body",_o,"colspan"));if(_c){if(_h==_l&&_j<=_m&&_m<(_j+_k)){_g=_o;break;}}else{if(_h==_l&&_j==_m&&_k==_n){_g=_o;break;}}}return _g;};this.isGridColResizing=function(_a){var _b=_a._resizer_elem;if(_b&&_b._is_tracking){return true;}return false;};this.setUserGridOnColResized=function(_a,_b,_c){if(Eco.isEmpty(_a)||Eco.XComp.typeOf(_a)!="Grid"){var _d={'message':"1'st argument must be a Grid Component",'stack':true};Eco.Logger.error(_d);}if(Eco.isEmpty(_b)||!Eco.isFunction(_b)){var _d={'message':"2'nd argument must be a Function",'stack':true};Eco.Logger.error(_d);}if(Eco.isEmpty(_c)){_c=_a.parent;}if(Eco.XComp.getUserProperty(_a,"setUserGridOnColResized")){return;}_a.addEventHandler("onmousemove",function(_e,_f){if(_e.cellsizingtype=="col"||_e.cellsizingtype=="both"){Eco.XComp.setUserProperty(_e,"colResizeInfo",null);var _g=_e._resizer_elem;if(_g&&_g._is_tracking){var _h=_g._index;var _i=_g._movedPos;if(_h> -1&&_i!=0){Eco.XComp.setUserProperty(_e,"colResizeInfo",{'col':_h,'oldvalue':_e.getRealColSize(_h)});}}}},_c);_a.addEventHandler("onlbuttonup",function(_e,_f){if(_e.cellsizingtype=="col"||_e.cellsizingtype=="both"){var _g=Eco.XComp.getUserProperty(_e,"colResizeInfo");if(!Eco.isEmpty(_g)){var _h={'col':_g.col,'oldvalue':_g.oldvalue,'newvalue':_e.getRealColSize(_g.col)};_b.call(_c,_e,_h);}}},_c);Eco.XComp.setUserProperty(_a,"setUserGridOnColResized",true);};this.setUserGridOnCellMoved=function(_a,_b,_c){if(Eco.isEmpty(_a)||Eco.XComp.typeOf(_a)!="Grid"){var _d={'message':"1'st argument must be a Grid Component",'stack':true};Eco.Logger.error(_d);}if(Eco.isEmpty(_b)||!Eco.isFunction(_b)){var _d={'message':"2'nd argument must be a Function",'stack':true};Eco.Logger.error(_d);}if(Eco.isEmpty(_c)){_c=_a.parent;}if(Eco.XComp.getUserProperty(_a,"setUserGridOnCellMoved")){return;}_a.addEventHandler("onlbuttondown",function(_e,_f){if(_e.cellmovingtype=="col"&&_f.row== -1){var _g={'oldcell':_f.cell,'oldcol':_f.col,'refCell':this.getGridCellObject(_e,"head",_f.cell)};Eco.XComp.setUserProperty(_e,"cellMovingInfo",_g);}else{Eco.XComp.setUserProperty(_e,"cellMovingInfo",null);}},_c);_a.addEventHandler("onlbuttonup",function(_e,_f){if(_e.cellmovingtype=="col"&&_f.row<0){var _g=Eco.XComp.getUserProperty(_e,"cellMovingInfo");if(!Eco.isEmpty(_g)){if(_g.oldcell!=_f.cell){var _h={'oldcell':_g.oldcell,'newcell':_g.refCell._cellidx,'oldcol':_g.oldcol,'newcol':_g.refCell._col};_b.call(_c,_e,_h);Eco.XComp.setUserProperty(_e,"cellMovingInfo",null);}}}},_c);Eco.XComp.setUserProperty(_a,"setUserGridOnCellMoved",true);};});this.on_initEvent=function(){this.addEventHandler("onload",this.GridFilter_onload,this);this.btn_filter.addEventHandler("onclick",this.btn_filter_onclick,this);};this.loadIncludeScript("GridFilter.xfdl");this.loadPreloadList();};})();