(function(){return function(_a){var _b;this.registerScript(_a,function(){var _c="▲";var _d="▼";var _e=null;this.gfn_gridSort=function(_b,_f){var _g=_b.getCellProperty("head",_f.cell,"displaytype");if(_g=="checkbox"){return;}var _h=this.comUtils._getDataset(_b.binddataset);if(_h== -1){application.trace("bind Dataset 확인요");return;}if(_h.getRowCount()==0){return false;}var _i=(_b.getCellProperty("body",_f.col,"text")).toString().split(":");if(_i.length!=2){return;}var _j="";var _k="";for(var _r=0;_r<_b.getCellCount("head");_r++ ){if(_b.getCellText( -1,_r)=="undefined"){continue;}var _l=_b.getCellText( -1,_r);if(_r==_f.cell){if(_l.substr(_l.length-1)==_c){_b.setCellProperty("head",_r,"text",_l.substr(0,_l.length-1)+_d);_h.set_keystring(("S:-"+_i[1]));_j=2;_k=_l.substr(0,_l.length-1);}else if(_l.substr(_l.length-1)==_d){this.gfn_clearSortMark(_b,null,"COM");_h.set_keystring("");_b.user_orgSort="";return;}else{_b.setCellProperty("head",_r,"text",_l+_c);_h.set_keystring(("S:+"+_i[1]));_j=1;_k=_l;}Eco.XComp.setUserProperty(_b,"sortKeyString",(_j==1?"S:+":"S:-")+_i[1]);}else{if(_l.substr(_l.length-1)==_c||_l.substr(_l.length-1)==_d){_b.setCellProperty("head",_r,"text",_l.substr(0,_l.length-1));}}}_b.user_orgSort=_h.keystring;Eco.XComp.setUserProperty(_b,"sortInfos",{});Eco.XComp.setUserProperty(_b,"sortItems",[]);var _m;var _n=_b._curFormat;_m=_n._headcells[_f.cell];var _o=Eco.XComp.getUserProperty(_b,"sortInfos"),_p=Eco.XComp.getUserProperty(_b,"sortItems"),_q=_o[_i[1]];if(Eco.isEmpty(_q)){_q=_o[_i[1]]={status:0,text:_k,refCell:_m};}_q.status=_j;_p.push(_i[1]);};this.gfn_clearSortMark=function(_b,_f,_g){var _h=_b.getBindDataset();if(_h.loadkeymode!='keep'||_g=='COM'){var _i=_b.getCellCount("head");var _j;for(var _k=0;_k<_i;_k++ ){if(_f!=null&&_f==_k){continue;}if(_b.getCellProperty("head",_k,"displaytype")=="checkbox"){continue;}if(this.comUtils.isNullEmpty(_b.getCellProperty("head",_k,"text"))){continue;}_j=_b.getCellProperty("head",_k,"text").split(_c).join("").split(_d).join("");_b.setCellProperty("head",_k,"text",_j);}if(!Eco.isUndefined(Eco.XComp.getUserProperty(_b,"sortInfos"))){Eco.XComp.setUserProperty(_b,"sortInfos",{});}if(!Eco.isUndefined(Eco.XComp.getUserProperty(_b,"sortItems"))){Eco.XComp.setUserProperty(_b,"sortItems",[]);}}};this.gfn_setGridCheckAll=function(_b,_f){if(_b.readonly==true){return;}var _g;var _h;var _i;_i=this.comUtils._getDataset(_b.binddataset);if(Eco.isNull(_b.getCellProperty("body",_f.col,"text"))||Eco.isUndefined(_b.getCellProperty("body",_f.col,"text"))){_h="";}else{_h=_b.getCellProperty("body",_f.col,"text");}_h=_h.split("bind:").join("");var _j=_b.getCellProperty("head",_f.cell,"displaytype");if(_j!="checkbox"){return;}_g=_b.getCellProperty("head",_f.cell,"text");if(this.comUtils.isNullEmpty(_g)){_g="0";}if(_g=="0"){_b.setCellProperty("head",_f.cell,"text",'1');_g="1";}else{_b.setCellProperty("head",_f.cell,"text",'0');_g="0";}_i.set_enableevent(false);for(var _k=0;_k<_i.getRowCount();_k++ ){_i.setColumn(_k,_h,_g);}_i.set_enableevent(true);};this.gfn_getGridItem=function(_f,_g,_h){var _i=null;var _j=_f.binddataset;var _k=this.lookup(_j);_i=this._gfn_getDatasetSelectedItem(_k,_g,_h);return _i;};this.gfn_getGridItems=function(_f,_g,_h){var _i=null;var _j=_f.binddataset;var _k=this.lookup(_j);_i=this._gfn_getDatasetSelectedItem(_k,_g,_h);return _i;};this.gfn_getGridSelectedItem=function(_f,_g){var _h=null;var _i=_f.binddataset;var _j=this.lookup(_i);var _k=_j.rowposition;_h=this._gfn_getDatasetSelectedItem(_j,_k,_g);return _h;};this.gfn_setGridSelectedItemValue=function(_f,_g,_h){var _i=null;var _j=_f.binddataset;var _k=this.lookup(_j);var _l=_k.rowposition;var _i=_k.setColumn(_l,_g,_h);return _i;};this.gfn_getGridSelectedItems=function(_f,_g){var _h=null;var _i=_f.binddataset;var _j=this.lookup(_i);var _k=_f.getSelectedDatasetRows();_h=this._gfn_getDatasetSelectedItem(_j,_k,_g);return _h;};this.gfn_deleteGridSelectedItem=function(_f){var _g=null;var _h=_f.binddataset;var _i=this.lookup(_h);var _j=_f.getSelectedDatasetRows();_g=_i.deleteRow(_j);return _g;};this.gfn_getGridUpdatedItems=function(_f,_g){var _h=null;var _g=this.comUtils.isNullEmpty(_g)?false:_g;var _i=_f.binddataset;var _j=this.lookup(_i);var _k=this.comUtils.isDatasetUpdated(_j);if(_k){var _l=[];var _m=_j.getRowCount();for(var _p=0;_p<_m;_p++ ){var _n=_j.getRowType(_p);if(_n==Dataset.ROWTYPE_INSERT||_n==Dataset.ROWTYPE_UPDATE){_l.push(_p);}if(_g&&_n==Dataset.ROWTYPE_DELETE){_l.push(_p);}}var _o={viewRow:_l};_h=this.gfn_datasetToObject(_j,_o,true);}return _h;};this.gfn_getGridInsertItems=function(_f){var _g=null;var _h=_f.binddataset;var _i=this.lookup(_h);var _j=this.comUtils.isDatasetUpdated(_i);if(_j){var _k=[];var _l=_i.getRowCount();for(var _o=0;_o<_l;_o++ ){var _m=_i.getRowType(_o);if(_m==Dataset.ROWTYPE_INSERT){_k.push(_o);}}var _n={viewRow:_k};_g=this.gfn_datasetToObject(_i,_n,true);}return _g;};this.gfn_getGridModifyItems=function(_f){var _g=null;var _h=_f.binddataset;var _i=this.lookup(_h);var _j=this.comUtils.isDatasetUpdated(_i);if(_j){var _k=[];var _l=_i.getRowCount();for(var _o=0;_o<_l;_o++ ){var _m=_i.getRowType(_o);if(_m==Dataset.ROWTYPE_UPDATE){_k.push(_o);}}var _n={viewRow:_k};_g=this.gfn_datasetToObject(_i,_n,true);}return _g;};this.gfn_getGridDeleteItems=function(_f){var _g=null;var _h=_f.binddataset;var _i=this.lookup(_h);var _j=this.comUtils.isDatasetUpdated(_i);if(_j){var _k=[];var _l=_i.getRowCount();for(var _o=0;_o<_l;_o++ ){var _m=_i.getRowType(_o);if(_m==Dataset.ROWTYPE_DELETE){_k.push(_o);}}var _n={viewRow:_k};_g=this.gfn_datasetToObject(_i,_n,true);}return _g;};this.gfn_getDatasetItem=function(_f,_g,_h){return this._gfn_getDatasetSelectedItem(_f,_g,_h);};this._gfn_getDatasetSelectedItem=function(_f,_g,_h){var _i=null;var _j=this.comUtils.isNullEmpty(_g);var _k=this.comUtils.isNullEmpty(_h);var _l=_j?_f.rowposition:_g;var _m=this.comUtils.isArray(_l);var _n=_k?true:this.comUtils.isArray(_h);if(_m||_n){var _o={};if(_k){_o["viewRow"]=_m?_g:[_l];}else{_o["viewRow"]=_m?_g:[_l];_o["viewCol"]=_h;}_i=this.gfn_datasetToObject(_f,_o,true);}else{_i=_f.getColumn(_g,_h);}return _i;};this.gfn_isUpdateRow=function(_f,_g){var _h=false;for(var _j=0;_j<_f.getColCount();_j++ ){var _i=_f.getColID(_j);if(_i=="chk"){continue;}if(_f.getColumn(_g,_j)==_f.getOrgColumn(_g,_j)){continue;}_h=true;break;}return _h;};this.gfn_exportExcel=function(_f,_g,_h){this.setWaitCursor(true,true);var _i="obj_commonExport";var _j=new ExcelExportObject();var _k=new Date();var _l;var _m=application.services["svcurl"].url+"XExportImport.do";var _n="";_j.set_name(_i);_j.addEventHandler("onsuccess",this._gfn_exportExcelEnd,this);_j.addEventHandler("onerror",this._gfn_exportExcelEndError,this);_j.clearExportItems(nexacro.ExportTypes.EXCEL2007);if(_f instanceof Grid){_l="Sheet1!A1";_j.addExportItem(nexacro.ExportItemTypes.GRID,_f,_l,"allband","allrecord","suppress","onlyvalue","none","color,background","both");}else{for(var _p=0;_p<_f.length;_p++ ){_l="A"+(_p+1);oGrid=_b[_p];_j.addExportItem(nexacro.ExportItemTypes.GRID,_f,_l+"!A1","allband","allrecord","suppress","none","background","font","both");}}_j.set_exporttype(nexacro.ExportTypes.EXCEL2007);_j.set_exportfilename(_g);_j.set_exporturl(_m);if(!_h){_n="cntn_file=N";}else{_n="cntn_file=Y svcurl="+application.services["svcurl"].url+" extrSantn="+_h;}var _o=_j.exportData(_n);};this.gfn_exportExcelContextMenu=function(_f,_g,_h,_i){var _j="obj_commonExport";var _k=new ExcelExportObject();var _l=new Date();var _m;var _n=application.services["svcurl"].url+"XExportImport.do";var _o="";var _p=this.gfn_getUserId();var _q=this.gfn_getUserName();var _r=this.gfn_getConectIp();var _s=new Date();var _t=_s.getFullYear();_t+="-"+(_s.getMonth()+1).toString().padLeft(2,"0");_t+="-"+_s.getDate().toString().padLeft(2,"0");_t+=" "+_s.getHours().toString().padLeft(2,"0");_t+=":"+_s.getMinutes().toString().padLeft(2,"0");_t+=":"+_s.getSeconds().toString().padLeft(2,"0");var _u="[출력자ID : ";_u+=_p;_u+=", 출력자명 : ";_u+=_q;_u+=", 출력자IP : ";_u+=_r;_u+=", 출력일시 : ";_u+=_t+"]";_k.set_name(_j);_k.addEventHandler("onsuccess",this._gfn_exportExcelEnd,this);_k.addEventHandler("onerror",this._gfn_exportExcelEndError,this);_k.clearExportItems(nexacro.ExportTypes.EXCEL2007);if(!this.comUtils.isNullEmpty(_g)){_g=_g;}else{_g=_l.getTime();}_g=_g.split("/").join("");if(_h!="Y"){if(_f instanceof Grid){_m="Sheet1!A1";_k.addExportItem(nexacro.ExportItemTypes.GRID,_f,_m,"allband","allrecord","suppress","onlyvalue","none","color,background","both");}_k.set_exporttype(nexacro.ExportTypes.EXCEL2007);_k.set_exportfilename(_g.substr(0,_g.indexOf("(")));_k.set_exporturl(_n);_k.set_exportuitype("exportprogress");_k.set_exportmessageprocess("%d건(%d / %d)                    ");if(!_i){_o="cntn_file=N";}else{_o="cntn_file=Y svcurl="+application.services["svcurl"].url+" extrSantn="+_i;}this.setWaitCursor(true,true);var _v=_k.exportData(_o);}else{var _w={pUsrId:_p,pFileName:_g,pConectIp:_r};this.gfn_popup("excelExportPrvonshPopup",500,300,"엑셀다운로드사유팝업",_w,"common::excelExportPrvonshPopup.xfdl","excelExportPrvonshPopupCallBack",true);this.excelExportPrvonshPopupCallBack=function(_x,_y){var _z=new Dataset();var _aa=_z.loadXML(_y);if(_aa>0){if(_f instanceof Grid){_m="Sheet1!A1";_k.addExportItem(nexacro.ExportItemTypes.GRID,_f,_m,"allband","allrecord","suppress","onlyvalue","none","color,background","both");}_k.set_exporttype(nexacro.ExportTypes.EXCEL2007);_k.set_exportfilename(_g.substr(0,_g.indexOf("(")));_k.set_exporturl(_n);_k.set_exportuitype("exportprogress");_k.set_exportmessageprocess("%d건(%d / %d)                    ");if(!_i){_o="cntn_file=N";}else{_o="cntn_file=Y svcurl="+application.services["svcurl"].url+" extrSantn="+_i;}this.setWaitCursor(true,true);var _v=_k.exportData(_o);}};}};this._gfn_exportExcelEndError=function(_b,_f){this.setWaitCursor(false,true);};this._gfn_exportExcelEnd=function(_b,_f){this.setWaitCursor(false,true);};this.gfn_exportExcelList=function(_f,_g){this.setWaitCursor(true,true);var _h="obj_commonExport";var _i=new ExcelExportObject();var _j=new Date();var _k;var _l=application.services["svcurl"].url+"XExportImport.do";var _m="";_i.set_name(_h);_i.addEventHandler("onsuccess",this._gfn_exportExcelEnd,this);_i.addEventHandler("onerror",this._gfn_exportExcelEndError,this);_i.clearExportItems(nexacro.ExportTypes.EXCEL2007);if(!this.comUtils.isNullEmpty(_g)){_g=_j.getTime()+"_"+_g;}else{_g=_j.getTime();}for(i=0;i<_f.length;i++ ){_i.addExportItem(nexacro.ExportItemTypes.GRID,_f[i].grid,_f[i].sheetName+"!A1","allband","allrecord","suppress","onlyvalue","none","color,background","both");}_i.set_exporttype(nexacro.ExportTypes.EXCEL2007);_i.set_exportfilename(_g);_i.set_exporturl(_l);var _n=_i.exportData("cntn_file=N");};this.gfn_importExcel=function(_f){var _g,_h="_common_excel_import";_g=new nexacro.ExcelImportObject(_h,this);this[_h]=_g;_g.set_importtype(nexacro.ImportTypes.EXCEL);_g.addEventHandler("onsuccess",this._gfn_excelImport_onsuccess,this);_g.addEventHandler("onerror",this._gfn_excelImport_onerror,this);_g.set_importurl(application.services["svcurl"].url+"XImport.do");_g.user_callBack=null;_g.user_targetGrid=null;var _i=null;if(_f.targetDs){_i=_f.targetDs.name;}else if(_f.targetGrid){_g.user_targetGrid=_f.targetGrid.id;_i=_f.targetGrid.getBindDataset().name;}if(typeof _f.callBack=="function"){_g.user_callBack=_f.callBack;}if(!_f.headSet){_g.importData("","[command=getsheetdata;output=outDs;body=!A1;]","["+_i+"=outDs]","");}else{_g.importData("","[command=getsheetdata;output=outDs;Head=!A1:ZZ1;body=!A2;]","["+_i+"=outDs]","");}};this._gfn_excelImport_onsuccess=function(_b,_f){this.setWaitCursor(false);if(typeof _b.user_callBack=='function'){_b.user_callBack.call(this);}this._common_excel_import.destroy();};this._gfn_excelImport_onerror=function(_b,_f){trace(_f.errormsg);this._common_excel_import.destroy();};this.gfn_scrollLeftGrid=function(_b){var _f=_b.hscrollbar;var _g=_b.vscrollbar;var _h=parseInt(_f.pos);var _i=parseInt(_b.width)-10;if(_g.enable){_i-=parseInt(_g.width);}_f.set_pos(_h-parseInt(_i));};this.gfn_scrollRightGrid=function(_b){var _f=_b.hscrollbar;var _g=_b.vscrollbar;var _h=parseInt(_f.pos);var _i=parseInt(_b.width)-10;if(_g.enable){_i-=parseInt(_g.width);}_f.set_pos(_h+parseInt(_i));};this.gfn_gridSize=function(_b,_f){var _g;if(_b.cssclass=="btn_WF_Gridexpand"){_f.orgleft=_f.left;_f.orgtop=_f.top;_f.orgwidth=_f.width;_f.orgheight=_f.height;_f.orgright=_f.right;_f.orgbottom=_f.bottom;_f.set_left(15);_f.set_right(15);_b.set_cssclass("btn_WF_Gridreduce");}else{_f.set_left(_f.orgleft);_f.set_top(_f.orgtop);_f.set_width(_f.orgwidth);_f.set_height(_f.orgheight);_f.set_right(_f.orgright);_f.set_bottom(_f.orgbottom);_b.set_cssclass("btn_WF_Gridexpand");}};this.gfn_getCheckData=function(_f,_g){var _h=new Dataset;var _i;var _j=_f.binddataset;if(this.comUtils.isNullEmpty(this.objects["ds_checked_data"])){this.addChild("ds_checked_data",_h);}else{_h=this.objects["ds_checked_data"];_h.clearData();}_h.set_name("ds_checked_data");_h.set_updatecontrol(false);if(this.comUtils.isNullEmpty(_j)){alert("해당 Grid에 Bind된 Dataset이 없습니다.");return _h;}_i=this.objects[_j];_h.copyData(_i);_h.clearData();for(var _n=0;_n<_i.rowcount;_n++ ){var _k=_i.getColumn(_n,_g);if(this.comUtils.isNullEmpty(_k)){_k="0";}if(_k.toString()!="0"){var _l=_i.getRowType(_n);var _m=_h.addRow();_h.copyRow(_m,_i,_n);_h.setRowType(_m,_l);}}return _h;};this.gfn_GridAdd=function(_f,_g,_h){var _i=this.objects[_f.binddataset];if(_i.getRowCount()==0){if(this.comUtils.isNull(_h)){_h="_flag";}if(this.comUtils.trimString(_g)=='N'){_i.set_enableevent(false);}var _j=_i.addRow();if(this.comUtils.trimString(_g)=='N'){_i.set_enableevent(true);}}else{var _j=this.gfn_GridInsert(_f,0,_g,_h);}return _j;};this.gfn_GridInsert=function(_f,_g,_h,_i){var _j=this.objects[_f.binddataset];if(_j.getRowCount()==0){return this.gfn_GridAdd(_f,_h,_i);}if(this.comUtils.isNull(_g)){_g=_j.rowposition;}if(this.comUtils.isNull(_i)){_i="_flag";}if(this.comUtils.trimString(_h)=='N'){_j.set_enableevent(false);}if(_j.rowposition==0){_j.set_rowposition( -1);}var _k=_j.insertRow(_g);_j.rowposition=_k;if(this.comUtils.trimString(_h)=='N'){_j.set_enableevent(true);}return _k;};this.gfn_GridDel=function(_f,_g,_h,_i,_j){var _k=this.objects[_f.binddataset];if(this.comUtils.isNull(_h)){_h="chk";}if(_k.findRow(_h,"1")== -1){return 0;}var _l=0;_f.set_enableevent(false);_k.set_enableevent(false);_k.set_updatecontrol(false);for(var _p=_k.getRowCount()-1;_p> -1;_p-- ){if(_k.getColumn(_p,_h)=='1'){if(_k.getRowType(_p)==Dataset.ROWTYPE_INSERT){_k.deleteRow(_p);}else if(_k.getRowType(_p)==Dataset.ROWTYPE_UPDATE){for(var _q=0;_q<_k.getColCount();_q++ ){var _m=_k.getColID(_q);if(_m==_i||_m==_h){continue;}var _n=_k.getOrgColumn(_p,_m);var _o=_k.getColumn(_p,_m);_k.setColumn(_p,_m,_n);}_k.setRowType(_p,Dataset.ROWTYPE_DELETE);_l++ ;}else{_k.setRowType(_p,Dataset.ROWTYPE_DELETE);_l++ ;}}}_k.set_updatecontrol(true);_k.set_enableevent(true);_f.set_enableevent(true);return _l;};this.gfn_gridFind=function(_f,_g){var _h=application.popupframes["commonGrdFindPopup"];if(!this.comUtils.isNull(_h)){_h.setFocus();return;}var _i=_f.getBindDataset();var _j={pv_Grid:_f,pv_Dataset:_i};this.gfn_popupOpen("commonGrdFindPopup",_j,"COM_DIV::commonGridFindPopup.xfdl","",400,188,this);return true;};this.gfn_gridBindDs_cancolumnchange=function(_b,_f){if(_f.columnid=="chk"||(_b._commonChkIgnoreUpdate&&_f.columnid in _b._commonChkIgnoreUpdate)){if(_b.getRowType(_f.row)==Dataset.ROWTYPE_NORMAL){_b.set_updatecontrol(false);}}};this.gfn_gridBindDs_oncolumnchanged=function(_b,_f){if(_f.columnid=="chk"||(_b._commonChkIgnoreUpdate&&_f.columnid in _b._commonChkIgnoreUpdate)){var _g=_f.columnid=="chk"?0:_b._commonChkIgnoreUpdate[_f.columnid];if(!_b.updatecontrol){_b.set_updatecontrol(true);}if(_f.columnid=="chk"&&_b.getRowType(_f.row)==Dataset.ROWTYPE_DELETE&&_f.newvalue=='0'){_b.set_updatecontrol(false);_b.setRowType(_f.row,Dataset.ROWTYPE_NORMAL);_b.set_updatecontrol(true);}if(_b.gridObject.getCellProperty("head",0,"edittype")=="checkbox"){var _h=_b.getSumNF(_f.columnid+'=="1"')==_b.getRowCount()?"1":"0";_b.gridObject.setCellProperty("Head",_g,"text",_h);}}};this.gfn_grid_onheadclick=function(_b,_f){var _g=_b.getBindDataset();if(_b.getCellProperty("head",_f.cell,"edittype")=="checkbox"){if(_g.getRowCount()==0&&_b.getCellText( -1,_f.cell)=='1'){_b.setCellProperty("Head",_f.cell,"text",'0');return false;}var _h=_b.getCellProperty("body",_f.cell,"text").replace(/bind:/,"");this.gfn_setGridCheckAllExpr(_b,_f.cell,_h);return true;}else{if(_b.user_sort=='Y'&&_b.user_autoSort!="N"){this.gfn_gridSort(_b,_f);}return true;}};this.gfn_setGridCheckAllExpr=function(_b,_f,_g,_h,_i){var _j=this.comUtils.trimString(_b.getCellProperty("head",_f,"displaytype"));if(_j== -1){return;}if(this.comUtils.isNull(_g)){return;}if(_j.toUpperCase()!="CHECKBOX"){return;}var _k="1";var _l="0";var _m=(_b.getCellText( -1,_f)==_k)?_l:_k;var _n=this.comUtils._getDataset(_b.binddataset);this.gfn_setColumnAllExpr(_b,_n,_g,_m,_l,_h,_i);_b.setCellProperty("Head",_f,"text",_m);};this.gfn_setColumnAllExpr=function(_b,_f,_g,_h,_i,_j,_k){if(_f.getRowCount()>0){if(_k==null||_k==""||_k<=0){_k=_f.getRowCount();}var _l=0;_f.set_enableevent(false);if(_g=="chk"){_f.set_updatecontrol(false);}for(var _m=0;_m<_f.getRowCount();_m++ ){_f.setColumn(_m,_g,_h);_l++ ;if(_f.getRowType(_m)==Dataset.ROWTYPE_UPDATE){}else if(_f.getRowType(_m)==Dataset.ROWTYPE_NORMAL){}}if(_g=="chk"){_f.set_updatecontrol(true);}_f.set_enableevent(true);}};this.gfn_removeNoise=function(_f){if(this.comUtils.isNullEmpty(_f.left)){_f.set_left(parseInt(_f.left)+1);_f.set_left(parseInt(_f.left)-1);return;}if(this.comUtils.isNullEmpty(_f.top)){_f.set_left(parseInt(_f.top)+1);_f.set_left(parseInt(_f.top)-1);return;}if(this.comUtils.isNullEmpty(_f.right)){_f.set_left(parseInt(_f.right)+1);_f.set_left(parseInt(_f.right)-1);return;}if(this.comUtils.isNullEmpty(_f.bottom)){_f.set_left(parseInt(_f.bottom)+1);_f.set_left(parseInt(_f.bottom)-1);return;}};this._gfn_initGridEventHandler=function(_f){var _g=_f.components.length;for(var _i=0;_i<_g;_i++ ){var _h=_f.components.get_item(_i);if(_h instanceof Grid){_h.addEventHandler("onrbuttondown",this._gfn_gridOnRbttHandler,this);this.initGridHeadAppendFilter(_h);}else if(_h instanceof Div||_h instanceof Tab||_h instanceof Tabpage){this._gfn_initGridEventHandler(_h);}}};this.gfn_initGridCommon=function(){this._gfn_initGridEventHandler(this);var _f=new Dataset;var _g=new Dataset;var _h=new PopupMenu("PopupMenu","absolute","608px","83px","142px","211px",null,null);var _i=0;var _j=["01","02","03","04"];var _k=["다중정렬","필터사용","엑셀다운"];var _l=["0","0","0","0"];var _m=["0","1","2","3"];_f.addColumn("CODE","string");_f.addColumn("DATA","string");_f.addColumn("LEVEL","string");_f.addColumn("ID","string");_g.addColumn("IDX","string");_g.addColumn("COL_NM","string");_g.addColumn("COL_ID","string");_g.addColumn("SORT_SE","string");_f.set_name("ds_popupMenu");_g.set_name("ds_rntSort");for(var _n=0;_n<3;_n++ ){_i=_f.addRow();_f.setColumn(_i,"CODE",_j[_n]);_f.setColumn(_i,"DATA",_k[_n]);_f.setColumn(_i,"LEVEL",_l[_n]);_f.setColumn(_i,"ID",_m[_n]);}this.addChild("ds_popupMenu",_f);this.addChild("ds_rntSort",_g);_h.set_innerdataset(_f);_h.set_captioncolumn("DATA");_h.set_idcolumn("ID");_h.set_levelcolumn("LEVEL");_h.set_userdatacolumn("CODE");_h.style.set_border("1 solid lightgrey");_h.style.set_itemborder("1 solid bisque,0 none #f7cc8cff,1 solid lightgrey,0 none #f7cc8cff");_h.style.set_itemheight("30");_h.style.set_itempadding("0 8 0 8");_h.style.set_background("bisque");_h.setEventHandler("onmenuclick",this._gfn_pmenuHandler,this);this.addChild("PopupMenu",_h);_h.show();};this._gfn_gridOnRbttHandler=function(_b,_f){this.CUR_GRID_OBJECT=_b;var _g=system.screenToClientX(this,_f.screenX);var _h=system.screenToClientY(this,_f.screenY);var _i=this.ds_popupMenu.findRow("CODE","02");var _j=Eco.XComp.getUserProperty(this.CUR_GRID_OBJECT,"showFilter");var _k=_j?"필터제거":"필터사용";this.ds_popupMenu.setColumn(_i,"DATA",_k);this.PopupMenu.trackPopup(_g+225,_h+115,"right bottom");};this._gfn_pmenuHandler=function(_b,_f){var _g=_f.userdata;switch(_g){case "01":var _h={arg_0:this,arg_1:this.CUR_GRID_OBJECT};this.gfn_popup("Popup_Sort",300,200,"",_h,"common::frmGridSort.xfdl","gfn_gridSort_callback",true);break;case "02":var _i=Eco.XComp.getUserProperty(this.CUR_GRID_OBJECT,"showFilter");if(_i){this.hideHeadAppendFilter(this.CUR_GRID_OBJECT);}else{this.showHeadAppendFilter(this.CUR_GRID_OBJECT);}_i=_i?false:true;Eco.XComp.setUserProperty(this.CUR_GRID_OBJECT,"showFilter",_i);break;case "03":var _j=application.gv_mdiFrame.form.tab_mdi.tabindex;var _k=application.gds_openMenu.getColumn(_j,"MENU_NM");var _l=application.gds_openMenu.getColumn(_j,"INDVDLINFO_AT");var _m=this.CUR_GRID_OBJECT.name;var _n=_k+"("+_m+")";this.gfn_exportExcelContextMenu(this.CUR_GRID_OBJECT,_n,_l);break;}};this.gfn_gridSort_callback=function(_f,_g){this.ds_rntSort.loadXML(_g);var _h=this[this.CUR_GRID_OBJECT.binddataset];var _i="S:";for(var _j=0;_j<this.ds_rntSort.getRowCount();_j++ ){_i=_i+this.ds_rntSort.getColumn(_j,"SORT_SE")+this.ds_rntSort.getColumn(_j,"COL_ID");}_h.set_keystring(_i);};this.initGridHeadAppendFilter=function(_f){if(Eco.XComp.getUserProperty(_f,"initGridHeadAppendFilter")){return;}Eco.XComp.setUserProperty(_f,"appendFilterCompNameList",[]);Eco.XComp.setUserProperty(_f,"filterInfos",{});this.setUserGridOnCellMoved(_f,this.arrangeAppendFilterComps,this);this.setUserGridOnColResized(_f,this.arrangeAppendFilterComps,this);_f.addEventHandler("onhscroll",this.arrangeAppendFilterComps,this);Eco.XComp.setUserProperty(_f,"initGridHeadAppendFilter",true);};this.showHeadAppendFilter=function(_f){var _g=Eco.XComp.getUserProperty(_f,"appendHeadRowIndex");if(Eco.isUndefined(_g)){_g=_f.appendContentsRow("head");Eco.XComp.setUserProperty(_f,"appendHeadRowIndex",_g);this.arrangeAppendFilterComps(_f);}};this.hideHeadAppendFilter=function(_f){var _g=Eco.XComp.getUserProperty(_f,"appendHeadRowIndex");if(!Eco.isUndefined(_g)){_f.deleteContentsRow("head",_g);var _h=_f.parent.components;var _i,_j=Eco.XComp.getUserProperty(_f,"appendFilterCompNameList");for(var _k=0,_l=_j.length;_k<_l;_k++ ){_i=_h[_j[_k]];if(_i){_i.set_visible(false);_i.initValue();}}Eco.XComp.deleteUserProperty(_f,"appendHeadRowIndex");this.clearFilter(_f);}};this.arrangeAppendFilterComps=function(_f,_g){var _h=Eco.XComp.getUserProperty(_f,"appendHeadRowIndex");if(Eco.isUndefined(_h)){return;}var _i=0;if(_g){switch(_g.type){case 'trackfirstover':case 'tracklastover':case 'trackstart':return;break;case 'track':case 'pageleft':case 'pageright':Eco.XComp.Event.requestAnimationFrame(this.arrangeAppendFilterComps,this,_f);return;break;}}var _j=_f.parent;var _k=Eco.XComp.getUserProperty(_f,"appendFilterCompNameList");var _l,_m=_j.components;for(var _as=0,_aq=_k.length;_as<_aq;_as++ ){_l=_m[_k[_as]];if(_l){_l.set_visible(false);}}var _n=Eco.XComp.getUserProperty(_f,"filterInfos");var _o=_f.getOffsetLeft();var _p=_f.getOffsetTop();var _q=_f.getOffsetWidth();var _r=[_o,_p,_o+_q,_p+_f.getOffsetBottom()];var _s=Eco.XComp.Style.getBorderWidth(_f);var _t=_f.vscrollbar?_f.vscrollbar.getOffsetWidth():0;var _u,_v=[];var _w=_f.getCellCount("head");var _x,_y,_l,_z,_aa,_ab;var _ac,_ad,_ae,_af;var _ag,_ah,_ai,_aj;var _ak=_f.hscrollbar?_f.hscrollbar.pos:0;var _al=_f.hscrollbar?_f.hscrollbar.max:0;var _am=_f.vscrollbar?_f.vscrollbar.getOffsetWidth():0;var _an=0;var _ao=_f.getOffsetWidth()-_am;var _ap=[];for(var _as=0;_as<_w;_as++ ){if(_f.getCellProperty("head",_as,"row")==_h){_ac=_f.getCellProperty("head",_as,"col");_ae=_f.getFormatColProperty(_ac,"band");if(_ae=="body"){continue;}_u=_f.getCellRect( -1,_as,Eco.decode(_ae,"left", -1,"right", -2,0));if(_ae=="left"){_ag=_u.left;r=_u.right;_an=Math.max(_an,_u.right);}else if(_ae=="right"){_ag=_u.left-_al;_ao=Math.min(_ao,_ag);}_ap.push({'cell':_as,'left':_ag,'top':_u.top,'width':_u.width,'height':_u.height});}}for(var _as=0;_as<_w;_as++ ){if(_f.getCellProperty("head",_as,"row")==_h){_ac=_f.getCellProperty("head",_as,"col");_ae=_f.getFormatColProperty(_ac,"band");if(_ae=="body"){_u=_f.getCellRect( -1,_as,0);_ag=_u.left;r=_u.right;if(r>_an&&_ag<_ao){if(_ag<_an){_ag=_an;}if(r>_ao){r=_ao;}_ai=r-_ag;if(_ai>=50){_ap.push({'cell':_as,'left':_ag,'top':_u.top,'width':r-_ag,'height':_u.height});}}}}}var _aq=_ap.length;var _ab;for(var _as=0;_as<_aq;_as++ ){_ab=_ap[_as];_x=this.getBodyCellIndex(_f,_ab.cell);_y=this.getBindColumnNameByIndex(_f,_x);_aa=_f.getCellProperty("body",_x,"displaytype");if(Eco.isUndefined(_aa)){_aa="normal";}_z=_f.name+"_headAppendComp"+_as;if(Eco.array.indexOf(_k,_z)<0){_k.push(_z);_l=new Div(_z,"absolute",0,0,0,0);_l.style.set_border("0px none #ffffff");_l.set_scrollbars("none");_l.set_async(false);_l.set_visible(false);_j.addChild(_l.name,_l);_l.set_url("common::GridFilterDiv.xfdl");_l.show();}else{_l=_j.components[_z];_l.initValue();}Eco.XComp.setUserProperty(_l,"grid",_f);Eco.XComp.setUserProperty(_l,"refCell",this.getGridCellObject(_f,"head",_ab.cell));Eco.XComp.setUserProperty(_l,"displayType",_aa);Eco.XComp.setUserProperty(_l,"filterColumnName",_y);Eco.XComp.setUserProperty(_l,"filterInfo",_n[_y]);_l.setFilterInfo();_ag=_r[0]+_ab.left;_ah=_r[1]+_ab.top+_s[1];_ai=_ab.width-1;_aj=_ab.height-1;_l.move(_ag,_ah,_ai,_aj);_l.set_visible(true);}var _ar=Eco.XComp.getUserProperty(_f,"currentFocusDiv");if(!Eco.isEmpty(_ar)){_ar.setFocus();}};this.removeAppendFilterComps=function(_f){var _g=_f.parent;var _h=_g.components;var _i,_j=Eco.XComp.getUserProperty(_f,"appendFilterCompNameList");var _k;for(var _l=0,_m=_j.length;_l<_m;_l++ ){_i=_h[_j[_l]];if(_i){_k=_g.removeChild(_i.name);_k.destroy();}}};this.FILTER_ENABLE_IMAGE_URL="theme://images/grd_filter_combo.png";this.FILTER_ENABLE_IMAGE_SIZE=[17,15];this.FILTER_APPLY_IMAGE_URL="theme://images/grd_filter_check.png";this.FILTER_APPLY_IMAGE_SIZE=[17,15];this.getFilterInfo=function(_f,_g){var _h=Eco.XComp.getUserProperty(_f,"filterInfos");return _h[_g];};this.setFilterInfo=function(_f,_g,_h){var _i=Eco.XComp.getUserProperty(_f,"filterInfos");_i[_g]=_h;};this.removeFilterInfo=function(_f,_g){var _h=Eco.XComp.getUserProperty(_f,"filterInfos");var _i=_h[_g];if(!Eco.isUndefined(_i)){_i=null;delete _h[_g];}};this.executeFilter=function(_f){var _g=Eco.XComp.lookup(_f.parent,_f.binddataset);var _h="";var _i=Eco.XComp.getUserProperty(_f,"filterInfos");var _j;var _k,_l,_m;for(var _n in _i){if(_i.hasOwnProperty(_n)){if(!Eco.isEmpty(_h)){_h+=" && ";}_j=_i[_n];_l=_g.getColumnInfo(_n).type;_h+="(";for(var _o=0,_p=_j.length;_o<_p;_o++ ){_k=_j[_o];_m=_k.logic;if(_o>0){if(_m=="and"){_h+=" && ";}else if(_m=="or"){_h+=" || ";}}_h+=this.getFilterExprString(_n,_l,_k.operator,_k.value);}_h+=")";}}_g.filter(_h);};this.clearFilter=function(_f){var _g=Eco.XComp.lookup(_f.parent,_f.binddataset);_g.filter("");Eco.XComp.setUserProperty(_f,"filterInfos",{});};this.getFilterExprString=function(_f,_g,_h,_i){var _j="";switch(_h){case 'equal':_j="=="+(_g.toUpperCase()=="STRING"?nexacro.wrapQuote(_i):_i);break;case 'notEqual':_j="!="+(_g.toUpperCase()=="STRING"?nexacro.wrapQuote(_i):_i);break;case 'greaterThan':_j=">"+(_g.toUpperCase()=="STRING"?nexacro.wrapQuote(_i):_i);break;case 'greaterThanOrEqual':_j=">="+(_g.toUpperCase()=="STRING"?nexacro.wrapQuote(_i):_i);break;case 'lessThan':_j="<"+(_g.toUpperCase()=="STRING"?nexacro.wrapQuote(_i):_i);break;case 'lessThanOrEqual':_j="<="+(_g.toUpperCase()=="STRING"?nexacro.wrapQuote(_i):_i);break;case 'startWith':_j=".toString().substr(0, "+_i.length+") == '"+_i+"'";break;case 'endWith':_j=".toString().substr("+_f+".toString().length-"+_i.length+") == '"+_i+"'";break;case 'contains':_j=".toString().search('"+_i+"') > -1";break;}if(!Eco.isEmpty(_j)){_j=_f+_j;}return _j;};this.getGridCellObject=function(_f,_g,_h){var _i;var _j=_f._curFormat;if(_j){if(_g=="head"){_i=_j._headcells[_h];}else if(_g=="body"){_i=_j._bodycells[_h];}else if(_g=="summ"||_g=="summary"){_i=_j._summcells[_h];}}return _i;};this.getCellObjectIndex=function(_f){return _f._cellidx;};this.getBindColumnNameByIndex=function(_f,_g){var _h="";var _i="";var _j=_f.getCellProperty("body",_g,"subcell");if(_j>0){_h=_f.getSubCellProperty("body",_g,0,"text");}else{_h=_f.getCellProperty("body",_g,"text");}if(!Eco.isEmpty(_h)){if(_h.search(/^BIND\(/)> -1){_i=_h.replace(/^BIND\(/,"");_i=_i.substr(0,_i.length-1);}else if(_h.search(/^bind:/)> -1){_i=_h.replace(/^bind:/,"");}}return _i;};this.getBodyCellIndex=function(_f,_g,_h){var _i=0;for(var _t=0,_u=_f.getCellCount("head");_t<_u;_t++ ){var _j=_f.getCellProperty("head",_t,"row");if(_i<_j){_i=_j;}}var _k=0;for(var _t=0,_u=_f.getCellCount("body");_t<_u;_t++ ){var _j=_f.getCellProperty("body",_t,"row");if(_k<_j){_k=_j;}}if(_i==0&&_k==0){return _g;}var _l= -1;var _m= -1;var _n=parseInt(_f.getCellProperty("head",_g,"row"));var _o=parseInt(_f.getCellProperty("head",_g,"col"));var _p=parseInt(_f.getCellProperty("head",_g,"colspan"));if(_i>_k){_m=_n-(_i-_k);_m=(_m<0?0:_m);}else{_m=_n;}var _q,_r,_s;for(var _t=0,_u=_f.getCellCount("body");_t<_u;_t++ ){_q=parseInt(_f.getCellProperty("body",_t,"row"));_r=parseInt(_f.getCellProperty("body",_t,"col"));_s=parseInt(_f.getCellProperty("body",_t,"colspan"));if(_h){if(_m==_q&&_o<=_r&&_r<(_o+_p)){_l=_t;break;}}else{if(_m==_q&&_o==_r&&_p==_s){_l=_t;break;}}}return _l;};this.isGridColResizing=function(_f){var _g=_f._resizer_elem;if(_g&&_g._is_tracking){return true;}return false;};this.setUserGridOnColResized=function(_f,_g,_h){if(Eco.isEmpty(_f)||Eco.XComp.typeOf(_f)!="Grid"){var _i={'message':"1'st argument must be a Grid Component",'stack':true};Eco.Logger.error(_i);}if(Eco.isEmpty(_g)||!Eco.isFunction(_g)){var _i={'message':"2'nd argument must be a Function",'stack':true};Eco.Logger.error(_i);}if(Eco.isEmpty(_h)){_h=_f.parent;}if(Eco.XComp.getUserProperty(_f,"setUserGridOnColResized")){return;}_f.addEventHandler("onmousemove",function(_b,_j){if(_b.cellsizingtype=="col"||_b.cellsizingtype=="both"){Eco.XComp.setUserProperty(_b,"colResizeInfo",null);var _k=_b._resizer_elem;if(_k&&_k._is_tracking){var _l=_k._index;var _m=_k._movedPos;if(_l> -1&&_m!=0){Eco.XComp.setUserProperty(_b,"colResizeInfo",{'col':_l,'oldvalue':_b.getRealColSize(_l)});}}}},_h);_f.addEventHandler("onlbuttonup",function(_b,_j){if(_b.cellsizingtype=="col"||_b.cellsizingtype=="both"){var _k=Eco.XComp.getUserProperty(_b,"colResizeInfo");if(!Eco.isEmpty(_k)){var _l={'col':_k.col,'oldvalue':_k.oldvalue,'newvalue':_b.getRealColSize(_k.col)};_g.call(_h,_b,_l);}}},_h);Eco.XComp.setUserProperty(_f,"setUserGridOnColResized",true);};this.setUserGridOnCellMoved=function(_f,_g,_h){if(Eco.isEmpty(_f)||Eco.XComp.typeOf(_f)!="Grid"){var _i={'message':"1'st argument must be a Grid Component",'stack':true};Eco.Logger.error(_i);}if(Eco.isEmpty(_g)||!Eco.isFunction(_g)){var _i={'message':"2'nd argument must be a Function",'stack':true};Eco.Logger.error(_i);}if(Eco.isEmpty(_h)){_h=_f.parent;}if(Eco.XComp.getUserProperty(_f,"setUserGridOnCellMoved")){return;}_f.addEventHandler("onlbuttondown",function(_b,_j){if(_b.cellmovingtype=="col"&&_j.row== -1){var _k={'oldcell':_j.cell,'oldcol':_j.col,'refCell':this.getGridCellObject(_b,"head",_j.cell)};Eco.XComp.setUserProperty(_b,"cellMovingInfo",_k);}else{Eco.XComp.setUserProperty(_b,"cellMovingInfo",null);}},_h);_f.addEventHandler("onlbuttonup",function(_b,_j){if(_b.cellmovingtype=="col"&&_j.row<0){var _k=Eco.XComp.getUserProperty(_b,"cellMovingInfo");if(!Eco.isEmpty(_k)){if(_k.oldcell!=_j.cell){var _l={'oldcell':_k.oldcell,'newcell':_k.refCell._cellidx,'oldcol':_k.oldcol,'newcol':_k.refCell._col};_g.call(_h,_b,_l);Eco.XComp.setUserProperty(_b,"cellMovingInfo",null);}}}},_h);Eco.XComp.setUserProperty(_f,"setUserGridOnCellMoved",true);};});this.loadIncludeScript(_a);_b=null;};})();