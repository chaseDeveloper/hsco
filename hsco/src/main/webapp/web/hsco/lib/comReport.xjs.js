(function(){return function(_a){var _b;this.registerScript(_a,function(){this.gfn_ReportPopup=function(_c,_d,_e){if(_c==null||_c==undefined||_c==""){return false;}if(_d==null||_d==undefined||_d==""){return false;}if(_e==null||_e==undefined||_e==""){return false;}var _f={arg_0:_c,reportPth:_d,dsPrint:_e};_c.gfn_popup("reportPopup",800,530,"",_f,"com::reportPopup.xfdl","fn_popupCallBack",true,true);};this.gfn_ReportOnWBControl=function(_c,_d,_e,_f){if(nexacro.Browser=="Runtime"){alert("runtime 버전은 지원하지 않습니다.");return false;}else if(nexacro.Browser=="IE"&&nexacro.BrowserVersion==8){alert("IE 8은 지원하지 않습니다");return false;}var _g=_d.left;var _h=_d.top;var _i=_d.width;var _j=_d.height;var _k=_d.right;var _l=_d.bottom;var _m=_d.name;_c.removeChild(_d.name);_d.destroy();_d=null;_d=new WebBrowser();_d.init(_m,"absolute",_g,_h,_i,_j,_k,_l);_c.addChild(_m,_d);_d.show();var _n=document.getElementById(_d._ifrm_elem._object_id);var _o;var _p;if(_n.contentDocument){_o=_n.contentDocument;_p=_o.getElementsByTagName('body')[0];}else if(_n.contentWindow){_o=_n.contentWindow.document;_p=_o.getElementsByTagName('body')[0];}if(!_p){_p=_o.createElement("body");_o.appendChild(_p);}var _q=_o.createElement("form");_q.id="postform";_q.name="postform";_q.action=application.services["svcurl"].url+"ClipReport4/clipreport.jsp";_q.method="post";_p.appendChild(_q);if(_f.getRowCount()!=1){alert("레포트를 출력하기 위한 검색조건이 존재하지 않습니다.");return false;}if(_e&&_e.length>0){var _r=_o.createElement("input");_r.id="reportname";_r.name="reportname";_r.type="hidden";_r.value=_e;_q.appendChild(_r);}for(var _y=0;_y<_f.getColCount();_y++ ){var _s=_f.getColID(_y);var _t=_f.getColumn(0,_y);var _u=_t;if(_u&&_u.length>0){var _v=_o.createElement("input");_v.id=_s;_v.name=_s;_v.type="hidden";_v.value=_u;_q.appendChild(_v);}}try{var _w=_o.createElement('script');_w.type='text/javascript';_w.charset='utf-8';_w.defer=true;_w.async=true;_w.onload=function(){};var _x="document.domain = \""+document.domain+"\";";_w.text=[_x].join('');_p.appendChild(_w);}catch(e){}if(_o.getElementById('postform')){_o.getElementById('postform').submit();}};this.cf_Opts=function(){this.toolbar=false;this.arg="";this.flicking=false;this.scrollpage=true;this.scale=100;this.timeout=60000;this.ismultireport=false;this.isStreaming=true;this.multicount=null;this.reportPath="";this.saveFilename="";this.dsLocals=[];this.gridObj=undefined;this.callback="";this.isvoiceye=true;this.getToolbar=function(){return this.toolbar;};this.getArgs=function(){return this.arg;};this.getFlicking=function(){return this.flicking;};this.getScrollPage=function(){return this.scrollpage;};this.getScale=function(){return this.scale;};this.getTimeout=function(){return this.timeout;};this.getIsMultiReport=function(){return this.ismultireport;};this.getIsStreaming=function(){return this.isStreaming;};this.getMultiCount=function(){return this.multicount;};this.getReportPath=function(){return this.reportPath;};this.getSaveFilename=function(){return this.saveFilename;};this.getLocalDs=function(){return this.dsLocals;};this.getGrid=function(){return this.gridObj;};this.getCallback=function(){return this.callback;};this.getIsvoiceye=function(){return this.isvoiceye;};this.setToolbar=function(_c){this.toolbar=_c;};this.setArgs=function(_c,_d){this.arg+=_c+"#"+_d+"#";};this.setFlicking=function(_c){this.flicking=_c;};this.setScrollPage=function(_c){this.scrollpage=_c;};this.setIsStreaming=function(_c){this.isStreaming=_c;};this.setScale=function(_c){this.scale=_c;};this.setTimeout=function(_c){this.timeout=_c;};this.setIsMultiReport=function(_c){this.ismultireport=_c;};this.setMultiCount=function(_c){this.multicount=_c;};this.setReportPath=function(_c){this.reportPath=_c;};this.setSaveFilename=function(_c){this.saveFilename=_c;};this.setLocalDs=function(_c){this.dsLocals.push(_c);};this.setIsvoiceye=function(_c){this.isvoiceye=_c;};this.clearLocalDs=function(){var _c=this.dsLocals.length;for(var _d=0;_d<_c;_d++ ){this.dsLocals.pop();}};this.setGrid=function(_b){this.gridObj=_b;};this.setCallback=function(_c){this.callback=_c;};};this.gfn_setLocalDs2Viewer=function(_c,_d){this.gfn_initReport(_c,_d);this.gfn_setReport2Viewer(_c,_d.getReportPath());if(_d.dsLocals){for(var _h=0;_h<_d.dsLocals.length;_h++ ){var _e=_d.dsLocals[_h];if(String.prototype.isPrototypeOf(_e[1])){var _f=new Dataset();_f.set_name(_e[0].name);_f.loadXML(_e[1],true);_c.setDataset(_e[0],_f);}else{_c.setDataset(_e[0],_e[1]);}}}var _g;if(this.comUtils.isNullEmpty(_d.callback)){_g="_retrieveEnd";}_c.retrieve(this,_g);};this.gfn_setGrid2Viewer=function(_c,_d){var _e=true;var _f=_d.getGrid();this.gfn_initReport(_c,_d);this.gfn_setReport2Viewer(_c,_d.getReportPath());if(_e==true){var _g=_f.getFormatRowCount();var _h=_f.getFormatColCount();var _i=new Array;var _j=new Array;var _k="230.230.230";var _l="240.240.240";var _m=0;var _n=0;var _o=0;var _p=0;var _q="";var _r="";var _s=0;var _t=0;for(_m=0;_m<_g;_m++ ){_q=_f.getFormatRowProperty(_m,"band");if(_q==_r){_p++ ;}else{_p=0;}_j[_m]=_f.getFormatRowSize(_m,_p,false);_r=_q;}for(_m=0;_m<_h;_m++ ){_i[_m]=_f.getRealColSize(_m);}var _u=0;var _v=0;var _w=_c.getDesignDataset(this);_r="";var _x=0;var _y=0;var _z=0;var _aa=0;var _ab=0;var _ac=0;var _ad=0;var _ae=0;var _af=0;var _ag=0;var _ah="";_y=_w.addRow();_w.setColumn(_y,"type","widths");_w.setColumn(_y,"text",_i);_w.setColumn(_y,"summarytype",_f.summarytype);_y=_w.addRow();_w.setColumn(_y,"type","heights");_w.setColumn(_y,"text",_j);for(_m=0;_m<_g;_m++ ){_q=_f.getFormatRowProperty(_m,"band");if(_q!=_r){if(_q=="head"){_x= -1;_ah=_k;}else if(_q=="body"){_x=0;_ah="";}else if(_q=="summ"){_x= -2;_ah=_l;}_u=_f.getCellCount(_q);for(_n=0;_n<_u;_n++ ){_z=_f.getCellProperty(_q,_n,"row");_aa=_f.getCellProperty(_q,_n,"col");_ac=_f.getCellProperty(_q,_n,"rowspan");_ab=_f.getCellProperty(_q,_n,"colspan");_y=_w.addRow();_w.setColumn(_y,"type",_q);_w.setColumn(_y,"row",_z);_w.setColumn(_y,"col",_aa);_w.setColumn(_y,"rowspan",_ac);_w.setColumn(_y,"colspan",_ab);_w.setColumn(_y,"align",_f.getCellProperty(_q,_n,"align"));if(_x!=0){_w.setColumn(_y,"text",_f.getCellText(_x,_n));}_w.setColumn(_y,"bgcolor",_ah);}}_r=_q;}this.addChild(_w.name,_w);_u=_f.getCellCount("Body");_v=_f.rowcount;var _ai=new Dataset("ds_ubiGrid",this);this.addChild(_ai.name,_ai);for(_m=0;_m<_u;_m++ ){_ai.addColumn("column"+_m,"string");}for(_n=0;_n<_v;_n++ ){_ai.addRow();for(_o=0;_o<_u;_o++ ){_ai.setColumn(_n,_o,_f.getCellText(_n,_o));}}_c.setRuntimeData(_w,_ai);this.removeChild(_w.name);this.removeChild(_ai.name);}var _aj;if(this.comUtils.isNullEmpty(_d.getCallback())){_aj="_retrieveEnd";}_c.retrieve(this,_aj);};this._retrieveEnd=function(){};this.gfn_initReport=function(_c,_d){var _e=application.services["svcurl"].url;var _f="web/hsco/ur/";_c.set_resource(_e+"ubireport/ajax/js4");_c.set_gatewayurl(_e+"UbiGateway.do");_c.set_dataurl(_e+"UbiData.do");_c.set_resid("UBIAJAX");_d.setArgs("EMPNO",this.gfn_getUserId());_d.setArgs("EMPNM",this.gfn_getUserName());_c.set_toolbar(_d.getToolbar());_c.set_arg(_d.getArgs());_c.set_flicking(_d.getFlicking());_c.set_scrollpage(_d.getScrollPage());_c.set_scale(_d.getScale());_c.set_ismultireport(_d.getIsMultiReport());_c.set_isStreaming(_d.getIsStreaming());_c.set_isvoiceye(_d.getIsvoiceye());if(_d.getIsMultiReport()){if(_d.getMultiCount()!=null){_c.set_multicount(_d.getMultiCount());}}_c.set_reporttitle(_d.getSaveFilename());};this.gfn_setReport2Viewer=function(_c,_d){var _e=_d.split(",");var _f=_e.length;var _g=_f>1?true:false;var _h=_g?_e[0]:_d;var _i=_h.split("/");var _j=_i.length;var _k=_i[_j-1];var _a=_h.replace(_k,"");var _l=application.services["svcurl"].url;var _m="web/hsco/ur/";var _n=_l+_m+_a.substr(1);var _o=_n;_c.set_jrffile(_d);_c.set_reporturl(_o);};});this.loadIncludeScript(_a);_b=null;};})();