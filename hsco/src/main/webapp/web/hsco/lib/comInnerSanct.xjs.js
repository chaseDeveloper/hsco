(function(){return function(_a){var _b;this.registerScript(_a,function(){this.mstDsNm="ds_sanctionRptParam";this.slvDsNm="ds_rptParamInfo";this.slvDsNmClob="ds_innerSanctnReprtDataClob";this.reportTitle="";this.userName="";this.reportUri="";this.saveFileName="";this.vOpts;this.dsCnt=0;this.gds_apprline;this.gds_fixapprline;this.isApprline=false;this.isViewMode=true;this.gfn_initSanctionReportMetaDs=function(_c){if(this.isValidObject(this.mstDsNm)){var _d=this.lookup(this.mstDsNm);_d.clearData();}else{this.gfn_makeRptMeta_Dataset();}if(this.isValidObject(this.slvDsNm)){var _e=this.lookup(this.slvDsNm);_e.clearData();}else{this.gfn_makeRptDataMeta_Dataset();}};this.gfn_createTranMetaDs=function(){if(!this.isValidObject(this.mstDsNm)){this.gfn_makeRptMeta_Dataset();}if(!this.isValidObject(this.slvDsNm)){this.gfn_makeRptDataMeta_Dataset();}};this.gfn_makeRptMeta_Dataset=function(){var _c='<Dataset id="ds_sanctionRptParam" >';_c+='    <ColumnInfo>';_c+='        <Column id="INNER_SANCTN_ID" type="STRING" size="256"/>';_c+='        <Column id="SN" type="BIGDECIMAL" size="256"/>';_c+='        <Column id="SVC_ID" type="STRING" size="256"/>';_c+='        <Column id="SVC_URL" type="STRING" size="512"/>';_c+='        <Column id="INPUT_DATA_SET" type="STRING" size="512"/>';_c+='        <Column id="OUTPUT_DATA_SET" type="STRING" size="512"/>';_c+='        <Column id="REPRT_URL" type="STRING" size="512"/>';_c+='        <Column id="REPRT_SJ" type="STRING" size="256"/>';_c+='        <Column id="STRE_FILE_NM" type="STRING" size="100"/>';_c+='    </ColumnInfo>';_c+='</Dataset>';var _d=this.lookup(this.mstDsNm);var _d=new Dataset(this.mstDsNm);_d.loadXML(_c);this.addChild(this.mstDsNm,_d);};this.gfn_makeRptDataMeta_Dataset=function(){var _c='<Dataset id="ds_rptParamInfo" >';_c+='    <ColumnInfo>';_c+='      <Column id="INNER_SANCTN_ID" type="STRING" size="256"/>';_c+='      <Column id="SN" type="BIGDECIMAL" size="256"/>';_c+='      <Column id="SVC_ID" type="STRING" size="256"/>';_c+='      <Column id="SVC_URL" type="STRING" size="512"/>';_c+='      <Column id="DATA_SET_SE" type="STRING" size="256"/>';_c+='      <Column id="PARAMTR_ID" type="STRING" size="256"/>';_c+='      <Column id="DATA_SET_NM" type="STRING" size="256"/>';_c+='      <Column id="INPUT_DATA" type="STRING" size="4000"/>';_c+='      <Column id="OUTPUT_XML" type="STRING" size="4000"/>';_c+='      <Column id="ORDR" type="BIGDECIMAL" size="256"/>';_c+='    </ColumnInfo>';_c+='</Dataset>';var _d=this.lookup(this.slvDsNm);_d=new Dataset(this.slvDsNm);_d.loadXML(_c);this.addChild(this.slvDsNm,_d);};this.gfn_makeRptDataMetaClob_Dataset=function(){var _c='<Dataset id="ds_innerSanctnReprtDataClob" >';_c+='    <ColumnInfo>';_c+='      <Column id="INNER_SANCTN_ID" type="STRING" size="256"/>';_c+='      <Column id="SN" type="BIGDECIMAL" size="256"/>';_c+='      <Column id="SVC_ID" type="STRING" size="256"/>';_c+='      <Column id="SVC_URL" type="STRING" size="512"/>';_c+='      <Column id="DATA_SET_SE" type="STRING" size="256"/>';_c+='      <Column id="PARAMTR_ID" type="STRING" size="256"/>';_c+='      <Column id="DATA_SET_NM" type="STRING" size="256"/>';_c+='      <Column id="INPUT_DATA_CLOB" type="STRING" size="4000"/>';_c+='      <Column id="OUTPUT_XML_CLOB" type="STRING" size="4000"/>';_c+='      <Column id="ORDR" type="BIGDECIMAL" size="256"/>';_c+='    </ColumnInfo>';_c+='</Dataset>';var _d=this.lookup(this.slvDsNmClob);_d=new Dataset(this.slvDsNmClob);_d.loadXML(_c);this.addChild(this.slvDsNmClob,_d);};this.gfn_makeOutputDsToXml=function(){if(!this.isValidObject(this.slvDsNmClob)){this.gfn_makeRptDataMetaClob_Dataset();}var _c=this.lookup(this.slvDsNmClob);_c.clearData();var _d=this.lookup(this.slvDsNm);_c.copyData(_d);if(_c.getConstColumn("INPUT_DATA_CLOB")==undefined){_c.addColumn("INPUT_DATA_CLOB","STRING");}if(_c.getConstColumn("OUTPUT_XML_CLOB")==undefined){_c.addColumn("OUTPUT_XML_CLOB","STRING");}for(var _g=0;_g<_d.rowcount;_g++ ){var _e=_d.getColumn(_g,"DATA_SET_SE");if("O"==_e){var _f=this.lookup(_d.getColumn(_g,"PARAMTR_ID"));_c.setColumn(_g,"OUTPUT_XML_CLOB",_f.saveXML());}else if("I"==_e){_c.setColumn(_g,"INPUT_DATA_CLOB",_d.getColumn(_g,"INPUT_DATA"));}}};this.gfn_showOutputDsToXml=function(_c,_d,_e){var _f=new this.cf_Opts();_f.setArgs("TODAY",this.dateUtils.today());_f.setReportPath(_c.getColumn(0,"REPRT_URL"));_f.setSaveFilename(_c.getColumn(0,"STRE_FILE_NM"));for(var _j=0;_j<_d.rowcount;_j++ ){var _g=_d.getColumn(_j,"DATA_SET_SE");if("O"==_g){var _h=_d.getColumn(_j,"PARAMTR_ID");var _i=new Dataset(_h);_i.loadXML(_d.getColumn(_j,"OUTPUT_XML"));_f.setLocalDs([_h,_i]);}}this.gfn_makeGdsApplineData(_e);this.gfn_makeGdsFixApplineData(_e);_f.setLocalDs(["gds_apprline",this.gds_apprline]);_f.setLocalDs(["gds_fixapprline",this.gds_fixapprline]);this.div_ubiReport.showReport(_f);};this.gfn_showApprLine=function(_c){this.gfn_makeGdsApplineData(_c);this.gfn_makeGdsFixApplineData(_c);this.vOpts.setLocalDs(["gds_apprline",this.gds_apprline]);this.vOpts.setLocalDs(["gds_fixapprline",this.gds_fixapprline]);this.div_ubiReport.showReport(this.vOpts);};this.gfn_makeGdsApplineMeta_Dataset=function(){var _c='<Dataset id="gds_apprline" >'+'    <ColumnInfo>'+'      <Column id="APPRLINE_COL1" type="STRING" size="256"/>'+'      <Column id="APPRLINE_COL2" type="STRING" size="256"/>'+'      <Column id="APPRLINE_COL3" type="STRING" size="256"/>'+'      <Column id="SANCTNER_ID" type="STRING" size="256"/>'+'    </ColumnInfo>'+'</Dataset>';return _c;};this.gfn_makeGdsApplineData=function(_c){this.gds_apprline=new Dataset("gds_apprline");var _d=this.gfn_makeGdsApplineMeta_Dataset();this.gds_apprline.loadXML(_d);var _e=6;var _f=_c.rowcount;var _g=_e-_f;for(var _h=0;_h<_g;_h++ ){this.gds_apprline.addRow();this.gds_apprline.setColumn(_h,"APPRLINE_COL1","");}this.gds_apprline.appendData(_c);};this.gfn_makeGdsFixApplineMeta_Dataset=function(){var _c='<Dataset id="gds_fixapprline" >'+'    <ColumnInfo>'+'      <Column id="C1_SANCTNER" type="STRING" size="256"/>'+'      <Column id="C1_SANCTNDT" type="STRING" size="256"/>'+'      <Column id="C2_SANCTNER" type="STRING" size="256"/>'+'      <Column id="C2_SANCTNDT" type="STRING" size="256"/>'+'      <Column id="C3_SANCTNER" type="STRING" size="256"/>'+'      <Column id="C3_SANCTNDT" type="STRING" size="256"/>'+'      <Column id="C4_SANCTNER" type="STRING" size="256"/>'+'      <Column id="C4_SANCTNDT" type="STRING" size="256"/>'+'      <Column id="C5_SANCTNER" type="STRING" size="256"/>'+'      <Column id="C5_SANCTNDT" type="STRING" size="256"/>'+'    </ColumnInfo>'+'</Dataset>';return _c;};this.gfn_makeGdsFixApplineData=function(_c){this.gds_fixapprline=new Dataset("gds_fixapprline");var _d=this.gfn_makeGdsFixApplineMeta_Dataset();this.gds_fixapprline.loadXML(_d);this.gds_fixapprline.addRow();for(var _f=0;_f<_c.rowcount;_f++ ){var _e=_f+1;this.gds_fixapprline.setColumn(0,"C"+_e+"_SANCTNER",_c.getColumn(_f,"APPRLINE_COL2"));this.gds_fixapprline.setColumn(0,"C"+_e+"_SANCTNDT",_c.getColumn(_f,"APPRLINE_COL3"));}};this.gfn_makeReportTranInfo=function(_c,_d,_e,_f,_g,_h,_i,_j){this.gfn_initSanctionReportMetaDs(_c);var _k=this.lookup(this.mstDsNm);var _l=_k.getMax("SN");if(_l==undefined){_l=1;}else{_l=_l+1;}var _m="INNER_SANCTN_ID=="+_c;_k.filter("");_k.filter(_m);_k.filter("");var _n="INNER_SANCTN_ID=="+_c+" && SVC_URL=='"+_e+"'";var _o=_k.findRowExpr(_n);if(_o== -1){_o=_k.addRow();}_k.setColumn(_o,"INNER_SANCTN_ID",_c);_k.setColumn(_o,"SN",_l);_k.setColumn(_o,"SVC_ID",_d);_k.setColumn(_o,"SVC_URL",_e);_k.setColumn(_o,"INPUT_DATA_SET",_f);_k.setColumn(_o,"OUTPUT_DATA_SET",_g);_k.setColumn(_o,"REPRT_SJ",_h);_k.setColumn(_o,"REPRT_URL",_i);_k.setColumn(_o,"STRE_FILE_NM",_j);var _p=this.lookup(this.slvDsNm);var _q=_f.split(" ");for(var _y=0;_y<_q.length;_y++ ){var _r=_q[_y].split("=");var _s=_p.addRow();_p.setColumn(_s,"INNER_SANCTN_ID",_c);_p.setColumn(_s,"SN",_l);_p.setColumn(_s,"SVC_ID",_d);_p.setColumn(_s,"SVC_URL",_e);_p.setColumn(_s,"DATA_SET_SE","I");_p.setColumn(_s,"PARAMTR_ID",_r[0]);_p.setColumn(_s,"DATA_SET_NM",_r[1]);var _t=this.lookup(_r[1]);if(_t!=null){_p.setColumn(_s,"INPUT_DATA",_t.saveXML());}else{trace(_r[1]+" 객체가 없습니다!");}_p.setColumn(_s,"OUTPUT_XML","");}var _u=_g.split(" ");for(var _y=0;_y<_u.length;_y++ ){var _v=_u[_y].split("=");var _s=_p.addRow();_p.setColumn(_s,"INNER_SANCTN_ID",_c);_p.setColumn(_s,"SN",_l);_p.setColumn(_s,"SVC_ID",_d);_p.setColumn(_s,"SVC_URL",_e);_p.setColumn(_s,"DATA_SET_SE","O");_p.setColumn(_s,"PARAMTR_ID",_v[0]);_p.setColumn(_s,"DATA_SET_NM",_v[1]);_p.setColumn(_s,"INPUT_DATA","");var _w=this.lookup(_v[0]);if(_w!=null){var _x=new Dataset(_v[0]);_x.loadXML(_w.saveXML());_x.clearData();_p.setColumn(_s,"OUTPUT_XML",_x.saveXML());}else{trace(_v[0]+"====dsObj 객체 찾을 수 없음 ====\n");}}};this.gfn_getXML=function(_c,_d){var _e='<Dataset id="'+_d+'" useclientlayout="false" >'+"\n";_e+="    <ColumnInfo>"+"\n";for(var _g=0;_g<_c.colinfos.length;_g++ ){var _f=_c.colinfos[_g];_e+='        <Column id="'+_f.name+'" type="'+_f.type+'" size="'+_f.size+'" />'+'\n';}_e+="    </ColumnInfo>"+"\n";_e+="</Dataset>";return _e;};this._existsMetaDs=function(){var _c=true;var _d=this.lookup(this.mstDsNm);if(_d==null){_c=false;return;}var _e=this.lookup(this.slvDsNm);if(_e==null){_c=false;return;}return _c;};this.gfn_makeRptDatasets=function(_c,_d){if(_c!=null){for(var _l=0;_l<_c.getRowCount();_l++ ){var _e=_c.getColumn(_l,"DATA_SET_SE");if(_e=="I"){var _f=_c.getColumn(_l,"DATA_SET_NM");var _g=new Dataset(_f);var _h=_c.getColumn(_l,"INPUT_DATA");_g.loadXML(_h);this.addChild(_f,_g);}else if(_e=="O"){var _i=_c.getColumn(_l,"PARAMTR_ID");var _g=this.lookup(_i);if(this.isValidObject(_i)){_g.setEventHandler("onload",this.gfn_rpt_ds_onload,this);}else{var _j=new Dataset(_i);var _k=_c.getColumn(_l,"OUTPUT_XML");_j.loadXML(_k);this.addChild(_i,_j);_j.set_useclientlayout(false);_j.setEventHandler("onload",this.gfn_rpt_ds_onload,this);}}}}if(_d){this.isApprline=true;this.gfn_makeGdsApplineData(_d);this.gds_apprline.setEventHandler("onload",this.gfn_rpt_dsapprline_onload,this);}};this.gfn_openInnerSanctionPopup=function(_c,_d,_e){if(_e==undefined||_e==""){this.gfn_message("info.처리불가","업무데이터 등록일시가 입력되지 않았습니다.");return;}var _f=application.gds_userInfo.getColumn(0,"SYS_OPEN_DT");if(_f==undefined||_f==""){this.gfn_message("info.처리불가","시스템 오픈일자가 없습니다.");return;}switch(_e.length){case 14:if(Number(_e)<Number(_f+"000000")){this.gfn_message("info.처리불가","차세대 시스템 오픈전 등록 데이터는 내부결재가 불가능합니다.");return;}break;case 8:if(Number(_e)<Number(_f)){this.gfn_message("info.처리불가","차세대 시스템 오픈전 등록 데이터는 내부결재가 불가능합니다.");return;}break;default:this.gfn_message("info.처리불가","업무데이터 등록일시 자리수를 확인하여 주시기 바랍니다.");return;}if(!this._existsMetaDs){return;}var _g=this.lookup(this.mstDsNm);var _h=this.lookup(this.slvDsNm);var _i={arg_0:this,arg_1:_g,arg_2:_h,arg_3:_c};this.gfn_popup("InnerSactionPopup",1100,730,"내부결재관리",_i,"com_sym_ism::SYM090200_P11.xfdl",_d);};this.filteredRowCount=function(_c,_d,_e){var _f=0;for(var _g=0;_g<_c.getRowCount();_g++ ){if(_c.getColumn(_g,_d)==_e){_f++ ;}}return _f;};this.gfn_selectReportDs=function(_c,_d){this.dsCnt=this.filteredRowCount(_d,"DATA_SET_SE","O");var _e=_c.getRowCount();this.vOpts=new this.cf_Opts();this.vOpts.setToolbar(false);this.vOpts.setScale(100);this.reportTitle=_c.getColumn(0,"REPRT_SJ");this.reportUri=_c.getColumn(0,"REPRT_URL");this.saveFileName=_c.getColumn(0,"STRE_FILE_NM");this.vOpts.setArgs("title",this.reportTitle);this.vOpts.setArgs("EMPNO",this.gfn_getUserId());this.vOpts.setArgs("EMPNM",this.gfn_getUserName());this.vOpts.setReportPath(this.reportUri);this.vOpts.setSaveFilename(this.saveFileName);for(var _p=0;_p<_e;_p++ ){var _f=_c.getColumn(_p,"INNER_SANCTN_ID");var _g=_c.getColumn(_p,"SVC_ID");var _h=_c.getColumn(_p,"SVC_URL");var _i=_c.getColumn(_p,"INPUT_DATA_SET");var _j=_c.getColumn(_p,"OUTPUT_DATA_SET");var _k=_c.getColumn(_p,"INPUT_DATA_SET");for(var _q=0;_q<_d.getRowCount();_q++ ){var _l=_d.getColumn(_q,"DATA_SET_SE");var _m=_d.getColumn(_q,"PARAMTR_ID");var _n=_d.getColumn(_q,"DATA_SET_NM");if(_l=="I"){var _o=this.lookup(_n);_o.removeEventHandler("onload",this.gfn_rpt_ds_onload,this);_o.clearData();_o.loadXML(_d.getColumn(_q,"INPUT_DATA"));_o.setEventHandler("onload",this.gfn_rpt_ds_onload,this);}}Ex.core.tran(this,_g,_h,_i,_j,_k,"gfn_reportDsCallback",false,false);}};this.gfn_reportDsCallback=function(_c,_d,_e){if(this.isApprline){this.gds_apprline.load();}};this.gfn_rpt_dsapprline_onload=function(_b,_c){this.vOpts.setLocalDs([_b.name,_b]);if(this.isViewMode){this.div_ubiReport.showReport(this.vOpts);}};this.gfn_rpt_ds_onload=function(_b,_c){this.vOpts.setLocalDs([_b.name,_b]);var _d=this.vOpts.getLocalDs().length;if(this.isViewMode&&_d==this.dsCnt&&!this.isApprline){this.div_ubiReport.showReport(this.vOpts);}};this.gfn_setSandtionIdToRptDs=function(_c,_d){var _e=_d.getRowCount();if(_e>0){for(var _f=0;_f<_e;_f++ ){_d.setColumn(0,"INNER_SANCTN_ID",_c);}}};this.gfn_exportRptToPdf=function(_c,_d,_e,_f,_g,_h,_i){if("S08"==_f||"S09"==_f||("S01"==_f&&_g)){var _j=String.fromCharCode(28);var _k=String.fromCharCode(29);var _l=String.fromCharCode(30);var _m=String.fromCharCode(31);var _n="/ubireport/ubi_export_pdf.jsp";var _o=_d;var _p="title#"+this.reportTitle+"#"+"EMPNO#"+this.gfn_getUserId()+"#"+"EMPNM#"+this.gfn_getUserName()+"#";var _q="DS";var _r=_e;var _s=_c;var _t=_h;for(var _ah=0;_ah<_t.length;_ah++ ){if(_t[_ah][1].name=="gds_apprline"){var _u=_t[_ah][1];var _v=_i.getColumn(_i.findRow("CODE",_f),"CODE_NM");var _w=this.dateUtils.format(this.gfn_today(),'mm/dd')+'('+_v+')';var _x=_u.findRow("SANCTNER_ID",this.gfn_getUserId());_t[_ah][1].setColumn(_x,"APPRLINE_COL3",_w);break;}}var _y=[];_y.push("LOCALDATASET:"+_l);for(var _ah=0;_ah<_t.length;_ah++ ){if(_t[_ah]&&_t[_ah].length==2){_y.push(_t[_ah][0]+_m);_y.push(_t[_ah][1].name+_m);_y.push(_l);}}for(var _ah=0;_ah<_t.length;_ah++ ){if(_t[_ah]&&_t[_ah].length==2){if(_ah==0){_y.push("SSV:utf-8"+_l);}_y.push(_t[_ah][1].saveSSV(_t[_ah][1].name,"N"));}}var _z=document.createElement("form");_z.setAttribute("id","preview_form"+_c);_z.setAttribute("method","post");_z.setAttribute("action",_n);_z.setAttribute("target","UBI_WIN_EXPORT"+_c);var _aa=document.createElement('input');_aa.type='hidden';_aa.name='jrf';_aa.value=_o;_z.appendChild(_aa);var _ab=document.createElement('input');_ab.type='hidden';_ab.name='arg';_ab.value=_p;_z.appendChild(_ab);var _ac=document.createElement('input');_ac.type='hidden';_ac.name='datatype';_ac.value=_q;_z.appendChild(_ac);var _ad=document.createElement('input');_ad.type='hidden';_ad.name='jobse';_ad.value=_r;_z.appendChild(_ad);var _ae=document.createElement('input');_ae.type='hidden';_ae.name='exportfile';_ae.value=_s;_z.appendChild(_ae);var _af=document.createElement('input');_af.type='hidden';_af.name='ssvdata';_af.value=_y.join("");_z.appendChild(_af);document.body.appendChild(_z);var _ag=document.createElement("iframe");_ag.setAttribute("id","UBI_WIN_EXPORT"+_c);_ag.setAttribute("name","UBI_WIN_EXPORT"+_c);_ag.style.width="0";_ag.style.height="0";document.body.appendChild(_ag);_z.submit();}};});this.loadIncludeScript(_a);_b=null;};})();