(function(){return function(){if(!this._is_form){return;}this.on_create=function(){var _a=null;if(Form==this.constructor){this.set_name("FileManager_test");this.set_classname("FileManager_test");this.set_titletext("파일 메니저 테스트");this._setFormPosition(0,0,1059,735);}_a=new Dataset("ds_fileMast",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"FILE_SN\" type=\"STRING\" size=\"256\"/><Column id=\"SYS_SE_CODE\" type=\"STRING\" size=\"256\"/><Column id=\"JOB_SE_CODE\" type=\"STRING\" size=\"256\"/><Column id=\"REGISTER_ID\" type=\"STRING\" size=\"256\"/><Column id=\"REGIST_DT\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_fileList",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"CHK\" type=\"STRING\" size=\"256\"/><Column id=\"FILE_SN\" type=\"STRING\" size=\"256\"/><Column id=\"FILE_ORDR\" type=\"STRING\" size=\"256\"/><Column id=\"FILE_STRE_COURS\" type=\"STRING\" size=\"256\"/><Column id=\"STRE_FILE_NM\" type=\"STRING\" size=\"256\"/><Column id=\"ORGINL_FILE_NM\" type=\"STRING\" size=\"256\"/><Column id=\"FILE_EXTSN\" type=\"STRING\" size=\"256\"/><Column id=\"FILE_CN\" type=\"STRING\" size=\"256\"/><Column id=\"FILE_MG\" type=\"STRING\" size=\"256\"/><Column id=\"USE_AT\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_singleFile",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"FILE_SN\" type=\"STRING\" size=\"256\"/><Column id=\"FILE_ORDR\" type=\"STRING\" size=\"256\"/><Column id=\"FILE_STRE_COURS\" type=\"STRING\" size=\"256\"/><Column id=\"STRE_FILE_NM\" type=\"STRING\" size=\"256\"/><Column id=\"ORGINL_FILE_NM\" type=\"STRING\" size=\"256\"/><Column id=\"FILE_EXTSN\" type=\"STRING\" size=\"256\"/><Column id=\"FILE_CN\" type=\"STRING\" size=\"256\"/><Column id=\"FILE_MG\" type=\"STRING\" size=\"256\"/><Column id=\"USE_AT\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Div("div_multiFile","absolute","0.85%","8",null,"225","1.04%",null,this);_a.set_taborder("1");_a.set_cssclass("div_WFSA_Box");this.addChild(_a.name,_a);_a=new Grid("grd_fileMast","absolute","0.96%","7",null,"201","64.22%",null,this.div_multiFile);_a.set_taborder("42");_a.set_binddataset("ds_fileMast");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"120\"/><Column size=\"100\"/><Column size=\"100\"/><Column size=\"93\"/><Column size=\"80\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"24\"/></Rows><Band id=\"head\"><Cell text=\"FILE_SN\"/><Cell col=\"1\" text=\"SYS_SE_CODE\"/><Cell col=\"2\" text=\"JOB_SE_CODE\"/><Cell col=\"3\" text=\"REGISTER_ID\"/><Cell col=\"4\" text=\"REGIST_DT\"/></Band><Band id=\"body\"><Cell text=\"bind:FILE_SN\"/><Cell col=\"1\" text=\"bind:SYS_SE_CODE\"/><Cell col=\"2\" text=\"bind:JOB_SE_CODE\"/><Cell col=\"3\" text=\"bind:REGISTER_ID\"/><Cell col=\"4\" text=\"bind:REGIST_DT\"/></Band></Format></Formats>");this.div_multiFile.addChild(_a.name,_a);_a=new Grid("grd_fileList","absolute",null,"31","387","180","251",null,this.div_multiFile);_a.set_taborder("43");_a.set_binddataset("ds_fileList");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"40\"/><Column size=\"120\"/><Column size=\"66\"/><Column size=\"63\"/><Column size=\"63\"/><Column size=\"73\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"24\"/></Rows><Band id=\"head\"><Cell displaytype=\"checkbox\"/><Cell col=\"1\" text=\"파일명\"/><Cell col=\"2\" text=\"확장자\"/><Cell col=\"3\" text=\"용량\"/><Cell col=\"4\" text=\"사용여부\"/><Cell col=\"5\" text=\"삭제\"/></Band><Band id=\"body\"><Cell displaytype=\"checkbox\" edittype=\"checkbox\" text=\"bind:CHK\"/><Cell col=\"1\" text=\"bind:ORGINL_FILE_NM\"/><Cell col=\"2\" text=\"bind:FILE_EXTSN\"/><Cell col=\"3\" text=\"bind:FILE_MG\"/><Cell col=\"4\" text=\"bind:USE_AT\"/><Cell col=\"5\" displaytype=\"button\" text=\"삭제\"/></Band></Format></Formats>");this.div_multiFile.addChild(_a.name,_a);_a=new ImageViewer("ImageViewer00","absolute",null,"31","222","180","9",null,this.div_multiFile);_a.set_taborder("44");_a.set_text("ImageViewer00");_a.set_stretch("fixaspectratio");this.div_multiFile.addChild(_a.name,_a);_a=new Button("btn_atchFiles","absolute",null,"7","67","19","570",null,this.div_multiFile);_a.set_taborder("45");_a.set_text("파일선택");_a.set_cssclass("btn_WF_Process");this.div_multiFile.addChild(_a.name,_a);_a=new Button("btn_uploadFiles","absolute",null,"7","68","19","253",null,this.div_multiFile);_a.set_taborder("46");_a.set_text("파일업로드");_a.set_cssclass("btn_WF_Process");this.div_multiFile.addChild(_a.name,_a);_a=new Button("btn_delFiles","absolute",null,"7","68","19","416",null,this.div_multiFile);_a.set_taborder("47");_a.set_text("선택삭제");_a.set_cssclass("btn_WF_Process");this.div_multiFile.addChild(_a.name,_a);_a=new Button("btn_downFiles","absolute",null,"7","85","19","326",null,this.div_multiFile);_a.set_taborder("48");_a.set_text("선택다운로드");_a.set_cssclass("btn_WF_Process");this.div_multiFile.addChild(_a.name,_a);_a=new Div("div_singleFile","absolute","0.76%","248",null,"196","1.13%",null,this);_a.set_taborder("2");_a.set_cssclass("div_WFSA_Box");this.addChild(_a.name,_a);_a=new Static("sta_WFDA_Label13","absolute","38.57%","10",null,"27","0.77%",null,this.div_singleFile);_a.set_taborder("35");_a.set_cssclass("sta_WF_Labelbg");this.div_singleFile.addChild(_a.name,_a);_a=new Static("sta_detAtchFile","absolute","38.57%","10",null,"27","51.78%",null,this.div_singleFile);_a.set_taborder("36");_a.set_text("첨부파일");_a.set_cssclass("sta_WF_Label");this.div_singleFile.addChild(_a.name,_a);_a=new Edit("edt_atchFile","absolute","48.41%","13",null,"21","12.34%",null,this.div_singleFile);_a.set_taborder("37");_a.set_readonly("true");_a.set_enableevent("false");this.div_singleFile.addChild(_a.name,_a);_a=new Button("btn_atchFile","absolute","85.44%","13",null,"21","12.34%",null,this.div_singleFile);_a.set_taborder("38");_a.set_cssclass("btn_WF_Search");this.div_singleFile.addChild(_a.name,_a);_a=new Button("btn_cancelAtchFile","absolute","87.85%","13",null,"21","7.04%",null,this.div_singleFile);_a.set_taborder("39");_a.set_text("취소");this.div_singleFile.addChild(_a.name,_a);_a=new Button("btn_delAtchFile","absolute","87.85%","13",null,"21","7.04%",null,this.div_singleFile);_a.set_taborder("40");_a.set_text("삭제");this.div_singleFile.addChild(_a.name,_a);_a=new Button("btn_viewAtchFile","absolute","93.15%","13",null,"21","1.83%",null,this.div_singleFile);_a.set_taborder("41");_a.set_text("보기");this.div_singleFile.addChild(_a.name,_a);_a=new Grid("grd_singleFile","absolute","0.96%","31",null,"150","64.22%",null,this.div_singleFile);_a.set_taborder("42");_a.set_binddataset("ds_singleFile");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/></Columns><Rows><Row band=\"head\" size=\"24\"/><Row band=\"body\" size=\"24\"/></Rows><Band id=\"head\"><Cell col=\"0\" disptype=\"normal\" text=\"파일일련번호\"/><Cell col=\"1\" disptype=\"normal\" text=\"파일순차번호\"/><Cell col=\"2\" disptype=\"normal\" text=\"FILE_STRE_COURS\"/><Cell col=\"3\" disptype=\"normal\" text=\"STRE_FILE_NM\"/><Cell col=\"4\" disptype=\"normal\" text=\"파일명\"/><Cell col=\"5\" disptype=\"normal\" text=\"FILE_EXTSN\"/><Cell col=\"6\" disptype=\"normal\" text=\"FILE_CN\"/><Cell col=\"7\" disptype=\"normal\" text=\"FILE_MG\"/><Cell col=\"8\" disptype=\"normal\" text=\"USE_AT\"/></Band><Band id=\"body\"><Cell col=\"0\" disptype=\"normal\" text=\"bind:FILE_SN\"/><Cell col=\"1\" disptype=\"normal\" text=\"bind:FILE_ORDR\"/><Cell col=\"2\" disptype=\"normal\" text=\"bind:FILE_STRE_COURS\"/><Cell col=\"3\" disptype=\"normal\" text=\"bind:STRE_FILE_NM\"/><Cell col=\"4\" disptype=\"normal\" text=\"bind:ORGINL_FILE_NM\"/><Cell col=\"5\" disptype=\"normal\" text=\"bind:FILE_EXTSN\"/><Cell col=\"6\" disptype=\"normal\" text=\"bind:FILE_CN\"/><Cell col=\"7\" disptype=\"normal\" text=\"bind:FILE_MG\"/><Cell col=\"8\" disptype=\"normal\" text=\"bind:USE_AT\"/></Band></Format></Formats>");this.div_singleFile.addChild(_a.name,_a);_a=new Button("btn_copyFileInfo","absolute","300","7","67","19",null,null,this.div_singleFile);_a.set_taborder("43");_a.set_text("파일정보");_a.set_cssclass("btn_WF_Process");this.div_singleFile.addChild(_a.name,_a);_a=new Button("btn_uploadFile","absolute","92.67%","55",null,"19","0.77%",null,this.div_singleFile);_a.set_taborder("44");_a.set_text("파일업로드");_a.set_cssclass("btn_WF_Process");this.div_singleFile.addChild(_a.name,_a);_a=new Layout("default","",0,225,this.div_multiFile,function(_b){_b.set_taborder("1");_b.set_cssclass("div_WFSA_Box");});this.div_multiFile.addLayout(_a.name,_a);_a=new Layout("default","",0,196,this.div_singleFile,function(_b){_b.set_taborder("2");_b.set_cssclass("div_WFSA_Box");});this.div_singleFile.addLayout(_a.name,_a);_a=new Layout("default","",1059,735,this,function(_b){_b.set_classname("FileManager_test");_b.set_titletext("파일 메니저 테스트");});this.addLayout(_a.name,_a);_a=new BindItem("item0","div_singleFile.edt_atchFile","value","ds_singleFile","ORGINL_FILE_NM");this.addChild(_a.name,_a);_a.bind();_a=null;};this.addIncludeScript("FileManager_test.xfdl","lib::comInclude.xjs");this.addIncludeScript("FileManager_test.xfdl","pms_lib::pmsUtil.xjs");this.addIncludeScript("FileManager_test.xfdl","pms_lib::gridUtil.xjs");this.registerScript("FileManager_test.xfdl",function(){this.FILE_MANAGER=null;this.form_oninit=function(_a,_b){this.fn_init_form();this.fn_init_allGrid(this,false);};this.form_onload=function(_a,_b){var _c={onChange:this.fn_onFileSelected,onSuccess:this.fn_onFileSuccess};this.FILE_MANAGER=new this.fileManager(this,"PMS","SLS");this.FILE_MANAGER.init(_c);this.fn_setSingleFileView();};this.fn_init_form=function(){this.gfn_initForm(this);};this.fn_search=function(){this.FILE_MANAGER.cancelAllFile();this.pmsUtil.clearDataSet([this.ds_fileList]);this.fn_transaction("selectFileMastList");};this.fn_transaction=function(_a){var _b=true;var _c=null;var _d=null;var _e=null;var _f=null;switch(_a){case "selectFileMastList":_f={};_f["FILE_SN"]="";_c="hsco/cmm/file/selectAtchmnFileMastList.do";_d=_f;_e="ds_fileMast=output1";break;case "selectAtchmnFileList":_f=this.pmsUtil.getGridSelectedItem(this.div_multiFile.grd_fileMast);_c="hsco/cmm/file/selectAtchmnFileList.do";_d=_f;_e="ds_fileList=output1";break;default:break;}if(_c==null){return;}var _g=typeof (_d);if(_g=="object"){this.pmsUtil.pmsComTran(_a,_c,_d,_e,null,null,false);}else{Ex.core.tran(this,_a,_c,_d,_e,null,null,null,_b);}};this.fn_callBack=function(_a,_b,_c){var _d=_b==0?true:false;if(_d){var _e=null;var _f=null;switch(_a){case "selectFileMastList":break;default:break;}}else{this.gfn_callBackMsg(_a,_b,_c);}};this.fn_btnOnClickHandler=function(_a,_b){var _c=_a.name;switch(_c){case "btn_atchFiles":this.fn_addAtchFile(true);break;case "btn_uploadFiles":this.fn_uploadFiles();break;case "btn_delFiles":var _d={};_d["viewRow"]="expr:CHK == '1'";var _e=this.pmsUtil.datasetToObject(this.ds_fileList,_d,true);var _f=_e==null?0:_e.length;trace("선택자료 = "+_f);if(_f==0){this.alert("선택된 자료가없습니다.");return;}var _g=this.pmsUtil._setDynamicInDataset(_e,true);trace(_g);break;case "btn_downFiles":trace("btn_downFiles");var _d={};_d["viewRow"]="expr:CHK == '1'";var _h=this.pmsUtil.datasetToObject(this.ds_fileList,_d,true);var _i=this.pmsUtil.isArray(_h);if(_i){var _j=_h==null?0:_h.length;if(_j==0){this.alert("선택된 자료가없습니다.");return;}trace("checkDownLeng = "+_j);for(var _s=0;_s<_j;_s++ ){var _k=_h[_s].FILE_SN;var _l=_h[_s].FILE_ORDR;var _m=_h[_s].ORGINL_FILE_NM;trace(_k+" :: "+_l);this.FILE_MANAGER.download(_k,_l,_m);}}else{var _k=_h.FILE_SN;var _l=_h.FILE_ORDR;var _m=_h.ORGINL_FILE_NM;this.FILE_MANAGER.download(_k,_l,_m);}break;case "btn_copyFileInfo":var _n=this.ds_fileList.getRowCount();if(_n<2){this.ds_singleFile.copyData(this.ds_fileList);}this.fn_setSingleFileView();break;case "btn_atchFile":this.fn_addAtchFile(false);break;case "btn_cancelAtchFile":var _o=this.div_singleFile.grd_singleFile;var _p=this.pmsUtil.getGridSelectedItem(_o);var _q=_p["STRE_FILE_NM"];var _r=_p["ORGINL_FILE_NM"];if(this.comUtils.isNullEmpty(_q)){this.fn_canceAtchlFile(_r,_o,false);}break;case "btn_delAtchFile":this.fn_deleteAtchFile();break;case "btn_viewAtchFile":this.fn_downloadAtchFile();break;case "btn_uploadFile":this.fn_uploadFiles();break;default:break;}};this.fn_grdOnCellClickHandler=function(_a,_b){var _c=_a.name;var _d=_b.oldrow;var _e=_b.row;var _f=_b.col;var _g=_b.cell;switch(_c){case "grd_fileMast":this.FILE_MANAGER.cancelAllFile();this.fn_transaction("selectAtchmnFileList");break;case "grd_fileList":var _h=this.pmsUtil.getGridSelectedItem(_a);if(_f==0){_a.setCellProperty("Head",_g,"text","0");}else if(_f==5){var _i=_h["STRE_FILE_NM"];var _j=_h["ORGINL_FILE_NM"];if(this.comUtils.isNullEmpty(_i)){this.fn_canceAtchlFile(_j,_a,true);}else{var _k="선택한 파일("+_j+")을 삭제하시겠습니까?";if(confirm(_k)){alert("파일 삭제!");}}}else{var _l=_h["FILE_EXTSN"];var _m=_h["FILE_SN"];var _n=_h["FILE_ORDR"];var _o=_h["ATCH_FILE"];if(_l=="jpg"){var _p={};_p["FILE_SN"]=_m;_p["FILE_ORDR"]=_n;this.div_multiFile.ImageViewer00.set_image("");var _q=application.gv_host+"hsco/cmm/download/viewImage.do";var _r="?FILE_SN="+_m+"&FILE_ORDR="+_n;this.div_multiFile.ImageViewer00.set_image(_q+_r);}else{this.FILE_MANAGER.download(_m,_n,_o);}}break;default:break;}};this.fn_grdOnHeadClickHandler=function(_a,_b){var _c=_a.name;switch(_c){case "grd_fileList":if(_b.col==0){this.gfn_setGridCheckAll(_a,_b);}break;default:break;}};this.fn_addAtchFile=function(_a){var _b=null;var _c=_a;this.FILE_MANAGER.addFiles(_b,_c);};this.fn_canceAtchlFile=function(_a,_b,_c){var _d=this.FILE_MANAGER.cancelFiles(_a);if(_d){if(_c){this.pmsUtil.deleteGridSelectedItem(_b);}else{trace("단건");this.pmsUtil.deleteGridSelectedItem(_b);this.fn_setSingleFileView();}}};this.fn_uploadFiles=function(){var _a=this.FILE_MANAGER.hasFile();if(_a){trace("첨부파일 있음!"+this.FILE_MANAGER.getfileCount());var _b="hsco/pms/com/COM000000/uploadFile.do";var _c="";var _d="ds_fileList=fileList";this.FILE_MANAGER.upload(_b,_c,_d);}else{alert("업로드 대상 파일이 없습니다.");}};this.fn_deleteAtchFile=function(){var _a="첨부파일을 삭제하시겠습니까?";if(confirm(_a)){this.fn_transaction("deleteLadDetailFileInfo");}};this.fn_onFileSelected=function(_a,_b){if(_a==this.FILE_MANAGER.TYPE_UPLOADER){var _c=this.pmsUtil.isArray(_b);if(_c){trace("다건처리");var _d=_b.length;for(var _h=0;_h<_d;_h++ ){var _e=this.ds_fileList.addRow();this.ds_fileList.setColumn(_e,"ORGINL_FILE_NM",_b[_h]);}}else{trace("단건처리");var _f=this.ds_singleFile.getRowCount();var _g= -1;if(_f>0){_g=this.ds_singleFile.rowposition;}else{_g=this.ds_singleFile.addRow();}this.ds_singleFile.setColumn(_g,"ORGINL_FILE_NM",_b);this.fn_setSingleFileView();}}};this.fn_setSingleFileView=function(){var _a=this.pmsUtil.getGridSelectedItem(this.div_singleFile.grd_singleFile,"FILE_SN");var _b=this.pmsUtil.getGridSelectedItem(this.div_singleFile.grd_singleFile,"ORGINL_FILE_NM");var _c=this.comUtils.isNullEmpty(_a)?false:true;var _d=this.comUtils.isNullEmpty(_b)?false:true;this.div_singleFile.btn_atchFile.set_visible(!_d);this.div_singleFile.btn_cancelAtchFile.set_visible(!_c);if(!_c){this.div_singleFile.btn_cancelAtchFile.set_enable(_d);}this.div_singleFile.btn_delAtchFile.set_visible(_c);this.div_singleFile.btn_viewAtchFile.set_visible(_c);};});this.on_initEvent=function(){this.addEventHandler("oninit",this.form_oninit,this);this.addEventHandler("onload",this.form_onload,this);this.div_multiFile.grd_fileMast.addEventHandler("oncellclick",this.fn_grdOnCellClickHandler,this);this.div_multiFile.grd_fileList.addEventHandler("oncellclick",this.fn_grdOnCellClickHandler,this);this.div_multiFile.btn_atchFiles.addEventHandler("onclick",this.fn_btnOnClickHandler,this);this.div_multiFile.btn_uploadFiles.addEventHandler("onclick",this.fn_btnOnClickHandler,this);this.div_multiFile.btn_delFiles.addEventHandler("onclick",this.fn_btnOnClickHandler,this);this.div_multiFile.btn_downFiles.addEventHandler("onclick",this.fn_btnOnClickHandler,this);this.div_singleFile.btn_atchFile.addEventHandler("onclick",this.fn_btnOnClickHandler,this);this.div_singleFile.btn_cancelAtchFile.addEventHandler("onclick",this.fn_btnOnClickHandler,this);this.div_singleFile.btn_delAtchFile.addEventHandler("onclick",this.fn_btnOnClickHandler,this);this.div_singleFile.btn_viewAtchFile.addEventHandler("onclick",this.fn_btnOnClickHandler,this);this.div_singleFile.btn_copyFileInfo.addEventHandler("onclick",this.fn_btnOnClickHandler,this);this.div_singleFile.btn_uploadFile.addEventHandler("onclick",this.fn_btnOnClickHandler,this);};this.loadIncludeScript("FileManager_test.xfdl");};})();