(function(){return function(){if(!this._is_form){return;}this.on_create=function(){var _a=null;if(Form==this.constructor){this.set_name("SAM010200");this.set_classname("Guide_10");this.set_titletext("파일 업로드/다운로드 관리");this._setFormPosition(0,0,694,474);}_a=new Dataset("ds_cmmnAtchmnflMastr",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"FILE_SN\" type=\"BIGDECIMAL\" size=\"20\"/><Column id=\"SYS_SE_CODE\" type=\"STRING\" size=\"6\"/><Column id=\"JOB_SE\" type=\"STRING\" size=\"3\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_files",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a.set_useclientlayout("true");_a._setContents("<ColumnInfo><Column id=\"FILE_SN\" type=\"BIGDECIMAL\" size=\"20\"/><Column id=\"FILE_ORDR\" type=\"INT\" size=\"3\"/><Column id=\"FILE_STRE_COURS\" type=\"STRING\" size=\"2000\"/><Column id=\"STRE_FILE_NM\" type=\"STRING\" size=\"255\"/><Column id=\"ORGINL_FILE_NM\" type=\"STRING\" size=\"255\"/><Column id=\"FILE_EXTSN\" type=\"STRING\" size=\"20\"/><Column id=\"FILE_CN\" type=\"STRING\" size=\"4000\"/><Column id=\"FILE_MG\" type=\"INT\" size=\"8\"/><Column id=\"USE_AT\" type=\"STRING\" size=\"1\"/><Column id=\"FILE_ID\" type=\"STRING\" size=\"256\"/><Column id=\"SN\" type=\"INT\" size=\"5\"/><Column id=\"SYS_SE_CODE\" type=\"STRING\" size=\"6\"/><Column id=\"JOB_SE\" type=\"STRING\" size=\"3\"/><Column id=\"FILE_TY\" type=\"STRING\" size=\"256\"/><Column id=\"FILE_IMAGE\" type=\"STRING\" size=\"256\"/><Column id=\"PROGRS\" type=\"INT\" size=\"5\"/><Column id=\"TRNSMIS_FILE_SIZE\" type=\"INT\" size=\"256\"/><Column id=\"DELETE_IMAGE\" type=\"STRING\" size=\"256\"/><Column id=\"STTUS\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_download",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a.set_useclientlayout("true");_a._setContents("<ColumnInfo><Column id=\"FILE_SN\" type=\"BIGDECIMAL\" size=\"20\"/><Column id=\"FILE_ORDR\" type=\"INT\" size=\"3\"/><Column id=\"FILE_STRE_COURS\" type=\"STRING\" size=\"2000\"/><Column id=\"STRE_FILE_NM\" type=\"STRING\" size=\"255\"/><Column id=\"ORGINL_FILE_NM\" type=\"STRING\" size=\"255\"/><Column id=\"FILE_EXTSN\" type=\"STRING\" size=\"20\"/><Column id=\"FILE_CN\" type=\"STRING\" size=\"4000\"/><Column id=\"FILE_MG\" type=\"INT\" size=\"8\"/><Column id=\"USE_AT\" type=\"STRING\" size=\"1\"/><Column id=\"FILE_ID\" type=\"STRING\" size=\"256\"/><Column id=\"SN\" type=\"INT\" size=\"5\"/><Column id=\"SYS_SE_CODE\" type=\"STRING\" size=\"6\"/><Column id=\"JOB_SE\" type=\"STRING\" size=\"3\"/><Column id=\"FILE_TY\" type=\"STRING\" size=\"256\"/><Column id=\"FILE_IMAGE\" type=\"STRING\" size=\"256\"/><Column id=\"PROGRS\" type=\"INT\" size=\"5\"/><Column id=\"TRNSMIS_FILE_SIZE\" type=\"INT\" size=\"256\"/><Column id=\"DELETE_IMAGE\" type=\"STRING\" size=\"256\"/><Column id=\"STTUS\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("form_url",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"FORM_URL\" type=\"STRING\" size=\"256\"/></ColumnInfo><Rows><Row><Col id=\"FORM_URL\">com::SAM010200.xfdl</Col></Row></Rows>");this.addChild(_a.name,_a);_a=new Dataset("ds_validation",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"compId\" type=\"STRING\" size=\"256\"/><Column id=\"colId\" type=\"STRING\" size=\"256\"/><Column id=\"PK\" type=\"STRING\" size=\"256\"/><Column id=\"notNull\" type=\"STRING\" size=\"256\"/><Column id=\"type\" type=\"STRING\" size=\"256\"/><Column id=\"nlength\" type=\"STRING\" size=\"256\"/><Column id=\"from\" type=\"STRING\" size=\"256\"/><Column id=\"to\" type=\"STRING\" size=\"256\"/><Column id=\"lengthChkGb\" type=\"STRING\" size=\"256\"/><Column id=\"msgId\" type=\"STRING\" size=\"256\"/><Column id=\"expr\" type=\"STRING\" size=\"256\"/><Column id=\"func\" type=\"STRING\" size=\"256\"/></ColumnInfo><Rows><Row><Col id=\"compId\">grd_files</Col><Col id=\"colId\">FILE_SN</Col><Col id=\"PK\">[Undefined]</Col><Col id=\"notNull\">Y</Col><Col id=\"type\">[Undefined]</Col><Col id=\"msgId\">파일일련번호</Col></Row><Row><Col id=\"compId\">grd_files</Col><Col id=\"colId\">FILE_ORDR</Col><Col id=\"PK\">[Undefined]</Col><Col id=\"notNull\">Y</Col><Col id=\"msgId\">파일순번</Col></Row></Rows>");this.addChild(_a.name,_a);_a=new Dataset("ds_cond00",this);_a._setContents("<ColumnInfo><Column id=\"FILE_SN\" type=\"BIGDECIMAL\" size=\"20\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_delete",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a.set_useclientlayout("true");_a._setContents("<ColumnInfo><Column id=\"FILE_SN\" type=\"BIGDECIMAL\" size=\"20\"/><Column id=\"FILE_ORDR\" type=\"INT\" size=\"3\"/><Column id=\"FILE_STRE_COURS\" type=\"STRING\" size=\"2000\"/><Column id=\"STRE_FILE_NM\" type=\"STRING\" size=\"255\"/><Column id=\"ORGINL_FILE_NM\" type=\"STRING\" size=\"255\"/><Column id=\"FILE_EXTSN\" type=\"STRING\" size=\"20\"/><Column id=\"FILE_CN\" type=\"STRING\" size=\"4000\"/><Column id=\"FILE_MG\" type=\"INT\" size=\"8\"/><Column id=\"USE_AT\" type=\"STRING\" size=\"1\"/><Column id=\"FILE_ID\" type=\"STRING\" size=\"256\"/><Column id=\"SN\" type=\"INT\" size=\"5\"/><Column id=\"SYS_SE_CODE\" type=\"STRING\" size=\"6\"/><Column id=\"JOB_SE\" type=\"STRING\" size=\"3\"/><Column id=\"FILE_TY\" type=\"STRING\" size=\"256\"/><Column id=\"FILE_IMAGE\" type=\"STRING\" size=\"256\"/><Column id=\"PROGRS\" type=\"INT\" size=\"5\"/><Column id=\"TRNSMIS_FILE_SIZE\" type=\"INT\" size=\"256\"/><Column id=\"DELETE_IMAGE\" type=\"STRING\" size=\"256\"/><Column id=\"STTUS\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_fileSn",this);_a.set_firefirstcount("0");_a.getSetter("firenextcount").set("0");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a.set_useclientlayout("true");_a._setContents("<ColumnInfo><Column id=\"FILE_SN\" type=\"BIGDECIMAL\" size=\"20\"/><Column id=\"SYS_SE_CODE\" type=\"STRING\" size=\"6\"/><Column id=\"JOB_SE\" type=\"STRING\" size=\"3\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Static("Static00","absolute","0","0","694","528",null,null,this);_a.set_taborder("0");_a.set_cssclass("sta_WF_PopupBg");this.addChild(_a.name,_a);_a=new Static("Static01","absolute","2","2","691","34",null,null,this);_a.set_taborder("1");_a.set_text("메인화면 파일 업로드/다운로드");_a.set_cssclass("sta_WF_PopupTitle");this.addChild(_a.name,_a);_a=new Static("Static05","absolute","0","2","15","528",null,null,this);_a.set_taborder("2");_a.set_text("15");_a.set_visible("false");_a.style.set_background("#1b3cd23c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Button("btn_close","absolute","669","8","20","20",null,null,this);_a.set_taborder("3");_a.set_cssclass("btn_WF_PopupClose");this.addChild(_a.name,_a);_a=new Static("Static02","absolute","679","2","15","528",null,null,this);_a.set_taborder("4");_a.set_text("15");_a.set_visible("false");_a.style.set_background("#1b3cd23c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Static("Static06","absolute","2","36","691","15",null,null,this);_a.set_taborder("5");_a.set_text("15");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Static("Static03","absolute","2","511","692","15",null,null,this);_a.set_taborder("6");_a.set_text("15");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Static("sta_title","absolute","15","53","197","21",null,null,this);_a.set_taborder("54");_a.set_cssclass("sta_WF_Title01");_a.set_text("메인화면 파일 업로드/다운로드");this.addChild(_a.name,_a);_a=new Grid("grd_files","absolute","15","193","664","285",null,null,this);_a.set_taborder("56");_a.set_binddataset("ds_files");_a.set_autofittype("col");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"23\"/><Column size=\"40\"/><Column size=\"51\"/><Column size=\"262\"/><Column size=\"124\"/><Column size=\"54\"/><Column size=\"39\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"24\"/><Row size=\"24\"/><Row size=\"24\" band=\"summ\"/></Rows><Band id=\"head\"><Cell celltype=\"head\" displaytype=\"checkbox\" edittype=\"checkbox\"/><Cell col=\"1\" text=\"순번\"/><Cell col=\"2\" text=\"다운로드\"/><Cell col=\"3\" celltype=\"head\" text=\"파일명\"/><Cell col=\"4\" text=\"확장자/사이즈\"/><Cell col=\"5\" text=\"사용여부\"/><Cell col=\"6\" text=\"삭제\"/></Band><Band id=\"body\"><Cell rowspan=\"2\" displaytype=\"checkbox\" edittype=\"checkbox\" style=\"cursor:pointer;\"/><Cell col=\"1\" rowspan=\"2\" displaytype=\"normal\" text=\"bind:SN\"/><Cell col=\"2\" rowspan=\"2\" displaytype=\"image\" text=\"bind:FILE_IMAGE\" autosizerow=\"limitmin\" autosizecol=\"limitmin\"/><Cell col=\"3\" displaytype=\"normal\" style=\"align:left middle;\" text=\"bind:ORGINL_FILE_NM\"/><Cell col=\"4\" text=\"bind:FILE_EXTSN\"/><Cell col=\"5\" rowspan=\"2\" displaytype=\"checkbox\" edittype=\"checkbox\" text=\"bind:USE_AT\"/><Cell col=\"6\" rowspan=\"2\" displaytype=\"image\" edittype=\"none\" text=\"bind:DELETE_IMAGE\" autosizerow=\"limitmin\" autosizecol=\"limitmin\"/><Cell row=\"1\" col=\"3\" displaytype=\"expr:(PROGRS &lt; 100)?((PROGRS &lt; 0)?'normal':'bar'):'normal'\" text=\"bind:PROGRS\" expr=\"expr:(PROGRS &lt; 100)?((PROGRS &lt; 0)?'Error!':PROGRS + '%'):'완료'\"/><Cell row=\"1\" col=\"4\" text=\"bind:FILE_MG\"/></Band><Band id=\"summary\"><Cell colspan=\"2\"/><Cell col=\"2\"/><Cell col=\"3\" text=\"expr:comp.parent.fn_TotalSizeSum()\"/><Cell col=\"4\" colspan=\"2\" text=\"expr:comp.parent.fn_taskingSum()\"/><Cell col=\"6\"/></Band></Format></Formats>");this.addChild(_a.name,_a);_a=new Static("Static07","absolute","15","159",null,"10","15",null,this);_a.set_taborder("57");_a.set_text("10");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Static("Static04","absolute","15","478",null,"10","15",null,this);_a.set_taborder("61");_a.set_text("10");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Static("Static11","absolute","15","133","96","27",null,null,this);_a.set_taborder("65");_a.set_text("파일유형");_a.set_cssclass("sta_WF_Label");this.addChild(_a.name,_a);_a=new Static("Static12","absolute","15","107","96","27",null,null,this);_a.set_taborder("66");_a.set_text("파일명");_a.set_cssclass("sta_WF_Label");this.addChild(_a.name,_a);_a=new Static("Static36","absolute","15","81","96","27",null,null,this);_a.set_taborder("69");_a.set_text("첨부일련번호");_a.set_cssclass("sta_WF_Label");this.addChild(_a.name,_a);_a=new Static("Static13","absolute","15","188","664","5",null,null,this);_a.set_taborder("70");_a.set_text("5");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Static("Static14","absolute","110","133","568","27",null,null,this);_a.set_taborder("72");_a.set_cssclass("sta_WF_Labelbg");this.addChild(_a.name,_a);_a=new Static("Static15","absolute","110","107","568","27",null,null,this);_a.set_taborder("74");_a.set_cssclass("sta_WF_Labelbg");this.addChild(_a.name,_a);_a=new Static("sta_title00","absolute","15","168","197","21",null,null,this);_a.set_taborder("75");_a.set_text("목록");_a.set_cssclass("sta_WF_Title02");this.addChild(_a.name,_a);_a=new Static("Static09","absolute","15","76","665","5",null,null,this);_a.set_taborder("76");_a.set_text("5");_a.set_visible("false");_a.style.set_background("#dc143c3c");_a.style.set_align("center middle");this.addChild(_a.name,_a);_a=new Static("Static37","absolute","110","81","568","27",null,null,this);_a.set_taborder("77");_a.set_cssclass("sta_WF_Labelbg");this.addChild(_a.name,_a);_a=new Edit("edtFileSn","absolute","114","84","238","21",null,null,this);_a.set_taborder("78");_a.set_readonly("true");this.addChild(_a.name,_a);_a=new Button("btn_selectFile","absolute","504","110","66","21",null,null,this);_a.set_taborder("79");_a.set_text("파일선택");this.addChild(_a.name,_a);_a=new Edit("edt_fileNm","absolute","114","110","388","21",null,null,this);_a.set_taborder("80");_a.set_readonly("true");this.addChild(_a.name,_a);_a=new Static("Static10","absolute","357","133","108","27",null,null,this);_a.set_taborder("82");_a.set_text("파일크기(Bytes)");_a.set_cssclass("sta_WF_Label");this.addChild(_a.name,_a);_a=new Edit("edt_fileExtsn","absolute","467","84","103","21",null,null,this);_a.set_taborder("83");this.addChild(_a.name,_a);_a=new Button("btn_delete","absolute","600","51","78","25",null,null,this);_a.set_taborder("89");_a.set_cssclass("btn_WF_CRUD");_a.set_text("전체 삭제");this.addChild(_a.name,_a);_a=new Button("btn_save","absolute","454","51","50","25",null,null,this);_a.set_taborder("90");_a.set_text("저장");_a.set_cssclass("btn_WF_CRUD");_a.set_visible("true");this.addChild(_a.name,_a);_a=new Button("btn_delRow","absolute","520","169","64","19",null,null,this);_a.set_taborder("91");_a.set_text("행삭제");_a.set_cssclass("btn_WF_Griddel");this.addChild(_a.name,_a);_a=new MaskEdit("mae_fileMg","absolute","467","136","103","21",null,null,this);_a.set_taborder("92");_a.set_mask("###,###,###");_a.set_maskchar("0");this.addChild(_a.name,_a);_a=new Static("Static53","absolute","606","169","82","19",null,null,this);_a.set_taborder("93");_a.set_text("[단위 : Bytes]");_a.set_cssclass("sta_WF_txt01");_a.style.set_align("left middle");this.addChild(_a.name,_a);_a=new Static("Static16","absolute","584","169","23","19",null,null,this);_a.set_taborder("94");_a.set_text("23");_a.set_visible("false");_a.style.set_background("#00ffff66");this.addChild(_a.name,_a);_a=new Static("Static17","absolute","357","81","108","27",null,null,this);_a.set_taborder("95");_a.set_text("확장자");_a.set_cssclass("sta_WF_Label");this.addChild(_a.name,_a);_a=new Edit("edt_fiileTy","absolute","114","136","238","21",null,null,this);_a.set_taborder("96");this.addChild(_a.name,_a);_a=new ImageViewer("img_loading","absolute",null,null,"90","90","310","91",this);_a.set_taborder("101");_a.set_image("URL('theme://images/loading_blue.gif')");this.addChild(_a.name,_a);_a=new MaskEdit("mae_prgs","absolute","577","136","103","21",null,null,this);_a.set_taborder("102");_a.set_visible("false");this.addChild(_a.name,_a);_a=new Static("sta_helpMessage","absolute","2.16%","219",null,"304","2.31%",null,this);_a.set_taborder("104");_a.set_text("마우스로 파일을 끌어오십시오.");_a.style.set_background("white");_a.style.set_border("2 dashed #a9c1d9ff");_a.style.set_color("#c9ced9ff");_a.style.set_bordertype("round 5 5");_a.style.set_align("center middle");_a.style.set_font("bold 14 굴림");_a.style.set_opacity("60");this.addChild(_a.name,_a);_a=new Button("btn_downloadAll","absolute","73.05%","51",null,"25","13.98%",null,this);_a.set_taborder("105");_a.set_text("전체 다운로드");_a.set_cssclass("btn_WF_CRUD");this.addChild(_a.name,_a);_a=new Static("Static20","absolute","73.49%","169","10","19",null,null,this);_a.set_taborder("107");_a.set_text("10");_a.set_visible("false");_a.style.set_background("#00ffff66");this.addChild(_a.name,_a);_a=new Layout("default","",694,474,this,function(_b){_b.set_classname("Guide_10");_b.set_titletext("파일 업로드/다운로드 관리");});this.addLayout(_a.name,_a);_a=new BindItem("item1","edt_fileExtsn","value","ds_files","FILE_EXTSN");this.addChild(_a.name,_a);_a.bind();_a=new BindItem("item3","edt_fileNm","value","ds_files","ORGINL_FILE_NM");this.addChild(_a.name,_a);_a.bind();_a=new BindItem("item0","mae_fileMg","value","ds_files","FILE_MG");this.addChild(_a.name,_a);_a.bind();_a=new BindItem("item2","edt_fiileTy","value","ds_files","FILE_TY");this.addChild(_a.name,_a);_a.bind();_a=new BindItem("item4","edtFileSn","value","ds_files","FILE_SN");this.addChild(_a.name,_a);_a.bind();_a=new BindItem("item5","mae_prgs","value","ds_files","PROGRS");this.addChild(_a.name,_a);_a.bind();_a=null;};this.addIncludeScript("SAM010200.xfdl","lib::comInclude.xjs");this.addIncludeScript("SAM010200.xfdl","lib::comUpDownload.xjs");this.registerScript("SAM010200.xfdl",function(){this.extUp;this.extDown;this.sysSe="SYS";this.jobSe="COM";this.fileSn;this.SAM010200_oninit=function(_a,_b){this.fn_init_form();this.formUrl=_a.parent.formurl;};this.SAM010200_onload=function(_a,_b){trace("SAM010200_onload start");this.fileSn=this.ds_fileSn.getColumn(0,"FILE_SN");this.sysSe=this.ds_fileSn.getColumn(0,"SYS_SE_CODE");this.jobSe=this.ds_fileSn.getColumn(0,"JOB_SE");this.fn_init_dataset();this.initFile(this.grd_files,false,false);};this.fn_init_form=function(){this.gfn_initForm(this);this.img_loading.set_visible(false);if(this.ds_files.rowcount==0){this.btn_save.set_visible(false);}};this.fn_init_dataset=function(){};this.fn_search=function(){trace("fn_search start");this.ds_cond00.addRow();this.ds_cond00.setColumn(0,"FILE_SN",this.fileSn);this.fn_transaction("AtchFileList");};this.fn_saveFileInfo=function(){if(!this.gfn_checkValidation(this.grd_files,this.ds_validation)){return;}if(this.gfn_message("comm.행위여부","저장")){this.fn_transaction("updateFileInfo");}if(this.ds_files.getRowCount()>0){this.fileSn=this.ds_files.getColumn(0,"FILE_SN");}};this.fn_deleteFile=function(){if(this.ds_files.getRowCount()>0){this.fileSn=this.ds_files.getColumn(0,"FILE_SN");}this.fn_transaction("deleteFile");};this.fn_deleteAllFile=function(){if(this.ds_files.getRowCount()>0){this.fileSn=this.ds_files.getColumn(0,"FILE_SN");}this.fn_transaction("deleteAllFile");};this.fn_downloadFiles=function(){};this.btn_downloadAll_onclick=function(_a,_b){if(this.ds_files.getRowCount()>0){this.fileSn=this.ds_files.getColumn(0,"FILE_SN");}for(var _d=0;_d<this.ds_files.getRowCount();_d++ ){var _c=this.ds_files.getColumn(_d,"FILE_ORDR");if(_c!=""&&_c!=undefined&&_c!=null){this.ds_download.clearData();this.fn_copyAddRow(this.ds_files,_d,this.ds_download, -1);this.downloadFile(0);}}};this.fn_transaction=function(_a){switch(_a){case "AtchFileList":var _b="hsco/cmm/file/selectAtchmnFileList.do";var _c="input1=ds_cond00 gds_form=form_url";var _d="ds_files=output1";trace("AtchFileList transaction start ::::");trace(this.ds_cond00.saveXML());trace("AtchFileList transaction start ::::");break;case "updateFileInfo":var _b="hsco/cmm/file/updateFileInfo.do";var _c="input1=ds_files:U gds_form=form_url";var _d="ds_files=output1";trace("updateFileInfo start");break;case "deleteFile":var _b="hsco/cmm/file/deleteFile.do";var _c="input1=ds_delete gds_form=form_url";var _d="ds_files=output1";trace("deleteFile start = "+this.ds_delete.saveXML());break;case "deleteAllFile":var _b="hsco/cmm/file/deleteFile.do";var _c="input1=ds_delete gds_form=form_url";var _d="ds_files=output1";trace("deleteAllFile start = "+this.ds_delete.saveXML());break;}Ex.core.tran(this,_a,_b,_c,_d);};this.fn_callBack=function(_a,_b,_c){this.gfn_callback_message(_a,_b,_c);if(_b!=0){switch(_a){case "AtchFileList":break;case "updateFileInfo":break;case "deleteFile":break;case "deleteAllFile":break;}}else{switch(_a){case "AtchFileList":if(this.ds_files.rowcount>0){this.fileSn=this.ds_files.getColumn(0,"FILE_SN");this.sta_helpMessage.set_visible(false);this.btn_save.set_visible(true);}trace("AtchFileList fn_callBack start");break;case "updateFileInfo":break;case "deleteFile":this.fileSn=this.ds_delete.getColumn(0,"FILE_SN");this.ds_delete.clearData();this.ds_delete.applyChange();this.fn_search();break;case "deleteAllFile":this.fileSn=this.ds_delete.getColumn(0,"FILE_SN");this.extUp.removeAll();this.ds_delete.clearData();this.ds_delete.applyChange();this.fn_search();break;}}};this.btn_selectFile_onclick=function(_a,_b){this.extUp.addFiles();if(this.sta_helpMessage.visible){this.sta_helpMessage.set_visible(false);}};this.btn_delete_onclick=function(_a,_b){this.fn_filterNewRowInDeletes();this.fn_transaction("deleteAllFile");};this.fn_filterNewRowInDeletes=function(){this.ds_delete.clearData();for(var _b=0;_b<this.ds_files.getRowCount();_b++ ){var _a=this.ds_files.getColumn(_b,"FILE_ORDR");if(_a!=""&&_a!=undefined&&_a!=null){this.fn_copyAddRow(this.ds_files,_b,this.ds_delete, -1);this.ds_delete.applyChange();}else{if(false){}}}};this.grd_files_oncellclick=function(_a,_b){var _c=2;var _d=6;if(_b.cell==_c){this.ds_download.clearData();this.fn_copyAddRow(this.ds_files,_b.row,this.ds_download, -1);this.downloadFile(0);}else if(_b.cell==_d){this.ds_delete.clearData();this.fn_copyAddRow(this.ds_files,_b.row,this.ds_delete, -1);this.removeFile(_b.row);}};this.fn_copyAddRow=function(_a,_b,_c,_d){if(_d== -1){_d=_c.addRow();}_c.copyRow(_d,_a,_b);};this.removeFile=function(_a){if(Eco.isEmpty(_a)||_a<0){return;}var _b=this.ds_files;if(_b.getRowType(_a)==2){var _c=_b.getColumn(_a,"FILE_ID");trace("★ removeFile fileId="+_c+", row="+_a);this.extUp.removeFile(_c);_b.deleteRow(_a);}else{_b.deleteRow(_a);this.fn_transaction("deleteFile");}this.grd_files.redraw();};this.btn_save_onclick=function(_a,_b){if(!this.comUtils.isDatasetUpdated(this.ds_files)){this.gfn_message("comm.내역.변경.없음");}else{this.uploadFiles();}};this.uploadFiles=function(){var _a,_b,_c,_d,_e,_f,_g=this.ds_files;var _h=this.extUp;_f=_h.getAddedFileLength()||0;if(_f>0){if(!_h.support.XHR2||!_h.support.FileAPI){if(!this.img_loading.visible){var _i=Eco.XComp.getTopLevelForm(this);var _j=Math.round((_i.getOffsetWidth()-this.img_loading.getOffsetWidth())/2);var _k=Math.round((_i.getOffsetHeight()-this.img_loading.getOffsetHeight())/2);this.img_loading.move(_j,_k,this.img_loading.getOffsetWidth(),this.img_loading.getOffsetHeight());this.img_loading.set_visible(true);}}this.initProgressbar("upload");var _l=this.fileConfig.host+this.fileConfig.uploadUrl;if(this.fileSn!=null&&this.fileSn!=""&&this.fileSn!=null){for(var _a=0;_a<this.ds_files.getRowCount();_a++ ){var _m=this.ds_files.getColumn(0,"FILE_SN");if(this.fileSn==null||this.fileSn==""||this.fileSn!=null){this.ds_files.setColumn(0,"FILE_SN",this.fileSn);}}}var _n="ds_input=ds_files:U gds_form=form_url";_h.upload(_l,_n,"ds_files=ds_output1",this.transferType,0);}else{this.fn_saveFileInfo();}};this.downloadFile=function(_a){if(Eco.isEmpty(_a)||_a<0){return;}var _b=this.ds_download;var _c,_d,_e=0,_f,_g;var _h=this.tranFiles;_h.downloaded=[];_b.setColumn(_a,"PROGS",0);_c=_b.getColumn(_a,"FILE_ID");_d=_b.getColumn(_a,"ORGINL_FILE_NM");var _i=_b.getColumn(_a,"STRE_FILE_NM");_e=_b.getColumn(_a,"FILE_MG");_f={"id":_c,"name":_d,"size":_e,"row":_a};_h.downloaded.push(_f);var _g=this.fileConfig.host+this.fileConfig.downloadUrl;var _j=encodeURIComponent(_d);this.extDown.download(_g+"?fileKey="+_i+"&filename="+_j,_d);};this.extUpload_onchange=function(_a,_b){if(this.ds_files.getRowCount()>0){this.btn_save.set_visible(true);}this.extFileUpload_onchanged(_b,this.ds_files,this.sysSe,this.jobSe,this.fileSn);};this.btn_delRow_onclick=function(_a,_b){this.ds_files.deleteRow(_b.row);this.resetSn(this.ds_files);};this.initProgressbar=function(_a){if(_a=="upload"){this.tranFiles.preFileSizeSum=0;this.tranFiles.transferFileIndex=0;}};this.fn_TotalSizeSum=function(){var _a=0;var _b=0;for(var _d=0;_d<this.ds_files.rowcount;_d++ ){var _c=this.ds_files.getRowType(_d);if(_c==1||_c==2||_c==4){_a+=this.ds_files.getColumn(_d,"FILE_MG");_b++ ;}}return "[전체] "+_b+"건, "+this.bytesToSize(_a);};this.fn_taskingSum=function(){var _a=0;var _b=0;var _c=0;var _d=0;var _e="";for(var _g=0;_g<this.ds_files.rowcount;_g++ ){var _f=this.ds_files.getRowType(_g);if(_f==2||(_f==4&&this.ds_files.getColumn(_g,"FILE_ORDR")=="")){_a+=this.ds_files.getColumn(_g,"FILE_MG");_b++ ;}if(_f==8){_c+=this.ds_files.getColumn(_g,"FILE_MG");_d++ ;}}if(_b>0){_e+="[신규] "+_b+"건, "+this.bytesToSize(_a);}if(_d>0){_e+="[삭제예정] "+_d+"건, "+this.bytesToSize(_c);}return _e;};this.btn_confirm_onclick=function(_a,_b){trace("before return ::::"+this.ds_files.saveXML());this.close(this.ds_files.saveXML());};this.btn_cancel_onclick=function(_a,_b){this.close("");};this.btn_close_onclick=function(_a,_b){this.close("");};this.ds_files_onvaluechanged=function(_a,_b){if(this.ds_files.getRowCount()>0){this.btn_save.set_visible(true);}};});this.on_initEvent=function(){this.ds_files.addEventHandler("onvaluechanged",this.ds_files_onvaluechanged,this);this.addEventHandler("oninit",this.SAM010200_oninit,this);this.addEventHandler("onload",this.SAM010200_onload,this);this.btn_close.addEventHandler("onclick",this.btn_close_onclick,this);this.grd_files.addEventHandler("oncellclick",this.grd_files_oncellclick,this);this.btn_selectFile.addEventHandler("onclick",this.btn_selectFile_onclick,this);this.btn_delete.addEventHandler("onclick",this.btn_delete_onclick,this);this.btn_save.addEventHandler("onclick",this.btn_save_onclick,this);this.btn_delRow.addEventHandler("onclick",this.btn_delRow_onclick,this);this.sta_helpMessage.addEventHandler("onclick",this.sta_helpMessage_onclick,this);this.btn_downloadAll.addEventHandler("onclick",this.btn_downloadAll_onclick,this);};this.loadIncludeScript("SAM010200.xfdl");};})();