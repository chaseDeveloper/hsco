[CLIP report Server - Report Key 65a2937646f34f1cb1cdf9b6d1f844b4 Thread 52. | INFO 2020-10-15 10:21:26] : Report Read Time : TimeMillis : 427ms, HH:MM:SS : 00:00:00
[CLIP report Server - Report Key 65a2937646f34f1cb1cdf9b6d1f844b4 Thread 52. | INFO CODE=10 | 2020-10-15 10:21:26] : 리포트 생성을 시작합니다.
[CLIP report Server - Report Key 65a2937646f34f1cb1cdf9b6d1f844b4 Thread 52. | DEBUG CODE=10100 | 2020-10-15 10:21:26] : [SQL_TITLE] Data Query : SELECT MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '1',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_1
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '2',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_2
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '3',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_3
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '4',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_4
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '5',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_5
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '6',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_6
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '7',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_7
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '8',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_8
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '9',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_9
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '10', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_10
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '11', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_11
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '12', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_12
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '13', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_13
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '14', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_14
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '15', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_15
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '16', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_16
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '17', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_17
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '18', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_18
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '19', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_19
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '20', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_20
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '21', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_21
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '22', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_22
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '23', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_23
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '24', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_24
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '25', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_25
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '26', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_26
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '27', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_27
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '1',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_01
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '2',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_02
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '3',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_03
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '4',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_04
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '5',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_05
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '6',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_06
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '7',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_07
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '8',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_08
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '9',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_09
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '10', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_10
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '11', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_11
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '12', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_12
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '13', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_13
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '14', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_14
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '15', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_15
FROM   (
        SELECT RANK() OVER (PARTITION BY PYMNT_DDC_SE ORDER BY PYMNT_DDC_CODE) AS RNK
              ,s1.*
        FROM   (
                SELECT t1.PYMNT_DDC_SE
                      ,t1.PYMNT_DDC_CODE
                      ,t1.PYMNT_DDC_CODE_NM
                FROM   TBSAL_PYMNT_DDC_STDR_CODE t1
                WHERE  1=1
                AND    EXISTS (
                    SELECT 1
                    FROM   TBSAL_MT_SALARY_IEM t2
                    WHERE  t1.PYMNT_DDC_CODE = t2.PYMNT_DDC_CODE
                    AND    t2.PYMNT_YM = '202010'
                    AND    t2.SN       = '1'
                )
                AND    EXISTS (
                    SELECT 1
                    FROM   TBSAL_MT_SALARY_DTLS t3
                    WHERE  t1.PYMNT_DDC_CODE = t3.PYMNT_DDC_CODE
                    AND    t3.PYMNT_YM = '202010'
                    AND    t3.SN       = '1'
                )
                ORDER BY t1.OUTPT_ORDR
               ) s1
        WHERE  1=1
       )
WHERE  1=1
[CLIP report Server - Report Key 65a2937646f34f1cb1cdf9b6d1f844b4 Thread 52. | DEBUG 2020-10-15 10:21:27] : [SQL_TITLE] Database Info - Product Name : Oracle, Product Version : Oracle Database 11g Release 11.2.0.4.0 - 64bit Production
With the Real Application Clusters option, Driver Name : Oracle JDBC driver, Driver Version : 12.1.0.2.0
[CLIP report Server - Report Key 65a2937646f34f1cb1cdf9b6d1f844b4 Thread 52. | INFO 2020-10-15 10:21:27] : [SQL_TITLE] Connection Time : TimeMillis : 675ms, HH:MM:SS : 00:00:00
[CLIP report Server - Report Key 65a2937646f34f1cb1cdf9b6d1f844b4 Thread 52. | INFO 2020-10-15 10:21:27] : [SQL_TITLE] executeQuery : TimeMillis : 52ms, HH:MM:SS : 00:00:00
[CLIP report Server - Report Key 65a2937646f34f1cb1cdf9b6d1f844b4 Thread 52. | INFO CODE=501 | 2020-10-15 10:21:27] : [SQL_TITLE] Database data load rows : 1
[CLIP report Server - Report Key 65a2937646f34f1cb1cdf9b6d1f844b4 Thread 52. | DEBUG CODE=10100 | 2020-10-15 10:21:27] : [SQLDS1] Data Query : WITH MT_SALARY_PYMNT_T AS (
    SELECT t1.PYMNT_YM
          ,t1.SALARY_DEPT_CODE
          ,t4.SALARY_DEPT_NM
          ,t1.EMPNO
          ,t5.EMPNM
          ,REGEXP_REPLACE(H_DECRYPT(t5.IHIDNUM_ENCPT), '([0-9]{6})([0-9]{1})([0-9]{6})', '\1-\2******')   AS IHIDNUM
          ,t5.SRCLS
          ,t5.HR_CLSF_SE
          ,t6.CODE_NM           AS HR_CLSF_NM
          ,t1.EMPL_SE           AS JSSFC_SE
          ,t3.PYMNT_DDC_CODE
          ,t3.PYMNT_DDC_CODE_NM
          ,t2.AMOUNT
		  ,t1.SALARY_SE
		  ,t1.PD_BUDGET_AT
    FROM TBSAL_MT_SALARY_PYMNT t1
         INNER JOIN TBSAL_MT_SALARY_DTLS t2
           ON  t1.PYMNT_YM = t2.PYMNT_YM
           AND t1.SN = t2.SN
           AND t1.EMPNO = t2.EMPNO
         INNER JOIN TBSAL_PYMNT_DDC_STDR_CODE t3
           ON  t2.PYMNT_DDC_CODE = t3.PYMNT_DDC_CODE
         INNER JOIN TBSAL_SALARY_DEPT t4
           ON  t1.SALARY_DEPT_CODE = t4.SALARY_DEPT_CODE
         LEFT OUTER JOIN TBHRM_HR_MASTR t5
           ON  t1.EMPNO = t5.EMPNO
         LEFT OUTER JOIN TBCOM_CMMN_CODE t6
           ON  t5.HR_CLSF_SE = t6.CODE
           AND t6.GRP_CODE = 'HRM002'
    WHERE t1.PYMNT_YM         = '202010'
      AND t1.SN               = '1'
      AND t3.PYMNT_DDC_SE IN ('0', '1')          /*0:지급,1:공제*/
      AND t4.BSNS_TY          = 'A'
	  AND t1.SALARY_DEPT_CODE LIKE '%' || NVL('','%') || '%'
      AND t4.SALARY_DEPT_NM LIKE'%' ||  NVL('','%') || '%'
), SAL_TOTAL_T AS (
    SELECT 1 AS RNUM
          ,s1.SALARY_DEPT_CODE
          ,s1.SALARY_DEPT_NM
          ,s1.JSSFC_SE
          ,s1.HR_CLSF_SE
          ,s1.EMPNM
          ,MAX(s1.SRCLS) AS SRCLS
          ,MAX(s1.IHIDNUM) AS IHIDNUM
          ,MAX(s1.HR_CLSF_NM) AS HR_CLSF_NM
          ,s1.PYMNT_DDC_CODE_NM
          ,SUM(s1.AMOUNT) AS AMOUNT
    FROM   MT_SALARY_PYMNT_T s1
    WHERE  s1.JSSFC_SE IN ('01', '02', '03', '04', '08')
    GROUP BY s1.SALARY_DEPT_CODE, s1.SALARY_DEPT_NM, s1.JSSFC_SE, s1.HR_CLSF_SE, s1.EMPNM, s1.PYMNT_DDC_CODE_NM
    UNION ALL
    SELECT 2
          ,s1.SALARY_DEPT_CODE
          ,s1.SALARY_DEPT_NM ||' '||'(시설관리원)'
          ,s1.JSSFC_SE
          ,s1.HR_CLSF_SE
          ,s1.EMPNM
          ,MAX(s1.SRCLS) AS SRCLS
          ,MAX(s1.IHIDNUM) AS IHIDNUM
          ,MAX(s1.HR_CLSF_NM) AS HR_CLSF_NM
          ,s1.PYMNT_DDC_CODE_NM
          ,SUM(s1.AMOUNT)
    FROM   MT_SALARY_PYMNT_T s1
    WHERE  s1.JSSFC_SE = '05'
	AND      NVL(s1.PD_BUDGET_AT,'0') = '0'
    GROUP BY s1.SALARY_DEPT_CODE, s1.SALARY_DEPT_NM, s1.JSSFC_SE, s1.HR_CLSF_SE, s1.EMPNM, s1.PYMNT_DDC_CODE_NM
    UNION ALL
    SELECT 3
          ,s1.SALARY_DEPT_CODE
          ,s1.SALARY_DEPT_NM ||' '||'(강사 및 상용직)'
          ,s1.JSSFC_SE
          ,s1.HR_CLSF_SE
          ,s1.EMPNM
          ,MAX(s1.SRCLS) AS SRCLS
          ,MAX(s1.IHIDNUM) AS IHIDNUM
          ,MAX(s1.HR_CLSF_NM) AS HR_CLSF_NM
          ,s1.PYMNT_DDC_CODE_NM
          ,SUM(s1.AMOUNT)
    FROM   MT_SALARY_PYMNT_T s1
    WHERE  (s1.JSSFC_SE IN ('09', '06') OR (s1.JSSFC_SE = '05' AND NVL(s1.PD_BUDGET_AT,'0') = '1'))
    GROUP BY s1.SALARY_DEPT_CODE, s1.SALARY_DEPT_NM, s1.JSSFC_SE, s1.HR_CLSF_SE, s1.EMPNM, s1.PYMNT_DDC_CODE_NM
)
SELECT *
FROM SAL_TOTAL_T
PIVOT (
  SUM(AMOUNT)
  FOR PYMNT_DDC_CODE_NM
  IN (
'기본급' AS PYMNT0NM1
,'정액급식비' AS PYMNT0NM2
,'가족수당' AS PYMNT0NM3
,'자녀학비보조수당' AS PYMNT0NM4
,'위험근무수당' AS PYMNT0NM5
,'기술수당' AS PYMNT0NM6
,'운전수당' AS PYMNT0NM7
,'특정업무수당' AS PYMNT0NM8
,'시간외근무수당' AS PYMNT0NM9
,'휴일근무수당' AS PYMNT0NM10
,'야간근무수당' AS PYMNT0NM11
,'직책급업무' AS PYMNT0NM12
,'상여수당' AS PYMNT0NM13
,'장려수당' AS PYMNT0NM14
,'교통보조비' AS PYMNT0NM15
,'위생수당' AS PYMNT0NM16
,'관리업무수당' AS PYMNT0NM17
,'' AS PYMNT0NM18
,'' AS PYMNT0NM19
,'' AS PYMNT0NM20
,'' AS PYMNT0NM21
,'' AS PYMNT0NM22
,'' AS PYMNT0NM23
,'' AS PYMNT0NM24
,'' AS PYMNT0NM25
,'' AS PYMNT0NM26
,'' AS PYMNT0NM27
,'소득세' AS PYMNT1NM1
,'주민세' AS PYMNT1NM2
,'건강보험' AS PYMNT1NM3
,'국민연금' AS PYMNT1NM4
,'고용보험' AS PYMNT1NM5
,'상조회비' AS PYMNT1NM6
,'노조비' AS PYMNT1NM7
,'길맛' AS PYMNT1NM8
,'산악회' AS PYMNT1NM9
,'토요미식회' AS PYMNT1NM10
,'우수리모금' AS PYMNT1NM11
,'레포츠 동호회' AS PYMNT1NM12
,'' AS PYMNT1NM13
,'' AS PYMNT1NM14
,'' AS PYMNT1NM15
    )
)
UNION ALL
SELECT *
FROM (
    /** 급여 공제내역(자체사업비) **/
    WITH MT_SALARY_PYMNT_T AS (
        SELECT t1.PYMNT_YM
              ,t1.SALARY_DEPT_CODE
              ,t4.SALARY_DEPT_NM
              ,t1.EMPNO
              ,t5.EMPNM
              ,REGEXP_REPLACE(H_DECRYPT(t5.IHIDNUM_ENCPT), '([0-9]{6})([0-9]{1})([0-9]{6})', '\1-\2******')   AS IHIDNUM
              ,t5.SRCLS
              ,t5.HR_CLSF_SE
              ,t6.CODE_NM           AS HR_CLSF_NM
              ,t1.EMPL_SE           AS JSSFC_SE
              ,t3.PYMNT_DDC_CODE
              ,t3.PYMNT_DDC_CODE_NM
              ,t2.AMOUNT
			  ,t1.SALARY_SE
        FROM TBSAL_MT_SALARY_PYMNT t1
             INNER JOIN TBSAL_MT_SALARY_DTLS t2
               ON  t1.PYMNT_YM = t2.PYMNT_YM
               AND t1.SN = t2.SN
               AND t1.EMPNO = t2.EMPNO
             INNER JOIN TBSAL_PYMNT_DDC_STDR_CODE t3
               ON  t2.PYMNT_DDC_CODE = t3.PYMNT_DDC_CODE
             INNER JOIN TBSAL_SALARY_DEPT t4
               ON  t1.SALARY_DEPT_CODE = t4.SALARY_DEPT_CODE
             LEFT OUTER JOIN TBHRM_HR_MASTR t5
               ON  t1.EMPNO = t5.EMPNO
             LEFT OUTER JOIN TBCOM_CMMN_CODE t6
               ON  t5.HR_CLSF_SE = t6.CODE
               AND t6.GRP_CODE = 'HRM002'
        WHERE t1.PYMNT_YM         = '202010'
          AND t1.SN               = '1'
          AND t3.PYMNT_DDC_SE IN ('0', '1')          /*0:지급,1:공제*/
          AND (t4.BSNS_TY IS NULL OR t4.BSNS_TY <> 'A')
	      AND t1.SALARY_DEPT_CODE LIKE '%' || NVL('','%') || '%'
          AND t4.SALARY_DEPT_NM LIKE'%' ||  NVL('','%') || '%'
    ), SAL_TOTAL_T AS (
        SELECT 1   AS RNUM
              ,s1.SALARY_DEPT_CODE
              ,s1.SALARY_DEPT_NM
              ,s1.JSSFC_SE
              ,s1.HR_CLSF_SE
              ,s1.EMPNM
              ,MAX(s1.SRCLS) AS SRCLS
              ,MAX(s1.IHIDNUM) AS IHIDNUM
              ,MAX(s1.HR_CLSF_NM) AS HR_CLSF_NM
              ,s1.PYMNT_DDC_CODE_NM
              ,SUM(s1.AMOUNT) AS AMOUNT
        FROM   MT_SALARY_PYMNT_T s1
        WHERE  s1.JSSFC_SE IN ('01', '02', '03', '04', '08')
        GROUP BY s1.SALARY_DEPT_CODE, s1.SALARY_DEPT_NM, s1.JSSFC_SE, s1.HR_CLSF_SE, s1.EMPNM, s1.PYMNT_DDC_CODE_NM
        UNION ALL
        SELECT 2
              ,s1.SALARY_DEPT_CODE
              ,s1.SALARY_DEPT_NM ||' '||'(시설관리원)'
              ,s1.JSSFC_SE
              ,s1.HR_CLSF_SE
              ,s1.EMPNM
              ,MAX(s1.SRCLS) AS SRCLS
              ,MAX(s1.IHIDNUM) AS IHIDNUM
              ,MAX(s1.HR_CLSF_NM) AS HR_CLSF_NM
              ,s1.PYMNT_DDC_CODE_NM
              ,SUM(s1.AMOUNT)
        FROM   MT_SALARY_PYMNT_T s1
        WHERE  s1.JSSFC_SE = '05'
		AND  NVL(s1.SALARY_SE,'002') = '002'
        GROUP BY s1.SALARY_DEPT_CODE, s1.SALARY_DEPT_NM, s1.JSSFC_SE, s1.HR_CLSF_SE, s1.EMPNM, s1.PYMNT_DDC_CODE_NM
        UNION ALL
        SELECT 3
              ,s1.SALARY_DEPT_CODE
              ,s1.SALARY_DEPT_NM ||' '||'(강사 및 상용직)'
              ,s1.JSSFC_SE
              ,s1.HR_CLSF_SE
              ,s1.EMPNM
              ,MAX(s1.SRCLS) AS SRCLS
              ,MAX(s1.IHIDNUM) AS IHIDNUM
              ,MAX(s1.HR_CLSF_NM) AS HR_CLSF_NM
              ,s1.PYMNT_DDC_CODE_NM
              ,SUM(s1.AMOUNT)
        FROM   MT_SALARY_PYMNT_T s1
        WHERE  (s1.JSSFC_SE IN ('06', '09') OR (s1.JSSFC_SE = '05' AND NVL(s1.SALARY_SE,'002') <> '002'))
        GROUP BY s1.SALARY_DEPT_CODE, s1.SALARY_DEPT_NM, s1.JSSFC_SE, s1.HR_CLSF_SE, s1.EMPNM, s1.PYMNT_DDC_CODE_NM
    )
    SELECT *
    FROM SAL_TOTAL_T
    PIVOT (
      SUM(AMOUNT)
      FOR PYMNT_DDC_CODE_NM
      IN (
'기본급' AS PYMNT0NM1
,'정액급식비' AS PYMNT0NM2
,'가족수당' AS PYMNT0NM3
,'자녀학비보조수당' AS PYMNT0NM4
,'위험근무수당' AS PYMNT0NM5
,'기술수당' AS PYMNT0NM6
,'운전수당' AS PYMNT0NM7
,'특정업무수당' AS PYMNT0NM8
,'시간외근무수당' AS PYMNT0NM9
,'휴일근무수당' AS PYMNT0NM10
,'야간근무수당' AS PYMNT0NM11
,'직책급업무' AS PYMNT0NM12
,'상여수당' AS PYMNT0NM13
,'장려수당' AS PYMNT0NM14
,'교통보조비' AS PYMNT0NM15
,'위생수당' AS PYMNT0NM16
,'관리업무수당' AS PYMNT0NM17
,'' AS PYMNT0NM18
,'' AS PYMNT0NM19
,'' AS PYMNT0NM20
,'' AS PYMNT0NM21
,'' AS PYMNT0NM22
,'' AS PYMNT0NM23
,'' AS PYMNT0NM24
,'' AS PYMNT0NM25
,'' AS PYMNT0NM26
,'' AS PYMNT0NM27
,'소득세' AS PYMNT1NM1
,'주민세' AS PYMNT1NM2
,'건강보험' AS PYMNT1NM3
,'국민연금' AS PYMNT1NM4
,'고용보험' AS PYMNT1NM5
,'상조회비' AS PYMNT1NM6
,'노조비' AS PYMNT1NM7
,'길맛' AS PYMNT1NM8
,'산악회' AS PYMNT1NM9
,'토요미식회' AS PYMNT1NM10
,'우수리모금' AS PYMNT1NM11
,'레포츠 동호회' AS PYMNT1NM12
,'' AS PYMNT1NM13
,'' AS PYMNT1NM14
,'' AS PYMNT1NM15
        )
    )
)
[CLIP report Server - Report Key 65a2937646f34f1cb1cdf9b6d1f844b4 Thread 52. | INFO 2020-10-15 10:21:28] : [SQLDS1] executeQuery : TimeMillis : 358ms, HH:MM:SS : 00:00:00
[CLIP report Server - Report Key 65a2937646f34f1cb1cdf9b6d1f844b4 Thread 52. | INFO CODE=501 | 2020-10-15 10:21:28] : [SQLDS1] Database data load rows : 193
[CLIP report Server - Report Key 65a2937646f34f1cb1cdf9b6d1f844b4 Thread 52. | INFO CODE=11 | 2020-10-15 10:21:31] : 리포트 생성이 끝났습니다.
[CLIP report Server - Report Key 65a2937646f34f1cb1cdf9b6d1f844b4 Thread 52. | INFO 2020-10-15 10:21:31] : Report Build Time : TimeMillis : 5001ms, HH:MM:SS : 00:00:05
[CLIP report Server - Report Key 65a2937646f34f1cb1cdf9b6d1f844b4 Thread 52. | INFO 2020-10-15 10:21:31] : Total Page Count saved!
[CLIP report Server - Report Key 65a2937646f34f1cb1cdf9b6d1f844b4 Thread 52. | INFO 2020-10-15 10:21:31] : Last Document saved!
[CLIP report Server - Report Key 65a2937646f34f1cb1cdf9b6d1f844b4 Thread 52. | INFO 2020-10-15 10:21:31] : Database Connection Close Start
[CLIP report Server - Report Key 65a2937646f34f1cb1cdf9b6d1f844b4 Thread 52. | INFO 2020-10-15 10:21:31] : Database Connection Close End - TimeMillis : 353ms, HH:MM:SS : 00:00:00
[CLIP report Server - Report Key 01950c8857cb411f8659539811ccd8f6 Thread 52. | INFO 2020-10-15 11:01:41] : Report Read Time : TimeMillis : 385ms, HH:MM:SS : 00:00:00
[CLIP report Server - Report Key 01950c8857cb411f8659539811ccd8f6 Thread 52. | INFO CODE=10 | 2020-10-15 11:01:41] : 리포트 생성을 시작합니다.
[CLIP report Server - Report Key 01950c8857cb411f8659539811ccd8f6 Thread 52. | DEBUG CODE=10100 | 2020-10-15 11:01:41] : [SQL_TITLE] Data Query : SELECT MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '1',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_1
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '2',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_2
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '3',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_3
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '4',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_4
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '5',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_5
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '6',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_6
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '7',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_7
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '8',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_8
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '9',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_9
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '10', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_10
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '11', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_11
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '12', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_12
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '13', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_13
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '14', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_14
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '15', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_15
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '16', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_16
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '17', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_17
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '18', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_18
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '19', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_19
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '20', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_20
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '21', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_21
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '22', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_22
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '23', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_23
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '24', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_24
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '25', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_25
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '26', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_26
      ,MAX(DECODE(PYMNT_DDC_SE, '0', DECODE(RNK, '27', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_0_NM_27
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '1',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_01
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '2',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_02
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '3',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_03
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '4',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_04
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '5',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_05
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '6',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_06
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '7',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_07
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '8',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_08
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '9',  PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_09
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '10', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_10
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '11', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_11
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '12', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_12
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '13', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_13
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '14', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_14
      ,MAX(DECODE(PYMNT_DDC_SE, '1', DECODE(RNK, '15', PYMNT_DDC_CODE_NM, NULL), NULL))   AS PYMNT_1_NM_15
FROM   (
        SELECT RANK() OVER (PARTITION BY PYMNT_DDC_SE ORDER BY PYMNT_DDC_CODE) AS RNK
              ,s1.*
        FROM   (
                SELECT t1.PYMNT_DDC_SE
                      ,t1.PYMNT_DDC_CODE
                      ,t1.PYMNT_DDC_CODE_NM
                FROM   TBSAL_PYMNT_DDC_STDR_CODE t1
                WHERE  1=1
                AND    EXISTS (
                    SELECT 1
                    FROM   TBSAL_MT_SALARY_IEM t2
                    WHERE  t1.PYMNT_DDC_CODE = t2.PYMNT_DDC_CODE
                    AND    t2.PYMNT_YM = '202010'
                    AND    t2.SN       = '1'
                )
                AND    EXISTS (
                    SELECT 1
                    FROM   TBSAL_MT_SALARY_DTLS t3
                    WHERE  t1.PYMNT_DDC_CODE = t3.PYMNT_DDC_CODE
                    AND    t3.PYMNT_YM = '202010'
                    AND    t3.SN       = '1'
                )
                ORDER BY t1.OUTPT_ORDR
               ) s1
        WHERE  1=1
       )
WHERE  1=1
[CLIP report Server - Report Key 01950c8857cb411f8659539811ccd8f6 Thread 52. | DEBUG 2020-10-15 11:01:42] : [SQL_TITLE] Database Info - Product Name : Oracle, Product Version : Oracle Database 11g Release 11.2.0.4.0 - 64bit Production
With the Real Application Clusters option, Driver Name : Oracle JDBC driver, Driver Version : 12.1.0.2.0
[CLIP report Server - Report Key 01950c8857cb411f8659539811ccd8f6 Thread 52. | INFO 2020-10-15 11:01:42] : [SQL_TITLE] Connection Time : TimeMillis : 177ms, HH:MM:SS : 00:00:00
[CLIP report Server - Report Key 01950c8857cb411f8659539811ccd8f6 Thread 52. | INFO 2020-10-15 11:01:42] : [SQL_TITLE] executeQuery : TimeMillis : 23ms, HH:MM:SS : 00:00:00
[CLIP report Server - Report Key 01950c8857cb411f8659539811ccd8f6 Thread 52. | INFO CODE=501 | 2020-10-15 11:01:42] : [SQL_TITLE] Database data load rows : 1
[CLIP report Server - Report Key 01950c8857cb411f8659539811ccd8f6 Thread 52. | DEBUG CODE=10100 | 2020-10-15 11:01:42] : [SQLDS1] Data Query : WITH MT_SALARY_PYMNT_T AS (
    SELECT t1.PYMNT_YM
          ,t1.SALARY_DEPT_CODE
          ,t4.SALARY_DEPT_NM
          ,t1.EMPNO
          ,t5.EMPNM
          ,REGEXP_REPLACE(H_DECRYPT(t5.IHIDNUM_ENCPT), '([0-9]{6})([0-9]{1})([0-9]{6})', '\1-\2******')   AS IHIDNUM
          ,t5.SRCLS
          ,t5.HR_CLSF_SE
          ,t6.CODE_NM           AS HR_CLSF_NM
          ,t1.EMPL_SE           AS JSSFC_SE
          ,t3.PYMNT_DDC_CODE
          ,t3.PYMNT_DDC_CODE_NM
          ,t2.AMOUNT
		  ,t1.SALARY_SE
		  ,t1.PD_BUDGET_AT
    FROM TBSAL_MT_SALARY_PYMNT t1
         INNER JOIN TBSAL_MT_SALARY_DTLS t2
           ON  t1.PYMNT_YM = t2.PYMNT_YM
           AND t1.SN = t2.SN
           AND t1.EMPNO = t2.EMPNO
         INNER JOIN TBSAL_PYMNT_DDC_STDR_CODE t3
           ON  t2.PYMNT_DDC_CODE = t3.PYMNT_DDC_CODE
         INNER JOIN TBSAL_SALARY_DEPT t4
           ON  t1.SALARY_DEPT_CODE = t4.SALARY_DEPT_CODE
         LEFT OUTER JOIN TBHRM_HR_MASTR t5
           ON  t1.EMPNO = t5.EMPNO
         LEFT OUTER JOIN TBCOM_CMMN_CODE t6
           ON  t5.HR_CLSF_SE = t6.CODE
           AND t6.GRP_CODE = 'HRM002'
    WHERE t1.PYMNT_YM         = '202010'
      AND t1.SN               = '1'
      AND t3.PYMNT_DDC_SE IN ('0', '1')          /*0:지급,1:공제*/
      AND t4.BSNS_TY          = 'A'
	  AND t1.SALARY_DEPT_CODE LIKE '%' || NVL('','%') || '%'
      AND t4.SALARY_DEPT_NM LIKE'%' ||  NVL('','%') || '%'
), SAL_TOTAL_T AS (
    SELECT 1 AS RNUM
          ,s1.SALARY_DEPT_CODE
          ,s1.SALARY_DEPT_NM
          ,s1.JSSFC_SE
          ,s1.HR_CLSF_SE
          ,s1.EMPNM
          ,MAX(s1.SRCLS) AS SRCLS
          ,MAX(s1.IHIDNUM) AS IHIDNUM
          ,MAX(s1.HR_CLSF_NM) AS HR_CLSF_NM
          ,s1.PYMNT_DDC_CODE_NM
          ,SUM(s1.AMOUNT) AS AMOUNT
    FROM   MT_SALARY_PYMNT_T s1
    WHERE  s1.JSSFC_SE IN ('01', '02', '03', '04', '08')
    GROUP BY s1.SALARY_DEPT_CODE, s1.SALARY_DEPT_NM, s1.JSSFC_SE, s1.HR_CLSF_SE, s1.EMPNM, s1.PYMNT_DDC_CODE_NM
    UNION ALL
    SELECT 2
          ,s1.SALARY_DEPT_CODE
          ,s1.SALARY_DEPT_NM ||' '||'(업무직)'
          ,s1.JSSFC_SE
          ,s1.HR_CLSF_SE
          ,s1.EMPNM
          ,MAX(s1.SRCLS) AS SRCLS
          ,MAX(s1.IHIDNUM) AS IHIDNUM
          ,MAX(s1.HR_CLSF_NM) AS HR_CLSF_NM
          ,s1.PYMNT_DDC_CODE_NM
          ,SUM(s1.AMOUNT)
    FROM   MT_SALARY_PYMNT_T s1
    WHERE  s1.JSSFC_SE = '05'
	AND      NVL(s1.PD_BUDGET_AT,'0') = '0'
    GROUP BY s1.SALARY_DEPT_CODE, s1.SALARY_DEPT_NM, s1.JSSFC_SE, s1.HR_CLSF_SE, s1.EMPNM, s1.PYMNT_DDC_CODE_NM
    UNION ALL
    SELECT 3
          ,s1.SALARY_DEPT_CODE
          ,s1.SALARY_DEPT_NM ||' '||'(강사 및 상용직)'
          ,s1.JSSFC_SE
          ,s1.HR_CLSF_SE
          ,s1.EMPNM
          ,MAX(s1.SRCLS) AS SRCLS
          ,MAX(s1.IHIDNUM) AS IHIDNUM
          ,MAX(s1.HR_CLSF_NM) AS HR_CLSF_NM
          ,s1.PYMNT_DDC_CODE_NM
          ,SUM(s1.AMOUNT)
    FROM   MT_SALARY_PYMNT_T s1
    WHERE  (s1.JSSFC_SE IN ('09', '06') OR (s1.JSSFC_SE = '05' AND NVL(s1.PD_BUDGET_AT,'0') = '1'))
    GROUP BY s1.SALARY_DEPT_CODE, s1.SALARY_DEPT_NM, s1.JSSFC_SE, s1.HR_CLSF_SE, s1.EMPNM, s1.PYMNT_DDC_CODE_NM
	UNION ALL
	SELECT 4
          ,s1.SALARY_DEPT_CODE
          ,s1.SALARY_DEPT_NM ||' '||'(운수직)'
          ,s1.JSSFC_SE
          ,s1.HR_CLSF_SE
          ,s1.EMPNM
          ,MAX(s1.SRCLS) AS SRCLS
          ,MAX(s1.IHIDNUM) AS IHIDNUM
          ,MAX(s1.HR_CLSF_NM) AS HR_CLSF_NM
          ,s1.PYMNT_DDC_CODE_NM
          ,SUM(s1.AMOUNT) AS AMOUNT
    FROM   MT_SALARY_PYMNT_T s1
    WHERE  s1.JSSFC_SE IN ('103')
    GROUP BY s1.SALARY_DEPT_CODE, s1.SALARY_DEPT_NM, s1.JSSFC_SE, s1.HR_CLSF_SE, s1.EMPNM, s1.PYMNT_DDC_CODE_NM
)
SELECT *
FROM SAL_TOTAL_T
PIVOT (
  SUM(AMOUNT)
  FOR PYMNT_DDC_CODE_NM
  IN (
'기본급' AS PYMNT0NM1
,'정액급식비' AS PYMNT0NM2
,'가족수당' AS PYMNT0NM3
,'자녀학비보조수당' AS PYMNT0NM4
,'위험근무수당' AS PYMNT0NM5
,'기술수당' AS PYMNT0NM6
,'운전수당' AS PYMNT0NM7
,'특정업무수당' AS PYMNT0NM8
,'시간외근무수당' AS PYMNT0NM9
,'휴일근무수당' AS PYMNT0NM10
,'야간근무수당' AS PYMNT0NM11
,'직책급업무' AS PYMNT0NM12
,'상여수당' AS PYMNT0NM13
,'장려수당' AS PYMNT0NM14
,'교통보조비' AS PYMNT0NM15
,'위생수당' AS PYMNT0NM16
,'관리업무수당' AS PYMNT0NM17
,'' AS PYMNT0NM18
,'' AS PYMNT0NM19
,'' AS PYMNT0NM20
,'' AS PYMNT0NM21
,'' AS PYMNT0NM22
,'' AS PYMNT0NM23
,'' AS PYMNT0NM24
,'' AS PYMNT0NM25
,'' AS PYMNT0NM26
,'' AS PYMNT0NM27
,'소득세' AS PYMNT1NM1
,'주민세' AS PYMNT1NM2
,'건강보험' AS PYMNT1NM3
,'국민연금' AS PYMNT1NM4
,'고용보험' AS PYMNT1NM5
,'상조회비' AS PYMNT1NM6
,'노조비' AS PYMNT1NM7
,'길맛' AS PYMNT1NM8
,'산악회' AS PYMNT1NM9
,'토요미식회' AS PYMNT1NM10
,'우수리모금' AS PYMNT1NM11
,'레포츠 동호회' AS PYMNT1NM12
,'' AS PYMNT1NM13
,'' AS PYMNT1NM14
,'' AS PYMNT1NM15
    )
)
UNION ALL
SELECT *
FROM (
    /** 급여 공제내역(자체사업비) **/
    WITH MT_SALARY_PYMNT_T AS (
        SELECT t1.PYMNT_YM
              ,t1.SALARY_DEPT_CODE
              ,t4.SALARY_DEPT_NM
              ,t1.EMPNO
              ,t5.EMPNM
              ,REGEXP_REPLACE(H_DECRYPT(t5.IHIDNUM_ENCPT), '([0-9]{6})([0-9]{1})([0-9]{6})', '\1-\2******')   AS IHIDNUM
              ,t5.SRCLS
              ,t5.HR_CLSF_SE
              ,t6.CODE_NM           AS HR_CLSF_NM
              ,t1.EMPL_SE           AS JSSFC_SE
              ,t3.PYMNT_DDC_CODE
              ,t3.PYMNT_DDC_CODE_NM
              ,t2.AMOUNT
			  ,t1.SALARY_SE
        FROM TBSAL_MT_SALARY_PYMNT t1
             INNER JOIN TBSAL_MT_SALARY_DTLS t2
               ON  t1.PYMNT_YM = t2.PYMNT_YM
               AND t1.SN = t2.SN
               AND t1.EMPNO = t2.EMPNO
             INNER JOIN TBSAL_PYMNT_DDC_STDR_CODE t3
               ON  t2.PYMNT_DDC_CODE = t3.PYMNT_DDC_CODE
             INNER JOIN TBSAL_SALARY_DEPT t4
               ON  t1.SALARY_DEPT_CODE = t4.SALARY_DEPT_CODE
             LEFT OUTER JOIN TBHRM_HR_MASTR t5
               ON  t1.EMPNO = t5.EMPNO
             LEFT OUTER JOIN TBCOM_CMMN_CODE t6
               ON  t5.HR_CLSF_SE = t6.CODE
               AND t6.GRP_CODE = 'HRM002'
        WHERE t1.PYMNT_YM         = '202010'
          AND t1.SN               = '1'
          AND t3.PYMNT_DDC_SE IN ('0', '1')          /*0:지급,1:공제*/
          AND (t4.BSNS_TY IS NULL OR t4.BSNS_TY <> 'A')
	      AND t1.SALARY_DEPT_CODE LIKE '%' || NVL('','%') || '%'
          AND t4.SALARY_DEPT_NM LIKE'%' ||  NVL('','%') || '%'
    ), SAL_TOTAL_T AS (
        SELECT 1   AS RNUM
              ,s1.SALARY_DEPT_CODE
              ,s1.SALARY_DEPT_NM
              ,s1.JSSFC_SE
              ,s1.HR_CLSF_SE
              ,s1.EMPNM
              ,MAX(s1.SRCLS) AS SRCLS
              ,MAX(s1.IHIDNUM) AS IHIDNUM
              ,MAX(s1.HR_CLSF_NM) AS HR_CLSF_NM
              ,s1.PYMNT_DDC_CODE_NM
              ,SUM(s1.AMOUNT) AS AMOUNT
        FROM   MT_SALARY_PYMNT_T s1
        WHERE  s1.JSSFC_SE IN ('01', '02', '03', '04', '08')
        GROUP BY s1.SALARY_DEPT_CODE, s1.SALARY_DEPT_NM, s1.JSSFC_SE, s1.HR_CLSF_SE, s1.EMPNM, s1.PYMNT_DDC_CODE_NM
        UNION ALL
        SELECT 2
              ,s1.SALARY_DEPT_CODE
              ,s1.SALARY_DEPT_NM ||' '||'(업무직)'
              ,s1.JSSFC_SE
              ,s1.HR_CLSF_SE
              ,s1.EMPNM
              ,MAX(s1.SRCLS) AS SRCLS
              ,MAX(s1.IHIDNUM) AS IHIDNUM
              ,MAX(s1.HR_CLSF_NM) AS HR_CLSF_NM
              ,s1.PYMNT_DDC_CODE_NM
              ,SUM(s1.AMOUNT)
        FROM   MT_SALARY_PYMNT_T s1
        WHERE  s1.JSSFC_SE = '05'
		AND  NVL(s1.SALARY_SE,'002') = '002'
        GROUP BY s1.SALARY_DEPT_CODE, s1.SALARY_DEPT_NM, s1.JSSFC_SE, s1.HR_CLSF_SE, s1.EMPNM, s1.PYMNT_DDC_CODE_NM
        UNION ALL
        SELECT 3
              ,s1.SALARY_DEPT_CODE
              ,s1.SALARY_DEPT_NM ||' '||'(강사 및 상용직)'
              ,s1.JSSFC_SE
              ,s1.HR_CLSF_SE
              ,s1.EMPNM
              ,MAX(s1.SRCLS) AS SRCLS
              ,MAX(s1.IHIDNUM) AS IHIDNUM
              ,MAX(s1.HR_CLSF_NM) AS HR_CLSF_NM
              ,s1.PYMNT_DDC_CODE_NM
              ,SUM(s1.AMOUNT)
        FROM   MT_SALARY_PYMNT_T s1
        WHERE  (s1.JSSFC_SE IN ('06', '09') OR (s1.JSSFC_SE = '05' AND NVL(s1.SALARY_SE,'002') <> '002'))
        GROUP BY s1.SALARY_DEPT_CODE, s1.SALARY_DEPT_NM, s1.JSSFC_SE, s1.HR_CLSF_SE, s1.EMPNM, s1.PYMNT_DDC_CODE_NM
		UNION ALL
		SELECT 4
              ,s1.SALARY_DEPT_CODE
              ,s1.SALARY_DEPT_NM ||' '||'(운수직)'
              ,s1.JSSFC_SE
              ,s1.HR_CLSF_SE
              ,s1.EMPNM
              ,MAX(s1.SRCLS) AS SRCLS
              ,MAX(s1.IHIDNUM) AS IHIDNUM
              ,MAX(s1.HR_CLSF_NM) AS HR_CLSF_NM
              ,s1.PYMNT_DDC_CODE_NM
              ,SUM(s1.AMOUNT) AS AMOUNT
        FROM   MT_SALARY_PYMNT_T s1
        WHERE  s1.JSSFC_SE IN ('103')
        GROUP BY s1.SALARY_DEPT_CODE, s1.SALARY_DEPT_NM, s1.JSSFC_SE, s1.HR_CLSF_SE, s1.EMPNM, s1.PYMNT_DDC_CODE_NM
    )
    SELECT *
    FROM SAL_TOTAL_T
    PIVOT (
      SUM(AMOUNT)
      FOR PYMNT_DDC_CODE_NM
      IN (
'기본급' AS PYMNT0NM1
,'정액급식비' AS PYMNT0NM2
,'가족수당' AS PYMNT0NM3
,'자녀학비보조수당' AS PYMNT0NM4
,'위험근무수당' AS PYMNT0NM5
,'기술수당' AS PYMNT0NM6
,'운전수당' AS PYMNT0NM7
,'특정업무수당' AS PYMNT0NM8
,'시간외근무수당' AS PYMNT0NM9
,'휴일근무수당' AS PYMNT0NM10
,'야간근무수당' AS PYMNT0NM11
,'직책급업무' AS PYMNT0NM12
,'상여수당' AS PYMNT0NM13
,'장려수당' AS PYMNT0NM14
,'교통보조비' AS PYMNT0NM15
,'위생수당' AS PYMNT0NM16
,'관리업무수당' AS PYMNT0NM17
,'' AS PYMNT0NM18
,'' AS PYMNT0NM19
,'' AS PYMNT0NM20
,'' AS PYMNT0NM21
,'' AS PYMNT0NM22
,'' AS PYMNT0NM23
,'' AS PYMNT0NM24
,'' AS PYMNT0NM25
,'' AS PYMNT0NM26
,'' AS PYMNT0NM27
,'소득세' AS PYMNT1NM1
,'주민세' AS PYMNT1NM2
,'건강보험' AS PYMNT1NM3
,'국민연금' AS PYMNT1NM4
,'고용보험' AS PYMNT1NM5
,'상조회비' AS PYMNT1NM6
,'노조비' AS PYMNT1NM7
,'길맛' AS PYMNT1NM8
,'산악회' AS PYMNT1NM9
,'토요미식회' AS PYMNT1NM10
,'우수리모금' AS PYMNT1NM11
,'레포츠 동호회' AS PYMNT1NM12
,'' AS PYMNT1NM13
,'' AS PYMNT1NM14
,'' AS PYMNT1NM15
        )
    )
)
[CLIP report Server - Report Key 01950c8857cb411f8659539811ccd8f6 Thread 52. | INFO 2020-10-15 11:01:42] : [SQLDS1] executeQuery : TimeMillis : 325ms, HH:MM:SS : 00:00:00
[CLIP report Server - Report Key 01950c8857cb411f8659539811ccd8f6 Thread 52. | INFO CODE=501 | 2020-10-15 11:01:43] : [SQLDS1] Database data load rows : 198
[CLIP report Server - Report Key 01950c8857cb411f8659539811ccd8f6 Thread 52. | INFO CODE=11 | 2020-10-15 11:01:45] : 리포트 생성이 끝났습니다.
[CLIP report Server - Report Key 01950c8857cb411f8659539811ccd8f6 Thread 52. | INFO 2020-10-15 11:01:45] : Report Build Time : TimeMillis : 4176ms, HH:MM:SS : 00:00:04
[CLIP report Server - Report Key 01950c8857cb411f8659539811ccd8f6 Thread 52. | INFO 2020-10-15 11:01:45] : Total Page Count saved!
[CLIP report Server - Report Key 01950c8857cb411f8659539811ccd8f6 Thread 52. | INFO 2020-10-15 11:01:45] : Last Document saved!
[CLIP report Server - Report Key 01950c8857cb411f8659539811ccd8f6 Thread 52. | INFO 2020-10-15 11:01:46] : Database Connection Close Start
[CLIP report Server - Report Key 01950c8857cb411f8659539811ccd8f6 Thread 52. | INFO 2020-10-15 11:01:46] : Database Connection Close End - TimeMillis : 78ms, HH:MM:SS : 00:00:00
