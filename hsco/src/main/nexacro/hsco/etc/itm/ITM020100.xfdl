<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\default_typedef.xml"/>
  <Form id="ITM020100" classname="codeMng" left="0" top="0" width="1059" height="735" titletext="HW대장관리" onload="ITM020100_onload" oninit="ITM020100_oninit">
    <Layouts>
      <Layout>
        <Static id="Static18" taborder="59" cssclass="sta_WF_Labelbg" left="99" bottom="439" height="27" width="404"/>
        <Static id="Static51" taborder="48" cssclass="sta_WF_Labelbg" left="99" bottom="465" height="27" width="404"/>
        <Static id="Static01" taborder="33" text="스&#13;&#10;크&#13;&#10;롤&#13;&#10;13" visible="false" left="98.77%" top="0" right="0%" height="735" style="background:#d07b173c;align:center middle;"/>
        <Static id="Static00" taborder="34" text="15" visible="false" left="97.36%" top="0" right="1.23%" height="735" style="background:#1b3cd23c;align:center middle;"/>
        <Div id="div_search" taborder="0" left="0%" top="0" cssclass="div_WFSA_Box" scrollbars="none" right="2.64%" height="59">
          <Layouts>
            <Layout>
              <Static id="Static04" taborder="56" text="업무구분" cssclass="sta_WFSA_Label" left="15" top="5" height="21" style="background:URL('theme://images/sta_WFSA_Label.png') left middle;" width="64"/>
              <Static id="Static19" taborder="58" text="장비구분" cssclass="sta_WFSA_Label" left="270" top="5" height="21" style="background:URL('theme://images/sta_WFSA_Label.png') left middle;" width="64"/>
              <Static id="Static05" taborder="69" text="사용여부" cssclass="sta_WFSA_Label" left="529" top="5" height="21" style="background:URL('theme://images/sta_WFSA_Label.png') left middle;" width="64"/>
              <Edit id="edt_modelNm" taborder="3" left="100" top="31" height="21" cssclass="edt_WF_Essential" width="150" onkeyup="div_search_edt_modelNm_onkeyup"/>
              <Static id="Static00" taborder="77" text="모델명" cssclass="sta_WFSA_Label" left="15" top="31" height="21" width="90"/>
              <Static id="Static01" taborder="78" text="Serial NO" cssclass="sta_WFSA_Label" left="270" top="31" height="21" width="90"/>
              <Edit id="edt_serialNo" taborder="4" left="360" top="31" height="21" cssclass="edt_WF_Essential" width="150" onkeydown="div_search_edt_serialNo_onkeydown" onkeyup="div_search_edt_serialNo_onkeyup"/>
              <Radio id="rdo_useAt" taborder="2" index="1" codecolumn="codecolumn" datacolumn="datacolumn" value="1" direction="vertical" onitemclick="Radio00_onitemclick" left="602" top="5" height="21" width="170">
                <Dataset id="innerdataset">
                  <ColumnInfo>
                    <Column id="codecolumn" size="256"/>
                    <Column id="datacolumn" size="256"/>
                  </ColumnInfo>
                  <Rows>
                    <Row>
                      <Col id="codecolumn"/>
                      <Col id="datacolumn">전체</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">1</Col>
                      <Col id="datacolumn">사용</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">2</Col>
                      <Col id="datacolumn">미사용</Col>
                    </Row>
                  </Rows>
                </Dataset>
              </Radio>
              <Combo id="cmb_ItCl" taborder="0" innerdataset="@ds_work" codecolumn="CODE" datacolumn="CODE_NM" onitemchanged="div_search_cmb_ItCl_onitemchanged" cssclass="cmb_WF_Essential" left="100" top="5" height="21" width="150"/>
              <Combo id="cmb_ItDetailCode" taborder="1" innerdataset="@ds_workdetail" codecolumn="CODE" datacolumn="CODE_NM" cssclass="cmb_WF_Essential" left="360" top="5" height="21" width="150"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static03" taborder="35" text="10" visible="false" left="0%" top="58" right="2.64%" height="10" style="background:#dc143c3c;align:center middle;"/>
        <Static id="Static34" taborder="36" text="장비대장목록" cssclass="sta_WF_Title02" left="0" top="68" height="21" width="131"/>
        <Static id="Static41" taborder="37" text="5" visible="false" left="0%" top="87" height="5" style="background:#dc143c3c;align:center middle;" width="1028"/>
        <Grid id="grd_hw" taborder="38" useinputpanel="false" left="0%" top="92" autofittype="none" binddataset="ds_grid" autoenter="select" onselectchanged="grd_hw_onselectchanged" cellsizingtype="col" onheadclick="grd_hw_onheadclick" bottom="525" right="2.64%">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="113"/>
                <Column size="105"/>
                <Column size="114"/>
                <Column size="163"/>
                <Column size="139"/>
                <Column size="144"/>
                <Column size="82"/>
                <Column size="81"/>
                <Column size="98"/>
                <Column size="102"/>
              </Columns>
              <Rows>
                <Row size="25" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell style="font:9 돋움;" text="업무구분"/>
                <Cell col="1" style="font:9 돋움;" text="장비구분"/>
                <Cell col="2" style="font:9 돋움;" text="모델코드"/>
                <Cell col="3" style="font:9 돋움;" text="모델명"/>
                <Cell col="4" style="font:9 돋움;" text="제조사"/>
                <Cell col="5" style="font:9 돋움;" text="CPU"/>
                <Cell col="6" style="font:9 돋움;" text="OS"/>
                <Cell col="7" style="font:9 돋움;" text="메모리"/>
                <Cell col="8" style="font:9 돋움;" text="HDD"/>
                <Cell col="9" style="font:9 돋움;" text="모델이미지"/>
              </Band>
              <Band id="body">
                <Cell style="align:left;" text="bind:IT_CODE_NM2"/>
                <Cell col="1" style="align:left;" text="bind:IT_DETAIL_CODE_NM2"/>
                <Cell col="2" text="bind:MODEL_NO"/>
                <Cell col="3" style="align:left;" text="bind:MODEL_NM"/>
                <Cell col="4" text="bind:HW_MAKR"/>
                <Cell col="5" style="align:left;" text="bind:CPU"/>
                <Cell col="6" displaytype="combo" style="align:left;" text="bind:OPERSYSM" combodataset="ds_os" combocodecol="CODE" combodatacol="CODE_NM"/>
                <Cell col="7" style="align:left;" text="bind:MORY"/>
                <Cell col="8" style="align:left;" text="bind:HDDISK"/>
                <Cell col="9" style="align:left;" text="bind:MODEL_IMAGE"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static02" taborder="39" text="10" visible="false" left="0%" top="210" height="10" style="background:#dc143c3c;align:center middle;" right="2.64%"/>
        <Static id="Static84" taborder="41" text="업무/장비구분" cssclass="sta_WF_Label" left="0%" height="27" width="100" bottom="465"/>
        <Static id="Static83" taborder="42" text="모델코드" cssclass="sta_WF_Label" left="0%" height="27" width="100" bottom="439"/>
        <Static id="Static85" taborder="43" text="모델명" cssclass="sta_WF_Label" left="0%" height="27" width="101" bottom="413"/>
        <Static id="Static16" taborder="44" text="HW유형" cssclass="sta_WF_Label" left="0%" height="27" width="101" bottom="387"/>
        <Static id="Static14" taborder="45" text="HW유형기타" cssclass="sta_WF_Label" left="0%" height="27" width="101" bottom="361"/>
        <Static id="Static12" taborder="46" text="운영구분" cssclass="sta_WF_Label" left="0%" height="27" width="101" bottom="335"/>
        <Static id="Static10" taborder="47" text="상위하드웨어" cssclass="sta_WF_Label" left="0%" height="27" width="101" bottom="309"/>
        <Static id="Static04" taborder="49" text="CPU" cssclass="sta_WF_Label" left="0%" height="27" width="101" bottom="179"/>
        <Static id="Static05" taborder="50" text="국산여부" cssclass="sta_WF_Label" left="0%" height="27" width="101" bottom="205"/>
        <Static id="Static06" taborder="51" text="밴더기타" cssclass="sta_WF_Label" left="0%" height="27" width="101" bottom="231"/>
        <Static id="Static07" taborder="52" text="밴더" cssclass="sta_WF_Label" left="0%" height="27" width="101" bottom="257"/>
        <Static id="Static08" taborder="53" text="하드웨어상세" cssclass="sta_WF_Label" left="0%" height="27" width="101" bottom="283"/>
        <Static id="Static09" taborder="54" text="세부사항&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;" cssclass="sta_WF_Label" left="0%" height="74" style="padding:8 8 0 8;align:left middle;" width="101" bottom="2"/>
        <Static id="Static11" taborder="55" text="모델이미지" cssclass="sta_WF_Label" left="0%" height="27" width="101" bottom="75"/>
        <Static id="Static13" taborder="56" text="OS" cssclass="sta_WF_Label" left="0%" height="27" width="101" bottom="101"/>
        <Static id="Static15" taborder="57" text="메모리" cssclass="sta_WF_Label" left="0%" height="27" width="101" bottom="127"/>
        <Static id="Static17" taborder="58" text="HDD" cssclass="sta_WF_Label" left="0%" height="27" width="101" bottom="153"/>
        <Edit id="edt_modelNo" taborder="5" left="104" height="21" width="146" bottom="442" maxlength="30" enable="false"/>
        <Static id="Static19" taborder="60" text="10" visible="false" left="47.59%" top="225" height="508" style="background:#1b3cd23c;align:center middle;" right="51.46%"/>
        <Static id="Static20" taborder="61" text="장비정보" cssclass="sta_WF_Title02" left="0" height="21" width="75" bottom="493"/>
        <Static id="Static21" taborder="62" text="장비목록" cssclass="sta_WF_Title02" left="514" width="98" height="21" bottom="493"/>
        <Static id="Static27" taborder="63" text="5" visible="false" left="48.54%" top="239" height="5" style="background:#dc143c3c;align:center middle;" width="516"/>
        <Static id="Static22" taborder="64" text="5" visible="false" left="0%" top="238" height="5" style="background:#dc143c3c;align:center middle;" right="75.26%"/>
        <Static id="Static23" taborder="65" text="사용유무" cssclass="sta_WF_Label" left="0px" top="0px" height="0px" width="0px"/>
        <Radio id="rdo_useAt" taborder="6" index="1" codecolumn="codecolumn" datacolumn="datacolumn" value="1" direction="vertical" onitemclick="Radio00_onitemclick" left="322" height="21" width="134" bottom="442">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">1</Col>
                <Col id="datacolumn">사용</Col>
              </Row>
              <Row>
                <Col id="codecolumn">2</Col>
                <Col id="datacolumn">미사용</Col>
              </Row>
            </Rows>
          </Dataset>
        </Radio>
        <Static id="Static24" taborder="66" cssclass="sta_WF_Labelbg" left="99" height="27" width="404" bottom="413"/>
        <Static id="Static25" taborder="67" cssclass="sta_WF_Labelbg" left="99" height="28" width="404" bottom="386"/>
        <Static id="Static26" taborder="68" cssclass="sta_WF_Labelbg" left="99" height="27" width="404" bottom="361"/>
        <Static id="Static28" taborder="69" cssclass="sta_WF_Labelbg" left="99" height="27" width="404" bottom="335"/>
        <Static id="Static29" taborder="70" cssclass="sta_WF_Labelbg" left="99" height="27" width="404" bottom="309"/>
        <Static id="Static30" taborder="71" cssclass="sta_WF_Labelbg" left="99" height="27" width="404" bottom="283"/>
        <Static id="Static31" taborder="72" cssclass="sta_WF_Labelbg" left="99" height="27" width="404" bottom="257"/>
        <Static id="Static32" taborder="73" cssclass="sta_WF_Labelbg" left="99" height="27" width="404" bottom="231"/>
        <Static id="Static33" taborder="74" cssclass="sta_WF_Labelbg" left="99" height="27" width="404" bottom="205"/>
        <Static id="Static35" taborder="75" cssclass="sta_WF_Labelbg" left="99" height="27" width="404" bottom="179"/>
        <Static id="Static36" taborder="76" cssclass="sta_WF_Labelbg" left="99" height="27" width="404" bottom="153"/>
        <Static id="Static37" taborder="77" cssclass="sta_WF_Labelbg" left="99" height="27" width="404" bottom="127"/>
        <Static id="Static38" taborder="78" cssclass="sta_WF_Labelbg" left="99" height="27" width="404" bottom="101"/>
        <Static id="Static39" taborder="79" cssclass="sta_WF_Labelbg" left="99" height="27" width="404" bottom="75"/>
        <Static id="Static40" taborder="80" cssclass="sta_WF_Labelbg" left="99" height="74" width="404" bottom="2"/>
        <Edit id="edt_modelNm" taborder="7" left="103" height="21" width="204" bottom="416" maxlength="50"/>
        <Static id="Static42" taborder="81" text="모델명" cssclass="sta_WF_Label" left="0px" top="0px" height="0px" width="0px"/>
        <Edit id="edt_hwMakr" taborder="8" left="372" height="21" width="128" bottom="416" maxlength="30"/>
        <Combo id="cmb_hwTy" taborder="9" codecolumn="CODE" datacolumn="CODE_NM" left="103" height="21" innerdataset="@ds_hw" width="204" index="-1" bottom="390"/>
        <CheckBox id="chk_sportListIncls" taborder="11" text="지원목록포함" value="true" left="406" height="21" width="91" falsevalue="0" truevalue="1" bottom="390"/>
        <CheckBox id="chk_dplxAt" taborder="10" text="이중화여부" left="311" height="21" tooltiptype="hover" tooltiptext="tklhytyty" width="83" falsevalue="0" truevalue="1" bottom="390"/>
        <Edit id="edt_hwEtcTy" taborder="12" left="103" height="21" width="204" bottom="364" maxlength="30"/>
        <Edit id="edt_upperHwNm" taborder="14" left="103" height="21" width="396" bottom="312" maxlength="50"/>
        <Combo id="cmb_hwOperSe" taborder="13" codecolumn="CODE" datacolumn="CODE_NM" left="103" height="21" innerdataset="@ds_hwgb" width="204" index="-1" bottom="338"/>
        <Edit id="edt_hwDetail" taborder="15" left="103" height="21" width="396" bottom="286" maxlength="50"/>
        <Edit id="edt_hwVendor" taborder="16" left="103" height="21" width="396" bottom="260" maxlength="50"/>
        <Edit id="edt_etcHwVendor" taborder="17" left="103" height="21" width="396" bottom="234"/>
        <Combo id="cmb_domstcAt" taborder="18" codecolumn="CODE" datacolumn="CODE_NM" left="103" innerdataset="@ds_madein" width="160" index="-1" height="21" bottom="208"/>
        <Combo id="cmb_assetsSttus" taborder="19" codecolumn="CODE" datacolumn="CODE_NM" left="338" innerdataset="@ds_jasan" width="161" index="-1" height="21" bottom="208"/>
        <Static id="Static43" taborder="82" text="자산상태" cssclass="sta_WF_Label" left="0px" top="0px" height="0px" width="0px"/>
        <Edit id="edt_cpu" taborder="20" left="103" height="21" width="233" bottom="182" maxlength="50"/>
        <Edit id="edt_cpuRepr" taborder="21" left="338" height="21" width="109" bottom="182" maxlength="2" inputtype="number"/>
        <TextArea id="txt_hwDetailMatter" taborder="32" value="fs 글자의 크기(fontsize)를 지정합니다.  ex)&lt;fs v='12'&gt;&lt;/fs&gt;&#13;&#10;fc 글자의 색상(fontcolor)를 지정합니다.  ex)&lt;fc v='red'&gt;&lt;/fc&gt;&lt;fc v='#FF00FF'&gt;&lt;/fc&gt;&#13;&#10;ff 글자의 종류(fontface)를 지정합니다.  ex)&lt;ff v='굴림'&gt;&lt;/ff&gt;&#13;&#10;b 굵은글씨를(bold)를 지정합니다. ex)&lt;b v='true'&gt;&lt;/b&gt;&#13;&#10;i 이텔릭체를 (italic)를 지정합니다.  ex)&lt;i v='true'&gt;&lt;/i&gt;&#13;&#10;u 언더라인을(underline)를 지정합니다.  ex)&lt;u v='true'&gt;&lt;/u&gt;&#13;&#10;s 취소선(strike)를 지정합니다.  ex)&lt;s v='true'&gt;&lt;/s&gt;" readonly="false" linespace="3" oneditclick="TextArea03_oneditclick" visible="true" left="103" style="compositecolor:#444444ff;" width="397" height="68" bottom="5" maxlength="1000"/>
        <Static id="Static44" taborder="83" text="개수" cssclass="sta_WF_Label" left="0px" top="0px" height="0px" width="0px"/>
        <Edit id="edt_hdDisk" taborder="22" left="103" height="21" width="233" bottom="156" maxlength="50"/>
        <Edit id="edt_mory" taborder="24" left="103" height="21" width="233" bottom="130" maxlength="50"/>
        <Edit id="edt_totStreCpcty" taborder="23" left="338" height="21" width="109" bottom="156" maxlength="30"/>
        <Edit id="edt_moryCpcty" taborder="25" left="338" height="21" width="109" bottom="130" maxlength="30"/>
        <Static id="Static45" taborder="84" text="용량" cssclass="sta_WF_Label" left="0px" top="0px" height="0px" width="0px"/>
        <Static id="Static46" taborder="85" text="용량" cssclass="sta_WF_Label" left="0px" top="0px" height="0px" width="0px"/>
        <Combo id="cmb_operSysm" taborder="26" codecolumn="CODE" datacolumn="CODE_NM" left="103" height="21" innerdataset="@ds_osnm" width="159" index="-1" bottom="104"/>
        <Static id="Static47" taborder="86" text="OS기타" cssclass="sta_WF_Label" left="0px" top="0px" height="0px" width="0px"/>
        <Edit id="edt_etcOpersysm" taborder="27" left="338" height="21" width="162" bottom="104" maxlength="50"/>
        <Static id="Static48" taborder="87" text="자산상태" cssclass="sta_WF_Label" left="265" height="27" width="70" bottom="205"/>
        <Static id="Static49" taborder="92" text="개수" cssclass="sta_WF_Label" left="449" height="27" width="49" bottom="179"/>
        <Static id="Static50" taborder="93" text="용량" cssclass="sta_WF_Label" left="449" height="27" width="49" bottom="153"/>
        <Static id="Static52" taborder="94" text="용량" cssclass="sta_WF_Label" left="449" height="27" width="49" bottom="127"/>
        <Static id="Static53" taborder="95" text="OS 기타" cssclass="sta_WF_Label" left="264" height="27" width="72" bottom="101"/>
        <Static id="Static54" taborder="96" text="제조사" cssclass="sta_WF_Label" left="309" height="27" width="62" bottom="413"/>
        <Button id="btn_excelDown01" taborder="97" onclick="btn_excel_down_onclick" cssclass="btn_WF_Gridexceldn" height="19" width="26" right="28" top="68"/>
        <Button id="btn_excelDown02" taborder="98" onclick="btn_excel_down00_onclick" cssclass="btn_WF_Gridexceldn" width="25" height="19" bottom="496" right="28"/>
        <Grid id="Grid00" taborder="99" binddataset="ds_hist" autoenter="select" useinputpanel="false" cellsizingtype="col" left="514" right="2.74%" bottom="3" height="208" onexpandup="Grid00_onexpandup">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="84"/>
                <Column size="187"/>
                <Column size="135"/>
                <Column size="134"/>
                <Column size="125"/>
                <Column size="255"/>
              </Columns>
              <Rows>
                <Row size="25" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell style="font:9 돋움;" text="일련번호" autosizecol="limitmax"/>
                <Cell col="1" style="font:9 돋움;" text="용역업체" autosizecol="limitmax"/>
                <Cell col="2" style="font:9 돋움;" text="직원" autosizecol="limitmax"/>
                <Cell col="3" style="font:9 돋움;" text="계약시작일" autosizecol="limitmax"/>
                <Cell col="4" style="font:9 돋움;" text="계약종료일"/>
                <Cell col="5" style="font:9 돋움;" text="비고"/>
              </Band>
              <Band id="body">
                <Cell displaytype="number" edittype="none" text="bind:MODEL_NO"/>
                <Cell col="1" displaytype="normal" edittype="none" text="bind:SERVC_ENTRPS_CODE_NM"/>
                <Cell col="2" displaytype="normal" edittype="none" text="bind:IT_EMP_NM" expandshow="show"/>
                <Cell col="3" displaytype="date" edittype="date" text="bind:CNTRCT_BGNDE" combodataset="ds_sttus" combocodecol="CODE" combodatacol="CODE_NM"/>
                <Cell col="4" displaytype="date" edittype="date" text="bind:CNTRCT_ENDDE" combodataset="ds_servc_entrps" combocodecol="CODE" combodatacol="CODE_NM"/>
                <Cell col="5" displaytype="text" edittype="text" style="align:left;" text="bind:RM" combodataset="ds_it_emp" combocodecol="CODE" combodatacol="CODE_NM"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static55" taborder="100" text="장비계약이력" cssclass="sta_WF_Title02" left="514" bottom="213" height="21" width="98"/>
        <Button id="btn_addHist" taborder="101" text="행추가" cssclass="btn_WF_Gridadd" right="121" bottom="216" height="19" width="64" onclick="btn_AddHist_onclick"/>
        <Button id="btn_delHist" taborder="102" text="행삭제" cssclass="btn_WF_Griddel" right="54" bottom="216" height="19" width="64" onclick="btn_DelHist_onclick"/>
        <Button id="btn_saveHist" taborder="103" text="저장" cssclass="btn_WF_Process" right="187" bottom="216" height="19" width="64" onclick="btn_SaveHist_onclick"/>
        <Button id="btn_excelDown03" taborder="104" onclick="btn_excel_down00_onclick" cssclass="btn_WF_Gridexceldn" right="27" bottom="216" height="19" width="25" visible="true"/>
        <Static id="Static56" taborder="105" text="10" visible="false" left="50.14%" top="490" height="10" style="background:#dc143c3c;align:center middle;" width="500"/>
        <Edit id="edt_atchFile" taborder="28" readonly="true" enableevent="false" left="103" height="21" width="279" bottom="78"/>
        <Button id="btn_viewAtchFile" taborder="31" text="보기" onclick="fn_btnOnClickHandler" left="446" height="21" width="54" bottom="78"/>
        <Button id="btn_atchFile" taborder="29" onclick="fn_btnOnClickHandler" cssclass="btn_WF_Search" left="356" height="21" width="24" bottom="78"/>
        <Button id="btn_cancelAtchFile" taborder="109" text="취소" onclick="fn_btnOnClickHandler" left="390" height="21" width="55" bottom="78"/>
        <Button id="btn_delAtchFile" taborder="30" text="삭제" onclick="fn_btnOnClickHandler" left="390" height="21" width="55" bottom="78"/>
        <Combo id="cmb_hwSe" taborder="3" innerdataset="@ds_work_2" codecolumn="CODE" datacolumn="CODE_NM" left="103" height="21" width="148" onitemchanged="com_hw_se_onitemchanged" index="-1" bottom="468" cssclass="cmb_WF_Essential" enable="false"/>
        <Combo id="cmb_swSe" taborder="4" innerdataset="@ds_workdetail_2" codecolumn="CODE" datacolumn="CODE_NM" left="256" height="21" width="179" index="-1" bottom="468" cssclass="cmb_WF_Essential" enable="false"/>
        <Button id="Button01" taborder="110" cssclass="btn_WF_Gridexcelup" height="19" width="25" right="54" onclick="Button01_onclick" bottom="496"/>
        <Button id="btn_Del" taborder="111" text="행삭제" onclick="btn_Del_onclick" cssclass="btn_WF_Griddel" bottom="496" height="19" width="64" right="81"/>
        <Button id="btn_save" taborder="112" text="저장" onclick="btn_Save_onclick" cssclass="btn_WF_Process" bottom="496" height="19" width="64" right="214"/>
        <Button id="btn_add" taborder="113" text="행추가" onclick="btn_Add_onclick" cssclass="btn_WF_Gridadd" bottom="496" height="19" width="64" right="147"/>
        <Button id="Button12" taborder="114" text="양식보기" height="19" bottom="496" position="absolute" onclick="Button12_onclick" width="80" right="281"/>
        <Grid id="Grid02" taborder="115" autoenter="select" useinputpanel="false" cellsizingtype="col" left="23.32%" right="45.8%" bottom="490" height="157" visible="false" binddataset="ds_view">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="149"/>
                <Column size="80"/>
                <Column size="88"/>
              </Columns>
              <Rows>
                <Row size="25" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell style="font:9 돋움;" text="SerialNO" autosizecol="default"/>
                <Cell col="1" style="font:9 돋움;" text="도입일자" autosizecol="default"/>
                <Cell col="2" style="font:9 돋움;" text="도입가" autosizecol="default"/>
              </Band>
              <Band id="body">
                <Cell edittype="text" text="bind:Column0"/>
                <Cell col="1" displaytype="normal" edittype="text" text="bind:Column1" calendardisplay="edit" calendardisplaynulltype="none"/>
                <Cell col="2" displaytype="normal" edittype="text" style="align:right;" text="bind:Column2"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="Grid01" taborder="116" binddataset="ds_detail" autoenter="select" useinputpanel="false" cellsizingtype="col" left="514" right="2.74%" bottom="245" height="246" onexpandup="grd_onexpandup">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="149"/>
                <Column size="80"/>
                <Column size="88"/>
                <Column size="63"/>
                <Column size="95"/>
                <Column size="97"/>
                <Column size="80"/>
                <Column size="225"/>
              </Columns>
              <Rows>
                <Row size="25" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell style="font:9 돋움;" text="SerialNO" autosizecol="limitmax"/>
                <Cell col="1" style="font:9 돋움;" text="도입일자" autosizecol="limitmax"/>
                <Cell col="2" style="font:9 돋움;" text="도입가" autosizecol="limitmax"/>
                <Cell col="3" style="font:9 돋움;" text="장비상태" autosizecol="limitmax"/>
                <Cell col="4" style="font:9 돋움;" text="납품업체"/>
                <Cell col="5" style="font:9 돋움;" text="직원"/>
                <Cell col="6" style="font:9 돋움;" text="폐기일자" autosizecol="limitmax"/>
                <Cell col="7" style="font:9 돋움;" text="폐기사유" autosizecol="limitmax"/>
              </Band>
              <Band id="body">
                <Cell edittype="expr:(dataset.getRowType(currow) == 2) ? 'normal' : 'none'" text="bind:EQPMN_NO"/>
                <Cell col="1" displaytype="date" edittype="date" text="bind:EQPMN_INDC_DT" calendardisplay="edit" calendardisplaynulltype="none"/>
                <Cell col="2" displaytype="number" edittype="masknumber" style="align:right;" text="bind:EQPMN_INDC_AMOUNT"/>
                <Cell col="3" displaytype="combo" edittype="combo" text="bind:EQPMN_STTUS" combodataset="ds_sttus" combocodecol="CODE" combodatacol="CODE_NM"/>
                <Cell col="4" displaytype="normal" edittype="none" text="bind:SERVC_ENTRPS_CODE_NM"/>
                <Cell col="5" displaytype="normal" edittype="none" text="bind:IT_EMP_NM" expandshow="show"/>
                <Cell col="6" displaytype="date" edittype="date" text="bind:EQPMN_DSUSE_DT" calendardisplaynulltype="none"/>
                <Cell col="7" edittype="text" style="align:left;" text="bind:EQPMN_DSUSE_PRVONSH"/>
              </Band>
              <Band id="summary">
                <Cell expr="expr:dataset.getRowCount('EQPMN_NO')"/>
                <Cell col="1"/>
                <Cell col="2" displaytype="number" edittype="masknumber" expr="expr:dataset.getSum(&quot;EQPMN_INDC_AMOUNT&quot;)"/>
                <Cell col="3"/>
                <Cell col="4"/>
                <Cell col="5"/>
                <Cell col="6"/>
                <Cell col="7"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_work">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_workdetail">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_grid" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_grid_onrowposchanged">
        <ColumnInfo>
          <Column id="IT_CODE" type="STRING" size="256"/>
          <Column id="IT_CODE_NM" type="STRING" size="256"/>
          <Column id="IT_DETAIL_CODE" type="STRING" size="256"/>
          <Column id="IT_DETAIL_CODE_NM" type="STRING" size="256"/>
          <Column id="MODEL_NO" type="STRING" size="256"/>
          <Column id="MODEL_NM" type="STRING" size="256"/>
          <Column id="HW_MAKR" type="STRING" size="256"/>
          <Column id="CPU" type="STRING" size="256"/>
          <Column id="OPERSYSM" type="STRING" size="256"/>
          <Column id="MORY" type="STRING" size="256"/>
          <Column id="HDDISK" type="STRING" size="256"/>
          <Column id="MODEL_IMAGE" type="STRING" size="256"/>
          <Column id="ASSETS_STTUS" type="STRING" size="256"/>
          <Column id="CPU_REPR" type="STRING" size="256"/>
          <Column id="DOMSTC_AT" type="STRING" size="256"/>
          <Column id="DPLX_AT" type="STRING" size="256"/>
          <Column id="EQPMN_SE" type="STRING" size="256"/>
          <Column id="ETC_HW_VENDOR" type="STRING" size="256"/>
          <Column id="ETC_OPERSYSM" type="STRING" size="256"/>
          <Column id="HW_DETAIL" type="STRING" size="256"/>
          <Column id="HW_DETAIL_MATTER" type="STRING" size="256"/>
          <Column id="HW_ETC_TY" type="STRING" size="256"/>
          <Column id="HW_LIST_INCLS_AT" type="STRING" size="256"/>
          <Column id="HW_OPER_SE" type="STRING" size="256"/>
          <Column id="HW_SE" type="STRING" size="256"/>
          <Column id="HW_TY" type="STRING" size="256"/>
          <Column id="HW_VENDOR" type="STRING" size="256"/>
          <Column id="MORY_CPCTY" type="STRING" size="256"/>
          <Column id="TOT_STRE_CPCTY" type="STRING" size="256"/>
          <Column id="UPPER_HW_NM" type="STRING" size="256"/>
          <Column id="USE_AT" type="STRING" size="256"/>
          <Column id="IT_CODE_NM2" type="STRING" size="256"/>
          <Column id="IT_DETAIL_CODE_NM2" type="STRING" size="256"/>
          <Column id="MODEL_IMAGE_FLTPH" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_workparam">
        <ColumnInfo>
          <Column id="IT_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_detail" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_detail_onrowposchanged" onvaluechanged="ds_detail_onvaluechanged">
        <ColumnInfo>
          <Column id="IT_CODE" type="STRING" size="256"/>
          <Column id="IT_CODE_NM" type="STRING" size="256"/>
          <Column id="IT_DETAIL_CODE" type="STRING" size="256"/>
          <Column id="IT_DETAIL_CODE_NM" type="STRING" size="256"/>
          <Column id="MODEL_NO" type="STRING" size="256"/>
          <Column id="EQPMN_NO" type="STRING" size="256"/>
          <Column id="EQPMN_INDC_DT" type="DATE" size="8"/>
          <Column id="EQPMN_INDC_AMOUNT" type="BIGDECIMAL" size="256"/>
          <Column id="EQPMN_DSUSE_DT" type="DATE" size="8"/>
          <Column id="EQPMN_DSUSE_PRVONSH" type="STRING" size="256"/>
          <Column id="EQPMN_STTUS" type="STRING" size="256"/>
          <Column id="EQPMN_COMPOSITION_ID" type="STRING" size="256"/>
          <Column id="EQPMN_ASSETS_ID" type="STRING" size="256"/>
          <Column id="EQPMN_INSTL_PLACE" type="STRING" size="256"/>
          <Column id="EQPMN_INSTL_DETAIL" type="STRING" size="256"/>
          <Column id="EQPMN_OPER_DEPT" type="STRING" size="256"/>
          <Column id="EQPMN_CHARGER" type="STRING" size="256"/>
          <Column id="SERVC_ENTRPS_CODE" type="STRING" size="256"/>
          <Column id="IT_EMP" type="STRING" size="256"/>
          <Column id="DWFG_ENTRPS_CODE" type="STRING" size="256"/>
          <Column id="DWFG_IT_EMP" type="STRING" size="256"/>
          <Column id="IT_EMP_NM" type="STRING" size="256"/>
          <Column id="SERVC_ENTRPS_CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond">
        <ColumnInfo>
          <Column id="IT_CODE" type="STRING" size="255"/>
          <Column id="IT_DETAIL_CODE" type="STRING" size="255"/>
          <Column id="MODEL_NM" type="STRING" size="256"/>
          <Column id="USE_AT" type="STRING" size="256"/>
          <Column id="EQPMN_NO" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_os"/>
      <Dataset id="ds_hw"/>
      <Dataset id="ds_madein"/>
      <Dataset id="ds_jasan"/>
      <Dataset id="ds_hwgb"/>
      <Dataset id="ds_osnm"/>
      <Dataset id="ds_cond1">
        <ColumnInfo>
          <Column id="MODEL_NO" type="STRING" size="256"/>
          <Column id="EQPMN_NO" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_work_2">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_workdetail_2">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="IT_CODE" type="STRING" size="2"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_workparam_2">
        <ColumnInfo>
          <Column id="IT_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sttus">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_servc_entrps" onrowposchanged="ds_servc_entrps_onrowposchanged" onvaluechanged="ds_servc_entrps_onvaluechanged" oncolumnchanged="ds_servc_entrps_oncolumnchanged">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_it_emp">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_dwfg_entrps">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_dwfg_it_emp">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_hist" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="MODEL_NO" type="STRING" size="30"/>
          <Column id="EQPMN_NO" type="STRING" size="50"/>
          <Column id="SN" type="BIGDECIMAL" size="11"/>
          <Column id="SERVC_ENTRPS_CODE" type="STRING" size="13"/>
          <Column id="IT_EMP" type="STRING" size="3"/>
          <Column id="CNTRCT_BGNDE" type="STRING" size="8"/>
          <Column id="CNTRCT_ENDDE" type="STRING" size="8"/>
          <Column id="RM" type="STRING" size="200"/>
          <Column id="REGISTER_ID" type="STRING" size="12"/>
          <Column id="REGIST_DT" type="STRING" size="255"/>
          <Column id="UPDUSR_ID" type="STRING" size="12"/>
          <Column id="UPDT_DT" type="STRING" size="255"/>
          <Column id="SERVC_ENTRPS_CODE_NM" type="STRING" size="256"/>
          <Column id="IT_EMP_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_condhist">
        <ColumnInfo>
          <Column id="MODEL_NO" type="STRING" size="255"/>
          <Column id="EQPMN_NO" type="STRING" size="255"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_hist_entrps">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_hist_it_emp">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond00" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="MODEL_IMAGE_FLTPH" type="STRING" size="256"/>
          <Column id="MODEL_NO" type="STRING" size="256"/>
          <Column id="FILE_SN" type="STRING" size="256"/>
          <Column id="JOB_SE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_failList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_File" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="FILE_PATH" type="STRING" size="256"/>
          <Column id="FILE_NAME" type="STRING" size="256"/>
          <Column id="FILE_SIZE" type="STRING" size="256"/>
          <Column id="FILE_SAVENM" type="STRING" size="256"/>
          <Column id="FILE_TYPE" type="STRING" size="256"/>
          <Column id="NUM" type="STRING" size="256"/>
          <Column id="CHK" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_validation" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="compId" type="STRING" size="256"/>
          <Column id="colId" type="STRING" size="256"/>
          <Column id="PK" type="STRING" size="256"/>
          <Column id="notNull" type="STRING" size="256"/>
          <Column id="type" type="STRING" size="256"/>
          <Column id="nlength" type="STRING" size="256"/>
          <Column id="from" type="STRING" size="256"/>
          <Column id="to" type="STRING" size="256"/>
          <Column id="lengthChkGb" type="STRING" size="256"/>
          <Column id="msgId" type="STRING" size="256"/>
          <Column id="expr" type="STRING" size="256"/>
          <Column id="func" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="compId">div_search</Col>
            <Col id="colId">cmb_ladCode</Col>
            <Col id="notNull">Y</Col>
            <Col id="to"/>
            <Col id="msgId">토지코드</Col>
          </Row>
          <Row>
            <Col id="compId">ds_ladDetailList</Col>
            <Col id="colId">LAD_CODE</Col>
            <Col id="notNull">Y</Col>
            <Col id="to"/>
            <Col id="msgId">토지코드</Col>
          </Row>
          <Row>
            <Col id="compId">ds_ladDetailList</Col>
            <Col id="colId">BLCK</Col>
            <Col id="notNull">Y</Col>
            <Col id="to"/>
            <Col id="msgId">블록</Col>
          </Row>
          <Row>
            <Col id="compId">ds_ladDetailList</Col>
            <Col id="colId">LOT</Col>
            <Col id="notNull">Y</Col>
            <Col id="to"/>
            <Col id="msgId">롯트</Col>
          </Row>
          <Row>
            <Col id="compId">ds_ladDetailList</Col>
            <Col id="colId">LOT_TY</Col>
            <Col id="notNull">Y</Col>
            <Col id="to"/>
            <Col id="msgId">롯트구분</Col>
          </Row>
          <Row>
            <Col id="compId">ds_ladDetailList</Col>
            <Col id="colId">SUPLY_CODE</Col>
            <Col id="notNull">Y</Col>
            <Col id="to"/>
            <Col id="msgId">공급구분</Col>
          </Row>
          <Row>
            <Col id="compId">ds_ladDetailList</Col>
            <Col id="colId">PRPOS_SE</Col>
            <Col id="notNull">Y</Col>
            <Col id="to"/>
            <Col id="msgId">용도구분</Col>
          </Row>
          <Row>
            <Col id="compId">ds_ladPayInfoList</Col>
            <Col id="colId">PAY_CODE</Col>
            <Col id="notNull">Y</Col>
            <Col id="to"/>
            <Col id="msgId">납부코드</Col>
          </Row>
          <Row>
            <Col id="compId">ds_ladPayInfoList</Col>
            <Col id="colId">PAY_TMLMT</Col>
            <Col id="notNull">Y</Col>
            <Col id="to"/>
            <Col id="msgId">납부기한일</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_excel" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" onrowposchanged="DS_TBRNT_APPLCNT_onrowposchanged" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_view" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="Column0" type="STRING" size="256"/>
          <Column id="Column1" type="STRING" size="256"/>
          <Column id="Column2" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="Column0">50000 010 00001</Col>
            <Col id="Column1">20160527</Col>
            <Col id="Column2">500000</Col>
          </Row>
          <Row>
            <Col id="Column0">50000 010 00002</Col>
            <Col id="Column1">20160527</Col>
            <Col id="Column2">500000</Col>
          </Row>
          <Row>
            <Col id="Column0">50000 010 00003</Col>
            <Col id="Column1">20160527</Col>
            <Col id="Column2">500000</Col>
          </Row>
          <Row>
            <Col id="Column0">50000 010 00004</Col>
            <Col id="Column1">20160527</Col>
            <Col id="Column2">500000</Col>
          </Row>
          <Row>
            <Col id="Column0">50000 010 00005</Col>
            <Col id="Column1">20160527</Col>
            <Col id="Column2">500000</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item49" compid="cmb_hwTy" propid="value" datasetid="ds_grid" columnid="HW_TY"/>
      <BindItem id="item0" compid="cmb_hwOperSe" propid="value" datasetid="ds_grid" columnid="HW_OPER_SE"/>
      <BindItem id="item1" compid="cmb_domstcAt" propid="value" datasetid="ds_grid" columnid="DOMSTC_AT"/>
      <BindItem id="item2" compid="cmb_assetsSttus" propid="value" datasetid="ds_grid" columnid="ASSETS_STTUS"/>
      <BindItem id="item3" compid="cmb_operSysm" propid="value" datasetid="ds_grid" columnid="OPERSYSM"/>
      <BindItem id="item6" compid="edt_modelNo" propid="value" datasetid="ds_grid" columnid="MODEL_NO"/>
      <BindItem id="item7" compid="edt_modelNm" propid="value" datasetid="ds_grid" columnid="MODEL_NM"/>
      <BindItem id="item8" compid="edt_hwMakr" propid="value" datasetid="ds_grid" columnid="HW_MAKR"/>
      <BindItem id="item9" compid="chk_dplxAt" propid="value" datasetid="ds_grid" columnid="DPLX_AT"/>
      <BindItem id="item10" compid="chk_sportListIncls" propid="value" datasetid="ds_grid" columnid="HW_LIST_INCLS_AT"/>
      <BindItem id="item11" compid="edt_hwEtcTy" propid="value" datasetid="ds_grid" columnid="HW_ETC_TY"/>
      <BindItem id="item12" compid="edt_upperHwNm" propid="value" datasetid="ds_grid" columnid="UPPER_HW_NM"/>
      <BindItem id="item13" compid="edt_hwDetail" propid="value" datasetid="ds_grid" columnid="HW_DETAIL"/>
      <BindItem id="item14" compid="edt_hwVendor" propid="value" datasetid="ds_grid" columnid="HW_VENDOR"/>
      <BindItem id="item15" compid="edt_etcHwVendor" propid="value" datasetid="ds_grid" columnid="ETC_HW_VENDOR"/>
      <BindItem id="item16" compid="edt_cpu" propid="value" datasetid="ds_grid" columnid="CPU"/>
      <BindItem id="item17" compid="edt_hdDisk" propid="value" datasetid="ds_grid" columnid="HDDISK"/>
      <BindItem id="item18" compid="edt_mory" propid="value" datasetid="ds_grid" columnid="MORY"/>
      <BindItem id="item19" compid="edt_etcOpersysm" propid="value" datasetid="ds_grid" columnid="ETC_OPERSYSM"/>
      <BindItem id="item21" compid="txt_hwDetailMatter" propid="value" datasetid="ds_grid" columnid="HW_DETAIL_MATTER"/>
      <BindItem id="item22" compid="rdo_useAt" propid="value" datasetid="ds_grid" columnid="USE_AT"/>
      <BindItem id="item23" compid="edt_totStreCpcty" propid="value" datasetid="ds_grid" columnid="TOT_STRE_CPCTY"/>
      <BindItem id="item24" compid="edt_cpuRepr" propid="value" datasetid="ds_grid" columnid="CPU_REPR"/>
      <BindItem id="item25" compid="edt_moryCpcty" propid="value" datasetid="ds_grid" columnid="MORY_CPCTY"/>
      <BindItem id="item27" compid="div_search.cmb_ItDetailCode" propid="value" datasetid="ds_cond" columnid="IT_DETAIL_CODE"/>
      <BindItem id="item29" compid="div_search.edt_modelNm" propid="value" datasetid="ds_cond" columnid="MODEL_NM"/>
      <BindItem id="item4" compid="cmb_hwSe" propid="value" datasetid="ds_grid" columnid="HW_SE"/>
      <BindItem id="item5" compid="cmb_swSe" propid="value" datasetid="ds_grid" columnid="EQPMN_SE"/>
      <BindItem id="item26" compid="div_search.cmb_ItCl" propid="value" datasetid="ds_cond" columnid="IT_CODE"/>
      <BindItem id="item28" compid="div_search.cmb_ItDetailCode" propid="value" datasetid="ds_cond" columnid="IT_DETAIL_CODE"/>
      <BindItem id="item38" compid="edt_atchFile" propid="value" datasetid="ds_grid" columnid="MODEL_IMAGE"/>
    </Bind>
    <Script type="xscript5.0"><![CDATA[/***********************************************************************
 * 화면ID   : ITM020100.xfdl
 * 화면명   : HW대장관리
 * 화면설명 : HW대장을 관리한다
 * 작성일   : 2015.08.24
 * 작성자   : 한승엽
 * 수정이력 : 
 ***********************************************************************
 *     수정일     수정자   내용
 ***********************************************************************
 *   
 *    
 ***********************************************************************
 */
 
/***********************************************************************
 * Script Include 
 ************************************************************************/
include "lib::comInclude.xjs";
include "pms_lib::pmsUtilInclude.xjs";	// PMS 업무공통 라이브러리
// 업무에 필요한 공통 라이브러리 파일을 추가할 수 있다.
// include "pms_lib::pmsUtil.xjs";	// PMS 업무공통 라이브러리
// include "pms_lib::gridUtil.xjs";
/***********************************************************************
 * 화면 변수 선언부
 ************************************************************************/
 
/***********************************************************************
 * Form Function
 ************************************************************************/
 
/***********************************************************************
 * onInit / onLoad 영역
 ***********************************************************************/
this.ITM020100_oninit = function(obj:Form, e:nexacro.InitEventInfo)
{
	// Form 초기화
	this.fn_init_form();

	// DataSet 초기화
	this.fn_init_dataset();
	  
	this.fn_init();
}
 
this.ITM020100_onload = function (obj:Form, e:LoadEventInfo)
{
	//this.fn_init_enterKeyEvent(this);
	this.div_search.rdo_useAt.value = '1'; //콤보 세팅이 잘되지 않아 로드시 세팅.	
	this.ds_workparam.addRow();//파라메타 넘기기위해 로우 한줄 추가
	this.ds_workparam_2.addRow();//파라메타 넘기기위해 로우 한줄 추가
	this.ds_cond1.addRow();
	this.fn_getCode();//공통코드조회
	this.fn_loadCombo();

	var fileConfig = {
		onChange: this.fn_onFileSelected,
		onSuccess : this.fn_onFileSuccess
	};
	this.FILE_MANAGER = new this.fileManager(this, "ETC", "ITM");
	this.FILE_MANAGER.init(fileConfig);
	
	//Ex.core.init(obj);
	 this.fn_search();
}
/***********************************************************************
 * Form/Dataset 오브젝트 초기화
 ***********************************************************************/
 
/*
 * 함수명  	: initForm
 * 설명 		: Form을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initForm();
 */
this.fn_init_form = function()
{
	// 시스템 공통으로 Form을 Initialize 한다.
	this.gfn_initForm(this);
	
	this.ds_cond.clearData();
	var nRow = this.ds_cond.addRow();

	this.ds_condhist.clearData();
	var nRow2 = this.ds_condhist.addRow();	
	
	
	this.checkDs.push(this.ds_grid);
	this.checkDs.push(this.ds_detail);
	// 해당 Form에 필요한 초기화 부분 기술
	// =======================================

    // Form Eliments 초기화

    // Grid 초기화(필요한 경우)
    // 공통코드콤보 초기화
    // 부서콤보 초기화
}

/*
 * 함수명  	: initDataset
 * 설명 		: Dataset을 초기화한다.
 *                주로, 조건 Dataset들(ds_cond, ds_cond_00, ds_cond_01, ...) 을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initDataset();
 */
this.fn_init_dataset = function()
{
	// 조건 Dataset 외에 초기화가 필요한 Dataset에 대한 초기화 코드를 추가한다.
	// TODO
}

/***********************************************************************
* Transaction 영역 시작
************************************************************************/

/***********************************************************************
 * Transaction 관련 이벤트 핸들러 
 **********************************************************************/
/*
 * 함수명  	: fn_loadCombo
 * 설명 		: 화면의 Combo 에 데이터를 불러온다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_loadCombo();
 */
 /*
	마스터콤보 변경
 */
this.fn_loadCombo = function ()
{	
	this.fn_transaction("selectListCode");
	this.fn_transaction("selectListCode2");
	this.fn_transaction("selectListCodeDetailAll");
	this.fn_transaction("selectListCodeDetail");
	
	this.fn_transaction("selectListCodeEntrPs");
	this.fn_transaction("selectListCodeItEmp");
	this.fn_transaction("selectListCodeEntrPs2");
	this.fn_transaction("selectListCodeItEmp2");
	this.fn_transaction("selectListCodeEntrPs3");
	this.fn_transaction("selectListCodeItEmp3");
	
	
	
}


//그룹코드목록에 따른 공통코드 목록조회 Search
this.fn_getCode = function()
{
	this.gfn_initCondDs(this, this.div_search);

	var param = [
		['ds_os','ITME06','Y','D','G']		// os
		,['ds_hw','ITME02','Y','D','G']		// hw유형
		,['ds_hwgb','ITME03','Y','D','G']		// hw유형
		,['ds_madein','ITME04','Y','D','G']		// 국산여부
		,['ds_jasan','ITME05','Y','D','G']		// 자산상태
		,['ds_osnm','ITME06','Y','D','G']		// os명
		,['ds_sttus','ITM002','Y','S','G']		// 장비상태
		//,['ds_PRJ011','PRJ011','Y','D','G']		// 판매구분
	];

	var callback = function (svcId, errorCode, errorMsg) {
	};

	this.gfn_comboLoad (param, callback);
}

/*
 * 함수명  	: fn_search
 * 설명 		: HW사용관리 조회 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_search();
 */
this.fn_search = function()
{
	this.ds_grid.clearData();
	
	this.fn_transaction("selectList");	
}

this.fn_save = function()
{

	// 파일 첨부여부 확인
	var hasAttFile = this.FILE_MANAGER.hasFile();
	if(hasAttFile){
		var attFileCount = this.FILE_MANAGER.getfileCount();
		trace("첨부파일 있음!" + attFileCount);
		var sController = "/hsco/etc/itm/ITM020100/ITM020100CU.do";
		var oInDatasets = "input1=ds_grid:U";
		var sOutDatasets = "ds_failList=failList";
		
		this.FILE_MANAGER.upload(sController, oInDatasets, sOutDatasets);
	}else{
		if ( application.confirm( "변경된 내용을 저장하시겠습니까?" ) )
		{	
			if(this.fn_check()){
				this.fn_transaction("saveList");
			}
		}else{
			alert('저장할 정보가 존재하지 않습니다');
		}
	}
	
}


/**********************************************************************
 * CALL TRANSACTION 영역
 **********************************************************************/
 
/*
 * 함수명  	: fn_transaction
 * 설명 		: Transaction 요청 처리 함수
 * params  		: strSvcId : 서비스요청 ID
 * return Type 	: None
 * 사용법		: this.fn_transaction("SELECT");
 */
this.fn_transaction = function(strSvcId)
{
	var reqParam = null;
	switch (strSvcId) {
	
		case "selectListCodeEntrPs": // 업체목록
			var sController		= "/hsco/etc/itm/ITM020100/ITM020100ListCodeEntrPs.do";
			var sInDatasets		= "";
			var sOutDatasets	= "ds_servc_entrps=output1";
			break;
				
		case "selectListCodeItEmp": // 직원목록
			var sController		= "/hsco/etc/itm/ITM020100/ITM020100ListCodeItEmp.do";
			var sInDatasets		= "";
			var sOutDatasets	= "ds_it_emp=output1";
			break;

		case "selectListCodeEntrPs2": // 업체목록
			var sController		= "/hsco/etc/itm/ITM020100/ITM020100ListCodeEntrPs.do";
			var sInDatasets		= "";
			var sOutDatasets	= "ds_dwfg_entrps=output1";
			break;
				
		case "selectListCodeItEmp2": // 직원목록
			var sController		= "/hsco/etc/itm/ITM020100/ITM020100ListCodeItEmp.do";
			var sInDatasets		= "";
			var sOutDatasets	= "ds_dwfg_it_emp=output1";
			break;			
							
		case "selectListCodeEntrPs3": // 업체목록
			var sController		= "/hsco/etc/itm/ITM020100/ITM020100ListCodeEntrPs.do";
			var sInDatasets		= "";
			var sOutDatasets	= "ds_hist_entrps=output1";
			break;
				
		case "selectListCodeItEmp3": // 직원목록
			var sController		= "/hsco/etc/itm/ITM020100/ITM020100ListCodeItEmp.do";
			var sInDatasets		= "";
			var sOutDatasets	= "ds_hist_it_emp=output1";
			break;								
							
		case "selectListCode": // 장비목록
			var sController		= "/hsco/etc/itm/ITM020100/ITM020100ListCode.do";
			var sInDatasets		= "";
			var sOutDatasets	= "ds_work=output1";
			break;
				
		case "selectListCodeDetail": // 장비목록
			var sController		= "/hsco/etc/itm/ITM020100/ITM020100ListCodeDetail.do";
			var sInDatasets		= "";
			var sOutDatasets	= "ds_workdetail=output1";
			break;

		case "selectListCode2": // 장비목록
			var sController		= "/hsco/etc/itm/ITM020100/ITM020100ListCode.do";
			var sInDatasets		= "";
			var sOutDatasets	= "ds_work_2=output1";
			break;
				
		case "selectListCodeDetail2": // 장비목록
			var sController		= "/hsco/etc/itm/ITM020100/ITM020100ListCodeDetail.do";
			var sInDatasets		= "input1=ds_workparam_2";
			var sOutDatasets	= "ds_workdetail_2=output1";
			break;			
			
		case "selectListCodeDetailAll": // 장비목록
			var sController		= "/hsco/etc/itm/ITM020100/ITM020100ListCodeDetail.do";
			var sInDatasets		= "input1=ds_workparam_2";
			var sOutDatasets	= "ds_workdetail_2=output1";
			break;				
							
		case "selectList": // 대장목록
			var sController		= "/hsco/etc/itm/ITM020100/ITM020100List.do";
			var sInDatasets		= "input1=ds_cond";
			var sOutDatasets	= "ds_grid=output1";
			
			this.ds_cond.setColumn(0,"USE_AT",this.div_search.rdo_useAt.value);
			this.ds_cond.setColumn(0,"EQPMN_NO",this.div_search.edt_serialNo.value);
			this.ds_cond.setColumn(0,"MODEL_NM",this.div_search.edt_modelNm.value);
//			this.ds_cond.setColumn(0,"IT_CODE",this.div_search.Combo02.value);
//			this.ds_cond.setColumn(0,"IT_DETAIL_CODE",this.div_search.Combo00.value);
//			this.ds_cond.setColumn(0,"MODEL_NO",this.div_search.Edit05.value);
						
			break;
			
		case "selectList1": // 장비목록
			var sController		= "/hsco/etc/itm/ITM020100/ITM020100DetailList.do";
			var sInDatasets		= "input1=ds_cond1";
			var sOutDatasets	= "ds_detail=output1";
			 
			this.ds_cond1.setColumn(0,"MODEL_NO",this.ds_grid.getColumn(this.ds_grid.rowposition,"MODEL_NO"));
			this.ds_cond1.setColumn(0,"EQPMN_NO",this.div_search.edt_serialNo.value);
			//this.ds_cond1.setColumn(0,"EQPMN_NO",this.ds_grid.getColumn(this.ds_grid.rowposition,"EQPMN_NO"));
			
			break;
			
			
		case "selectListCodeHist": // 계약이력
			var sController		= "/hsco/etc/itm/ITM020100/ITM020100HistList.do";
			var sInDatasets		= "input1=ds_condhist";
			var sOutDatasets	= "ds_hist=output1";
			
			this.ds_condhist.setColumn(0,"MODEL_NO",this.ds_detail.getColumn(this.ds_detail.rowposition,"MODEL_NO"));
			this.ds_condhist.setColumn(0,"EQPMN_NO",this.ds_detail.getColumn(this.ds_detail.rowposition,"EQPMN_NO"));
						
			break;
						

			
		case "saveList": // 대장목록 저장
			var sController   	= "/hsco/etc/itm/ITM020100/ITM020100CU.do";	
			var s  = "input1=ds_grid:U";
				  //+ " input2=ds_rnet_ph:U"  //다중저장할때
				  //+ " input3=ds_cocnr:U";	  //다중저장할때
				  
			var sInDatasets   	= s;
			var sOutDatasets  	= "";
			break;
		
		
		case "deleteList" :		// 선택 토지 상세정보 삭제
		
			this.ds_cond00.clearData();
			var nRow = this.ds_cond00.addRow();
					
			this.ds_cond00.setColumn(0,"MODEL_IMAGE_FLTPH",this.ds_grid.getColumn(this.ds_grid.rowposition,"MODEL_IMAGE_FLTPH"));
			this.ds_cond00.setColumn(0,"SN",this.ds_grid.getColumn(this.ds_grid.rowposition,"SN"));
			this.ds_cond00.setColumn(0,"FILE_SN",this.ds_grid.getColumn(this.ds_grid.rowposition,"MODEL_IMAGE_FLTPH"));
				
			trace(this.ds_cond00.saveXML());
			var sController   	= "/hsco/etc/itm/ITM020100/ITM020100D.do";	
			var s  = "input1=ds_cond00";
				  //+ " input2=ds_rnet_ph:U"  //다중저장할때
				  //+ " input3=ds_cocnr:U";	  //다중저장할때
				  
			var sInDatasets   	= s;
			var sOutDatasets  	= "";
			break;
		
		case "deleteFile" :	// 파일정보 삭제
			var selRowItem = this.pmsUtil.getGridSelectedItem(this.grd_hw);
			this.SELECTED_LAD_DETAIL_INFO = selRowItem;	
			
			reqParam = this.SELECTED_LAD_DETAIL_INFO;
			reqParam["FILE_SN"] = this.ds_grid.getColumn(this.ds_grid.rowposition,"MODEL_IMAGE_FLTPH");
			
			var sController = "/hsco/etc/itm/ITM020100/ITM020100DFILE.do";
			var sInDatasets = reqParam;
			var sOutDatasets = "";
			break;
			
		case "downloadAtchFile" :
		
// 			var ladDetInfo = this.SELECTED_LAD_DETAIL_INFO == null ? this.pmsUtil.getGridSelectedItem(this.grd_ladDet) : this.SELECTED_LAD_DETAIL_INFO;	// 선택 토지 상세정보
// 			var fileSn = ladDetInfo["ATCH_FLPTH"];	// 파일일련번호(파일경로)
// 			var fileOrder = "1";					// 임시 : 첨부파일은 공통으로 파일일련번호와 파일순차로 조회가능하나 현재(2015/10/21) 컬럼이 맞지않음
// 			var fileName = ladDetInfo["ATCH_FILE"];	// 실제 파일명
		
			reqParam = this.SELECTED_LAD_DETAIL_INFO;
			reqParam["FILE_SN"] = reqParam["MODEL_IMAGE_FLTPH"];
			reqParam["FILE_ORDR"] = "1";
			
			sController = "hsco/cmm/download/fileDownload.do";
			sInDatasets = reqParam;
			sOutDatasets = "";
		
			break;
		
		case "saveList1": // 대장목록 저장
			var sController   	= "/hsco/etc/itm/ITM020100/ITM020100DetailCUD.do";	
			var s  = "input1=ds_detail:U";
				  
			var sInDatasets   	= s;
			var sOutDatasets  	= "";
			
			break;			
			
		case "saveHistList": // 계약이력 저장
			var sController   	= "/hsco/etc/itm/ITM020100/ITM020100HistCUD.do";	
			var s  = "input1=ds_hist:U";
				  
			var sInDatasets   	= s;
			var sOutDatasets  	= "";
			
			trace("SaveHistList : " + this.ds_hist.saveXML());
			break;				
		
	}
	var sInDataType = typeof(sInDatasets);
	if(sInDataType == "object"){
		this.pmsUtil.pmsComTran(strSvcId, sController, sInDatasets, sOutDatasets, null, null, false);
	}else{
		Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets, null, null, null);
	}
}

 /**********************************************************************
 * Transaction Callback 영역
 ***********************************************************************/
 
 /*
 * 함수명  	: fn_callBack
 * 설명 		: Transaction Callback 처리
 * params  		: strSvcId    : 서비스요청 ID
 *                nErrorCode  : 오류 메시지 코드 ([예] 0 : Success, 그밖의 경우, error)
 *                strErrorMsg : 오류 메시지([예]  success.insert|정상적으로 등록되었습니다.)
 * return Type 	: None
 * 사용법		: 
 */
this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg)
{
	if (nErrorCode < 0) 
	{
		this.gfn_callBackMsg(strSvcId, nErrorCode, strErrorMsg);
		return ;
	}
	
	switch (strSvcId) 
	{
		
		case "selectList":
			//this.gfn_callBackMsg(strSvcId, nErrorCode, strErrorMsg);
			//this.div_search.edt_modelNm.setFocus();
			
			break;	
		case "saveList":
			this.gfn_callBackMsg(strSvcId, nErrorCode, strErrorMsg);
			this.cmb_hwSe.enable = false;
		    this.cmb_swSe.enable = false;

			break;	
		case "saveList1":
			this.gfn_callBackMsg(strSvcId, nErrorCode, strErrorMsg);            
			break;		
			
		case "selectListCode":
			this.fn_add_comboHeader(this, this.div_search.cmb_ItCl, "전체");
			break;	
			
		case "selectListCodeDetail":
			this.fn_add_comboHeader(this, this.div_search.cmb_ItDetailCode, "전체");
			break;				
		
		case "deleteList":
			this.fn_transaction('selectList');

			break;	
		default:
			break;
	}
}


 
/***********************************************************************
* Transaction 영역 끝
************************************************************************/

/***********************************************************************
 * non-Transaction 관련 컴포넌트 이벤트 처리 함수
 ***********************************************************************/
 /*
 * 함수명  	: fn_insert
 * 설명 		: 신규 버튼 이벤트 처리(행추가)
 * params  		: Non
 * return Type 	: None
 * 사용법		: this.fn_insert();
 */
this.fn_insert = function(obj:Button,  e:nexacro.ClickEventInfo)
{		
	this.cmb_hwSe.enable = true;
	this.cmb_swSe.enable = true;
	if(this.fn_check()){
		var rowtype = this.ds_grid.getRowType(this.ds_grid.rowposition);
		var nRow = this.ds_grid.addRow();
		this.ds_grid.setColumn(nRow,"USE_AT","1");

	}
}
/*
 * 함수명  	: fn_delete
 * 설명 		: 삭제 버튼 이벤트 처리(행삭제)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_delete();
 */
this.fn_delete = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.ds_detail.getRowCount()>0){
		alert('하위데이터가 있습니다. \n하위데이터를 삭제후 삭제하세요.');
		return false;
	}

	var selItem = this.pmsUtil.getGridSelectedItem(this.grd_hw);
	var rowType = selItem["DS_ROW_TYPE"];
	var rowIdx = selItem["DS_ROW"];
	
	var confirmMsgId = "";
	var confirmMsg = "";
	if(rowType == Dataset.ROWTYPE_INSERT){
		this.ds_grid.deleteRow(rowIdx);
	}else{
		confirmMsgId = "comm.행위여부";
		confirmMsg = "선택한 정보를 삭제합니다.\n진행";

		if(this.gfn_message(confirmMsgId, confirmMsg)){
			this.fn_transaction("deleteList");		// 선택 토지 상세정보 삭제
		}
	}
}

/*
 * 함수명  	: fn_btnOnClickHandler
 * 설명 		: 버튼 onClick 이벤트 처리
 * params  		: obj 	: 이벤트 발생 그리드 Component
				  e		: 발생 이벤트
 * return Type 	: None
 * 사용법		: <Button onclick="fn_btnOnClickHandler">...</Button>
 */
this.fn_btnOnClickHandler = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var btnName = obj.name;
	switch(btnName){
	
			
		case "btn_atchFile" :					// 첨부파일 선택
			this.fn_addAtchFile();
			break;
			
		case "btn_cancelAtchFile" :				// 첨부파일 선택 취소
			this.fn_canceAtchlFile();
			break;
			
		case "btn_delAtchFile" :				// 첨부파일 삭제
			this.fn_deleteAtchFile();
			break;
			
		case "btn_viewAtchFile" :				// 첨부파일 보기(다운로드)
			this.fn_downloadAtchFile();
			break;
		
		default :
			break;
	}

}

/*
	ds_grid그리드 행이 바뀔때 실행되는 이벤트.
*/
this.ds_grid_onrowposchanged = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{
	this.ds_detail.clearData();
	
	if(this.ds_grid.getRowType(this.ds_grid.rowposition)!='2'){
		this.fn_transaction("selectList1");
	}
	
	this.fn_setAtchFileView();

}





this.btn_Add_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var ct = this.ds_grid.getRowCount();

	if(ct == 0){
		alert('조회후 신규를 선택하세요.');
		return false;
	}

	if(this.fn_check_detail()){
		this.ds_detail.addRow();
		this.ds_detail.setColumn(this.ds_detail.rowposition,"IT_CL",this.ds_grid.getColumn(this.ds_grid.rowposition,"IT_CL"));
		this.ds_detail.setColumn(this.ds_detail.rowposition,"IT_CODE",this.ds_grid.getColumn(this.ds_grid.rowposition,"IT_CODE"));
		this.ds_detail.setColumn(this.ds_detail.rowposition,"MODEL_NO",this.ds_grid.getColumn(this.ds_grid.rowposition,"MODEL_NO"));
	}
	
}

this.btn_Del_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var nCurRow = this.ds_detail.rowposition;
	var nRowType = this.ds_detail.getRowType(nCurRow);
    this.ds_detail.deleteRow(nCurRow);    
}

this.btn_Save_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{

	// 데이터셋 수정 여부체크
	if (!this.comUtils.isDatasetUpdated(this.ds_detail)) {
		alert("저장할 내역이 없습니다.");
		return false;
	}
	if ( application.confirm( "변경된 내용을 저장하시겠습니까?" ) )
	{	
		if(this.fn_check_detail()){
			this.fn_transaction("saveList1");
		}
	}
}

this.com_hw_se_onitemchanged = function(obj:Combo, e:nexacro.ItemChangeEventInfo)
{
	this.ds_workdetail_2.filter("IT_CODE == '" + e.postvalue + "'");
	this.cmb_Sw_Se.set_index(0);
		
}


this.grd_hw_onselectchanged = function(obj:Grid, e:nexacro.GridSelectEventInfo)
{
	var filter_str = this.ds_grid.getColumn(this.ds_grid.rowposition, "IT_CODE");
	this.ds_workdetail_2.filter("IT_CODE =='" + filter_str + "'");
}


this.div_search_cmb_ItCl_onitemchanged = function(obj:Combo, e:nexacro.ItemChangeEventInfo)
{
	this.ds_workdetail.filter("IT_CODE == '" + e.postvalue + "'");
	this.fn_add_comboHeader(this, this.div_search.cmb_ItDetailCode, "전체");
	this.div_search.cmb_ItDetailCode.set_index(0);
	
}

/***********************************************************************
 * 설명: 필수입력사항 체크
 ************************************************************************/
this.fn_check= function()
{
	var year = "";
	var odr = "";
	var nRow = this.ds_grid.rowposition;
	
	//
	if(nRow > -1)   // 데이터셋의 크기가 1보다 클 때
	{
		ck1 = this.ds_grid.getColumn(nRow,"HW_SE"); //업무구분
		ck2 = this.ds_grid.getColumn(nRow,"EQPMN_SE"); //장비구분
		//ck3 = this.ds_grid.getColumn(nRow,"MODEL_NO"); //모델코드
		ck4 = this.ds_grid.getColumn(nRow,"MODEL_NM"); //모델명
		ck5 = this.ds_grid.getColumn(nRow,"USE_AT"); //사용여부
		
		
		
		if(!ck1) {
			alert("업무구분은 필수입력 사항입니다.");
			return false;
		}else if(!ck2) {
			alert("장비구분은 필수입력 사항입니다.");
			return false;
		//}else if(!ck3) {
		//	alert("모델코드는 필수입력 사항입니다.");
		//	return false;
		}else if(!ck4) {
			alert("모델명은 필수입력 사항입니다.");
			return false;
		}else if(!ck5) {
			alert("사용여부는 필수입력 사항입니다.");
			return false;
		}else {
			return true;
		} 

		return true;
	}else {
		return true;
	}
}



/***********************************************************************
 * 설명: 필수입력사항 체크
 ************************************************************************/
this.fn_check_detail= function()
{
	var year = "";
	var odr = "";
	var nRow = this.ds_detail.rowposition;
	
	//
	if(nRow > -1)   // 데이터셋의 크기가 1보다 클 때
	{
		ck1 = this.ds_detail.getColumn(nRow,"EQPMN_NO"); //SerialNo
		
		if(!ck1) {
			alert("SerialNo는 필수입력 사항입니다.");
			return false;
		}else {
			return true;
		} 

		return true;
	}else {
		return true;
	}
}

/***********************************************************************
 * 설명: 필수입력사항 체크
 ************************************************************************/
this.fn_check_hist= function()
{
	var year = "";
	var odr = "";
	var nRow = this.ds_hist.rowposition;
	
	//
	if(nRow > -1)   // 데이터셋의 크기가 1보다 클 때
	{
		ck1 = this.ds_hist.getColumn(nRow,"SERVC_ENTRPS_CODE_NM"); //SerialNo
		
		if(!ck1) {
			alert("용역업체는 필수입력 사항입니다.");
			return false;
		}else {
			return true;
		} 

		return true;
	}else {
		return true;
	}
}

/*
 * 함수명  	: btn_excel_down_onclick
 * 설명 		: 엑셀다운로드
 * params  		: None
 * return Type 	: None
 * 사용법		: n/a
 */
this.btn_excel_down_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.gfn_exportExcel(this.grd_hw, "exportExl");
}
this.btn_excel_down00_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.gfn_exportExcel(this.Grid01, "exportExl");
}


/*
 * 함수명  	: grd_onheadclick
 * 설명 		: 헤더클릭 이벤트(SORT)
 * params  		: None
 * return Type 	: None
 * 사용법		: n/a
 */
this.grd_hw_onheadclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	this.gfn_gridSort(obj, e);
}


this.ds_detail_onrowposchanged = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{
	this.ds_hist.clearData();
	this.fn_transaction("selectListCodeHist");
}

this.btn_SaveHist_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
		// 데이터셋 수정 여부체크
	if (!this.comUtils.isDatasetUpdated(this.ds_hist)) {
		alert("저장할 내역이 없습니다.");
		return false;
	}
	if ( application.confirm( "변경된 내용을 저장하시겠습니까?" ) )
	{	
		if(this.fn_check_hist()){
			this.fn_transaction("saveHistList");
		}
	}
}

this.btn_AddHist_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var ct = this.ds_detail.getRowCount();

	if(ct == 0){
		alert('조회후 신규를 선택하세요.');
		return false;
	}

	if(this.fn_check_hist()){
		this.ds_hist.addRow();
		this.ds_hist.setColumn(this.ds_hist.rowposition,"MODEL_NO",this.ds_detail.getColumn(this.ds_detail.rowposition,"MODEL_NO"));
		this.ds_hist.setColumn(this.ds_hist.rowposition,"EQPMN_NO",this.ds_detail.getColumn(this.ds_detail.rowposition,"EQPMN_NO"));
	}
}

this.btn_DelHist_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var nCurRow = this.ds_hist.rowposition;
	var nRowType = this.ds_hist.getRowType(nCurRow);
    this.ds_hist.deleteRow(nCurRow);
}

/* 파일 업로드 관련 */
this.div_work_btn_popupFile_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.fn_transaction("GetFileSn");

	if(!this.fn_ds_popUp_validate) return;

    this.ds_fileSn.setColumn(0, "SYS_SE_CODE", this.sysSe);
    this.ds_fileSn.setColumn(0, "JOB_SE", this.jobSe);
    //trace("div_work_btn_popupFile_onclick = " + this.ds_fileSn.saveXML());
	var parm = {
		arg_0 : this,  //==> 필수, 팝업을 호출하는 form을 참조할 수 있도록 팝업에 Argument로 넘겨준다. (반드시 기술해야 함.)
		arg_1 : this.ds_files,
		arg_2 : this.ds_fileSn
	};
	
	this.gfn_popup("Popup_2", 694, 528, "업로드파일 선택 / 다운로드", parm, "com::COM010300_P01.xfdl", "div_work_btn_popupFile_callback");
}

this.fn_ds_popUp_validate = function(){
    var boolChk = true;
    if(this.ds_fileSn.getRowCount() == 0) {
        
        boolChk = false;
        // this.alert("프로그램 오류? 필수값 누락");
        return;
    } else {
        var sysSeCode = this.ds_fileSn.getColumn(0, "SYS_SE_CODE");
        var jobSeCode = this.ds_fileSn.getColumn(0, "JOB_SE");
        if(sysSeCode == "" || sysSeCode == null || sysSeCode == undefined){
             
             boolChk = false;
             // this.alert("항목 필수값 누락");
             return;
        }
        
        if(jobSeCode == "" || jobSeCode == null || jobSeCode == undefined){
            
            boolChk = false;
            // this.alert("항목 필수값 누락");
            return;
        }
    }
    return boolChk;
}

/*
 * 함수명  	: fn_btnOnClickHandler
 * 설명 		: 버튼 onClick 이벤트 처리
 * params  		: obj 	: 이벤트 발생 그리드 Component
				  e		: 발생 이벤트
 * return Type 	: None
 * 사용법		: <Button onclick="fn_btnOnClickHandler">...</Button>
 */
this.fn_btnOnClickHandler = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var btnName = obj.name;
	switch(btnName){
	
			
		case "btn_atchFile" :					// 첨부파일 선택
			this.fn_addAtchFile();
			break;
			
		case "btn_cancelAtchFile" :				// 첨부파일 선택 취소
			this.fn_canceAtchlFile();
			break;
			
		case "btn_delAtchFile" :				// 첨부파일 삭제
			this.fn_deleteAtchFile();
			break;
			
		case "btn_viewAtchFile" :				// 첨부파일 보기(다운로드)
			this.fn_downloadAtchFile();
			break;
		
		default :
			break;
	}

}

// ==================================================
// 첨부파일 처리 관련
// ==================================================

/**
 * 파일업로드 파일 선택
 * @param 
 * @return void
 */
this.fn_addAtchFile = function(){
	this.FILE_MANAGER.addFiles();
}

/**
 * 파일업로드 선택 파일 취소
 * @param 
 * @return void
 */
this.fn_canceAtchlFile = function(){
	//var selFileNm = this.pmsUtil.getGridSelectedItem(this.Grid02, "PROCSS_ATCH_FILE");
	//var result = this.FILE_MANAGER.cancelFiles(selFileNm);

	//if(result){
		//this.pmsUtil.setGridSelectedItemValue(this.Grid02, "PROCSS_ATCH_FILE", null);
		this.ds_grid.setColumn(this.ds_grid.rowposition,"MODEL_IMAGE","");
		this.fn_setAtchFileView();		// 첨부파일 영역 처리
	//}
}

/**
 * 함수명  	: fn_deleteAtchFile
 * 설명 		: 토지 상세 첨부파일 삭제
 * params  		: null
 * return Type 	: None
 * 사용법		: this.fn_deleteAtchFile();
 */
this.fn_deleteAtchFile = function(){

	var confirmMsg = "첨부파일을 삭제하시겠습니까?";
	if(confirm(confirmMsg)){
		this.fn_transaction("deleteFile");		// 첨부파일 삭제
	}
}

/**
 * 함수명  	: fn_downloadAtchFile
 * 설명 		: 토지 상세 첨부파일 보기(다운로드)
 * params  		: null
 * return Type 	: None
 * 사용법		: this.fn_downloadAtchFile();
 */
this.fn_downloadAtchFile = function(){

	var ladDetInfo = this.SELECTED_LAD_DETAIL_INFO == null ? this.pmsUtil.getGridSelectedItem(this.grd_hw) : this.SELECTED_LAD_DETAIL_INFO;	// 선택 토지 상세정보
	var fileSn = ladDetInfo["MODEL_IMAGE_FLTPH"];	// 파일일련번호(파일경로)
	var fileOrder = "1";					// 임시 : 첨부파일은 공통으로 파일일련번호와 파일순차로 조회가능하나 현재(2015/10/21) 컬럼이 맞지않음
	var fileName = ladDetInfo["MODEL_IMAGE"];	// 실제 파일명
	
	this.FILE_MANAGER.download(fileSn, fileOrder, fileName);
}

/**
 * 파일업로드 파일 선택 이벤트 핸들러
 * @param fileFullName 선택 전체 파일명
 * @param type 실행구분(ExtFileUpload/ExtFileDownload)
 * @param fileFullName 선택 파일명
 * @return void
 */
this.fn_onFileSelected = function(type, fileFullName){
	if(type == this.FILE_MANAGER.TYPE_UPLOADER){
		var isNmArray = this.pmsUtil.isArray(fileFullName);
		if(isNmArray){
			// TODO - 본 화면은 단건 처리이므로 해당 없음.
		}else{
			this.ds_grid.setColumn(this.ds_grid.rowposition, "MODEL_IMAGE", fileFullName);	// 첨부된 파일 데이터 셋 입력 처리
			this.fn_setAtchFileView();		// 첨부파일 영역 처리
		}
	}
}

/**
 * 파일업로드 파일 업로드 성공 이벤트 핸들러
 * @param fileFullName 선택 전체 파일명
 * @param type 실행구분(ExtFileUpload/ExtFileDownload)
 * @param e 발생이벤트
 * @return void
 */
this.fn_onFileSuccess = function(type, e){
	if(type == this.FILE_MANAGER.TYPE_UPLOADER){
		this.fn_search();
	}
	if(type == this.FILE_MANAGER.TYPE_DOWNLOADER){
		alert("파일 다운로드 완료");
	}
}
 
 /**
 * 첨부파일 영역 처리
 */
this.fn_setAtchFileView = function(){

	// 첨부파일이 있으면 첨부파일의 검색버튼을 숨기고, 파일삭제, 파일보기 버튼 활성화 처리
	var atchPath = this.pmsUtil.getGridSelectedItem(this.grd_hw, "MODEL_IMAGE_FLTPH");		// 파일 경로(파일일련번호)
	var atchFile = this.pmsUtil.getGridSelectedItem(this.grd_hw, "MODEL_IMAGE");		// 파일명

	var hasAtchPath = this.comUtils.isNullEmpty(atchPath) ? false : true;
	var hasAtchFile = this.comUtils.isNullEmpty(atchFile) ? false : true;
	
	this.btn_atchFile.set_visible(!hasAtchFile);		 	// 파일검색
	//this.div_ladDetailInfo.fup_atchFile.set_visible(!hasAtchFile);	 	// 파일검색(업로드)
	//this.div_ladDetailInfo.edt_atchFile.set_visible(hasAtchFile);		 	// 파일정보
	
	this.btn_cancelAtchFile.set_visible(!hasAtchPath); 	// 파일 선택 취소
	if(!hasAtchPath){
		this.btn_cancelAtchFile.set_enable(hasAtchFile); // 파일 선택 취소
	}
	
	this.btn_delAtchFile.set_visible(hasAtchPath);	 	// 파일삭제
	this.btn_viewAtchFile.set_visible(hasAtchPath);	 	// 파일보기(다운로드)
}

this.fn_print = function()
{
	var vOpts = new this.cf_Opts();

	//this.div_work.div_4.div_1.cmb_SANCTN_FORM_SE
	var f_name = '/etc/itm/ITM020100.jrf';
	
	//var ds;
	//var ds_s;
	var sCols;
	var title = "장비목록";
	//ds = this.ds_ubiReport00;
	//ds_s = this.ds_detail;
	sCols = "SANCTN_SJ=SANCTN_SJ,"
		   +"SANCTN_ETC=SANCTN_ETC,"
		   +"SANCTN_CN=SANCTN_CN,"
	;
	//ds.clearData();
	//r = ds.addRow();
	//ds.copyRow(r, ds_s, ds_s.rowposition, sCols);

	vOpts.setToolbar(false);
	vOpts.setScale(100);
	vOpts.setArgs("title", title);
	vOpts.setArgs("user", "홍길동");
	vOpts.setReportPath(f_name);
	vOpts.setSaveFilename(title);
	vOpts.setLocalDs(["ds_detail", this.ds_detail]);	// 기성양식구분
	
	//trace('111111111111=='+this.ds_detail.saveXML());
	
	//trace('222222222222=='+this.ds.saveXML());
	
	var parm = {
		arg_0 : this,  //==> 필수, 팝업을 호출하는 form을 참조할 수 있도록 팝업에 Argument로 넘겨준다. (반드시 기술해야 함.)
		opts : vOpts
	};

	var fn_cb = function(sPopupId, sReturn) {
		trace('this.fn_print() - fn_cb');
	}

	this.gfn_popup("prjReportPouup", 884, 735, title, parm, "common::frmReportPopup.xfdl", fn_cb);
}

this.ds_detail_onvaluechanged = function(obj:Dataset,  e:nexacro.DSColChangeEventInfo)
{	
	if(e.columnid == 'SERVC_ENTRPS_CODE'){
		this.ds_it_emp.filter("SERVC_ENTRPS_CODE == '" + e.newvalue + "'");
	}
}

this.div_search_edt_modelNm_onkeyup = function(obj:Edit, e:nexacro.KeyEventInfo)
{
	if(e.keycode == 13) {
		this.fn_search();
	}
}

this.div_search_edt_serialNo_onkeyup = function(obj:Edit, e:nexacro.KeyEventInfo)
{
	if(e.keycode == 13) {
		this.fn_search();
	}
}



this.Button01_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	//this.fn_importExcel(this.ds_excel, this.grd_applcnt, 2);
	this.ds_detail.clearData();
	this.ds_excel.clearData();
	var fn_cb = function() {
 		var i = this.ds_excel.rowcount;
		for(var x=1 ; x <= i ; x++)
		{
			//if(1 > (parseInt(this.ds_excel.getColumn(x, 'Column0'))||0)) continue;
			var nRow = this.ds_detail.addRow();
			this.ds_detail.setColumn( nRow , "MODEL_NO" , this.ds_grid.getColumn( this.ds_grid.rowposition , "MODEL_NO"));
			this.ds_detail.copyRow( nRow  , this.ds_excel , x , 
			 'EQPMN_NO=Column0,'
			+'EQPMN_INDC_DT=Column1,'
			+'EQPMN_INDC_AMOUNT=Column2,'
			);
		}	
	};

	var arg = {
		targetDs : this.ds_excel,
		headSet : false,
 		callBack : fn_cb
	};
	
	this.gfn_importExcel(arg);
}



/*
 * 함수명  	: Button12_onclick
 * 설명 		: 장비목록 양식 다운로드
 * 작성자 		: 김선진
 */
this.Button12_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	//trace("11111");
	this.gfn_exportExcel(this.Grid02, "exceldown");	
}



/*
 * 함수명  	: fn_popupCallBack
 * 설명 		: Popup Callback 처리 (장비관리)
 * params  		: sPopupId : 팝업 ID
 *                sReturn  : 팝업 처리 결과(dataset.saveXML())
 * return Type 	: None
 * 작성자 		: 김선진
 */
this.fn_popupCallBack = function(sPopupId, sReturn)
{


	//장비목록
	if(sPopupId == "Popup1") {
		var ds_ITEmpCode = new Dataset();
		var loadCnt = ds_ITEmpCode.loadXML(sReturn);

		if(loadCnt) {
			var ServcNm   = ds_ITEmpCode.getColumn(0, "ENTRPS_NM");
			var EmpNm     = ds_ITEmpCode.getColumn(0, "IT_EMP_NM");

			var a   = ds_ITEmpCode.getColumn(0, "SERVC_ENTRPS_CODE");
			var b   = ds_ITEmpCode.getColumn(0, "IT_EMP");				
			
			var euRow     = this.ds_detail.rowposition;
			
			this.ds_detail.setColumn(euRow, "SERVC_ENTRPS_CODE_NM",   ServcNm  );
			this.ds_detail.setColumn(euRow, "IT_EMP_NM",   EmpNm  );
			
			this.ds_detail.setColumn(euRow, "SERVC_ENTRPS_CODE" , a);
			this.ds_detail.setColumn(euRow, "IT_EMP" , b);			
		}

	}
	
	
	//장비계약이력
	if(sPopupId == "Popup2") {
		var ds_ITEmpCode = new Dataset();
		var loadCnt = ds_ITEmpCode.loadXML(sReturn);

		if(loadCnt) {
			var ServcNm   = ds_ITEmpCode.getColumn(0, "ENTRPS_NM");
			var EmpNm     = ds_ITEmpCode.getColumn(0, "IT_EMP_NM");

			var a   = ds_ITEmpCode.getColumn(0, "SERVC_ENTRPS_CODE");
			var b   = ds_ITEmpCode.getColumn(0, "IT_EMP");				
			
			var euRow     = this.ds_hist.rowposition;
			
			this.ds_hist.setColumn(euRow, "SERVC_ENTRPS_CODE_NM",   ServcNm  );
			this.ds_hist.setColumn(euRow, "IT_EMP_NM",   EmpNm  );
			
			this.ds_hist.setColumn(euRow, "SERVC_ENTRPS_CODE" , a);
			this.ds_hist.setColumn(euRow, "IT_EMP" , b);			
		}
	}
}



/*
 * 함수명  	: grd_onexpandup
 * 설명 		: 장비목록에서 직원 팝업창 띄우기
 * 작성자 		: 김선진
 */
this.grd_onexpandup = function(obj:Grid, e:nexacro.GridMouseEventInfo)
{
	// 장비목록 -> 직원
	if(e.col == '5') {
		this.gfn_popup("Popup1", 400, 400, "", {sport_stle:"%"}, "etc_itm::ITM020100_P01.xfdl", "fn_popupCallBack", true);
	}
		
}



/*
 * 함수명  	: Grid00_onexpandup
 * 설명 		: 장비계약이력에서 직원 팝업창 띄우기
 * 작성자 		: 김선진
 */
this.Grid00_onexpandup = function(obj:Grid, e:nexacro.GridMouseEventInfo)
{
	if(e.col == '2') {
		this.gfn_popup("Popup2", 400, 400, "", {sport_stle:"%"}, "etc_itm::ITM020100_P01.xfdl", "fn_popupCallBack", true);
	}
}
]]></Script>
  </Form>
</FDL>
