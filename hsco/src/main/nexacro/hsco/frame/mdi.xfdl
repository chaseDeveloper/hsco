<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="mdi" classname="mdi" left="0" top="0" width="1074" height="34" titletext="MDI Tab" scrollbars="none" oninit="mdiFrame_oninit">
    <Layouts>
      <Layout>
        <Static id="sta_mdiBg" taborder="8" left="0" top="0" height="34" cssclass="sta_MDI_Bg" right="0"/>
        <Button id="btn_arrgMax" taborder="0" top="7" width="20" height="20" cssclass="btn_MDI_Arrgmax" right="167" onclick="btn_arrgMax_onclick" tooltiptext="창 최대화"/>
        <Tab id="tab_mdi" taborder="1" left="0" top="0" height="34" tabindex="0" scrollbars="autoboth" cssclass="tab_MDI_Mdi" style="showextrabutton:true;" onchanged="tab_mdi_onchanged" onextrabuttonclick="tab_mdi_onextrabuttonclick" right="198">
          <Tabpages>
          </Tabpages>
        </Tab>
        <Static id="sta_btnLine04" taborder="3" top="13" width="1" height="8" cssclass="sta_MDI_BtnLine" right="70"/>
        <Button id="btn_arrgCascd" taborder="4" top="7" width="20" height="20" cssclass="btn_MDI_Arrgcascd" right="136" onclick="btn_arrgCascd_onclick" tooltiptext="계단 정렬"/>
        <Button id="btn_mdiArrgV" taborder="5" top="7" width="20" height="20" cssclass="btn_MDI_ArrgV" right="105" onclick="btn_mdiArrgV_onclick" tooltiptext="가로 정렬"/>
        <Button id="btn_mdiArrgH" taborder="6" top="7" width="20" height="20" cssclass="btn_MDI_ArrgH" right="75" onclick="btn_mdiArrgH_onclick" tooltiptext="세로 정렬"/>
        <Button id="btn_arrgClsAll" taborder="7" top="7" width="20" height="20" cssclass="btn_MDI_Arrgclsall" right="45" onclick="btn_arrgClsAll_onclick" tooltiptext="모두 닫기"/>
        <Static id="sta_btnLine02" taborder="10" cssclass="sta_MDI_BtnLine" top="13" width="1" height="8" right="130"/>
        <Static id="sta_btnLine01" taborder="11" cssclass="sta_MDI_BtnLine" top="13" width="1" height="8" right="161"/>
        <Static id="sta_btnLine00" taborder="12" cssclass="sta_MDI_BtnLine" top="13" width="1" height="8" right="192"/>
        <Static id="sta_btnLine03" taborder="13" cssclass="sta_MDI_BtnLine" top="13" width="1" height="8" right="100"/>
        <Button id="btn_mdiSpinUp" taborder="14" cssclass="btn_MDI_SpinUp" top="7" width="20" height="20" right="209" onclick="btn_mdiSpinUp_onclick"/>
        <Button id="btn_mdiSpinDown" taborder="15" cssclass="btn_MDI_SpinDown" top="7" width="20" height="20" right="195" onclick="btn_mdiSpinDown_onclick"/>
        <Tab id="Tab01" taborder="16" left="0" top="72" width="900" height="34" tabindex="0" scrollbars="autoboth" cssclass="tab_MDI_Mdi" visible="false" style="showextrabutton:true;" enable="true">
          <Tabpages>
            <Tabpage id="tabpage1" text="tabpage1"/>
            <Tabpage id="tabpage2" text="tabpage2"/>
            <Tabpage id="tabpage3" text="tabpage3"/>
            <Tabpage id="tabpage4" text="tabpage4"/>
            <Tabpage id="tabpage5" text="tabpage5"/>
          </Tabpages>
        </Tab>
        <Button id="btn_mdiDocument" taborder="17" cssclass="btn_MDI_Document" top="7" width="20" height="20" right="15" tooltiptext="사용설명서" onclick="btn_mdiDocument_onclick"/>
        <Static id="sta_btnLine05" taborder="18" cssclass="sta_MDI_BtnLine" top="13" width="1" height="8" right="40"/>
        <Tab id="Tab00" taborder="19" left="570" top="208" width="459" height="173" tabindex="0" scrollbars="autoboth" cssclass="tab_MDI_Mdi" style="buttonbackground:@gradation;">
          <Tabpages>
            <Tabpage id="tabpage1" text="tabpage1"/>
            <Tabpage id="tabpage2" text="tabpage2"/>
            <Tabpage id="tabpage3" text="tabpage3"/>
          </Tabpages>
        </Tab>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_condMfile" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="JOB_SE" type="STRING" size="256"/>
          <Column id="VER" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="VER">1</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_menualFile" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="JOB_SE" type="STRING" size="256"/>
          <Column id="SN" type="STRING" size="256"/>
          <Column id="MANUAL_PROCESS_DTLS" type="STRING" size="256"/>
          <Column id="MANUAL_VER" type="STRING" size="256"/>
          <Column id="MANUAL_ATCH_FILE" type="STRING" size="256"/>
          <Column id="MANUAL_ATCH_FLTPH" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_subMenuUseFindMenu" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="MENU_ORDR_MAX" type="bigdecimal" size="16"/>
          <Column id="MENU_OPTP" type="string" size="32"/>
          <Column id="PAGE_URL" type="string" size="32"/>
          <Column id="INQIRE_AUTH" type="string" size="32"/>
          <Column id="UPPER_MENU" type="bigdecimal" size="16"/>
          <Column id="UPDT_AUTH" type="string" size="32"/>
          <Column id="MENU_NM" type="string" size="32"/>
          <Column id="MENU_LVL" type="bigdecimal" size="16"/>
          <Column id="MENU_AUTH" type="string" size="32"/>
          <Column id="MENU_ID" type="bigdecimal" size="16"/>
          <Column id="SYS_SE_CODE" type="string" size="32"/>
          <Column id="MENU_GRP" type="bigdecimal" size="16"/>
          <Column id="DEL_AUTH" type="string" size="32"/>
          <Column id="PAGE_NM" type="string" size="32"/>
          <Column id="PAGE_ID" type="string" size="32"/>
          <Column id="MENU_PARAMTR" type="string" size="32"/>
          <Column id="MENU_STTUS" type="string" size="32"/>
          <Column id="ADD_AUTH" type="string" size="32"/>
          <Column id="PRINT_AUTH" type="string" size="32"/>
          <Column id="MENU_ORDR" type="bigdecimal" size="16"/>
          <Column id="JOB_SE" type="STRING" size="3"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript5.0"><![CDATA[/***********************************************************************
 * 화면ID   : mdi Frame
 * 화면명   : MDI Frame (Tab MDI Frame) 화면
 * 화면설명 : 
 * 작성일   : 2015.08.13
 * 작성자   : 송금준
 * 수정이력 : 
 ***********************************************************************
 *     수정일     수정자   내용
 ***********************************************************************
 *
 ***********************************************************************
 */

/***********************************************************************
 * Script Include 
 ***********************************************************************/
//include "lib::comInclude.xjs";
include "lib::comForm.xjs";
include "lib::comUtil.xjs";
include "lib::comLib.xjs";

/***********************************************************************
 * 화면 변수 선언부
 ***********************************************************************/
this.fv_strTpg = "";
this.FILE_MANAGER = null;
/***********************************************************************
 * non-Transaction 관련 컴포넌트 이벤트 처리 함수
 ***********************************************************************/
this.mdiFrame_oninit = function(obj:Form, e:nexacro.InitEventInfo){
	//Form 초기화
	//this.gfn_initForm(this);
	this.ds_subMenuUseFindMenu.clearData();
}

this.tab_mdi_onchanged = function(obj:Tab, e:nexacro.TabIndexChangeEventInfo){
	//change top, left menu
	if(this.ds_subMenuUseFindMenu.rowcount==0){
		this.ds_subMenuUseFindMenu.copyData(application.gv_topFrame.form.ds_subMenu);
		this.ds_subMenuUseFindMenu.filter("");
	}
	
	var strSubMenuId = application.gds_openMenu.getColumn(e.postindex, "MENU_GRP");
	var strSubMenuRow = this.ds_subMenuUseFindMenu.findRow("MENU_ID",strSubMenuId+"");
	var strSysSeCode = application.gds_openMenu.getColumn(e.postindex, "SYS_SE_CODE");
	var strMenuId = application.gds_openMenu.getColumn(e.postindex, "MENU_ID");
	var strFormId = strSysSeCode + "_" + strMenuId;
	
	if(strSubMenuRow!=-1){
		var strTopMenuId = this.ds_subMenuUseFindMenu.getColumn(strSubMenuRow,"UPPER_MENU");
		application.gv_topFrame.form.btnMenu_onclick(application.gv_topFrame.form.div_topMenu["btn_mnu"+strTopMenuId]);
		application.gv_topFrame.form.btnSubMenu_onclick(application.gv_topFrame.form.div_topSubMenu["btn_subMnu"+strSubMenuId]);
		
		var leftMenuRow = application.gv_menuFrame.form.ds_menu.findRow("MENU_ID",strMenuId);
		application.gv_menuFrame.form.ds_menu.set_rowposition(leftMenuRow);
	}

	var obj = application.gv_formFrameSet.frames[strFormId];
	if(typeof obj != "undefined") {
		obj.setFocus(true); 
	}
	application.gv_preFormId = application.gv_curFormId;
	application.gv_curFormId = strFormId;
}

this.tab_mdi_onextrabuttonclick = function(obj:Tab, e:nexacro.TabMouseEventInfo) 
{
	var strFormId = obj.tabpages[e.index].name;

	this.gfn_removeForm(e.index, strFormId);
// 	obj.removeTabpage(e.index);
}

this.btn_arrgMax_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	application.gv_arrangeType = "maximize";
// 	application.gv_formFrameSet.arrange("maximize");
	
	for(var i = 0; i < application.gv_formFrameSet.frames.length; i++)
	{
		var objFrame = application.gv_formFrameSet.frames[i];
		
		this.gfn_changeFrameStyle(objFrame, "maximize");
		objFrame.form.div_workFrame.resetScroll();
	}

	application.gv_formFrameSet.frames[application.gv_curFormId].setFocus();
}

this.btn_arrgCascd_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	application.gv_formFrameSet.arrange("cascade");
	application.gv_arrangeType = "cascade";
	
	for(var i = 0; i < application.gv_formFrameSet.frames.length; i++)
	{
		var objFrame = application.gv_formFrameSet.frames[i];
		
		this.gfn_changeFrameStyle(objFrame, "normal");
		objFrame.form.div_workFrame.resetScroll();
	}

	this.gfn_decorateTitleBar(application.gv_formFrameSet.frames[application.gv_curFormId]);
	application.gv_formFrameSet.frames[application.gv_curFormId].setFocus();
}

this.btn_mdiArrgV_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	application.gv_formFrameSet.arrange("tilevertical");
	application.gv_arrangeType = "tilevertical";
	
	for(var i = 0; i < application.gv_formFrameSet.frames.length; i++)
	{
		var objFrame = application.gv_formFrameSet.frames[i];
		
		this.gfn_changeFrameStyle(objFrame, "normal");
		objFrame.form.div_workFrame.resetScroll();
	}
	
	this.gfn_decorateTitleBar(application.gv_formFrameSet.frames[application.gv_curFormId]);
	application.gv_formFrameSet.frames[application.gv_curFormId].setFocus();
}

this.btn_mdiArrgH_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	application.gv_formFrameSet.arrange("tilehorizontal");
	application.gv_arrangeType = "tilehorizontal";
	
	for(var i = 0; i < application.gv_formFrameSet.frames.length; i++)
	{
		var objFrame = application.gv_formFrameSet.frames[i];
		
		this.gfn_changeFrameStyle(objFrame, "normal");
		objFrame.form.div_workFrame.resetScroll();
	}

	this.gfn_decorateTitleBar(application.gv_formFrameSet.frames[application.gv_curFormId]);
	application.gv_formFrameSet.frames[application.gv_curFormId].setFocus();
}

this.btn_arrgClsAll_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(!confirm("화면을 모두 닫으시겠습니까?"))
	{
		return;
	}
	
	for(var i = application.gds_openMenu.rowcount - 1; i >= 0; --i)
	{
		var strFormId = this.tab_mdi.tabpages[i].name;

		this.gfn_removeForm(i, strFormId);
// 		this.tab_mdi.removeTabpage(i);
	}
	
	application.gds_openMenu.clearData();
	application.gv_curFormId = "";
	application.gv_preFormId = "";
}

this.btn_mdiSpinUp_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.tab_mdi.spinupbutton.click();
}

this.btn_mdiSpinDown_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.tab_mdi.spindownbutton.click();
}

/***********************************************************************
* 사용자 정의 함수
************************************************************************/
/*
 * 함수명  	: fn_addMenu
 * 설명 		: 메뉴를 Tab에 추가한다.
 * params  		: menuId - 메뉴 아이디, menuNm - 메뉴명, sysSeCode - 시스템 구분
 * return Type 	: None
 * 사용법		:
 */
this.fn_addMenu = function (menuId, menuNm, sysSeCode)
{
	var strTpgId = sysSeCode + "_" + menuId;
	
	this.tab_mdi.insertTabpage(strTpgId, this.tab_mdi.getTabpageCount(), "", menuNm);
}




// 메뉴얼 파일다운
this.btn_mdiDocument_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{ 	
  	
  	
  	 var menu_id = application.gv_lvl0MenuId; // 상위메뉴별로 사용설명서 다운
   
     
     this.ds_condMfile.setColumn(0, "JOB_SE",menu_id);
  
     this.ds_menualFile.clearData();
    
            var strSvcId        = "selectList1";
            var sController		= "/hsco/etc/itm/ITM050400/ITM050400DetailList.do";
			var sInDatasets		= "input1=ds_condMfile";
			var sOutDatasets	= "ds_menualFile=output1"; 
    
     Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets, null, null, null);
}


this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg)
{
	var fileConfig = {
		onChange: this.fn_onFileSelected,
		onSuccess : this.fn_onFileSuccess
	};
	
	this.FILE_MANAGER = new this.fileManager(this, "SYS", "COM");
	this.FILE_MANAGER.init(fileConfig);	
	
	var fileSn = this.ds_menualFile.getColumn(0,"MANUAL_ATCH_FLTPH");
	var fileOrder = "1";
	var fileName  = this.ds_menualFile.getColumn(0,"MANUAL_ATCH_FILE");
  
	this.FILE_MANAGER.download(fileSn, fileOrder, fileName);
}

]]></Script>
  </Form>
</FDL>
