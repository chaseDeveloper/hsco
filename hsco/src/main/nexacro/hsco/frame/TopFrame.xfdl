<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="TopFrame" classname="TopFrame" left="0" top="0" width="1264" height="99" titletext="Top" oninit="TopFrame_oninit" onload="TopFrame_onload" onsize="TopFrame_onsize" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="sta_bg" taborder="0" left="0" top="0" height="99" cssclass="sta_TF_Bg" right="0" style="linespace:3;background:@gradation;"/>
        <Static id="sta_logoBg" taborder="4" cssclass="sta_TF_Logobg" left="0" top="3" width="190" height="93"/>
        <Static id="Static00" taborder="45" left="0" top="59" style="background:#343e48ff;border:2 solid #d6272eff,1 solid #343e48ff,0 none #808080ff,1 solid #343e48ff;" right="0" height="40"/>
        <Static id="sta_logo" taborder="3" left="199" top="189" width="160" height="70" cssclass="sta_TF_Logo" style="background:URL('theme://images/sta_TF_HS_Logo.png') left middle;"/>
        <Button id="Button03" taborder="11" text="예산" cssclass="btn_TF_Menu01S" left="220" top="278" width="66" height="30" visible="false"/>
        <Button id="Button02" taborder="12" text="회계" cssclass="btn_TF_Menu01" left="286" top="278" width="66" height="30" visible="false"/>
        <Button id="Button04" taborder="13" text="자금" cssclass="btn_TF_Menu01" left="352" top="278" width="66" height="30" visible="false"/>
        <Button id="Button05" taborder="14" text="인사" cssclass="btn_TF_Menu01" left="418" top="278" width="66" height="30" visible="false"/>
        <Button id="Button06" taborder="15" text="급여" cssclass="btn_TF_Menu01" left="484" top="278" width="66" height="30" visible="false"/>
        <Button id="Button07" taborder="16" text="총무" cssclass="btn_TF_Menu01" left="550" top="278" width="66" height="30" visible="false"/>
        <Button id="Button08" taborder="17" text="자산" cssclass="btn_TF_Menu01" left="723" top="278" width="66" height="30" visible="false"/>
        <Button id="Button09" taborder="18" text="예산" cssclass="btn_TF_Menu01" left="789" top="278" width="66" height="30" visible="false"/>
        <Button id="Button10" taborder="19" text="회계" cssclass="btn_TF_Menu01" left="855" top="278" width="66" height="30" visible="false"/>
        <Button id="Button11" taborder="20" text="자금" cssclass="btn_TF_Menu01" left="921" top="278" width="66" height="30" visible="false"/>
        <Button id="Button12" taborder="21" text="인사" cssclass="btn_TF_Menu01" left="987" top="278" width="66" height="30" visible="false"/>
        <Button id="Button13" taborder="22" text="급여" cssclass="btn_TF_Menu01" left="1053" top="278" width="66" height="30" visible="false"/>
        <Button id="Button15" taborder="24" text="급여/계약" cssclass="btn_TF_Menu01" left="616" top="278" width="107" height="30" visible="false"/>
        <Button id="Button16" taborder="27" text="구매/계약" cssclass="btn_TF_Menu01" left="1119" top="278" width="104" height="30" visible="false"/>
        <Button id="Button14" taborder="29" text="기준정보" left="223" top="334" width="92" height="25" cssclass="btn_TF_Menu02" visible="false"/>
        <Button id="Button17" taborder="30" text="계좌관리" left="318" top="334" width="92" height="25" cssclass="btn_TF_Menu02S" visible="false"/>
        <Button id="Button18" taborder="31" text="카드관리" left="412" top="334" width="92" height="25" cssclass="btn_TF_Menu02" visible="false"/>
        <Button id="Button19" taborder="32" text="결의서관리" left="506" top="334" width="108" height="25" cssclass="btn_TF_Menu02" visible="false"/>
        <Button id="Button20" taborder="33" text="전표관리" left="613" top="334" width="92" height="25" cssclass="btn_TF_Menu02" visible="false"/>
        <Button id="Button21" taborder="34" text="장부관리" left="707" top="334" width="92" height="25" cssclass="btn_TF_Menu02" visible="false"/>
        <Button id="Button22" taborder="35" text="세무관리" left="801" top="334" width="92" height="25" cssclass="btn_TF_Menu02" visible="false"/>
        <Button id="Button23" taborder="36" text="결산관리" left="895" top="334" width="92" height="25" cssclass="btn_TF_Menu02" visible="false"/>
        <Div id="div_topMenu" taborder="37" left="220" top="13" height="56" scrollbars="autohorz" right="40">
          <Layouts>
            <Layout>
              <Button id="Button06" taborder="4" text="급여" cssclass="btn_TF_Menu01" left="384" top="1" width="66" height="30" style="color:#ffffffff;"/>
              <Button id="Button07" taborder="5" text="총무" cssclass="btn_TF_Menu01" left="480" top="1" width="66" height="30"/>
              <Button id="Button15" taborder="6" text="급여/계약" cssclass="btn_TF_Menu01" left="576" top="1" width="107" height="30"/>
              <Button id="Button08" taborder="7" text="자산" cssclass="btn_TF_Menu01" left="713" top="1" width="66" height="30"/>
              <Button id="Button09" taborder="8" text="예산" cssclass="btn_TF_Menu01" left="809" top="1" width="66" height="30"/>
              <Button id="Button10" taborder="9" text="회계" cssclass="btn_TF_Menu01" left="905" top="1" width="66" height="30"/>
              <Button id="Button11" taborder="10" text="자금" cssclass="btn_TF_Menu01" left="1001" top="1" width="66" height="30"/>
              <Button id="Button12" taborder="11" text="인사" cssclass="btn_TF_Menu01" left="1097" top="1" width="66" height="30"/>
              <Button id="Button13" taborder="12" text="급여" cssclass="btn_TF_Menu01" left="1193" top="1" width="66" height="30"/>
              <Button id="Button16" taborder="13" text="구매/계약" cssclass="btn_TF_Menu01" left="1289" top="1" width="104" height="30"/>
              <Button id="Button03" taborder="0" text="예산" cssclass="btn_TF_Menu01S" left="0" top="1" width="66" height="30"/>
              <Button id="Button02" taborder="1" text="회계" cssclass="btn_TF_Menu01" left="96" top="1" width="66" height="30" style="color:#ffffffff;"/>
              <Button id="Button04" taborder="2" text="자금" cssclass="btn_TF_Menu01" left="192" top="1" width="66" height="30" style="color:#ffffffff;"/>
              <Button id="Button05" taborder="3" text="인사" cssclass="btn_TF_Menu01" left="288" top="1" width="66" height="30" style="color:#ffffffff;"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="div_topSubMenu" taborder="38" left="247" top="61" height="51" scrollbars="autohorz" right="64" style="background:transparent;">
          <Layouts>
            <Layout>
              <Button id="Button20" taborder="4" text="전표관리" cssclass="btn_TF_Menu02" left="390" top="1" width="92" height="25" style="color:#d1d1d1ff;"/>
              <Button id="Button21" taborder="5" text="장부관리" cssclass="btn_TF_Menu02" left="484" top="1" width="92" height="25" style="color:#d1d1d1ff;"/>
              <Button id="Button22" taborder="6" text="세무관리" cssclass="btn_TF_Menu02" left="578" top="1" width="92" height="25" style="color:#d1d1d1ff;"/>
              <Button id="Button23" taborder="7" text="결산관리" cssclass="btn_TF_Menu02" left="672" top="1" width="92" height="25" style="color:#d1d1d1ff;"/>
              <Button id="Button14" taborder="0" text="기준정보" cssclass="btn_TF_Menu02" left="0" top="1" width="92" height="25" style="color:#d1d1d1ff;"/>
              <Button id="Button17" taborder="1" text="계좌관리" cssclass="btn_TF_Menu02S" left="95" top="1" width="92" height="25" style="color:#ffc238ff;"/>
              <Button id="Button18" taborder="2" text="카드관리" cssclass="btn_TF_Menu02" left="189" top="1" width="92" height="25" style="color:#d1d1d1ff;" onclick="div_topSubMenu_Button18_onclick"/>
              <Button id="Button19" taborder="3" text="결의서관리" cssclass="btn_TF_Menu02" left="283" top="1" width="108" height="25" style="color:#d1d1d1ff;"/>
            </Layout>
          </Layouts>
        </Div>
        <Button id="btn_prevSubMenu" taborder="41" cssclass="btn_TF_Prev2" left="206" top="66" width="17" height="18" onclick="btn_prevSubMenu_onclick"/>
        <Button id="btn_nextSubMenu" taborder="42" cssclass="btn_TF_Next2" top="66" width="17" height="18" right="20" onclick="btn_nextSubMenu_onclick"/>
        <Button id="btn_prevMenu" taborder="7" left="199" top="14" width="30" height="30" cssclass="btn_TF_Prev" onclick="btn_prevMenu_onclick"/>
        <Button id="btn_nextMenu" taborder="8" cssclass="btn_TF_Next" top="14" width="30" height="30" onclick="btn_nextMenu_onclick" right="12"/>
        <Button id="btn_logout" taborder="46" text="로그아웃" onclick="btn_logout_onclick" cssclass="btn_TF_Logout" bottom="11" width="71" height="21" style="font:8 arial bold;" left="93"/>
        <ImageViewer id="ImageViewer00" taborder="47" image="URL('theme://images/sta_TF_HS_Logo.png')" stretch="fit" left="17" top="5" width="151" height="50" style="background:transparent;border:1 none #808080ff ;"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_menu" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="MENU_ORDR_MAX" type="bigdecimal" size="16"/>
          <Column id="MENU_OPTP" type="string" size="32"/>
          <Column id="PAGE_URL" type="string" size="32"/>
          <Column id="INQIRE_AUTH" type="string" size="32"/>
          <Column id="UPPER_MENU" type="bigdecimal" size="16"/>
          <Column id="UPDT_AUTH" type="string" size="32"/>
          <Column id="MENU_NM" type="string" size="32"/>
          <Column id="MENU_LVL" type="bigdecimal" size="16"/>
          <Column id="MENU_AUTH" type="string" size="32"/>
          <Column id="MENU_ID" type="bigdecimal" size="16"/>
          <Column id="SYS_SE_CODE" type="string" size="32"/>
          <Column id="MENU_GRP" type="bigdecimal" size="16"/>
          <Column id="DEL_AUTH" type="string" size="32"/>
          <Column id="PAGE_NM" type="string" size="32"/>
          <Column id="PAGE_ID" type="string" size="32"/>
          <Column id="MENU_PARAMTR" type="string" size="32"/>
          <Column id="MENU_STTUS" type="string" size="32"/>
          <Column id="ADD_AUTH" type="string" size="32"/>
          <Column id="PRINT_AUTH" type="string" size="32"/>
          <Column id="MENU_ORDR" type="bigdecimal" size="16"/>
          <Column id="JOB_SE" type="STRING" size="3"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_subMenu" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="MENU_ORDR_MAX" type="bigdecimal" size="16"/>
          <Column id="MENU_OPTP" type="string" size="32"/>
          <Column id="PAGE_URL" type="string" size="32"/>
          <Column id="INQIRE_AUTH" type="string" size="32"/>
          <Column id="UPPER_MENU" type="bigdecimal" size="16"/>
          <Column id="UPDT_AUTH" type="string" size="32"/>
          <Column id="MENU_NM" type="string" size="32"/>
          <Column id="MENU_LVL" type="bigdecimal" size="16"/>
          <Column id="MENU_AUTH" type="string" size="32"/>
          <Column id="MENU_ID" type="bigdecimal" size="16"/>
          <Column id="SYS_SE_CODE" type="string" size="32"/>
          <Column id="MENU_GRP" type="bigdecimal" size="16"/>
          <Column id="DEL_AUTH" type="string" size="32"/>
          <Column id="PAGE_NM" type="string" size="32"/>
          <Column id="PAGE_ID" type="string" size="32"/>
          <Column id="MENU_PARAMTR" type="string" size="32"/>
          <Column id="MENU_STTUS" type="string" size="32"/>
          <Column id="ADD_AUTH" type="string" size="32"/>
          <Column id="PRINT_AUTH" type="string" size="32"/>
          <Column id="MENU_ORDR" type="bigdecimal" size="16"/>
          <Column id="JOB_SE" type="STRING" size="3"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript5.0"><![CDATA[/***********************************************************************
 * 화면ID   : TopFrame
 * 화면명   : Top Frame 화면
 * 화면설명 : 
 * 작성일   : 2015.08.12
 * 작성자   : 송금준
 * 수정이력 : 
 ***********************************************************************
 *     수정일     수정자   내용
 ***********************************************************************
 * 
 ***********************************************************************
 */

/***********************************************************************
 * Script Include 
 ***********************************************************************/
//include "lib::comInclude.xjs";
include "lib::comUtil.xjs";
include "lib::comLib.xjs";

/***********************************************************************
 * 화면 변수 선언부
 ***********************************************************************/
this.fv_strMenuName = "btn_mnu";
this.fv_strSubMenuName = "btn_subMnu";
this.fv_prevMenuBtn = undefined;
this.fv_currMenuBtn = undefined;
this.fv_prevSubMenuBtn = undefined;
this.fv_currSubMenuBtn = undefined;
this.fv_lvl0MenuId = "";
this.fv_lvl1MenuId = "";
this.hscrollWidth = 1004;
this.hscrollSubWidth = 953;  // 953,200

/***********************************************************************
 * onInit / onLoad 영역
 ***********************************************************************/
this.TopFrame_oninit = function(obj:Form, e:nexacro.InitEventInfo)
{
	// Form 초기화
	this.fn_init_form();

	// DataSet 초기화
	this.fn_init_dataset();
}

this.TopFrame_onload = function(obj:Form, e:nexacro.LoadEventInfo) 
{
	// 전체 메뉴 불러오기
	this.gfn_loadMenu();
    //this.focus_TopMenu();
	//this.gfn_loadMyMenu();
}

/***********************************************************************
 * Form/Dataset 오브젝트 초기화
 ***********************************************************************/
/*
 * 함수명  	: initForm
 * 설명 		: Form을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_init_form();
 */
this.fn_init_form = function()
{
	// 시스템 공통으로 Form을 Initialize 한다.
	//this.gfn_initForm(this);

	this.fn_clearMenuButtons(this.div_topMenu);
	this.fn_clearMenuButtons(this.div_topSubMenu);
}

/*
 * 함수명  	: fn_clearMenuButtons
 * 설명 		: 그려진 버튼을 없앤다.
 * params  		: div - Division
 * return Type 	: None
 * 사용법		: this.fn_clearMenuButtons(this.div_topMenu);
 */
this.fn_clearMenuButtons = function (div : Div)
{
	var comps = div.components;
	var obj;
	
	for(var i = comps.length - 1; i >= 0; --i)
	{
		obj = comps[i];
		
		div.removeChild(obj.name);
		obj.destroy();
		obj = null;
	}
}

/*
 * 함수명  	: initDataset
 * 설명 		: Dataset을 초기화한다.
 *                주로, 조건 Dataset들(ds_cond, ds_cond_00, ds_cond_01, ...) 을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_init_dataset();
 */
this.fn_init_dataset = function()
{
	this.ds_menu.clearData();
	this.ds_subMenu.clearData();
}

/***********************************************************************
* Inspection 영역
************************************************************************/

/***********************************************************************
* Transaction 영역 시작
************************************************************************/

/***********************************************************************
* Transaction 영역 끝
************************************************************************/

/***********************************************************************
 * non-Transaction 관련 컴포넌트 이벤트 처리 함수
 ***********************************************************************/
this.btn_prevMenu_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.div_topMenu.hscrollbar.set_pos(parseInt(this.div_topMenu.hscrollbar.pos) - this.hscrollWidth);
}

this.btn_nextMenu_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.div_topMenu.hscrollbar.set_pos(parseInt(this.div_topMenu.hscrollbar.pos) + this.hscrollWidth);
}

this.btn_prevSubMenu_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.div_topSubMenu.hscrollbar.set_pos(parseInt(this.div_topSubMenu.hscrollbar.pos) - this.hscrollSubWidth);
}

this.btn_nextSubMenu_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.div_topSubMenu.hscrollbar.set_pos(parseInt(this.div_topSubMenu.hscrollbar.pos) + this.hscrollSubWidth);
}

this.TopFrame_onsize = function(obj:Form, e:nexacro.SizeEventInfo)
{
	this.div_topMenu.resetScroll();
	this.div_topSubMenu.resetScroll();
	
	this.div_topMenu.hscrollbar.set_visible(false);
	this.div_topSubMenu.hscrollbar.set_visible(false);
// 
// 	if(obj.width < 1264)
// 	{
// 		obj.set_width(1264);
// 	}
}

this.btn_logout_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var sSvcID        	= "logout";
	var sController   	= "svcurl::/logout.do";
	var sInDatasets   	= "";
	var sOutDatasets  	= "";
	var sArgs = "V_USER_ID='" + application.gv_userId

	this.transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs, "_logoutCallBack");
}
 
this._logoutCallBack = function (sid, errNo, errMsg) {
	if(errNo < 0)
	{
        if(errMsg == "err.SSO로그아웃.실패"){
            this.alert("SSO로그아웃이 실패하였습니다.");
            replacePage("/index.jsp");
        } else if(errMsg == "err.예외상황.발생") {
            this.alert("예외상황이 발생하였습니다.");  
            replacePage("/index.jsp"); 
        } 
	} else {
	    this.alert("정상적으로 로그아웃되었습니다.");  
	    if (this.gfn_getEmpNo() != ""){ 
	       window.open("about:blank","_self").close(); // 로그아웃시 창을 닫는다.
	    }else{ 
	       replacePage("/index.jsp"); 
	    } // 사번이 없는 경우에는 포털 사이트에서 로그인을 할수 있는 사용자가 아니라서 index페이지로 이동한다.
	}
}
/***********************************************************************
* 사용자 정의 함수
************************************************************************/
/*
 * 함수명  	: fn_fillMenu
 * 설명 		: Menu를 채운다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_fillMenu();
 */
this.fn_fillMenu = function ()
{
	application.gds_menu.filter("MENU_LVL==0 && MENU_NM != 'DEFAULT'"); //내부결재 메뉴는 상단에서 제외.
	this.ds_menu.copyData(application.gds_menu, true);

	application.gds_menu.filter("");
	application.gds_menu.filter("MENU_LVL==1");
	this.ds_subMenu.copyData(application.gds_menu, true);
}

/*
 * 함수명  	: fn_drawMenu
 * 설명 		: Menu를 그린다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_drawMenu();
 */
this.fn_drawMenu = function ()
{
	var nT = 1;
	var nL = 0;
	var nW = 10; 
	var nH = 30;
	var nM = 60; // 메뉴 간 간격(40->20)
	
	var strText;
	var strMenuId;
	var arrSize;
	var objFirst;
	var btnMenuPos = 0;
	
	for(i = 0; i < this.ds_menu.rowcount; i++)
	{
		var obj = new Button();
		strText = this.ds_menu.getColumn(i, "MENU_NM");
		strMenuId = this.ds_menu.getColumn(i, "MENU_ID");

		obj.init(this.fv_strMenuName + strMenuId.toString(), "absolute", nL, nT, nW, nH, null, null);
		obj.set_text(strText);

		obj.set_cssclass("btn_TF_Menu01");
		obj.set_left(nL);

		arrSize = this.comUtils.getTextSize(obj.text, obj);
		nW = parseInt(arrSize[0]) + nM;
		nL += nW;
		obj.set_width(nW);

		obj.addEventHandler("onclick", this.btnMenu_onclick, this);
		obj.addEventHandler("onkillfocus", this.btnMenu_onkillfocus, this);

		this.div_topMenu.addChild(obj.name, obj);

		obj.show();
		  
		if(this.fv_lvl0MenuId == "" || this.fv_lvl0MenuId == undefined || this.fv_lvl0MenuId == null || this.fv_lvl0MenuId == "99" ){
            if(i == 0)
		    {
			    objFirst = obj;
		    } 
		} else {		
		    if(this.fv_lvl0MenuId == strMenuId.toString()){
		    
		        objFirst = obj;
		        this.fv_currMenuBtn = obj;
		        btnMenuPos = Math.floor((i+1)/3) * 170;
		        this.fv_lvl0MenuId == "";
		    }
		}
		
	}   

	this.div_topMenu.resetScroll();
	this.div_topMenu.hscrollbar.set_visible(false);
	if(btnMenuPos > 0) this.div_topMenu.hscrollbar.set_pos(btnMenuPos);
	objFirst.click();
}

this.btnMenu_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var strMenuId = obj.name.split(this.fv_strMenuName)[1];

	this.fv_prevMenuBtn = this.fv_currMenuBtn;
	this.fv_currMenuBtn = obj;
	
	this.fn_drawSubMenu(strMenuId);

	if(!this.comUtils.isNullEmpty(this.fv_prevMenuBtn))
	{
		this.fv_prevMenuBtn.set_cssclass("btn_TF_Menu01");
	}
}

this.btnMenu_onkillfocus = function (obj:Button, e:nexacro.KillFocusEventInfo)
{
	if(!this.comUtils.isNullEmpty(this.fv_currMenuBtn))
	{
		this.fv_currMenuBtn.set_cssclass("btn_TF_Menu01S");
	}
}

/*
 * 함수명  	: fn_drawSubMenu
 * 설명 		: Menu를 채운다.
 * params  		: strUpperId - 부메뉴의 상위 메뉴
 * return Type 	: None
 * 사용법		: 
 */
this.fn_drawSubMenu = function (strUpperId)
{
	this.ds_subMenu.filter("");
	this.ds_subMenu.filter("UPPER_MENU==" + strUpperId);

	this.fn_clearMenuButtons(this.div_topSubMenu);
	
	

	var nT = 1;
	var nL = 0;
	var nW = 10;
	var nH = 30;
	
	var strText;
	var strMenuId;
	var arrSize;
	var objFirst;
	
	for(i = 0; i < this.ds_subMenu.rowcount; i++)
	{
		var obj = new Button();
		strText = this.ds_subMenu.getColumn(i, "MENU_NM");
		strMenuId = this.ds_subMenu.getColumn(i, "MENU_ID");
		application.gv_lvl0MenuId = strUpperId;
		if(i == 0)
		    application.gv_currentJobSe = this.ds_subMenu.getColumn(0, "JOB_SE");
		     
		obj.init(this.fv_strSubMenuName + strMenuId.toString(), "absolute", nL, nT, nW, nH, null, null);
		obj.set_text(strText);

		obj.set_cssclass("btn_TF_Menu02");
		obj.set_left(nL);

		arrSize = this.comUtils.getTextSize(obj.text, obj);
		nW = parseInt(arrSize[0]) + 30;
		nL += nW;
		obj.set_width(nW); 

		obj.addEventHandler("onclick", this.btnSubMenu_onclick, this);
		obj.addEventHandler("onkillfocus", this.btnSubMenu_onkillfocus, this);

		this.div_topSubMenu.addChild(obj.name, obj);

		obj.show();

		if(this.fv_lvl1MenuId != "" && this.fv_lvl1MenuId != undefined && this.fv_lvl1MenuId != null) {

		    if(this.fv_lvl1MenuId == strMenuId.toString()){
		        objFirst = obj;
		        this.fv_lvl1MenuId = "";
		    }
		} else {
		
		    if(i == 0)
		    {
			    objFirst = obj;
		    }
		}

	} 
	
	this.div_topSubMenu.resetScroll();
	this.div_topSubMenu.hscrollbar.set_visible(false);

	this.fv_currSubMenuBtn = objFirst;
	objFirst.set_cssclass("btn_TF_Menu02S");
	objFirst.click();
	objFirst.setFocus();
}

this.btnSubMenu_onclick = function(obj:Button, e:nexacro.ClickEventInfo)
{
	this.fv_currMenuBtn.set_cssclass("btn_TF_Menu01S");

	var strSubMenuId = obj.name.split(this.fv_strSubMenuName)[1];
	
	application.gv_menuFrame.form.fn_loadTreeMenu(strSubMenuId);

	this.fv_prevSubMenuBtn = this.fv_currSubMenuBtn;
	if(!this.comUtils.isNullEmpty(this.fv_prevSubMenuBtn))
	{
		this.fv_prevSubMenuBtn.set_cssclass("btn_TF_Menu02");
	}
	this.fv_currSubMenuBtn = obj;
	application.gv_menuFrame.form.btn_menu_onclick();
}

this.btnSubMenu_onkillfocus = function (obj:Button, e:nexacro.KillFocusEventInfo)
{
	if(!this.comUtils.isNullEmpty(this.fv_currSubMenuBtn))
	{
		this.fv_currSubMenuBtn.set_cssclass("btn_TF_Menu02S");
	}
}



//========================================================
// Portal로부터 넘어온 메뉴 화면을 오픈한다.
//========================================================

/*
 * 함수명  	: getUpperMenuId
 * 설명 		: Portal로부터 넘어온 메뉴 화면을 오픈한다.
 * params  		: lvl - 레벨 숫자 ( 0  또는 1)
 * return Type 	: Portal로부터 넘어온 메뉴의 레벨별 상위메뉴ID
 * 사용법		: this.getUpperMenuId();
 */
this.getUpperMenuId = function(lvl){
    
    application.gds_menutree.filter("");
	var nRow = application.gds_menutree.findRow("MENU_LVL", lvl);
	if(nRow < 0) // 
	{
		return;
	}
	var lvl_menuId = application.gds_menutree.getColumn(nRow, "MENU_ID");
	var strMenuId = lvl_menuId.toString();
	return strMenuId;
} 
/*
 * 함수명  	: getTreeMenu
 * 설명 		: Portal로부터 넘어온 메뉴의 레벨0 메뉴를 오픈한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.getTreeMenu();
 */
this.getTreeMenu = function(){
    if(application.gds_menutree.getRowCount() > 0)
        this.fv_lvl0MenuId = this.getUpperMenuId(0);
}
/*
 * 함수명  	: getSubMenu
 * 설명 		: Portal로부터 넘어온 메뉴의 레벨1 메뉴를 오픈한다
 * params  		: None
 * return Type 	: None
 * 사용법		: this.getSubMenu();
 */ 
this.getSubMenu = function(){
    if(application.gds_menutree.getRowCount() > 0)
        this.fv_lvl1MenuId = this.getUpperMenuId(1);
    if(this.fv_lvl0MenuId != "" && this.fv_lvl0MenuId != undefined && this.fv_lvl0MenuId != null && this.fv_lvl0MenuId != "99") 
        this.fn_drawSubMenu(this.fv_lvl0MenuId);
}


/*
 * 함수명  	: fn_openForm
 * 설명 		: Portal로부터 넘어온 메뉴 화면을 오픈한다.
 * params  		: menuId - 직접 화면에 표시할 메뉴 아이디
 * return Type 	: None
 * 사용법		: 
 */
this.fn_openForm = function (menuId)
{

	application.gds_menu.filter("");
	var nRow = application.gds_menu.findRow("MENU_ID", menuId);	
	
	if(nRow < 1) // nRow == 0 일때는 ROOT 이므로 Form 메뉴로서 의미가 없음.
	{
		return;
	}	
    
    return;// 
	var strMenuId = application.gds_menu.getColumn(nRow, "MENU_ID");	
	var strMenuNm = application.gds_menu.getColumn(nRow, "MENU_NM");
	var strSysSeCode = application.gds_menu.getColumn(nRow, "SYS_SE_CODE");
	var strUrl = application.gds_menu.getColumn(nRow, "PAGE_URL");
	
	var strExpr = "MENU_ID==" + strMenuId + " && SYS_SE_CODE=='" + strSysSeCode + "'";
	var nFRow = application.gds_openMenu.findRowExpr(strExpr);
	
	if(nFRow > -1)
	{
		application.gv_formFrameSet.frames[strSysSeCode + "_" + strMenuId].setFocus();
		return;
	}

	var nNewRow = application.gds_openMenu.addRow();
	application.gds_openMenu.copyRow(nNewRow, application.gds_menu, nRow);

	application.gv_mdiFrame.form.fn_addMenu(strMenuId, strMenuNm, strSysSeCode);
	this.gfn_addForm(strMenuId, strMenuNm, strSysSeCode, strUrl);
}
//========================================================
]]></Script>
  </Form>
</FDL>
