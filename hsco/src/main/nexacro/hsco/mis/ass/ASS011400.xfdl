<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\default_typedef.xml"/>
  <Form id="ASS011400" classname="ASS010500" left="0" top="0" width="1059" height="735" titletext="물품수급계획" onload="ASS011400_onload" oninit="ASS011400_oninit">
    <Layouts>
      <Layout>
        <Static id="Static00" taborder="9" text="9" visible="false" left="0.57%" top="-450" right="0%" height="10" style="background:blueviolet;align:center middle;font:bold 9 Dotum;opacity:50;"/>
        <Static id="Static01" taborder="10" text="7" visible="false" left="0.57%" top="-451" right="0%" height="7" style="background:blueviolet;align:center middle;font:bold 9 Dotum;opacity:50;"/>
        <Static id="Static03" taborder="11" text="9" visible="false" left="1.33%" top="-442" right="-0.66%" height="10" style="background:blueviolet;align:center middle;font:bold 9 Dotum;opacity:50;"/>
        <Static id="Static04" taborder="12" text="스&#13;&#10;크&#13;&#10;롤&#13;&#10;13" visible="false" top="0" right="0" width="13" height="735" style="background:#d07b173c;align:center middle;"/>
        <Static id="Static05" taborder="13" text="15" visible="false" left="1031" top="0" width="15" height="735" style="background:#1b3cd23c;align:center middle;"/>
        <Static id="Static61" taborder="14" text="10" visible="false" left="0" top="33" width="1032" height="10" style="background:#dc143c3c;align:center middle;"/>
        <Static id="sta_assetList" taborder="15" text="물품운영대장" onclick="tab_plan_tpg2_sta_assetList_onclick" cssclass="sta_WF_Title02" left="0" top="44" width="113" height="19" style="align:left middle;"/>
        <Static id="Static08" taborder="35" text="5" visible="false" left="0" top="63" right="28" height="5" style="background:#dc143c3c;align:center middle;"/>
        <Div id="div_search" taborder="0" text="Div01" left="0" top="0" right="28" height="33" cssclass="div_WFSA_Box">
          <Layouts>
            <Layout width="1025" height="41">
              <Static id="sta_year" taborder="92" text="조회년도" cssclass="sta_WFSA_Label" left="15" top="5" width="64" height="21"/>
              <Static id="Static06" taborder="93" text="15" visible="false" left="0" top="0" width="15" height="33" style="background:#00ffff66;"/>
              <Static id="Static02" taborder="94" text="10" visible="false" left="0" top="0" right="0" height="5" style="background:#dc143c3c;align:center middle;"/>
              <Static id="Static00" taborder="95" text="10" visible="false" left="0" right="0" bottom="0" height="5" style="background:#dc143c3c;align:center middle;"/>
              <Spin id="spn_year" taborder="0" value="0" left="79" top="5" width="70" height="21" style="align:center;" cssclass="spn_WF_Essential" min="1000" max="9999"/>
              <Div id="div_dept" taborder="1" url="com::deptCode.xfdl" text="부서" left="229" top="5" width="195" height="21" async="false" enable="false"/>
              <Static id="Static09" taborder="98" text="조회부서" cssclass="sta_WFSA_Label" left="164" top="5" width="65" height="21"/>
              <Static id="Static01" taborder="99" text="15" visible="false" left="149" top="0" width="15" height="33" style="background:#00ffff66;"/>
            </Layout>
          </Layouts>
        </Div>
        <Button id="btn_upload" taborder="2" cssclass="btn_WF_Gridexcelup" top="43" right="28" width="25" height="19" onclick="btn_upload_onclick"/>
        <Button id="btn_download" taborder="1" text="양식 다운로드" top="43" right="55" width="82" height="19" onclick="btn_download_onclick"/>
        <Grid id="grd_sample" taborder="43" binddataset="ds_sample" useinputpanel="false" left="1" top="753" right="474" bottom="-273" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="80"/>
                <Column size="75"/>
                <Column size="40"/>
                <Column size="80"/>
                <Column size="120"/>
                <Column size="120"/>
                <Column size="80"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="85"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="3" text="부서코드"/>
                <Cell col="1" rowspan="3" text="부서명"/>
                <Cell col="2" rowspan="3" text="일련&#13;&#10;번호"/>
                <Cell col="3" rowspan="3" text="정부물품&#13;&#10;분류번호"/>
                <Cell col="4" rowspan="3" text="품명"/>
                <Cell col="5" rowspan="3" text="규격"/>
                <Cell col="6" rowspan="3" text="단가"/>
                <Cell col="7" rowspan="3" text="수량"/>
                <Cell col="8" rowspan="3" text="내용년수"/>
                <Cell col="9" rowspan="3" text="수급구분"/>
                <Cell col="10" rowspan="3" text="구매예정월"/>
                <Cell col="11" colspan="12" text="당해년도 수급관리계획"/>
                <Cell col="23" rowspan="2" text="보유현황"/>
                <Cell row="1" col="11" colspan="4" text="취득"/>
                <Cell row="1" col="15" colspan="8" text="처분"/>
                <Cell row="2" col="11" text="구매"/>
                <Cell row="2" col="12" text="관리전환"/>
                <Cell row="2" col="13" text="기타"/>
                <Cell row="2" col="14" text="소계"/>
                <Cell row="2" col="15" text="관리전환"/>
                <Cell row="2" col="16" colspan="2" text="관리전환부서"/>
                <Cell row="2" col="18" text="불용"/>
                <Cell row="2" col="19" text="손망실"/>
                <Cell row="2" col="20" text="매각"/>
                <Cell row="2" col="21" text="기타"/>
                <Cell row="2" col="22" text="소계"/>
                <Cell row="2" col="23" text="수량"/>
              </Band>
              <Band id="body">
                <Cell text="bind:DEPT_CODE" suppress="1"/>
                <Cell col="1" text="bind:DEPT_NM"/>
                <Cell col="2" text="bind:SN"/>
                <Cell col="3" text="bind:GVRN_THNG_CL_NO" editlimit="20" editdisplay="edit" editlengthunit="utf8"/>
                <Cell col="4" style="align:left;" text="bind:ASSETS_NM" editlimit="150" editdisplay="edit" editlengthunit="utf8"/>
                <Cell col="5" style="align:left;" text="bind:STNDRD" editlimit="300" editdisplay="edit" editlengthunit="utf8"/>
                <Cell col="6" displaytype="number" edittype="masknumber" style="align:right;" text="bind:UNTPC" mask="!###,###,###,###,###" editdisplay="edit" editlimitbymask="both"/>
                <Cell col="7" displaytype="number" edittype="masknumber" text="bind:QY" mask="!###,###,###,###,###" editdisplay="edit" editlimitbymask="both"/>
                <Cell col="8" displaytype="number" edittype="masknumber" text="bind:CN_YYCNT" mask="!##" editdisplay="edit" editlimitbymask="both"/>
                <Cell col="9" displaytype="combo" edittype="combo" text="bind:SPLDMD_SE" combodisplay="edit"/>
                <Cell col="10" edittype="mask" style="align:center;" text="bind:PURCHS_PREARNGE_MT" maskchar=" " editdisplay="edit"/>
                <Cell col="11" displaytype="number" edittype="masknumber" style="align:right;" text="bind:PLAN_ACQS_PURCHS" mask="!###,###,###,###,###" editdisplay="edit" editlimitbymask="both"/>
                <Cell col="12" displaytype="number" edittype="masknumber" style="align:right;" text="bind:PLAN_ACQS_MANAGE_CNVRS" mask="!###,###,###,###,###" editdisplay="edit" editlimitbymask="both"/>
                <Cell col="13" displaytype="number" edittype="masknumber" style="align:right;" text="bind:PLAN_ACQS" mask="!###,###,###,###,###" editdisplay="edit" editlimitbymask="both"/>
                <Cell col="14" displaytype="number" edittype="normal" style="align:right;" editdisplay="edit"/>
                <Cell col="15" displaytype="number" edittype="masknumber" style="align:right;" text="bind:PLAN_DSPS_MANAGE_CNVRS" mask="!###,###,###,###,###" editdisplay="edit" editlimitbymask="both"/>
                <Cell col="16" style="background:EXPR(comp.parent.fn_changeProperty('background', currow));background2:EXPR(comp.parent.fn_changeProperty('background', currow));" text="bind:PLAN_DSPS_MANAGE_CNVRS_DEPT" editdisplay="edit" expandshow="expr:comp.parent.fn_changeProperty('expandshow', currow)"/>
                <Cell col="17" style="background:EXPR(comp.parent.fn_changeProperty('background', currow));background2:EXPR(comp.parent.fn_changeProperty('background', currow));" text="bind:MANAGE_CNVRS_DEPT_NM" editdisplay="edit"/>
                <Cell col="18" displaytype="number" edittype="masknumber" style="align:right;" text="bind:PLAN_DSPS_DISUSE" mask="!###,###,###,###,###" editdisplay="edit" editlimitbymask="both"/>
                <Cell col="19" displaytype="number" edittype="masknumber" style="align:right;" text="bind:PLAN_DSPS_LOSS" mask="!###,###,###,###,###" editdisplay="edit" editlimitbymask="both"/>
                <Cell col="20" displaytype="number" edittype="masknumber" style="align:right;" mask="!###,###,###,###,###" editdisplay="edit" editlimitbymask="both"/>
                <Cell col="21" displaytype="number" edittype="masknumber" style="align:right;" text="bind:PLAN_DSPS_ETC" mask="!###,###,###,###,###" editdisplay="edit" editlimitbymask="both"/>
                <Cell col="22" displaytype="number" edittype="normal" style="align:right;"/>
                <Cell col="23" displaytype="number" edittype="normal" style="align:right;"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static06" taborder="44" text="(단가, 소계 단위 : 원)" top="43" right="145" width="124" height="21" style="color:black;font:9 Gulim;"/>
        <Grid id="grd_list" taborder="45" binddataset="ds_list" useinputpanel="false" onexpanddown="grd_list_onexpanddown" left="0" top="68" right="28" bottom="0">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="80"/>
                <Column size="40"/>
                <Column size="80"/>
                <Column size="120"/>
                <Column size="120"/>
                <Column size="80"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="3" text="순번"/>
                <Cell col="1" rowspan="3" cssclass="Cellgrd_WF_HeadEssential" text="부서"/>
                <Cell col="2" rowspan="3" text="일련&#13;&#10;번호"/>
                <Cell col="3" rowspan="3" text="정부물품&#13;&#10;분류번호"/>
                <Cell col="4" rowspan="3" cssclass="Cellgrd_WF_HeadEssential" text="품명"/>
                <Cell col="5" rowspan="3" text="규격"/>
                <Cell col="6" rowspan="3" text="단가"/>
                <Cell col="7" rowspan="3" text="수량"/>
                <Cell col="8" rowspan="3" text="내용년수"/>
                <Cell col="9" rowspan="3" text="수급구분"/>
                <Cell col="10" rowspan="3" text="구매예정월"/>
                <Cell col="11" colspan="12" text="당해년도 수급관리계획"/>
                <Cell col="23" rowspan="2" text="보유현황"/>
                <Cell row="1" col="11" colspan="4" text="취득"/>
                <Cell row="1" col="15" colspan="8" text="처분"/>
                <Cell row="2" col="11" text="구매"/>
                <Cell row="2" col="12" text="관리전환"/>
                <Cell row="2" col="13" text="기타"/>
                <Cell row="2" col="14" text="소계"/>
                <Cell row="2" col="15" text="관리전환"/>
                <Cell row="2" col="16" colspan="2" text="관리전환부서"/>
                <Cell row="2" col="18" text="불용"/>
                <Cell row="2" col="19" text="손망실"/>
                <Cell row="2" col="20" text="매각"/>
                <Cell row="2" col="21" text="기타"/>
                <Cell row="2" col="22" text="소계"/>
                <Cell row="2" col="23" text="수량"/>
              </Band>
              <Band id="body">
                <Cell style="background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="expr:currow+1"/>
                <Cell col="1" style="background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ?  dataset.getCaseMax(&quot;DEPT_CODE == '&quot; + dataset.getColumn(currow, &quot;DEPT_CODE&quot;) + &quot;'&quot;, &quot;DEPT_NM&quot;) : dataset.getColumn(currow, &quot;DEPT_NM&quot;)"/>
                <Cell col="2" style="background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="bind:SN"/>
                <Cell col="3" edittype="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;none&quot;: &quot;normal&quot;" style="background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="bind:GVRN_THNG_CL_NO" editlimit="20" editdisplay="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;edit&quot;: &quot;display&quot;" editlengthunit="utf8"/>
                <Cell col="4" edittype="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;none&quot;: &quot;normal&quot;" style="align:left;background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="bind:ASSETS_NM" editlimit="150" editdisplay="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;edit&quot;: &quot;display&quot;" editlengthunit="utf8"/>
                <Cell col="5" edittype="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;none&quot;: &quot;normal&quot;" style="align:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;right&quot; : &quot;left&quot;);background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="bind:STNDRD" expr="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;[소 계]&quot; : STNDRD" editlimit="300" editdisplay="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;edit&quot;: &quot;display&quot;" editlengthunit="utf8"/>
                <Cell col="6" displaytype="number" edittype="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;none&quot;: &quot;masknumber&quot;" style="align:right;background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="bind:UNTPC" mask="!###,###,###,###,###" editdisplay="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;edit&quot;: &quot;display&quot;" editlimitbymask="both"/>
                <Cell col="7" displaytype="number" edittype="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;none&quot;: &quot;masknumber&quot;" style="align:center;background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="bind:QY" mask="!##,###,###,###" editdisplay="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;edit&quot;: &quot;display&quot;" editlimitbymask="both"/>
                <Cell col="8" displaytype="number" edittype="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;none&quot;: &quot;masknumber&quot;" style="align:center;background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="bind:CN_YYCNT" mask="!##" editdisplay="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;edit&quot;: &quot;display&quot;" editlimitbymask="both"/>
                <Cell col="9" displaytype="combo" edittype="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;none&quot;: &quot;combo&quot;" style="background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="bind:SPLDMD_SE" combodataset="ds_ctr030" combocodecol="CODE" combodatacol="CODE_NM" combodisplay="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;edit&quot;: &quot;display&quot;"/>
                <Cell col="10" displaytype="combo" edittype="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;none&quot;: &quot;combo&quot;" style="align:center;background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="bind:PURCHS_PREARNGE_MT" maskchar=" " editscrollbar="fixedvert" combodataset="ds_mt" combocodecol="CODE" combodatacol="CODE_NM" combodisplay="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;edit&quot;: &quot;display&quot;"/>
                <Cell col="11" displaytype="checkbox" edittype="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;none&quot;: &quot;checkbox&quot;" style="align:center;background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="bind:PLAN_ACQS_PURCHS" mask="!###,##0" editdisplay="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;edit&quot;: &quot;display&quot;" editlimitbymask="both"/>
                <Cell col="12" displaytype="checkbox" edittype="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;none&quot;: &quot;checkbox&quot;" style="align:center;background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="bind:PLAN_ACQS_MANAGE_CNVRS" mask="!###,##0" editdisplay="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;edit&quot;: &quot;display&quot;" editlimitbymask="both"/>
                <Cell col="13" displaytype="checkbox" edittype="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;none&quot;: &quot;checkbox&quot;" style="align:center;background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="bind:PLAN_ACQS_ETC" mask="!###,##0" editdisplay="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;edit&quot;: &quot;display&quot;" editlimitbymask="both"/>
                <Cell col="14" displaytype="number" edittype="none" style="align:right;background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="bind:ACQS_SUBSUM"/>
                <Cell col="15" displaytype="checkbox" edittype="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;none&quot;: &quot;checkbox&quot;" style="align:center;background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="bind:PLAN_DSPS_MANAGE_CNVRS" mask="!###,##0" editdisplay="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;edit&quot;: &quot;display&quot;" editlimitbymask="both"/>
                <Cell col="16" style="background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : comp.parent.fn_changeProperty('background', currow) );background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : comp.parent.fn_changeProperty('background', currow) );selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;&quot; : PLAN_DSPS_MANAGE_CNVRS_DEPT" expandshow="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? 'hide' : comp.parent.fn_changeProperty('expandshow', currow)"/>
                <Cell col="17" style="background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : comp.parent.fn_changeProperty('background', currow) );background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : comp.parent.fn_changeProperty('background', currow) );selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;&quot; : MANAGE_CNVRS_DEPT_NM"/>
                <Cell col="18" displaytype="checkbox" edittype="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;none&quot;: &quot;checkbox&quot;" style="align:center;background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="bind:PLAN_DSPS_DISUSE" mask="!###,##0" editdisplay="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;edit&quot;: &quot;display&quot;" editlimitbymask="both"/>
                <Cell col="19" displaytype="checkbox" edittype="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;none&quot;: &quot;checkbox&quot;" style="align:center;background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="bind:PLAN_DSPS_LOSS" mask="!###,##0" editdisplay="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;edit&quot;: &quot;display&quot;" editlimitbymask="both"/>
                <Cell col="20" displaytype="checkbox" edittype="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;none&quot;: &quot;checkbox&quot;" style="align:center;background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="bind:PLAN_DSPS_SALE" mask="!###,##0" editdisplay="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;edit&quot;: &quot;display&quot;" editlimitbymask="both"/>
                <Cell col="21" displaytype="checkbox" edittype="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;none&quot;: &quot;checkbox&quot;" style="align:center;background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="bind:PLAN_DSPS_ETC" mask="!###,##0" editdisplay="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;edit&quot;: &quot;display&quot;" editlimitbymask="both"/>
                <Cell col="22" displaytype="number" edittype="none" style="align:right;background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="bind:DSPS_SUBSUM"/>
                <Cell col="23" displaytype="number" edittype="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;none&quot;: &quot;masknumber&quot;" style="align:right;background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;lightgrey&quot; : &quot;&quot;);" text="bind:PLAN_HOLD_STATUS_QY" mask="###,###" editdisplay="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? &quot;edit&quot;: &quot;display&quot;" editlimitbymask="both"/>
              </Band>
              <Band id="summary">
                <Cell/>
                <Cell col="1"/>
                <Cell col="2"/>
                <Cell col="3"/>
                <Cell col="4"/>
                <Cell col="5" text="총 합계"/>
                <Cell col="6" text="expr:dataset.getSum('UNTPC')"/>
                <Cell col="7" displaytype="number" text="expr:dataset.getSum('QY')"/>
                <Cell col="8" text="expr:dataset.getSum('CN_YYCNT')"/>
                <Cell col="9"/>
                <Cell col="10"/>
                <Cell col="11" displaytype="number" text="expr:dataset.getSum('PLAN_ACQS_PURCHS')"/>
                <Cell col="12" displaytype="number" text="expr:dataset.getSum('PLAN_ACQS_MANAGE_CNVRS')"/>
                <Cell col="13" displaytype="number" text="expr:dataset.getSum('PLAN_ACQS_ETC')"/>
                <Cell col="14" displaytype="number" text="expr:dataset.getSum('ACQS_SUBSUM')"/>
                <Cell col="15" displaytype="number" text="expr:dataset.getSum('PLAN_DSPS_MANAGE_CNVRS')"/>
                <Cell col="16" displaytype="none"/>
                <Cell col="17" displaytype="none"/>
                <Cell col="18" displaytype="number" text="expr:dataset.getSum('PLAN_DSPS_DISUSE')"/>
                <Cell col="19" displaytype="number" text="expr:dataset.getSum('PLAN_DSPS_LOSS')"/>
                <Cell col="20" displaytype="number" text="expr:dataset.getSum('PLAN_DSPS_SALE')"/>
                <Cell col="21" displaytype="number" text="expr:dataset.getSum('PLAN_DSPS_ETC')"/>
                <Cell col="22" displaytype="number" text="expr:dataset.getSum('DSPS_SUBSUM')"/>
                <Cell col="23" displaytype="number" text="expr:dataset.getSum('PLAN_HOLD_STATUS_QY')"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cond" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="YEAR" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_validation" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="compId" type="STRING" size="256"/>
          <Column id="colId" type="STRING" size="256"/>
          <Column id="msgId" type="STRING" size="256"/>
          <Column id="nlength" type="STRING" size="256"/>
          <Column id="from" type="STRING" size="256"/>
          <Column id="to" type="STRING" size="256"/>
          <Column id="PK" type="STRING" size="256"/>
          <Column id="notNull" type="STRING" size="256"/>
          <Column id="type" type="STRING" size="256"/>
          <Column id="lengthChkGb" type="STRING" size="256"/>
          <Column id="expr" type="STRING" size="256"/>
          <Column id="func" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="compId">ds_cond</Col>
            <Col id="colId">YEAR</Col>
            <Col id="msgId">조회년도</Col>
            <Col id="notNull">Y</Col>
          </Row>
          <Row>
            <Col id="compId">ds_list</Col>
            <Col id="colId">ASSETS_NM</Col>
            <Col id="msgId">품명</Col>
            <Col id="notNull">Y</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_list" useclientlayout="true" oncolumnchanged="ds_list_oncolumnchanged">
        <ColumnInfo>
          <Column id="YEAR" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="SN" type="STRING" size="256"/>
          <Column id="GVRN_THNG_CL_NO" type="STRING" size="256"/>
          <Column id="ASSETS_NM" type="STRING" size="256"/>
          <Column id="STNDRD" type="STRING" size="256"/>
          <Column id="UNTPC" type="INT" size="256"/>
          <Column id="QY" type="INT" size="256"/>
          <Column id="CN_YYCNT" type="INT" size="256"/>
          <Column id="SPLDMD_SE" type="STRING" size="256"/>
          <Column id="PURCHS_PREARNGE_MT" type="STRING" size="256"/>
          <Column id="PLAN_ACQS_PURCHS" type="INT" size="256"/>
          <Column id="PLAN_ACQS_MANAGE_CNVRS" type="INT" size="256"/>
          <Column id="PLAN_ACQS_ETC" type="INT" size="256"/>
          <Column id="PLAN_DSPS_MANAGE_CNVRS" type="INT" size="256"/>
          <Column id="PLAN_DSPS_MANAGE_CNVRS_DEPT" type="STRING" size="256"/>
          <Column id="PLAN_DSPS_DISUSE" type="INT" size="256"/>
          <Column id="PLAN_DSPS_LOSS" type="INT" size="256"/>
          <Column id="PLAN_DSPS_ETC" type="INT" size="256"/>
          <Column id="MANAGE_CNVRS_DEPT_NM" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="PLAN_DSPS_SALE" type="INT" size="256"/>
          <Column id="ACQS_SUBSUM" type="INT" size="256"/>
          <Column id="DSPS_SUBSUM" type="INT" size="256"/>
          <Column id="PLAN_HOLD_STATUS_QY" type="INT" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ctr030" useclientlayout="true">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sample" useclientlayout="true" oncolumnchanged="ds_list_oncolumnchanged">
        <ColumnInfo>
          <Column id="YEAR" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="SN" type="STRING" size="256"/>
          <Column id="GVRN_THNG_CL_NO" type="STRING" size="256"/>
          <Column id="ASSETS_NM" type="STRING" size="256"/>
          <Column id="STNDRD" type="STRING" size="256"/>
          <Column id="UNTPC" type="STRING" size="256"/>
          <Column id="QY" type="STRING" size="256"/>
          <Column id="CN_YYCNT" type="STRING" size="256"/>
          <Column id="SPLDMD_SE" type="STRING" size="256"/>
          <Column id="PURCHS_PREARNGE_MT" type="STRING" size="256"/>
          <Column id="PLAN_ACQS_PURCHS" type="STRING" size="256"/>
          <Column id="PLAN_ACQS_MANAGE_CNVRS" type="STRING" size="256"/>
          <Column id="PLAN_ACQS" type="STRING" size="256"/>
          <Column id="PLAN_DSPS_MANAGE_CNVRS" type="STRING" size="256"/>
          <Column id="PLAN_DSPS_MANAGE_CNVRS_DEPT" type="STRING" size="256"/>
          <Column id="PLAN_DSPS_DISUSE" type="STRING" size="256"/>
          <Column id="PLAN_DSPS_LOSS" type="STRING" size="256"/>
          <Column id="PLAN_DSPS_ETC" type="STRING" size="256"/>
          <Column id="MANAGE_CNVRS_DEPT_NM" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="DEPT_CODE">050200</Col>
            <Col id="DEPT_NM">체육시설팀</Col>
            <Col id="PURCHS_PREARNGE_MT">05</Col>
            <Col id="ASSETS_NM">테스트 품명</Col>
            <Col id="SPLDMD_SE">자체</Col>
            <Col id="PLAN_ACQS">○</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_mt">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">01</Col>
            <Col id="CODE_NM">1월</Col>
          </Row>
          <Row>
            <Col id="CODE">02</Col>
            <Col id="CODE_NM">2월</Col>
          </Row>
          <Row>
            <Col id="CODE">03</Col>
            <Col id="CODE_NM">3월</Col>
          </Row>
          <Row>
            <Col id="CODE">04</Col>
            <Col id="CODE_NM">4월</Col>
          </Row>
          <Row>
            <Col id="CODE">05</Col>
            <Col id="CODE_NM">5월</Col>
          </Row>
          <Row>
            <Col id="CODE">06</Col>
            <Col id="CODE_NM">6월</Col>
          </Row>
          <Row>
            <Col id="CODE">07</Col>
            <Col id="CODE_NM">7월</Col>
          </Row>
          <Row>
            <Col id="CODE">08</Col>
            <Col id="CODE_NM">8월</Col>
          </Row>
          <Row>
            <Col id="CODE">09</Col>
            <Col id="CODE_NM">9월</Col>
          </Row>
          <Row>
            <Col id="CODE">10</Col>
            <Col id="CODE_NM">10월</Col>
          </Row>
          <Row>
            <Col id="CODE">11</Col>
            <Col id="CODE_NM">11월</Col>
          </Row>
          <Row>
            <Col id="CODE">12</Col>
            <Col id="CODE_NM">12월</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_import">
        <ColumnInfo>
          <Column id="Column0" type="STRING" size="256"/>
          <Column id="Column1" type="STRING" size="256"/>
          <Column id="Column2" type="STRING" size="256"/>
          <Column id="Column3" type="STRING" size="256"/>
          <Column id="Column4" type="STRING" size="256"/>
          <Column id="Column5" type="STRING" size="256"/>
          <Column id="Column6" type="STRING" size="256"/>
          <Column id="Column7" type="STRING" size="256"/>
          <Column id="Column8" type="STRING" size="256"/>
          <Column id="Column9" type="STRING" size="256"/>
          <Column id="Column10" type="STRING" size="256"/>
          <Column id="Column11" type="STRING" size="256"/>
          <Column id="Column12" type="STRING" size="256"/>
          <Column id="Column13" type="STRING" size="256"/>
          <Column id="Column14" type="STRING" size="256"/>
          <Column id="Column15" type="STRING" size="256"/>
          <Column id="Column16" type="STRING" size="256"/>
          <Column id="Column17" type="STRING" size="256"/>
          <Column id="Column18" type="STRING" size="256"/>
          <Column id="Column19" type="STRING" size="256"/>
          <Column id="Column20" type="STRING" size="256"/>
          <Column id="Column21" type="STRING" size="256"/>
          <Column id="Column22" type="STRING" size="256"/>
          <Column id="Column23" type="STRING" size="256"/>
          <Column id="Column24" type="STRING" size="256"/>
          <Column id="Column25" type="STRING" size="256"/>
          <Column id="Column26" type="STRING" size="256"/>
          <Column id="Column27" type="STRING" size="256"/>
          <Column id="Column28" type="STRING" size="256"/>
          <Column id="Column29" type="STRING" size="256"/>
          <Column id="Column30" type="STRING" size="256"/>
          <Column id="Column31" type="STRING" size="256"/>
          <Column id="Column32" type="STRING" size="256"/>
          <Column id="Column33" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item0" compid="div_search.spn_year" propid="value" datasetid="ds_cond" columnid="YEAR"/>
    </Bind>
    <Script type="xscript5.0"><![CDATA[/***********************************************************************
 * 화면ID   : ASS011400.xfdl
 * 화면명   : 물품수급계획
 * 화면설명 : 물품수급계획 계획등록을 관리한다.
 * 작성일   : 2015.07.06
 * 작성자   : 이혜선
 * 수정이력 : 
 ***********************************************************************
 *     수정일     수정자   내용
 ***********************************************************************
 *    
 ***********************************************************************
 */

/***********************************************************************
 * Script Include 
 ***********************************************************************/
// 시스템 공통 라이브러리 Include
include "lib::comInclude.xjs";
include "mis_lib::misUtil.xjs";

/***********************************************************************
 * 화면 변수 선언부
 ***********************************************************************/
this.saveRow = -1;

/***********************************************************************
 * onInit / onLoad 영역
 ***********************************************************************/
this.ASS011400_oninit = function(obj:Form, e:nexacro.InitEventInfo)
{
	// Form 초기화
	this.fn_init_form();

	// DataSet 초기화
	this.fn_init_dataset();
}

this.ASS011400_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{	
	this.div_search.div_dept.fn_setBind("ds_cond", "DEPT_CODE", "DEPT_NM");
	
	// 초기 검색조건
	this.ds_cond.clearData();
	this.ds_cond.addRow();
	this.ds_cond.setColumn(0, "YEAR"     , this.dateUtils.today().substr(0,4));
	this.ds_cond.setColumn(0, "DEPT_CODE", this.gfn_getDeptId());
	this.ds_cond.setColumn(0, "DEPT_NM"  , this.gfn_getDeptName());
		
	// 공통코드
	var comboParams = [
		["ds_ctr030", "CTR030", "Y", ""]			// 수급구분
	];
	
	var callback = function (svcId, errorCode, errorMsg) {
		
	// 권한 분리
	if(this.gfn_authGrpId("ASS_ADMIN") > -1) {		// 자산결재자
		// 검색조건 - 부서
		this.div_search.div_dept.fn_setReadonly(false);
		this.div_search.div_dept.set_enable(true);
		// 부서별 소계
		this.ds_list.set_keystring("G:DEPT_CODE");
	}else {
		// 검색조건 - 부서
		this.div_search.div_dept.fn_setReadonly(true);
		this.div_search.div_dept.set_enable(false);
		// 부서별 소계 제외
		this.ds_list.set_keystring("");
	}
		// 조회 이벤트
		this.fn_search();
		
	};
	this.gfn_comboLoad (comboParams, callback);
}

/***********************************************************************
 * Form/Dataset 오브젝트 초기화
 ***********************************************************************/
/*
 * 함수명  	: initForm
 * 설명 		: Form을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initForm();
 */
this.fn_init_form = function()
{
	// 시스템 공통으로 Form을 Initialize 한다.
	this.gfn_initForm(this);
	this.fn_misFormInit(this);
}

/*
 * 함수명  	: initDataset
 * 설명 		: Dataset을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initDataset();
 */
this.fn_init_dataset = function()
{
	//this.gfn_initCondDs(this, this.div_search);
}


/***********************************************************************
* Transaction 영역 시작
************************************************************************/

/***********************************************************************
 * Transaction 관련 이벤트 핸들러 
 **********************************************************************/
/*
 * 함수명  	: fn_search
 * 설명 		: 조회 이벤트 처리(물품수급계획계획)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_search();
 */
this.fn_search = function()
{
	this.ds_list.clearData();
	
	if(!this.gfn_checkValidation_NoUpdChk(this.ds_cond, this.ds_validation)) {
		return false;
	}
	
	this.fn_transaction("thngSpldmdList");
}

/*
 * 함수명  	: fn_save
 * 설명 		: 저장 이벤트 처리
 * params  		: None
 * return Type 	: None	
 * 사용법		: this.fn_save();
 */
this.fn_save= function()
{	
	// 데이터셋 수정 여부체크
	if (!this.comUtils.isDatasetUpdated(this.ds_list)) {
		this.gfn_message("comm.데이터.변경.없음");
		return false;
	}

	if(!this.gfn_checkValidation_NoUpdChk(this.ds_list, this.ds_validation)) {
		return false;
	}
	
	// 관리전환 - 관리전환부서 validation check
	var listCnt           = this.ds_list.rowcount;
	var manageCnvrs     = "";
	var manageCnvrsDept = "";
	var rowType = "";
	for(var i = 0; i < listCnt ; i++) {
		rowType = this.ds_list.getRowType(i);
		if(rowType != "16") {	// 그룹핑 제외
			manageCnvrs     = this.ds_list.getColumn(i, "PLAN_DSPS_MANAGE_CNVRS");
			manageCnvrsDept = this.ds_list.getColumn(i, "PLAN_DSPS_MANAGE_CNVRS_DEPT");
					
			if((!this.comUtils.isNull(manageCnvrs) && manageCnvrs != 0) && this.comUtils.isNull(manageCnvrsDept)) {
				this.gfn_message("info.처리불가",(i+1)+"행의 관리전환부서를 입력해주세요.");
				return false;
			}else if((this.comUtils.isNull(manageCnvrs) || manageCnvrs == 0) && !this.comUtils.isNull(manageCnvrsDept)) {
				this.gfn_message("info.처리불가",(i+1)+"행의 관리전환을 입력해주세요.");
				return false;
			}
		}
	}
	
	if(this.gfn_message("confirm.저장.여부"))	{
		this.saveRow = this.ds_list.rowposition;
		this.fn_transaction("thngSpldmdCUD");
	}
}


/*
 * 함수명  	: fn_cancel
 * 설명 		: 취소 버튼 이벤트(마스터)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_cancel();
 */
this.fn_cancel = function(obj:Button,  e:nexacro.ClickEventInfo)
{	
	// 데이터셋 수정 여부체크
	if (!this.comUtils.isDatasetUpdated(this.ds_list)) {
		this.gfn_message("comm.데이터.변경.없음");
		return false;
	}
	
	if (this.gfn_message("confirm.취소여부")) {
		this.ds_list.reset();		//DATASET ROLLBACK
		this.ds_list.applyChange();	//DATASET COMMIT
		if(this.gfn_authGrpId("ASS_ADMIN") > -1) {		// 자산결재자
			// 부서별 소계
			this.ds_list.set_keystring("G:DEPT_CODE");
		}else {
			// 부서별 소계 제외
			this.ds_list.set_keystring("");
		}
	}
}


/*
 * 함수명  	: fn_delete
 * 설명 		: 삭제 버튼 이벤트(마스터)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_delete();
 */
this.fn_delete = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var nRow = this.ds_list.rowposition;
	var rowType = this.ds_list.getRowType(nRow);
	if(rowType != "16") {
		if(this.gfn_message("confirm.삭제여부")) {
			this.ds_list.deleteRow(nRow);
		}
	}
}


/*
 * 함수명  	: fn_insert
 * 설명 		: 신규 버튼 클릭시 발생
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_insert();
 */
this.fn_insert = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var year     = this.ds_cond.getColumn(0, "YEAR");
	var deptCode = this.ds_cond.getColumn(0, "DEPT_CODE");
	var deptNm   = this.ds_cond.getColumn(0, "DEPT_NM");
	
	if(this.comUtils.isNull(deptCode)) {
		this.gfn_message("info.처리불가", "검색조건의 조회부서를 설정 후, 다시 진행해주십시오.");
		return false;
	}
	
	var nRow = this.ds_list.addRow();
	this.ds_list.setColumn(nRow, "YEAR"     , year);
	this.ds_list.setColumn(nRow, "DEPT_CODE", deptCode);
	this.ds_list.setColumn(nRow, "DEPT_NM"  , deptNm);
}
/**********************************************************************
 * CALL TRANSACTION 영역
 **********************************************************************/
 
/*
 * 함수명  	: fn_transaction
 * 설명 		: Transaction 요청 처리 함수
 * params  		: strSvcId : 서비스요청 ID
 * return Type 	: None
 * 사용법		: this.fn_transaction("SELECT");
 */
this.fn_transaction = function(strSvcId)
{
	switch (strSvcId) {
		case "thngSpldmdList":		// 물품수급계획 리스트  조회 
			var sController   	= "/hsco/mis/ass/ASS011400/thngSpldmdList.do";
			var sInDatasets   	= "input1=ds_cond";
			var sOutDatasets  	= "ds_list=output1";
			break;
		case "thngSpldmdCUD":		// 물품수급계획 저장
			var sController   	= "hsco/mis/ass/ASS011400/thngSpldmdCUD.do";	
			var sInDatasets   	= "input1=ds_list:U";
			var sOutDatasets  	= "";
			break;
		case "excelUpload":			// 물품수급계획 엑셀 업로드
			var sController   	= "hsco/mis/ass/ASS011400/excelUpload.do";	
			var sInDatasets   	= "input1=ds_list:U";
			var sOutDatasets  	= "";
			break;		
	}

	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets);
}

 /**********************************************************************
 * Transaction Callback 영역
 ***********************************************************************/
 
 /*
 * 함수명  	: fn_callBack
 * 설명 		: Transaction Callback 처리
 * params  		: strSvcId    : 서비스요청 ID
 *                nErrorCode  : 오류 메시지 코드 ([예] 0 : Success, 그밖의 경우, error)
 *                strErrorMsg : 오류 메시지([예]  success.insert|정상적으로 등록되었습니다.)
 * return Type 	: None
 * 사용법		: 
 */
this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg)
{
	// 오류 및 성공 메시지를 화면에 보여준다.
	if (nErrorCode != 0){
		this.gfn_callback_message(strSvcId, nErrorCode, strErrorMsg);
	} else {
		// 실패 메시지를 보여주는 동작 외에 처리할 내용이 있으면 아래에 기술.
		switch (strSvcId) {	
			case "thngSpldmdList":		// 물품수급계획 리스트  조회 
				if(this.saveRow > -1) {
					this.ds_list.set_rowposition(this.saveRow);
					this.saveRow = -1;
				}
				break;
			case "thngSpldmdCUD":		// 물품수급계획 저장
				this.fn_search();
				break;
			case "excelUpload":			// 물품수급계획 엑셀 업로드
				this.gfn_message("success.처리.성공");
				this.fn_search();
				break;		
		}
	}
}

/***********************************************************************
* Transaction 영역 끝
************************************************************************/

/***********************************************************************
* non-Transaction 관련 컴포넌트 이벤트 처리 함수
************************************************************************
* 1. Button 영역 
* 2. 데이터셋 영역
* 3. 탭 영역
* 4. 그리드 영역
* 5. 팝업영역
************************************************************************/

/**********************************************************************
* Button 영역 
***********************************************************************/
/*
 * 함수명  	: btn_upload_onclick
 * 설명 		: 엑셀업로드 버튼 클릭 시 발생
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_upload_onclick();
 */
this.btn_upload_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	// 데이터셋 변경 체크
    if(Ex.util.isUpdated(this.ds_list)) {
        if(!this.gfn_message("confirm.변경.취소.여부")) {
            return false;
        }
    }
    
    // 검색조건 데이터셋 valiidation check
	if(!this.gfn_checkValidation_NoUpdChk(this.ds_cond, this.ds_validation)) {
		return false;
	}
	
	trace("0. year : "+this.ds_cond.getColumn(0, "YEAR"));
	var year = this.ds_cond.getColumn(0, "YEAR");
// 	var deptCode = this.ds_cond.getColumn(0, "DEPT_CODE");
// 	if(this.comUtils.isNull(deptCode)) {
// 		this.gfn_message("info.처리불가", "검색조건의 조회부서를 설정 후, 다시 진행해주십시오.");
// 		return false;
// 	}
		
	if(!application.confirm(year+"년도의 데이터를 엑셀 업로드 하시겠습니까?")) {
		return false;
	}
         	
    this.ds_list.clearData();
	var arg = {
		targetDs : this.ds_import,
		headSet : false,
		callBack : function () {
						
			if(this.ds_import.getRowCount() > 3){
				this.ds_list.clearData();
				for(i=3; i< this.ds_import.rowcount; i++) {
					
					var col0  = this.ds_import.getColumn(i, "Column0");		// *부서코드
					var col1  = this.ds_import.getColumn(i, "Column1");		// 부서명
					var col2  = this.ds_import.getColumn(i, "Column2");		// 일련번호
					var col3  = this.ds_import.getColumn(i, "Column3");		// 정부물품분류기호
					var col4  = this.ds_import.getColumn(i, "Column4");		// *품명
					var col5  = this.ds_import.getColumn(i, "Column5");		// 규격
					var col6  = this.ds_import.getColumn(i, "Column6");		// 단가
					var col7  = this.ds_import.getColumn(i, "Column7");		// 수량
					var col8  = this.ds_import.getColumn(i, "Column8");		// 내용년수 
					var col9  = this.ds_import.getColumn(i, "Column9");		// 구분
					var col10 = this.ds_import.getColumn(i, "Column10");	// 구매예정월
					var col11 = this.ds_import.getColumn(i, "Column11");	// 취득_구매
					var col12 = this.ds_import.getColumn(i, "Column12");	// 취득_취득전환
					var col13 = this.ds_import.getColumn(i, "Column13");	// 취득_기타
					var col14 = this.ds_import.getColumn(i, "Column14");	// 취득_소계
					var col15 = this.ds_import.getColumn(i, "Column15");	// 처분_관리전환
					var col16 = this.ds_import.getColumn(i, "Column16");	// 처분_관리전환부서코드
					var col17 = this.ds_import.getColumn(i, "Column17");	// 처분_관리전환부서명 
					var col18 = this.ds_import.getColumn(i, "Column18");	// 처분_불용
					var col19 = this.ds_import.getColumn(i, "Column19");	// 처분_손망실 
					var col20 = this.ds_import.getColumn(i, "Column20");	// 처분_매각
					var col21 = this.ds_import.getColumn(i, "Column21");	// 처분_기타
					var col22 = this.ds_import.getColumn(i, "Column22");	// 처분_소계
					var col23 = this.ds_import.getColumn(i, "Column23");	// 보유현황_수량
										
					// 필수정보 - 부서코드, 품명
					if(!this.comUtils.isNull(col0) && !this.comUtils.isNull(col4)) {
								
						// 코드 - 수급구분
						var spldmdRow = this.ds_ctr030.findRow("CODE_NM", col9);	//수급구분
						var spldmdCode = this.ds_ctr030.getColumn(spldmdRow, "CODE");
						trace("spldmdRow : " + spldmdRow+"  //  "+col9+" spldmdCode : "+spldmdCode);
						
						var deptCode                    = col0.padLeft(6, "0");                                       								    // 부서                   
						var sn                          = this.fn_getStringCheckByte(col2, 6);                                                          // 순번
						var gvrnThngClNo                = this.fn_getStringCheckByte(col3, 20);                                                         // 정부물품분류번호        
						var assetsNm                    = this.fn_getStringCheckByte(col4, 150);                                                        // 품명         
						var stndrd                      = this.fn_getStringCheckByte(col5, 300);                                                        // 규격
						var untpc                       = this.fn_getStringCheckByte(col6, 15);                                                         // 단가     
						var qy                          = this.fn_getStringCheckByte(col7, 11);                                                         // 수량     
						var cnYycnt                     = this.fn_getStringCheckByte(col8, 2);                                                          // 내용년수    
						var spldmdSe                    = spldmdCode;                                                                                   // 수급구분
						var purchsPrearngeMt            = !this.comUtils.isNull(col10) ? this.fn_getStringCheckByte(col10.replace(/[-]/g, ""), 6) : "";	// 구매예정월                                                        
						var planAcqsPurchs              = col11 == "○" ? "1" : "";                                                                       // 계획_취득_구매     
						var planAcqsManageCnvrs         = col12 == "○" ? "1" : "";                                                         // 계획_취득_관리전환     
						var planAcqsEtc                 = col13 == "○" ? "1" : "";                                                       // 계획_취득_기타     
						var planDspsManageCnvrs         = col15 == "○" ? "1" : "";                                                       // 계획_처분_관리전환     
						var planDspsManageCnvrsDept     = !this.comUtils.isNull(col16) ? col16.padLeft(6, "0") : "";								     // 계획_처분_관리전환부서                             
						var planDspsDisuse              = col18 == "○" ? "1" : "";                                                          // 계획_처분_불용     
						var planDspsLoss                = col19 == "○" ? "1" : "";                                                          // 계획_처분_손망실     
						var planDspsSale                = col20 == "○" ? "1" : "";                                                          // 계획_처분_매각     
						var planDspsEtc                 = col21 == "○" ? "1" : "";                                                          // 계획_처분_기타
						var planHoldStatusQy            = this.fn_getStringCheckByte(col23, 15);                                                         // 보유현황_수량
 						var acmsltDspsEtc               = this.fn_getStringCheckByte(col2, 150);                                                        // 실적_처분_기타                                                                                                                         																												
						
						// 행추가
						var nRow = this.ds_list.addRow();
											
						this.ds_list.setColumn(nRow, "YEAR"                           , year);
						this.ds_list.setColumn(nRow, "DEPT_CODE"                      , deptCode);
						this.ds_list.setColumn(nRow, "SN"                             , sn);
						this.ds_list.setColumn(nRow, "GVRN_THNG_CL_NO"                , gvrnThngClNo);
						this.ds_list.setColumn(nRow, "ASSETS_NM"                      , assetsNm);
						this.ds_list.setColumn(nRow, "STNDRD"                         , stndrd);
						this.ds_list.setColumn(nRow, "UNTPC"                          , untpc);
						this.ds_list.setColumn(nRow, "QY"                             , qy);
						this.ds_list.setColumn(nRow, "CN_YYCNT"                       , cnYycnt);
						this.ds_list.setColumn(nRow, "SPLDMD_SE"                      , spldmdSe);
						this.ds_list.setColumn(nRow, "PURCHS_PREARNGE_MT"             , purchsPrearngeMt);
						this.ds_list.setColumn(nRow, "PLAN_ACQS_PURCHS"               , planAcqsPurchs);
						this.ds_list.setColumn(nRow, "PLAN_ACQS_MANAGE_CNVRS"         , planAcqsManageCnvrs);
						this.ds_list.setColumn(nRow, "PLAN_ACQS_ETC"                  , planAcqsEtc);
						this.ds_list.setColumn(nRow, "PLAN_DSPS_MANAGE_CNVRS"         , planDspsManageCnvrs);
						this.ds_list.setColumn(nRow, "PLAN_DSPS_MANAGE_CNVRS_DEPT"    , planDspsManageCnvrsDept);
						this.ds_list.setColumn(nRow, "PLAN_DSPS_DISUSE"               , planDspsDisuse);
						this.ds_list.setColumn(nRow, "PLAN_DSPS_LOSS"                 , planDspsLoss);
						this.ds_list.setColumn(nRow, "PLAN_DSPS_SALE"                 , planDspsSale);
						this.ds_list.setColumn(nRow, "PLAN_DSPS_ETC"                  , planDspsEtc);
						this.ds_list.setColumn(nRow, "PLAN_HOLD_STATUS_QY"            , planHoldStatusQy);
					}
				}
				this.fn_transaction("excelUpload");
			}
		}
	};
	this.gfn_importExcel(arg);
}


/*
 * 함수명  	: btn_download_onclick
 * 설명 		: 양식다운로드 버튼 클릭 시 발생
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_download_onclick();
 */
this.btn_download_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.gfn_exportExcel(this.grd_sample, "grd_sample");	
}


/**********************************************************************
* 데이터셋 영역 
***********************************************************************/
/*
 * 함수명  	: ds_list_oncolumnchanged
 * 설명 		: 부모데이터셋 데이터 변경 후 발생
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_list_oncolumnchanged();
 */

this.ds_list_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	var nRow = obj.rowposition;
	if(e.columnid == "PLAN_DSPS_MANAGE_CNVRS") {	// 관리전환
		var manageCnvrs = e.newvalue;
		if(this.comUtils.isNull(manageCnvrs)) {
			obj.setColumn(nRow, "PLAN_DSPS_MANAGE_CNVRS_DEPT"   , null);
			obj.setColumn(nRow, "MANAGE_CNVRS_DEPT_NM"          , null);
		}
	}

	if(e.columnid == "UNTPC") {						// 단가
		var untpc      = this.comUtils.isNull(e.newvalue) ? 0 : nexacro.toNumber(e.newvalue);
		var acqsPurchs = this.comUtils.isNull(obj.getColumn(nRow, "PLAN_ACQS_PURCHS")) ? 0 : nexacro.toNumber(obj.getColumn(nRow, "PLAN_ACQS_PURCHS"));
		var dspsDisuse = this.comUtils.isNull(obj.getColumn(nRow, "PLAN_DSPS_DISUSE")) ? 0 : nexacro.toNumber(obj.getColumn(nRow, "PLAN_DSPS_DISUSE"));
		var acqsSubsum = untpc * acqsPurchs;
		var dspsSubsum = untpc * dspsDisuse;
		
		obj.setColumn(nRow, "ACQS_SUBSUM", acqsSubsum);
		obj.setColumn(nRow, "DSPS_SUBSUM", dspsSubsum);
	}
	if(e.columnid == "PLAN_ACQS_PURCHS") {			// 취득구매
		var untpc      = this.comUtils.isNull(obj.getColumn(nRow, "UNTPC")) ? 0 : nexacro.toNumber(obj.getColumn(nRow, "UNTPC"));
		var acqsPurchs = this.comUtils.isNull(obj.getColumn(nRow, "PLAN_ACQS_PURCHS")) ? 0 : nexacro.toNumber(obj.getColumn(nRow, "PLAN_ACQS_PURCHS"));
		var acqsSubsum = untpc * acqsPurchs;
		
		obj.setColumn(nRow, "ACQS_SUBSUM", acqsSubsum);
	}
	if(e.columnid == "PLAN_DSPS_DISUSE") {			// 처분불용
		var untpc      = this.comUtils.isNull(obj.getColumn(nRow, "UNTPC")) ? 0 : nexacro.toNumber(obj.getColumn(nRow, "UNTPC"));
		var dspsDisuse = this.comUtils.isNull(obj.getColumn(nRow, "PLAN_DSPS_DISUSE")) ? 0 : nexacro.toNumber(obj.getColumn(nRow, "PLAN_DSPS_DISUSE"));
		var dspsSubsum = untpc * dspsDisuse;

		obj.setColumn(nRow, "DSPS_SUBSUM", dspsSubsum);	
	}

	if(e.columnid == "QY" || e.columnid == "PLAN_ACQS_PURCHS" || e.columnid == "PLAN_DSPS_DISUSE") {
		
		var qy              = !this.comUtils.isNull(obj.getColumn(nRow, "QY"))                     ? nexacro.toNumber(obj.getColumn(nRow, "QY"))                     : 0 ;
		var acqsPurchs      = !this.comUtils.isNull(obj.getColumn(nRow, "PLAN_ACQS_PURCHS"))       ? nexacro.toNumber(obj.getColumn(nRow, "PLAN_ACQS_PURCHS"))       : 0 ;
		var dspsDisuse      = !this.comUtils.isNull(obj.getColumn(nRow, "PLAN_DSPS_DISUSE"))       ? nexacro.toNumber(obj.getColumn(nRow, "PLAN_DSPS_DISUSE"))       : 0 ;
		                   
		var statusQy = qy + ( acqsPurchs * qy ) - ( dspsDisuse * qy );
		
		if(statusQy > 999999 || statusQy < -999999) {
			this.gfn_message("info.처리불가","6자리수 이내로 입력해주시기 바랍니다.");
			obj.setColumn(nRow, e.columnid, e.oldvalue);
			return false;
		}
		obj.setColumn(nRow, "PLAN_HOLD_STATUS_QY", statusQy);
	}
}


/**********************************************************************
* 그리드
***********************************************************************/

/*
 * 함수명  	: grd_list_onexpandup
 * 설명 		: 부모그리드 돋보기 클릭 
 * params  		: None
 * return Type 	: None
 * 사용법		: this.grd_list_onexpandup();
 */
this.grd_list_onexpanddown = function(obj:Grid, e:nexacro.GridMouseEventInfo) {
	
	// 관리전환부서 - 부서팝업
	if(e.cell == "16") {
		this.fn_popup("popDeptSearch");
	}
}
/**********************************************************************
* 팝업영역 
***********************************************************************/

 /*
 * 함수명  	: fn_popup
 * 설명 		: Popup 호출 이벤트 처리
 * params  		: sPopupId    : 팝업 ID
 * return Type 	: None
 * 사용법		: this.fn_popup(sPopupId)
 */
this.fn_popup = function(sPopupId)
{
	// 부서팝업
	if(sPopupId == "popDeptSearch") {
		var parm = {
			 arg_0      : this
		};
		this.gfn_popup(sPopupId, 800, 530, "", parm, "mis_hrm::HRM010101_P1.xfdl", "fn_popupCallBack", true);
	}
}

 /*
 * 함수명  	: fn_popupCallBack
 * 설명 		: Popup Callback 처리
 * params  		: sPopupId    : 팝업 ID
 *                sReturn  : 팝업 처리 결과(dataset.saveXML())
 * return Type 	: None
 * 사용법		: 
 */
this.fn_popupCallBack = function(sPopupId, sReturn)
{
	// 부서팝업
	if(sPopupId == "popDeptSearch") {
		var dsTemp = new Dataset();
		var loadCnt = dsTemp.loadXML(sReturn);
		if(loadCnt) {
			var deptCode = dsTemp.getColumn(0, "DEPT_CODE");
			var deptNm   = dsTemp.getColumn(0, "DEPT_NM");
			trace(deptCode);
			var nRow = this.ds_list.rowposition;
			this.ds_list.setColumn(nRow, "PLAN_DSPS_MANAGE_CNVRS_DEPT",   deptCode);	// 부서코드
			this.ds_list.setColumn(nRow, "MANAGE_CNVRS_DEPT_NM"       ,   deptNm);		// 부서명
		}
	}
}
/**********************************************************************
* 사용자 정의 함수
***********************************************************************/

/*
 * 함수명  	: fn_changeProperty
 * 설명 		: 그리드 속성 변경
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_changeProperty();
 */
this.fn_changeProperty = function(property, nRow) {
	
	var manageCnvrs = this.ds_list.getColumn(nRow, "PLAN_DSPS_MANAGE_CNVRS");
	var array = new Array();
	var result = null;
	
	if(!this.comUtils.isNull(property) && !this.comUtils.isNull(nRow)) {
		if(property == "background") {
			array = ["", "beige"];
		}else if(property == "expandshow") {
			array = ["hide", "show"];
		}
	
		var result = array[0];
		if(!this.comUtils.isNull(manageCnvrs) && manageCnvrs != 0) {
			result = array[1];
		}
	}
	return result;
}

this.ds_list_canrowposchange = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{
	
}
]]></Script>
  </Form>
</FDL>
