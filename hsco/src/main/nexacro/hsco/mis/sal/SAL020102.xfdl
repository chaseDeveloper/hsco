<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\default_typedef.xml"/>
  <Form id="SAL020102" classname="SAL020102" left="0" top="0" width="1059" height="735" titletext="초과근무관리" onload="SAL020102_onload" oninit="SAL020102_oninit">
    <Layouts>
      <Layout>
        <Div id="div_search" taborder="0" left="0" top="0" right="28" height="33" cssclass="div_WFSA_Box">
          <Layouts>
            <Layout>
              <Static id="Static16" taborder="1" text="15" visible="false" left="13.8%" top="1" right="84.84%" height="25" style="background:#00ffff66;"/>
              <Static id="Static01" taborder="2" text="직종" cssclass="sta_WFSA_Label" left="156" top="5" height="21" width="36"/>
              <Combo id="cmb_EMPL_SE" taborder="3" innerdataset="ds_jssfc" codecolumn="CODE" datacolumn="CODE_NM" left="198" top="5" height="21" style="font:10 Gulim;" width="102"/>
              <Static id="Static05" taborder="4" text="직급구분" cssclass="sta_WFSA_Label" left="316" top="5" height="21" width="67"/>
              <Combo id="cmb_CLSF_CODE" taborder="5" text="전체" innerdataset="@DS_CLSF_CODE" codecolumn="code" datacolumn="data" index="0" left="380" top="5" height="21" width="111"/>
              <Static id="Static03" taborder="6" text="성명" cssclass="sta_WFSA_Label" left="505" top="5" height="21" width="37"/>
              <Div id="div_EMP" taborder="7" url="com::empno.xfdl" text="Div00" left="540" top="5" height="21" onkeyup="div_SEARCH_div_EMP_onkeyup" width="163" async="false"/>
              <Static id="Static02" taborder="8" text="15" visible="false" left="47.72%" top="1" right="50.92%" height="25" style="background:#00ffff66;"/>
              <Static id="Static00" taborder="9" text="검색년도" cssclass="sta_WFSA_Label" left="15" top="5" height="21" width="65"/>
              <Combo id="cmb_year1" taborder="10" innerdataset="ds_year" codecolumn="CODE" datacolumn="NAME" left="76" top="5" height="21" width="66" onitemchanged="div_search_cmb_year1_onitemchanged"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static08" taborder="4" text="10" visible="false" left="0%" top="33" right="2.64%" height="10" style="background:#dc143c3c;align:center middle;"/>
        <Static id="Static03" taborder="5" text="초과근무상세정보" onclick="Static03_onclick" cssclass="sta_WF_Title03" left="144" top="39" height="19" width="136"/>
        <Static id="Static02" taborder="6" text="5" visible="false" left="0%" top="53" right="2.64%" height="5" style="background:#dc143c3c;align:center middle;"/>
        <Static id="Static00" taborder="7" text="15" visible="false" left="97.36%" top="0" right="1.23%" height="735" style="background:#1b3cd23c;align:center middle;"/>
        <Static id="Static01" taborder="8" text="스&#13;&#10;크&#13;&#10;롤&#13;&#10;13" visible="false" left="98.77%" top="0" right="0%" height="735" style="background:#d07b173c;align:center middle;"/>
        <Grid id="grd_EXCESS_WORK_DTLS" taborder="9" binddataset="DS_EXCESS_WORK_DTLS" useinputpanel="false" autofittype="col" onheadclick="grd_EXCESS_WORK_DTLS_onheadclick" left="163" top="58" right="28" bottom="0" autoenter="select" oncellclick="grd_EXCESS_WORK_DTLS_oncellclick" onexpandup="grd_EXCESS_WORK_DTLS_onexpandup" oncelldblclick="grd_EXCESS_WORK_DTLS_oncelldblclick" style="cursor:hand;">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="95"/>
                <Column size="83"/>
                <Column size="134"/>
                <Column size="97"/>
                <Column size="76"/>
                <Column size="45"/>
                <Column size="45"/>
                <Column size="102"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="98"/>
              </Columns>
              <Rows>
                <Row size="22" band="head"/>
                <Row size="22"/>
              </Rows>
              <Band id="head">
                <Cell text="순번"/>
                <Cell col="1" cssclass="Cellgrd_WF_HeadEssential" text="초과근무년월"/>
                <Cell col="2" text="지급일자"/>
                <Cell col="3" text="부서명"/>
                <Cell col="4" cssclass="Cellgrd_WF_HeadEssential" text="사번"/>
                <Cell col="5" text="사원명"/>
                <Cell col="6" text="직급"/>
                <Cell col="7" text="호봉"/>
                <Cell col="8" text="통상임금"/>
                <Cell col="9" text="시간외"/>
                <Cell col="10" text="야근근무"/>
                <Cell col="11" text="휴일근무"/>
                <Cell col="12" text="한도시간"/>
                <Cell col="13" text="누계시간"/>
                <Cell col="14" text="지급시간"/>
                <Cell col="15" text="지급액"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" displaytype="normal" edittype="normal" text="bind:PYMNT_YM" mask="####-##"/>
                <Cell col="2" displaytype="date" edittype="date" text="bind:PYMNT_DE" calendardisplay="edit" calendardisplaynulltype="default"/>
                <Cell col="3" displaytype="combo" style="align: ;" text="bind:DEPT_CODE" combodataset="ds_dept" combocodecol="CODE" combodatacol="CODE_NM"/>
                <Cell col="4" edittype="none" text="bind:EMPNO" expandshow="show" expandsize="20"/>
                <Cell col="5" displaytype="combo" edittype="none" text="bind:EMPNM" combodataset="ds_emp" combocodecol="CODE_NM" combodatacol="CODE_NM"/>
                <Cell col="6" displaytype="normal" edittype="none" text="bind:CLSF_CODE" combodisplayrowcount="-1"/>
                <Cell col="7" text="bind:SRCLS"/>
                <Cell col="8" displaytype="number" edittype="normal" editfilter="number" style="align:right;" text="bind:ODYGS"/>
                <Cell col="9" displaytype="number" edittype="normal" editfilter="number" style="align:right;" text="bind:TIME_ELSE_TIME"/>
                <Cell col="10"/>
                <Cell col="11"/>
                <Cell col="12" displaytype="number" edittype="normal" editfilter="number" style="align:right;" text="bind:LMT_TIME"/>
                <Cell col="13" displaytype="number" edittype="none" style="align:right;" text="bind:TIME2"/>
                <Cell col="14" displaytype="number" edittype="none" editfilter="number" style="align:right;" text="bind:PYMNT_TIME"/>
                <Cell col="15" displaytype="number" editfilter="number" style="align:right;" text="bind:PYMNT_AMOUNT"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_Cre" taborder="1" text="생성" onclick="div_cont_btn_Cre_onclick" top="37" height="19" width="40" right="72" cssclass="btn_WF_Process"/>
        <Button id="btn_Cal" taborder="2" text="계산" onclick="div_cont_btn_Cal_onclick" top="37" height="19" width="40" right="30" cssclass="btn_WF_Process"/>
        <Static id="Static04" taborder="10" text="(내역을 더블클릭하면 상세내역을 볼수 있습니다.)" left="273" top="38" height="20" width="302" style="color:crimson;"/>
        <Static id="Static31" taborder="11" text="초과근무적용내역" cssclass="sta_WF_Title02" left="0" top="39" height="19" width="170"/>
        <Grid id="grd_EXCESS_WORK_DATE" taborder="12" binddataset="DS_EXCESS_WORK_DATE" useinputpanel="false" autofittype="col" left="0%" top="58" bottom="0" width="157">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="33"/>
                <Column size="80"/>
                <Column size="40"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="번호"/>
                <Cell col="1" text="초과근무년월"/>
                <Cell col="2" text="삭제"/>
              </Band>
              <Band id="body">
                <Cell displaytype="number" text="expr:currow+1"/>
                <Cell col="1" displaytype="normal" text="bind:PYMNT_YM" mask="####-##" editdisplay="edit" editlimitbymask="decimal" calendardisplaynulltype="none"/>
                <Cell col="2" displaytype="checkbox" edittype="checkbox" text="bind:CHK"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static05" taborder="14" text="(계산 후 저장하세요)" left="544" top="38" height="20" style="color:crimson;" width="124"/>
        <Static id="sta_CLSF_CODE" taborder="15" text="초과근무" cssclass="sta_WF_Title02" top="35" right="296" width="68" height="21" style="align:left middle;"/>
        <Calendar id="cal_pymntDe" taborder="18" dateformat="yyyy-MM-dd" top="35" right="116" width="94" height="21"/>
        <Div id="div_pymntYm" taborder="19" url="mis_sal::SAL020102_MonCal.xfdl" top="35" right="212" width="86" height="21" onlbuttonup="div_search_div_pymntYm_onlbuttonup"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="DS_EMPL_SE" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="data" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="data">전체</Col>
          </Row>
          <Row>
            <Col id="code">000</Col>
            <Col id="data">임원</Col>
          </Row>
          <Row>
            <Col id="code">001</Col>
            <Col id="data">업무직</Col>
          </Row>
          <Row>
            <Col id="code">002</Col>
            <Col id="data">기술직</Col>
          </Row>
          <Row>
            <Col id="code">003</Col>
            <Col id="data">기능직</Col>
          </Row>
          <Row>
            <Col id="code">004</Col>
            <Col id="data">계약직</Col>
          </Row>
          <Row>
            <Col id="code">005</Col>
            <Col id="data">기간제</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="DS_CLSF_CODE" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="data" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="data">전체</Col>
          </Row>
          <Row>
            <Col id="code">00</Col>
            <Col id="data">사장</Col>
          </Row>
          <Row>
            <Col id="code">01</Col>
            <Col id="data">1급</Col>
          </Row>
          <Row>
            <Col id="code">02</Col>
            <Col id="data">2급</Col>
          </Row>
          <Row>
            <Col id="code">03</Col>
            <Col id="data">3급</Col>
          </Row>
          <Row>
            <Col id="code">04</Col>
            <Col id="data">4급</Col>
          </Row>
          <Row>
            <Col id="code">05</Col>
            <Col id="data">5급</Col>
          </Row>
          <Row>
            <Col id="code">06</Col>
            <Col id="data">6급</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="DS_SEARCH" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="EMPL_SE" type="STRING" size="256"/>
          <Column id="EMPNO" type="STRING" size="256"/>
          <Column id="EMPNM" type="STRING" size="256"/>
          <Column id="CLSF_CODE" type="STRING" size="256"/>
          <Column id="PYMNT_YM" type="STRING" size="256"/>
          <Column id="PYMNT_YM2" type="STRING" size="256"/>
          <Column id="PYMNT_YEAR1" type="STRING" size="256"/>
          <Column id="PYMNT_YEAR2" type="STRING" size="256"/>
          <Column id="PYMNT_DE" type="STRING" size="256"/>
          <Column id="SALARY_SE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="DS_EXCESS_WORK_DTLS" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="PYMNT_YM" type="STRING" size="256"/>
          <Column id="PYMNT_DE" type="STRING" size="256"/>
          <Column id="EMPNO" type="STRING" size="256"/>
          <Column id="EMPNM" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="CLSF_CODE" type="STRING" size="256"/>
          <Column id="SRCLS" type="STRING" size="256"/>
          <Column id="ODYGS" type="BIGDECIMAL" size="256"/>
          <Column id="TIME_ELSE_TIME" type="INT" size="256"/>
          <Column id="NIGHT_TIME" type="INT" size="256"/>
          <Column id="RESTDE_TIME" type="INT" size="256"/>
          <Column id="MDAT_TIME" type="INT" size="256"/>
          <Column id="LMT_TIME" type="INT" size="256"/>
          <Column id="PYMNT_TIME" type="INT" size="256"/>
          <Column id="PYMNT_AMOUNT" type="BIGDECIMAL" size="256"/>
          <Column id="DCSN_AT" type="STRING" size="256"/>
          <Column id="TIME2" type="INT" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_EXCESS_CODE" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="SE_1" type="STRING" size="256"/>
          <Column id="SE_2" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_SEARCH2" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="PYMNT_DETAIL_CODE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="PYMNT_DETAIL_CODE">P1910001</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_empno" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="EMPNO" type="STRING" size="256"/>
          <Column id="EMPNM" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="CLSF_CODE" type="STRING" size="256"/>
          <Column id="SALARY_SE" type="STRING" size="256"/>
          <Column id="RSPOFC_SE" type="STRING" size="256"/>
          <Column id="JSSFC_SE" type="STRING" size="256"/>
          <Column id="SRCLS" type="STRING" size="256"/>
          <Column id="ECNY_DE" type="STRING" size="256"/>
          <Column id="STDR_DE" type="STRING" size="256"/>
          <Column id="ADRES" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_DCSN_AT" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="data" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="code">1</Col>
            <Col id="data">확정</Col>
          </Row>
          <Row>
            <Col id="code">0</Col>
            <Col id="data">미확정</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_jssfc" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_validation" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="compId" type="STRING" size="256"/>
          <Column id="colId" type="STRING" size="256"/>
          <Column id="PK" type="STRING" size="256"/>
          <Column id="notNull" type="STRING" size="256"/>
          <Column id="type" type="STRING" size="256"/>
          <Column id="nlength" type="STRING" size="256"/>
          <Column id="from" type="STRING" size="256"/>
          <Column id="to" type="STRING" size="256"/>
          <Column id="lengthChkGb" type="STRING" size="256"/>
          <Column id="msgId" type="STRING" size="256"/>
          <Column id="expr" type="STRING" size="256"/>
          <Column id="func" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="compId">DS_SEARCH3</Col>
            <Col id="colId">PYMNT_YM</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">지급년월</Col>
          </Row>
          <Row>
            <Col id="compId">DS_EXCESS_WORK_DTLS</Col>
            <Col id="colId">PYMNT_YM</Col>
            <Col id="PK">Y</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">지급년월</Col>
          </Row>
          <Row>
            <Col id="compId">DS_EXCESS_WORK_DTLS</Col>
            <Col id="colId">EMPNO</Col>
            <Col id="PK">Y</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">사번</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_year" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_EXCESS_WORK_DATE" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="DS_EXCESS_WORK_DATE_onrowposchanged">
        <ColumnInfo>
          <Column id="PYMNT_YM" type="STRING" size="256"/>
          <Column id="PYMNT_DE" type="STRING" size="256"/>
          <Column id="CHK" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_SEARCH3" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="EMPL_SE" type="STRING" size="256"/>
          <Column id="EMPNO" type="STRING" size="256"/>
          <Column id="EMPNM" type="STRING" size="256"/>
          <Column id="CLSF_CODE" type="STRING" size="256"/>
          <Column id="PYMNT_YM" type="STRING" size="256"/>
          <Column id="JSSFC_SE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_cond00" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="PYMNT_YM" type="STRING" size="256"/>
          <Column id="PYMNT_DE" type="STRING" size="256"/>
          <Column id="PYMNT_SE" type="STRING" size="256"/>
          <Column id="SALARY_SE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_crecheck" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="PYMNT_YM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_crecheck00" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CNT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_dept" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_emp" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item0" compid="div_search.cmb_CLSF_CODE" propid="value" datasetid="DS_SEARCH" columnid="CLSF_CODE"/>
      <BindItem id="item1" compid="div_search.cmb_EMPL_SE" propid="value" datasetid="DS_SEARCH" columnid="EMPL_SE"/>
      <BindItem id="item2" compid="div_search.cmb_year1" propid="value" datasetid="DS_SEARCH" columnid="PYMNT_YEAR1"/>
    </Bind>
    <Script type="xscript5.0"><![CDATA[/***********************************************************************
 * 업무구분 : 초과근무관리
 * 화면ID   : SAL020102
 * 화면명   : 초과근무정보관리
 * 화면설명 : 초과근무정보를 관리한다.
 * 작성일   : 2015.06.29
 * 작성자   : 이동석
 * 수정이력 : 
 ***********************************************************************
 *     수정일     수정자   내용
 ***********************************************************************
 *   
 ***********************************************************************/
/***********************************************************************
 * Script Include 
 ************************************************************************/
include "lib::comInclude.xjs";
include "mis_lib::misUtil.xjs";

/***********************************************************************
 * 화면 변수 선언부
 ***********************************************************************/
this.checkDs = [
	 this.DS_EXCESS_WORK_DTLS
];
var cre=0;

/***********************************************************************
 * onInit 영역
 ***********************************************************************/
this.SAL020102_oninit = function(obj:Form, e:nexacro.InitEventInfo)
{
	this.fn_init_form();
	this.fn_init_dataset();
	
    // 조회조건 	
	//this.DS_SEARCH.clearData();              // 조회 데이터셋 초기화	
	//var nRow = this.DS_SEARCH.addRow();      // 조회 데이터셋 행추가
	this.div_search.div_EMP.fn_setBind("DS_SEARCH","EMPNO","EMPNM");
} 
 
/***********************************************************************
 * 설명: 폼로딩시 처리
 ************************************************************************/
this.SAL020102_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{
	this.div_pymntYm.setValue(this.dateUtils.format(this.gfn_addDate(this.gfn_today(), -1, "M"),"yyyymm"));
	this.cal_pymntDe.set_value(this.dateUtils.format(this.gfn_today(),"yyyymm") + "01");	
	
	this.fn_year_cmb();
	this.fn_loadCombo();
	this.fn_search();
}

/***********************************************************************
 * Form 오브젝트 초기화
 ***********************************************************************/ 
this.fn_init_form = function()
{
	this.fn_misFormInit(this);
	this.gfn_initForm(this);	
}

/***********************************************************************
 * Dataset 오브젝트 초기화
 ***********************************************************************/ 
this.fn_init_dataset = function()
{
	//this.gfn_initCondDs(this, this.div_search);	
}

/***********************************************************************
 * 설명: 공통조회
 ************************************************************************/
this.fn_loadCombo = function()
{
	var comboParams = [["ds_jssfc", "HRM001", 1, "전체"]   // 직종
	                  ];

	this.gfn_comboLoad(comboParams, this.fn_callbackAfter);

	this.ds_cond00.clearData();
	this.ds_cond00.addRow();
	
	this.fn_transaction("selectdeptcodeList");		// 부서코드 조회
}

/***********************************************************************
 * 설명: 년도 콤보
 ************************************************************************/
this.fn_year_cmb = function()
 {
	var objDate = new Date();
    var sYear  = objDate.getFullYear();
    //alert("sYear = " + sYear);
    
    for(var i = 2000; i <= sYear+2; i++){
		var nRow = this.ds_year.addRow();
		this.ds_year.setColumn(nRow,"CODE",i);
		this.ds_year.setColumn(nRow,"NAME",i);		
    } 
    
    this.div_search.cmb_year1.set_value(sYear); 


    /*
    var objDate = new Date();
    var sYear  = objDate.getFullYear();
    var sYear2  = sYear;
    this.ds_year.clearData();
    var sYear3 = sYear-5;
    var sYear_stdr=sYear-5;
    for(var i=0; i<= 4; i++){
		var nRow = this.ds_year.addRow();
		this.ds_year.setColumn(nRow,"CODE",sYear_stdr);
		this.ds_year.setColumn(nRow,"NAME",sYear_stdr);
		sYear_stdr = sYear_stdr + 1;
    }     
    var sYear_stdr2 = sYear;
    for(var i=0; i<= 2; i++){
		var nRow = this.ds_year.addRow();
		this.ds_year.setColumn(nRow,"CODE",sYear_stdr);
		this.ds_year.setColumn(nRow,"NAME",sYear_stdr);
		sYear_stdr = sYear_stdr + 1;
    }        
    this.div_search.cmb_year1.set_value(sYear2); 
    */
 }

/***********************************************************************
 * 설명: 조회 처리
 ************************************************************************/
this.fn_search= function()
{
	// 초기화	
	this.DS_EXCESS_WORK_DTLS.clearData();
	this.DS_EXCESS_WORK_DATE.clearData();
	
    if(this.div_search.div_EMP.GetValue("EMPNO")){
          var empno = this.div_search.div_EMP.GetValue("EMPNO");
    }
    
	// Validation 체크
	//if(!this.gfn_checkValidation_NoUpdChk(this.DS_SEARCH, this.ds_validation)) {
	//	return;
	//}	
	
	this.fn_transaction("selectExcessworkdtlsList");
}

/***********************************************************************
 * 설명: 신규
 ************************************************************************/
this.fn_insert = function()	
{
	var yearmm 	= this.DS_EXCESS_WORK_DATE.getColumn(this.DS_EXCESS_WORK_DATE.rowposition,"PYMNT_YM");
	var nRow 	= this.DS_EXCESS_WORK_DTLS.addRow();
	this.DS_EXCESS_WORK_DTLS.setColumn(nRow,"PYMNT_YM",yearmm);
	var bFocus 	= this.grd_EXCESS_WORK_DTLS.setFocus(true);
	var bSucc 	= this.grd_EXCESS_WORK_DTLS.setCellPos(2);
	this.grd_EXCESS_WORK_DTLS_oncellclick();
}

/***********************************************************************
 * 설명: 추가
 ************************************************************************/
this.fn_add = function()
{
	var nRow = this.DS_EXCESS_WORK_DTLS.insertRow(this.DS_EXCESS_WORK_DTLS.rowposition+1);		
}

/***********************************************************************
 * 설명: 삭제
 ************************************************************************/
this.fn_delete = function()
{	
	if(this.pymnt_cre_check2() == false){
		 this.alert("급여지급이 확정되어 삭제 할 수 없습니다.");
		 return;
	}
	
	if(this.DS_EXCESS_WORK_DATE.getColumn(this.DS_EXCESS_WORK_DATE.rowposition,"CHK") == "1"){
	    var bOK;
	    bOK = application.confirm( this.DS_EXCESS_WORK_DATE.getColumn(this.DS_EXCESS_WORK_DATE.rowposition,"PYMNT_YM") + "월 전체내역을 삭제하시겠습니까?" );
	    if(bOK == true){
	          //this.DS_SEARCH.clearData();              
			  //var nRow = this.DS_SEARCH.addRow();      
			  this.DS_SEARCH.setColumn(0,"PYMNT_YM2",this.DS_EXCESS_WORK_DATE.getColumn(this.DS_EXCESS_WORK_DATE.rowposition,"PYMNT_YM") ); 
	          this.fn_transaction("delExcessworkdtlsList");
	    }
	} else {
		if ( this.gfn_message("confirm.삭제여부")) {  
			var nRow = this.DS_EXCESS_WORK_DTLS.rowposition;
			this.DS_EXCESS_WORK_DTLS.deleteRow(nRow);
		}	
	}	
}

/***********************************************************************
 * 설명: 취소
 ************************************************************************/
this.fn_cancel = function()
{
	if ( this.gfn_message("confirm.취소여부") ) {  //모든 내용을 복원 하시겠습니까?
		this.DS_EXCESS_WORK_DTLS.reset();		//DATASET ROLLBACK
		this.DS_EXCESS_WORK_DTLS.applyChange();	//DATASET COMMIT
		return;
	}	
}

/***********************************************************************
 * 설명: 저장
 ************************************************************************/
this.fn_save = function()
{
	if(this.pymnt_cre_check2() == false){
		 this.alert("급여지급이 확정되어 저장할 수 없습니다.");
		 return;
	}
	
	// Validation 체크
	if(!this.gfn_checkValidation(this.DS_EXCESS_WORK_DTLS, this.ds_validation)) {
		return;
	}
	
	if(this.gfn_message("confirm.저장.여부"))	{
		this.fn_transaction("saveExcessworkdtlsList");
	}
}

/**********************************************************************
 * CALL TRANSACTION 영역
 **********************************************************************/ 
this.fn_transaction = function(strSvcId)
{
	switch (strSvcId) {
		case "selectExcessworkdtlsList": 	// 초과근무정보 목록조회
			var sController   	= "hsco/mis/sal/SAL020102/selectExcessworkdtlsList.do";
			var sInDatasets   	= "input1=DS_SEARCH";
			var sOutDatasets  	= "DS_EXCESS_WORK_DATE=output1";
			var sArgs = "";	
			break;
		case "selectExcessworkdtls2List": 	// 초과근무정보 상세 목록조회
			var sController   	= "hsco/mis/sal/SAL020102/selectExcessworkdtls2List.do";
			var sInDatasets   	= "input2=DS_SEARCH3";
			var sOutDatasets  	= "DS_EXCESS_WORK_DTLS=output2";
			var sArgs = "";	
			break;
		case "selectPymntdetailcodeList": 	// 지급상세코드정보 조회
			var sController   	= "hsco/mis/sal/SAL020102/selectPymntdetailcodeList.do";
			var sInDatasets   	= "input3=DS_SEARCH2";
			var sOutDatasets  	= "DS_EXCESS_CODE=output3";
			var sArgs = "";	
			break;		
		case "Excessworkdtls2List": 		// 초과근무정보 생성(일괄)
			var sController   	= "hsco/mis/sal/SAL020102/Excessworkdtls2.do";
			var sInDatasets   	= "input4=DS_SEARCH";
			var sOutDatasets  	= "";
			var sArgs = "";	
			break;	
		case "delExcessworkdtlsList": 		// 초과근무정보 일괄삭제
			var sController   	= "hsco/mis/sal/SAL020102/delExcessworkdtls.do";
			var sInDatasets   	= "input4=DS_SEARCH";
			var sOutDatasets  	= "";
			var sArgs = "";	
			break;			
		case "saveExcessworkdtlsList":		// 초과근무정보 등록, 수정, 삭제 (건별)
			var sController   	= "hsco/mis/sal/SAL020102/ExcessworkdtlsCUD.do";	
			var sInDatasets   	= "input2=DS_EXCESS_WORK_DTLS:U";
			var sOutDatasets  	= "";
			var sArgs = "DEL_SE=1";	
			break;

	    // 부서코드 조회
		case "selectdeptcodeList": 
			var sController   	= "hsco/mis/sal/SAL030112/selectdeptcodeList.do";
			var sInDatasets   	= "input1=ds_cond00";
			var sOutDatasets  	= "ds_dept=output1";
			break;
	}

	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets, sArgs); 
}

/**********************************************************************
 * Transaction Callback 영역
 ***********************************************************************/ 
this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg)
{
	// 오류 및 성공 메시지를 화면에 보여준다.
	/*this.gfn_callback_message(strSvcId, nErrorCode, strErrorMsg);*/
	if (nErrorCode != 0){
		this.gfn_callback_message(strSvcId, nErrorCode, strErrorMsg);	
	} else {		
		switch (strSvcId) {
		    case "selectExcessworkdtlsList":
				break;

		    case "selectExcessworkdtls2List": // 초과근무정보 상세 목록조회
				this.fn_filter_combo();	
				break;

			case "Excessworkdtls2List": 
// 			    cre = 1;
 			    this.fn_search();
 			    this.gfn_message("success.처리.성공");
		        //this.gfn_message("success.작업완료.성공","생성");
		        //alert("생성 작업완료");
//		        this.fn_search();
				break;
				
			case "selectPymntdetailcodeList": 
			    var Hrow_con = this.DS_EXCESS_WORK_DTLS.getRowCount();
				if(Hrow_con > 0) {
					var Pymnt1 = this.DS_EXCESS_CODE.getColumn(0,"SE_1");   // 지급구분1
					var Pymnt2 = this.DS_EXCESS_CODE.getColumn(0,"SE_2");   // 지급구분2
					
					for(var i=0; i<= Hrow_con-1; i++){
						var Timeelsetime 	= this.DS_EXCESS_WORK_DTLS.getColumn(i,"TIME_ELSE_TIME");	// 시간외시간
						var Lmttime 		= this.DS_EXCESS_WORK_DTLS.getColumn(i,"LMT_TIME");         // 한도시간
						var Time2 			= this.DS_EXCESS_WORK_DTLS.getColumn(i,"TIME2");         	// 누계시간
						var Pymnttime		= 0;	// 지급시간
						var Difftime		= 0;	// 한도시간 - 누계시간
						 
						var Difftime = Lmttime - Time2;
					  
						// 한도시간 - 누계시간이 0보다 크거나 같을 경우
						if (Difftime < 0) {
							// 지급시간 = 한도시간 - (누계시간 - 시간외시간)
							Pymnttime = Lmttime - (Time2 - Timeelsetime);
							if (Pymnttime < 1) {
								Pymnttime = 0;
							}
						} else {
							Pymnttime = Timeelsetime;
						}
						this.DS_EXCESS_WORK_DTLS.setColumn(i,"PYMNT_TIME",Pymnttime);					// 지급시간
						 
						var Odygs 		= this.DS_EXCESS_WORK_DTLS.getColumn(i,"ODYGS");            	// 통상임금				 
						var Pymntstd 	= Odygs * Pymnt1 / Pymnt2;                                		// 분단위 지급기준금액
						var Pymntamount = parseInt(parseInt(Pymntstd * Pymnttime)/10)*10;      			// 시간외 수당(원단위 버림)
						this.DS_EXCESS_WORK_DTLS.setColumn(i,"PYMNT_AMOUNT",Pymntamount);				// 지급액
											
					/*
						var Timeelsetime 	= this.DS_EXCESS_WORK_DTLS.getColumn(i,"TIME_ELSE_TIME");	// 시간외시간
						var Nighttime 		= this.DS_EXCESS_WORK_DTLS.getColumn(i,"NIGHT_TIME");       // 야간시간
						var Restdetime 		= this.DS_EXCESS_WORK_DTLS.getColumn(i,"RESTDE_TIME");      // 휴일시간
						
						var Lmttime 		= this.DS_EXCESS_WORK_DTLS.getColumn(i,"LMT_TIME");         // 한도시간
						var Time2 			= this.DS_EXCESS_WORK_DTLS.getColumn(i,"TIME2");         	// 누계시간
						 
						if(!Nighttime){ Nighttime = 0;}
						if(!Restdetime){ Restdetime = 0;}
						if(!Lmttime){ Lmttime = 0;}
						 
						// 초과근무시간 = 시간외시간 + 야간시간 + 휴일시간
						var Pymnttime = parseInt(Timeelsetime) + parseInt(Nighttime) + parseInt(Restdetime);
					  
						if(Pymnttime > Lmttime){	// 한도계산
							Pymnttime = Lmttime;
						}
						this.DS_EXCESS_WORK_DTLS.setColumn(i,"PYMNT_TIME",Pymnttime);					// 지급시간
						 
						var Odygs 		= this.DS_EXCESS_WORK_DTLS.getColumn(i,"ODYGS");            	// 통상임금				 
						var Pymntstd 	= Odygs * Pymnt1 / Pymnt2;                                		// 분단위 지급기준금액
						var Pymntamount = parseInt(parseInt(Pymntstd * Pymnttime)/10)*10;      			// 시간외 수당(원단위 버림)
						this.DS_EXCESS_WORK_DTLS.setColumn(i,"PYMNT_AMOUNT",Pymntamount);				// 지급액
					*/
					}
					//this.gfn_message("success.작업완료.성공","계산");
					alert("계산 작업완료");
				}  		
				break;								
			case "saveExcessworkdtlsList":
			    this.gfn_message("success.처리.성공");
			    this.fn_search();
			    break;
			case "delExcessworkdtlsList":
			    this.gfn_message("success.처리.성공");
			    this.fn_search();
			    break;    
		}
	}
}

/***********************************************************************************
* 설명	: 급여지급 확정여부 확인 (일괄생성시 체크)
***********************************************************************************/
this.pymnt_cre_check = function()
{
    this.ds_crecheck.clearData();
    this.ds_cond00.clearData();	
	this.ds_cond00.addRow();	

	var pymntym 	= this.cal_pymntDe.value + "";
	var pymntde 	= this.cal_pymntDe.value;
	var stdrym		= "";
	
	pymntym = pymntym.substring(0,6);
	stdrym 	= this.div_pymntYm.getValue().substring(4,6);

	//this.ds_cond00.setColumn(0,"PYMNT_YM",this.div_pymntYm.getValue());
	this.ds_cond00.setColumn(0,"PYMNT_YM",	pymntym);	// 지급년월 (초과근무년월이 아님)
	this.ds_cond00.setColumn(0,"PYMNT_DE",	pymntde);	// 지급일자

	if (stdrym == "12") {
		this.ds_cond00.setColumn(0,"SALARY_SE",	"3");	// 1: 정상, 2: 정산, 3: 시간외
	} else {
		this.ds_cond00.setColumn(0,"SALARY_SE",	"1");	// 1: 정상, 2: 정산, 3: 시간외
	}
     
    var strSvcId      	= "selectMtsalarycreList";   
	var sController   	= "hsco/mis/sal/SAL020102/selectMtsalarycreList.do";
	var sInDatasets   	= "input10=ds_cond00";
	var sOutDatasets  	= "ds_crecheck=output10";
	 
	var argument 		= "";
	var callbackfunc 	= "";
	var showprogress 	= "";
	var bAsync = false;
	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets, argument, callbackfunc, showprogress, bAsync);  
	 
	if(this.ds_crecheck.getColumn(0,"PYMNT_YM")){
		return false;
	}
}

/***********************************************************************************
* 설명	: 급여지급 확정여부 확인 (삭제시 체크)
***********************************************************************************/
this.pymnt_cre_check2 = function()
{
    this.ds_crecheck.clearData();
    this.ds_cond00.clearData();	
	this.ds_cond00.addRow();	

	var pymntym 	= this.DS_EXCESS_WORK_DATE.getColumn(this.DS_EXCESS_WORK_DATE.rowposition,"PYMNT_YM");
	var stdrym		= "";
	var set_pymntym;
	
	stdrym = pymntym.substring(4,6);

	if (stdrym == "12") {
		this.ds_cond00.setColumn(0,"PYMNT_YM2",	pymntym);		// 지급년월 (초과근무년월이 아님)
		this.ds_cond00.setColumn(0,"SALARY_SE",	"3");			// 1: 정상, 2: 정산, 3: 시간외
	} else {
		set_pymntym = nexacro.toNumber(pymntym) + 1;
		this.ds_cond00.setColumn(0,"PYMNT_YM",	set_pymntym);	// 지급년월 (초과근무년월이 아님)
		this.ds_cond00.setColumn(0,"SALARY_SE",	"1");			// 1: 정상, 2: 정산, 3: 시간외
	}

    var strSvcId      	= "selectMtsalarycreList";   
	var sController   	= "hsco/mis/sal/SAL020102/selectMtsalarycreList.do";
	var sInDatasets   	= "input10=ds_cond00";
	var sOutDatasets  	= "ds_crecheck=output10";
	 
	var argument 		= "";
	var callbackfunc 	= "";
	var showprogress 	= "";
	var bAsync = false;
	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets, argument, callbackfunc, showprogress, bAsync);  
	 
	if(this.ds_crecheck.getColumn(0,"PYMNT_YM")){
		return false;
	}
}


/***********************************************************************************
* 설명	: 초과근무정보 생성 대상조회
***********************************************************************************/
this.pymnt_cre_target_check2 = function()
{
	var strSvcId       	= "selectMtsalarycreList";   
	var sController   	= "hsco/mis/sal/SAL020102/selectExcessworkdtls3List.do";
	var sInDatasets   	= "input2=DS_SEARCH";
	var sOutDatasets  	= "ds_crecheck00=output2";
		
	var argument 		= "";
	var callbackfunc 	= "";
	var showprogress 	= "";
	var bAsync = false;
	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets, argument, callbackfunc, showprogress, bAsync);  

	var rowCnt = this.ds_crecheck00.getColumn(0,"CNT");
	if (rowCnt < 1) {
	   return false;
	}
}

/***********************************************************************************
* 설명	: 초과근무정보 생성(일괄)
***********************************************************************************/
this.div_cont_btn_Cre_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.pymnt_cre_check() == false){
		 this.alert("급여지급이 확정되어 재생성할 수 없습니다.");
		 return;
	}

	var pymntym 	= this.div_pymntYm.getValue();
	var pymntde		= this.cal_pymntDe.value;
	
	/*
	var Pymntyear 	= Pymntym.substr(0,4);
	var Pymntmoon 	= Pymntym.substr(4,2);

	var mm = parseInt(Pymntmoon)-1; 
	if(mm == 0){ mm = 12; }
	if(mm < 10){ mm = "0" + mm; }	

	if(mm == "12") {
		 var s_year = parseInt(Pymntyear)-1;
	} 
	else {
		 var s_year = Pymntyear;          
	}
	var s_ym = s_year +""+ mm; 
	*/

	//this.DS_SEARCH.setColumn(0,"PYMNT_YM2",	s_ym);
	var pymntym 	= this.cal_pymntDe.value + "";
	var pymntde 	= this.cal_pymntDe.value + "";
	var pymntym2 	= this.div_pymntYm.getValue();
	var stdrym		= "";

	pymntym = pymntym.substring(0,6);
	stdrym 	= pymntym2.substring(4,6);

	this.DS_SEARCH.setColumn(0,"PYMNT_YM",	pymntym);
	this.DS_SEARCH.setColumn(0,"PYMNT_YM2",	pymntym2);
	this.DS_SEARCH.setColumn(0,"PYMNT_DE",	pymntde);
	
	if (stdrym == "12") {
		this.DS_SEARCH.setColumn(0,"SALARY_SE",	"3");	// 1: 정상, 2: 정산, 3: 시간외
	} else {
		this.DS_SEARCH.setColumn(0,"SALARY_SE",	"1");	// 1: 정상, 2: 정산, 3: 시간외
	}

	if(this.pymnt_cre_target_check2() == false){
		 this.alert("초과근무정보 생성 대상이 없습니다.");
		 return;
	}

	this.fn_transaction("Excessworkdtls2List");
}


/***********************************************************************************
* 설명	: 초과근무 계산
***********************************************************************************/
this.div_cont_btn_Cal_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	// 초기화	
	this.DS_EXCESS_CODE.clearData();	
	
	this.fn_transaction("selectPymntdetailcodeList");
}

/***********************************************************************************
* 설명	: 그리드 내 조회버튼
***********************************************************************************/
this.grd_EXCESS_WORK_DTLS_onexpandup = function(obj:Grid, e:nexacro.GridMouseEventInfo)
{
	if(!this.DS_EXCESS_WORK_DTLS.getColumn(this.DS_EXCESS_WORK_DTLS.rowposition,"EMPNO")){
		var nLeft = system.clientToScreenX(this, 10);
		var nTop  = system.clientToScreenY(this, 10);

		var newChild = new ChildFrame;
		newChild.init("Popup1"
				, "absolute", nLeft, nTop, 400, 400, null, null
				, "com::empno_P01.xfdl");

		newChild.set_openalign("center middle");
		newChild.set_dragmovetype("all");  
		newChild.set_showtitlebar(true);
		newChild.showModal(this.getOwnerFrame()
				 , {}
				 , this
				 , "fn_callback2");
	}				
}

/***********************************************************************************
* 설명	: 사원선택 팝업 콜백
***********************************************************************************/
this.fn_callback2 = function(sPopupId, sReturn)
{
	if(sPopupId == "Popup1")
	{
		this.ds_empno.clearData();
		nRowCnt = this.ds_empno.loadXML(sReturn); 
		if(this.ds_empno.getColumn(0,"EMPNO")) {
			this.DS_EXCESS_WORK_DTLS.setColumn(this.DS_EXCESS_WORK_DTLS.rowposition,"EMPNO",this.ds_empno.getColumn(0,"EMPNO"));
			this.DS_EXCESS_WORK_DTLS.setColumn(this.DS_EXCESS_WORK_DTLS.rowposition,"EMPNM",this.ds_empno.getColumn(0,"EMPNM"));			
			this.DS_EXCESS_WORK_DTLS.setColumn(this.DS_EXCESS_WORK_DTLS.rowposition,"DEPT_NM",this.ds_empno.getColumn(0,"DEPT_NM"));
			this.DS_EXCESS_WORK_DTLS.setColumn(this.DS_EXCESS_WORK_DTLS.rowposition,"DEPT_CODE",this.ds_empno.getColumn(0,"DEPT_CODE"));		
			this.DS_EXCESS_WORK_DTLS.setColumn(this.DS_EXCESS_WORK_DTLS.rowposition,"CLSF_CODE",this.ds_empno.getColumn(0,"CLSF_CODE"));	
			this.DS_EXCESS_WORK_DTLS.setColumn(this.DS_EXCESS_WORK_DTLS.rowposition,"SRCLS",this.ds_empno.getColumn(0,"SRCLS"));
			var bFocus = this.grd_EXCESS_WORK_DTLS.setFocus(true);
			var bSucc = this.grd_EXCESS_WORK_DTLS.setCellPos(6);							
		}	
	}
}

/***********************************************************************************
* 설명	: 그리드헤드정렬
***********************************************************************************/
this.grd_EXCESS_WORK_DTLS_onheadclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	LGV_COL_SORT = e.col;
    this._gridSort(obj, e);
}

/***********************************************************************************
* 설명	: 그리드의 내용을 엑셀파일로 다운로드
***********************************************************************************/
this.Excel_down_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
    this.gfn_exportExcel(this.grd_EXCESS_WORK_DTLS, "EXCESS_WORK_DTLS");
}

/***********************************************************************************
* 설명	: 그리드의 셀클릭 이벤트
***********************************************************************************/
this.grd_EXCESS_WORK_DTLS_oncellclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	var nIndex = this.grd_EXCESS_WORK_DTLS.getCellPos();
	if(nIndex == 4){
	      this.grd_EXCESS_WORK_DTLS_onexpandup(); 
	}	
}

/***********************************************************************************
* 설명	: 초과근무 상세내역
***********************************************************************************/
this.grd_EXCESS_WORK_DTLS_oncelldblclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{	
	if(this.DS_EXCESS_WORK_DTLS.getColumn(e.row,"EMPNO") && this.DS_EXCESS_WORK_DTLS.getColumn(e.row,"TIME_ELSE_TIME")){
		 var nLeft = system.clientToScreenX(this, 10);
		 var nTop  = system.clientToScreenY(this, 10);

		 var newChild = new ChildFrame;
		 newChild.init("Popup1", "absolute", nLeft, nTop, 500, 500, null, null, "mis_sal::SAL020102_P01.xfdl");

		 newChild.set_openalign("center middle");
		 newChild.set_dragmovetype("all"); 
		 newChild.set_showtitlebar(true);
		 var empno 	= this.DS_EXCESS_WORK_DTLS.getColumn(e.row,"EMPNO");
		 var empnm 	= this.DS_EXCESS_WORK_DTLS.getColumn(e.row,"EMPNM");
		 var s_ym 	= this.DS_EXCESS_WORK_DTLS.getColumn(e.row,"PYMNT_YM");
		 
		 newChild.showModal(this.getOwnerFrame(), {EMPNO:empno,S_YM:s_ym,EMPNM:empnm}, this, "fn_callback3");
	}	 
}

/***********************************************************************************
* 설명	: 초과근무 년월별 내역 행 변경시
***********************************************************************************/
this.DS_EXCESS_WORK_DATE_onrowposchanged = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{
	if(e.newrow>-1){
		// 삭제 체크
		var Hrow_con = this.DS_EXCESS_WORK_DATE.getRowCount();
		var rowp = this.DS_EXCESS_WORK_DATE.rowposition;
		for(var i=0; i<= Hrow_con-1; i++){	
		   if( i == rowp) {
			   
		   } else {
				this.DS_EXCESS_WORK_DATE.setColumn(i,"CHK","0");
		   }     
		}
		
		if(this.DS_EXCESS_WORK_DATE.getColumn(this.DS_EXCESS_WORK_DATE.rowposition,"PYMNT_YM")){
			this.DS_EXCESS_WORK_DTLS.clearData();
			this.DS_SEARCH3.clearData();
			this.DS_SEARCH3.addRow();
			var empno = ""
			if(this.div_search.div_EMP.GetValue("EMPNO")){
				  empno = this.div_search.div_EMP.GetValue("EMPNO");
			}			
			this.DS_SEARCH3.setColumn(0,"EMPNO",	empno);
			this.DS_SEARCH3.setColumn(0,"CLSF_CODE",this.div_search.cmb_CLSF_CODE.value)      
			this.DS_SEARCH3.setColumn(0,"EMPL_SE",	this.div_search.cmb_EMPL_SE.value)   
			this.DS_SEARCH3.setColumn(0,"PYMNT_YM",	this.DS_EXCESS_WORK_DATE.getColumn(this.DS_EXCESS_WORK_DATE.rowposition,"PYMNT_YM")); 
			
			this.fn_transaction("selectExcessworkdtls2List");
		}
	}else{
		this.DS_EXCESS_WORK_DTLS.clearData();
	}
}

/***********************************************************************************
* 설명	: 조회년도 콤보 변경
***********************************************************************************/
this.div_search_cmb_year1_onitemchanged = function(obj:Combo, e:nexacro.ItemChangeEventInfo)
{
	this.fn_search();
}

/***********************************************************************************
* 설명	:월력 호출시 콜백
***********************************************************************************/
this.fn_MonCal_callBack = function () {
	//this.div_pymntYm.setValue(this.dateUtils.format(this.gfn_addDate(this.gfn_today(), -1, "M"),"yyyymm"));
	var get_pymntym = this.div_pymntYm.getValue();
	var get_pymntde	= this.gfn_addDate(get_pymntym + "01", 1, "M");
	var get_yymm	= get_pymntym.substring(4,6);
	
	if (get_yymm == "12") {
		get_pymntde	= get_pymntym + "31";
	}
	this.cal_pymntDe.set_value(get_pymntde);
}

this.fn_filter_combo = function()
{
	this.ds_emp.clearData();
	
	var ll_rowcnt = this.DS_EXCESS_WORK_DTLS.getRowCount();
	for (var i=0; i<ll_rowcnt; i++)
	{
		var nRow = this.ds_emp.addRow();
		this.ds_emp.copyRow(nRow, this.DS_EXCESS_WORK_DTLS, i, "CODE=EMPNO, CODE_NM=EMPNM");
	}
	this.ds_emp.set_keystring("S:+CODE_NM");
}]]></Script>
  </Form>
</FDL>
