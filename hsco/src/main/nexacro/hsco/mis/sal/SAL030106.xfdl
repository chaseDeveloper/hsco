<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\default_typedef.xml"/>
  <Form id="SAL030106" classname="SAL030106" left="0" top="0" width="1059" height="735" titletext="급여지급관리" oninit="SAL030106_oninit" onload="SAL030106_onload">
    <Layouts>
      <Layout>
        <Div id="div_search" taborder="8" left="0" top="0" right="28" height="33" cssclass="div_WFSA_Box" onclick="div_search_onclick">
          <Layouts>
            <Layout>
              <Static id="Static06" taborder="153" text="15" visible="false" left="0" top="2" right="1015" height="20" style="background:#00ffff66;"/>
              <Static id="Static00" taborder="154" text="5" visible="false" left="104" top="53" right="887" height="5" style="background:#fa794f66;align:center middle;"/>
              <Static id="Static16" taborder="155" text="지급년도" cssclass="sta_WFSA_Label" left="15" top="5" height="21" width="65"/>
              <Spin id="spn_excclcYear" taborder="160" max="3000" min="2010" cssclass="spn_WF_Essential" left="85" top="5" height="21" width="72"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static03" taborder="11" text="5" visible="false" left="0" top="53" right="28" height="5" style="background:#dc143c3c;align:center middle;"/>
        <Static id="Static00" taborder="12" text="15" visible="false" left="1031" top="0" right="13" height="735" style="background:#1b3cd23c;align:center middle;"/>
        <Static id="Static01" taborder="13" text="스&#13;&#10;크&#13;&#10;롤&#13;&#10;13" visible="false" left="1046" top="0" right="0" height="735" style="background:#d07b173c;align:center middle;"/>
        <Static id="Static04" taborder="14" text="10" visible="false" left="0" top="33" right="28" height="10" style="background:#dc143c3c;align:center middle;"/>
        <Button id="btn_pymntList" taborder="61" text="급여지급대장" cssclass="btn_WF_Process" top="35" height="21" onclick="btn_pymntList_onclick" width="92" right="123" visible="false"/>
        <Button id="btn_incmtaxList" taborder="63" text="소득세명세서" cssclass="btn_WF_Process" top="35" height="21" onclick="btn_incmtaxList_onclick" width="92" right="29" visible="false"/>
        <Button id="btn_pymntLong" taborder="68" text="장기근속수당" cssclass="btn_WF_Process" top="35" right="217" height="21" onclick="btn_pymntLong_onclick" width="92" visible="false"/>
        <Static id="Static02" taborder="69" text="급여지급 목록" cssclass="sta_WF_Title02" left="0" top="39" height="19" width="170"/>
        <Grid id="grd_pymnt_de" taborder="70" binddataset="ds_pymnt_de" useinputpanel="false" autofittype="col" left="0" top="58" bottom="0" width="341" autoenter="select" oncellclick="grd_pymnt_de_oncellclick" oncelldblclick="grd_pymnt_de_oncelldblclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="70"/>
                <Column size="60"/>
                <Column size="90"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="지급년월"/>
                <Cell col="1" text="지급순번"/>
                <Cell col="2" text="지급일자"/>
                <Cell col="3" text="결재상태"/>
              </Band>
              <Band id="body">
                <Cell text="bind:PYMNT_YM" mask="####-##"/>
                <Cell col="1" text="bind:SN"/>
                <Cell col="2" displaytype="date" text="bind:PYMNT_DE" calendardisplaynulltype="none"/>
                <Cell col="3" displaytype="image" text="bind:DRFT_STS_IMG" tooltiptext="bind:DRFT_DT"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_apprCancel" taborder="72" text="결재취소" cssclass="btn_WF_Process" top="36" height="19" onclick="btn_apprCancel_onclick" left="271" width="70" visible="false"/>
        <Button id="btn_mtSalaryDtstmn" taborder="73" text="급여명세서" onclick="btn_mtSalaryDtstmn_onclick" cssclass="btn_WF_Process" top="35" width="84" height="21" visible="false" right="217"/>
        <Tab id="tab_salaryPymntList" taborder="74" left="351" top="58" tabindex="0" scrollbars="autoboth" bottom="0" right="28" style="showextrabutton:false;" preload="true">
          <Tabpages>
            <Tabpage id="tpg_deptSalaryPymntList" text="부서별급여지급상세정보" url="mis_sal::SAL030106_T01.xfdl">
              <Layouts/>
            </Tabpage>
            <Tabpage id="tpg_empSalaryPymntList" text="사원별급여지급상세정보" url="mis_sal::SAL030106_T02.xfdl"/>
          </Tabpages>
        </Tab>
        <Static id="Static05" taborder="75" text="급여지급상세정보" cssclass="sta_WF_Title02" left="351" top="39" width="170" height="19"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item0" compid="div_search.spn_excclcYear" propid="value" datasetid="ds_cond00" columnid="PYMNT_YEAR"/>
    </Bind>
    <Objects>
      <Dataset id="ds_rspofc" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ofcps" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_jssfc" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond00" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="PYMNT_YEAR" type="STRING" size="256"/>
          <Column id="PYMNT_YEAR2" type="STRING" size="256"/>
          <Column id="EMPL_SE" type="STRING" size="256"/>
          <Column id="SALARY_SE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_validation" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="compId" type="STRING" size="256"/>
          <Column id="colId" type="STRING" size="256"/>
          <Column id="PK" type="STRING" size="256"/>
          <Column id="notNull" type="STRING" size="256"/>
          <Column id="type" type="STRING" size="256"/>
          <Column id="nlength" type="STRING" size="256"/>
          <Column id="from" type="STRING" size="256"/>
          <Column id="to" type="STRING" size="256"/>
          <Column id="lengthChkGb" type="STRING" size="256"/>
          <Column id="msgId" type="STRING" size="256"/>
          <Column id="expr" type="STRING" size="256"/>
          <Column id="func" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="compId">ds_cond00</Col>
            <Col id="colId">PYMNT_DE</Col>
            <Col id="PK"/>
            <Col id="notNull">Y</Col>
            <Col id="type"/>
            <Col id="nlength"/>
            <Col id="from"/>
            <Col id="to"/>
            <Col id="lengthChkGb"/>
            <Col id="msgId">지급일자</Col>
            <Col id="expr"/>
            <Col id="func"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_SalaryPymntExpndtr" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="PYMNT_YM" type="STRING" size="256"/>
          <Column id="SALARY_SE" type="STRING" size="256"/>
          <Column id="PYMNT_SE" type="STRING" size="256"/>
          <Column id="PYMNT_DE" type="STRING" size="256"/>
          <Column id="CPTAL_ASIGN_REQST_DE" type="STRING" size="256"/>
          <Column id="CPTAL_ASIGN_CONFM_NO" type="STRING" size="256"/>
          <Column id="DRFT_DE" type="STRING" size="256"/>
          <Column id="INNER_SANCTN_ID" type="STRING" size="256"/>
          <Column id="EXPNDTR_DECSN_DE" type="STRING" size="256"/>
          <Column id="EXPNDTR_DECSN_NO" type="STRING" size="256"/>
          <Column id="PYMNT_AM_SM" type="BIGDECIMAL" size="256"/>
          <Column id="DDC_AM_SM" type="BIGDECIMAL" size="256"/>
          <Column id="PYMNT_NMPR" type="BIGDECIMAL" size="256"/>
          <Column id="BUDGET_ACNT_CODE" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_CODE_NM" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_NM" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_CODE" type="STRING" size="256"/>
          <Column id="CONFM_AT" type="STRING" size="256"/>
          <Column id="ATCH_FILE_1" type="STRING" size="256"/>
          <Column id="LAST_SANCTN_STTUS" type="STRING" size="256"/>
          <Column id="SANCTN_NO" type="STRING" size="256"/>
          <Column id="SANCTN_KND" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_anslryse" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE_NM">호봉</Col>
          </Row>
          <Row>
            <Col id="CODE">Y</Col>
            <Col id="CODE_NM">연봉</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_pymnt_de" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_pymnt_de_onrowposchanged">
        <ColumnInfo>
          <Column id="PYMNT_YM" type="STRING" size="256"/>
          <Column id="SN" type="STRING" size="256"/>
          <Column id="PYMNT_DE" type="STRING" size="256"/>
          <Column id="CNT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond01" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="SN" type="STRING" size="256"/>
          <Column id="PYMNT_YM" type="STRING" size="256"/>
          <Column id="PYMNT_DE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_empSalaryPymntList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="PYMNT_YM" type="STRING" size="256"/>
          <Column id="SN" type="STRING" size="256"/>
          <Column id="PYMNT_DE" type="STRING" size="256"/>
          <Column id="EMPNO" type="STRING" size="256"/>
          <Column id="EMPNM" type="STRING" size="256"/>
          <Column id="JSSFC" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="PRMPC_SE" type="STRING" size="256"/>
          <Column id="OFCPS" type="STRING" size="256"/>
          <Column id="HR_CLSF" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond02" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="PYMNT_YM" type="STRING" size="256"/>
          <Column id="PYMNT_SE" type="STRING" size="256"/>
          <Column id="PYMNT_DE" type="STRING" size="256"/>
          <Column id="SALARY_SE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SalaryPymntExpndtr00" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="PYMNT_YM" type="STRING" size="256"/>
          <Column id="SALARY_SE" type="STRING" size="256"/>
          <Column id="PYMNT_SE" type="STRING" size="256"/>
          <Column id="PYMNT_DE" type="STRING" size="256"/>
          <Column id="CPTAL_ASIGN_REQST_DE" type="STRING" size="256"/>
          <Column id="CPTAL_ASIGN_CONFM_NO" type="STRING" size="256"/>
          <Column id="DRFT_DE" type="STRING" size="256"/>
          <Column id="INNER_SANCTN_ID" type="STRING" size="256"/>
          <Column id="EXPNDTR_DECSN_DE" type="STRING" size="256"/>
          <Column id="EXPNDTR_DECSN_NO" type="STRING" size="256"/>
          <Column id="PYMNT_AM_SM" type="BIGDECIMAL" size="256"/>
          <Column id="DDC_AM_SM" type="BIGDECIMAL" size="256"/>
          <Column id="PYMNT_NMPR" type="BIGDECIMAL" size="256"/>
          <Column id="BUDGET_ACNT_CODE" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_CODE_NM" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_NM" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_CODE" type="STRING" size="256"/>
          <Column id="CONFM_AT" type="STRING" size="256"/>
          <Column id="ATCH_FILE_1" type="STRING" size="256"/>
          <Column id="LAST_SANCTN_STTUS" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_approve" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DATA_VALUE" type="STRING" size="1000"/>
          <Column id="DATA_TITLE" type="STRING" size="256"/>
          <Column id="O_URL" type="STRING" size="256"/>
          <Column id="I_KEY" type="STRING" size="256"/>
          <Column id="EMPNO" type="STRING" size="256"/>
          <Column id="SEQ" type="STRING" size="256"/>
          <Column id="DEPT_CD" type="STRING" size="256"/>
          <Column id="EMP_CD" type="STRING" size="256"/>
          <Column id="TITLE" type="STRING" size="256"/>
          <Column id="PYMNT_YM" type="STRING" size="256"/>
          <Column id="PYMNT_SE" type="STRING" size="256"/>
          <Column id="PYMNT_DE" type="STRING" size="256"/>
          <Column id="SALARY_SE" type="STRING" size="256"/>
          <Column id="SE" type="STRING" size="256"/>
          <Column id="SANCTN_NO" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ubiDataset" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DAY" type="STRING" size="256"/>
          <Column id="PYMNT_YM" type="STRING" size="256"/>
          <Column id="PYMNT_DE" type="STRING" size="256"/>
          <Column id="TOT_PYMNTAMT" type="STRING" size="256"/>
          <Column id="TOT_PYMNTAMT_H" type="STRING" size="256"/>
          <Column id="DDC_TOTAMT" type="STRING" size="256"/>
          <Column id="RL_RECPT_AMOUNT" type="STRING" size="256"/>
          <Column id="EMPNM" type="STRING" size="256"/>
          <Column id="EMPNM2" type="STRING" size="256"/>
          <Column id="EMPNM3" type="STRING" size="256"/>
          <Column id="EMPNM4" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ubiDataset2" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="TOT_PYMNTAMT" type="STRING" size="256"/>
          <Column id="TOT_PYMNTAMT_H" type="STRING" size="256"/>
          <Column id="DDC_TOTAMT" type="STRING" size="256"/>
          <Column id="RL_RECPT_AMOUNT" type="STRING" size="256"/>
          <Column id="DAY" type="STRING" size="256"/>
          <Column id="EMPNM" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="SALARY_BANK_ACNUT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond03" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="PYMNT_YM" type="STRING" size="256"/>
          <Column id="PYMNT_SE" type="STRING" size="256"/>
          <Column id="PYMNT_DE" type="STRING" size="256"/>
          <Column id="SALARY_SE" type="STRING" size="256"/>
          <Column id="SANCTN_NO" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_pymntDdcIem">
        <ColumnInfo>
          <Column id="PYMNT_DDC_SE" type="STRING" size="256"/>
          <Column id="PYMNT_DDC_CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_deptSalaryPymntList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="PYMNT_YM" type="STRING" size="256"/>
          <Column id="SN" type="STRING" size="256"/>
          <Column id="PYMNT_DE" type="STRING" size="256"/>
          <Column id="EMPNO" type="STRING" size="256"/>
          <Column id="EMPNM" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript5.0"><![CDATA[/***********************************************************************
 * 업무구분 : 월급여자료조회
 * 화면ID   : SAL030106
 * 화면명   : 월급여자료조회
 * 화면설명 : 월급여자료조회정보를 관리한다.
 * 작성일   : 2017.04.19
 * 작성자   : 이상명
 * 수정이력 : 
 ***********************************************************************
 *     수정일     수정자   내용
 ***********************************************************************
 *    
 ***********************************************************************/
 

/***********************************************************************
 * Script Include 
 ***********************************************************************/
include "lib::comInclude.xjs";
include "mis_lib::misUtil.xjs";

/***********************************************************************
 * 화면 변수 선언부
 ***********************************************************************/
this.checkDs = [
	 this.ds_pymnt_de
];

/***********************************************************************
 * onInit 영역
 ***********************************************************************/
this.SAL030106_oninit = function(obj:Form, e:nexacro.InitEventInfo)
{
	this.fn_init_form();
	this.fn_init_dataset();
	
}

/***********************************************************************
 * onLoad 영역
 ***********************************************************************/
this.SAL030106_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{
	
	this.ds_cond00.clearData();
	this.ds_cond00.addRow();
	this.ds_cond00.setColumn(0,"EMPL_SE","1");
	this.ds_cond00.setColumn(0,"SALARY_SE","1");
	
	this.div_search.spn_excclcYear.set_value(this.dateUtils.format(this.gfn_today(),"yyyy"));
	this.div_search.spn_excclcYear.setFocus(true);
	this.fn_loadCombo();
	this.fn_search();
}

/***********************************************************************
 * Form 오브젝트 초기화
 ***********************************************************************/ 
this.fn_init_form = function()
{
	this.gfn_initForm(this);	
    
}

/**********************************************************************
 * 설명: 공통조회
 ************************************************************************/
this.fn_loadCombo = function ()
{
	var comboParams = [
					   ["ds_rspofc", "HRM214", 1, ""],   // 직책
	                   ["ds_ofcps", "HRM021", 1, ""],    // 직위
	                   ["ds_jssfc", "HRM001", 1, "전체"]
		              ];

	this.gfn_comboLoad(comboParams, this.fn_callbackAfter);
}



/***********************************************************************
 * Dataset 오브젝트 초기화
 ***********************************************************************/ 
this.fn_init_dataset = function()
{
	this.gfn_initCondDs(this, this.div_search);	
}


this.fn_dynamicCol = function (grd:Grid, baseCellCnt:Number)
{	
	// 기존컬럼 남기고 삭제
	for(var i=grd.getCellCount("Head"); i> baseCellCnt; i--) {
		grd.deleteContentsCol(i-1);
	}
	
	var nCol 	   = 0;		// 추가된 컬럼 인덱스 
	var etcCol     = 0;		// 컬럼이 하나라도 존재한다면 '합계' 컬럼 생성
	var pymntCol   = 0;		// 컬럼이 하나라도 존재한다면 '지급항목' 컬럼 생성
	var ddcCol     = 0;		// 컬럼이 하나라도 존재한다면 '공제항목' 컬럼 생성
	var etcCnt     = 0;		// 합계의 컬럼 수
	var pymntCnt   = 0;		// 지급항목의 컬럼 수
	var ddcCnt     = 0;		// 공제항목의 컬럼 수
	var colNm      = "";	// 데이터셋의 컬럼명1
	var colNo      = 0;		// 데이터셋의 컬럼명2
	var headColCnt = grd.getFormatColCount();	// 기존컬럼 수
	
	// 급여지급현황그리드에 지급공제항목 컬럼 동적 생성
	for(var i=0; i<this.ds_pymntDdcIem.getRowCount(); i++) {
		
		// 열 추가
		nCol = grd.appendContentsCol("body", true);
		colNm = "AMT";
		colNo = this.ds_pymntDdcIem.getColumn(i, "PYMNT_DDC_CODE");
		
		// 합계
		if(this.ds_pymntDdcIem.getColumn(i, "PYMNT_DDC_SE") == null) {
		
			if(etcCol == 0) {
				etcCol = grd.setCellProperty("Head", 1, "text", "합계");
			}
			
			grd.mergeContentsCell("Head", 0, headColCnt, 0, headColCnt+etcCnt, 1, false);
			grd.setCellProperty("Head", nCol+2 ,"text", this.ds_pymntDdcIem.getColumn(i, "PYMNT_DDC_CODE_NM"));
			
			colNm = "ETC";
			colNo = etcCnt;
			etcCnt ++;
		
		// 지급항목
		}else if(this.ds_pymntDdcIem.getColumn(i, "PYMNT_DDC_SE") == 0) {
			if(pymntCol == 0) {
				pymntCol = grd.setCellProperty("Head", 2, "text", "지급항목");
			}
			// Head
			grd.mergeContentsCell("Head", 0, headColCnt+etcCnt, 0, (headColCnt+etcCnt)+pymntCnt, 2, false);
			grd.setCellProperty("Head", nCol+3, "text", this.ds_pymntDdcIem.getColumn(i, "PYMNT_DDC_CODE_NM"));
		
			pymntCnt ++;
		
		// 공제항목
		}else if(this.ds_pymntDdcIem.getColumn(i, "PYMNT_DDC_SE") == 1) {

			if(ddcCol == 0) {
				ddcCol = grd.setCellProperty("Head", 3, "text", "공제항목");
			}
			// Head
			grd.mergeContentsCell("Head", 0, headColCnt+etcCnt+pymntCnt, 0, (headColCnt+etcCnt+pymntCnt)+ddcCnt, 3, false);
			grd.setCellProperty("Head", nCol+4, "text", this.ds_pymntDdcIem.getColumn(i, "PYMNT_DDC_CODE_NM"));
		
			ddcCnt ++;
		}
		
		// Body 
		grd.setCellProperty("Body", nCol ,"align"      , "right middle");
		grd.setFormatColProperty(nCol, "size", 105);
		
		// Dataset 컬럼 생성 및 Body 바인드
		grd.setCellProperty("Body", nCol, "text", "bind:"+colNm+colNo);
	}
}

this.fn_dynamicSumm = function(ds:Dataset, grd:Grid) {
	
	var etcSummCnt = 0;
	var colNm;
	var colNo;
	
	for(var i=0; i<this.ds_pymntDdcIem.getRowCount(); i++) {
		colNm = "AMT"; 
		colNo = this.ds_pymntDdcIem.getColumn(i, "PYMNT_DDC_CODE");
		if(this.ds_pymntDdcIem.getColumn(i, "PYMNT_DDC_CODE") == null) {
			colNm = "ETC";
			colNo = etcSummCnt;
			etcSummCnt ++;
		}
		grd.setCellProperty("Summ", i+1, "text"       , ds.getSum(colNm+colNo));
		grd.setCellProperty("Summ", i+1, "displaytype", "number");
		grd.setCellProperty("Summ", i+1, "align"      , "right middle");
	}
}
/***********************************************************************
* 조회처리
************************************************************************/
this.fn_search = function()
{
	this.ds_pymnt_de.clearData();
	this.ds_deptSalaryPymntList.clearData();
	this.ds_empSalaryPymntList.clearData();	
	this.ds_SalaryPymntExpndtr.clearData();
	
	// Validation 체크
	if(!this.gfn_checkValidation_NoUpdChk(this.ds_cond00, this.ds_validation)) {
		return;
	}
	
	this.fn_transaction("selectSalaryPymntDeList");
}


/**********************************************************************
 * CALL TRANSACTION 영역
 **********************************************************************/ 
this.fn_transaction = function(strSvcId)
{
	switch (strSvcId) {
	    case "selectSalaryPymntDeList": 
			var sController   	= "hsco/mis/sal/SAL030106/selectMtSalaryList.do";
			var sInDatasets   	= "input1=ds_cond00";
			var sOutDatasets  	= "ds_pymnt_de=output1";
			break;
			/*
		case "selectSalaryPymntExpndtrList": 
			var sController   	= "hsco/mis/sal/SAL030106/selectSalaryPymntExpndtrList.do";
			var sInDatasets   	= "input1=ds_cond01";
			var sOutDatasets  	= "ds_empSalaryPymntList=output1 ds_SalaryPymntExpndtr=output2";
			break;
			*/
		case "saveSalaryPymntExpndtrList":	
			var sController   	= "hsco/mis/sal/SAL030106/SalaryPymntExpndtrCUD.do";	
			var sInDatasets   	= "input2=ds_SalaryPymntExpndtr:U";
			var sOutDatasets  	= "";
			break;
		// 해당 월의 지급공제항목 리스트
		case "selectPymntDdcIem":
			var sController   	= "hsco/mis/sal/SAL030106/selectPymntDdcIem.do";
			var sInDatasets   	= "input1=ds_cond01";
			var sOutDatasets  	= "ds_pymntDdcIem=output1";
			break;
		//  급여지급상세정보 조회 (부서별급여지급상세정보, 사원별급여지급상세정보)
		case "selectSalaryPymntList":
			var sController   	=  "hsco/mis/sal/SAL030106/selectSalaryPymntList.do";
			var sInDatasets   	=  "input1=ds_cond01";
			var sOutDatasets  	=  "ds_deptSalaryPymntList=output1";	// 탭1 : 부서별급여지급상세정보
			    sOutDatasets  	+= " ds_empSalaryPymntList=output2";		// 탭2 : 사원별급여지급상세정보
			break;
		// 전자결재
		case "approve":    						
			var sController   	= "hsco/mis/sal/SAL030106/approve.do";	
			var sInDatasets   	= "input1=ds_approve";
			var sOutDatasets  	= "ds_approve=output1";
			break;
		// 결재취소
		case "apprCancel":    					
			var sController   	= "hsco/mis/sal/SAL030106/apprCancel.do";	
			var sInDatasets   	= "input4=ds_cond03:U";
			var sOutDatasets  	= "";
			break;
	}

	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets); 
}

 /**********************************************************************
 * Transaction Callback 영역
 ***********************************************************************/ 
this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg)
{
	// 오류 및 성공 메시지를 화면에 보여준다.
	/*this.gfn_callback_message(strSvcId, nErrorCode, strErrorMsg);*/
	if (nErrorCode != 0){
		this.gfn_callback_message(strSvcId, nErrorCode, strErrorMsg);	
	} else {		
		switch (strSvcId) {
			case "selectSalaryPymntDeList":   
				break;
			/*
			case "selectSalaryPymntExpndtrList":    	     		      
				break;
			*/
			case "saveSalaryPymntExpndtrList":  
				this.fn_search();
				this.gfn_message("success.처리.성공");
				break;
			case "selectPymntDdcIem": 
			 	// Dataset에 합계 추가
				if(this.ds_pymntDdcIem.findRow("PYMNT_DDC_SE", 0) > -1) {
					var pymntArr = ["지급합계", "공제합계", "실수령액"]; 
					for(var i in pymntArr) {
						var nRow = this.ds_pymntDdcIem.insertRow(0);
						this.ds_pymntDdcIem.setColumn(nRow, "PYMNT_DDC_CODE_NM", pymntArr[(pymntArr.length-1)-i]);
					}
				}	
				// 지급공제항목에 맞게 동적컬럼 생성
				this.fn_dynamicCol(this.tab_salaryPymntList.tpg_deptSalaryPymntList.grd_deptSalaryPymntList, 4);
				this.fn_dynamicCol(this.tab_salaryPymntList.tpg_empSalaryPymntList.grd_empSalaryPymntList, 8);
				this.fn_transaction("selectSalaryPymntList");
				break;
			case "selectSalaryPymntList":  
				// Summary 합계액 및 속성 셋팅
				this.fn_dynamicSumm(this.ds_deptSalaryPymntList, this.tab_salaryPymntList.tpg_deptSalaryPymntList.grd_deptSalaryPymntList);
				this.fn_dynamicSumm(this.ds_empSalaryPymntList , this.tab_salaryPymntList.tpg_empSalaryPymntList.grd_empSalaryPymntList);
				break;
			case "approve":							// 전자결재
				var oUrl = this.ds_approve.getColumn(0,"O_URL");
				//system.execBrowser(oUrl);
				this.gfn_exportExcel(this.grd_mtSalaryPymntList, "mtSalaryPymnt", oUrl);	
				break;
			case "apprCancel":						// 결재취소
				this.fn_search();
				this.gfn_message("success.처리.성공");
				break;
		}
	}
}

/***********************************************************************************
* 설명	: 적용내역 클릭(행변경)
***********************************************************************************/
this.ds_pymnt_de_onrowposchanged = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{ 
	var result = false;

	this.ds_pymntDdcIem.clearData();
	this.ds_empSalaryPymntList.clearData();
		
	if(e.newrow>-1){
		if(this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition,"PYMNT_YM") && this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition,"SN")){ // 월급여지급내역에 지급일자가 존재한다면,
			
			this.ds_cond01.clearData();              // 조회 데이터셋 초기화
			var nRow = this.ds_cond01.addRow();      // 조회 데이터셋 행추가
			this.ds_cond01.setColumn(nRow,"SN",this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition,"SN")) 
			this.ds_cond01.setColumn(nRow,"PYMNT_YM",this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition,"PYMNT_YM")) 
			this.ds_cond01.setColumn(nRow,"PYMNT_DE",this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition,"PYMNT_DE")) 
			this.fn_transaction("selectPymntDdcIem");
			result = true;
		}
	}
	 
	if(!result){
		// 기존컬럼 남기고 삭제
		for(var i=this.grd_mtSalaryPymntList.getCellCount("Head"); i> 8; i--) {
			this.grd_mtSalaryPymntList.deleteContentsCol(i);
		}
	}
}

this.popupSactionStts = function(sanctnNo, registDt){
    var parm = {
		arg_0 : this,  
		arg_1 : sanctnNo,  // 결재번호
		arg_2 : registDt
	};
	
	/**
	* 팝업 공통함수
	* @param {string} svcId
	* @param {number} Width
	* @param {number} Height
	* @param {string} Title
	* @param {string} form URL
	* @param {string} Callback Function
	* @return N/A
	* @example
	* @memberOf comLib
	*/
	this.gfn_popup("COM010400_P01", 710, 580, "전자결재진행 현황", parm, "com::COM010400_P01.xfdl", "fn_callback5");
}

/***********************************************************************
* 헤드 정렬
************************************************************************/
this.grd_mtSalaryPymntList_onheadclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
    this.gfn_gridSort(obj, e); // Grid 데이터 정렬
}


/***********************************************************************************
* 설명	: 그리드의 내용을 엑셀파일로 다운로드
***********************************************************************************/
this.Excel_down_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
    this.gfn_exportExcel(this.grd_mtSalaryPymntList, "mtSalaryPymnt");	
}


/***********************************************************************************
* 설명	: 급여지급대장
***********************************************************************************/
this.btn_pymntList_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition,"PYMNT_YM")){
		 var nLeft = system.clientToScreenX(this, 10);
		 var nTop  = system.clientToScreenY(this, 10);

		 var newChild = new ChildFrame;
		 newChild.init("Popup2", "absolute", nLeft, nTop, 1000, 700, null, null, "mis_sal::SAL030106_P02.xfdl");

		 newChild.set_openalign("center middle");
		 newChild.set_dragmovetype("all"); 
		 newChild.set_showtitlebar(true);
		 var pymnt_ym = this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition,"PYMNT_YM");
		 var pymnt_de = this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition,"PYMNT_DE");
		 var pymnt_se = this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition,"PYMNT_SE");
		 var salary_se = this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition,"SALARY_SE");
		 newChild.showModal(this.getOwnerFrame(), {PYMNTYM:pymnt_ym,PYMNTDE:pymnt_de,PYMNTSE:pymnt_se,SALARYSE:salary_se}, this, "fn_callback3");
	}	 
}

/***********************************************************************************
* 설명	: 급여지급대장 팝업 콜백
***********************************************************************************/
this.fn_callback3 = function(sPopupId, sReturn)
{
	if(sPopupId == "Popup2")
	{
		
	}
}

/***********************************************************************************
* 설명	: 소득세명세서 클릭
***********************************************************************************/
this.btn_incmtaxList_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition,"PYMNT_YM")){
		 var nLeft = system.clientToScreenX(this, 10);
		 var nTop  = system.clientToScreenY(this, 10);

		 var newChild = new ChildFrame;
		 newChild.init("Popup2", "absolute", nLeft, nTop, 800, 700, null, null, "mis_sal::SAL030106_P03.xfdl");

		 newChild.set_openalign("center middle");
		 newChild.set_dragmovetype("all"); 
		 newChild.set_showtitlebar(true);
		 var pymnt_ym = this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition,"PYMNT_YM");
		 var pymnt_de = this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition,"PYMNT_DE");
		 var pymnt_se = this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition,"PYMNT_SE");
		 var salary_se = this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition,"SALARY_SE");
		 newChild.showModal(this.getOwnerFrame(), {PYMNTYM:pymnt_ym,PYMNTDE:pymnt_de,PYMNTSE:pymnt_se,SALARYSE:salary_se}, this, "fn_callback3");
	}	 
}

/***********************************************************************************
* 설명	: 장기근속수당 클릭
***********************************************************************************/
this.btn_pymntLong_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition,"PYMNT_YM") && this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition,"PYMNT_SE") == "2"){
		 var nLeft = system.clientToScreenX(this, 10);
		 var nTop  = system.clientToScreenY(this, 10);

		 var newChild = new ChildFrame;
		 newChild.init("Popup2", "absolute", nLeft, nTop, 800, 700, null, null, "mis_sal::SAL030106_P04.xfdl");

		 newChild.set_openalign("center middle");
		 newChild.set_dragmovetype("all"); 
		 newChild.set_showtitlebar(true);
		 var pymnt_ym = this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition,"PYMNT_YM");
		 var pymnt_de = this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition,"PYMNT_DE");
		 var pymnt_se = this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition,"PYMNT_SE");
		 var salary_se = this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition,"SALARY_SE");
		 newChild.showModal(this.getOwnerFrame(), {PYMNTYM:pymnt_ym,PYMNTDE:pymnt_de,PYMNTSE:pymnt_se,SALARYSE:salary_se}, this, "fn_callback3");
	}	 
}

/***********************************************************************************
* 설명	: 직원구분클릭
***********************************************************************************/
this.div_search_rad_excclcSe_onitemchanged = function(obj:Radio, e:nexacro.ItemChangeEventInfo)
{
	if (obj.value == "4") {
		this.btn_mtSalaryDtstmn.set_visible(true);
		this.btn_pymntLong.set_visible(false);
	} else {
		this.btn_mtSalaryDtstmn.set_visible(false);
		this.btn_pymntLong.set_visible(true);
	}
	this.fn_search();
}

/***********************************************************************************
* 설명	: 결재
***********************************************************************************/
this.fn_sanction = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	
	// 전자결재 상태 체크 2016.7
	// 기안상태 COM022 (0:기안전 1:기안 9:기안오류)
	// 결재상태 COM023 (1: 진행 2:보류 4:대기 8:협조대기 32:삭제 256:완료 512:반송 4096:취소 1024:참조 NUL:상신전 DUP:결재중복)
	// 기안전인것 : 재상신 및 수정/삭제
	// 결재상태가 상신전 외는 신규로 다시 진행.
	var sanctnKnd = this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "SANCTN_STS");
	
	switch (sanctnKnd) {
		case "1": case "2": case "4": case "8": case "1024": case "DUP":
		this.gfn_message("comm.결재.진행");
		return false;
		
		case "32": case "256": case "512": case "4096": 
		this.gfn_message("comm.결재.완료");
		return false;
		
		default:
	}		

    if(this.ds_SalaryPymntExpndtr.rowcount == 0 ){
		this.ds_approve.clearData();	
		this.ds_approve.addRow();
		
		this.ds_cond02.clearData();	
		this.ds_cond02.addRow();
		this.ds_cond02.setColumn(0, "PYMNT_YM",  this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "PYMNT_YM"));
		this.ds_cond02.setColumn(0, "PYMNT_SE",  this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "PYMNT_SE"));
		this.ds_cond02.setColumn(0, "PYMNT_DE",  this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "PYMNT_DE"));
		this.ds_cond02.setColumn(0, "SALARY_SE", this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "SALARY_SE"));
		
		var strSvcId     = "selectSalaryPymntReportList";
		var sController  = "hsco/mis/sal/SAL030106/selectSalaryPymntReportList.do";
		var sInDatasets  = "input7=ds_cond02";
		var sOutDatasets = "ds_ubiDataset=output7 ds_ubiDataset2=output8";
		var argument = "";
		var callbackfunc = "";
		var showprogress = "";
		var bAsync = false;
		Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets, argument, callbackfunc, showprogress, bAsync);  
		
		// 복리후생비
		if(this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "PYMNT_SE") == "1"){
			 this.ds_approve.setColumn(0, "SE", "1"); // 결재구분500
			 var ym = this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "PYMNT_YM");
			 var de = this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "PYMNT_DE");
			 var year   = ym.substr(0,4);
			 var mm     = ym.substr(4,2);
			 var year2  = de.substr(0,4);
			 var mm2    = de.substr(4,2);
			 var dd2    = de.substr(6,2);
			 var title1  = "복리후생비 지급 및 공제(" + year + "년도 " + mm + "월)";
			 var title2 = year + "년도 "+ mm + "월분 복리후생비를 다음과 같이 지급하고 식권비용 등을 공제코자 합니다.";
			 var title3 = "금"+ this.comUtils.formatComma(this.ds_ubiDataset.getColumn(0,"TOT_PYMNTAMT"))+"원("+this.ds_ubiDataset.getColumn(0,"TOT_PYMNTAMT_H")+"정)";
			
			var filds = new Array(10);
			
			filds[0] = title2;
			filds[1] = title3;
			filds[2] = this.comUtils.formatComma(this.ds_ubiDataset.getColumn(0,"TOT_PYMNTAMT"));
			filds[3] = this.comUtils.formatComma(this.ds_ubiDataset.getColumn(0,"DDC_TOTAMT"));
			filds[4] = this.comUtils.formatComma(this.ds_ubiDataset.getColumn(0,"RL_RECPT_AMOUNT"));
			filds[5] = this.ds_ubiDataset.getColumn(0,"EMPNM");
			filds[6] = year2+". "+ mm2 +". "+ dd2+"(" + this.ds_ubiDataset.getColumn(0,"DAY") + ")";
			filds[7] = year + "년 " + mm + "월";
			filds[8] = year + "년 " + mm + "월 복리후생지 지급내역 1부. 끝.";
			
			var dataValue = filds.join("|");
			var dataTitle = title1;
			var title     = title1;
		
		// 급여     
		} else if(this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "PYMNT_SE") == "2"){
			 this.ds_approve.setColumn(0, "SE", "2"); // 결재구분501
			 var ym = this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "PYMNT_YM");
			 var de = this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "PYMNT_DE");
			 var year   = ym.substr(0,4);
			 var mm     = ym.substr(4,2);
			 var year2  = de.substr(0,4);
			 var mm2    = de.substr(4,2);
			 var dd2    = de.substr(6,2);
			 var title1  = "급여 지급 및 공제(" + year + "년도 " + mm + "월)";
			 var title2 = year + "년도 "+ mm + "월분 임직원 급여를 다음과 같이 지급하고 근로소득 및 4대 사회보험료 등 기타 원천징수금액을 공제코자 합니다.";
			 var title3 = "금"+ this.comUtils.formatComma(this.ds_ubiDataset.getColumn(0,"TOT_PYMNTAMT"))+"원("+this.ds_ubiDataset.getColumn(0,"TOT_PYMNTAMT_H")+"정)";
			
			var filds = new Array(10);
			
			filds[0] = title2;
			filds[1] = title3;
			filds[2] = this.comUtils.formatComma(this.ds_ubiDataset.getColumn(0,"TOT_PYMNTAMT"));
			filds[3] = this.comUtils.formatComma(this.ds_ubiDataset.getColumn(0,"DDC_TOTAMT"));
			filds[4] = this.comUtils.formatComma(this.ds_ubiDataset.getColumn(0,"RL_RECPT_AMOUNT"));
			filds[5] = "임원 " + this.ds_ubiDataset.getColumn(0,"EMPNM2") + "명 직원 " + this.ds_ubiDataset.getColumn(0,"EMPNM3") + "명";
			filds[6] = "육아휴직 " + this.ds_ubiDataset.getColumn(0,"EMPNM4") +"명";
			filds[7] = year2+". "+ mm2 +". "+ dd2+"(" + this.ds_ubiDataset.getColumn(0,"DAY") + ")";
			filds[8] = year + "년 " + mm + "월 급여지급조서 1부. 끝.";
			
			var dataValue = filds.join("|");
			var dataTitle = title1;
			var title     = title1;
			
			
		// 계약직     
		} else if(this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "PYMNT_SE") == "4"){
			 
			 this.ds_approve.setColumn(0, "SE", "3"); // 결재구분502
		     var ym = this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "PYMNT_YM");
			 var de = this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "PYMNT_DE");
			 var year   = ym.substr(0,4);
			 var mm     = ym.substr(4,2);
			 var year2  = de.substr(0,4);
			 var mm2    = de.substr(4,2);
			 var dd2    = de.substr(6,2);
			 var title1  = "계약직 관리소장 급여지급(" + year + "년도 " + mm + "월)";
			 var title2 = year + "년도 "+ mm + "월분 영구임대주택 관리소장 급여를 다음과 같이 지급하고, 근로소득세 및 4대 사회보험료 등 기타 원천징수금액을 공제코저 합니다.";
			 var title3 = "금"+ this.comUtils.formatComma(this.ds_ubiDataset.getColumn(0,"TOT_PYMNTAMT"))+"원("+this.ds_ubiDataset.getColumn(0,"TOT_PYMNTAMT_H")+"정)";
			
			var filds = new Array(10);
			
			//2016.08.26
			filds[0] = title2;
			filds[1] = title3;
			filds[2] = this.ds_ubiDataset.getColumn(0,"EMPNM");
			filds[3] = this.comUtils.formatComma(this.ds_ubiDataset.getColumn(0,"TOT_PYMNTAMT"));
			filds[4] = this.comUtils.formatComma(this.ds_ubiDataset.getColumn(0,"DDC_TOTAMT"));
			filds[5] = this.comUtils.formatComma(this.ds_ubiDataset.getColumn(0,"RL_RECPT_AMOUNT"));
			if(this.ds_ubiDataset2.rowcount > 1){
				filds[6] = "별도기재";
			}else{
				filds[6] = this.ds_ubiDataset2.getColumn(0,"CODE_NM") + " " + this.ds_ubiDataset2.getColumn(0,"SALARY_BANK_ACNUT");
			}
			
			filds[7] = year2+". "+ mm2 +". "+ dd2+"(" + this.ds_ubiDataset.getColumn(0,"DAY") + ")";
			filds[8] = year + "년 " + mm + "월 계약직 관리소장 급여지급내역 1부. 끝.";
			
			var dataValue = filds.join("|");
			var dataTitle = title1;
			var title     = title1;
		}			
		
		//alert("dataValue = " + dataValue);
		//2016.7 전자결재
		var sanctn_no = this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "SANCTN_NO") ;
		this.ds_approve.setColumn(0, "SANCTN_NO", sanctn_no);	
		
		this.ds_approve.setColumn(0, "TITLE", 		title);
		this.ds_approve.setColumn(0, "DATA_TITLE", 	dataTitle);
		this.ds_approve.setColumn(0, "DATA_VALUE", 	dataValue);
		this.ds_approve.setColumn(0, "DEPT_CD", 	this.gfn_getDeptId());
		this.ds_approve.setColumn(0, "EMP_CD", 		this.fn_getEmpno());
		this.ds_approve.setColumn(0, "EMPNO", 		this.fn_getEmpno());		
		this.ds_approve.setColumn(0, "PYMNT_YM", 	this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "PYMNT_YM"));
		this.ds_approve.setColumn(0, "PYMNT_DE", 	this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "PYMNT_DE"));
		this.ds_approve.setColumn(0, "PYMNT_SE", 	this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "PYMNT_SE"));
		this.ds_approve.setColumn(0, "SALARY_SE", 	this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "SALARY_SE"));
		
		this.fn_transaction("approve");
	}	
}

/***********************************************************************************
* 설명	: 결재상태보기(월급여지급내역 행클릭)
***********************************************************************************/
this.grd_pymnt_de_oncellclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	if(e.cell == 0) {
		obj.setCellProperty("Head", e.cell, "text", "0");
	}

	// column index 확인. 전자결재
	if(e.col == 6) {
		var sanctnNo 	= this.ds_pymnt_de.getColumn(e.row, "SANCTN_NO");
		var registDt 	= this.ds_pymnt_de.getColumn(e.row, "PYMNT_DE");
		if(sanctnNo){
			this.popupSactionStts(sanctnNo, registDt);
		}			
	}
}

this.btn_apprCancel_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var sanctnKnd 	= this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "SANCTN_STS");		// 결재상태

	if (sanctnKnd == "256") {
		if(this.confirm("결재취소 하시겠습니까?")) {
			this.ds_cond03.clearData();	
			this.ds_cond03.addRow();
			this.ds_cond03.setColumn(0, "PYMNT_YM",  this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "PYMNT_YM"));
			this.ds_cond03.setColumn(0, "PYMNT_SE",  this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "PYMNT_SE"));
			this.ds_cond03.setColumn(0, "PYMNT_DE",  this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "PYMNT_DE"));
			this.ds_cond03.setColumn(0, "SALARY_SE",  this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "SALARY_SE"));
			this.ds_cond03.setColumn(0, "SANCTN_NO",  this.ds_pymnt_de.getColumn(this.ds_pymnt_de.rowposition, "SANCTN_NO"));	// 결재번호

			this.fn_transaction("apprCancel");
		}
	} else {
		this.alert("결재상태가 완료인 상태만 결재취소가 가능합니다.");
	}
}

 /**********************************************************************
 * 급여명세서 출력
 ***********************************************************************/ 
this.btn_mtSalaryDtstmn_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.ds_empSalaryPymntList.getRowCount() > 0){
		var vOpts = new this.cf_Opts();
		
		vOpts.setToolbar(false);
		vOpts.setScale(100);
		vOpts.setReportPath("/mis/sal/SAL030106_R01.jrf");
		vOpts.setSaveFilename("급여명세서");
		vOpts.setLocalDs(["ds_empSalaryPymntList", this.ds_empSalaryPymntList]);
		
		var parm = {
			arg_0 : this,  //==> 필수, 팝업을 호출하는 form을 참조할 수 있도록 팝업에 Argument로 넘겨준다. (반드시 기술해야 함.)
			opts : vOpts
		};

		this.gfn_popup("Popup_Report", 884, 735, "급여명세서", parm, "common::frmReportPopup.xfdl", "report_callback");
	} else {
	    this.alert("조회후 출력하세요!");
	}	
}
]]></Script>
  </Form>
</FDL>
