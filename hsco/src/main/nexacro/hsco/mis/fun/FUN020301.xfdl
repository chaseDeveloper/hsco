<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\default_typedef.xml"/>
  <Form id="FUN020301" classname="FUN020301" left="0" top="0" width="1059" height="708" titletext="상환내역관리" oninit="FUN020301_oninit" onload="FUN020301_onload">
    <Layouts>
      <Layout>
        <Div id="div_search" taborder="0" left="0" top="0" height="33" style="padding:0 0 0 0;" cssclass="div_WFSA_Box" right="28">
          <Layouts>
            <Layout>
              <Static id="Static00" taborder="50" text="15" visible="false" left="0" top="2" width="15" height="34" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="Static09" taborder="54" text="9" visible="false" left="9" top="32" width="1000" height="9" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="sta_budgetAcntSe00" taborder="68" text="공사채" left="15" top="5" height="21" width="51" cssclass="sta_WFSA_Label"/>
              <Static id="Static11" taborder="71" text="5" visible="false" left="60" top="2" width="5" height="34" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Edit id="edt_pbncdNo" taborder="72" maxlength="20" left="65" top="5" width="112" height="22" style="align:left middle;" readonly="true" cssclass="edt_WF_Essential" lengthunit="ascii"/>
              <Button id="btn_pbncd" taborder="0" top="5" width="21" height="22" onclick="div_search_btn_pbncd_onclick" cssclass="btn_WF_Search" left="152"/>
              <Edit id="edt_BRRW_ACNUT_NM" taborder="73" readonly="true" lengthunit="utf8" maxlength="100" autoselect="true" onkeyup="edt_BSNS_CODE_onkeyup" cssclass="edt_WF_Readonly" left="179" top="6" width="233" height="21" style="align:left middle;"/>
            </Layout>
          </Layouts>
          <InitValue/>
        </Div>
        <Static id="Static09" taborder="3" text="10" visible="false" left="9" top="33" width="1000" height="10" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
        <Static id="sta_title01" taborder="1" text="기본정보" cssclass="sta_WF_Title02" left="0" top="37" right="947" height="26" style="align:left middle;"/>
        <Static id="Static01" taborder="5" text="5" visible="false" left="8" top="56" width="1000" height="5" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
        <Div id="div_work" taborder="6" left="0" top="61" right="28" bottom="0">
          <Layouts>
            <Layout>
              <Static id="sta_WFDA_Label19" taborder="354" cssclass="sta_WF_Labelbg" left="0" top="52" height="27" right="0"/>
              <Static id="sta_WFDA_Label15" taborder="264" cssclass="sta_WF_Labelbg" left="898" top="130" height="27" right="14"/>
              <Static id="sta_WFDA_Label24" taborder="291" cssclass="sta_WF_Labelbg" left="898" top="130" height="27" right="0"/>
              <Static id="sta_WFDA_Label29" taborder="243" cssclass="sta_WF_Labelbg" left="652" top="182" height="27" right="0"/>
              <Static id="sta_WFDA_Label01" taborder="244" cssclass="sta_WF_Labelbg" left="0" top="0" height="27" right="0"/>
              <Edit id="edt_PBNCD_NO" taborder="245" readonly="true" lengthunit="utf8" maxlength="20" onkeyup="edt_BSNS_CODE_onkeyup" cssclass="edt_WF_Readonly" left="95" top="3" width="163" height="21" style="align:left middle;"/>
              <Static id="Static07" taborder="246" text="10" visible="false" left="26" top="232" width="950" height="10" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="sta_title00" taborder="247" text="상환내역 및 계획" cssclass="sta_WF_Title02" left="0" right="904" height="26" style="align:left middle;" top="211"/>
              <Static id="Static08" taborder="248" text="5" visible="false" left="26" top="209" width="950" height="5" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Tab id="tab_pbncd" taborder="249" left="0" top="242" right="0" bottom="0" tabindex="0" scrollbars="autoboth" style="showextrabutton:false;" onchanged="div_work_tab_pbncd_onchanged">
                <Tabpages>
                  <Tabpage id="tpg1" text="이자지급계획">
                    <Layouts>
                      <Layout>
                        <Grid id="grd_intrRpayPlan" taborder="12" binddataset="ds_intrRpayPlan" autoenter="select" useinputpanel="false" autofittype="col" oncellclick="div_work_tab_pbncd_tpg1_grd_intrRpayPlan_oncellclick" left="1" top="29" right="1" bottom="1" oncelldblclick="div_work_tab_pbncd_tpg1_grd_intrRpayPlan_oncelldblclick">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="40"/>
                                <Column size="50"/>
                                <Column size="80"/>
                                <Column size="117"/>
                                <Column size="150"/>
                                <Column size="150"/>
                                <Column size="250"/>
                                <Column size="70"/>
                                <Column size="40"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                                <Row size="24" band="summ"/>
                              </Rows>
                              <Band id="head">
                                <Cell text="결재"/>
                                <Cell col="1" text="확정여부"/>
                                <Cell col="2" text="결재상태"/>
                                <Cell col="3" text="지급일자"/>
                                <Cell col="4" text="적용금리"/>
                                <Cell col="5" text="지급액"/>
                                <Cell col="6" text="적요"/>
                                <Cell col="7" text="결의서"/>
                                <Cell col="8" text="선택"/>
                              </Band>
                              <Band id="body">
                                <Cell displaytype="expr:UPDATE_POSBL_AT == '1' ? 'checkbox' : 'none'" text="bind:CHK"/>
                                <Cell col="1" displaytype="checkbox" edittype="expr:EXPRTN_AT == '1' ? 'none' : 'checkbox'" text="bind:CNFIRM_AT"/>
                                <Cell col="2" displaytype="image" text="expr:comp.parent.parent.parent.parent.fn_get_imgUrl(SANCTN_STS)"/>
                                <Cell col="3" displaytype="date" edittype="expr:UPDATE_POSBL_AT == '1' ? 'date' : 'none'" text="bind:RPAY_DE" calendardisplay="expr:UPDATE_POSBL_AT == '1' ? 'display' : 'edit'" calendardisplaynulltype="none"/>
                                <Cell col="4" edittype="expr:UPDATE_POSBL_AT == '1' ? 'masknumber' : 'none'" style="align:right middle;padding:0 5 0 0;" text="bind:RPAY_INTRT" mask="!###.###%" editdisplay="expr:UPDATE_POSBL_AT == '1' ? 'display' : 'edit'" editlimitbymask="both"/>
                                <Cell col="5" displaytype="number" edittype="expr:UPDATE_POSBL_AT == '1' ? 'masknumber' : 'none'" style="align:right;padding:0 5 0 0;" text="bind:RPAY_AMOUNT" mask="!###,###,###,###,###" editdisplay="expr:UPDATE_POSBL_AT == '1' ? 'display' : 'edit'" editlimitbymask="integer"/>
                                <Cell col="6" edittype="expr:UPDATE_POSBL_AT == '1' ? 'normal' : 'none'" style="align:left middle;padding:0 0 0 5;" text="bind:SUMRY" editdisplay="expr:UPDATE_POSBL_AT == '1' ? 'display' : 'edit'"/>
                                <Cell col="7" displaytype="button" text="expr:!EXPNDTR_DECSN_NO? '발행' : '조회'"/>
                                <Cell col="8" displaytype="checkbox" text="bind:CHK2"/>
                              </Band>
                              <Band id="summary">
                                <Cell/>
                                <Cell col="1"/>
                                <Cell col="2"/>
                                <Cell col="3"/>
                                <Cell col="4" text="합계"/>
                                <Cell col="5" displaytype="number" text="expr:dataset.getSum(&quot;RPAY_AMOUNT&quot;)"/>
                                <Cell col="6"/>
                                <Cell col="7"/>
                                <Cell col="8"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                        <Static id="Static00" taborder="13" text="5" visible="false" left="0" top="0" right="0" height="5" style="background:#dc143c3c;align:center middle;"/>
                        <Static id="Static01" taborder="14" text="5" visible="false" left="0" top="24" right="0" height="5" style="background:#dc143c3c;align:center middle;"/>
                        <Button id="btn_planCreat" taborder="15" text="계획생성" onclick="fn_planCreat" cssclass="btn_WF_Process" top="5" right="135" width="81" height="19"/>
                        <Static id="sta_title00" taborder="16" text="이자지급계획" cssclass="sta_WF_Title02" left="1" top="1" width="126" height="26" style="align:left middle;"/>
                        <Button id="btn_insert" taborder="17" text="행추가" onclick="fn_insert" cssclass="btn_WF_Gridadd" top="5" right="67" width="64" height="19"/>
                        <Button id="btn_delete" taborder="18" text="행삭제" onclick="fn_delete" cssclass="btn_WF_Griddel" top="5" right="1" width="64" height="19"/>
                        <Button id="btn_excelImpot01" taborder="20" onclick="btn_EXCEL_IMP_onclick" cssclass="btn_WF_Gridexcelup" top="5" right="223" width="25" height="19" visible="false"/>
                        <Grid id="grd_uploadFormat" autoenter="select" useinputpanel="false" autofittype="col" left="652" top="207" right="14" bottom="28" summarytype="top" visible="false">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="117"/>
                                <Column size="150"/>
                                <Column size="150"/>
                                <Column size="250"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24" band="summ"/>
                              </Rows>
                              <Band id="head">
                                <Cell text="일자"/>
                                <Cell col="1" text="적용금리"/>
                                <Cell col="2" text="금액"/>
                                <Cell col="3" text="적요"/>
                              </Band>
                              <Band id="summary">
                                <Cell style="align:center;" text="20170101"/>
                                <Cell col="1" text="4.02"/>
                                <Cell col="2" displaytype="number" text="100000"/>
                                <Cell col="3" style="align:left;" text="(예시행 이므로 삭제 후 업로드 요망)"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="tpg2" text="원금상환계획">
                    <Layouts>
                      <Layout>
                        <Grid id="grd_prncpalRpayPlan" taborder="11" binddataset="ds_prncpalRpayPlan" autoenter="select" useinputpanel="false" autofittype="col" oncellclick="div_work_tab_pbncd_tpg2_grd_prncpalRpayPlan_oncellclick" left="1" top="29" right="1" bottom="1" oncelldblclick="div_work_tab_pbncd_tpg2_grd_prncpalRpayPlan_oncelldblclick">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="40"/>
                                <Column size="50"/>
                                <Column size="80"/>
                                <Column size="117"/>
                                <Column size="150"/>
                                <Column size="150"/>
                                <Column size="250"/>
                                <Column size="70"/>
                                <Column size="40"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                                <Row size="24" band="summ"/>
                              </Rows>
                              <Band id="head">
                                <Cell text="결재"/>
                                <Cell col="1" text="확장여부"/>
                                <Cell col="2" text="결재상태"/>
                                <Cell col="3" text="상환일자"/>
                                <Cell col="4" text="적용금리"/>
                                <Cell col="5" text="상환액"/>
                                <Cell col="6" text="적요"/>
                                <Cell col="7" text="결의서"/>
                                <Cell col="8" text="선택"/>
                              </Band>
                              <Band id="body">
                                <Cell displaytype="expr:UPDATE_POSBL_AT == '1' ? 'checkbox' : 'none'" text="bind:CHK"/>
                                <Cell col="1" displaytype="checkbox" edittype="expr:EXPRTN_AT == '1' ? 'none' : 'checkbox'" text="bind:CNFIRM_AT"/>
                                <Cell col="2" displaytype="image" text="expr:comp.parent.parent.parent.parent.fn_get_imgUrl(SANCTN_STS)"/>
                                <Cell col="3" displaytype="date" edittype="expr:UPDATE_POSBL_AT == '1' ? 'date' : 'none'" text="bind:RPAY_DE" calendardisplay="expr:UPDATE_POSBL_AT == '1' ? 'display' : 'edit'" calendardisplaynulltype="none"/>
                                <Cell col="4" edittype="expr:UPDATE_POSBL_AT == '1' ? 'masknumber' : 'none'" style="align:right middle;padding:0 5 0 0;" text="bind:RPAY_INTRT" mask="!###.###%" editdisplay="expr:UPDATE_POSBL_AT == '1' ? 'display' : 'edit'" editlimitbymask="both"/>
                                <Cell col="5" displaytype="number" edittype="expr:UPDATE_POSBL_AT == '1' ? 'masknumber' : 'none'" style="align:right;padding:0 5 0 0;" text="bind:RPAY_AMOUNT" mask="!###,###,###,###,###" editdisplay="expr:UPDATE_POSBL_AT == '1' ? 'display' : 'edit'" editlimitbymask="integer"/>
                                <Cell col="6" edittype="expr:UPDATE_POSBL_AT == '1' ? 'normal' : 'none'" style="align:left middle;padding:0 0 0 5;" text="bind:SUMRY" editdisplay="expr:UPDATE_POSBL_AT == '1' ? 'display' : 'edit'"/>
                                <Cell col="7" displaytype="button" text="expr:!EXPNDTR_DECSN_NO? '발행' : '조회'"/>
                                <Cell col="8" displaytype="checkbox" text="bind:CHK2"/>
                              </Band>
                              <Band id="summary">
                                <Cell/>
                                <Cell col="1"/>
                                <Cell col="2"/>
                                <Cell col="3"/>
                                <Cell col="4" text="합계"/>
                                <Cell col="5" displaytype="number" text="expr:dataset.getSum(&quot;RPAY_AMOUNT&quot;)"/>
                                <Cell col="6"/>
                                <Cell col="7"/>
                                <Cell col="8"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                        <Static id="Static01" taborder="12" text="5" visible="false" left="0" top="24" right="0" height="5" style="background:#dc143c3c;align:center middle;"/>
                        <Static id="Static00" taborder="13" text="5" visible="false" left="0" top="0" right="0" height="5" style="background:#dc143c3c;align:center middle;"/>
                        <Button id="btn_planCreat" taborder="14" text="계획생성" onclick="fn_planCreat" cssclass="btn_WF_Process" top="5" right="134" width="81" height="19"/>
                        <Static id="sta_title00" taborder="15" text="원금상환계획" cssclass="sta_WF_Title02" left="1" top="1" width="126" height="26" style="align:left middle;"/>
                        <Button id="btn_delete" taborder="17" text="행삭제" onclick="fn_delete" cssclass="btn_WF_Griddel" top="5" right="1" width="64" height="19"/>
                        <Button id="btn_insert" taborder="18" text="행추가" onclick="fn_insert" cssclass="btn_WF_Gridadd" top="5" right="67" width="64" height="19"/>
                        <Button id="btn_excelImpot02" taborder="19" onclick="btn_EXCEL_IMP_onclick" cssclass="btn_WF_Gridexcelup" top="5" right="231" width="25" height="19"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="tpg3" text="이자지급내역">
                    <Layouts>
                      <Layout>
                        <Grid id="grd_intrRpayDtls" taborder="12" binddataset="ds_intrRpayDtls" useinputpanel="false" autofittype="col" left="1" top="29" right="1" bottom="1">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="117"/>
                                <Column size="150"/>
                                <Column size="150"/>
                                <Column size="250"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                                <Row size="24" band="summ"/>
                              </Rows>
                              <Band id="head">
                                <Cell text="지급일자"/>
                                <Cell col="1" text="적용금리"/>
                                <Cell col="2" text="지급액"/>
                                <Cell col="3" text="적요"/>
                              </Band>
                              <Band id="body">
                                <Cell displaytype="date" edittype="expr:comp.parent.parent.parent.parent.ds_pbncdInfo.getColumn(0, &quot;EXPRTN_AT&quot;) == '1' ? 'none':'date'" text="bind:RPAY_DE" calendardisplaynulltype="none"/>
                                <Cell col="1" edittype="expr:comp.parent.parent.parent.parent.ds_pbncdInfo.getColumn(0, &quot;EXPRTN_AT&quot;) == '1' ? 'none':'masknumber'" style="align:right middle;padding:0 5 0 0;" text="bind:RPAY_INTRT" mask="!###.###%" editlimitbymask="both"/>
                                <Cell col="2" displaytype="number" edittype="expr:comp.parent.parent.parent.parent.ds_pbncdInfo.getColumn(0, &quot;EXPRTN_AT&quot;) == '1' ? 'none':'masknumber'" style="align:right;padding:0 5 0 0;" text="bind:RPAY_AMOUNT" mask="!###,###,###,###,###" editlimitbymask="integer"/>
                                <Cell col="3" edittype="normal" style="align:left middle;padding:0 0 0 5;" text="bind:SUMRY"/>
                              </Band>
                              <Band id="summary">
                                <Cell/>
                                <Cell col="1" text="합계"/>
                                <Cell col="2" displaytype="number" text="expr:dataset.getSum(&quot;RPAY_AMOUNT&quot;)"/>
                                <Cell col="3"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                        <Static id="Static01" taborder="13" text="5" visible="false" left="0" top="24" right="0" height="5" style="background:#dc143c3c;align:center middle;"/>
                        <Static id="Static00" taborder="14" text="5" visible="false" left="0" top="0" right="0" height="5" style="background:#dc143c3c;align:center middle;"/>
                        <Static id="sta_title00" taborder="15" text="이자지급내역" cssclass="sta_WF_Title02" left="1" top="1" width="126" height="26" style="align:left middle;"/>
                        <Button id="btn_planLoad" taborder="16" text="자료가져오기(전체)" onclick="div_work_tab_pbncd_tpg3_btn_planLoad_onclick" cssclass="btn_WF_Process" top="5" right="198" width="120" height="19"/>
                        <Button id="btn_save" taborder="17" text="저장" onclick="fn_save" cssclass="btn_WF_Process" top="5" right="0" width="64" height="19"/>
                        <Button id="btn_delete" taborder="18" text="행삭제" onclick="fn_delete" cssclass="btn_WF_Griddel" top="5" right="66" width="64" height="19"/>
                        <Button id="btn_insert" taborder="19" text="행추가" onclick="fn_insert" cssclass="btn_WF_Gridadd" top="5" right="132" width="64" height="19"/>
                        <Button id="btn_planLoad2" taborder="20" text="자료가져오기(선택)" cssclass="btn_WF_Process" top="5" right="320" width="120" height="19" onclick="div_work_tab_pbncd_tpg3_btn_planLoad2_onclick"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="tpg4" text="원금상환내역">
                    <Layouts>
                      <Layout>
                        <Grid id="grd_prncpalRpayDtls" taborder="12" binddataset="ds_prncpalRpayDtls" useinputpanel="false" autofittype="col" left="1" top="29" right="1" bottom="1">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="117"/>
                                <Column size="150"/>
                                <Column size="150"/>
                                <Column size="250"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                                <Row size="24" band="summ"/>
                              </Rows>
                              <Band id="head">
                                <Cell text="상환일자"/>
                                <Cell col="1" text="적용금리"/>
                                <Cell col="2" text="상환액"/>
                                <Cell col="3" text="적요"/>
                              </Band>
                              <Band id="body">
                                <Cell displaytype="date" edittype="expr:comp.parent.parent.parent.parent.ds_pbncdInfo.getColumn(0, &quot;EXPRTN_AT&quot;) == '1' ? 'none':'date'" text="bind:RPAY_DE" calendardisplaynulltype="none"/>
                                <Cell col="1" displaytype="normal" edittype="expr:comp.parent.parent.parent.parent.ds_pbncdInfo.getColumn(0, &quot;EXPRTN_AT&quot;) == '1' ? 'none':'masknumber'" style="align:right middle;padding:0 5 0 0;" text="bind:RPAY_INTRT" mask="!###.###%" editlimitbymask="both"/>
                                <Cell col="2" displaytype="number" edittype="expr:comp.parent.parent.parent.parent.ds_pbncdInfo.getColumn(0, &quot;EXPRTN_AT&quot;) == '1' ? 'none':'masknumber'" style="align:right;padding:0 5 0 0;" text="bind:RPAY_AMOUNT" mask="!###,###,###,###,###" editlimitbymask="integer"/>
                                <Cell col="3" edittype="normal" style="align:left middle;padding:0 0 0 5;" text="bind:SUMRY"/>
                              </Band>
                              <Band id="summary">
                                <Cell/>
                                <Cell col="1" text="합계"/>
                                <Cell col="2" displaytype="number" text="expr:dataset.getSum(&quot;RPAY_AMOUNT&quot;)"/>
                                <Cell col="3"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                        <Static id="Static01" taborder="13" text="5" visible="false" left="0" top="24" right="0" height="5" style="background:#dc143c3c;align:center middle;"/>
                        <Static id="Static00" taborder="14" text="5" visible="false" left="0" top="0" right="0" height="5" style="background:#dc143c3c;align:center middle;"/>
                        <Button id="btn_exprtnAt" taborder="15" text="만기처리" onclick="btn_exprtnAt_onclick" cssclass="btn_WF_Process" top="5" right="443" width="60" height="19"/>
                        <Static id="sta_title00" taborder="16" text="원금상환내역" cssclass="sta_WF_Title02" left="1" top="1" width="126" height="26" style="align:left middle;"/>
                        <Button id="btn_planLoad" taborder="17" text="자료가져오기(전체)" onclick="div_work_tab_pbncd_tpg4_btn_planLoad_onclick" cssclass="btn_WF_Process" top="5" right="198" width="120" height="19"/>
                        <Button id="btn_save" taborder="18" text="저장" onclick="fn_save" cssclass="btn_WF_Process" top="5" right="0" width="64" height="19"/>
                        <Button id="btn_delete" taborder="19" text="행삭제" onclick="fn_delete" cssclass="btn_WF_Griddel" top="5" right="66" width="64" height="19"/>
                        <Button id="btn_insert" taborder="20" text="행추가" onclick="fn_insert" cssclass="btn_WF_Gridadd" top="5" right="132" width="64" height="19"/>
                        <Button id="btn_planLoad2" taborder="21" text="자료가져오기(선택)" cssclass="btn_WF_Process" top="5" right="320" width="120" height="19" onclick="div_work_tab_pbncd_tpg4_btn_planLoad2_onclick"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                </Tabpages>
              </Tab>
              <Static id="sta_WFDA_Label23" taborder="250" cssclass="sta_WF_Labelbg" left="898" top="78" height="27" right="0"/>
              <Static id="sta_WFDA_Label00" taborder="251" cssclass="sta_WF_Labelbg" left="0" top="26" height="27" right="0"/>
              <Static id="sta_WFDA_Label02" taborder="252" cssclass="sta_WF_Labelbg" left="652" top="78" width="153" height="27"/>
              <Static id="sta_WFDA_Label03" taborder="253" cssclass="sta_WF_Labelbg" left="91" top="130" width="172" height="27"/>
              <Static id="sta_WFDA_Label06" taborder="256" cssclass="sta_WF_Labelbg" left="360" top="104" width="211" height="27"/>
              <Static id="sta_WFDA_Label08" taborder="258" cssclass="sta_WF_Labelbg" left="91" top="104" width="172" height="27"/>
              <Static id="sta_WFDA_Label10" taborder="260" cssclass="sta_WF_Labelbg" left="652" top="104" width="153" height="27"/>
              <Static id="sta_WFDA_Label12" taborder="262" cssclass="sta_WF_Labelbg" left="898" top="104" height="27" right="0"/>
              <Static id="sta_WFDA_Label16" taborder="265" cssclass="sta_WF_Labelbg" left="360" top="78" width="211" height="27"/>
              <Static id="sta_WFDA_Label17" taborder="266" cssclass="sta_WF_Labelbg" left="360" top="130" width="211" height="27"/>
              <Calendar id="cal_BRRW_DE" taborder="270" autoselect="true" readonly="true" dateformat="yyyy-MM-dd" cssclass="cal_WF_Readonly" left="364" top="81" width="100" height="21" style="align:left middle;"/>
              <MaskEdit id="msk_INTRT" taborder="272" readonly="true" mask="!###.###" limitbymask="both" cssclass="msk_WF_Readonly" left="95" top="107" width="146" height="21"/>
              <Static id="sta_Percentage" taborder="273" text="%" left="246" top="107" width="12" height="21"/>
              <MaskEdit id="msk_BRRW_AMOUNT" taborder="274" readonly="true" mask="###,###." autoselect="true" cssclass="msk_WF_Readonly" left="902" top="81" width="125" height="21"/>
              <Combo id="cmb_CMPNINT_SE" taborder="275" autoselect="true" readonly="true" cssclass="cmb_WF_Readonly" left="364" top="107" width="100" height="21" innerdataset="@ds_fun013" codecolumn="CODE" datacolumn="CODE_NM"/>
              <Combo id="cmb_INRST_SE" taborder="276" autoselect="true" readonly="true" cssclass="cmb_WF_Readonly" left="656" top="107" width="145" height="21" innerdataset="@ds_fun014" codecolumn="CODE" datacolumn="CODE_NM"/>
              <Static id="sta_Percentage00" taborder="278" text="(개월)" left="0" top="146" width="0" height="0"/>
              <Static id="sta_WFDA_Label13" taborder="282" cssclass="sta_WF_Labelbg" left="91" top="78" width="172" height="27"/>
              <Edit id="edt_RPAY_PD" taborder="283" inputtype="number" readonly="true" lengthunit="utf8" maxlength="8" onkeyup="edt_BSNS_CODE_onkeyup" cssclass="edt_WF_Readonly" left="656" top="81" width="108" height="21" style="align:right middle;"/>
              <Static id="sta_Percentage01" taborder="284" text="(개월)" left="767" top="81" width="34" height="21"/>
              <MaskEdit id="msk_BOD_CONFM_DE" taborder="285" readonly="true" type="string" mask="####-##-##" maskchar=" " cssclass="msk_WF_Readonly" left="95" top="133" width="163" height="21" style="align:left middle;"/>
              <MaskEdit id="msk_GVRN_CONFM_DE" taborder="286" readonly="true" type="string" mask="####-##-##" maskchar=" " cssclass="msk_WF_Readonly" left="364" top="133" width="202" height="21" style="align:left middle;"/>
              <Edit id="edt_PNINT_RCPMNY_INSTT" taborder="294" inputmode="upper" readonly="true" lengthunit="utf8" maxlength="100" autoselect="true" onkeyup="edt_BSNS_CODE_onkeyup" cssclass="edt_WF_Readonly" left="364" top="55" width="202" height="21" style="align:left middle;"/>
              <Static id="sta_CNTRCT_DE00" taborder="299" text="차입금액" cssclass="sta_WF_Label" left="804" top="78" width="95" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Static id="sta_DPST_INTRT00" taborder="300" text="상환구분" cssclass="sta_WF_Label" left="0" top="78" width="92" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Static id="sta_RM02" taborder="301" text="정부승인일" cssclass="sta_WF_Label" left="261" top="130" width="100" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Static id="sta_DPSTR01" taborder="304" text="이율" cssclass="sta_WF_Label" left="0" top="104" width="92" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Static id="sta_CNTRCT_DE01" taborder="305" text="금리구분" cssclass="sta_WF_Label" left="570" top="104" width="83" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Static id="sta_RM05" taborder="307" text="시장승인일" cssclass="sta_WF_Label" left="570" top="130" width="83" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Static id="sta_RM11" taborder="310" text="상환잔액" onclick="div_Cont_sta_RM11_onclick" cssclass="sta_WF_Label" left="804" top="104" width="95" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Static id="sta_CNTRCT_DE" taborder="312" text="차입일/만기일" cssclass="sta_WF_Label" left="261" top="78" width="100" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Static id="sta_ACNUTNO" taborder="313" text="승인번호" cssclass="sta_WF_Label" left="0" top="0" width="92" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Static id="sta_DPST_INTRT" taborder="315" text="이자구분/주기" cssclass="sta_WF_Label" left="261" top="104" width="100" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Static id="sta_RM" taborder="316" text="이사회승인일" cssclass="sta_WF_Label" left="0" top="130" width="92" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Static id="sta_RM01" taborder="318" text="상환기간" cssclass="sta_WF_Label" left="570" top="78" width="83" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Static id="sta_RM07" taborder="332" text="KR번호" cssclass="sta_WF_Label" left="261" top="26" width="100" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Static id="sta_RM08" taborder="333" text="비고" cssclass="sta_WF_Label" left="570" top="182" width="83" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Edit id="edt_KR_NO" taborder="334" inputmode="upper" readonly="true" autoselect="true" onkeyup="edt_BSNS_CODE_onkeyup" cssclass="edt_WF_Readonly" left="364" top="29" width="203" height="21" style="align:left middle;"/>
              <Edit id="edt_RM" taborder="335" readonly="true" autoselect="true" onkeyup="edt_BSNS_CODE_onkeyup" cssclass="edt_WF_Readonly" left="656" top="185" width="371" height="21" style="align:left middle;"/>
              <Static id="sta_WFDA_Label27" taborder="339" cssclass="sta_WF_Labelbg" left="91" top="182" width="480" height="27"/>
              <Edit id="edt_INTR_CYCLE" taborder="347" inputtype="number" readonly="true" lengthunit="utf8" maxlength="8" autoselect="true" onkeyup="edt_BSNS_CODE_onkeyup" cssclass="edt_WF_Readonly" left="466" top="107" width="64" height="21" style="align:right middle;"/>
              <Static id="sta_Percentage04" taborder="348" text="(개월)" left="532" top="107" width="34" height="21"/>
              <Static id="sta_DPSTR00" taborder="351" text="사업코드" cssclass="sta_WF_Label" left="0" top="182" width="92" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Edit id="edt_BSNS_CODE" taborder="352" readonly="true" lengthunit="utf8" maxlength="5" onkeyup="edt_BSNS_CODE_onkeyup" cssclass="edt_WF_Readonly" left="95" top="185" width="71" height="21" style="align:left middle;"/>
              <Edit id="edt_BSNS_NM" taborder="353" readonly="true" lengthunit="utf8" maxlength="100" onkeyup="edt_BSNS_CODE_onkeyup" cssclass="edt_WF_Readonly" left="168" top="185" width="399" height="21" style="align:left middle;"/>
              <Combo id="cmb_RPAY_SE" taborder="357" autoselect="true" readonly="true" innerdataset="@ds_fun015" codecolumn="CODE" datacolumn="CODE_NM" cssclass="cmb_WF_Readonly" left="95" top="81" width="163" height="21"/>
              <Static id="sta_RM12" taborder="358" text="원리금입금처" cssclass="sta_WF_Label" left="261" top="52" width="100" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Calendar id="cal_EXPRTN_DE" taborder="359" autoselect="true" readonly="true" dateformat="yyyy-MM-dd" cssclass="cal_WF_Readonly" left="466" top="81" width="100" height="21" style="align:left middle;"/>
              <Static id="sta_WFDA_Label04" taborder="360" cssclass="sta_WF_Labelbg" left="652" top="130" height="27" width="153"/>
              <MaskEdit id="msk_CITY_CONFM_DE" taborder="361" readonly="true" type="string" mask="####-##-##" maskchar=" " cssclass="msk_WF_Readonly" left="656" top="133" width="145" height="21" style="align:left middle;"/>
              <Static id="sta_fixingInrstSe00" taborder="362" text="만기여부" cssclass="sta_WF_Label" left="570" top="0" width="83" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <CheckBox id="chk_exprtnAt" taborder="363" value="0" truevalue="1" falsevalue="0" readonly="true" left="656" top="3" width="17" height="21" style="buttonbackground:#f0f0f0ff;"/>
              <Static id="sta_fixingInrstSe01" taborder="364" text="실물채여부" cssclass="sta_WF_Label" left="261" top="0" width="100" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <CheckBox id="chk_objtAt" taborder="365" value="0" truevalue="1" falsevalue="0" readonly="true" left="364" top="3" width="17" height="21" style="buttonbackground:#f0f0f0ff;"/>
              <Static id="sta_DPST_INTRT01" taborder="366" text="거치월/상환월" cssclass="sta_WF_Label" left="804" top="130" width="95" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <MaskEdit id="msk_BRRW_BALANCE" taborder="367" readonly="true" mask="###,###." autoselect="true" cssclass="msk_WF_Readonly" left="902" top="107" width="125" height="21"/>
              <Edit id="edt_BRRW_ACNUT_NM" taborder="271" readonly="true" lengthunit="utf8" maxlength="100" autoselect="true" onkeyup="edt_BSNS_CODE_onkeyup" cssclass="edt_WF_Readonly" left="656" top="29" width="243" height="21" style="align:left middle;"/>
              <Static id="sta_ACNUTNO00" taborder="319" text="채권명" cssclass="sta_WF_Label" left="570" top="26" width="83" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Static id="sta_DPSTR" taborder="314" text="납입처(금융)" cssclass="sta_WF_Label" left="570" top="52" width="83" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Edit id="edt_FNNC_INSTT_CODE" taborder="355" inputmode="upper" readonly="true" lengthunit="utf8" maxlength="50" autoselect="true" onkeyup="edt_BSNS_CODE_onkeyup" cssclass="edt_WF_Readonly" left="656" top="55" width="243" height="21" style="align:left middle;"/>
              <Edit id="edt_BRWOFC" taborder="290" inputmode="upper" readonly="true" lengthunit="utf8" maxlength="50" autoselect="true" onkeyup="edt_BSNS_CODE_onkeyup" cssclass="edt_WF_Readonly" left="95" top="55" width="163" height="21" style="align:left middle;"/>
              <Static id="sta_RM10" taborder="309" text="차입처/주관사" cssclass="sta_WF_Label" left="0" top="52" width="92" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Edit id="edt_CPTAL_KND" taborder="344" readonly="true" lengthunit="utf8" maxlength="6" onkeyup="edt_BSNS_CODE_onkeyup" cssclass="edt_WF_Readonly" left="95" top="29" width="54" height="21" style="align:left middle;"/>
              <Edit id="edt_CPTAL_KND_NM" taborder="345" readonly="true" lengthunit="utf8" maxlength="100" onkeyup="edt_BSNS_CODE_onkeyup" cssclass="edt_WF_Readonly" left="151" top="29" width="107" height="21" style="align:left middle;"/>
              <Static id="sta_ACNUTNO01" taborder="343" text="자금종류" cssclass="sta_WF_Label" left="0" top="26" width="92" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Edit id="edt_DFR_MT" taborder="292" inputmode="upper" inputtype="number" readonly="true" lengthunit="utf8" maxlength="50" autoselect="true" onkeyup="edt_BSNS_CODE_onkeyup" cssclass="edt_WF_Readonly" left="902" top="133" width="33" height="21" style="align:right middle;" visible="true"/>
              <Edit id="edt_RPAY_MT" taborder="295" inputmode="upper" inputtype="number" readonly="true" lengthunit="utf8" maxlength="50" autoselect="true" onkeyup="edt_BSNS_CODE_onkeyup" cssclass="edt_WF_Readonly" left="950" top="133" width="33" height="21" style="align:right middle;" visible="true"/>
              <Static id="sta_Percentage02" taborder="296" text="/" left="939" top="133" width="10" height="21" visible="true"/>
              <Static id="sta_Percentage03" taborder="297" text="(개월)" left="987" top="133" width="34" height="21" visible="true"/>
              <Static id="sta_WFDA_Label07" taborder="369" cssclass="sta_WF_Labelbg" left="0" top="156" height="27" right="0"/>
              <Combo id="cmb_INRST_SE00" taborder="372" autoselect="true" innerdataset="ds_fun032" codecolumn="CODE" datacolumn="CODE_NM" left="656" top="159" width="145" height="21" readonly="true" cssclass="cmb_WF_Readonly" type="dropdown"/>
              <Static id="sta_CDLT03" taborder="373" text="한기평" cssclass="sta_WF_Label" left="570" top="156" width="83" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Static id="sta_CDLT04" taborder="374" text="NICE" onclick="div_Cont_sta_RM11_onclick" cssclass="sta_WF_Label" left="804" top="156" width="95" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Static id="sta_CDLT02" taborder="375" text="한신평" cssclass="sta_WF_Label" left="261" top="156" width="100" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Static id="sta_CDLT01" taborder="376" text="한신정" cssclass="sta_WF_Label" left="0" top="156" width="92" height="27" style="padding:0 0 0 10;align:left middle;"/>
              <Combo id="cmb_INRST_SE01" taborder="377" autoselect="true" innerdataset="ds_fun032" codecolumn="CODE" datacolumn="CODE_NM" left="95" top="159" width="163" height="21" readonly="true" cssclass="cmb_WF_Readonly" type="dropdown"/>
              <Combo id="cmb_INRST_SE02" taborder="378" autoselect="true" innerdataset="ds_fun032" codecolumn="CODE" datacolumn="CODE_NM" left="364" top="159" width="202" height="21" readonly="true" cssclass="cmb_WF_Readonly" type="dropdown"/>
              <Combo id="cmb_INRST_SE03" taborder="379" autoselect="true" innerdataset="ds_fun032" codecolumn="CODE" datacolumn="CODE_NM" left="902" top="159" width="126" height="21" readonly="true" cssclass="cmb_WF_Readonly"/>
              <Button id="btn_sample" taborder="380" text="업로드 양식 다운로드" onclick="btn_excelFormDown" cssclass="btn_WF_Process" top="242" right="0" width="132" height="19" visible="false"/>
            </Layout>
          </Layouts>
        </Div>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item0" compid="div_work.edt_PBNCD_NO" propid="value" datasetid="ds_pbncdInfo" columnid="CONFM_NO"/>
      <BindItem id="item35" compid="div_work.cal_BRRW_DE" propid="value" datasetid="ds_pbncdInfo" columnid="BRRW_DE"/>
      <BindItem id="item31" compid="div_work.edt_BRRW_ACNUT_NM" propid="value" datasetid="ds_pbncdInfo" columnid="BRRW_ACNUT_NM"/>
      <BindItem id="item46" compid="div_work.msk_INTRT" propid="value" datasetid="ds_pbncdInfo" columnid="INTRT"/>
      <BindItem id="item36" compid="div_work.msk_BRRW_AMOUNT" propid="value" datasetid="ds_pbncdInfo" columnid="BRRW_AMOUNT"/>
      <BindItem id="item47" compid="div_work.cmb_CMPNINT_SE" propid="value" datasetid="ds_pbncdInfo" columnid="CMPNINT_SE"/>
      <BindItem id="item37" compid="div_work.cmb_INRST_SE" propid="value" datasetid="ds_pbncdInfo" columnid="INRST_SE"/>
      <BindItem id="item43" compid="div_work.edt_RPAY_PD" propid="value" datasetid="ds_pbncdInfo" columnid="RPAY_PD"/>
      <BindItem id="item39" compid="div_work.msk_BOD_CONFM_DE" propid="value" datasetid="ds_pbncdInfo" columnid="BOD_CONFM_DE"/>
      <BindItem id="item40" compid="div_work.msk_GVRN_CONFM_DE" propid="value" datasetid="ds_pbncdInfo" columnid="GVRN_CONFM_DE"/>
      <BindItem id="item12" compid="div_work.edt_BRWOFC" propid="value" datasetid="ds_pbncdInfo" columnid="BRWOFC"/>
      <BindItem id="item13" compid="div_work.edt_DFR_MT" propid="value" datasetid="ds_pbncdInfo" columnid="DFR_MT"/>
      <BindItem id="item14" compid="div_work.edt_PNINT_RCPMNY_INSTT" propid="value" datasetid="ds_pbncdInfo" columnid="PNINT_RCPMNY_INSTT"/>
      <BindItem id="item15" compid="div_work.edt_RPAY_MT" propid="value" datasetid="ds_pbncdInfo" columnid="RPAY_MT"/>
      <BindItem id="item64" compid="div_work.edt_KR_NO" propid="value" datasetid="ds_pbncdInfo" columnid="KR_NO"/>
      <BindItem id="item65" compid="div_work.edt_RM" propid="value" datasetid="ds_pbncdInfo" columnid="RM"/>
      <BindItem id="item30" compid="div_search.edt_pbncdNo" propid="value" datasetid="ds_cond" columnid="PBNCD_NO"/>
      <BindItem id="item4" compid="div_work.edt_CPTAL_KND" propid="value" datasetid="ds_pbncdInfo" columnid="CPTAL_KND"/>
      <BindItem id="item9" compid="div_work.edt_CPTAL_KND_NM" propid="value" datasetid="ds_pbncdInfo" columnid="CPTAL_KND_NM"/>
      <BindItem id="item48" compid="div_work.edt_INTR_CYCLE" propid="value" datasetid="ds_pbncdInfo" columnid="INTR_CYCLE"/>
      <BindItem id="item33" compid="div_work.edt_BSNS_CODE" propid="value" datasetid="ds_pbncdInfo" columnid="BSNS_CODE"/>
      <BindItem id="item34" compid="div_work.edt_BSNS_NM" propid="value" datasetid="ds_pbncdInfo" columnid="BSNS_NM"/>
      <BindItem id="item1" compid="div_work.edt_FNNC_INSTT_CODE" propid="value" datasetid="ds_pbncdInfo" columnid="FNNC_INSTT_NM"/>
      <BindItem id="item38" compid="div_work.cmb_RPAY_SE" propid="value" datasetid="ds_pbncdInfo" columnid="RPAY_SE"/>
      <BindItem id="item50" compid="div_work.cal_EXPRTN_DE" propid="value" datasetid="ds_pbncdInfo" columnid="EXPRTN_DE"/>
      <BindItem id="item49" compid="div_work.msk_CITY_CONFM_DE" propid="value" datasetid="ds_pbncdInfo" columnid="CITY_CONFM_DE"/>
      <BindItem id="item66" compid="div_work.chk_exprtnAt" propid="value" datasetid="ds_pbncdInfo" columnid="EXPRTN_AT"/>
      <BindItem id="item2" compid="div_work.chk_objtAt" propid="value" datasetid="ds_pbncdInfo" columnid="OBJT_AT"/>
      <BindItem id="item3" compid="div_work.msk_BRRW_BALANCE" propid="value" datasetid="ds_pbncdInfo" columnid="BRRW_BALANCE"/>
      <BindItem id="item5" compid="div_search.edt_BRRW_ACNUT_NM" propid="value" datasetid="ds_cond" columnid="BRRW_ACNUT_NM"/>
      <BindItem id="item6" compid="div_work.cmb_INRST_SE00" propid="value" datasetid="ds_pbncdInfo" columnid="CDLT3"/>
      <BindItem id="item7" compid="div_work.cmb_INRST_SE01" propid="value" datasetid="ds_pbncdInfo" columnid="CDLT1"/>
      <BindItem id="item8" compid="div_work.cmb_INRST_SE02" propid="value" datasetid="ds_pbncdInfo" columnid="CDLT2"/>
      <BindItem id="item10" compid="div_work.cmb_INRST_SE03" propid="value" datasetid="ds_pbncdInfo" columnid="CDLT4"/>
    </Bind>
    <Objects>
      <Dataset id="ds_cond" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="PBNCD_NO" type="STRING" size="256"/>
          <Column id="BRRW_ACNUT_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_intrRpayPlan" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_intrRpayPlan_oncolumnchanged">
        <ColumnInfo>
          <Column id="PBNCD_NO" type="STRING" size="256" sumtext="공사채번호"/>
          <Column id="RPAY_DE" type="STRING" size="256" sumtext="상환일자"/>
          <Column id="RPAY_AMOUNT" type="BIGDECIMAL" size="256" sumtext="상환금액"/>
          <Column id="RPAY_INTRT" type="FLOAT" size="256" sumtext="상환이율"/>
          <Column id="SUMRY" type="STRING" size="256" sumtext="적요"/>
          <Column id="REGISTER_ID" type="STRING" size="256" sumtext="등록자id"/>
          <Column id="REGIST_DT" type="STRING" size="256" sumtext="등록일시"/>
          <Column id="UPDUSR_ID" type="STRING" size="256" sumtext="수정자id"/>
          <Column id="UPDT_DT" type="STRING" size="256" sumtext="수정일시"/>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="KR_AMT" type="STRING" size="256"/>
          <Column id="SANCTN_NO" type="STRING" size="256"/>
          <Column id="SANCTN_STS" type="STRING" size="256"/>
          <Column id="RPAY_DE2" type="STRING" size="256"/>
          <Column id="CHK2" type="STRING" size="256"/>
          <Column id="RPAY_DE3" type="STRING" size="256"/>
          <Column id="BUDGET_YEAR" type="STRING" size="256"/>
          <Column id="BSNS_SE" type="STRING" size="256"/>
          <Column id="BALC_SE" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_CODE" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_NM" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_CODE" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_NM" type="STRING" size="256"/>
          <Column id="BUDGET_CNRL_AT" type="STRING" size="256"/>
          <Column id="PYMNT_DE" type="STRING" size="256"/>
          <Column id="FNNC_INSTT_CODE" type="STRING" size="256"/>
          <Column id="ACNUTNO" type="STRING" size="256"/>
          <Column id="COMPUT_BSIS" type="STRING" size="256"/>
          <Column id="EXPNDTR_DECSN_YEAR" type="STRING" size="256"/>
          <Column id="EXPNDTR_DECSN_DE" type="STRING" size="256"/>
          <Column id="EXPNDTR_DECSN_NO" type="STRING" size="256"/>
          <Column id="CNFIRM_AT" type="STRING" size="256"/>
          <Column id="UPDATE_POSBL_AT" type="STRING" size="256"/>
          <Column id="EXPRTN_AT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_intrRpayDtls" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="PBNCD_NO" type="STRING" size="256" sumtext="공사채번호"/>
          <Column id="RPAY_DE" type="STRING" size="256" sumtext="상환일자"/>
          <Column id="RPAY_AMOUNT" type="BIGDECIMAL" size="256" sumtext="상환금액"/>
          <Column id="RPAY_INTRT" type="FLOAT" size="256" sumtext="상환이율"/>
          <Column id="SUMRY" type="STRING" size="256" sumtext="적요"/>
          <Column id="REGISTER_ID" type="STRING" size="256" sumtext="등록자id"/>
          <Column id="REGIST_DT" type="STRING" size="256" sumtext="등록일시"/>
          <Column id="UPDUSR_ID" type="STRING" size="256" sumtext="수정자id"/>
          <Column id="UPDT_DT" type="STRING" size="256" sumtext="수정일시"/>
          <Column id="RPAY_DE2" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_prncpalRpayDtls" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="PBNCD_NO" type="STRING" size="256" sumtext="공사채번호"/>
          <Column id="RPAY_DE" type="STRING" size="256" sumtext="상환일자"/>
          <Column id="RPAY_AMOUNT" type="BIGDECIMAL" size="256" sumtext="상환금액"/>
          <Column id="RPAY_INTRT" type="FLOAT" size="256" sumtext="상환이율"/>
          <Column id="SUMRY" type="STRING" size="256" sumtext="적요"/>
          <Column id="REGISTER_ID" type="STRING" size="256" sumtext="등록자id"/>
          <Column id="REGIST_DT" type="STRING" size="256" sumtext="등록일시"/>
          <Column id="UPDUSR_ID" type="STRING" size="256" sumtext="수정자id"/>
          <Column id="UPDT_DT" type="STRING" size="256" sumtext="수정일시"/>
          <Column id="RPAY_DE2" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_prncpalRpayPlan" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_prncpalRpayPlan_oncolumnchanged">
        <ColumnInfo>
          <Column id="PBNCD_NO" type="STRING" size="256" sumtext="공사채번호"/>
          <Column id="RPAY_DE" type="STRING" size="256" sumtext="상환일자"/>
          <Column id="RPAY_AMOUNT" type="BIGDECIMAL" size="256" sumtext="상환금액"/>
          <Column id="RPAY_INTRT" type="FLOAT" size="256" sumtext="상환이율"/>
          <Column id="SUMRY" type="STRING" size="256" sumtext="적요"/>
          <Column id="REGISTER_ID" type="STRING" size="256" sumtext="등록자id"/>
          <Column id="REGIST_DT" type="STRING" size="256" sumtext="등록일시"/>
          <Column id="UPDUSR_ID" type="STRING" size="256" sumtext="수정자id"/>
          <Column id="UPDT_DT" type="STRING" size="256" sumtext="수정일시"/>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="KR_AMT" type="STRING" size="256"/>
          <Column id="SANCTN_NO" type="STRING" size="256"/>
          <Column id="SANCTN_STS" type="STRING" size="256"/>
          <Column id="RPAY_DE2" type="STRING" size="256"/>
          <Column id="CHK2" type="STRING" size="256"/>
          <Column id="BUDGET_YEAR" type="STRING" size="256"/>
          <Column id="BSNS_SE" type="STRING" size="256"/>
          <Column id="BALC_SE" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_CODE" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_NM" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_CODE" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_NM" type="STRING" size="256"/>
          <Column id="BUDGET_CNRL_AT" type="STRING" size="256"/>
          <Column id="PYMNT_DE" type="STRING" size="256"/>
          <Column id="FNNC_INSTT_CODE" type="STRING" size="256"/>
          <Column id="ACNUTNO" type="STRING" size="256"/>
          <Column id="COMPUT_BSIS" type="STRING" size="256"/>
          <Column id="EXPNDTR_DECSN_YEAR" type="STRING" size="256"/>
          <Column id="EXPNDTR_DECSN_DE" type="STRING" size="256"/>
          <Column id="EXPNDTR_DECSN_NO" type="STRING" size="256"/>
          <Column id="CNFIRM_AT" type="STRING" size="256"/>
          <Column id="UPDATE_POSBL_AT" type="STRING" size="256"/>
          <Column id="EXPRTN_AT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_validation" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="compId" type="STRING" size="256"/>
          <Column id="colId" type="STRING" size="256"/>
          <Column id="PK" type="STRING" size="256"/>
          <Column id="notNull" type="STRING" size="256"/>
          <Column id="type" type="STRING" size="256"/>
          <Column id="nlength" type="STRING" size="256"/>
          <Column id="from" type="STRING" size="256"/>
          <Column id="to" type="STRING" size="256"/>
          <Column id="lengthChkGb" type="STRING" size="256"/>
          <Column id="msgId" type="STRING" size="256"/>
          <Column id="expr" type="STRING" size="256"/>
          <Column id="func" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="colId">RPAY_DE</Col>
            <Col id="compId">ds_intrRpayPlan</Col>
            <Col id="msgId">지급일자</Col>
            <Col id="notNull">Y</Col>
            <Col id="PK">Y</Col>
          </Row>
          <Row>
            <Col id="compId">ds_intrRpayDtls</Col>
            <Col id="msgId">지급일자</Col>
            <Col id="notNull">Y</Col>
            <Col id="colId">RPAY_DE</Col>
            <Col id="PK">Y</Col>
          </Row>
          <Row>
            <Col id="compId">ds_prncpalRpayDtls</Col>
            <Col id="msgId">상환일자</Col>
            <Col id="notNull">Y</Col>
            <Col id="colId">RPAY_DE</Col>
            <Col id="PK">Y</Col>
          </Row>
          <Row>
            <Col id="compId">ds_prncpalRpayPlan</Col>
            <Col id="msgId">상환일자</Col>
            <Col id="notNull">Y</Col>
            <Col id="colId">RPAY_DE</Col>
            <Col id="PK">Y</Col>
          </Row>
          <Row>
            <Col id="compId">ds_cond</Col>
            <Col id="colId">PBNCD_NO</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">공사채</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_pbncdInfo" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="DS_PBNCD_onrowposchanged" canrowposchange="DS_PBNCD_canrowposchange">
        <ColumnInfo>
          <Column id="PBNCD_NO" type="STRING" size="256" sumtext="공사채번호"/>
          <Column id="CONFM_NO" type="STRING" size="256" sumtext="승인번호"/>
          <Column id="CONFM_AMOUNT" type="BIGDECIMAL" size="256" sumtext="승인금액"/>
          <Column id="CPTAL_KND_NM" type="STRING" size="256" sumtext="자금구분명"/>
          <Column id="CPTAL_KND" type="STRING" size="256" sumtext="자금구분"/>
          <Column id="CMPNINT_SE" type="STRING" size="256" sumtext="복리구분"/>
          <Column id="INRST_SE" type="STRING" size="256" sumtext="금리구분"/>
          <Column id="RPAY_SE" type="STRING" size="256" sumtext="상환구분"/>
          <Column id="BRRW_ACNUT_NM" type="STRING" size="256" sumtext="차입계좌명"/>
          <Column id="FNNC_INSTT_CODE" type="STRING" size="256" sumtext="금융기관코드"/>
          <Column id="FNNC_INSTT_NM" type="STRING" size="256"/>
          <Column id="BSNS_CODE" type="STRING" size="256" sumtext="사업코드"/>
          <Column id="BSNS_NM" type="STRING" size="256" sumtext="사업코드명"/>
          <Column id="BRRW_AMOUNT" type="BIGDECIMAL" size="256" sumtext="차입금액"/>
          <Column id="BRRW_DE" type="STRING" size="256" sumtext="차입일"/>
          <Column id="EXPRTN_DE" type="STRING" size="256" sumtext="만기일"/>
          <Column id="INTRT" type="STRING" size="256" sumtext="이율"/>
          <Column id="INTR_CYCLE" type="STRING" size="256" sumtext="이자주기"/>
          <Column id="RPAY_PD" type="STRING" size="256" sumtext="상환기간"/>
          <Column id="RM" type="STRING" size="256" sumtext="비고"/>
          <Column id="EXPRTN_AT" type="STRING" size="256" sumtext="만기여부"/>
          <Column id="BOD_CONFM_DE" type="STRING" size="256" sumtext="이사회승인일"/>
          <Column id="GVRN_CONFM_DE" type="STRING" size="256" sumtext="정부승인일자"/>
          <Column id="CITY_CONFM_DE" type="STRING" size="256" sumtext="시승인일자"/>
          <Column id="KR_NO" type="STRING" size="256" sumtext="KR번호"/>
          <Column id="REGISTER_ID" type="STRING" size="256" sumtext="등록자ID"/>
          <Column id="REGIST_DT" type="STRING" size="256" sumtext="등록일시"/>
          <Column id="UPDUSR_ID" type="STRING" size="256" sumtext="수정자ID"/>
          <Column id="UPDT_DT" type="STRING" size="256" sumtext="수정일시"/>
          <Column id="MASTER_YN" type="STRING" size="256" sumtext="마스터테이블 여부"/>
          <Column id="BRWOFC" type="STRING" size="256" sumtext="차입처"/>
          <Column id="PNINT_RCPMNY_INSTT" type="STRING" size="256" sumtext="원리금입금처"/>
          <Column id="REGIST_CNVRS_DE" type="STRING" size="256" sumtext="등록전환일자"/>
          <Column id="REGIST_CNVRS_AT" type="STRING" size="256" sumtext="등록전환여부"/>
          <Column id="DFR_MT" type="STRING" size="256" sumtext="거치월"/>
          <Column id="RPAY_MT" type="STRING" size="256" sumtext="상환월"/>
          <Column id="ISU_FOM" type="STRING" size="256" sumtext="발행형식"/>
          <Column id="FIXING_INRST_SE" type="STRING" size="256" sumtext="고정금리구분"/>
          <Column id="FILE_SN" type="STRING" size="256"/>
          <Column id="FNNC_INSTT_SPOT_NM" type="STRING" size="256"/>
          <Column id="OBJT_AT" type="STRING" size="256"/>
          <Column id="ACNUTNO" type="STRING" size="256"/>
          <Column id="BRRW_BALANCE" type="STRING" size="256"/>
          <Column id="CDLT1" type="STRING" size="256"/>
          <Column id="CDLT2" type="STRING" size="256"/>
          <Column id="CDLT3" type="STRING" size="256"/>
          <Column id="CDLT4" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_cond_fileSn" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="FILE_SN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_temp01" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="C01" type="STRING" size="256"/>
          <Column id="C02" type="STRING" size="256"/>
          <Column id="C03" type="STRING" size="256"/>
          <Column id="C04" type="STRING" size="256"/>
          <Column id="C05" type="FLOAT" size="256"/>
          <Column id="C06A" type="STRING" size="256"/>
          <Column id="C06B" type="STRING" size="256"/>
          <Column id="C07" type="STRING" size="256"/>
          <Column id="C08" type="STRING" size="256"/>
          <Column id="C09" type="STRING" size="256"/>
          <Column id="C10" type="STRING" size="256"/>
          <Column id="C11A" type="STRING" size="256"/>
          <Column id="C11B" type="STRING" size="256"/>
          <Column id="C12" type="STRING" size="256"/>
          <Column id="C13A" type="STRING" size="256"/>
          <Column id="C13B" type="STRING" size="256"/>
          <Column id="C14" type="STRING" size="256"/>
          <Column id="C15" type="STRING" size="256"/>
          <Column id="PBNCD_NO" type="STRING" size="256"/>
          <Column id="RPAY_DE" type="STRING" size="256"/>
          <Column id="RPAY_DE1" type="STRING" size="256"/>
          <Column id="BUDGET_YEAR" type="STRING" size="256"/>
          <Column id="BSNS_SE" type="STRING" size="256"/>
          <Column id="BALC_SE" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_CODE" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_NM" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_CODE" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_NM" type="STRING" size="256"/>
          <Column id="BUDGET_CNRL_AT" type="STRING" size="256"/>
          <Column id="PYMNT_DE" type="STRING" size="256"/>
          <Column id="FNNC_INSTT_CODE" type="STRING" size="256"/>
          <Column id="ACNUTNO" type="STRING" size="256"/>
          <Column id="COMPUT_BSIS" type="STRING" size="256"/>
          <Column id="SANCTN_SJ" type="STRING" size="256"/>
          <Column id="Column13" type="STRING" size="256"/>
          <Column id="BUDGET_YEAR1" type="STRING" size="256"/>
          <Column id="BSNS_SE1" type="STRING" size="256"/>
          <Column id="BALC_SE1" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_CODE1" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_NM1" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_CODE1" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_NM1" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_temp02" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_temp_oncolumnchanged">
        <ColumnInfo>
          <Column id="C00" type="STRING" size="256"/>
          <Column id="C01" type="STRING" size="256"/>
          <Column id="C02" type="STRING" size="256"/>
          <Column id="C03" type="STRING" size="256"/>
          <Column id="C04" type="STRING" size="256"/>
          <Column id="C05" type="FLOAT" size="256"/>
          <Column id="C06A" type="STRING" size="256"/>
          <Column id="C06B" type="STRING" size="256"/>
          <Column id="C07" type="STRING" size="256"/>
          <Column id="C08" type="BIGDECIMAL" size="256"/>
          <Column id="C09" type="STRING" size="256"/>
          <Column id="C10A" type="STRING" size="256"/>
          <Column id="C10B" type="STRING" size="256"/>
          <Column id="C11" type="STRING" size="256"/>
          <Column id="C12" type="STRING" size="256"/>
          <Column id="C13" type="STRING" size="256"/>
          <Column id="PBNCD_NO" type="STRING" size="256"/>
          <Column id="RPAY_DE" type="STRING" size="256"/>
          <Column id="BUDGET_YEAR" type="STRING" size="256"/>
          <Column id="BSNS_SE" type="STRING" size="256"/>
          <Column id="BALC_SE" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_CODE" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_NM" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_CODE" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_NM" type="STRING" size="256"/>
          <Column id="BUDGET_CNRL_AT" type="STRING" size="256"/>
          <Column id="PYMNT_DE" type="STRING" size="256"/>
          <Column id="FNNC_INSTT_CODE" type="STRING" size="256"/>
          <Column id="ACNUTNO" type="STRING" size="256"/>
          <Column id="COMPUT_BSIS" type="STRING" size="256"/>
          <Column id="SANCTN_SJ" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_fileList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="PROGRS" type="BIGDECIMAL" size="16"/>
          <Column id="ORGINL_FILE_NM" type="string" size="32"/>
          <Column id="FILE_EXTSN" type="string" size="32"/>
          <Column id="FILE_STRE_COURS" type="string" size="32"/>
          <Column id="FILE_ID" type="string" size="32"/>
          <Column id="SN" type="bigdecimal" size="16"/>
          <Column id="SYS_SE_CODE" type="string" size="32"/>
          <Column id="FILE_IMAGE" type="string" size="32"/>
          <Column id="FILE_TY" type="string" size="32"/>
          <Column id="JOB_SE" type="string" size="32"/>
          <Column id="DELETE_IMAGE" type="string" size="32"/>
          <Column id="STRE_FILE_NM" type="string" size="32"/>
          <Column id="FILE_MG" type="bigdecimal" size="16"/>
          <Column id="FILE_CN" type="string" size="32"/>
          <Column id="FILE_ORDR" type="bigdecimal" size="16"/>
          <Column id="TRNSMIS_FILE_SIZE" type="string" size="32"/>
          <Column id="USE_AT" type="string" size="32"/>
          <Column id="STTUS" type="string" size="32"/>
          <Column id="FILE_SN" type="bigdecimal" size="16"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_INRST_SE" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="DS_CMPNINT_INRST_onrowposchanged">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">01</Col>
            <Col id="CODE_NM">고정</Col>
          </Row>
          <Row>
            <Col id="CODE">02</Col>
            <Col id="CODE_NM">변동</Col>
          </Row>
          <Row>
            <Col id="CODE">02</Col>
            <Col id="CODE_NM">고정+변동</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="DS_RPAY_SE" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">1</Col>
            <Col id="CODE_NM">만기상환</Col>
          </Row>
          <Row>
            <Col id="CODE">2</Col>
            <Col id="CODE_NM">분할상환</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="DS_CMPNINT_SE" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="DS_CMPNINT_INRST_onrowposchanged">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">1</Col>
            <Col id="CODE_NM">단리</Col>
          </Row>
          <Row>
            <Col id="CODE">2</Col>
            <Col id="CODE_NM">년복리</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_fun013" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_fun014" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_fun015" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_import" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onload="DS_IMPORT_onload">
        <ColumnInfo>
          <Column id="Column0" type="STRING" size="256"/>
          <Column id="Column1" type="STRING" size="256"/>
          <Column id="Column2" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_expDsnMastr" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DECSN_YEAR" type="STRING" size="4"/>
          <Column id="DECSN_NO" type="STRING" size="10"/>
          <Column id="CAUSE_ACTION_NO" type="STRING" size="10"/>
          <Column id="BUDGET_YEAR" type="STRING" size="4"/>
          <Column id="BSNS_SE" type="STRING" size="1"/>
          <Column id="BALC_SE" type="STRING" size="1"/>
          <Column id="BUDGET_ACNT_CODE" type="STRING" size="8"/>
          <Column id="BUDGET_ACNT_NM" type="STRING" size="256"/>
          <Column id="ANACT_KND" type="STRING" size="2"/>
          <Column id="DEPT_CODE" type="STRING" size="6"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="CYFD_SE" type="STRING" size="1"/>
          <Column id="ITNC_DE" type="STRING" size="8"/>
          <Column id="PYMNT_ITNC_DE" type="STRING" size="8"/>
          <Column id="DET_DCSN_DE" type="STRING" size="8"/>
          <Column id="PRMPC_JRNLZPR_RGIST_DE" type="STRING" size="8"/>
          <Column id="CPTAL_EXPNDTR_ACNTBK_DE" type="STRING" size="8"/>
          <Column id="EXPNDTR_BUDGET_CNRL_DE" type="STRING" size="8"/>
          <Column id="CAUSE_ACTION_DE" type="STRING" size="8"/>
          <Column id="DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="BUDGET_ACNT_BLCE" type="BIGDECIMAL" size="22"/>
          <Column id="EXPNDTR_UNIT_CODE" type="STRING" size="8"/>
          <Column id="EXPNDTR_UNIT_NM" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_CODE_BLCE" type="BIGDECIMAL" size="22"/>
          <Column id="CPTAL_CHRG_CONFM" type="STRING" size="1"/>
          <Column id="TIMHDER_CONFM" type="STRING" size="1"/>
          <Column id="CNTRCT_NO" type="STRING" size="11"/>
          <Column id="FNNC_INSTT_CODE" type="STRING" size="3"/>
          <Column id="ACNUTNO" type="STRING" size="20"/>
          <Column id="SUMRY" type="STRING" size="200"/>
          <Column id="BSNS_CODE" type="STRING" size="5"/>
          <Column id="BSNS_NM" type="STRING" size="256"/>
          <Column id="PRMPC_YEAR" type="STRING" size="256"/>
          <Column id="PRMPC_CODE" type="STRING" size="6"/>
          <Column id="PRMPC_NM" type="STRING" size="256"/>
          <Column id="REGISTER_ID" type="STRING" size="12"/>
          <Column id="REGIST_DT" type="DATE" size="7"/>
          <Column id="UPDUSR_ID" type="STRING" size="12"/>
          <Column id="UPDT_DT" type="DATE" size="7"/>
          <Column id="EXPNDTR_CNFIRM_AT" type="STRING" size="2"/>
          <Column id="ATMC_JRNLZ_TY_CODE" type="STRING" size="256"/>
          <Column id="GNRL_DEBTOR_ACNT_NM" type="STRING" size="256"/>
          <Column id="GNRL_CRDIT_ACNT_NM" type="STRING" size="256"/>
          <Column id="SETOFF_DEBTOR_ACNT_NM" type="STRING" size="256"/>
          <Column id="SETOFF_CRDIT_ACNT_NM" type="STRING" size="256"/>
          <Column id="FILE_SN" type="STRING" size="256"/>
          <Column id="CHECK_NO" type="STRING" size="256"/>
          <Column id="BUDGET_CNRL_AT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_expDsnMtrDet" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_expDsnMtrDet_oncolumnchanged">
        <ColumnInfo>
          <Column id="DECSN_YEAR" type="STRING" size="4"/>
          <Column id="DECSN_NO" type="STRING" size="11"/>
          <Column id="CNTRCT_DE" type="STRING" size="8"/>
          <Column id="ACPTNC_DE" type="STRING" size="8"/>
          <Column id="ORDER_DE" type="STRING" size="8"/>
          <Column id="DVYFG_DE" type="STRING" size="8"/>
          <Column id="PYMNT_CMMND_PBLICTE_DE" type="STRING" size="8"/>
          <Column id="CHECK_NO" type="BIGDECIMAL" size="22"/>
          <Column id="TAXXPT_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="VAT_DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="SUPLY_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="VAT_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="DSGN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="CNTRCT_SE" type="STRING" size="3"/>
          <Column id="CNTRCT_MTHD" type="STRING" size="1"/>
          <Column id="ATCH_FILE" type="STRING" size="100"/>
          <Column id="ATCH_FLPTH" type="STRING" size="200"/>
          <Column id="ATCH_FILE_1" type="STRING" size="100"/>
          <Column id="ATCH_FLPTH_1" type="STRING" size="200"/>
          <Column id="REGISTER_ID" type="STRING" size="12"/>
          <Column id="REGIST_DT" type="DATE" size="7"/>
          <Column id="UPDUSR_ID" type="STRING" size="12"/>
          <Column id="UPDT_DT" type="DATE" size="7"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_expDsnDetail" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_expDsnDetail_oncolumnchanged" onrowsetchanged="ds_expDsnDetail_onrowsetchanged">
        <ColumnInfo>
          <Column id="DECSN_YEAR" type="STRING" size="4"/>
          <Column id="DECSN_NO" type="STRING" size="11"/>
          <Column id="SEQ" type="BIGDECIMAL" size="22"/>
          <Column id="DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="TAXXPT_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="VAT_AT" type="STRING" size="1"/>
          <Column id="BILL_KND" type="STRING" size="1"/>
          <Column id="VAT_DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="SUPLY_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="VAT" type="BIGDECIMAL" size="22"/>
          <Column id="BCNC_CODE" type="STRING" size="10"/>
          <Column id="BCNC_NM" type="STRING" size="256"/>
          <Column id="NM" type="STRING" size="30"/>
          <Column id="ADRES" type="STRING" size="200"/>
          <Column id="RQEST_DE" type="STRING" size="8"/>
          <Column id="RQEST_MAN" type="STRING" size="30"/>
          <Column id="RCPT_DE" type="STRING" size="8"/>
          <Column id="RCPT_MAN" type="STRING" size="30"/>
          <Column id="FNNC_INSTT_CODE" type="STRING" size="3"/>
          <Column id="ACNUTNO" type="STRING" size="20"/>
          <Column id="ENTRPRS_SE" type="STRING" size="1"/>
          <Column id="EVRFRND" type="STRING" size="1"/>
          <Column id="TCNDVLP" type="STRING" size="1"/>
          <Column id="CNTRWK_PRPOS_MTRIL" type="STRING" size="1"/>
          <Column id="AREA_ENTRPS" type="STRING" size="1"/>
          <Column id="FEMALE_ENTRPRS" type="STRING" size="1"/>
          <Column id="MIDDL_PD_CMPET_PRDUCT" type="STRING" size="1"/>
          <Column id="FRGCPT_ENTRPRS" type="STRING" size="1"/>
          <Column id="DSPSN" type="STRING" size="1"/>
          <Column id="SRSILL_DSPSN" type="STRING" size="1"/>
          <Column id="SOCTY_ENTRPRS" type="STRING" size="1"/>
          <Column id="DSPSN_PRDCTN_FCLTY" type="STRING" size="1"/>
          <Column id="SOCTY_CPER_MXTR" type="STRING" size="1"/>
          <Column id="GREEN_PRDUCT" type="STRING" size="1"/>
          <Column id="WHTAX_AT" type="STRING" size="1"/>
          <Column id="WHTAX_KND" type="STRING" size="1"/>
          <Column id="WHTAX_ADRES" type="STRING" size="200"/>
          <Column id="IHDNUM" type="STRING" size="256"/>
          <Column id="INCMTAX" type="STRING" size="256"/>
          <Column id="IHNTS" type="STRING" size="256"/>
          <Column id="WHTAX_INCOME_SE_CODE" type="STRING" size="256"/>
          <Column id="WHTAX_INDUTY_CODE" type="STRING" size="256"/>
          <Column id="MTCHG_SE" type="STRING" size="5"/>
          <Column id="BRRW_AMOUNT_INTR_RPAY_AT" type="STRING" size="1"/>
          <Column id="RM" type="STRING" size="200"/>
          <Column id="CMPNSP_NO" type="STRING" size="30"/>
          <Column id="REGISTER_ID" type="STRING" size="12"/>
          <Column id="REGIST_DT" type="DATE" size="7"/>
          <Column id="UPDUSR_ID" type="STRING" size="12"/>
          <Column id="UPDT_DT" type="DATE" size="7"/>
          <Column id="PBNCD_NO" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_decsnNo" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="PBNCD_NO" type="STRING" size="256"/>
          <Column id="RPAY_DE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_fun032" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript5.0"><![CDATA[/***********************************************************************
 * 화면ID   : FUN020301
 * 화면명   : 상환내역관리
 * 화면설명 : 상환내역 및 상환일정을 관리한다.
 * 작성일   : 2015.08.17
 * 작성자   : 양성모
 * 수정이력 : 
 ***********************************************************************
 *     수정일     수정자   내용
 ***********************************************************************
 *    
 ***********************************************************************
 */

/***********************************************************************
 * Script Include 
 ***********************************************************************/
// 시스템 공통 라이브러리 Include
include "lib::comLib.xjs";
include "lib::comInclude.xjs";
include "mis_lib::misUtil.xjs";
include "lib::comUpDownUtils.xjs";

/***********************************************************************
 * 화면 변수 선언부
 ***********************************************************************/
this.File_UpDownManager = null;
this.saveRow = -1;
this.checkDs = [this.ds_intrRpayPlan, this.ds_intrRpayDtls, this.ds_prncpalRpayDtls, this.ds_prncpalRpayPlan];

/***********************************************************************
 * onInit / onLoad 영역
 ***********************************************************************/
this.FUN020301_oninit = function(obj:Form, e:nexacro.InitEventInfo)
{
	// Form 초기화
	this.fn_init_form();

	// DataSet 초기화
	this.fn_init_dataset();
}

this.FUN020301_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{
	// 공통코드
	var comboParams = [
		["ds_fun013", "FUN013", "Y", "S"]	// 채권이자지급형태
	   ,["ds_fun014", "FUN014", "Y", "S"]	// 채권이자변동여부
	   ,["ds_fun015", "FUN015", "Y", "S"]	// 채권원금상환방법
	   ,["ds_fun032", "FUN032", "Y", ""]	// 신용평가등급
	];
	var callback = function (svcId, errorCode, errorMsg) {
		//this.fn_search();
	};
	this.gfn_comboLoad (comboParams, callback);		
}

/***********************************************************************
 * Form/Dataset 오브젝트 초기화
 ***********************************************************************/
 
/*
 * 함수명  	: initForm
 * 설명 		: Form을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initForm();
 */
this.fn_init_form = function()
{
	this.gfn_initForm(this);
	this.fn_misFormInit(this);
}

/*
 * 함수명  	: initDataset
 * 설명 		: Dataset을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initDataset();
 */
this.fn_init_dataset = function()
{
	// 조건에 사용되는 Dataset 초기화
	this.gfn_initCondDs(this, this.div_search);
	
	// 파일 메니저 설정
	var fileConfig = {
		//useMultiUpload : true,
		onChange: this.fn_onFileSelected,	// 파일 선택 이벤트 핸들러
		onSuccess : this.fn_onFileSuccess	// 전송 성공 이벤트 핸들러
		//responseGrid : this.div_multiFile.grd_fileList,
		//responseArea : this.div_multiFile.sta_helpMessage
	};
	this.File_UpDownManager = new this.fileUpDownManager(this, "MIS", "FUN");
	this.File_UpDownManager.init(fileConfig);
}



/***********************************************************************
* Inspection 영역
************************************************************************/
/*
 * 함수명  	: fn_valid
 * 설명 		: Form 자체적으로 Validation 체크가 필요할 경우 사용함.
				  gfn_checkValidation 함수로 체크가 불가능하거나, 더 복잡해지는 경우,
				  별도로 화면에서 체크를 하는 용도로 사용하면 됨.
 * params  		: strSvcId : 서비스 ID
 * return Type 	: true / false
 * 사용법		: this.fn_valid();
 */
this.fn_valid = function()
{
	    // validation 체크(이자상환계획)
		if(!this.gfn_checkValidation_NoUpdChk(this.ds_intrRpayPlan, this.ds_validation)) {
			return false;
		}
		
		// validation 체크(이자상환내역)
		if(!this.gfn_checkValidation_NoUpdChk(this.ds_intrRpayDtls, this.ds_validation)) {
			return false;
		}
		
	    // validation 체크(원금상환내역)
		if(!this.gfn_checkValidation_NoUpdChk(this.ds_prncpalRpayDtls, this.ds_validation)) {
			return false;
		}
				
	    // validation 체크(원금상환계획)
		if(!this.gfn_checkValidation_NoUpdChk(this.ds_prncpalRpayPlan, this.ds_validation)) {
			return false;
		}
		
		return true;
}

/***********************************************************************
* Transaction 영역 시작
************************************************************************/

/***********************************************************************
 * Transaction 관련 이벤트 핸들러 
 **********************************************************************/
/*
 * 함수명  	: fn_search
 * 설명 		: 조회 이벤트 처리(공사채 기본정보)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_search();
 */
this.fn_search = function()
{
	// validation 체크
	if(!this.gfn_checkValidation_NoUpdChk(this.ds_cond, this.ds_validation)) {
		return false;
	}	
	
	// 데이터셋 클리어
	this.ds_pbncdInfo.clearData();
	
	this.fn_transaction("selectPbncdInfo");
}

/*
 * 함수명  	: fn_save
 * 설명 		: 저장 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_save();
 */
this.fn_save = function()
{
	// 데이터셋 변경사항 체크
    if(Ex.util.isUpdated(this.ds_intrRpayPlan) || Ex.util.isUpdated(this.ds_intrRpayDtls) || Ex.util.isUpdated(this.ds_prncpalRpayDtls) || Ex.util.isUpdated(this.ds_prncpalRpayPlan)){
		
		// validation 체크(이자상환계획)
		if(!this.gfn_checkValidation_NoUpdChk(this.ds_intrRpayPlan, this.ds_validation)) {
			return false;
		}
		// validation 체크(원금상환계획)
		if(!this.gfn_checkValidation_NoUpdChk(this.ds_prncpalRpayPlan, this.ds_validation)) {
			return false;
		}
		// validation 체크(이자상환내역)
		if(!this.gfn_checkValidation_NoUpdChk(this.ds_intrRpayDtls, this.ds_validation)) {
			return false;
		}
		// validation 체크(원금상환내역)
		if(!this.gfn_checkValidation_NoUpdChk(this.ds_prncpalRpayDtls, this.ds_validation)) {
			return false;
		}
		
		this.fn_transaction("pbncdCUD");
		
	}else{
		//변경되지 않았을 경우.
		this.gfn_message("comm.데이터.변경.없음");
	}
}

/*
 * 함수명  	: fn_search_fileList
 * 설명 		: 조회
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_search_fileList();
 */
this.fn_search_fileList = function()
{
	this.ds_fileList.clearData();
	// cond set
	var cRow   = this.ds_pbncdInfo.rowposition;
	var fileSn = this.ds_pbncdInfo.getColumn(cRow, "FILE_SN");
	
	this.ds_cond_fileSn.clearData();
	var nRow = this.ds_cond_fileSn.addRow();
	
	this.ds_cond_fileSn.setColumn(nRow, "FILE_SN", fileSn);
	
	// transaction
	this.fn_transaction("selectAtchFile");
}

/*
 * 함수명  	: btn_exprtnAt_onclick
 * 설명 		: 공사채계좌 만기처리 버튼 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_exprtnAt_onclick();
 */
this.btn_exprtnAt_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var nBrrwAmt = this.ds_pbncdInfo.getColumn(0, "BRRW_AMOUNT"); // 차입금액
	var nRpayAmt = this.ds_prncpalRpayDtls.getSum("RPAY_AMOUNT"); // 원금상환금액 합
	var nRpayAmt01 = this.ds_intrRpayPlan.getSum("RPAY_AMOUNT"); // 이자상환계획금액 합
	var nRpayAmt02 = this.ds_intrRpayDtls.getSum("RPAY_AMOUNT"); // 이자상환집행금액 합
	var strExprtnAt = this.ds_pbncdInfo.getColumn(0, "EXPRTN_AT");
	
	if(strExprtnAt == "1"){
		if(this.gfn_message("comm.행위여부", "만기처리를 취소")){
			this.ds_pbncdInfo.setColumn(0, "EXPRTN_AT", "0");
			this.fn_transaction("pbncdInfoCUD");				
		}
	} else {
		if (this.gfn_message("comm.행위여부", "만기처리")) {
			if(nBrrwAmt - nRpayAmt == 0) {
				if(nRpayAmt01 - nRpayAmt02 == 0) {
					this.ds_pbncdInfo.setColumn(0, "EXPRTN_AT", "1");
					this.fn_transaction("pbncdInfoCUD");
				} else {
					this.gfn_message("fail.처리.불가", "이자계획총액|이자지급총액|만기처리");
				}
			} else {
				this.gfn_message("fail.처리.불가", "차입총액|원금상환총액|만기처리");
			}
			
		}
		
	}
}
/**********************************************************************
 * CALL TRANSACTION 영역
 **********************************************************************/
 
/*
 * 함수명  	: fn_transaction
 * 설명 		: Transaction 요청 처리 함수
 * params  		: strSvcId : 서비스요청 ID
 * return Type 	: None
 * 사용법		: this.fn_transaction("SELECT");
 */
this.fn_transaction = function(strSvcId)
{
	switch (strSvcId) {
		case "selectPbncdInfo":    		// 공사채 기본정보 조회
			var sController   	= "hsco/mis/fun/FUN020301/selectPbncdInfo.do";
			var sInDatasets   	= "input1=ds_cond";
			var sOutDatasets  	= "ds_pbncdInfo=output1 ds_intrRpayPlan=output2 ds_prncpalRpayPlan=output3 ds_intrRpayDtls=output4 ds_prncpalRpayDtls=output5";
			break;
		case "pbncdCUD":           		// 상환계획 및 내역 저장하기
			var sController   	= "hsco/mis/fun/FUN020301/pbncdCUD.do";	
			var sInDatasets   	= "input1=ds_intrRpayPlan:U, input2=ds_intrRpayDtls:U, input3=ds_prncpalRpayDtls:U, input4=ds_prncpalRpayPlan:U";
			var sOutDatasets  	= "";
			break;		
		
		case "intrRpayPlanCUD":			// 이자상환계획생성(단리, 년복리)
			var sController   	= "hsco/mis/fun/FUN020301/intrRpayPlanCUD.do";
			var sInDatasets   	= "input1=ds_cond";
			var sOutDatasets  	= "";
			break
		case "prncpalRpayPlanCUD":		// 원금상환계획생성
			var sController   	= "hsco/mis/fun/FUN020301/prncpalRpayPlanCUD.do";
			var sInDatasets   	= "input1=ds_cond";
			var sOutDatasets  	= "";
			break			
			
		case "pbncdInfoCUD":		    // 만기처리 실행
			var sController   	= "hsco/mis/fun/FUN020301/pbncdInfoCUD.do";
			var sInDatasets   	= "input1=ds_pbncdInfo:U";
			var sOutDatasets  	= "";
			break
		case "selectAtchFile":			// 첨부파일 조회
			var sController   	= "hsco/mis/fun/FUN020301/selectAtchFile.do";
			var sInDatasets   	= "input1=ds_cond_fileSn";
			var sOutDatasets  	= "ds_fileList=output1";
			break;
		case "intrRpayPlanLoad":    	// 이자지급계획 가져오기(전체)
			var sController   	= "hsco/mis/fun/FUN020301/intrRpayPlanLoad.do";
			var sInDatasets   	= "input1=ds_pbncdInfo";
			var sOutDatasets  	= "ds_intrRpayDtls=output1";
			break;		
		case "prncpalRpayPlanLoad":    	// 원금상환계획 가져오기(전체)
			var sController   	= "hsco/mis/fun/FUN020301/prncpalRpayPlanLoad.do";
			var sInDatasets   	= "input1=ds_pbncdInfo";
			var sOutDatasets  	= "ds_prncpalRpayDtls=output1";
			break;
	}

	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets); 
}

 /**********************************************************************
 * Transaction Callback 영역
 ***********************************************************************/
 
 /*
 * 함수명  	: fn_callBack
 * 설명 		: Transaction Callback 처리
 * params  		: strSvcId    : 서비스요청 ID
 *                nErrorCode  : 오류 메시지 코드 ([예] 0 : Success, 그밖의 경우, error)
 *                strErrorMsg : 오류 메시지([예]  success.insert|정상적으로 등록되었습니다.)
 * return Type 	: None
 * 사용법		: 
 */
this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg)
{
	// 오류 및 성공 메시지를 화면에 보여준다.
	if (nErrorCode != 0){
		this.gfn_callback_message(strSvcId, nErrorCode, strErrorMsg);
	} else {
		// 실패 메시지를 보여주는 동작 외에 처리할 내용이 있으면 아래에 기술.
		switch (strSvcId) {
			case "selectPbncdInfo":		// 공사채 기본정보 조회
				this.fn_search_fileList();
				this.ds_intrRpayPlan.applyChange();
				this.ds_prncpalRpayPlan.applyChange();
				this.ds_intrRpayDtls.applyChange();
				this.ds_prncpalRpayDtls.applyChange();
				break;
			case "pbncdCUD":			// 상환계획 및 내역 저장
			    this.gfn_message("success.처리.성공");
			    this.fn_search();
				break;			
			case "intrRpayPlanCUD":		// 이자상환계획생성(단리, 년복리)
			    this.gfn_message("success.처리.성공");
			    this.fn_search();
				break;
			case "prncpalRpayPlanCUD":	// 원금상환계획생성
			    this.gfn_message("success.처리.성공");
			    this.fn_search();
				break;
			case "pbncdInfoCUD":	    // 만기처리 실행
				this.fn_transaction("pbncdCUD")
				break;
			case "selectFileList":      // 첨부파일 조회
				this.ds_fileList.filter("USE_AT == '1'");
				break;
			case "intrRpayPlanLoad":           			// 이자지급계획 가져오기(전체)
				this.gfn_message("success.처리.성공");
				break;
			case "prncpalRpayPlanLoad":           		// 원금상환계획 가져오기(전체)
			    this.gfn_message("success.처리.성공");
				break;
		}
	}
}

/*
 * 함수명  	: fn_PopupCallback
 * 설명 		: 팝업 콜백함수
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_PopupCallback();
 */
this.fn_PopupCallback = function(sPopupId, sReturn)
{	
	var dsRtn = new Dataset();
	nRowCnt = dsRtn.loadXML(sReturn);	
	
	if(nRowCnt>=0){
		if(sPopupId == "fun020301_p01") {
			if(nRowCnt){
				this.ds_cond.setColumn(0, "PBNCD_NO", dsRtn.getColumn(0,"PBNCD_NO"));
				this.ds_cond.setColumn(0, "BRRW_ACNUT_NM", dsRtn.getColumn(0,"BRRW_ACNUT_NM"));
				this.fn_search();
			}
		}
		
		if(sPopupId == "fun020301_p02") {
			if(sReturn == "1"){//원금상환계획
				this.fn_Popup3();
			} 
			else if(sReturn == "2") { //이자지급계획
				this.fn_Popup4();
			}
		}
		
		// 원리금납부 결재 팝업 콜백
		if(sPopupId == "fun020301_p03") {
			if(!this.comUtils.isNull(dsRtn.getColumn(0,"SANCTN_NO"))){
				var findRow   = this.ds_prncpalRpayPlan.findRow("CHK", "1");
				var findRow02 = this.ds_intrRpayPlan.findRow("CHK", "1");
				
				this.ds_prncpalRpayPlan.setColumn(findRow, "SANCTN_NO", dsRtn.getColumn(0,"SANCTN_NO"));
				this.ds_intrRpayPlan.setColumn(findRow02, "SANCTN_NO", dsRtn.getColumn(0,"SANCTN_NO"));
				
				this.fn_save();
			}
		}
		
		// 이자지급 결재 팝업 콜백
		if(sPopupId == "fun020301_p07") {
			if(!this.comUtils.isNull(dsRtn.getColumn(0,"SANCTN_NO"))){
				this.fn_search();
			}
		}
	}	
}

/***********************************************************************
* Transaction 영역 끝
************************************************************************/

/***********************************************************************
* 사용자 정의 함수
************************************************************************/
/*
 * 함수명  	: div_search_btn_pbncd_onclick
 * 설명 		: 공사채조회팝업 호출
 * params  		: None
 * return Type 	: None
 * 사용법		: this.div_search_btn_pbncd_onclick();
 */
this.div_search_btn_pbncd_onclick = function()
{	
	var parm = {
		arg_0 : this  //==> 필수, 팝업을 호출하는 form을 참조할 수 있도록 팝업에 Argument로 넘겨준다. (반드시 기술해야 함.)
	};
	
	/**
	* 팝업 공통함수
	* @param {string} svcId
	* @param {number} Width
	* @param {number} Height
	* @param {string} Title
	* @param {string} form URL
	* @param {string} Callback Function
	* @return N/A
	* @example
	* @memberOf comLib
	*/
	this.gfn_popup("fun020301_p01", 1000, 700, "공사채조회", parm, "mis_fun::FUN020301_P01.xfdl", "fn_PopupCallback");	
}


/*
 * 함수명  	: div_Cont_btn_Add_Row_onclick
 * 설명 		: 탭 계획생성 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.div_Cont_btn_Add_Row_onclick();
 */
this.fn_planCreat = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.ds_pbncdInfo.getColumn(0, "EXPRTN_AT") == "1") {
		this.gfn_message("fail.수정.불가", "만기처리된 공사채는");
	} 
	else {
		//이자지급계획
		if(this.div_work.tab_pbncd.tabindex == 0){
			
			if(this.ds_prncpalRpayPlan.rowcount > 0) {
				
				var intrCycle = this.ds_pbncdInfo.getColumn(0, "INTR_CYCLE");
				
				if(!this.comUtils.isNull(intrCycle)){
					if(this.gfn_message("confirm.삭제.진행", " 가장 마지막 확정처리된 계획일자 이후의 내역을 삭제 후 신규 계획이 생성됩니다.")) {
						this.fn_transaction("intrRpayPlanCUD");
					}
				} else {
					this.gfn_message("comm.항목.입력.을", "이자주기");
					return;
				}
			} 
			else {
				this.gfn_message("info.저장.초과", "원금상환계획 등록 후");
				return;
			}
		}
		
		//원금상환계획
		if(this.div_work.tab_pbncd.tabindex == 1){
			
			var dfrMt = this.ds_pbncdInfo.getColumn(0, "DFR_MT");
			var rpayMt = this.ds_pbncdInfo.getColumn(0, "RPAY_MT");
			
			if(!this.comUtils.isNull(dfrMt) && !this.comUtils.isNull(rpayMt)) {
				
				if(this.gfn_message("confirm.삭제.진행", "가장 마지막 확정처리된 계획일자 이후의 내역을 삭제 후 신규 계획이 생성됩니다.")) {
					this.fn_transaction("prncpalRpayPlanCUD");
				}
			} 
			else {
				this.gfn_message("comm.항목.입력.을", "거치월/상환월");
				return;
			}
		}	
	}
	
}

/*
 * 함수명  	: div_work_btn_Add_Row03_onclick
 * 설명 		: 탭 행추가 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.div_work_btn_Add_Row03_onclick();
 */
this.fn_insert = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var strPbncdNo = this.ds_pbncdInfo.getColumn(0, "PBNCD_NO");
	
	if(!strPbncdNo){
		this.gfn_message("info.항목.선택.알림", "공사채");
	} 
	else if(this.ds_pbncdInfo.getColumn(0, "EXPRTN_AT") == "1") {
		this.gfn_message("fail.수정.불가", "만기처리된 공사채는");
	} 
	else {
		if(this.div_work.tab_pbncd.tabindex == 0){
			var nRow = this.ds_intrRpayPlan.addRow();
			
			this.ds_intrRpayPlan.setColumn(nRow, "RPAY_AMOUNT", 0);
			this.ds_intrRpayPlan.setColumn(nRow, "PBNCD_NO"   , strPbncdNo);
			this.ds_intrRpayPlan.setColumn(nRow, "RPAY_DE"    , this.dateUtils.today());
			this.ds_intrRpayPlan.setColumn(nRow, "RPAY_INTRT" , this.ds_pbncdInfo.getColumn(0, "INTRT"));
			this.ds_intrRpayPlan.setColumn(nRow, "UPDATE_POSBL_AT",  '1');
			this.ds_intrRpayPlan.setColumn(nRow, "EXPRTN_AT"  , '0');
			this.ds_intrRpayPlan.setColumn(nRow, "CNFIRM_AT"  , '0');
		}
		
		if(this.div_work.tab_pbncd.tabindex == 1){
			var nRow = this.ds_prncpalRpayPlan.addRow();
			
			this.ds_prncpalRpayPlan.setColumn(nRow, "RPAY_AMOUNT", 0);
			this.ds_prncpalRpayPlan.setColumn(nRow, "PBNCD_NO"   , strPbncdNo);
			this.ds_prncpalRpayPlan.setColumn(nRow, "RPAY_DE"    , this.dateUtils.today());
			this.ds_prncpalRpayPlan.setColumn(nRow, "RPAY_INTRT" , this.ds_pbncdInfo.getColumn(0, "INTRT"));
			this.ds_prncpalRpayPlan.setColumn(nRow, "UPDATE_POSBL_AT",  '1');
			this.ds_prncpalRpayPlan.setColumn(nRow, "EXPRTN_AT"  , '0');
			this.ds_prncpalRpayPlan.setColumn(nRow, "CNFIRM_AT"  , '0');
		}
		
		if(this.div_work.tab_pbncd.tabindex == 2){
			var nRow = this.ds_intrRpayDtls.addRow();
			
			this.ds_intrRpayDtls.setColumn(nRow, "RPAY_AMOUNT", 0);
			this.ds_intrRpayDtls.setColumn(nRow, "PBNCD_NO"   , strPbncdNo);
			this.ds_intrRpayDtls.setColumn(nRow, "RPAY_DE",     this.dateUtils.today());
			this.ds_intrRpayDtls.setColumn(nRow, "RPAY_INTRT",  this.ds_pbncdInfo.getColumn(0, "INTRT"));
		}
		
		if(this.div_work.tab_pbncd.tabindex == 3){
			var nRow = this.ds_prncpalRpayDtls.addRow();
			
			this.ds_prncpalRpayDtls.setColumn(nRow, "RPAY_AMOUNT", 0);
			this.ds_prncpalRpayDtls.setColumn(nRow, "PBNCD_NO"   , strPbncdNo);
			this.ds_prncpalRpayDtls.setColumn(nRow, "RPAY_DE",     this.dateUtils.today());
			this.ds_prncpalRpayDtls.setColumn(nRow, "RPAY_INTRT",  this.ds_pbncdInfo.getColumn(0, "INTRT"));			
		}		
	}	
}

/*
 * 함수명  	: div_work_btn_Del_Row02_onclick
 * 설명 		: 탭 행삭제 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.div_work_btn_Del_Row02_onclick();
 */
this.fn_delete = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.ds_pbncdInfo.getColumn(0, "EXPRTN_AT") == "1") {
		this.gfn_message("fail.수정.불가", "만기처리된 공사채는");
	} 
	else {
		if(this.gfn_message("confirm.삭제여부")){
			
			if(this.div_work.tab_pbncd.tabindex == 0){
				var nRow = this.ds_intrRpayPlan.rowposition;
				var cnfirmAt = this.ds_intrRpayPlan.getColumn(nRow, "CNFIRM_AT");
				
				if(cnfirmAt == '1'){
					this.gfn_message("fail.수정.불가", "확정처리된 공사채는");
					return false;
				}
				
				// 결재상태 COM022 (0: 기안전 1:기안 2:반송 3:취소 4:중간결재 5:결재완료)
				var SANCTN_STS = this.ds_intrRpayPlan.getColumn(nRow, "SANCTN_STS");
				switch (SANCTN_STS) {
					case "1": case "4":
					this.gfn_message("comm.결재.진행");
					return false;
					
					case "5": 
					this.gfn_message("comm.결재.완료");
					return false;
					
					default:
				}
				
				this.ds_intrRpayPlan.deleteRow(nRow);
			}
			
			if(this.div_work.tab_pbncd.tabindex == 1){
				var nRow = this.ds_prncpalRpayPlan.rowposition;
				var cnfirmAt = this.ds_prncpalRpayPlan.getColumn(nRow, "CNFIRM_AT");
				
				if(cnfirmAt == '1'){
					this.gfn_message("fail.수정.불가", "확정처리된 공사채는");
					return false;
				}
				
				// 결재상태 COM022 (0: 기안전 1:기안 2:반송 3:취소 4:중간결재 5:결재완료)
				var SANCTN_STS = this.ds_prncpalRpayPlan.getColumn(nRow, "SANCTN_STS");
				switch (SANCTN_STS) {
					case "1": case "4":
					this.gfn_message("comm.결재.진행");
					return false;
					
					case "5": 
					this.gfn_message("comm.결재.완료");
					return false;
					
					default:
				}

				this.ds_prncpalRpayPlan.deleteRow(nRow);
			}
			
			if(this.div_work.tab_pbncd.tabindex == 2){
				var nRow = this.ds_intrRpayDtls.rowposition;
				
				this.ds_intrRpayDtls.deleteRow(nRow);
			}
			
			if(this.div_work.tab_pbncd.tabindex == 3){
				var nRow = this.ds_prncpalRpayDtls.rowposition;
				
				this.ds_prncpalRpayDtls.deleteRow(nRow);
			}
		}
	}	
}

/*
 * 함수명  	: div_work_btn_Cancel_Row02_onclick
 * 설명 		: 탭 취소 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.div_work_btn_Cancel_Row02_onclick();
 */
this.fn_cancel = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.div_work.tab_pbncd.tabindex == 0){		
		if (this.gfn_message("confirm.취소여부")) {
			this.ds_intrRpayPlan.reset();		//DATASET ROLLBACK
			this.ds_intrRpayPlan.applyChange();	//DATASET COMMIT
			return;
		}		
	}
	
	if(this.div_work.tab_pbncd.tabindex == 1){
		if (this.gfn_message("confirm.취소여부")) {
			this.ds_prncpalRpayPlan.reset();		//DATASET ROLLBACK
			this.ds_prncpalRpayPlan.applyChange();	//DATASET COMMIT
			return;
		}	
	}
	
	if(this.div_work.tab_pbncd.tabindex == 2){
		if (this.gfn_message("confirm.취소여부")) {
			this.ds_intrRpayDtls.reset();		//DATASET ROLLBACK
			this.ds_intrRpayDtls.applyChange();	//DATASET COMMIT
			return;
		}
	}
	
	if(this.div_work.tab_pbncd.tabindex == 3){
		if (this.gfn_message("confirm.취소여부")) {
			this.ds_prncpalRpayDtls.reset();		//DATASET ROLLBACK
			this.ds_prncpalRpayDtls.applyChange();	//DATASET COMMIT
			return;
		}
	}			
}


/*
 * 함수명  	: btn_downFiles_onclick
 * 설명 		: '선택다운로드' 버튼 클릭 후 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_downFiles_onclick(obj,e);
 */
this.btn_downFiles_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var findRow = this.ds_fileList.findRow("CHK", "1");
	if(findRow < 0) {
		this.gfn_message("comm.데이터.선택.없음");
			return;
	}
	
	for(var fRow = 0; fRow < this.ds_fileList.getRowCount(); fRow++) {
		var fileSn    = this.ds_fileList.getColumn(fRow, "FILE_SN");
		var fileOrder = this.ds_fileList.getColumn(fRow, "FILE_ORDR");
		var fileName  = this.ds_fileList.getColumn(fRow, "ORGINL_FILE_NM");
		var chk       = this.ds_fileList.getColumn(fRow, "CHK");
		if(chk == '1') {
			this.File_UpDownManager.download(fileSn, fileOrder, fileName);
		}
	}
}

/*
 * 함수명  	: file_upload_popup
 * 설명 		: 첨부파일 그리드 전체파일선택 ON/OFF 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.file_upload_popup(obj,e);
 */
this.div_work_grd_cmmnAtchmnfl_onheadclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	if(e.col == 0) {
		this.gfn_setGridCheckAll(obj, e);
	}
}

/*
 * 함수명  	: file_upload_popup
 * 설명 		: 첨부파일 그리드 Body의 체크 버튼이 눌러졌을 때, Head 부분의 체크 버튼을 꺼 줌.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.file_upload_popup(obj,e);
 */
this.div_work_grd_cmmnAtchmnfl_oncellclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	if(e.cell == 0) {
		obj.setCellProperty("Head", e.cell, "text", "0");
	}
}


/*
 * 함수명  	: fn_sanction
 * 설명 		: 결재 버튼 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_sanction();
 */
this.fn_sanction = function(){
	this.gfn_message("info.처리불가", "준비중입니다.");
    return;
	
	if(Ex.util.isUpdated(this.ds_intrRpayPlan) || Ex.util.isUpdated(this.ds_intrRpayDtls) || Ex.util.isUpdated(this.ds_prncpalRpayDtls) || Ex.util.isUpdated(this.ds_prncpalRpayPlan)){
	    this.gfn_message("comm.정보.저장.요청", "변경된");
	    return;
	}
	
	var parm = {
		arg_0 : this  //==> 필수, 팝업을 호출하는 form을 참조할 수 있도록 팝업에 Argument로 넘겨준다. (반드시 기술해야 함.)
	};
	
	/**
	* 팝업 공통함수
	* @param {string} svcId
	* @param {number} Width
	* @param {number} Height
	* @param {string} Title
	* @param {string} form URL
	* @param {string} Callback Function
	* @return N/A
	* @example
	* @memberOf comLib
	*/
	this.gfn_popup("fun020301_p02", 380, 125, "결재선택팝업", parm, "mis_fun::FUN020301_P02.xfdl", "fn_PopupCallback");
}


/*
 * 함수명  	: fn_Popup3
 * 설명 		: 결재 버튼 이벤트 처리(원리금납부)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_Popup3();
 */
this.fn_Popup3 = function(){

	var findRow01     = this.ds_prncpalRpayPlan.findRow("CHK", "1");
	var findRow02     = this.ds_intrRpayPlan.findRow("CHK", "1");
	
	if(findRow01 < 0){
		this.gfn_message("info.항목.선택.알림", "원금상환계획");
		return;
	}
	
	if(findRow02 < 0){
		this.gfn_message("info.항목.선택.알림", "이자지급계획");
		return;
	}
	
	var brrwAmt       = this.ds_pbncdInfo.getColumn(0, "BRRW_AMOUNT");									// 차입금액
	var rpayDe        = this.ds_prncpalRpayPlan.getColumn(findRow01, "RPAY_DE"); 						// 당회 원금상환일자
	var prncpalTotAmt = this.ds_prncpalRpayPlan.getCaseSum("RPAY_DE < '"+ rpayDe +"'","RPAY_AMOUNT");	// 당회 이전까지의 원금상환합계
	var blce 	      = brrwAmt - prncpalTotAmt															// 원금상환잔액
	var prncpalAmt    = this.ds_prncpalRpayPlan.getColumn(findRow01, "RPAY_AMOUNT");					// 당회 상환 원금액
	var intrAmt       = this.ds_intrRpayPlan.getColumn(findRow01, "RPAY_AMOUNT");						// 당회 상환 이자액
	var cptalKndNm    = this.ds_pbncdInfo.getColumn(0, "CPTAL_KND_NM");									// 자금종류
	
	if (cptalKndNm == "공모채권") {
		cptalKndNm = "공사채"
	}
	
	this.ds_temp01.clearData();
	this.ds_temp01.addRow();
	
	this.ds_temp01.setColumn(0, "C01", cptalKndNm);											// 제목
	this.ds_temp01.setColumn(0, "C02", prncpalAmt + intrAmt);								// 당회 지출금액(납부금액)
	this.ds_temp01.setColumn(0, "C03", this.ds_pbncdInfo.getColumn(0, "BRRW_ACNUT_NM"));	// 차입계좌명
	
	// 차입조건 영역 데이터 설정
	this.ds_temp01.setColumn(0, "C04", brrwAmt);											// 차입금액
	this.ds_temp01.setColumn(0, "C05", this.ds_pbncdInfo.getColumn(0, "INTRT"));			// 이율
	this.ds_temp01.setColumn(0, "C06A", this.ds_pbncdInfo.getColumn(0, "BRRW_DE"));			// 차입일
	this.ds_temp01.setColumn(0, "C06B", this.ds_pbncdInfo.getColumn(0, "EXPRTN_DE"));		// 만기일
	
	this.ds_temp01.setColumn(0, "C07", blce);												// 원금상환잔액
	
	// 금회상환내역 영역 데이터 설정
	this.ds_temp01.setColumn(0, "C08", prncpalAmt);											// 상환원금액
	this.ds_temp01.setColumn(0, "C09", intrAmt);											// 상환이자액
	this.ds_temp01.setColumn(0, "C10", prncpalAmt + intrAmt);								// 상환원리금(당회 원금 + 당회 이자)	
	if(findRow02 == 0){	// 첫 이자상환이면 차입일, 아니면 전 이자상환일
		this.ds_temp01.setColumn(0, "C11A", this.ds_pbncdInfo.getColumn(0, "BRRW_DE"));		// 이자산출기간 시작일
	} 
	else if(findRow02 > 0){
		this.ds_temp01.setColumn(0, "C11A", this.ds_intrRpayPlan.getColumn(findRow02-1, "RPAY_DE"));
	}
	this.ds_temp01.setColumn(0, "C11B", this.ds_intrRpayPlan.getColumn(findRow02, "RPAY_DE3"));		// 이자산출기간 종료일(지급일자 - 1)
	
	this.ds_temp01.setColumn(0, "C12",  this.ds_prncpalRpayPlan.getColumn(findRow01, "RPAY_DE"));			// 원리금상환 지급일자, 디폴트 = 원금상환일자
	this.ds_temp01.setColumn(0, "PBNCD_NO",  this.ds_intrRpayPlan.getColumn(findRow02, "PBNCD_NO"));		// 공사채번호
	this.ds_temp01.setColumn(0, "RPAY_DE",   this.ds_intrRpayPlan.getColumn(findRow02, "RPAY_DE2"));		// 지출일자(이자)
	this.ds_temp01.setColumn(0, "RPAY_DE1",  this.ds_prncpalRpayPlan.getColumn(findRow01, "RPAY_DE2"));		// 지출일자(원금)
	
	var parm = {
		arg_0 : this  //==> 필수, 팝업을 호출하는 form을 참조할 수 있도록 팝업에 Argument로 넘겨준다. (반드시 기술해야 함.)
	   ,arg_1 : this.ds_temp01	
	};
	
	/**
	* 팝업 공통함수
	* @param {string} svcId
	* @param {number} Width
	* @param {number} Height
	* @param {string} Title
	* @param {string} form URL
	* @param {string} Callback Function
	* @return N/A
	* @example
	* @memberOf comLib
	*/
	this.gfn_popup("fun020301_p03", 1000, 316, "", parm, "mis_fun::FUN020301_P03.xfdl", "fn_PopupCallback", true);
}


/*
 * 함수명  	: fn_Popup4
 * 설명 		: 결재 버튼 이벤트 처리(이자납부)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_Popup4();
 */
this.fn_Popup4 = function(){

	var findRow     = this.ds_intrRpayPlan.findRow("CHK", "1");

	if(findRow<0){
		this.gfn_message("info.항목.선택.알림", "이자지급계획");
		return;
	}
	
	this.ds_temp02.clearData();
	this.ds_temp02.addRow();
	
	var cptalKnd = this.ds_pbncdInfo.getColumn(0, "CPTAL_KND");
	var cptalKndNm = this.ds_pbncdInfo.getColumn(0, "CPTAL_KND_NM");
	
	if (cptalKnd == "A03" || cptalKnd == "A04" || cptalKnd == "B03" || cptalKnd == "B04") {
		cptalKndNm = "공사채"
	} 
	
	this.ds_temp02.setColumn(0, "C00", cptalKnd);													// 자금구분
	this.ds_temp02.setColumn(0, "C01", cptalKndNm);													// 제목
	this.ds_temp02.setColumn(0, "C02", this.ds_intrRpayPlan.getColumn(findRow, "RPAY_AMOUNT"));		// 지출금액(납부금액)
	this.ds_temp02.setColumn(0, "C13", this.ds_intrRpayPlan.getColumn(findRow, "KR_AMT"));	    	// 지출금액(한글)
	this.ds_temp02.setColumn(0, "C03", this.ds_pbncdInfo.getColumn(0, "BRRW_ACNUT_NM"));			// 차입계좌명
	//this.ds_temp02.setColumn(0, "C04", this.ds_pbncdInfo.getColumn(0, "BRRW_AMOUNT") - this.ds_prncpalRpayDtls.getSum("RPAY_AMOUNT"));				// 차입금액
	this.ds_temp02.setColumn(0, "C04", this.ds_pbncdInfo.getColumn(0, "BRRW_BALANCE"));				// 차입금액(차입금액 - 상환금액)
	this.ds_temp02.setColumn(0, "C05", this.ds_pbncdInfo.getColumn(0, "INTRT"));					// 이율
	this.ds_temp02.setColumn(0, "C06A", this.ds_pbncdInfo.getColumn(0, "BRRW_DE"));					// 차입일
	this.ds_temp02.setColumn(0, "C06B", this.ds_pbncdInfo.getColumn(0, "EXPRTN_DE"));				// 만기일
	this.ds_temp02.setColumn(0, "C08", this.ds_intrRpayPlan.getColumn(findRow, "RPAY_AMOUNT"));		// 상환이자액
	this.ds_temp02.setColumn(0, "C09", this.ds_intrRpayPlan.getColumn(findRow, "RPAY_DE"));			// 지출일자
	this.ds_temp02.setColumn(0, "C12", this.ds_pbncdInfo.getColumn(0, "BSNS_NM"));					// 사업명
	this.ds_temp02.setColumn(0, "PBNCD_NO", this.ds_intrRpayPlan.getColumn(findRow, "PBNCD_NO"));	// 공사채번호
	this.ds_temp02.setColumn(0, "RPAY_DE",  this.ds_intrRpayPlan.getColumn(findRow, "RPAY_DE2"));	// 지출일자
	
	var parm = {
		arg_0 : this  //==> 필수, 팝업을 호출하는 form을 참조할 수 있도록 팝업에 Argument로 넘겨준다. (반드시 기술해야 함.)
	   ,arg_1 : this.ds_temp02
	};
	
	/**
	* 팝업 공통함수
	* @param {string} svcId
	* @param {number} Width
	* @param {number} Height
	* @param {string} Title
	* @param {string} form URL
	* @param {string} Callback Function
	* @return N/A
	* @example
	* @memberOf comLib
	*/
	this.gfn_popup("fun020301_p07", 757, 316, "", parm, "mis_fun::FUN020301_P07.xfdl", "fn_PopupCallback", true);
}


/*
 * 함수명  	: div_work_tab_master_tpg2_grd_cptalAsign_oncellclick
 * 설명 		: 이자지급계획 그리드 결재란 체크 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.div_work_tab_master_tpg2_grd_cptalAsign_oncellclick();
 */
this.div_work_tab_pbncd_tpg1_grd_intrRpayPlan_oncellclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
		
	// 결재 항목
	if(e.col == 0) {
		
		var iRow = this.ds_intrRpayPlan.rowposition;
		var chkVal = this.ds_intrRpayPlan.getColumn(iRow, "CHK");
		var SANCTN_STS = this.ds_intrRpayPlan.getColumn(iRow, "SANCTN_STS");
		var uptPlAt = this.ds_intrRpayPlan.getColumn(iRow, "UPDATE_POSBL_AT");
		
		if(uptPlAt == '1'){
			this.ds_intrRpayPlan.set_updatecontrol(false);
			if(chkVal == '1') {
				this.ds_intrRpayPlan.setColumn(iRow, "CHK", "0");
			} 
			else {
				
				// 결재상태 COM022 (0: 기안전 1:기안 2:반송 3:취소 4:중간결재 5:결재완료)
				switch (SANCTN_STS) {
					case "1": case "4":
					this.gfn_message("comm.결재.진행");
					return false;
					
					case "5": 
					this.gfn_message("comm.결재.완료");
					return false;
					
					default:
				}		
				
				if(this.ds_intrRpayPlan.getCaseCount("CHK == '1'") == 1){
					this.gfn_message("info.파일선택.알림", "1건");
					return;
				}
				this.ds_intrRpayPlan.setColumn(iRow, "CHK", "1");
			}
			this.ds_intrRpayPlan.set_updatecontrol(true);
		}
	}

	// 결의서 항목
	if(e.col == 7) {
		this.fn_createOrView_EXPNDTR_DECSN(this.ds_intrRpayPlan, e.row, this.ds_intrRpayPlan.getColumn(e.row, "RPAY_AMOUNT"), "공사채 이자납부", "FUN020301");
	}
	
	// 선택 항목
	if(e.col == 8) {
		var iRow = this.ds_intrRpayPlan.rowposition;
		var chkVal = this.ds_intrRpayPlan.getColumn(iRow, "CHK2");
		
		this.ds_intrRpayPlan.set_updatecontrol(false);
		if(chkVal == '1') {
			this.ds_intrRpayPlan.setColumn(iRow, "CHK2", "0");
		} 
		else {
			this.ds_intrRpayPlan.setColumn(iRow, "CHK2", "1");
		}
		this.ds_intrRpayPlan.set_updatecontrol(true);
	}
		
}

/*
 * 함수명  	: div_work_tab_pbncd_tpg1_grd_intrRpayPlan_oncelldblclick
 * 설명 		: 이자지급계획 더블 클릭 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.div_work_tab_pbncd_tpg1_grd_intrRpayPlan_oncelldblclick();
 */
this.div_work_tab_pbncd_tpg1_grd_intrRpayPlan_oncelldblclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	// 전자결재 기안 보기
	if(e.col == 1){
		// 전자결재 연동 작업 이후 활성화 예정
// 		var sanctnNo = this.ds_intrRpayPlan.getColumn(this.ds_intrRpayPlan.rowposition, "SANCTN_NO");
// 		var SANCTN_STS = this.ds_intrRpayPlan.getColumn(this.ds_intrRpayPlan.rowposition, "SANCTN_STS");
// 		//공통요청 2016.08.30
// 		var REGIST_DT = this.ds_intrRpayPlan.getColumn(this.ds_intrRpayPlan.rowposition, "REGIST_DT");
// 		//alert("이자 sanctnNo = " + sanctnNo +  " SANCTN_STS = " + SANCTN_STS);
// 		if(!this.comUtils.isNullEmpty(sanctnNo)){
// 			if(SANCTN_STS < 1 || SANCTN_STS == 'NUL'){
// 				return;
// 			}
// 			this.popupSactionStts(sanctnNo,REGIST_DT);			
// 		} 
// 		else {
// 			this.gfn_message("fail.정보검색.실패", "진행된 결재 정보를");
// 		}
	}	
}

/*
 * 함수명  	: div_work_tab_master_tpg2_grd_cptalAsign_oncellclick
 * 설명 		: 원금상환계획 그리드 결재란 체크 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.div_work_tab_master_tpg2_grd_cptalAsign_oncellclick();
 */
this.div_work_tab_pbncd_tpg2_grd_prncpalRpayPlan_oncellclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	
	// 결재 항목
	if(e.col == 0) {
		
		var iRow = this.ds_prncpalRpayPlan.rowposition;
		var chkVal = this.ds_prncpalRpayPlan.getColumn(iRow, "CHK");
		var SANCTN_STS = this.ds_prncpalRpayPlan.getColumn(iRow, "SANCTN_STS");
		var uptPlAt = this.ds_intrRpayPlan.getColumn(iRow, "UPDATE_POSBL_AT");
		
		if(uptPlAt == '1'){
			this.ds_prncpalRpayPlan.set_updatecontrol(false);
			if(chkVal == '1') {
				this.ds_prncpalRpayPlan.setColumn(iRow, "CHK", "0");
			} 
			else {
				
				// 결재상태 COM022 (0: 기안전 1:기안 2:반송 3:취소 4:중간결재 5:결재완료)
				switch (SANCTN_STS) {
					case "1": case "4":
					this.gfn_message("comm.결재.진행");
					return false;
					
					case "5": 
					this.gfn_message("comm.결재.완료");
					return false;
					
					default:
				}
				
				if(this.ds_prncpalRpayPlan.getCaseCount("CHK == '1'") == 1){
					this.gfn_message("info.파일선택.알림", "1건");
					return;
				}
				this.ds_prncpalRpayPlan.setColumn(iRow, "CHK", "1");
			}
			this.ds_prncpalRpayPlan.set_updatecontrol(true);
		}		
		
	}
	
	// 결의서 항목
	if(e.col == 7) {
		this.fn_createOrView_EXPNDTR_DECSN(this.ds_prncpalRpayPlan, e.row, this.ds_prncpalRpayPlan.getColumn(e.row, "RPAY_AMOUNT"), "공사채 원리금납부", "FUN020301_2");
	}	
	
	// 선택 항목
	if(e.col == 8) {
		
		var iRow = this.ds_prncpalRpayPlan.rowposition;
		var chkVal = this.ds_prncpalRpayPlan.getColumn(iRow, "CHK2");
		
		this.ds_prncpalRpayPlan.set_updatecontrol(false);
		if(chkVal == '1') {
			this.ds_prncpalRpayPlan.setColumn(iRow, "CHK2", "0");
		} 
		else {
			this.ds_prncpalRpayPlan.setColumn(iRow, "CHK2", "1");
		}
		this.ds_prncpalRpayPlan.set_updatecontrol(true);
	}	
}

/*
 * 함수명  	: div_work_tab_pbncd_tpg2_grd_prncpalRpayPlan_oncelldblclick
 * 설명 		: 원금상환계획 그리드 더블클릭 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.div_work_tab_pbncd_tpg2_grd_prncpalRpayPlan_oncelldblclick();
 */
this.div_work_tab_pbncd_tpg2_grd_prncpalRpayPlan_oncelldblclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	// 결재상세 항목
	if(e.col == 1){
		// 전자결재 연동 작업 이후 활성화 예정
// 		var sanctnNo = this.ds_prncpalRpayPlan.getColumn(this.ds_prncpalRpayPlan.rowposition, "SANCTN_NO");
// 		var SANCTN_STS = this.ds_prncpalRpayPlan.getColumn(this.ds_prncpalRpayPlan.rowposition, "SANCTN_STS");
// 		//공통요청 2016.08.30
// 		var REGIST_DT = this.ds_prncpalRpayPlan.getColumn(this.ds_prncpalRpayPlan.rowposition, "REGIST_DT");
// 		//alert("원금 sanctnNo = " + sanctnNo + "  SANCTN_STS = " + SANCTN_STS);
// 		if(!this.comUtils.isNullEmpty(sanctnNo)){
// 			if(SANCTN_STS == "NUL"){
// 				return;
// 			}
// 			this.popupSactionStts(sanctnNo, REGIST_DT);			
// 		} 
// 		else {
// 			this.gfn_message("fail.정보검색.실패", "진행된 결재 정보를");
// 		}
	}
}


/*
 * 함수명  	: grd_Acqs_Table_oncellclick
 * 설명 		: 전자결재 진행현황 팝업
 * params  		: None
 * return Type 	: None
 * 사용법		: this.grd_Acqs_Table_oncellclick();
 */
this.popupSactionStts = function(sanctnNo, REGIST_DT){
    var parm = {
		arg_0 : this,  
		arg_1 : sanctnNo,
		arg_2 : REGIST_DT	//공통요청 2016.08.30
	};
	
	/**
	* 팝업 공통함수
	* @param {string} svcId
	* @param {number} Width
	* @param {number} Height
	* @param {string} Title
	* @param {string} form URL
	* @param {string} Callback Function
	* @return N/A
	* @example
	* @memberOf comLib
	*/
	this.gfn_popup("COM010400_P01", 710, 580, "전자결재진행 현황", parm, "com::COM010400_P01.xfdl", "fn_callback5");
}

this.div_work_tab_pbncd_tpg3_btn_planLoad_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.ds_pbncdInfo.getColumn(0, "EXPRTN_AT") == "1") {
		this.gfn_message("fail.수정.불가", "만기처리된 공사채는");
		return false;
	} 
	
	if(this.gfn_message("comm.행위여부", "이자지급계획 자료가져오기(전체)를")){
		this.fn_transaction("intrRpayPlanLoad");
	}
}

this.div_work_tab_pbncd_tpg4_btn_planLoad_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.ds_pbncdInfo.getColumn(0, "EXPRTN_AT") == "1") {
		this.gfn_message("fail.수정.불가", "만기처리된 공사채는");
		return false;
	}
	
	if(this.gfn_message("comm.행위여부", "원금상환계획 자료가져오기(전체)를")){
		this.fn_transaction("prncpalRpayPlanLoad");
	}
}

this.btn_EXCEL_IMP_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{	
	if(this.ds_pbncdInfo.getColumn(0, "EXPRTN_AT") == "1") {
		this.gfn_message("fail.수정.불가", "만기처리된 공사채는");
		return false;
	}
	
	this.ds_import.clearData();
	var arg = {
		targetDs : this.ds_import,
		headSet : false,
		callBack : function () {
			if(this.ds_import.rowcount > 1){
				var nRow;
				
				switch(obj.name){
					case "btn_excelImpot01" :
						for(i=1; i< this.ds_import.rowcount; i++) {
							nRow = this.ds_intrRpayPlan.addRow();
							this.ds_intrRpayPlan.setColumn(nRow, "PBNCD_NO",      this.ds_pbncdInfo.getColumn(0, "PBNCD_NO"));
							this.ds_intrRpayPlan.setColumn(nRow, "RPAY_DE",        this.ds_import.getColumn(i, "Column0"));
							this.ds_intrRpayPlan.setColumn(nRow, "RPAY_INTRT",   this.ds_import.getColumn(i, "Column1"));
							this.ds_intrRpayPlan.setColumn(nRow, "RPAY_AMOUNT", this.ds_import.getColumn(i, "Column2"));
							this.ds_intrRpayPlan.setColumn(nRow, "SUMRY",      this.ds_import.getColumn(i, "Column3"));
						}
						break;
					case "btn_excelImpot02" :
						for(i=1; i< this.ds_import.rowcount; i++) {
							nRow = this.ds_prncpalRpayPlan.addRow();
							this.ds_prncpalRpayPlan.setColumn(nRow, "PBNCD_NO",      this.ds_pbncdInfo.getColumn(0, "PBNCD_NO"));
							this.ds_prncpalRpayPlan.setColumn(nRow, "RPAY_DE",          this.ds_import.getColumn(i, "Column0"));
							this.ds_prncpalRpayPlan.setColumn(nRow, "RPAY_INTRT",        this.ds_import.getColumn(i, "Column1"));
							this.ds_prncpalRpayPlan.setColumn(nRow, "RPAY_AMOUNT", this.ds_import.getColumn(i, "Column2"));
							this.ds_prncpalRpayPlan.setColumn(nRow, "SUMRY",     this.ds_import.getColumn(i, "Column3"));
						}
						break;
				}				
			}
		}
	};
	
	this.gfn_importExcel(arg);
}


this.div_work_tab_pbncd_tpg3_btn_planLoad2_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.ds_pbncdInfo.getColumn(0, "EXPRTN_AT") == "1") {
		this.gfn_message("fail.수정.불가", "만기처리된 공사채는");
		return false;
	} 
	
	if(this.gfn_message("comm.행위여부", "이자지급계획 자료가져오기(선택)를")){
		this.ds_intrRpayPlan.filter("CHK2 == '1'");
		
		if(this.ds_intrRpayPlan.rowcount > 0){
			for (var i = 0; i < this.ds_intrRpayPlan.rowcount; i++) {
				console.log(i);
				
				var fRow = this.ds_intrRpayDtls.findRow("RPAY_DE", this.ds_intrRpayPlan.getColumn(i, "RPAY_DE"));
				
				if (fRow > -1) {
					this.ds_intrRpayDtls.setColumn(fRow, "PBNCD_NO",      	this.ds_intrRpayPlan.getColumn(i, "PBNCD_NO"));
					this.ds_intrRpayDtls.setColumn(fRow, "RPAY_DE",       	this.ds_intrRpayPlan.getColumn(i, "RPAY_DE"));
					this.ds_intrRpayDtls.setColumn(fRow, "RPAY_INTRT",   	this.ds_intrRpayPlan.getColumn(i, "RPAY_INTRT"));
					this.ds_intrRpayDtls.setColumn(fRow, "RPAY_AMOUNT", 	this.ds_intrRpayPlan.getColumn(i, "RPAY_AMOUNT"));
					this.ds_intrRpayDtls.setColumn(fRow, "SUMRY",      		this.ds_intrRpayPlan.getColumn(i, "SUMRY"));
				} else {
					var nRow = this.ds_intrRpayDtls.addRow();
					
					this.ds_intrRpayDtls.setColumn(nRow, "PBNCD_NO",      	this.ds_intrRpayPlan.getColumn(i, "PBNCD_NO"));
					this.ds_intrRpayDtls.setColumn(nRow, "RPAY_DE",       	this.ds_intrRpayPlan.getColumn(i, "RPAY_DE"));
					this.ds_intrRpayDtls.setColumn(nRow, "RPAY_INTRT",   	this.ds_intrRpayPlan.getColumn(i, "RPAY_INTRT"));
					this.ds_intrRpayDtls.setColumn(nRow, "RPAY_AMOUNT", 	this.ds_intrRpayPlan.getColumn(i, "RPAY_AMOUNT"));
					this.ds_intrRpayDtls.setColumn(nRow, "SUMRY",      		this.ds_intrRpayPlan.getColumn(i, "SUMRY"));
				}
			}
			
			this.ds_intrRpayPlan.filter("");
			
			this.fn_transaction("intrRpayDtlsSave");
		} else {
			this.ds_intrRpayPlan.filter("");
			this.gfn_message("info.처리불가", "선택된 이자지급계획이 없습니다.");
		}
	}
}

this.div_work_tab_pbncd_tpg4_btn_planLoad2_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.ds_pbncdInfo.getColumn(0, "EXPRTN_AT") == "1") {
		this.gfn_message("fail.수정.불가", "만기처리된 공사채는");
		return false;
	}
	
	if(this.gfn_message("comm.행위여부", "원금상환계획 자료가져오기(선택)를")){
		this.ds_prncpalRpayPlan.filter("CHK2 == '1'");
		
		if(this.ds_prncpalRpayPlan.rowcount > 0){
			for (var i = 0; i < this.ds_prncpalRpayPlan.rowcount; i++) {
				console.log(i);
				
				var fRow = this.ds_prncpalRpayDtls.findRow("RPAY_DE", this.ds_prncpalRpayPlan.getColumn(i, "RPAY_DE"));
				
				if (fRow > -1) {
					this.ds_prncpalRpayDtls.setColumn(fRow, "PBNCD_NO",      	this.ds_prncpalRpayPlan.getColumn(i, "PBNCD_NO"));
					this.ds_prncpalRpayDtls.setColumn(fRow, "RPAY_DE",       	this.ds_prncpalRpayPlan.getColumn(i, "RPAY_DE"));
					this.ds_prncpalRpayDtls.setColumn(fRow, "RPAY_INTRT",   	this.ds_prncpalRpayPlan.getColumn(i, "RPAY_INTRT"));
					this.ds_prncpalRpayDtls.setColumn(fRow, "RPAY_AMOUNT", 	this.ds_prncpalRpayPlan.getColumn(i, "RPAY_AMOUNT"));
					this.ds_prncpalRpayDtls.setColumn(fRow, "SUMRY",      		this.ds_prncpalRpayPlan.getColumn(i, "SUMRY"));
				} else {
					var nRow = this.ds_prncpalRpayDtls.addRow();
					
					this.ds_prncpalRpayDtls.setColumn(nRow, "PBNCD_NO",      	this.ds_prncpalRpayPlan.getColumn(i, "PBNCD_NO"));
					this.ds_prncpalRpayDtls.setColumn(nRow, "RPAY_DE",       	this.ds_prncpalRpayPlan.getColumn(i, "RPAY_DE"));
					this.ds_prncpalRpayDtls.setColumn(nRow, "RPAY_INTRT",   	this.ds_prncpalRpayPlan.getColumn(i, "RPAY_INTRT"));
					this.ds_prncpalRpayDtls.setColumn(nRow, "RPAY_AMOUNT", 	this.ds_prncpalRpayPlan.getColumn(i, "RPAY_AMOUNT"));
					this.ds_prncpalRpayDtls.setColumn(nRow, "SUMRY",      		this.ds_prncpalRpayPlan.getColumn(i, "SUMRY"));
				}
			}
			
			this.ds_prncpalRpayPlan.filter("");
			
			this.fn_transaction("prncpalRpayDtlsSave");
		} else {
			this.ds_prncpalRpayPlan.filter("");
			this.gfn_message("info.처리불가", "선택된 원금상환계획이 없습니다.");
		}
	}	
}



this.fn_createOrView_EXPNDTR_DECSN = function(wrkDs, _selrow, _RPAY_AMOUNT, _sumry, _trgFormId)
{

	if(wrkDs.getColumn(_selrow, "CNFIRM_AT") != '1'){
		this.gfn_message("info.처리불가", "확정처리건에 대해서 결의서 작성이 가능합니다.");
		return;
	}
	
	// 결의서 번호 여부 체크
	if(null != wrkDs.getColumn(_selrow, "EXPNDTR_DECSN_NO")){
		// 결의서 팝업 호출
		var args = {
			  arg_0     : this
			, trgFormId	: _trgFormId	// 팝업을 호출하는 화면의 ID
			, trgFormId2: "MIS"			// 삭제방지코드
			, anactKnd	: "03"
			, decsnYear	: wrkDs.getColumn(_selrow, "EXPNDTR_DECSN_YEAR")
			, decsnNo	: wrkDs.getColumn(_selrow, "EXPNDTR_DECSN_NO")
		};
		
		this.gfn_popup("expPopup", 903, 842, "지출결의서", args, "mis_acc::ACC020203_P01.xfdl", "fn_popupCallBack", true);
	}
	else {	
		var day 	= this.comUtils.isNull(wrkDs.getColumn(_selrow, "PYMNT_DE")) ? wrkDs.getColumn(_selrow, "RPAY_DE") : wrkDs.getColumn(_selrow, "PYMNT_DE");		// 결의일자
		var pymntDe = day;		// 지급예정일자
		var pymntYr = this.comUtils.isNull(wrkDs.getColumn(_selrow, "BUDGET_YEAR")) ? wrkDs.getColumn(_selrow, "RPAY_DE").substr(0,4) : wrkDs.getColumn(_selrow, "BUDGET_YEAR");	// 회계년
		var sumry	= _sumry;
		
		// 결의마스터 셋팅
		this.ds_expDsnMastr.clearData();
		this.ds_expDsnMastr.addRow();
		this.ds_expDsnMastr.setColumn(0, "DECSN_YEAR"		, pymntYr);								// 회계년월
		this.ds_expDsnMastr.setColumn(0, "ANACT_KND"		, "03");								// 결의서구분
		this.ds_expDsnMastr.setColumn(0, "DEPT_CODE"		, this.gfn_getDeptId());				// 부서코드
		this.ds_expDsnMastr.setColumn(0, "DEPT_NM"			, this.gfn_getDeptName());				// 부서명
		
// 		this.ds_expDsnMastr.setColumn(0, "BUDGET_YEAR"		, wrkDs.getColumn(_selrow, "BUDGET_YEAR"));			// 예산년도
// 		this.ds_expDsnMastr.setColumn(0, "BSNS_SE"			, wrkDs.getColumn(_selrow, "BSNS_SE"));				// 사업구분
// 		this.ds_expDsnMastr.setColumn(0, "BALC_SE"			, wrkDs.getColumn(_selrow, "BALC_SE"));				// 수지구분(2:지출 고정)
// 		this.ds_expDsnMastr.setColumn(0, "BUDGET_ACNT_CODE"	, wrkDs.getColumn(_selrow, "BUDGET_ACNT_CODE"));	// 예산계정과목
// 		this.ds_expDsnMastr.setColumn(0, "BUDGET_ACNT_NM"	, wrkDs.getColumn(_selrow, "BUDGET_ACNT_NM"));		// 예산계정과목
// 		this.ds_expDsnMastr.setColumn(0, "EXPNDTR_UNIT_CODE", wrkDs.getColumn(_selrow, "EXPNDTR_UNIT_CODE"));	// 지출단위코드
// 		this.ds_expDsnMastr.setColumn(0, "EXPNDTR_UNIT_NM"	, wrkDs.getColumn(_selrow, "EXPNDTR_UNIT_NM"));		// 지출단위명
// 		this.ds_expDsnMastr.setColumn(0, "BUDGET_CNRL_AT"	, wrkDs.getColumn(_selrow, "BUDGET_CNRL_AT")); 		// 예산통제여부

		
		this.ds_expDsnMastr.setColumn(0, "SUMRY",                   sumry  	);			// 적요
		this.ds_expDsnMastr.setColumn(0, "ITNC_DE",                 day  	);			// 발의일자
		this.ds_expDsnMastr.setColumn(0, "DET_DCSN_DE",             day   	);			// 채무확정일자
		this.ds_expDsnMastr.setColumn(0, "PYMNT_ITNC_DE",           pymntDe	);			// 지급발의일자
		this.ds_expDsnMastr.setColumn(0, "PRMPC_JRNLZPR_RGIST_DE",  day 	);			// 원장분개장등기
		this.ds_expDsnMastr.setColumn(0, "EXPNDTR_BUDGET_CNRL_DE",  pymntDe	);			// 지출예산통제
		this.ds_expDsnMastr.setColumn(0, "CPTAL_EXPNDTR_ACNTBK_DE", pymntDe );			// 자금지출부등기

		this.ds_expDsnMastr.setColumn(0, "CAUSE_ACTION_DE", 		day  );				// 원인행위일자 2016.09.04

		this.ds_expDsnMastr.setColumn(0, "DECSN_AMOUNT"		, _RPAY_AMOUNT);			// 확정금액 -> 결의금액		
		this.ds_expDsnMastr.setColumn(0, "FNNC_INSTT_CODE"	, wrkDs.getColumn(_selrow, "FNNC_INSTT_CODE"));	// 지출은행
		this.ds_expDsnMastr.setColumn(0, "ACNUTNO"			, wrkDs.getColumn(_selrow, "ACNUTNO"));			// 계좌번호
		
		// 결의마스터상세
		this.ds_expDsnMtrDet.clearData();
		this.ds_expDsnMtrDet.addRow();
		this.ds_expDsnMtrDet.setColumn(0, "TAXXPT_AMOUNT"	, "0");									// 면세금액
		this.ds_expDsnMtrDet.setColumn(0, "VAT_DECSN_AMOUNT", "0");									// 부가세결의금액
		this.ds_expDsnMtrDet.setColumn(0, "SUPLY_AMOUNT"	, "0");									// 공급가액
		this.ds_expDsnMtrDet.setColumn(0, "VAT_AMOUNT"		, "0");									// 부가세금액
		
		// 결의세부
		this.ds_expDsnDetail.clearData();
		this.ds_expDsnDetail.addRow();
		this.ds_expDsnDetail.setColumn(0, "DECSN_AMOUNT"	, _RPAY_AMOUNT);							// 결의금액
		this.ds_expDsnDetail.setColumn(0, "TAXXPT_AMOUNT"	, "0");										// 면세금액
		this.ds_expDsnDetail.setColumn(0, "VAT_AT"			, "0");										// 부가세여부
		this.ds_expDsnDetail.setColumn(0, "VAT_DECSN_AMOUNT", "0");										// 부가세결의금액
		this.ds_expDsnDetail.setColumn(0, "SUPLY_AMOUNT"	, "0");										// 공급가액
		this.ds_expDsnDetail.setColumn(0, "VAT"				, "0");										// 부가세
		this.ds_expDsnDetail.setColumn(0, "RCPT_DE"			, pymntDe);									// 영수일자
		this.ds_expDsnDetail.setColumn(0 ,"PBNCD_NO"        , wrkDs.getColumn(_selrow, "PBNCD_NO"));	// 공사채번호
		
		/*
		this.ds_expDsnDetail.setColumn(0, "FNNC_INSTT_CODE"	, wrkDs.getColumn(_selrow, "FNNC_INSTT_CODE"));
		this.ds_expDsnDetail.setColumn(0, "ACNUTNO"			, wrkDs.getColumn(_selrow, "ACNUTNO"));
		this.ds_expDsnDetail.setColumn(0, "IHDNUM"			, wrkDs.getColumn(_selrow, "IHDNUM"));
		*/
		
		// 결의서 등록 후 결의번호를 입력해야하는 데이터셋 정보
		this.ds_decsnNo.clearData();
		this.ds_decsnNo.addRow();
		this.ds_decsnNo.setColumn(0, "PBNCD_NO", 		wrkDs.getColumn(_selrow, "PBNCD_NO"));		
		this.ds_decsnNo.setColumn(0, "RPAY_DE", 		wrkDs.getColumn(_selrow, "RPAY_DE2"));
		
		// 지출결의 팝업 호출
		var decsnYear 		= wrkDs.getColumn(_selrow, "EXPNDTR_DECSN_YEAR");
		var decsnNo			= wrkDs.getColumn(_selrow, "EXPNDTR_DECSN_NO");
		var param = {
			 arg_0      			: this
			,trgFormId				: _trgFormId					// 팝업을 호출하는 화면의 ID
			,trgFormId2				: "MIS"								// 삭제방지코드
			,anactKnd				: "03"								// 결의서구분
			,decsnYear				: decsnYear							// 결의년도
			,decsnNo				: decsnNo							// 결의번호
			,dsExpDsnMastr			: this.ds_expDsnMastr.saveXML()		// 결의마스터(Dataset)
			,dsExpDsnMtrDet 		: this.ds_expDsnMtrDet.saveXML()	// 결의마스터상세(Dataset)
			,dsExpDsnDetail 		: this.ds_expDsnDetail.saveXML()	// 결의세부(Dataset)
			,dsDecsnNo				: this.ds_decsnNo.saveXML()			// 키값정보(Dataset)
		};
		
		this.gfn_popup("expDsnPopup", 903, 842, "지출결의서", param, "mis_acc::ACC020203_P01.xfdl", "fn_PopUpCallback3",true);
	}
}

/*
 * 함수명  	: btn_excelFormDown
 * 설명 		: 엑셀 업로드 양식 다운로드 팝업 버튼 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_excelFormDown();
 */
this.btn_excelFormDown = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var Url = this.div_work.tab_pbncd.tpg1.grd_uploadFormat;
	
	this.gfn_exportExcel(Url, "EXCEL_UPLOAD_FORM");
}

/*
 * 함수명  	: fn_get_imgUrl
 * 설명 		: 전자결재종류 이미지 경로 리턴 함수
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_get_imgUrl();
 */
this.fn_get_imgUrl = function(sanctnSts)
{
	return this.gfn_getSanctnImgUrl(sanctnSts);
}

/*
 * 함수명  	: div_work_tab_pbncd_onchanged
 * 설명 		: 텝 페이지 변경 후 이벤트 처리 함수
 * params  		: None
 * return Type 	: None
 * 사용법		: this.div_work_tab_pbncd_onchanged();
 */
this.div_work_tab_pbncd_onchanged = function(obj:Tab, e:nexacro.TabIndexChangeEventInfo)
{
// 	if(obj.tabindex == 0 || obj.tabindex == 1){
// 		this.div_work.btn_sample.set_visible(true);
// 	} else {
// 		this.div_work.btn_sample.set_visible(false);
// 	}
}

/*
 * 함수명  	: ds_intrRpayPlan_oncolumnchanged
 * 설명 		: 이자지급계획 데이터셋 테이터 변경 후 이벤트 처리 함수
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_intrRpayPlan_oncolumnchanged();
 */
this.ds_intrRpayPlan_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	// 확정여부 값 변경에 따른 업데이트 가능 여부 업데이트
	if(e.columnid == "CNFIRM_AT"){
		if(e.newvalue == "1"){
			obj.setColumn(e.row, "UPDATE_POSBL_AT", "0");
		} else {
			obj.setColumn(e.row, "UPDATE_POSBL_AT", "1");
		}
	}
}

/*
 * 함수명  	: ds_prncpalRpayPlan_oncolumnchanged
 * 설명 		: 원금상환계획 데이터셋 테이터 변경 후 이벤트 처리 함수
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_prncpalRpayPlan_oncolumnchanged();
 */
this.ds_prncpalRpayPlan_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	// 확정여부 값 변경에 따른 업데이트 가능 여부 업데이트
	if(e.columnid == "CNFIRM_AT"){
		if(e.newvalue == "1"){
			obj.setColumn(e.row, "UPDATE_POSBL_AT", "0");
		} else {
			obj.setColumn(e.row, "UPDATE_POSBL_AT", "1");
		}
	}
}
]]></Script>
  </Form>
</FDL>
