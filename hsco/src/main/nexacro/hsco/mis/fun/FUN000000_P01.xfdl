<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\default_typedef.xml"/>
  <Form id="FUN000000_P01" classname="FUN000000_P01" left="0" top="0" width="950" height="700" titletext="주간자금배정 팝업" onload="FUN000000_P01_onload" oninit="FUN000000_P01_oninit">
    <Layouts>
      <Layout>
        <Static id="Static01" taborder="5" cssclass="sta_WF_PopupTitle" left="0" top="0" height="34" right="0" text="주간자금배정 팝업"/>
        <Button id="btn_exit" taborder="6" cssclass="btn_WF_PopupClose" top="8" width="20" height="20" onclick="btn_Close_onclick" right="11"/>
        <Static id="Static06" taborder="7" text="15" visible="false" left="0" top="34" height="15" style="background:#dc143c3c;align:center middle;" right="0"/>
        <Static id="Static12" taborder="14" text="5" visible="false" left="0" top="74" width="900" height="5" style="background:#dc143c3c;align:center middle;"/>
        <Static id="sta_title00" taborder="15" text="주간자금배정" cssclass="sta_WF_Title01" left="15" top="51" width="197" height="21"/>
        <Button id="btn_Search" taborder="16" text="조회" cssclass="btn_WF_CRUD" top="49" right="121" width="50" height="25" onclick="fn_search"/>
        <Button id="btn_Confirm" taborder="17" text="저장" cssclass="btn_WF_CRUD" top="49" right="68" width="50" height="25" onclick="fn_save"/>
        <Button id="btn_Close" taborder="18" text="닫기" cssclass="btn_WF_CRUD" top="49" right="15" width="50" height="25" onclick="btn_Close_onclick"/>
        <Static id="Static05" taborder="19" text="15" visible="false" left="0" top="0" width="15" height="450" style="background:#1b3cd23c;align:center middle;"/>
        <Static id="Static02" taborder="20" text="15" visible="false" top="0" height="450" style="background:#1b3cd23c;align:center middle;" right="0" width="15"/>
        <Div id="div_search" taborder="21" left="15" top="79" right="15" height="33" style="padding:0 0 0 0;" cssclass="div_WFSA_Box">
          <Layouts>
            <Layout>
              <Static id="Static00" taborder="51" text="15" visible="false" left="0" top="2" width="15" height="34" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="Static01" taborder="52" text="9" visible="false" left="9" top="0" width="1000" height="5" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="sta_year" taborder="53" text="연도" cssclass="sta_WFSA_Label" left="15" top="5" width="38" height="21"/>
              <Static id="Static03" taborder="54" text="5" visible="false" left="47" top="2" width="5" height="34" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="Static09" taborder="55" text="9" visible="false" left="9" top="32" width="1000" height="9" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Combo id="cmb_week" taborder="56" autoselect="true" innerdataset="ds_week" codecolumn="CODE" datacolumn="CODE_NM" left="273" top="5" width="60" height="21" style="align:center middle;"/>
              <Static id="sta_week" taborder="57" text="주차" cssclass="sta_WFSA_Label" left="235" top="5" width="38" height="21"/>
              <Static id="Static02" taborder="58" text="5" visible="false" left="268" top="2" width="5" height="34" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="sta_budgetAcntSe" taborder="59" text="계정구분" cssclass="sta_WFSA_Label" left="348" top="5" width="64" height="21"/>
              <Combo id="cmb_month" taborder="60" innerdataset="ds_month" codecolumn="CODE" datacolumn="CODE_NM" left="170" top="5" width="50" height="21" style="align:center middle;"/>
              <Static id="sta_month" taborder="61" text="월" cssclass="sta_WFSA_Label" left="147" top="5" width="22" height="21"/>
              <Static id="Static04" taborder="62" text="5" visible="false" left="165" top="2" width="5" height="34" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Combo id="cmb_budgetAcntSe" taborder="63" innerdataset="ds_acntSe" codecolumn="CODE" datacolumn="CODE_NM" left="412" top="5" width="100" height="21"/>
              <Static id="Static05" taborder="64" text="5" visible="false" left="407" top="2" width="5" height="34" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="Static06" taborder="65" text="15" visible="false" left="132" top="2" width="15" height="34" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="Static07" taborder="66" text="15" visible="false" left="220" top="2" width="15" height="34" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="Static08" taborder="67" text="15" visible="false" left="333" top="2" width="15" height="34" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="sta_budgetAcntSe00" taborder="68" text="부서" cssclass="sta_WFSA_Label" left="527" top="5" width="38" height="21"/>
              <Static id="Static10" taborder="70" text="15" visible="false" left="512" top="2" width="15" height="34" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="Static11" taborder="71" text="5" visible="false" left="560" top="2" width="5" height="34" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Spin id="spn_year" taborder="72" value="0" max="9999" min="1000" onspin="div_search_spn_year_onspin" left="52" top="5" width="80" height="21"/>
              <Edit id="edt_deptCode" taborder="73" left="565" top="5" width="64" height="21" enable="false"/>
              <Edit id="edt_deptNm" taborder="74" left="631" top="5" width="102" height="21" enable="false"/>
            </Layout>
          </Layouts>
          <InitValue/>
        </Div>
        <Div id="div_work" taborder="22" left="15" top="112" right="15" height="240">
          <Layouts>
            <Layout>
              <Grid id="grd_mnthngCptalList" taborder="4" binddataset="ds_mnthngCptalList" autoenter="select" autoupdatetype="itemselect" useinputpanel="false" cellsizingtype="col" autofittype="none" autosizingtype="row" onexpandup="fn_onexpandup" left="0" top="27" right="0" bottom="0">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="50"/>
                      <Column size="50"/>
                      <Column size="100"/>
                      <Column size="60"/>
                      <Column size="35"/>
                      <Column size="100"/>
                      <Column size="75"/>
                      <Column size="150"/>
                      <Column size="75"/>
                      <Column size="150"/>
                      <Column size="110"/>
                      <Column size="110"/>
                      <Column size="110"/>
                      <Column size="110"/>
                      <Column size="110"/>
                    </Columns>
                    <Rows>
                      <Row size="24" band="head"/>
                      <Row size="24" band="head"/>
                      <Row size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell rowspan="2" text="승인&#13;&#10;여부"/>
                      <Cell col="1" rowspan="2" text="지출&#13;&#10;가능"/>
                      <Cell col="2" rowspan="2" text="부서"/>
                      <Cell col="3" colspan="7" text="예산과목"/>
                      <Cell col="10" colspan="3" text="예산 및 집행"/>
                      <Cell col="13"/>
                      <Cell col="14"/>
                      <Cell row="1" col="3" text="예산년도"/>
                      <Cell row="1" col="4" colspan="2" text="계정구분"/>
                      <Cell row="1" col="6" colspan="2" text="예산계정"/>
                      <Cell row="1" col="8" colspan="2" text="지출단위"/>
                      <Cell row="1" col="10" text="예산금액"/>
                      <Cell row="1" col="11" text="집행금액"/>
                      <Cell row="1" col="12" text="잔액"/>
                      <Cell row="1" col="13" text="계획금액"/>
                      <Cell row="1" col="14" text="승인금액"/>
                    </Band>
                    <Band id="body">
                      <Cell displaytype="checkbox" text="bind:CONFM_AT" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="1" displaytype="checkbox" text="bind:EXPNDTR_POSBL_AT" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="2" style="align:left;padding:0 0 0 10;" text="bind:DEPT_NM" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="3" editfilter="number" style="align:center middle;" text="bind:BUDGET_YEAR" mask="####" editlimit="4" editlimitbymask="integer" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="4" text="bind:BUDGET_ACNT_SE"/>
                      <Cell col="5" displaytype="combo" style="align:left;" text="bind:BUDGET_ACNT_SE" combodataset="ds_acntSe_01" combocodecol="CODE" combodatacol="CODE_NM" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="6" text="bind:BUDGET_ACNT_CODE"/>
                      <Cell col="7" style="align:left;" text="bind:BUDGET_ACNT_CODE_NM" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="8" text="bind:EXPNDTR_UNIT_CODE"/>
                      <Cell col="9" style="align:left;" text="bind:EXPNDTR_UNIT_NM" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="10" displaytype="number" style="align:right;" text="bind:BUDGET_AMOUNT" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="11" displaytype="number" style="align:right;" text="bind:EXPNDTR_AMOUNT" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="12" displaytype="number" style="align:right;" expr="expr:BUDGET_AMOUNT-EXPNDTR_AMOUNT" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="13" displaytype="number" editfilter="number" style="align:right;" text="bind:PLAN_AMOUNT" mask="###,###" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="14" displaytype="number" style="align:right;" text="bind:DCSN_AMOUNT" autosizerow="limitmin" autosizecol="limitmin"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Static id="Static09" taborder="6" text="10" visible="false" left="9" top="0" width="1000" height="10" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="Static00" taborder="7" text="5" visible="false" left="17" top="22" width="1000" height="5" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="sta_title00" taborder="8" text="월간계획" cssclass="sta_WF_Title02" left="0" top="3" height="26" width="100"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="div_dtl00" taborder="23" left="15" right="15" bottom="0" top="352">
          <Layouts>
            <Layout>
              <Tab id="tab_wikCptalList" taborder="7" left="0" top="34" right="0" bottom="0" tabindex="0" scrollbars="autoboth" style="showextrabutton:false;">
                <Tabpages>
                  <Tabpage id="tpg1" text="주간계획">
                    <Layouts>
                      <Layout>
                        <Grid id="grd_wikCptalList" taborder="2" binddataset="ds_wikCptalList" autoenter="select" autoupdatetype="itemselect" useinputpanel="false" cellsizingtype="col" autosizingtype="row" onexpandup="fn_onexpandup" left="1" top="5" right="1" bottom="1">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="40"/>
                                <Column size="100"/>
                                <Column size="60"/>
                                <Column size="35"/>
                                <Column size="100"/>
                                <Column size="75"/>
                                <Column size="130"/>
                                <Column size="75"/>
                                <Column size="150"/>
                                <Column size="110"/>
                                <Column size="110"/>
                                <Column size="110"/>
                                <Column size="40"/>
                                <Column size="110"/>
                                <Column size="120"/>
                                <Column size="100"/>
                                <Column size="150"/>
                                <Column size="150"/>
                                <Column size="110"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                              </Rows>
                              <Band id="head">
                                <Cell rowspan="2" text="승인&#13;&#10;여부"/>
                                <Cell col="1" rowspan="2" text="부서"/>
                                <Cell col="2" colspan="7" text="예산과목"/>
                                <Cell col="9" colspan="3" text="월승인 및 집행내역"/>
                                <Cell col="12" colspan="6" text="주계획"/>
                                <Cell col="18" rowspan="2" text="승인금액"/>
                                <Cell row="1" col="2" text="예산년도"/>
                                <Cell row="1" col="3" colspan="2" text="계정구분"/>
                                <Cell row="1" col="5" colspan="2" text="예산계정"/>
                                <Cell row="1" col="7" colspan="2" text="지출단위"/>
                                <Cell row="1" col="9" text="승인금액"/>
                                <Cell row="1" col="10" text="집행금액"/>
                                <Cell row="1" col="11" text="잔액"/>
                                <Cell row="1" col="12" text="순번"/>
                                <Cell row="1" col="13" text="계획금액"/>
                                <Cell row="1" col="14" text="결의서종류"/>
                                <Cell row="1" col="15" text="원인행위"/>
                                <Cell row="1" col="16" text="원가항목"/>
                                <Cell row="1" col="17" text="적요"/>
                              </Band>
                              <Band id="body">
                                <Cell displaytype="checkbox" text="bind:CONFM_AT" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="1" style="align:left;padding:0 0 0 10;" text="bind:DEPT_NM" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="2" text="bind:BUDGET_YEAR" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="3" text="bind:BUDGET_ACNT_SE" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="4" displaytype="combo" style="align:left;" text="bind:BUDGET_ACNT_SE" combodataset="ds_acntSe_01" combocodecol="CODE" combodatacol="CODE_NM" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="5" text="bind:BUDGET_ACNT_CODE" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="6" style="align:left;" text="bind:BUDGET_ACNT_CODE_NM" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="7" text="bind:EXPNDTR_UNIT_CODE" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="8" style="align:left;" text="bind:EXPNDTR_UNIT_NM" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="9" displaytype="number" style="align:right;" text="bind:MONTH_DCSN_AMOUNT" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="10" displaytype="number" style="align:right;" text="bind:MONTH_EXPNDTR_AMOUNT" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="11" displaytype="number" style="align:right;" expr="expr:MONTH_DCSN_AMOUNT-MONTH_EXPNDTR_AMOUNT" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="12" text="bind:SN" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="13" displaytype="number" edittype="expr:dataset.getColumn(currow,&quot;CONFM_AT&quot;) == &quot;1&quot; ? &quot;none&quot; : comp.parent.parent.parent.parent.ds_cond00.getColumn(0, &quot;WIK_CPTAL_PLAN_KEY&quot;) == WIK_CPTAL_PLAN_KEY ? &quot;masknumber&quot; : WIK_CPTAL_PLAN_KEY == null ? &quot;masknumber&quot; : &quot;none&quot;" editfilter="number" style="align:right;" text="bind:PLAN_AMOUNT" mask="!###,###,###,###,###" editdisplay="expr:dataset.getColumn(currow,&quot;CONFM_AT&quot;) == &quot;1&quot; ? &quot;edit&quot; : comp.parent.parent.parent.parent.ds_cond00.getColumn(0, &quot;WIK_CPTAL_PLAN_KEY&quot;) == WIK_CPTAL_PLAN_KEY ? &quot;display&quot; : WIK_CPTAL_PLAN_KEY == null ? &quot;display&quot; : &quot;edit&quot;" editlimitbymask="integer" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="14" displaytype="combo" edittype="expr:dataset.getColumn(currow,&quot;CONFM_AT&quot;) == &quot;1&quot; ? &quot;none&quot; : comp.parent.parent.parent.parent.ds_cond00.getColumn(0, &quot;WIK_CPTAL_PLAN_KEY&quot;) == WIK_CPTAL_PLAN_KEY ? &quot;combo&quot; : WIK_CPTAL_PLAN_KEY == null ? &quot;combo&quot; : &quot;none&quot;" style="align:left;" text="bind:ANACT_KND" combodataset="ds_anactKnd" combocodecol="CODE" combodatacol="CODE_NM" combodisplay="expr:dataset.getColumn(currow,&quot;CONFM_AT&quot;) == &quot;1&quot; ? &quot;edit&quot; : comp.parent.parent.parent.parent.ds_cond00.getColumn(0, &quot;WIK_CPTAL_PLAN_KEY&quot;) == WIK_CPTAL_PLAN_KEY ? &quot;display&quot; : WIK_CPTAL_PLAN_KEY == null ? &quot;display&quot; : &quot;edit&quot;" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="15" style="align: ;" text="bind:CAUSE_ACTION_NO" expandshow="expr:dataset.getColumn(currow,&quot;CONFM_AT&quot;) == &quot;1&quot; ? &quot;hide&quot; : comp.parent.parent.parent.parent.ds_cond00.getColumn(0, &quot;WIK_CPTAL_PLAN_KEY&quot;) == WIK_CPTAL_PLAN_KEY ? &quot;show&quot; : WIK_CPTAL_PLAN_KEY == null ? &quot;show&quot; : &quot;hide&quot;" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="16" style="align:left;padding:0 0 0 5;" text="bind:ACCNUT_ACNT_NM" expandshow="expr:dataset.getColumn(currow,&quot;CONFM_AT&quot;) == &quot;1&quot; ? &quot;hide&quot; : comp.parent.parent.parent.parent.ds_cond00.getColumn(0, &quot;WIK_CPTAL_PLAN_KEY&quot;) == WIK_CPTAL_PLAN_KEY ? &quot;show&quot; : WIK_CPTAL_PLAN_KEY == null ? &quot;show&quot; : &quot;hide&quot;"/>
                                <Cell col="17" edittype="expr:dataset.getColumn(currow,&quot;CONFM_AT&quot;) == &quot;1&quot; ? &quot;none&quot; : comp.parent.parent.parent.parent.ds_cond00.getColumn(0, &quot;WIK_CPTAL_PLAN_KEY&quot;) == WIK_CPTAL_PLAN_KEY ? &quot;normal&quot; : WIK_CPTAL_PLAN_KEY == null ? &quot;normal&quot; : &quot;none&quot;" editfilter="none" style="align:left;" text="bind:RM" editdisplay="expr:dataset.getColumn(currow,&quot;CONFM_AT&quot;) == &quot;1&quot; ? &quot;edit&quot; : comp.parent.parent.parent.parent.ds_cond00.getColumn(0, &quot;WIK_CPTAL_PLAN_KEY&quot;) == WIK_CPTAL_PLAN_KEY ? &quot;display&quot; : WIK_CPTAL_PLAN_KEY == null ? &quot;display&quot; : &quot;edit&quot;" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="18" displaytype="number" style="align:right;" text="bind:DCSN_AMOUNT" autosizerow="limitmin" autosizecol="limitmin"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                        <Static id="Static00" taborder="3" text="5" visible="false" left="0" top="0" right="1" height="5" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="tpg2" text="계획 외 지출">
                    <Layouts>
                      <Layout>
                        <Grid id="grd_etcCptalList" taborder="0" binddataset="ds_etcCptalList" autoenter="select" autoupdatetype="itemselect" useinputpanel="false" cellsizingtype="col" autosizingtype="row" onexpandup="fn_onexpandup" left="1" top="5" right="1" bottom="1">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="40"/>
                                <Column size="100"/>
                                <Column size="60"/>
                                <Column size="35"/>
                                <Column size="120"/>
                                <Column size="75"/>
                                <Column size="150"/>
                                <Column size="75"/>
                                <Column size="150"/>
                                <Column size="110"/>
                                <Column size="110"/>
                                <Column size="110"/>
                                <Column size="60"/>
                                <Column size="110"/>
                                <Column size="120"/>
                                <Column size="100"/>
                                <Column size="150"/>
                                <Column size="150"/>
                                <Column size="110"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                              </Rows>
                              <Band id="head">
                                <Cell rowspan="2" text="승인&#13;&#10;여부"/>
                                <Cell col="1" rowspan="2" text="부서"/>
                                <Cell col="2" colspan="7" text="예산과목"/>
                                <Cell col="9" colspan="4" text="얘산 및 집행내역"/>
                                <Cell col="13" colspan="5" text="주계획"/>
                                <Cell col="18" rowspan="2" text="승인금액"/>
                                <Cell row="1" col="2" text="예산년도"/>
                                <Cell row="1" col="3" colspan="2" text="계정구분"/>
                                <Cell row="1" col="5" colspan="2" text="예산계정"/>
                                <Cell row="1" col="7" colspan="2" text="지출단위"/>
                                <Cell row="1" col="9" text="예산금액"/>
                                <Cell row="1" col="10" text="집행금액"/>
                                <Cell row="1" col="11" text="잔액"/>
                                <Cell row="1" col="12" text="지출가능"/>
                                <Cell row="1" col="13" text="계획금액"/>
                                <Cell row="1" col="14" text="결의서종류"/>
                                <Cell row="1" col="15" text="원인행위"/>
                                <Cell row="1" col="16" text="원가항목"/>
                                <Cell row="1" col="17" text="적요"/>
                              </Band>
                              <Band id="body">
                                <Cell displaytype="checkbox" text="bind:CONFM_AT" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="1" style="align:left;padding:0 0 0 10;" text="bind:DEPT_NM" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="2" edittype="expr:dataset.getRowType(currow) == 2 ? &quot;masknumber&quot; : &quot;none&quot;" editfilter="number" style="align:center;" text="bind:BUDGET_YEAR" mask="####" editlimit="4" editdisplay="expr:dataset.getRowType(currow) == 2 ? &quot;display&quot; : &quot;edit&quot;" editlimitbymask="integer" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="3" text="bind:BUDGET_ACNT_SE" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="4" displaytype="combo" edittype="expr:dataset.getRowType(currow) == 2 ? &quot;combo&quot; : &quot;none&quot;" style="align:left;" text="bind:BUDGET_ACNT_SE" combodataset="ds_acntSe_02" combocodecol="CODE" combodatacol="CODE_NM" combodisplay="expr:dataset.getRowType(currow) == 2 ? &quot;display&quot; : &quot;edit&quot;" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="5" text="bind:BUDGET_ACNT_CODE" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="6" style="align:left;" text="bind:BUDGET_ACNT_CODE_NM" expandshow="expr:dataset.getRowType(currow) == 2 ? &quot;show&quot; : &quot;hide&quot;" expandsize="13" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="7" text="bind:EXPNDTR_UNIT_CODE" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="8" style="align:left;" text="bind:EXPNDTR_UNIT_NM" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="9" displaytype="number" style="align:right;" text="bind:BUDGET_AMOUNT" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="10" displaytype="number" style="align:right;" text="bind:EXPNDTR_AMOUNT" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="11" displaytype="number" style="align:right;" text="bind:MONTH_BLCE" expr="expr:BUDGET_AMOUNT-EXPNDTR_AMOUNT" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="12" displaytype="checkbox" text="bind:EXPNDTR_POSBL_AT" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="13" displaytype="number" edittype="expr:dataset.getColumn(currow,&quot;CONFM_AT&quot;) == &quot;1&quot; ? &quot;none&quot; : comp.parent.parent.parent.parent.ds_cond00.getColumn(0, &quot;WIK_CPTAL_PLAN_KEY&quot;) == WIK_CPTAL_PLAN_KEY ? &quot;masknumber&quot; : WIK_CPTAL_PLAN_KEY == null ? &quot;masknumber&quot; : &quot;none&quot;" editfilter="number" style="align:right;" text="bind:PLAN_AMOUNT" mask="!###,###,###,###,###" editdisplay="expr:dataset.getColumn(currow,&quot;CONFM_AT&quot;) == &quot;1&quot; ? &quot;edit&quot; : comp.parent.parent.parent.parent.ds_cond00.getColumn(0, &quot;WIK_CPTAL_PLAN_KEY&quot;) == WIK_CPTAL_PLAN_KEY ? &quot;display&quot; : WIK_CPTAL_PLAN_KEY == null ? &quot;display&quot; : &quot;edit&quot;" editlimitbymask="integer" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="14" displaytype="combo" edittype="expr:dataset.getColumn(currow,&quot;CONFM_AT&quot;) == &quot;1&quot; ? &quot;none&quot; : comp.parent.parent.parent.parent.ds_cond00.getColumn(0, &quot;WIK_CPTAL_PLAN_KEY&quot;) == WIK_CPTAL_PLAN_KEY ? &quot;combo&quot; : WIK_CPTAL_PLAN_KEY == null ? &quot;combo&quot; : &quot;none&quot;" style="align:left;" text="bind:ANACT_KND" combodataset="ds_anactKnd" combocodecol="CODE" combodatacol="CODE_NM" combodisplay="expr:dataset.getColumn(currow,&quot;CONFM_AT&quot;) == &quot;1&quot; ? &quot;edit&quot; : comp.parent.parent.parent.parent.ds_cond00.getColumn(0, &quot;WIK_CPTAL_PLAN_KEY&quot;) == WIK_CPTAL_PLAN_KEY ? &quot;display&quot; : WIK_CPTAL_PLAN_KEY == null ? &quot;display&quot; : &quot;edit&quot;" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="15" style="align: ;" text="bind:CAUSE_ACTION_NO" expandshow="expr:dataset.getColumn(currow,&quot;CONFM_AT&quot;) == &quot;1&quot; ? &quot;hide&quot; : comp.parent.parent.parent.parent.ds_cond00.getColumn(0, &quot;WIK_CPTAL_PLAN_KEY&quot;) == WIK_CPTAL_PLAN_KEY ? &quot;show&quot; : WIK_CPTAL_PLAN_KEY == null ? &quot;show&quot; : &quot;hide&quot;" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="16" style="align:left;padding:0 0 0 5;" text="bind:ACCNUT_ACNT_NM" expandshow="expr:dataset.getColumn(currow,&quot;CONFM_AT&quot;) == &quot;1&quot; ? &quot;hide&quot; : comp.parent.parent.parent.parent.ds_cond00.getColumn(0, &quot;WIK_CPTAL_PLAN_KEY&quot;) == WIK_CPTAL_PLAN_KEY ? &quot;show&quot; : WIK_CPTAL_PLAN_KEY == null ? &quot;show&quot; : &quot;hide&quot;"/>
                                <Cell col="17" edittype="expr:dataset.getColumn(currow,&quot;CONFM_AT&quot;) == &quot;1&quot; ? &quot;none&quot; : comp.parent.parent.parent.parent.ds_cond00.getColumn(0, &quot;WIK_CPTAL_PLAN_KEY&quot;) == WIK_CPTAL_PLAN_KEY ? &quot;normal&quot; : WIK_CPTAL_PLAN_KEY == null ? &quot;normal&quot; : &quot;none&quot;" style="align:left;" text="bind:RM" editdisplay="expr:dataset.getColumn(currow,&quot;CONFM_AT&quot;) == &quot;1&quot; ? &quot;edit&quot; : comp.parent.parent.parent.parent.ds_cond00.getColumn(0, &quot;WIK_CPTAL_PLAN_KEY&quot;) == WIK_CPTAL_PLAN_KEY ? &quot;display&quot; : WIK_CPTAL_PLAN_KEY == null ? &quot;display&quot; : &quot;edit&quot;" autosizerow="limitmin" autosizecol="limitmin"/>
                                <Cell col="18" displaytype="number" style="align:right;" text="bind:DCSN_AMOUNT" autosizerow="limitmin" autosizecol="limitmin"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                </Tabpages>
              </Tab>
              <Button id="btn_Add_Row" taborder="8" text="행추가" onclick="div_Cont_btn_Add_Row_onclick" cssclass="btn_WF_Gridadd" top="10" right="134" width="64" height="19"/>
              <Button id="btn_Del_Row" taborder="9" text="행삭제" onclick="div_Cont_btn_Del_Row_onclick" cssclass="btn_WF_Griddel" top="10" right="67" width="64" height="19"/>
              <Button id="btn_Cancel_Row" taborder="10" text="행취소" onclick="div_Cont_btn_Cancel_Row_onclick" cssclass="btn_WF_Gridcnl" top="10" right="0" width="64" height="19"/>
              <Static id="Static03" taborder="11" text="10" visible="false" left="-1" top="0" width="1035" height="10" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="Static00" taborder="12" text="5" visible="false" left="0" top="29" width="1035" height="5" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="sta_title01" taborder="13" text="주간계획" cssclass="sta_WF_Title02" left="0" top="6" height="26" width="100"/>
            </Layout>
          </Layouts>
        </Div>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cond00" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_cond00_oncolumnchanged">
        <ColumnInfo>
          <Column id="STDR_YY" type="STRING" size="256"/>
          <Column id="STDR_MT" type="STRING" size="256"/>
          <Column id="PLAN_YM" type="STRING" size="256"/>
          <Column id="WEEK_ATMB" type="STRING" size="256"/>
          <Column id="ACNT_SE" type="STRING" size="256"/>
          <Column id="EMPNO" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="POPUP_YN" type="STRING" size="256"/>
          <Column id="WIK_CPTAL_PLAN_KEY" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_cond01" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="PLAN_YM" type="STRING" size="256"/>
          <Column id="WEEK_ATMB" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_SE" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_CODE" type="STRING" size="256"/>
          <Column id="BUDGET_TAXITM_CODE" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_CODE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_cond03" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="BUDGET_ACNT_SE" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_CODE" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_CODE" type="STRING" size="256"/>
          <Column id="BUDGET_YEAR" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="PLAN_YM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_etcCptalList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" cancolumnchange="ds_etcCptalList_cancolumnchange" oncolumnchanged="ds_etcCptalList_oncolumnchanged">
        <ColumnInfo>
          <Column id="PLAN_YM" type="STRING" size="256" sumtext="계획년월"/>
          <Column id="WEEK_ATMB" type="STRING" size="256" sumtext="주간"/>
          <Column id="SE" type="STRING" size="256" sumtext="주간구분"/>
          <Column id="DEPT_CODE" type="STRING" size="256" sumtext="부서코드"/>
          <Column id="DEPT_NM" type="STRING" size="256" sumtext="부서명"/>
          <Column id="BUDGET_ACNT_SE" type="STRING" size="256" sumtext="계정구분"/>
          <Column id="BUDGET_ACNT_CODE" type="STRING" size="256" sumtext="계정코드"/>
          <Column id="BUDGET_ACNT_CODE_NM" type="STRING" size="256" sumtext="계정명"/>
          <Column id="EXPNDTR_UNIT_CODE" type="STRING" size="256" sumtext="지출단위코드"/>
          <Column id="EXPNDTR_UNIT_NM" type="STRING" size="256" sumtext="지출단위코드"/>
          <Column id="PLAN_AMOUNT" type="BIGDECIMAL" size="256" sumtext="계획금액"/>
          <Column id="DCSN_AMOUNT" type="BIGDECIMAL" size="256" sumtext="승인금액"/>
          <Column id="BLCE" type="BIGDECIMAL" size="256" sumtext="월간잔액"/>
          <Column id="BUDGET_AMOUNT" type="STRING" size="256" sumtext="예산금액"/>
          <Column id="EXPNDTR_AMOUNT" type="BIGDECIMAL" size="256" sumtext="집행금액"/>
          <Column id="CONFM_AT" type="STRING" size="256" sumtext="승인여부"/>
          <Column id="EXPNDTR_POSBL" type="STRING" size="256" sumtext="지출가능여부"/>
          <Column id="EXPNDTR_CNFIRM" type="STRING" size="256" sumtext="지출확인"/>
          <Column id="BUDGET_YEAR" type="STRING" size="256" sumtext="예산년도"/>
          <Column id="ANACT_KND" type="STRING" size="256" sumtext="결의서종류"/>
          <Column id="CAUSE_ACTION_NO" type="STRING" size="256" sumtext="원인행위번호"/>
          <Column id="RM" type="STRING" size="256" sumtext="적요"/>
          <Column id="REGISTER_ID" type="STRING" size="256"/>
          <Column id="REGIST_DT" type="STRING" size="256"/>
          <Column id="UPDUSR_ID" type="STRING" size="256"/>
          <Column id="UPDT_DT" type="STRING" size="256"/>
          <Column id="SN" type="BIGDECIMAL" size="256" sumtext="일련번호"/>
          <Column id="PRMPC_YEAR" type="STRING" size="256" sumtext="원가년도"/>
          <Column id="PRMPC_CODE" type="STRING" size="256" sumtext="원가코드"/>
          <Column id="ACCNUT_ACNT_NM" type="STRING" size="256" sumtext="원가항목명"/>
          <Column id="WIK_CPTAL_PLAN_KEY" type="STRING" size="256"/>
          <Column id="POPUP_REGIST_AT" type="STRING" size="256" sumtext="팝업등록여부"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_validation" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="compId" type="STRING" size="256"/>
          <Column id="colId" type="STRING" size="256"/>
          <Column id="PK" type="STRING" size="256"/>
          <Column id="notNull" type="STRING" size="256"/>
          <Column id="type" type="STRING" size="256"/>
          <Column id="nlength" type="STRING" size="256"/>
          <Column id="from" type="STRING" size="256"/>
          <Column id="to" type="STRING" size="256"/>
          <Column id="lengthChkGb" type="STRING" size="256"/>
          <Column id="msgId" type="STRING" size="256"/>
          <Column id="expr" type="STRING" size="256"/>
          <Column id="func" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="colId">BUDGET_YEAR</Col>
            <Col id="compId">ds_mnthngCptalList</Col>
            <Col id="msgId">예산년도(월간)</Col>
            <Col id="notNull">Y</Col>
          </Row>
          <Row>
            <Col id="compId">ds_mnthngCptalList</Col>
            <Col id="msgId">계정구분(월간)</Col>
            <Col id="notNull">Y</Col>
            <Col id="colId">BUDGET_ACNT_SE</Col>
          </Row>
          <Row>
            <Col id="compId">ds_mnthngCptalList</Col>
            <Col id="msgId">계정과목(월간)</Col>
            <Col id="notNull">Y</Col>
            <Col id="colId">BUDGET_ACNT_CODE</Col>
          </Row>
          <Row>
            <Col id="compId">ds_mnthngCptalList</Col>
            <Col id="colId">PLAN_AMOUNT</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">계획금액(월간)</Col>
          </Row>
          <Row>
            <Col id="compId">ds_wikCptalList</Col>
            <Col id="colId">PLAN_AMOUNT</Col>
            <Col id="PK">[Undefined]</Col>
            <Col id="notNull">Y</Col>
            <Col id="type">[Undefined]</Col>
            <Col id="nlength">[Undefined]</Col>
            <Col id="from">[Undefined]</Col>
            <Col id="to">[Undefined]</Col>
            <Col id="lengthChkGb">[Undefined]</Col>
            <Col id="msgId">계획금액(주간)</Col>
            <Col id="expr">[Undefined]</Col>
            <Col id="func">[Undefined]</Col>
          </Row>
          <Row>
            <Col id="compId">ds_wikCptalList</Col>
            <Col id="colId">PRMPC_CODE</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">원가항목(주간)</Col>
          </Row>
          <Row>
            <Col id="compId">ds_etcCptalList</Col>
            <Col id="colId">BUDGET_YEAR</Col>
            <Col id="PK">[Undefined]</Col>
            <Col id="notNull">Y</Col>
            <Col id="type">[Undefined]</Col>
            <Col id="nlength">[Undefined]</Col>
            <Col id="from">[Undefined]</Col>
            <Col id="to">[Undefined]</Col>
            <Col id="lengthChkGb">[Undefined]</Col>
            <Col id="msgId">예산년도(계획외)</Col>
            <Col id="expr">[Undefined]</Col>
            <Col id="func">[Undefined]</Col>
          </Row>
          <Row>
            <Col id="compId">ds_etcCptalList</Col>
            <Col id="colId">BUDGET_ACNT_SE</Col>
            <Col id="PK">[Undefined]</Col>
            <Col id="notNull">Y</Col>
            <Col id="type">[Undefined]</Col>
            <Col id="nlength">[Undefined]</Col>
            <Col id="from">[Undefined]</Col>
            <Col id="to">[Undefined]</Col>
            <Col id="lengthChkGb">[Undefined]</Col>
            <Col id="msgId">계정구분(계획외)</Col>
            <Col id="expr">[Undefined]</Col>
            <Col id="func">[Undefined]</Col>
          </Row>
          <Row>
            <Col id="compId">ds_etcCptalList</Col>
            <Col id="colId">BUDGET_ACNT_CODE</Col>
            <Col id="PK">[Undefined]</Col>
            <Col id="notNull">Y</Col>
            <Col id="type">[Undefined]</Col>
            <Col id="nlength">[Undefined]</Col>
            <Col id="from">[Undefined]</Col>
            <Col id="to">[Undefined]</Col>
            <Col id="lengthChkGb">[Undefined]</Col>
            <Col id="msgId">계정과목(계획외)</Col>
            <Col id="expr">[Undefined]</Col>
            <Col id="func">[Undefined]</Col>
          </Row>
          <Row>
            <Col id="compId">ds_etcCptalList</Col>
            <Col id="colId">PLAN_AMOUNT</Col>
            <Col id="PK">[Undefined]</Col>
            <Col id="notNull">Y</Col>
            <Col id="type">[Undefined]</Col>
            <Col id="nlength">[Undefined]</Col>
            <Col id="from">[Undefined]</Col>
            <Col id="to">[Undefined]</Col>
            <Col id="lengthChkGb">[Undefined]</Col>
            <Col id="msgId">계획금액(계획외)</Col>
            <Col id="expr">[Undefined]</Col>
            <Col id="func">[Undefined]</Col>
          </Row>
          <Row>
            <Col id="compId">ds_etcCptalList</Col>
            <Col id="colId">PRMPC_CODE</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">원가항목(계획외)</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_acntSe_01" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_mnthngCptalList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_mnthngCptalList_onrowposchanged" cancolumnchange="ds_mnthngCptalList_cancolumnchange" canrowposchange="ds_mnthngCptalList_canrowposchange" oncolumnchanged="ds_mnthngCptalList_oncolumnchanged">
        <ColumnInfo>
          <Column id="CONFM_AT" type="STRING" size="256" sumtext="승인여부"/>
          <Column id="EXPNDTR_REGIST_AT" type="STRING" size="256" sumtext="지출등록여부"/>
          <Column id="DEPT_NM" type="STRING" size="256" sumtext="부서명"/>
          <Column id="DEPT_CODE" type="STRING" size="256" sumtext="부서코드"/>
          <Column id="PLAN_YM" type="STRING" size="256" sumtext="계획연월"/>
          <Column id="BUDGET_YEAR" type="STRING" size="256" sumtext="예산년도"/>
          <Column id="BUDGET_ACNT_SE" type="STRING" size="256" sumtext="계정구분"/>
          <Column id="BUDGET_ACNT_CODE" type="STRING" size="256" sumtext="계정코드"/>
          <Column id="BUDGET_ACNT_CODE_NM" type="STRING" size="256" sumtext="계정코드명"/>
          <Column id="BUDGET_TAXITM_CODE" type="STRING" size="256" sumtext="세목코드"/>
          <Column id="BUDGET_TAXITM_CODE_NM" type="STRING" size="256" sumtext="세목명"/>
          <Column id="EXPNDTR_UNIT_NM" type="STRING" size="256" sumtext="지출단위명"/>
          <Column id="EXPNDTR_UNIT_CODE" type="STRING" size="256" sumtext="지출단위코드"/>
          <Column id="BUDGET_AMOUNT" type="BIGDECIMAL" size="256" sumtext="예산금액"/>
          <Column id="EXPNDTR_AMOUNT" type="BIGDECIMAL" size="256" sumtext="집행금액"/>
          <Column id="BLCE" type="BIGDECIMAL" size="256" sumtext="잔액"/>
          <Column id="PLAN_AMOUNT" type="BIGDECIMAL" size="256" sumtext="계획금액"/>
          <Column id="DCSN_AMOUNT" type="BIGDECIMAL" size="256" sumtext="승인금액"/>
          <Column id="EXPNDTR_POSBL" type="STRING" size="256" sumtext="지출가능여부"/>
          <Column id="MONTH_EXPNDTR_AMOUNT" type="BIGDECIMAL" size="256"/>
          <Column id="REGISTER_ID" type="STRING" size="256"/>
          <Column id="REGIST_DT" type="STRING" size="256"/>
          <Column id="UPDUSR_ID" type="STRING" size="256"/>
          <Column id="UPDT_DT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_emp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="EMPNO" type="STRING" size="256"/>
          <Column id="EMPNM" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="CLSF_CODE" type="STRING" size="256"/>
          <Column id="SALARY_SE" type="STRING" size="256"/>
          <Column id="RSPOFC_SE" type="STRING" size="256"/>
          <Column id="JSSFC_SE" type="STRING" size="256"/>
          <Column id="SRCLS" type="STRING" size="256"/>
          <Column id="ECNY_DE" type="STRING" size="256"/>
          <Column id="ADRES" type="STRING" size="256"/>
          <Column id="TELNO_2" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_excutct" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="EXPNDTR_AMOUNT" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_anactKnd" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond02" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="YEAR" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="BSNS_SE" type="STRING" size="256"/>
          <Column id="BALC_SE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_wikCptalList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" cancolumnchange="ds_wikCptalList_cancolumnchange" oncolumnchanged="ds_wikCptalList_oncolumnchanged">
        <ColumnInfo>
          <Column id="PLAN_YM" type="STRING" size="256" sumtext="계획년월"/>
          <Column id="WEEK_ATMB" type="STRING" size="256" sumtext="주간"/>
          <Column id="SE" type="STRING" size="256" sumtext="주간구분"/>
          <Column id="SN" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256" sumtext="부서코드"/>
          <Column id="DEPT_NM" type="STRING" size="256" sumtext="부서명"/>
          <Column id="BUDGET_ACNT_SE" type="STRING" size="256" sumtext="계정구분"/>
          <Column id="BUDGET_ACNT_CODE" type="STRING" size="256" sumtext="계정코드"/>
          <Column id="BUDGET_ACNT_CODE_NM" type="STRING" size="256" sumtext="계정명"/>
          <Column id="EXPNDTR_UNIT_CODE" type="STRING" size="256" sumtext="지출단위코드"/>
          <Column id="EXPNDTR_UNIT_NM" type="STRING" size="256" sumtext="지출단위명"/>
          <Column id="PLAN_AMOUNT" type="BIGDECIMAL" size="256" sumtext="계획금액"/>
          <Column id="DCSN_AMOUNT" type="BIGDECIMAL" size="256" sumtext="승인금액"/>
          <Column id="MONTH_DCSN_AMOUNT" type="BIGDECIMAL" size="256" sumtext="월간승인금액"/>
          <Column id="MONTH_BLCE" type="BIGDECIMAL" size="256" sumtext="월간잔액"/>
          <Column id="MONTH_EXPNDTR_AMOUNT" type="BIGDECIMAL" size="256" sumtext="월간 집행금액"/>
          <Column id="CONFM_AT" type="STRING" size="256" sumtext="승인여부"/>
          <Column id="BUDGET_YEAR" type="STRING" size="256" sumtext="예산년도"/>
          <Column id="ANACT_KND" type="STRING" size="256" sumtext="결의서종류"/>
          <Column id="CAUSE_ACTION_NO" type="STRING" size="256" sumtext="원인행위번호"/>
          <Column id="RM" type="STRING" size="256" sumtext="적요"/>
          <Column id="REGISTER_ID" type="STRING" size="256"/>
          <Column id="REGIST_DT" type="STRING" size="256"/>
          <Column id="UPDUSR_ID" type="STRING" size="256"/>
          <Column id="UPDT_DT" type="STRING" size="256"/>
          <Column id="PRMPC_YEAR" type="STRING" size="256" sumtext="원가년도"/>
          <Column id="PRMPC_CODE" type="STRING" size="256" sumtext="원가코드"/>
          <Column id="ACCNUT_ACNT_NM" type="STRING" size="256" sumtext="원가항목명"/>
          <Column id="WIK_CPTAL_PLAN_KEY" type="STRING" size="256"/>
          <Column id="POPUP_REGIST_AT" type="STRING" size="256" sumtext="팝업등록여부"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_acntSe_02" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_week" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_month" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">01</Col>
            <Col id="CODE_NM">01</Col>
          </Row>
          <Row>
            <Col id="CODE">02</Col>
            <Col id="CODE_NM">02</Col>
          </Row>
          <Row>
            <Col id="CODE">03</Col>
            <Col id="CODE_NM">03</Col>
          </Row>
          <Row>
            <Col id="CODE">04</Col>
            <Col id="CODE_NM">04</Col>
          </Row>
          <Row>
            <Col id="CODE">05</Col>
            <Col id="CODE_NM">05</Col>
          </Row>
          <Row>
            <Col id="CODE">06</Col>
            <Col id="CODE_NM">06</Col>
          </Row>
          <Row>
            <Col id="CODE">07</Col>
            <Col id="CODE_NM">07</Col>
          </Row>
          <Row>
            <Col id="CODE">08</Col>
            <Col id="CODE_NM">08</Col>
          </Row>
          <Row>
            <Col id="CODE">09</Col>
            <Col id="CODE_NM">09</Col>
          </Row>
          <Row>
            <Col id="CODE">10</Col>
            <Col id="CODE_NM">10</Col>
          </Row>
          <Row>
            <Col id="CODE">11</Col>
            <Col id="CODE_NM">11</Col>
          </Row>
          <Row>
            <Col id="CODE">12</Col>
            <Col id="CODE_NM">12</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_acntSe" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_popResult" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="WIK_CPTAL_PLAN_KEY" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_CODE" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_CODE_NM" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_NM" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_CODE" type="STRING" size="256"/>
          <Column id="TYPE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item0" compid="div_search00.edt_deptCode" propid="value" datasetid="ds_cond00" columnid="DEPT_CODE"/>
      <BindItem id="item1" compid="div_search00.edt_deptNm" propid="value" datasetid="ds_cond00" columnid="DEPT_NM"/>
      <BindItem id="item2" compid="div_search00.spn_year" propid="value" datasetid="ds_cond00" columnid="STDR_YY"/>
      <BindItem id="item3" compid="div_search00.cmb_month" propid="value" datasetid="ds_cond00" columnid="STDR_MT"/>
      <BindItem id="item4" compid="div_search00.cmb_week" propid="value" datasetid="ds_cond00" columnid="WEEK_ATMB"/>
      <BindItem id="item5" compid="div_search00.cmb_budgetAcntSe" propid="value" datasetid="ds_cond00" columnid="ACNT_SE"/>
      <BindItem id="item6" compid="div_search.spn_year" propid="value" datasetid="ds_cond00" columnid="STDR_YY"/>
      <BindItem id="item7" compid="div_search.cmb_month" propid="value" datasetid="ds_cond00" columnid="STDR_MT"/>
      <BindItem id="item8" compid="div_search.cmb_week" propid="value" datasetid="ds_cond00" columnid="WEEK_ATMB"/>
      <BindItem id="item9" compid="div_search.cmb_budgetAcntSe" propid="value" datasetid="ds_cond00" columnid="ACNT_SE"/>
      <BindItem id="item10" compid="div_search.edt_deptCode" propid="value" datasetid="ds_cond00" columnid="DEPT_CODE"/>
      <BindItem id="item11" compid="div_search.edt_deptNm" propid="value" datasetid="ds_cond00" columnid="DEPT_NM"/>
    </Bind>
    <Script type="xscript5.0"><![CDATA[/***********************************************************************
 * 01. 업무구분 : 사업지구코드조회
 * 02. 화면명   : FUN020101_P01.xfdl
 * 03. 화면설명 : 사업지구코드를 조회한다.
 * 04. 작성일   : 2015.07.13
 * 05. 작성자   : 양성모
 * 06. 수정이력 : 2015.07.13 최초생성
 ***********************************************************************
 *     수정일     작성자   내용
 ***********************************************************************
 *    2015.07.13   양성모   최초
 ***********************************************************************
 */

/***********************************************************************
 * Script Include 
 ************************************************************************/
include "lib::comInclude.xjs";
include "mis_lib::misUtil.xjs";

this.fv_objForm;
this.strGridNm;    //현재 선택된 그리드 id
this.oldRowCnt = 0;
this.newRowCnt = 0;
this.saveRow = -1;
this.checkDs = [this.ds_mnthngCptalList, this.ds_wikCptalList, this.ds_etcCptalList];
/***********************************************************************
 * 설명: 폼로딩시 처리
 ************************************************************************/
this.FUN000000_P01_oninit = function(obj:Form, e:nexacro.InitEventInfo)
{
	// Form 초기화
	this.fn_init_form();

	// DataSet 초기화
	this.fn_init_dataset();
}

this.FUN000000_P01_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{	
	// 팝업을 호출한 Form을 얻음. ==> 반드시, 기술되어야 함.
	this.fv_objForm = this.parent.arg_0;

	// Main Form에서 넘겨준 Argument (Dataset)를 얻음
	//this.ds_cond.copyData(this.parent.arg_1);
	
	var strDeptCode = this.parent.arg_1.getColumn(0, "DEPT_CODE");
	var strDeptNm   = this.parent.arg_1.getColumn(0, "DEPT_NM");
	var strKey      = this.parent.arg_1.getColumn(0, "WIK_CPTAL_PLAN_KEY");
	
	// 검색조건 컴포넌트 초기값 부여
	this.ds_cond00.setColumn(0, "STDR_YY", this.dateUtils.today().substr(0,4));
	this.ds_cond00.setColumn(0, "STDR_MT", this.dateUtils.today().substr(4,2));
	this.ds_cond00.setColumn(0, "POPUP_YN",  "1");
	this.ds_cond00.setColumn(0, "DEPT_CODE", strDeptCode);
	this.ds_cond00.setColumn(0, "DEPT_NM",   strDeptNm);
	this.ds_cond00.setColumn(0, "WIK_CPTAL_PLAN_KEY", strKey);
	
	// 기존 자금배정 등록 여부 체크
	if(strKey) {
		this.oldRowCnt = 1;
		this.newRowCnt = 1;
	}
	
	// 공통코드
	var comboParams = [
		["ds_acntSe", "BDG017", "Y", "A"]	    // 계정구분(검색조건)
	   ,["ds_acntSe_01", "BDG017", "Y", "S"]	// 계정구분(월간계획)
	   ,["ds_acntSe_02", "BDG017", "Y", "S"]	// 계정구분(계획외지출)
	   ,["ds_anactKnd", "ACC002", "Y", "D"]	    // 결의서구분
	];
	var callback = function (svcId, errorCode, errorMsg) {
		this.ds_cond00.setColumn(0, "ACNT_SE", "");
		this.ds_acntSe_02.filter("CODE == '' || CODE == '12' || CODE == '22' || CODE == '31'");
	};
	this.gfn_comboLoad (comboParams, callback);	
}

/***********************************************************************
 * Form/Dataset 오브젝트 초기화
 ***********************************************************************/
/*
 * 함수명  	: initForm
 * 설명 		: Form을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initForm();
 */
this.fn_init_form = function()
{
	// 시스템 공통으로 Form을 Initialize 한다.
	this.gfn_initForm(this);
	this.fn_misFormInit(this);
}

/*
 * 함수명  	: initDataset
 * 설명 		: Dataset을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initDataset();
 */
this.fn_init_dataset = function()
{
	this.gfn_initCondDs(this, this.div_search);
} 
 

/***********************************************************************
* Transaction 영역 시작
************************************************************************/

/***********************************************************************
 * Transaction 관련 이벤트 핸들러 
 **********************************************************************/
/*
 * 함수명  	: fn_search
 * 설명 		: 월간, 계획외지출 등록 내역 조회 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_search();
 */
this.fn_search = function()
{	
	// 데이터셋 클리어
	this.ds_mnthngCptalList.clearData();
	this.ds_wikCptalList.clearData();
	this.ds_etcCptalList.clearData();
	
	var strYear  = this.ds_cond00.getColumn(0, "STDR_YY");
	var strMonth = this.ds_cond00.getColumn(0, "STDR_MT");
	var strWeek  = this.ds_cond00.getColumn(0, "WEEK_ATMB");
	
	this.ds_cond00.setColumn(0, "PLAN_YM",   strYear+strMonth);
	this.ds_cond01.setColumn(0, "WEEK_ATMB", strWeek);
	this.fn_transaction("selectMnthngCptalList");
}

/*
 * 함수명  	: fn_search
 * 설명 		: 주간 수입/지출계획 등록 현황  조회 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_search();
 */
this.fn_searchWikCptalList = function()
{
	var nRow = this.ds_mnthngCptalList.rowposition;
	this.ds_cond01.setColumn(0, "PLAN_YM",            this.ds_mnthngCptalList.getColumn(nRow, "PLAN_YM"));                // 계획년월
	this.ds_cond01.setColumn(0, "DEPT_CODE",          this.ds_mnthngCptalList.getColumn(nRow, "DEPT_CODE"));              // 부서코드
	this.ds_cond01.setColumn(0, "BUDGET_ACNT_SE",     this.ds_mnthngCptalList.getColumn(nRow, "BUDGET_ACNT_SE"));         // 계정구분
	this.ds_cond01.setColumn(0, "BUDGET_ACNT_CODE",   this.ds_mnthngCptalList.getColumn(nRow, "BUDGET_ACNT_CODE"));       // 계정코드
	this.ds_cond01.setColumn(0, "BUDGET_TAXITM_CODE", this.ds_mnthngCptalList.getColumn(nRow, "BUDGET_TAXITM_CODE"));     // 세목코드
	this.ds_cond01.setColumn(0, "EXPNDTR_UNIT_CODE",  this.ds_mnthngCptalList.getColumn(nRow, "EXPNDTR_UNIT_CODE"));      // 지출단위코드
	
	this.fn_transaction("selectWikCptalList");
}

/*
 * 함수명  	: fn_save
 * 설명 		: 저장 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_save();
 */
this.fn_save = function()
{
	// 주간, 계획외지출 데이터셋 변경사항 체크
    if(Ex.util.isUpdated(this.ds_wikCptalList) || Ex.util.isUpdated(this.ds_etcCptalList)){
		
		// validation 체크(주간계획)
		if(!this.gfn_checkValidation_NoUpdChk(this.ds_wikCptalList, this.ds_validation)) {
			return;
		}
		
		// validation 체크(계획외지출)
		if(!this.gfn_checkValidation_NoUpdChk(this.ds_etcCptalList, this.ds_validation)) {
			return;
		}
	    
	    this.saveRow = this.ds_mnthngCptalList.rowposition;
	    this.fn_transaction("savePopup");
	}else{
		//변경되지 않았을 경우.
		this.gfn_message("comm.데이터.변경.없음");
	}
}

/*
 * 함수명  	: fn_excutct
 * 설명 		: 집행금액 조회 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_excutct();
 */
this.fn_excutct = function()
{
    if(this.strGridNm == "mnthngCptalList") {
		var nRow           = this.ds_mnthngCptalList.rowposition;
		var acntSe         = this.ds_mnthngCptalList.getColumn(nRow, "BUDGET_ACNT_SE");        // 계정구분
		var acntCd         = this.ds_mnthngCptalList.getColumn(nRow, "BUDGET_ACNT_CODE");      // 계정코드
		var expndtrUnitCd  = this.ds_mnthngCptalList.getColumn(nRow, "EXPNDTR_UNIT_CODE");     // 지출단위코드
		var year           = this.ds_mnthngCptalList.getColumn(nRow, "BUDGET_YEAR");           // 년도
		var planYm         = this.ds_mnthngCptalList.getColumn(nRow, "PLAN_YM");               // 계획년월
		var deptCd         = this.ds_mnthngCptalList.getColumn(nRow, "DEPT_CODE");             // 부서코드
		
		this.ds_cond03.setColumn(0, "BUDGET_ACNT_SE",     acntSe);
		this.ds_cond03.setColumn(0, "BUDGET_ACNT_CODE",   acntCd);
		this.ds_cond03.setColumn(0, "EXPNDTR_UNIT_CODE",  expndtrUnitCd);
		this.ds_cond03.setColumn(0, "BUDGET_YEAR",        year);
		this.ds_cond03.setColumn(0, "PLAN_YM",            planYm);
		this.ds_cond03.setColumn(0, "DEPT_CODE",          deptCd);
		
		this.fn_transaction("selectExcutctInfo");    
    }
    
    if(this.strGridNm == "etcCptalList") {
		var nRow           = this.ds_etcCptalList.rowposition;
		var acntSe         = this.ds_etcCptalList.getColumn(nRow, "BUDGET_ACNT_SE");        // 계정구분
		var acntCd         = this.ds_etcCptalList.getColumn(nRow, "BUDGET_ACNT_CODE");      // 계정코드
		var expndtrUnitCd  = this.ds_etcCptalList.getColumn(nRow, "EXPNDTR_UNIT_CODE");     // 지출단위코드
		var year           = this.ds_etcCptalList.getColumn(nRow, "BUDGET_YEAR");           // 년도
		var planYm         = this.ds_etcCptalList.getColumn(nRow, "PLAN_YM");               // 계획년월
		var deptCd         = this.ds_etcCptalList.getColumn(nRow, "DEPT_CODE");             // 부서코드
		
		this.ds_cond03.setColumn(0, "BUDGET_ACNT_SE",     acntSe);
		this.ds_cond03.setColumn(0, "BUDGET_ACNT_CODE",   acntCd);
		this.ds_cond03.setColumn(0, "EXPNDTR_UNIT_CODE",  expndtrUnitCd);
		this.ds_cond03.setColumn(0, "BUDGET_YEAR",        year);
		this.ds_cond03.setColumn(0, "PLAN_YM",            planYm);
		this.ds_cond03.setColumn(0, "DEPT_CODE",          deptCd);
		
		this.fn_transaction("selectExcutctInfo");    
    }   
}

/*
 * 함수명  	: fn_expndtrPosbl
 * 설명 		: 지출가능 여부 조회 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_expndtrPosbl();
 */
this.fn_expndtrPosbl = function()
{
    if(this.strGridNm == "mnthngCptalList") {
		var nRow           = this.ds_mnthngCptalList.rowposition;
	//	this.fn_transaction("selectExcutctInfo");
		
		this.ds_mnthngCptalList.setColumn(nRow, "EXPNDTR_POSBL",      "0"  );
    }
    
    if(this.strGridNm == "etcCptalList") {
		var nRow           = this.ds_etcCptalList.rowposition;
	//	this.fn_transaction("selectExcutctInfo");
		
		this.ds_etcCptalList.setColumn(nRow, "EXPNDTR_POSBL",      "0"  );
    }
}

/*
 * 함수명  	: fn_week
 * 설명 		: 년월별 주 조회
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_week();
 */
this.fn_week = function()
{	
	this.fn_transaction("selectWeek");
}

/**********************************************************************
 * CALL TRANSACTION 영역
 **********************************************************************/
 
/*
 * 함수명  	: fn_transaction
 * 설명 		: Transaction 요청 처리 함수
 * params  		: strSvcId : 서비스요청 ID
 * return Type 	: None
 * 사용법		: this.fn_transaction("SELECT");
 */
this.fn_transaction = function(strSvcId)
{
	switch (strSvcId) {
		case "selectMnthngCptalList":    // 월간, 계획외지출 내역 불러오기
			var sController   	= "hsco/mis/fun/FUN040401/selectMnthngCptalPlanList.do";
			var sInDatasets   	= "input1=ds_cond00";
			var sOutDatasets  	= "ds_mnthngCptalList=output1 ds_etcCptalList=output2";
			break;
		case "selectWikCptalList":       // 주간계획 불러오기
			var sController   	= "hsco/mis/fun/FUN040401/selectWikCptalPlanList.do";
			var sInDatasets   	= "input1=ds_cond01";
			var sOutDatasets  	= "ds_wikCptalList=output1";
			break;
		case "savePopup":         // 주간계획 저장하기
			var sController   	= "hsco/mis/fun/FUN040401/popUpCUD.do";	
			var sInDatasets   	= "input1=ds_wikCptalList:U input2=ds_etcCptalList:U";
			var sOutDatasets  	= "ds_popResult=output1";
			break;			
		case "selectExcutctInfo":        // 집행금액 조회하기
			var sController   	= "hsco/mis/fun/FUN040401/selectExcutctInfo.do";   
			var sInDatasets   	= "input1=ds_cond03";
			var sOutDatasets  	= "ds_excutct=output1";
			break;
		case "selectWeek":           // 년월별 주 조회
			var sController   	= "hsco/mis/fun/FUN040401/selectWeekList.do";   
			var sInDatasets   	= "input1=ds_cond00";
			var sOutDatasets  	= "ds_week=output1"; 
			break;
	}

	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets); 
}

 /**********************************************************************
 * Transaction Callback 영역
 ***********************************************************************/
 
 /*
 * 함수명  	: fn_callBack
 * 설명 		: Transaction Callback 처리
 * params  		: strSvcId    : 서비스요청 ID
 *                nErrorCode  : 오류 메시지 코드 ([예] 0 : Success, 그밖의 경우, error)
 *                strErrorMsg : 오류 메시지([예]  success.insert|정상적으로 등록되었습니다.)
 * return Type 	: None
 * 사용법		: 
 */
this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg)
{
	
    trace(strSvcId);
	if (nErrorCode != 0){
	
	} else {
		// 성공 메시지를 보여주는 동작 외에 처리할 내용이 있으면 아래에 기술.
		switch (strSvcId) {
			case "selectMnthngCptalList":	// 월간, 계획외지출 내역 불러오기	
			    this.ds_mnthngCptalList.applyChange();
			    this.ds_etcCptalList.applyChange();
			    
			    if(this.saveRow > -1){
					this.ds_mnthngCptalList.set_rowposition(this.saveRow);
					this.saveRow = -1;
				}
				break;
			case "selectWikCptalList":      // 주간계획 불러오기
			    this.ds_wikCptalList.applyChange();
			    
			    if(this.saveRow > -1){
					this.ds_mnthngCptalList.set_rowposition(this.saveRow);
					this.saveRow = -1;
				}
				break;
			case "savePopup":
			    this.gfn_message("success.처리.성공");
			    
			    if(this.ds_popResult.rowcount == 0) {
					this.ds_popResult.addRow();
			    }
			    
			    this.close(this.ds_popResult.saveXML());
				break;	
			case "selectExcutctInfo":  // 집행금액 조회하기
				if(this.ds_excutct.rowcount > 0 ){
					if(this.strGridNm == "mnthngCptalList") {
						var nRow     = this.ds_mnthngCptalList.rowposition;
						var nExcutct = this.ds_excutct.getColumn(0,"EXPNDTR_AMOUNT");
						
						this.ds_mnthngCptalList.setColumn(nRow, "EXPNDTR_AMOUNT",  nExcutct);			
					}

					if(this.strGridNm == "etcCptalList") {
						var nRow     = this.ds_etcCptalList.rowposition;
						var nExcutct = this.ds_excutct.getColumn(0,"EXPNDTR_AMOUNT");
						
						this.ds_etcCptalList.setColumn(nRow, "EXPNDTR_AMOUNT",  nExcutct);			
					}
				}      
				break;
			case "selectWeek":          // 년월별 주 조회
				if(this.ds_week.rowcount > 0){
					this.ds_cond00.setColumn(0, "WEEK_ATMB", this.ds_week.getColumn(0, "CODE"));
				} else{
					this.ds_cond00.setColumn(0, "WEEK_ATMB", null);
					this.gfn_message("fail.정보검색.실패", "시스템에 설정된 검색일의 주차 정보를");
				}
				break;				
		}
	}
	
	// 오류 및 성공 메시지를 화면에 보여준다.
	this.gfn_callback_message(strSvcId, nErrorCode, strErrorMsg);
}

/*
 * 함수명  	: fn_PopupCallback
 * 설명 		: 팝업 콜백함수
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_PopupCallback();
 */
this.fn_PopupCallback = function(sPopupId, sReturn)
{
    var dsRtn = new Dataset();
    nRowCnt = dsRtn.loadXML(sReturn);

	if(nRowCnt){
		
		if(sPopupId == "etcCptalList") {
			var acntCode      = dsRtn.getColumn(0, "BUDGET_ACNT_CODE");
			var acntNm        = dsRtn.getColumn(0, "BUDGET_ACNT_NM");
			var budgetAm      = dsRtn.getColumn(0, "BUDGET_AM");
			var expndtrUnitCd = dsRtn.getColumn(0, "EXPNDTR_UNIT_CODE");
			var expndtrUnitNm = dsRtn.getColumn(0, "EXPNDTR_UNIT_NM");
			var nRow = this.ds_etcCptalList.rowposition;
			
			this.ds_etcCptalList.setColumn(nRow, "BUDGET_ACNT_CODE",      acntCode      );
			this.ds_etcCptalList.setColumn(nRow, "BUDGET_ACNT_CODE_NM",   acntNm        );
			this.ds_etcCptalList.setColumn(nRow, "BUDGET_AMOUNT",         budgetAm      );
			this.ds_etcCptalList.setColumn(nRow, "EXPNDTR_UNIT_CODE",     expndtrUnitCd );
			this.ds_etcCptalList.setColumn(nRow, "EXPNDTR_UNIT_NM",       expndtrUnitNm );
			
			this.strGridNm = "etcCptalList";
			
			// 지출가능 조회 이벤트
            this.fn_expndtrPosbl();	
				
			// 집행금액 조회 이벤트
            this.fn_excutct();
		}
		
		if(sPopupId == "wikPrmpcPopup") {
		    var strAccnutYr   = dsRtn.getColumn(0, "ACCNUT_YEAR");
		    var strAccnutCode = dsRtn.getColumn(0, "ACCNUT_ACNT_CODE");
		    var strAccnutNm   = dsRtn.getColumn(0, "ACCNUT_ACNT_NM");
			var nRow = this.ds_wikCptalList.rowposition;
			
			this.ds_wikCptalList.setColumn(nRow, "PRMPC_YEAR", strAccnutYr);
			this.ds_wikCptalList.setColumn(nRow, "PRMPC_CODE", strAccnutCode);
			this.ds_wikCptalList.setColumn(nRow, "ACCNUT_ACNT_NM", strAccnutNm);
		}
		
		if(sPopupId == "etcPrmpcPopup") {
		    var strAccnutYr   = dsRtn.getColumn(0, "ACCNUT_YEAR");
		    var strAccnutCode = dsRtn.getColumn(0, "ACCNUT_ACNT_CODE");
		    var strAccnutNm   = dsRtn.getColumn(0, "ACCNUT_ACNT_NM");
			var nRow = this.ds_etcCptalList.rowposition;
			
			this.ds_etcCptalList.setColumn(nRow, "PRMPC_YEAR", strAccnutYr);
			this.ds_etcCptalList.setColumn(nRow, "PRMPC_CODE", strAccnutCode);
			this.ds_etcCptalList.setColumn(nRow, "ACCNUT_ACNT_NM", strAccnutNm);
		}			
	}
	
	if(sReturn){
		if(sPopupId == "etcCauseActionPopup") {
		var nRow = this.ds_etcCptalList.rowposition;
		
		this.ds_etcCptalList.setColumn(nRow, "CAUSE_ACTION_NO", sReturn);
		}
		
		if(sPopupId == "wikCauseActionPopup") {
			var nRow = this.ds_wikCptalList.rowposition;
			
			this.ds_wikCptalList.setColumn(nRow, "CAUSE_ACTION_NO", sReturn  );
		}
	}
}

/***********************************************************************
* Transaction 영역 끝
************************************************************************/

/***********************************************************************
 * non-Transaction 관련 컴포넌트 이벤트 처리 함수
 ***********************************************************************/
/*
 * 함수명  	: div_Cont_btn_Add_Row_onclick
 * 설명 		: 주간, 계획외지출 행추가 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.div_Cont_btn_Add_Row_onclick();
 */
this.div_Cont_btn_Add_Row_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.newRowCnt > 0) {
		
		this.gfn_message("info.저장.초과", "자금배정은 1건씩");
	} else {	
		if(this.div_dtl00.tab_wikCptalList.tabindex == 0)    // 주간계획 탭
		{
			var nRow1 = this.ds_mnthngCptalList.rowposition;
			
			if(0 <= nRow1){
				var strConfmAt = this.ds_mnthngCptalList.getColumn(nRow1, "CONFM_AT");			// 승인여부
				var strAcntSe  = this.ds_mnthngCptalList.getColumn(nRow1, "BUDGET_ACNT_SE");    // 계정구분
				var nDcsnAmt   = this.ds_mnthngCptalList.getColumn(nRow1, "DCSN_AMOUNT");		// 승인금액
				var nDcsnAmt   = this.ds_mnthngCptalList.getColumn(nRow1, "DCSN_AMOUNT");		// 승인금액
				
				if(strAcntSe == "11" || strAcntSe == "21") {	//수익적수익, 자본적수입은 주단위 계획 등록안함
					this.gfn_message("errors.값확인.요청", "주계획 등록대상 자료가|월간계획을");
					return;
				}
				
				if(strConfmAt == "0") {
					this.gfn_message("comm.승인안됨");
					return;
				}
				
				if(strConfmAt <= 0) {
					this.gfn_message("errors.없음.요청", "승인 금액이|월간계획 승인정보를");
					return;
				}
				
				if(this.div_search.cmb_week.index < 0) {
					this.gfn_message("info.항목.선택.알림", "주차");
					return;
				}
				
				var nRow = this.ds_wikCptalList.addRow();
				
				this.ds_wikCptalList.setColumn(nRow, "CONFM_AT",                  "0");                                                               // 승인여부
				this.ds_wikCptalList.setColumn(nRow, "PLAN_YM",                   this.ds_mnthngCptalList.getColumn(nRow1,"PLAN_YM"));                // 계획년월
				this.ds_wikCptalList.setColumn(nRow, "SE",                        "1");
				this.ds_wikCptalList.setColumn(nRow, "ANACT_KND",                 "03");															  // 결의서종류
				this.ds_wikCptalList.setColumn(nRow, "WEEK_ATMB",                 this.ds_cond00.getColumn(0,"WEEK_ATMB"));                           // 주차
				this.ds_wikCptalList.setColumn(nRow, "DEPT_CODE",                 this.ds_mnthngCptalList.getColumn(nRow1,"DEPT_CODE"));              // 부서코드
				this.ds_wikCptalList.setColumn(nRow, "DEPT_NM",                   this.ds_mnthngCptalList.getColumn(nRow1,"DEPT_NM"));                // 부서명
				this.ds_wikCptalList.setColumn(nRow, "BUDGET_YEAR",               this.ds_mnthngCptalList.getColumn(nRow1,"BUDGET_YEAR"));            // 예산년도
				this.ds_wikCptalList.setColumn(nRow, "BUDGET_ACNT_SE",            this.ds_mnthngCptalList.getColumn(nRow1,"BUDGET_ACNT_SE"));         // 계정구분
				this.ds_wikCptalList.setColumn(nRow, "BUDGET_ACNT_CODE",          this.ds_mnthngCptalList.getColumn(nRow1,"BUDGET_ACNT_CODE"));       // 계정코드
				this.ds_wikCptalList.setColumn(nRow, "BUDGET_ACNT_CODE_NM",       this.ds_mnthngCptalList.getColumn(nRow1,"BUDGET_ACNT_CODE_NM"));    // 계정코드명
				this.ds_wikCptalList.setColumn(nRow, "EXPNDTR_UNIT_CODE",         this.ds_mnthngCptalList.getColumn(nRow1,"EXPNDTR_UNIT_CODE"));      // 지출단위코드
				this.ds_wikCptalList.setColumn(nRow, "EXPNDTR_UNIT_NM",           this.ds_mnthngCptalList.getColumn(nRow1,"EXPNDTR_UNIT_NM"));        // 지출단위명			
				this.ds_wikCptalList.setColumn(nRow, "MONTH_DCSN_AMOUNT",         this.ds_mnthngCptalList.getColumn(nRow1,"DCSN_AMOUNT"));            // 월 승인금액 
				this.ds_wikCptalList.setColumn(nRow, "MONTH_EXPNDTR_AMOUNT",      this.ds_mnthngCptalList.getColumn(nRow1,"MONTH_EXPNDTR_AMOUNT"));   // 월 집행금액
				this.ds_wikCptalList.setColumn(nRow, "POPUP_REGIST_AT",           "1");   // 팝업등록여부
				
				this.newRowCnt = 1;
			} else {
				this.gfn_message("info.항목.선택.알림", "월간계획");
			}
		}
		
		if(this.div_dtl00.tab_wikCptalList.tabindex == 1)    // 주간외계획 탭
		{
			var strDeptCode = this.ds_cond00.getColumn(0, "DEPT_CODE");
			
			if(strDeptCode == "" || strDeptCode == "000000") {
				this.gfn_message("info.항목.선택.알림", "부서");
				return;
			}
			
			if(this.div_search.cmb_week.index < 0) {
				this.gfn_message("info.항목.선택.알림", "주차");
				return;
			}
				
			var nRow = this.ds_etcCptalList.addRow();
			
			this.ds_etcCptalList.setColumn(nRow, "PLAN_YM",           this.ds_cond00.getColumn(0,"STDR_YY") + this.ds_cond00.getColumn(0,"STDR_MT"));
			this.ds_etcCptalList.setColumn(nRow, "BUDGET_YEAR",       this.ds_cond00.getColumn(0,"STDR_YY"));
			this.ds_etcCptalList.setColumn(nRow, "BUDGET_ACNT_SE",    "");
			this.ds_etcCptalList.setColumn(nRow, "DEPT_NM",           this.ds_cond00.getColumn(0,"DEPT_NM"));
			this.ds_etcCptalList.setColumn(nRow, "DEPT_CODE",         this.ds_cond00.getColumn(0,"DEPT_CODE"));
			this.ds_etcCptalList.setColumn(nRow, "WEEK_ATMB",         this.ds_cond00.getColumn(0,"WEEK_ATMB"));
			this.ds_etcCptalList.setColumn(nRow, "EXPNDTR_REGIST_AT", "0");
			this.ds_etcCptalList.setColumn(nRow, "CONFM_AT",          "0");
			this.ds_etcCptalList.setColumn(nRow, "BUDGET_AMOUNT",     0);
			this.ds_etcCptalList.setColumn(nRow, "EXPNDTR_AMOUNT",    0);
			this.ds_etcCptalList.setColumn(nRow, "DCSN_AMOUNT",       0);
			this.ds_etcCptalList.setColumn(nRow, "ANACT_KND",         "03");
			this.ds_etcCptalList.setColumn(nRow, "SE",                "2");
			this.ds_etcCptalList.setColumn(nRow, "POPUP_REGIST_AT",   "1");   // 팝업등록여부
			
			this.newRowCnt = 1;
		}
	}
}

/*
 * 함수명  	: div_Cont_btn_Del_Row_onclick
 * 설명 		: 주간, 계획외지출 행삭제 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.div_Cont_btn_Del_Row_onclick();
 */
this.div_Cont_btn_Del_Row_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{	
	if(this.div_dtl00.tab_wikCptalList.tabindex == 0) {
	    var nRow = this.ds_wikCptalList.rowposition;
		var strConfmAt = this.ds_wikCptalList.getColumn(nRow, "CONFM_AT");
		var strKey = this.ds_wikCptalList.getColumn(nRow, "WIK_CPTAL_PLAN_KEY");
		var strCondKey = this.ds_cond00.getColumn(0, "WIK_CPTAL_PLAN_KEY");
		
		if(strConfmAt != "1") {
			if(strCondKey == strKey || !strKey) {
				if (this.gfn_message("confirm.삭제여부")) {
					this.ds_wikCptalList.deleteRow(nRow);
					this.newRowCnt = 0;
				}
			} else {
				this.gfn_message("fail.수정.불가", "사용자가 등록한 계획이 아니면");
			}
		} else {
			this.gfn_message("fail.삭제.불가", "이미 승인된 계획은");
			return false;
		}	
	}
	
	if(this.div_dtl00.tab_wikCptalList.tabindex == 1) {
		var nRow = this.ds_etcCptalList.rowposition;
		var strConfmAt = this.ds_etcCptalList.getColumn(nRow, "CONFM_AT");
		var strKey = this.ds_etcCptalList.getColumn(nRow, "WIK_CPTAL_PLAN_KEY");
		var strCondKey = this.ds_cond00.getColumn(0, "WIK_CPTAL_PLAN_KEY");		
		
		if(strConfmAt != "1") {
			
			if(strCondKey == strKey || !strKey) {
				if (this.gfn_message("confirm.삭제여부")) {
					this.ds_etcCptalList.deleteRow(nRow);
					this.newRowCnt = 0;
				}
			} else {
				this.gfn_message("fail.수정.불가", "사용자가 등록한 계획이 아니면");
			}					
		} else {
			this.gfn_message("fail.삭제.불가", "이미 승인된 계획은");
			return false;
		}	
	}
}

/*
 * 함수명  	: div_Cont_btn_Cancel_Row_onclick
 * 설명 		: 주간, 계획외지출 행취소 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.div_Cont_btn_Cancel_Row_onclick();
 */
this.div_Cont_btn_Cancel_Row_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if (this.gfn_message("confirm.취소여부")) {
		if(this.div_dtl00.tab_wikCptalList.tabindex == 0) {   // 주간계획 탭
			this.ds_wikCptalList.reset();		//DATASET ROLLBACK
			this.ds_wikCptalList.applyChange();	//DATASET COMMIT
			this.newRowCnt = this.oldRowCnt;
			return;		
		}
		
		if(this.div_dtl00.tab_wikCptalList.tabindex == 1) {   // 계획외지출 탭
			this.ds_etcCptalList.reset();		//DATASET ROLLBACK
			this.ds_etcCptalList.applyChange();	//DATASET COMMIT
			this.newRowCnt = this.oldRowCnt;
			return;		
		}		
	}
}


/*
 * 함수명  	: fn_onexpandup
 * 설명 		: 그리드 expand 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_onexpandup();
 */
this.fn_onexpandup = function(obj:Grid, e:nexacro.GridMouseEventInfo)
{
	if(obj.name == "grd_etcCptalList") {
		if(e.cell==6) {
			if(typeof this.ds_etcCptalList.getColumn(obj.currentrow, "BUDGET_YEAR") != "undefined" && this.ds_etcCptalList.getColumn(obj.currentrow, "BUDGET_YEAR") != "") {
				if(this.ds_etcCptalList.getColumn(obj.currentrow, "BUDGET_ACNT_SE") != "") {
						
						// 예산계정과목 팝업 호출						
						this.ds_cond02.setColumn(0,"YEAR",      this.ds_etcCptalList.getColumn(this.ds_etcCptalList.rowposition, "BUDGET_YEAR"));
						this.ds_cond02.setColumn(0,"DEPT_CODE", this.ds_etcCptalList.getColumn(this.ds_etcCptalList.rowposition, "DEPT_CODE"));
						this.ds_cond02.setColumn(0,"DEPT_NM",   this.ds_etcCptalList.getColumn(this.ds_etcCptalList.rowposition, "DEPT_NM"));
						this.ds_cond02.setColumn(0,"BSNS_SE",   this.ds_etcCptalList.getColumn(this.ds_etcCptalList.rowposition, "BUDGET_ACNT_SE").substr(0,1));
						this.ds_cond02.setColumn(0,"BALC_SE",   this.ds_etcCptalList.getColumn(this.ds_etcCptalList.rowposition, "BUDGET_ACNT_SE").substr(1,1));
						  
						var parm = {
							  arg_0      : this
							 ,searchDs   : this.ds_cond02.saveXML()       // 검색조건(YEAR, BSNS_SE, BALC_SE, DEPT_CODE 컬럼만 이용)
							 ,strObj     : "edt_YEAR,cbo_BSNS_SE,rdo_BALC_SE,div_srchDept" // 수정불가능 처리할 오브젝트 명(ex : "edt_YEAR,cbo_BSNS_SE,rdo_BALC_SE,div_srchDept")
							 ,year_S     : null            // 예산년도(srchDs보다 우선순위를 가짐)
							 ,bsnsSe_S   : null            // 사업구분(srchDs보다 우선순위를 가짐)
							 ,balcSe_S   : null            // 수지구분(srchDs보다 우선순위를 가짐)
							 ,deptCode_S : null            // 부서코드(srchDs보다 우선순위를 가짐)
							 ,acntPopup  : false            // (true : 예산계정코드선택팝업, false : 지출단위선택팝업)
						};
						this.gfn_popup("etcCptalList", 900, 635, "예산선택팝업", parm, "com::bdgAcntPop.xfdl", "fn_PopupCallback");		
				} else {
					this.gfn_message("info.항목.선택.알림", "계정구분");
				}	
			} else {
				this.gfn_message("comm.입력.요청.를", "예산년도");
			}
		}
		
		if(e.cell==15) {
			var anactKnd 	= this.ds_etcCptalList.getColumn(this.ds_etcCptalList.rowposition, "ANACT_KND");		// 결의서구분
			var deptCode	= this.ds_etcCptalList.getColumn(this.ds_etcCptalList.rowposition, "DEPT_CODE");		// 부서코드
			var deptNm		= this.ds_etcCptalList.getColumn(this.ds_etcCptalList.rowposition, "DEPT_NM");			// 부서명
			
			var nLeft    = system.clientToScreenX(this, 0);
			var nTop     = system.clientToScreenY(this, 0);
			var newChild = new ChildFrame;
			newChild.set_openalign("center middle");
			newChild.set_dragmovetype("all");
			newChild.init("etcCauseActionPopup", "absolute", nLeft, nTop, 600, 500, null, null , "mis_acc::ACC020203_P09.xfdl");
			newChild.showModal(this.getOwnerFrame(), {anactKnd:anactKnd, deptCode:deptCode, deptNm:deptNm}, this, "fn_PopupCallback");
		}
		
		if(e.cell==16) {
			var nLeft    = system.clientToScreenX(this, 0);
			var nTop     = system.clientToScreenY(this, 0);
			var newChild = new ChildFrame;
			newChild.set_openalign("center middle");
			newChild.set_dragmovetype("all");
			newChild.init("etcPrmpcPopup", "absolute", nLeft, nTop, 500, 490, null, null , "mis_acc::ACC000000_P02.xfdl");
			newChild.showModal(this.getOwnerFrame(), {year:this.ds_etcCptalList.getColumn(this.ds_etcCptalList.rowposition, "BUDGET_YEAR")}, this, "fn_PopupCallback");
		}		
	}
	
	if(obj.name == "grd_wikCptalList") {		
		if(e.cell==15) {
			var anactKnd 	= this.ds_wikCptalList.getColumn(this.ds_wikCptalList.rowposition, "ANACT_KND");		// 결의서구분
			var deptCode	= this.ds_wikCptalList.getColumn(this.ds_wikCptalList.rowposition, "DEPT_CODE");		// 부서코드
			var deptNm		= this.ds_wikCptalList.getColumn(this.ds_wikCptalList.rowposition, "DEPT_NM");			// 부서명
			
			var nLeft    = system.clientToScreenX(this, 0);
			var nTop     = system.clientToScreenY(this, 0);
			var newChild = new ChildFrame;
			newChild.set_openalign("center middle");
			newChild.set_dragmovetype("all");
			newChild.init("wikCauseActionPopup", "absolute", nLeft, nTop, 600, 500, null, null , "mis_acc::ACC020203_P09.xfdl");
			newChild.showModal(this.getOwnerFrame(), {anactKnd:anactKnd, deptCode:deptCode, deptNm:deptNm}, this, "fn_PopupCallback");
		}
		
		if(e.cell==16) {
			var nLeft    = system.clientToScreenX(this, 0);
			var nTop     = system.clientToScreenY(this, 0);
			var newChild = new ChildFrame;
			newChild.set_openalign("center middle");
			newChild.set_dragmovetype("all");
			newChild.init("wikPrmpcPopup", "absolute", nLeft, nTop, 500, 490, null, null , "mis_acc::ACC000000_P02.xfdl");
			newChild.showModal(this.getOwnerFrame(), {year:this.ds_wikCptalList.getColumn(this.ds_wikCptalList.rowposition, "BUDGET_YEAR")}, this, "fn_PopupCallback");
		}		
	}	
}

/*
 * 함수명  	: ds_mnthngCptalList_onrowposchanged
 * 설명 		: 월간계획 행 변경 후 이벤트 처리(월간계획 내역그리드 클릭)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_mnthngCptalList_onrowposchanged();
 */
this.ds_mnthngCptalList_onrowposchanged = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{
	// 데이터셋 클리어
	this.ds_wikCptalList.clearData();
		
	this.fn_searchWikCptalList();
}


/*
 * 함수명  	: ds_mnthngCptalList_canrowposchange
 * 설명 		: 월간계획 행 변경 전 이벤트 처리(월간계획 내역그리드 클릭)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_mnthngCptalList_canrowposchange();
 */
this.ds_mnthngCptalList_canrowposchange = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{
	// 주간계획 변경사항 체크
	if(Ex.util.isUpdated(this.ds_wikCptalList)){
		if ( this.gfn_message("confirm.변경.취소.여부") ) {	        
			return true;
		} else {
			return false;
		}
	}
}

/*
 * 함수명  	: ds_wikCptalList_cancolumnchange
 * 설명 		: 주간 계획 유효성 검사
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_wikCptalList_cancolumnchange();
 */
this.ds_wikCptalList_cancolumnchange = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{   
	if(e.columnid == "PLAN_AMOUNT") {	// 계획금액 검사
		var nDcsnAmt      = obj.getColumn(e.row, "MONTH_DCSN_AMOUNT");
		var nExpndtrAmt   = obj.getColumn(e.row, "MONTH_EXPNDTR_AMOUNT");
		var strAnactKnd   = obj.getColumn(e.row, "ANACT_KND");
		var nBlce         = nDcsnAmt - nExpndtrAmt;
		var nPlanAmt      = e.newvalue;
		
		if(strAnactKnd  == "05"){	// 여입결의서인 경우
			return true;
		}
		
		if(nBlce < nPlanAmt) {
			this.gfn_message("errors.항목값.범위.이하", "계획금액|잔액");
			e.newvalue = nBlce;
			return true;
		}			
	}
	return true;	 
	
}

/*
 * 함수명  	: ds_wikCptalList_cancolumnchange
 * 설명 		: 계획외지출 유효성 검사
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_wikCptalList_cancolumnchange();
 */
this.ds_etcCptalList_cancolumnchange = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	if(e.columnid == "PLAN_AMOUNT") {
	
		var strAnactKnd   = obj.getColumn(e.row, "ANACT_KND");
		
		if(strAnactKnd  == "05"){	// 여입(반납)결의서인 경우
			return true;
		}
		
		if(obj.getColumn(e.row, "EXPNDTR_POSBL") == "0" && obj.getColumn(e.row, "BUDGET_ACNT_SE") != "31" ){
			var nBudgetAmt    = obj.getColumn(e.row, "BUDGET_AMOUNT");
			var nExpndtrAmt   = obj.getColumn(e.row, "EXPNDTR_AMOUNT");
			var nBlce         = nBudgetAmt - nExpndtrAmt;
			var nPlanAmt      = e.newvalue;
		
			if(nBlce < e.newvalue) {	// 잔액을 초과했을 때
				this.gfn_message("errors.항목값.범위.이하", "계획금액|잔액");
				e.newvalue = nBlce;					
				return true;
			}	
		}			
	} 
    return true;	
}

/*
 * 함수명  	: ds_etcCptalList_oncolumnchanged
 * 설명 		: 계획외지출 데이터 변경 후 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_etcCptalList_oncolumnchanged();
 */
this.ds_etcCptalList_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	if(e.columnid == "ANACT_KND") {		// 결의서종류가 변경된 경우 원인행위정보 초기화
	    obj.setColumn(e.row, "CAUSE_ACTION_NO", null);
	}
	
	if(e.columnid == "BUDGET_YEAR") {		// 예산년도가 변경된 경우
	    obj.setColumn(e.row, "BUDGET_ACNT_SE", "");
	    obj.setColumn(e.row, "BUDGET_ACNT_CODE", null);
	    obj.setColumn(e.row, "BUDGET_ACNT_CODE_NM", null);	    
	    obj.setColumn(e.row, "EXPNDTR_UNIT_CODE", null);
	    obj.setColumn(e.row, "BUDGET_AMOUNT", 0);
	    obj.setColumn(e.row, "EXPNDTR_AMOUNT", 0);
	    obj.setColumn(e.row, "PLAN_AMOUNT", null);
	}	
	
	if(e.columnid == "BUDGET_ACNT_SE") {		// 계정구분이 변경된 경우
	    obj.setColumn(e.row, "BUDGET_ACNT_CODE", null);
	    obj.setColumn(e.row, "BUDGET_TAXITM_CODE", null);
	    obj.setColumn(e.row, "BUDGET_ACNT_CODE_NM", null);
	    obj.setColumn(e.row, "BUDGET_TAXITM_CODE_NM", null);	    
	    obj.setColumn(e.row, "EXPNDTR_UNIT_CODE", null);	    
	    obj.setColumn(e.row, "BUDGET_AMOUNT", 0);
	    obj.setColumn(e.row, "EXPNDTR_AMOUNT", 0);
	    obj.setColumn(e.row, "PLAN_AMOUNT", null);
	}	
}

/*
 * 함수명  	: ds_wikCptalList_oncolumnchanged
 * 설명 		: 주간지출계획 데이터 변경 후 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_wikCptalList_oncolumnchanged();
 */
this.ds_wikCptalList_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	if(e.columnid == "ANACT_KND") {		// 결의서종류가 변경된 경우 원인행위정보 초기화
	    obj.setColumn(e.row, "CAUSE_ACTION_NO", null);
	}
}

/*
 * 함수명  	: ds_cond00_oncolumnchanged
 * 설명 		: 검색 데이터셋 컬럼 데이터 변경 이벤트(주차조회)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_cond00_oncolumnchanged();
 */
this.ds_cond00_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	if(e.columnid == "STDR_YY" || e.columnid == "STDR_MT") {		// 년 또는 월 검색조건이 변경 되었을때, 해당되는 주리스트 조회
		if(this.comUtils.isNull(obj.getColumn(0,"STDR_MT")) == false){
			obj.setColumn(obj.rowposition, "PLAN_YM", obj.getColumn(0,"STDR_YY") + obj.getColumn(0,"STDR_MT"));
			this.fn_week();
	    }
	}
}

/*
 * 함수명  	: ds_cond00_oncolumnchanged
 * 설명 		: 년도 변경 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_cond00_oncolumnchanged();
 */
this.div_search_spn_year_onspin = function(obj:Spin, e:nexacro.SpinEventInfo)
{
	this.div_search.cmb_week.setFocus();
}

/*
 * 함수명  	: btn_Close_onclick
 * 설명 		: 닫기 버튼 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_Close_onclick();
 */
this.btn_Close_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.close();
}

]]></Script>
  </Form>
</FDL>
