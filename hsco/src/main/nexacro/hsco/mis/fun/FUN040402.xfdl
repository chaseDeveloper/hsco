<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\default_typedef.xml"/>
  <Form id="FUN040402" classname="FUN040402" left="0" top="0" width="1059" height="735" titletext="수입/지출계획승인" oninit="FUN040402_oninit" onload="FUN040402_onload">
    <Layouts>
      <Layout>
        <Div id="div_work" taborder="1" left="0" top="65" right="28" bottom="0">
          <Layouts>
            <Layout width="1031" height="702">
              <Static id="Static09" taborder="6" text="10" visible="false" left="0" top="0" height="10" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;" right="0"/>
              <Grid id="grd_wikCptalList" taborder="7" binddataset="ds_wikCptalList" autoenter="select" autoupdatetype="itemselect" useinputpanel="false" cellsizingtype="col" autosizingtype="row" oncelldblclick="div_work_tab_cptalPlan_tpg2_Grid00_oncelldblclick" onexpandup="fn_onexpandup" left="1" top="34" right="1" bottom="1" style="cursor:hand;">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="35"/>
                      <Column size="35"/>
                      <Column size="35"/>
                      <Column size="92"/>
                      <Column size="150"/>
                      <Column size="125"/>
                      <Column size="125"/>
                      <Column size="125"/>
                      <Column size="125"/>
                      <Column size="40"/>
                      <Column size="25"/>
                      <Column size="83"/>
                      <Column size="60"/>
                      <Column size="105"/>
                      <Column size="60"/>
                      <Column size="121"/>
                      <Column size="70"/>
                      <Column size="124"/>
                      <Column size="90"/>
                      <Column size="90"/>
                    </Columns>
                    <Rows>
                      <Row size="24" band="head"/>
                      <Row size="24" band="head"/>
                      <Row size="40"/>
                      <Row size="24" band="summ"/>
                    </Rows>
                    <Band id="head">
                      <Cell rowspan="2" text="지출&#13;&#10;등록"/>
                      <Cell col="1" rowspan="2" text="승인&#13;&#10;여부"/>
                      <Cell col="2" rowspan="2" text="지출&#13;&#10;확인"/>
                      <Cell col="3" rowspan="2" text="부서"/>
                      <Cell col="4" rowspan="2" text="적요"/>
                      <Cell col="5" rowspan="2" text="계획금액"/>
                      <Cell col="6" rowspan="2" text="월계획잔액"/>
                      <Cell col="7" rowspan="2" text="주계획잔액"/>
                      <Cell col="8" rowspan="2" text="예산잔액"/>
                      <Cell col="9" colspan="9" text="예산과목"/>
                      <Cell col="18" rowspan="2" text="최초등록자&#13;&#10;최초등록일시"/>
                      <Cell col="19" rowspan="2" text="최종수정자&#13;&#10;최종수정일시"/>
                      <Cell row="1" col="9" text="년도"/>
                      <Cell row="1" col="10" colspan="2" text="계정구분"/>
                      <Cell row="1" col="12" colspan="2" text="예산계정"/>
                      <Cell row="1" col="14" colspan="2" text="사업지구"/>
                      <Cell row="1" col="16" colspan="2" text="지출단위"/>
                    </Band>
                    <Band id="body">
                      <Cell displaytype="checkbox" style="controlborder:1 none #808080 ;" text="bind:EXPNDTR_REGIST" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="1" displaytype="checkbox" edittype="checkbox" style="background2: ;" text="bind:CONFM_AT" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="2" displaytype="checkbox" style="controlborder:1 none #808080 ;" text="bind:EXPNDTR_CNFIRM" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="3" style="align:left;padding:0 0 0 10;color:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);color2:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);" text="bind:DEPT_NM" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="4" edittype="none" style="align:left;color:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);color2:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);" text="bind:RM" editdisplay="edit" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="5" displaytype="number" edittype="none" editfilter="integer" style="align:right;color:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);color2:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);" text="bind:PLAN_AMOUNT" mask="###,###,###,###,###" editdisplay="edit" editlimitbymask="integer" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="6" displaytype="number" style="align:right;color:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);color2:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);" text="bind:M_BLCE" mask="9,999" suppress="0"/>
                      <Cell col="7" displaytype="number" style="align:right;color:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);color2:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);" text="bind:W_BLCE" mask="9,999" suppress="0"/>
                      <Cell col="8" displaytype="number" style="align:right;color:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);color2:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);" expr="expr:BUDGET_AMOUNT-EXPNDTR_AMOUNT" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="9" style="color:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);color2:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);" text="bind:BUDGET_YEAR" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="10" style="color:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);color2:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);" text="bind:BUDGET_ACNT_SE" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="11" displaytype="combo" style="align:left;color:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);color2:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);" text="bind:BUDGET_ACNT_SE" combodataset="ds_acntSe" combocodecol="CODE" combodatacol="CODE_NM" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="12" style="color:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);color2:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);" text="bind:BUDGET_ACNT_CODE" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="13" style="align:left;color:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);color2:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);" text="bind:BUDGET_ACNT_CODE_NM" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="14" style="color:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);color2:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);" text="bind:DETAIL_BSNS_CODE"/>
                      <Cell col="15" style="align:left;color:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);color2:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);" text="bind:BSNS_NM"/>
                      <Cell col="16" style="color:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);color2:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);" text="bind:EXPNDTR_UNIT_CODE" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="17" style="align:left;color:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);color2:EXPR((PLAN_REGIST_AT == 0)?&quot;black&quot;:(M_BLCE &lt; PLAN_AMOUNT)?&quot;red&quot;:&quot;black&quot;);" text="bind:EXPNDTR_UNIT_NM" autosizerow="limitmin" autosizecol="limitmin"/>
                      <Cell col="18" text="expr:REGISTER_EMPNM+'\n('+REGIST_DT+')'"/>
                      <Cell col="19" text="expr:UPDUSR_EMPNM+'\n('+UPDT_DT+')'"/>
                    </Band>
                    <Band id="summary">
                      <Cell/>
                      <Cell col="1"/>
                      <Cell col="2"/>
                      <Cell col="3" displaytype="number" style="align:center;" text="expr:dataset.rowcount"/>
                      <Cell col="4"/>
                      <Cell col="5" displaytype="number" style="align:right;" text="expr:dataset.getSum('PLAN_AMOUNT')"/>
                      <Cell col="6" displaytype="number" style="align:right;" text="expr:dataset.getSum('M_BLCE')"/>
                      <Cell col="7" displaytype="number" style="align:right;" text="expr:dataset.getSum('W_BLCE')"/>
                      <Cell col="8" displaytype="number" style="align:right;" text="expr:dataset.getSum('BUDGET_AMOUNT') - dataset.getSum('EXPNDTR_AMOUNT')"/>
                      <Cell col="9"/>
                      <Cell col="10"/>
                      <Cell col="11"/>
                      <Cell col="12"/>
                      <Cell col="13"/>
                      <Cell col="14"/>
                      <Cell col="15"/>
                      <Cell col="16"/>
                      <Cell col="17"/>
                      <Cell col="18"/>
                      <Cell col="19"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Static id="Static04" taborder="8" text="5" visible="false" left="0" top="29" right="28" height="5" style="background:#dc143c3c;align:center middle;"/>
              <Static id="sta_acntCode" taborder="9" text="수입/지출계획승인 리스트" cssclass="sta_WF_Title02" left="0" top="10" width="174" height="19"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="div_search" taborder="0" left="0" top="0" right="28" height="65" style="padding:0 0 0 0;" cssclass="div_WFSA_Box">
          <Layouts>
            <Layout>
              <Static id="Static00" taborder="52" text="15" visible="false" left="0" top="0" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;" width="15" bottom="0"/>
              <Static id="Static01" taborder="53" text="9" visible="false" left="9" top="0" width="1000" height="5" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="sta_year" taborder="54" text="연도" cssclass="sta_WFSA_Label" left="15" top="5" width="38" height="21"/>
              <Static id="Static03" taborder="55" text="5" visible="false" left="47" top="0" width="5" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;" bottom="0"/>
              <Static id="Static09" taborder="56" text="9" visible="false" left="9" top="26" width="1000" height="11" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Combo id="cmb_week" taborder="2" innerdataset="@ds_week" codecolumn="CODE" datacolumn="CODE_NM" left="265" top="5" width="60" height="21" style="align:center middle;" cssclass="cmb_WF_Essential"/>
              <Static id="sta_week" taborder="58" text="주차" cssclass="sta_WFSA_Label" left="227" top="5" width="38" height="21"/>
              <Static id="Static02" taborder="59" text="5" visible="false" left="260" top="2" width="5" height="34" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="sta_budgetAcntSe" taborder="60" text="계정구분" cssclass="sta_WFSA_Label" left="364" top="5" width="64" height="21"/>
              <Combo id="cmb_month" taborder="1" innerdataset="@ds_month" codecolumn="CODE" datacolumn="CODE_NM" left="162" top="5" width="50" height="21" style="align:center middle;" autoselect="true" cssclass="cmb_WF_Essential"/>
              <Static id="sta_month" taborder="62" text="월" cssclass="sta_WFSA_Label" left="139" top="5" width="22" height="21"/>
              <Static id="Static04" taborder="63" text="5" visible="false" left="157" top="2" width="5" height="34" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Combo id="cmb_budgetAcntSe" taborder="3" innerdataset="@ds_acntSe" codecolumn="CODE" datacolumn="CODE_NM" left="428" top="5" width="124" height="21"/>
              <Static id="Static05" taborder="65" text="5" visible="false" left="423" top="0" width="5" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;" bottom="0"/>
              <Static id="Static06" taborder="66" text="15" visible="false" left="124" top="2" width="15" height="34" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="Static07" taborder="67" text="15" visible="false" left="212" top="2" width="15" height="34" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="Static08" taborder="68" text="15" visible="false" left="325" top="0" width="15" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;" bottom="0"/>
              <Static id="sta_budgetAcntSe00" taborder="69" text="부서" cssclass="sta_WFSA_Label" left="15" top="37" width="38" height="21"/>
              <Div id="div_dept" taborder="4" url="com::deptCode.xfdl" left="52" top="37" width="195" height="21" async="false"/>
              <Static id="Static10" taborder="71" text="15" visible="false" left="780" top="2" width="15" height="34" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="Static12" taborder="74" text="15" visible="false" left="552" top="2" width="15" height="34" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="Static13" taborder="75" text="5" visible="false" left="675" top="2" width="5" height="34" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="sta_month00" taborder="76" text="승인여부" cssclass="sta_WFSA_Label" left="364" top="37" width="64" height="21"/>
              <Combo id="cmb_confmAt" taborder="5" text="전체" codecolumn="codecolumn" datacolumn="datacolumn" index="0" left="428" top="37" width="124" height="21" style="align:left middle;">
                <Dataset id="innerdataset">
                  <ColumnInfo>
                    <Column id="codecolumn" size="256"/>
                    <Column id="datacolumn" size="256"/>
                  </ColumnInfo>
                  <Rows>
                    <Row>
                      <Col id="codecolumn"/>
                      <Col id="datacolumn">전체</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">1</Col>
                      <Col id="datacolumn">승인</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">0</Col>
                      <Col id="datacolumn">미승인</Col>
                    </Row>
                  </Rows>
                </Dataset>
              </Combo>
              <Spin id="spn_year" taborder="0" value="2014" max="9999" min="1000" onspin="div_search_spn_year_onspin" left="52" top="5" width="72" height="21" cssclass="spn_WF_Essential"/>
              <Static id="Static14" taborder="77" text="9" visible="false" left="0" top="58" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;" right="0" height="5"/>
              <Static id="sta_budgetAcntSe01" taborder="78" text="계획등록구분" cssclass="sta_WFSA_Label" left="591" top="5" width="84" height="21"/>
              <Combo id="cmb_budgetAcntSe00" taborder="79" codecolumn="codecolumn" datacolumn="datacolumn" left="680" top="5" width="104" height="21" index="0" text="전체">
                <Dataset id="innerdataset">
                  <ColumnInfo>
                    <Column id="codecolumn" size="256"/>
                    <Column id="datacolumn" size="256"/>
                  </ColumnInfo>
                  <Rows>
                    <Row>
                      <Col id="codecolumn"/>
                      <Col id="datacolumn">전체</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">1</Col>
                      <Col id="datacolumn">등록</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">0</Col>
                      <Col id="datacolumn">미등록</Col>
                    </Row>
                  </Rows>
                </Dataset>
              </Combo>
              <Static id="sta_BUDGET_SE00" taborder="80" text="사업지구" wordwrap="char" cssclass="sta_WFSA_Label" left="592" top="37" width="64" height="21"/>
              <Edit id="edt_bsnsAreaCode" taborder="81" imemode="alpha" inputmode="upper" inputtype="number,english,alpha" lengthunit="utf8" maxlength="7" left="680" top="37" width="104" height="21" onchanged="div_search_edt_bsnsAreaCode_onchanged"/>
              <Button id="btn_bsnsCode" taborder="82" cssclass="btn_WF_Search" left="765" top="37" width="21" height="21" onclick="div_search_btn_bsnsCode_onclick"/>
              <Edit id="edt_BSNS_NM" taborder="83" readonly="true" onkeyup="edt_BSNS_NM_onkeyup" cssclass="edt_WF_Readonly" left="786" top="37" width="218" height="21"/>
            </Layout>
          </Layouts>
          <InitValue/>
        </Div>
        <Static id="Static01" taborder="6" text="28" visible="false" top="0" right="0" bottom="0" width="28" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_mnthngCptalList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" cancolumnchange="ds_mnthngCptalList_cancolumnchange">
        <ColumnInfo>
          <Column id="CONFM_AT" type="STRING" size="256" sumtext="승인여부"/>
          <Column id="EXPNDTR_REGIST_AT" type="STRING" size="256" sumtext="지출등록여부"/>
          <Column id="DEPT_NM" type="STRING" size="256" sumtext="부서명"/>
          <Column id="DEPT_CODE" type="STRING" size="256" sumtext="부서코드"/>
          <Column id="PLAN_YM" type="STRING" size="256" sumtext="계획연월"/>
          <Column id="BUDGET_YEAR" type="STRING" size="256" sumtext="예산년도"/>
          <Column id="BUDGET_ACNT_SE" type="STRING" size="256" sumtext="계정구분"/>
          <Column id="BUDGET_ACNT_CODE" type="STRING" size="256" sumtext="계정코드"/>
          <Column id="BUDGET_ACNT_CODE_NM" type="STRING" size="256" sumtext="계정코드명"/>
          <Column id="EXPNDTR_UNIT_CODE" type="STRING" size="256" sumtext="지출단위코드"/>
          <Column id="EXPNDTR_UNIT_NM" type="STRING" size="256" sumtext="지출단위명"/>
          <Column id="BUDGET_AMOUNT" type="BIGDECIMAL" size="256" sumtext="예산금액"/>
          <Column id="EXPNDTR_AMOUNT" type="BIGDECIMAL" size="256" sumtext="집행금액"/>
          <Column id="BLCE" type="BIGDECIMAL" size="256" sumtext="잔액"/>
          <Column id="PLAN_AMOUNT" type="BIGDECIMAL" size="256" sumtext="계획금액"/>
          <Column id="DCSN_AMOUNT" type="BIGDECIMAL" size="256" sumtext="승인금액"/>
          <Column id="EXPNDTR_POSBL_AT" type="STRING" size="256" sumtext="지출가능여부"/>
          <Column id="WIK_CNT" type="BIGDECIMAL" size="256" sumtext="주간계획 수"/>
          <Column id="REGISTER_ID" type="STRING" size="256"/>
          <Column id="REGIST_DT" type="DATE" size="8"/>
          <Column id="UPDUSR_ID" type="STRING" size="256"/>
          <Column id="UPDT_DT" type="DATE" size="8"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_wikCptalList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" cancolumnchange="ds_wikCptalList_cancolumnchange" oncolumnchanged="ds_wikCptalList_oncolumnchanged">
        <ColumnInfo>
          <Column id="PLAN_YM" type="STRING" size="256" sumtext="계획년월"/>
          <Column id="WEEK_ATMB" type="STRING" size="256" sumtext="주간"/>
          <Column id="SE" type="STRING" size="256" sumtext="주간구분"/>
          <Column id="SN" type="STRING" size="256" sumtext="일련번호"/>
          <Column id="DEPT_CODE" type="STRING" size="256" sumtext="부서코드"/>
          <Column id="DEPT_NM" type="STRING" size="256" sumtext="부서명"/>
          <Column id="BUDGET_ACNT_SE" type="STRING" size="256" sumtext="계정구분"/>
          <Column id="BUDGET_ACNT_CODE" type="STRING" size="256" sumtext="계정코드"/>
          <Column id="BUDGET_ACNT_CODE_NM" type="STRING" size="256" sumtext="계정명"/>
          <Column id="EXPNDTR_UNIT_CODE" type="STRING" size="256" sumtext="지출단위코드"/>
          <Column id="EXPNDTR_UNIT_NM" type="STRING" size="256" sumtext="지출단위명"/>
          <Column id="PLAN_AMOUNT" type="BIGDECIMAL" size="256" sumtext="계획금액"/>
          <Column id="DCSN_AMOUNT" type="BIGDECIMAL" size="256" sumtext="승인금액"/>
          <Column id="BUDGET_AMOUNT" type="BIGDECIMAL" size="256" sumtext="예산(승인)금액"/>
          <Column id="BLCE" type="BIGDECIMAL" size="256" sumtext="월간잔액"/>
          <Column id="EXPNDTR_AMOUNT" type="BIGDECIMAL" size="256" sumtext="월간 집행금액"/>
          <Column id="CONFM_AT" type="STRING" size="256" sumtext="승인여부"/>
          <Column id="EXPNDTR_CNFIRM" type="STRING" size="256" sumtext="지출확인"/>
          <Column id="EXPNDTR_REGIST" type="STRING" size="256" sumtext="지출등록"/>
          <Column id="EXPNDTR_POSBL_AT" type="STRING" size="256" sumtext="지출가능"/>
          <Column id="BUDGET_YEAR" type="STRING" size="256" sumtext="예산년도"/>
          <Column id="ANACT_KND" type="STRING" size="256" sumtext="결의서종류"/>
          <Column id="CAUSE_ACTION_NO" type="STRING" size="256" sumtext="원인행위번호"/>
          <Column id="RM" type="STRING" size="256" sumtext="적요"/>
          <Column id="REGISTER_ID" type="STRING" size="256"/>
          <Column id="REGIST_DT" type="STRING" size="10"/>
          <Column id="UPDUSR_ID" type="STRING" size="256"/>
          <Column id="UPDT_DT" type="STRING" size="10"/>
          <Column id="PRMPC_YEAR" type="STRING" size="256" sumtext="원가년도"/>
          <Column id="PRMPC_CODE" type="STRING" size="256" sumtext="원가코드"/>
          <Column id="ACCNUT_ACNT_NM" type="STRING" size="256" sumtext="원가항목명"/>
          <Column id="MONTH_AT" type="STRING" size="256"/>
          <Column id="DECSN_NO" type="STRING" size="256"/>
          <Column id="M_PLAN_AMOUNT" type="BIGDECIMAL" size="256"/>
          <Column id="M_EXCUT_AM" type="BIGDECIMAL" size="256"/>
          <Column id="M_BLCE" type="BIGDECIMAL" size="256"/>
          <Column id="W_BLCE" type="BIGDECIMAL" size="256"/>
          <Column id="DETAIL_BSNS_CODE" type="STRING" size="256"/>
          <Column id="BSNS_NM" type="STRING" size="256"/>
          <Column id="PLAN_REGIST_AT" type="STRING" size="256"/>
          <Column id="REGISTER_EMPNM" type="STRING" size="256"/>
          <Column id="UPDUSR_EMPNM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_anactKnd" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_emp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="EMPNO" type="STRING" size="256"/>
          <Column id="EMPNM" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="CLSF_CODE" type="STRING" size="256"/>
          <Column id="SALARY_SE" type="STRING" size="256"/>
          <Column id="RSPOFC_SE" type="STRING" size="256"/>
          <Column id="JSSFC_SE" type="STRING" size="256"/>
          <Column id="SRCLS" type="STRING" size="256"/>
          <Column id="ECNY_DE" type="STRING" size="256"/>
          <Column id="ADRES" type="STRING" size="256"/>
          <Column id="TELNO_2" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_acntSe" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_month" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">01</Col>
            <Col id="CODE_NM">01</Col>
          </Row>
          <Row>
            <Col id="CODE">02</Col>
            <Col id="CODE_NM">02</Col>
          </Row>
          <Row>
            <Col id="CODE">03</Col>
            <Col id="CODE_NM">03</Col>
          </Row>
          <Row>
            <Col id="CODE">04</Col>
            <Col id="CODE_NM">04</Col>
          </Row>
          <Row>
            <Col id="CODE">05</Col>
            <Col id="CODE_NM">05</Col>
          </Row>
          <Row>
            <Col id="CODE">06</Col>
            <Col id="CODE_NM">06</Col>
          </Row>
          <Row>
            <Col id="CODE">07</Col>
            <Col id="CODE_NM">07</Col>
          </Row>
          <Row>
            <Col id="CODE">08</Col>
            <Col id="CODE_NM">08</Col>
          </Row>
          <Row>
            <Col id="CODE">09</Col>
            <Col id="CODE_NM">09</Col>
          </Row>
          <Row>
            <Col id="CODE">10</Col>
            <Col id="CODE_NM">10</Col>
          </Row>
          <Row>
            <Col id="CODE">11</Col>
            <Col id="CODE_NM">11</Col>
          </Row>
          <Row>
            <Col id="CODE">12</Col>
            <Col id="CODE_NM">12</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_week" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="THIS_WEEK_NUM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond00" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_cond00_oncolumnchanged">
        <ColumnInfo>
          <Column id="STDR_YY" type="STRING" size="256"/>
          <Column id="STDR_MT" type="STRING" size="256"/>
          <Column id="PLAN_YM" type="STRING" size="256"/>
          <Column id="WEEK_ATMB" type="STRING" size="256"/>
          <Column id="ACNT_SE" type="STRING" size="256"/>
          <Column id="EMPNO" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="CONFM_AT" type="STRING" size="256"/>
          <Column id="PLAN_REGIST_AT" type="STRING" size="256"/>
          <Column id="DETAIL_BSNS_CODE" type="STRING" size="256"/>
          <Column id="BSNS_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_validation" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="compId" type="STRING" size="256"/>
          <Column id="colId" type="STRING" size="256"/>
          <Column id="PK" type="STRING" size="256"/>
          <Column id="notNull" type="STRING" size="256"/>
          <Column id="type" type="STRING" size="256"/>
          <Column id="nlength" type="STRING" size="256"/>
          <Column id="from" type="STRING" size="256"/>
          <Column id="to" type="STRING" size="256"/>
          <Column id="lengthChkGb" type="STRING" size="256"/>
          <Column id="msgId" type="STRING" size="256"/>
          <Column id="expr" type="STRING" size="256"/>
          <Column id="func" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="colId">BUDGET_YEAR</Col>
            <Col id="compId">ds_mnthngCptalList</Col>
            <Col id="msgId">예산년도(월간)</Col>
            <Col id="notNull">Y</Col>
          </Row>
          <Row>
            <Col id="compId">ds_mnthngCptalList</Col>
            <Col id="msgId">계정구분(월간)</Col>
            <Col id="notNull">Y</Col>
            <Col id="colId">BUDGET_ACNT_SE</Col>
          </Row>
          <Row>
            <Col id="compId">ds_mnthngCptalList</Col>
            <Col id="msgId">계정과목(월간)</Col>
            <Col id="notNull">Y</Col>
            <Col id="colId">BUDGET_ACNT_CODE</Col>
          </Row>
          <Row>
            <Col id="compId">ds_mnthngCptalList</Col>
            <Col id="colId">PLAN_AMOUNT</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">계획금액(월간)</Col>
          </Row>
          <Row>
            <Col id="compId">ds_wikCptalList</Col>
            <Col id="colId">PLAN_AMOUNT</Col>
            <Col id="PK">[Undefined]</Col>
            <Col id="notNull">Y</Col>
            <Col id="type">[Undefined]</Col>
            <Col id="nlength">[Undefined]</Col>
            <Col id="from">[Undefined]</Col>
            <Col id="to">[Undefined]</Col>
            <Col id="lengthChkGb">[Undefined]</Col>
            <Col id="msgId">계획금액(주간)</Col>
            <Col id="expr">[Undefined]</Col>
            <Col id="func">[Undefined]</Col>
          </Row>
          <Row>
            <Col id="compId">ds_wikCptalList</Col>
            <Col id="colId">PRMPC_CODE</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">원가항목(주간)</Col>
          </Row>
          <Row>
            <Col id="compId">ds_etcCptalList</Col>
            <Col id="colId">BUDGET_YEAR</Col>
            <Col id="PK">[Undefined]</Col>
            <Col id="notNull">Y</Col>
            <Col id="type">[Undefined]</Col>
            <Col id="nlength">[Undefined]</Col>
            <Col id="from">[Undefined]</Col>
            <Col id="to">[Undefined]</Col>
            <Col id="lengthChkGb">[Undefined]</Col>
            <Col id="msgId">예산년도(계획외)</Col>
            <Col id="expr">[Undefined]</Col>
            <Col id="func">[Undefined]</Col>
          </Row>
          <Row>
            <Col id="compId">ds_etcCptalList</Col>
            <Col id="colId">BUDGET_ACNT_SE</Col>
            <Col id="PK">[Undefined]</Col>
            <Col id="notNull">Y</Col>
            <Col id="type">[Undefined]</Col>
            <Col id="nlength">[Undefined]</Col>
            <Col id="from">[Undefined]</Col>
            <Col id="to">[Undefined]</Col>
            <Col id="lengthChkGb">[Undefined]</Col>
            <Col id="msgId">계정구분(계획외)</Col>
            <Col id="expr">[Undefined]</Col>
            <Col id="func">[Undefined]</Col>
          </Row>
          <Row>
            <Col id="compId">ds_etcCptalList</Col>
            <Col id="colId">BUDGET_ACNT_CODE</Col>
            <Col id="PK">[Undefined]</Col>
            <Col id="notNull">Y</Col>
            <Col id="type">[Undefined]</Col>
            <Col id="nlength">[Undefined]</Col>
            <Col id="from">[Undefined]</Col>
            <Col id="to">[Undefined]</Col>
            <Col id="lengthChkGb">[Undefined]</Col>
            <Col id="msgId">계정과목(계획외)</Col>
            <Col id="expr">[Undefined]</Col>
            <Col id="func">[Undefined]</Col>
          </Row>
          <Row>
            <Col id="compId">ds_etcCptalList</Col>
            <Col id="colId">PLAN_AMOUNT</Col>
            <Col id="PK">[Undefined]</Col>
            <Col id="notNull">Y</Col>
            <Col id="type">[Undefined]</Col>
            <Col id="nlength">[Undefined]</Col>
            <Col id="from">[Undefined]</Col>
            <Col id="to">[Undefined]</Col>
            <Col id="lengthChkGb">[Undefined]</Col>
            <Col id="msgId">계획금액(계획외)</Col>
            <Col id="expr">[Undefined]</Col>
            <Col id="func">[Undefined]</Col>
          </Row>
          <Row>
            <Col id="compId">ds_etcCptalList</Col>
            <Col id="colId">PRMPC_CODE</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">원가항목(계획외)</Col>
          </Row>
          <Row>
            <Col id="compId">ds_cond00</Col>
            <Col id="colId">STDR_YY</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">검색 년도</Col>
          </Row>
          <Row>
            <Col id="colId">STDR_MT</Col>
            <Col id="compId">ds_cond00</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">검색 월</Col>
          </Row>
          <Row>
            <Col id="colId">WEEK_ATMB</Col>
            <Col id="compId">ds_cond00</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">검색 주차</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item5" compid="div_search.cmb_confmAt" propid="value" datasetid="ds_cond00" columnid="CONFM_AT"/>
      <BindItem id="item1" compid="div_search.cmb_month" propid="value" datasetid="ds_cond00" columnid="STDR_MT"/>
      <BindItem id="item2" compid="div_search.cmb_week" propid="value" datasetid="ds_cond00" columnid="WEEK_ATMB"/>
      <BindItem id="item3" compid="div_search.cmb_budgetAcntSe" propid="value" datasetid="ds_cond00" columnid="ACNT_SE"/>
      <BindItem id="item0" compid="div_search.spn_year" propid="value" datasetid="ds_cond00" columnid="STDR_YY"/>
      <BindItem id="item4" compid="div_search.cmb_planRegistAt" propid="value" datasetid="ds_cond00" columnid="ACNT_SE"/>
      <BindItem id="item6" compid="div_search.cmb_budgetAcntSe00" propid="value" datasetid="ds_cond00" columnid="PLAN_REGIST_AT"/>
      <BindItem id="item90" compid="div_search.edt_bsnsAreaCode" propid="value" datasetid="ds_cond00" columnid="DETAIL_BSNS_CODE"/>
      <BindItem id="item13" compid="div_search.edt_BSNS_NM" propid="value" datasetid="ds_cond00" columnid="BSNS_NM"/>
    </Bind>
    <Script type="xscript5.0"><![CDATA[/***********************************************************************
 * 화면ID   : FUN040402
 * 화면명   : 수입/지출계획승인
 * 화면설명 : 월간자금계획, 주간자금계획을 승인 관리
 * 작성일   : 2015.07.24
 * 작성자   : 양성모
 * 수정이력 : 
 ***********************************************************************
 *     수정일     수정자   내용
 ***********************************************************************
 *    
 ***********************************************************************
 */

/***********************************************************************
 * Script Include 
 ***********************************************************************/
// 시스템 공통 라이브러리 Include
include "lib::comInclude.xjs";
include "mis_lib::misUtil.xjs";

/***********************************************************************
 * 화면 변수 선언부
 ***********************************************************************/
this.saveRow1 = -1;
this.saveRow2 = -1;
this.checkDs = [this.ds_mnthngCptalList, this.ds_wikCptalList];

this.arrStrUrl = {
	 "01": "mis_acc::ACC020203_P03.xfdl"	// 여비지출결의서
	,"02": "mis_acc::ACC020203_P02.xfdl"	// 구입과지출결의서
	,"03": "mis_acc::ACC020203_P01.xfdl"	// 지출결의서
	,"04": "mis_acc::ACC020203_P04.xfdl"	// 임차와지출결의서
	,"05": "mis_acc::ACC020203_P05.xfdl"	// 반납결의서
	,"06": "mis_acc::ACC020203_P06.xfdl"	// 공사와집행결의서
	,"07": "mis_acc::ACC020203_P07.xfdl"	// 봉급지출결의서
	,"08": "mis_acc::ACC020203_P08.xfdl"	// 용역과지출결의서
};

/***********************************************************************
 * onInit / onLoad 영역
 ***********************************************************************/
this.FUN040402_oninit = function(obj:Form, e:nexacro.InitEventInfo)
{
	// Form 초기화
	this.fn_init_form();

	// DataSet 초기화
	this.fn_init_dataset();
}

this.FUN040402_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{
	// 검색조건 컴포넌트 초기값 부여
	this.ds_cond00.setColumn(0, "STDR_YY", this.dateUtils.today().substr(0,4));
	this.ds_cond00.setColumn(0, "STDR_MT", this.dateUtils.today().substr(4,2));
	//this.ds_cond00.setColumn(0, "DEPT_CODE", this.gfn_getDeptId());
	//this.ds_cond00.setColumn(0, "DEPT_NM",   this.gfn_getDeptName());
	
	// 데이터셋 동적 바인딩(부서팝업)
	this.div_search.div_dept.fn_setBind("ds_cond00","DEPT_CODE","DEPT_NM");
	
	// 공통코드
	var comboParams = [
		["ds_acntSe", "BDG017", "Y", "A"]	    // 계정구분
	   ,["ds_anactKnd", "ACC002", "Y", "D"]	    // 결의서구분
	];
	var callback = function (svcId, errorCode, errorMsg) {
	
	};
	this.gfn_comboLoad (comboParams, callback);	
}

/***********************************************************************
 * Form/Dataset 오브젝트 초기화
 ***********************************************************************/
 
/*
 * 함수명  	: initForm
 * 설명 		: Form을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initForm();
 */
this.fn_init_form = function()
{
	// 시스템 공통으로 Form을 Initialize 한다.
	this.gfn_initForm(this);
	this.fn_misFormInit(this);
}

/*
 * 함수명  	: initDataset
 * 설명 		: Dataset을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initDataset();
 */
this.fn_init_dataset = function()
{
	this.gfn_initCondDs(this, this.div_search);
}

/***********************************************************************
* Transaction 영역 시작
************************************************************************/

/***********************************************************************
 * Transaction 관련 이벤트 핸들러 
 **********************************************************************/
/*
 * 함수명  	: fn_search
 * 설명 		: 월간, 주간, 계획외지출 등록 내역 조회 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_search();
 */
this.fn_search = function()
{
	// validation 체크
	if(!this.gfn_checkValidation_NoUpdChk(this.ds_cond00, this.ds_validation)) {
		return false;
	}
	
	// 데이터셋 클리어
	this.ds_mnthngCptalList.clearData();
	this.ds_wikCptalList.clearData();
	
	var strYear  = this.ds_cond00.getColumn(0, "STDR_YY");
	var strMonth = this.ds_cond00.getColumn(0, "STDR_MT");
	
	this.ds_cond00.setColumn(0, "PLAN_YM",   strYear+strMonth);

	this.fn_transaction("selectCptalList");
}

/*
 * 함수명  	: fn_save
 * 설명 		: 저장 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_save();
 */
this.fn_save = function()
{
	// 주간, 계획외지출 데이터셋 변경사항 체크
    if(Ex.util.isUpdated(this.ds_mnthngCptalList) || Ex.util.isUpdated(this.ds_wikCptalList)){
		
		this.saveRow1 = this.ds_mnthngCptalList.rowposition;
		this.saveRow2 = this.ds_wikCptalList.rowposition;
	    this.fn_transaction("saveCptalList");
	}else{
		//변경되지 않았을 경우.
		this.gfn_message("comm.데이터.변경.없음");
	}
}

/*
 * 함수명  	: fn_week
 * 설명 		: 년월별 주 조회
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_week();
 */
this.fn_week = function()
{	
	this.ds_week.clearData();
	this.fn_transaction("selectWeek");
}

/**********************************************************************
 * CALL TRANSACTION 영역
 **********************************************************************/
 
/*
 * 함수명  	: fn_transaction
 * 설명 		: Transaction 요청 처리 함수
 * params  		: strSvcId : 서비스요청 ID
 * return Type 	: None
 * 사용법		: this.fn_transaction("SELECT");
 */
this.fn_transaction = function(strSvcId)
{
	switch (strSvcId) {
		case "selectCptalList":          // 월간, 주간, 계획외지출 승인내역 불러오기
			var sController   	= "hsco/mis/fun/FUN040402/selectCptalPlanList.do";
			var sInDatasets   	= "input1=ds_cond00";
			var sOutDatasets  	= "ds_wikCptalList=output1";
			break;
		case "saveCptalList":            // 월간, 주간, 계획외지출 승인내역 저장하기
			var sController   	= "hsco/mis/fun/FUN040402/cptalPlanCUD.do";
			var sInDatasets   	= "input1=ds_mnthngCptalList:U, input2=ds_wikCptalList:U";
			var sOutDatasets  	= "";
			break;
		
		case "selectWeek":           // 년월별 주 조회
			bAsync = false; // None Async
			var sController   	= "hsco/mis/fun/FUN040402/selectWeekList.do";   
			var sInDatasets   	= "input1=ds_cond00";
			var sOutDatasets  	= "ds_week=output1"; 
			break;

	}

	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets); 
}

 /**********************************************************************
 * Transaction Callback 영역
 ***********************************************************************/
 
 /*
 * 함수명  	: fn_callBack
 * 설명 		: Transaction Callback 처리
 * params  		: strSvcId    : 서비스요청 ID
 *                nErrorCode  : 오류 메시지 코드 ([예] 0 : Success, 그밖의 경우, error)
 *                strErrorMsg : 오류 메시지([예]  success.insert|정상적으로 등록되었습니다.)
 * return Type 	: None
 * 사용법		: 
 */
this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg)
{
	
	if (nErrorCode != 0){
	
	} else {
		// 성공 메시지를 보여주는 동작 외에 처리할 내용이 있으면 아래에 기술.
		switch (strSvcId) {
			case "selectCptalList":          // 월간, 주간, 계획외지출 승인내역 불러오기
			    
			    if(this.saveRow1 > -1){
					this.ds_mnthngCptalList.set_rowposition(this.saveRow1);
					this.saveRow1 = -1;
				}
				
				if(this.saveRow2 > -1){
					this.ds_wikCptalList.set_rowposition(this.saveRow2);
					this.saveRow2 = -1;
				}
				
				trace(this.ds_wikCptalList.saveXML());
				break;	
			case "saveCptalList":    // 월간, 주간, 계획외지출 저장하기
			    this.gfn_message("success.처리.성공");
				this.fn_search();
				break;	
			case "selectWeek":          // 년월별 주 조회
				if(this.ds_week.rowcount > 0){
					this.ds_cond00.setColumn(0, "WEEK_ATMB", this.ds_week.getColumn(0, "THIS_WEEK_NUM"));
				} 
				else{
					this.ds_cond00.setColumn(0, "WEEK_ATMB", null);
					this.gfn_message("fail.정보검색.실패", "시스템에 설정된 검색일의 주차 정보를");
				}

				
				break;					
		}
	}
	
	// 오류 및 성공 메시지를 화면에 보여준다.
	this.gfn_callback_message(strSvcId, nErrorCode, strErrorMsg);
	
}

/*
 * 함수명  	: fn_PopupCallback
 * 설명 		: 팝업 콜백함수
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_PopupCallback();
 */
this.fn_PopupCallback = function(sPopupId, sReturn)
{
	if(sPopupId == "CauseActionPopup") {
		var nRow = this.ds_wikCptalList.rowposition;
		this.ds_wikCptalList.setColumn(nRow, "CAUSE_ACTION_NO", sReturn);
	}
	else if(sPopupId == "popBsns") {
		var dsTemp = new Dataset();
		var loadCnt = dsTemp.loadXML(sReturn);
		if(loadCnt) {
			var fbRow    = this.ds_cond00.rowposition;
			var bsnsCode = dsTemp.getColumn(0, "BSNS_CODE");
			var bsnsNm   = dsTemp.getColumn(0, "BSNS_NM");
			
			this.ds_cond00.setColumn(fbRow, "DETAIL_BSNS_CODE", bsnsCode);	// 사업코드
			this.ds_cond00.setColumn(fbRow, "BSNS_NM",   bsnsNm  );	// 사업명
		}
	}
}

/***********************************************************************
* Transaction 영역 끝
************************************************************************/

/***********************************************************************
 * non-Transaction 관련 컴포넌트 이벤트 처리 함수
 ***********************************************************************/

/*
 * 함수명  	: fn_cancel
 * 설명 		: 취소 버튼 이벤트 처리(Dataset 변경 내역 Reset)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_cancel();
 */
this.fn_cancel = function()
{	
	if(this.div_work.tab_cptalPlan.tabindex == 0)    // 월간계획 탭
	{
		if (this.gfn_message("confirm.취소여부")) {
			this.ds_mnthngCptalList.reset();		//DATASET ROLLBACK
			this.ds_mnthngCptalList.applyChange();	//DATASET COMMIT
			return;
		}
	}
	
	if(this.div_work.tab_cptalPlan.tabindex == 1)    // 주간계획, 계획외지출 탭
	{
		if (this.gfn_message("confirm.취소여부")) {
			this.ds_wikCptalList.reset();		//DATASET ROLLBACK
			this.ds_wikCptalList.applyChange();	//DATASET COMMIT
			return;
		}
	}		
}

/***********************************************************************
* 사용자 정의 함수
************************************************************************/

/*
 * 함수명  	: ds_mnthngCptalList_cancolumnchange
 * 설명 		: 월계획 유효성 검사
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_mnthngCptalList_cancolumnchange();
 */
this.ds_mnthngCptalList_cancolumnchange = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	
	if(e.columnid == "CONFM_AT"){
		var dcsnAmt = this.ds_mnthngCptalList.getColumn(this.ds_mnthngCptalList.rowposition, "DCSN_AMOUNT");
		
		if(this.comUtils.isNull(dcsnAmt) || dcsnAmt < 1){
			this.gfn_message("errors.항목값.범위.이상2", "승인금액|0원");
			return false;
		}
	}
	
	if(e.columnid == "DCSN_AMOUNT") {	// 승인금액 검사
	    var nPlanAmt = obj.getColumn(e.row, "PLAN_AMOUNT");
	    
	    if(nPlanAmt < e.newvalue) {		// 계획금액 보다 클 경우
			this.gfn_message("errors.항목값.범위.이하", "승인금액|계획금액");
			e.newvalue = nPlanAmt;
			return true;
	    }
		if(obj.getColumn(e.row, "CONFM_AT") == "1") {	// 승인된 경우
    	    if(e.newvalue < e.oldvalue) {    // 기존 승인 금액보다 감소된 경우
				this.gfn_message("errors.항목값.범위.이상", "승인금액|기존 승인금액");
				return false;
    	    }
		}
	}
	
	if(e.columnid == "PLAN_AMOUNT") {	// 계획금액 검사
	    var nBudgetAmt    = obj.getColumn(e.row, "BUDGET_AMOUNT");
		var nExpndtrAmt   = obj.getColumn(e.row, "EXPNDTR_AMOUNT");
		var nBlce         = nBudgetAmt - nExpndtrAmt;
	    
	    if(obj.getColumn(e.row, "EXPNDTR_POSBL_AT") == "0") {		// 지출가능 부기가 아닐 경우에만 제어
			if(nBlce < e.newvalue) {	// 잔액을 초과했을 때
				this.gfn_message("errors.항목값.범위.이하", "계획금액|잔액");
				return false;
			}
	    }
	    
	    if(obj.getColumn(e.row, "CONFM_AT") == "1") {		// 승인된 경우
			if(e.newvalue < e.oldvalue) {	// 기존 계획금액 보다 감소된 경우
				this.gfn_message("errors.항목값.범위.이상", "승인금액|기존 승인금액");
				return false;
			}
		}
	}
	
	if(e.columnid == "CONFM_AT") {	// 승인취소 검사
		if(e.oldvalue == "1") {
			if(obj.getColumn(e.row, "WIK_CNT") > 0) {
				this.gfn_message("fail.수정.불가", "주계획 자료가 등록되어");
				return false;
			}
		}
	}
    return true;	
}


/*
 * 함수명  	: ds_wikCptalList_cancolumnchange
 * 설명 		: 주계획 유효성 검사
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_wikCptalList_cancolumnchange();
 */
this.ds_wikCptalList_cancolumnchange = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	if(e.columnid == "CONFM_AT") {		// 승인 항목 검사
	    var strCnfirm = obj.getColumn(e.row, "EXPNDTR_CNFIRM");
	    
	    if(strCnfirm == "1") {		// 지출결의서가 등록된 자료 승인취소 불가
			this.gfn_message("fail.수정.불가", "지출 확인된 자료는");
			return false;
	    }
	}
	
	if(e.columnid == "PLAN_AMOUNT") {	// 계획금액 항목 검사
	    
	    if(obj.getColumn(e.row, "SE") == "1") {		// 주간계획일 경우
			var strAnactKnd = obj.getColumn(e.row, "ANACT_KND");
			var nBudgetAmt    = obj.getColumn(e.row, "BUDGET_AMOUNT");
			var nExpndtrAmt   = obj.getColumn(e.row, "EXPNDTR_AMOUNT");
			var nBlce         = nBudgetAmt - nExpndtrAmt;
			
			if(strAnactKnd == "05") {	// 결의서 종류가 여입결의서인 경우 통과
				return true;
			}
			
			if(nBlce < e.newvalue) {	// 잔액을 초과했을 때
				this.gfn_message("errors.항목값.범위.이하", "계획금액|잔액");
				return false;
			}
	    } else {
			if(obj.getColumn(e.row, "EXPNDTR_POSBL_AT") == "0" && obj.getColumn(e.row, "BUDGET_ACNT_SE") != "31" ){
				if(nBlce < e.newvalue) {	// 잔액을 초과했을 때
					this.gfn_message("errors.항목값.범위.이하", "계획금액|잔액");
					return false;
				}	
			}
	    }
	}
	
	if(e.columnid == "DCSN_AMOUNT") {	// 승인금액 검사
	    var nPlanAmt = obj.getColumn(e.row, "PLAN_AMOUNT");
	    
	    if(nPlanAmt < e.newvalue) {		// 계획금액 보다 클 경우
			this.gfn_message("errors.항목값.범위.이하", "승인금액|계획금액");
			e.newvalue = nPlanAmt;
			return true;
	    }
	}	
    return true;	
}


/*
 * 함수명  	: ds_wikCptalList_oncolumnchanged
 * 설명 		: 주계획 컬럼 데이터 변경 후 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_wikCptalList_oncolumnchanged();
 */
this.ds_wikCptalList_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	if(e.columnid == "ANACT_KND") {		// 결의서종류가 변경된 경우 원인행위정보 초기화
	    obj.setColumn(e.row, "CAUSE_ACTION_NO", "");
	}
}


/*
 * 함수명  	: ds_cond00_oncolumnchanged
 * 설명 		: 검색 데이터셋 컬럼 데이터 변경 후 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_cond00_oncolumnchanged();
 */
this.ds_cond00_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	if(e.columnid == "STDR_YY" || e.columnid == "STDR_MT") {		// 년 또는 월 검색조건이 변경 되었을때, 해당되는 주리스트 조회
		if(!this.comUtils.isNull(obj.getColumn(0,"STDR_MT"))){
			obj.setColumn(obj.rowposition, "PLAN_YM", obj.getColumn(0,"STDR_YY") + obj.getColumn(0,"STDR_MT"));
			this.fn_week();
	    }
	}
}


/*
 * 함수명  	: ds_cond00_oncolumnchanged
 * 설명 		: 년도 변경 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_cond00_oncolumnchanged();
 */
this.div_search_spn_year_onspin = function(obj:Spin, e:nexacro.SpinEventInfo)
{
	this.div_search.cmb_week.setFocus();
}

/*
 * 함수명  	: fn_onexpandup
 * 설명 		: 그리드 expand 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_onexpandup();
 */
this.fn_onexpandup = function(obj:Grid, e:nexacro.GridMouseEventInfo)
{
	if(e.cell==17) {				// 원인행위 팝업
		var anactKnd 	= this.ds_wikCptalList.getColumn(this.ds_wikCptalList.rowposition, "ANACT_KND");		// 결의서구분
		var deptCode	= this.ds_wikCptalList.getColumn(this.ds_wikCptalList.rowposition, "DEPT_CODE");		// 부서코드
		var deptNm		= this.ds_wikCptalList.getColumn(this.ds_wikCptalList.rowposition, "DEPT_NM");			// 부서명
		
		var nLeft    = system.clientToScreenX(this, 0);
		var nTop     = system.clientToScreenY(this, 0);
		var newChild = new ChildFrame;
		newChild.set_openalign("center middle");
		newChild.set_dragmovetype("all");
		newChild.init("CauseActionPopup", "absolute", nLeft, nTop, 600, 500, null, null , "mis_acc::ACC020203_P09.xfdl");
		newChild.showModal(this.getOwnerFrame(), {anactKnd:anactKnd, deptCode:deptCode, deptNm:deptNm}, this, "fn_PopupCallback");
	}
}

this.div_work_tab_cptalPlan_tpg2_Grid00_oncelldblclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	var nRow  = this.ds_wikCptalList.rowposition;
	var EXPNDTR_REGIST  = this.ds_wikCptalList.getColumn(nRow, "EXPNDTR_REGIST");
	var CONFM_AT  = this.ds_wikCptalList.getColumn(nRow, "CONFM_AT");
	//alert("EXPNDTR_REGIST = " + EXPNDTR_REGIST + "   CONFM_AT = " + CONFM_AT);
	var ANACT_KND  = this.ds_wikCptalList.getColumn(nRow, "ANACT_KND");
	var DECSN_YEAR  = this.ds_wikCptalList.getColumn(nRow, "BUDGET_YEAR");
	var DECSN_NO  = this.ds_wikCptalList.getColumn(nRow, "DECSN_NO");
	//alert("ANACT_KND = " + ANACT_KND + "   DECSN_YEAR = " + DECSN_YEAR+ "   DECSN_NO = " + DECSN_NO);
	//if(EXPNDTR_REGIST == "1" && CONFM_AT == "0") {
	
		// 결의서 팝업 호출
		var args = {
			  arg_0     : this
			, trgFormId	: "ACC020202"												// 팝업을 호출하는 화면의 ID
			, anactKnd	: ANACT_KND
			, decsnYear	: DECSN_YEAR
			, decsnNo	: DECSN_NO
		};
		this.gfn_popup("expPopup", 903, 842, "결의서", args, this.arrStrUrl[args.anactKnd], "fn_popupCallBack2", true);
		
	//} 
}

this.fn_popupCallBack2 = function(strID, variant)
{
	//this.fn_search();
}

this.div_search_btn_bsnsCode_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	// 사업코드
	var parm = {
		BSNS_GB:1
	};
	this.gfn_popup("popBsns", 500, 500, "사업코드 선택", parm, "pms_prj::popBsns.xfdl", "fn_PopupCallback", true);
}

this.div_search_edt_bsnsAreaCode_onchanged = function(obj:Edit, e:nexacro.ChangeEventInfo)
{
	if(this.comUtils.isNull(e.postvalue)) {
		this.div_search.edt_bsnsAreaCode.set_value("");
		this.div_search.edt_BSNS_NM.set_value("");
	}
}
]]></Script>
  </Form>
</FDL>
