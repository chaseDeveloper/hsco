<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\default_typedef.xml"/>
  <Form id="ACC020203_P03" classname="UI_ACC020203_P03" left="0" top="0" width="902" height="707" titletext="여비지출결의서" onload="ACC020203_P03_onload" scrollbars="none">
    <Layouts>
      <Layout>
        <Tab id="tab" taborder="10" left="14" top="397" height="308" tabindex="0" scrollbars="autoboth" width="875" style="buttonpadding:8 25 8 25;showextrabutton:false;" onchanged="tab_onchanged" preload="true">
          <Tabpages>
            <Tabpage id="tabpage1" text="세부내용">
              <Layouts>
                <Layout width="885" height="269">
                  <Grid id="grd" taborder="0" binddataset="ds_expDsnDetailTrvct" useinputpanel="false" left="0" top="5" width="873" height="126" autofittype="col">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="48"/>
                          <Column size="220"/>
                          <Column size="140"/>
                          <Column size="140"/>
                          <Column size="140"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="순번"/>
                          <Cell col="1" text="영수자"/>
                          <Cell col="2" text="여비총액(A)"/>
                          <Cell col="3" text="법인카드지출액(B)"/>
                          <Cell col="4" text="결의금액(A-B)"/>
                        </Band>
                        <Band id="body">
                          <Cell text="expr:currow+1"/>
                          <Cell col="1" style="align:left middle;padding:0 0 0 5;" text="bind:RCPT_MAN"/>
                          <Cell col="2" displaytype="number" style="align:right middle;padding:0 10 0 0;" text="bind:TOT_AMOUNT"/>
                          <Cell col="3" displaytype="number" style="align:right middle;padding:0 10 0 0;" text="bind:CPR_CARD_AMOUNT"/>
                          <Cell col="4" displaytype="number" style="align:right middle;padding:0 10 0 0;" text="bind:DECSN_AMOUNT"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Div id="div_detail1" taborder="1" left="0" top="104" height="162" cssclass="div_detailBox" width="873">
                    <Layouts>
                      <Layout width="476" height="122">
                        <Static id="Static08" taborder="2" cssclass="sta_WF_Labelbg" left="0" top="82" right="0" height="27"/>
                        <Static id="Static14" taborder="4" cssclass="sta_WF_Labelbg" left="0" top="134" height="27" right="0"/>
                        <Static id="Static27" taborder="1" cssclass="sta_WF_Labelbg" left="0" top="56" height="27" right="0"/>
                        <Static id="Static10" taborder="0" cssclass="sta_WF_Labelbg" left="0" top="30" height="27" right="0"/>
                        <Static id="Static13" taborder="3" cssclass="sta_WF_Labelbg" left="0" top="108" height="27" right="0"/>
                        <Static id="Static00" taborder="5" text="여비총액" cssclass="sta_WF_Label" left="0" top="30" height="27" width="112"/>
                        <Static id="Static03" taborder="14" text="영수일자" cssclass="sta_WF_Label" left="0" top="108" height="27" width="112"/>
                        <Static id="Static05" taborder="16" text="지급은행" cssclass="sta_WF_Label" left="0" top="134" height="27" width="112"/>
                        <Static id="Static07" taborder="7" text="결의금액" cssclass="sta_WF_Label" left="484" top="30" height="27" width="104"/>
                        <Static id="Static09" taborder="15" text="영수자" cssclass="sta_WF_Label" left="226" top="108" height="27" width="104"/>
                        <Static id="Static11" taborder="17" text="계좌번호" cssclass="sta_WF_Label" left="226" top="134" height="27" width="104"/>
                        <Calendar id="cal_rcptDe" taborder="27" left="114" top="111" height="21" width="110" dateformat="yyyy-MM-dd"/>
                        <MaskEdit id="msk_DECSN_AMOUNT" taborder="20" mask="###,###,###,###,###" left="590" top="33" height="21" width="130" maskchar=" " limitbymask="integer" cssclass="msk_WF_Essential"/>
                        <Combo id="cmd_fnncInstt" taborder="29" left="114" top="137" height="21" width="110" innerdataset="@ds_fnncInstt" codecolumn="FNNC_INSTT_CODE" datacolumn="FNNC_INSTT_CODE_NM" cssclass="cmb_WF_Essential"/>
                        <Edit id="edt_acnutno" taborder="30" left="332" top="137" right="331" height="21" maxlength="30" inputtype="number" cssclass="edt_WF_Essential"/>
                        <Edit id="edt_rcptMan" taborder="28" left="332" top="111" height="21" width="170" maxlength="15"/>
                        <Static id="Static02" taborder="6" text="법인카드지출액" cssclass="sta_WF_Label" left="246" top="30" width="104" height="27"/>
                        <MaskEdit id="msk_TOT_AMOUNT" taborder="18" mask="###,###,###,###,###" maskchar=" " left="114" top="33" width="130" height="21" cssclass="msk_WF_Readonly" readonly="true"/>
                        <MaskEdit id="msk_CPR_CARD_AMOUNT" taborder="19" mask="###,###,###,###,###" maskchar=" " left="352" top="33" width="130" height="21" readonly="true" cssclass="msk_WF_Readonly"/>
                        <Static id="Static01" taborder="11" text="여비(일비)" cssclass="sta_WF_Label" left="0" top="82" width="112" height="27"/>
                        <Static id="Static04" taborder="13" text="여비(숙박비)" cssclass="sta_WF_Label" left="484" top="82" width="104" height="27"/>
                        <MaskEdit id="msk_SUM_STAYNG" taborder="26" mask="###,###,###,###,###" maskchar=" " limitbymask="integer" left="590" top="85" width="130" height="21" cssclass="msk_WF_Readonly" readonly="true"/>
                        <Static id="Static06" taborder="12" text="여비(식비)" cssclass="sta_WF_Label" left="246" top="82" width="104" height="27"/>
                        <MaskEdit id="msk_SUM_DAIL" taborder="24" readonly="true" mask="###,###,###,###,###" maskchar=" " cssclass="msk_WF_Readonly" left="114" top="85" width="130" height="21"/>
                        <MaskEdit id="msk_SUM_MAEL" taborder="25" readonly="true" mask="###,###,###,###,###" maskchar=" " cssclass="msk_WF_Readonly" left="352" top="85" width="130" height="21"/>
                        <Static id="Static12" taborder="8" text="여비(현지활동비)" cssclass="sta_WF_Label" left="0" top="56" width="112" height="27"/>
                        <Static id="Static15" taborder="10" text="여비(교통비)" cssclass="sta_WF_Label" left="484" top="56" width="104" height="27"/>
                        <Static id="Static16" taborder="9" text="여비(기타경비)" cssclass="sta_WF_Label" left="246" top="56" width="104" height="27"/>
                        <MaskEdit id="msk_SUM_ACPLC_ACT" taborder="21" readonly="true" mask="###,###,###,###,###" maskchar=" " cssclass="msk_WF_Readonly" left="114" top="59" width="130" height="21"/>
                        <MaskEdit id="msk_SUM_ETC_EXPENS" taborder="22" readonly="true" mask="###,###,###,###,###" maskchar=" " cssclass="msk_WF_Readonly" left="352" top="59" width="130" height="21"/>
                        <MaskEdit id="msk_SUM_TRNSPORT" taborder="23" mask="###,###,###,###,###" maskchar=" " limitbymask="integer" cssclass="msk_WF_Readonly" left="590" top="59" width="130" height="21" readonly="true"/>
                      </Layout>
                    </Layouts>
                  </Div>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage2" text="출장내역">
              <Layouts>
                <Layout>
                  <Grid id="grd_bsrpList" taborder="0" binddataset="ds_bsrpList" useinputpanel="false" left="0" top="5" right="0" bottom="0">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="150"/>
                          <Column size="80"/>
                          <Column size="120"/>
                          <Column size="200"/>
                          <Column size="80"/>
                          <Column size="120"/>
                          <Column size="120"/>
                          <Column size="120"/>
                          <Column size="120"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="순번"/>
                          <Cell col="1" text="부서명"/>
                          <Cell col="2" text="성명"/>
                          <Cell col="3" text="직종(직급)"/>
                          <Cell col="4" text="출장목적"/>
                          <Cell col="5" text="관내여부"/>
                          <Cell col="6" text="목적지"/>
                          <Cell col="7" text="출장시작일시"/>
                          <Cell col="8" text="출장종료일시"/>
                          <Cell col="9" text="출장정산금액"/>
                        </Band>
                        <Band id="body">
                          <Cell style="background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');font:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? 'bold 9 Gulim' : '9 Gulim');selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');selectfont:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? 'bold 9 Gulim' : '9 Gulim');" text="expr:currow + 1"/>
                          <Cell col="1" style="padding:0 0 0 5;background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');font:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? 'bold 9 Gulim' : '9 Gulim');selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');selectfont:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? 'bold 9 Gulim' : '9 Gulim');" text="bind:DEPT_NM"/>
                          <Cell col="2" style="padding:0 0 0 5;background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');font:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? 'bold 9 Gulim' : '9 Gulim');selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');selectfont:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? 'bold 9 Gulim' : '9 Gulim');" text="bind:EMPNM"/>
                          <Cell col="3" style="padding:0 0 0 5;background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');font:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? 'bold 9 Gulim' : '9 Gulim');selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');selectfont:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? 'bold 9 Gulim' : '9 Gulim');" text="bind:JSSFC_CLSF_NM"/>
                          <Cell col="4" style="align:left middle;padding:0 0 0 5;background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');font:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? 'bold 9 Gulim' : '9 Gulim');selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');selectfont:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? 'bold 9 Gulim' : '9 Gulim');" text="bind:BSRP_PURPS"/>
                          <Cell col="5" displaytype="checkbox" style="background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');font:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? 'bold 9 Gulim' : '9 Gulim');selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');selectfont:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? 'bold 9 Gulim' : '9 Gulim');" text="bind:WHTHRC_AT"/>
                          <Cell col="6" style="align:left middle;padding:0 0 0 5;background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');font:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? 'bold 9 Gulim' : '9 Gulim');selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');selectfont:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? 'bold 9 Gulim' : '9 Gulim');" text="bind:DSTN_NM"/>
                          <Cell col="7" displaytype="normal" style="background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');font:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? 'bold 9 Gulim' : '9 Gulim');selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');selectfont:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? 'bold 9 Gulim' : '9 Gulim');" text="bind:BSRP_BEGIN_DT"/>
                          <Cell col="8" displaytype="normal" style="background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');font:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? 'bold 9 Gulim' : '9 Gulim');selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');selectfont:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? 'bold 9 Gulim' : '9 Gulim');" text="bind:BSRP_END_DT" expr="dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '소계' : BSRP_END_DT"/>
                          <Cell col="9" displaytype="number" style="align:right middle;padding:0 5 0 0;background:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');background2:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');font:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? 'bold 9 Gulim' : '9 Gulim');selectbackground:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? '#f6f7ffff' : '');selectfont:EXPR(dataset.getRowType(currow) == Dataset.ROWTYPE_GROUP ? 'bold 9 Gulim' : '9 Gulim');" text="bind:EXCCLC_AMOUNT"/>
                        </Band>
                        <Band id="summary">
                          <Cell/>
                          <Cell col="1"/>
                          <Cell col="2"/>
                          <Cell col="3"/>
                          <Cell col="4"/>
                          <Cell col="5"/>
                          <Cell col="6"/>
                          <Cell col="7"/>
                          <Cell col="8" text="총계"/>
                          <Cell col="9" displaytype="number" style="align:right middle;" text="expr:dataset.getSum(&quot;EXCCLC_AMOUNT&quot;)"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage3" text="교육내역">
              <Layouts>
                <Layout>
                  <Grid id="grd_edcList" taborder="0" binddataset="ds_edcList" useinputpanel="false" left="0" top="5" right="0" bottom="0">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="150"/>
                          <Column size="80"/>
                          <Column size="200"/>
                          <Column size="150"/>
                          <Column size="150"/>
                          <Column size="120"/>
                          <Column size="120"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="120"/>
                          <Column size="120"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="순번"/>
                          <Cell col="1" text="부서명"/>
                          <Cell col="2" text="성명"/>
                          <Cell col="3" text="교육과정명"/>
                          <Cell col="4" text="교육유형"/>
                          <Cell col="5" text="교육분류"/>
                          <Cell col="6" text="교육기관"/>
                          <Cell col="7" text="교육장소"/>
                          <Cell col="8" text="교육시작일"/>
                          <Cell col="9" text="교육종료일"/>
                          <Cell col="10" text="교육품의금액"/>
                          <Cell col="11" text="잔액"/>
                        </Band>
                        <Band id="body">
                          <Cell text="expr:currow+1"/>
                          <Cell col="1" style="padding:0 0 0 5;" text="bind:DEPT_NM"/>
                          <Cell col="2" style="padding:0 0 0 5;" text="bind:EMPNM"/>
                          <Cell col="3" style="align:left middle;padding:0 0 0 5;" text="bind:CRSE_NM"/>
                          <Cell col="4" style="align:left middle;padding:0 0 0 5;" text="bind:EDC_TY_NM" tooltiptext="bind:EDC_TY_NM"/>
                          <Cell col="5" style="align:left middle;padding:0 0 0 5;" text="bind:EDC_CL_NM" tooltiptext="bind:EDC_CL_NM"/>
                          <Cell col="6" style="align:left middle;padding:0 0 0 5;" text="bind:EDC_INSTT" tooltiptext="bind:EDC_INSTT"/>
                          <Cell col="7" style="align:left middle;padding:0 0 0 5;" text="bind:EDC_PLACE" tooltiptext="bind:EDC_PLACE"/>
                          <Cell col="8" displaytype="date" text="bind:EDC_BGNDE" calendardisplaynulltype="none"/>
                          <Cell col="9" displaytype="date" text="bind:EDC_ENDDE" calendardisplaynulltype="none"/>
                          <Cell col="10" displaytype="number" style="align:right middle;padding:0 5 0 0;" text="bind:EDC_CNSUL_AM"/>
                          <Cell col="11" displaytype="number" style="align:right middle;padding:0 5 0 0;" text="bind:BLCE"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage4" text="법인카드">
              <Layouts>
                <Layout>
                  <Grid id="grd_cprCardUseDtls" taborder="0" binddataset="ds_cprCardUseDtls" useinputpanel="false" left="0" top="5" bottom="0" right="0">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="140"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="150"/>
                          <Column size="100"/>
                          <Column size="80"/>
                          <Column size="120"/>
                          <Column size="250"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="순번"/>
                          <Cell col="1" text="사원명"/>
                          <Cell col="2" text="여비구분"/>
                          <Cell col="3" text="카드번호"/>
                          <Cell col="4" text="카드명"/>
                          <Cell col="5" text="업종"/>
                          <Cell col="6" text="가맹점"/>
                          <Cell col="7" text="사용일자"/>
                          <Cell col="8" text="사용시간"/>
                          <Cell col="9" text="사용금액"/>
                          <Cell col="10" text="비고"/>
                        </Band>
                        <Band id="body">
                          <Cell text="expr:currow + 1"/>
                          <Cell col="1" style="align:left middle;padding:0 0 0 5;" text="bind:EMPNM"/>
                          <Cell col="2" displaytype="combo" style="padding:0 0 0 5;" text="bind:BTRPS_SE" combodataset="ds_hrm055" combocodecol="CODE" combodatacol="CODE_NM"/>
                          <Cell col="3" text="bind:CARD_NO" mask="@@@@-@@@@-@@@@-@@@@"/>
                          <Cell col="4" style="align:left middle;padding:0 0 0 5;" text="bind:CARD_NM"/>
                          <Cell col="5" style="align:left middle;padding:0 0 0 5;" text="bind:BRANCHTYPE"/>
                          <Cell col="6" style="align:left middle;padding:0 0 0 5;" text="bind:CHAIN_NM"/>
                          <Cell col="7" displaytype="date" text="bind:USE_DE" calendardisplaynulltype="none"/>
                          <Cell col="8" text="bind:APPR_TIME"/>
                          <Cell col="9" displaytype="number" style="align:right middle;padding:0 5 0 0;" text="bind:USE_AM"/>
                          <Cell col="10" style="align:left middle;padding:0 0 0 5;" text="bind:RM"/>
                        </Band>
                      </Format>
                      <Format id="edc">
                        <Columns>
                          <Column size="40"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="140"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="150"/>
                          <Column size="100"/>
                          <Column size="80"/>
                          <Column size="120"/>
                          <Column size="250"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="순번"/>
                          <Cell col="1" text="사원명"/>
                          <Cell col="2" text="여비구분"/>
                          <Cell col="3" text="카드번호"/>
                          <Cell col="4" text="카드명"/>
                          <Cell col="5" text="업종"/>
                          <Cell col="6" text="가맹점"/>
                          <Cell col="7" text="사용일자"/>
                          <Cell col="8" text="사용시간"/>
                          <Cell col="9" text="사용금액"/>
                          <Cell col="10" text="비고"/>
                        </Band>
                        <Band id="body">
                          <Cell text="expr:currow + 1"/>
                          <Cell col="1" style="align:left middle;padding:0 0 0 5;" text="bind:EMPNM"/>
                          <Cell col="2" displaytype="combo" style="padding:0 0 0 5;" text="bind:EDCCT_SE" combodataset="ds_hrm055" combocodecol="CODE" combodatacol="CODE_NM"/>
                          <Cell col="3" text="bind:CARD_NO" mask="@@@@-@@@@-@@@@-@@@@"/>
                          <Cell col="4" style="align:left middle;padding:0 0 0 5;" text="bind:CARD_NM"/>
                          <Cell col="5" style="align:left middle;padding:0 0 0 5;" text="bind:BRANCHTYPE"/>
                          <Cell col="6" style="align:left middle;padding:0 0 0 5;" text="bind:CHAIN_NM"/>
                          <Cell col="7" displaytype="date" text="bind:USE_DE" calendardisplaynulltype="none"/>
                          <Cell col="8" text="bind:APPR_TIME"/>
                          <Cell col="9" displaytype="number" style="align:right middle;padding:0 5 0 0;" text="bind:USE_AM"/>
                          <Cell col="10" style="align:left middle;padding:0 0 0 5;" text="bind:RM"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage5" text="영수증">
              <Layouts>
                <Layout>
                  <Grid id="grd_rciptUseDtls" taborder="0" binddataset="ds_rcipt" autoenter="select" useinputpanel="false" oncellclick="grd_rciptUseDtls_oncellclick" left="0" top="5" bottom="0" right="0">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="100"/>
                          <Column size="120"/>
                          <Column size="100"/>
                          <Column size="150"/>
                          <Column size="80"/>
                          <Column size="250"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="순번"/>
                          <Cell col="1" text="사원명"/>
                          <Cell col="2" text="여비구분"/>
                          <Cell col="3" text="사용일자"/>
                          <Cell col="4" text="사용금액"/>
                          <Cell col="5" text="첨부파일"/>
                          <Cell col="6" text="비고"/>
                        </Band>
                        <Band id="body">
                          <Cell text="expr:currow + 1"/>
                          <Cell col="1" cssclass="Cellgrd_WF_AlignLeft" text="bind:EMPNM"/>
                          <Cell col="2" displaytype="combo" cssclass="Cellgrd_WF_AlignLeft" text="bind:BTRPS_SE" combodataset="ds_hrm055" combocodecol="CODE" combodatacol="CODE_NM"/>
                          <Cell col="3" displaytype="date" text="bind:USE_DE" calendardisplaynulltype="none"/>
                          <Cell col="4" displaytype="number" cssclass="Cellgrd_WF_AlignRight" text="bind:USE_AM" mask="###,###,###,###,###"/>
                          <Cell col="5" displaytype="expr:FILE_CNT == '0' ? 'none' :  'button'" text="다운로드"/>
                          <Cell col="6" cssclass="Cellgrd_WF_AlignLeft" text="bind:RM" calendardisplaynulltype="default"/>
                        </Band>
                      </Format>
                      <Format id="edc">
                        <Columns>
                          <Column size="40"/>
                          <Column size="100"/>
                          <Column size="120"/>
                          <Column size="100"/>
                          <Column size="150"/>
                          <Column size="80"/>
                          <Column size="250"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="순번"/>
                          <Cell col="1" text="사원명"/>
                          <Cell col="2" text="여비구분"/>
                          <Cell col="3" text="사용일자"/>
                          <Cell col="4" text="사용금액"/>
                          <Cell col="5" text="첨부파일"/>
                          <Cell col="6" text="비고"/>
                        </Band>
                        <Band id="body">
                          <Cell text="expr:currow + 1"/>
                          <Cell col="1" cssclass="Cellgrd_WF_AlignLeft" text="bind:EMPNM"/>
                          <Cell col="2" displaytype="combo" cssclass="Cellgrd_WF_AlignLeft" text="bind:EDCCT_SE" combodataset="ds_hrm055" combocodecol="CODE" combodatacol="CODE_NM"/>
                          <Cell col="3" displaytype="date" text="bind:USE_DE" calendardisplaynulltype="none"/>
                          <Cell col="4" displaytype="number" cssclass="Cellgrd_WF_AlignRight" text="bind:USE_AM" mask="###,###,###,###,###"/>
                          <Cell col="5" displaytype="expr:FILE_CNT == '0' ? 'none' :  'button'" text="다운로드"/>
                          <Cell col="6" cssclass="Cellgrd_WF_AlignLeft" text="bind:RM" calendardisplaynulltype="default"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage6" text="정액지급">
              <Layouts>
                <Layout>
                  <Grid id="grd_fxamtPymnt" taborder="0" binddataset="ds_fxamtPymnt" autoenter="select" useinputpanel="false" left="0" top="5" bottom="0" right="0">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="100"/>
                          <Column size="120"/>
                          <Column size="100"/>
                          <Column size="150"/>
                          <Column size="500"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="순번"/>
                          <Cell col="1" text="사원명"/>
                          <Cell col="2" text="여비구분"/>
                          <Cell col="3" text="사용일자"/>
                          <Cell col="4" text="사용액"/>
                          <Cell col="5" text="비고"/>
                        </Band>
                        <Band id="body">
                          <Cell text="expr:currow + 1"/>
                          <Cell col="1" cssclass="Cellgrd_WF_AlignLeft" text="bind:EMPNM"/>
                          <Cell col="2" displaytype="combo" cssclass="Cellgrd_WF_AlignLeft" text="bind:BTRPS_SE" combodataset="ds_hrm055" combocodecol="CODE" combodatacol="CODE_NM"/>
                          <Cell col="3" displaytype="date" text="bind:USE_DE" calendardisplaynulltype="none"/>
                          <Cell col="4" displaytype="number" cssclass="Cellgrd_WF_AlignRight" text="bind:USE_AM" mask="###,###,###,###,###"/>
                          <Cell col="5" cssclass="Cellgrd_WF_AlignLeft" text="bind:RM" editlimit="450" editlengthunit="utf8"/>
                        </Band>
                      </Format>
                      <Format id="edc">
                        <Columns>
                          <Column size="40"/>
                          <Column size="100"/>
                          <Column size="120"/>
                          <Column size="100"/>
                          <Column size="150"/>
                          <Column size="500"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="순번"/>
                          <Cell col="1" text="사원명"/>
                          <Cell col="2" text="여비구분"/>
                          <Cell col="3" text="사용일자"/>
                          <Cell col="4" text="사용액"/>
                          <Cell col="5" text="비고"/>
                        </Band>
                        <Band id="body">
                          <Cell text="expr:currow + 1"/>
                          <Cell col="1" cssclass="Cellgrd_WF_AlignLeft" text="bind:EMPNM"/>
                          <Cell col="2" displaytype="combo" cssclass="Cellgrd_WF_AlignLeft" text="bind:EDCCT_SE" combodataset="ds_hrm055" combocodecol="CODE" combodatacol="CODE_NM"/>
                          <Cell col="3" displaytype="date" text="bind:USE_DE" calendardisplaynulltype="none"/>
                          <Cell col="4" displaytype="number" cssclass="Cellgrd_WF_AlignRight" text="bind:USE_AM" mask="###,###,###,###,###"/>
                          <Cell col="5" cssclass="Cellgrd_WF_AlignLeft" text="bind:RM" editlimit="450" editlengthunit="utf8"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Div id="div_detail1" taborder="5" left="432" top="104" cssclass="div_detailBox" height="289" width="447">
          <Layouts>
            <Layout width="476" height="122">
              <Static id="Static32" taborder="89" cssclass="sta_WF_Labelbg" left="0" top="261" right="0" height="27"/>
              <Static id="Static13" taborder="66" cssclass="sta_WF_Labelbg" left="0" top="182" right="0" height="27"/>
              <Static id="Static17" taborder="67" cssclass="sta_WF_Labelbg" left="0" top="156" right="0" height="27"/>
              <Static id="Static18" taborder="68" cssclass="sta_WF_Labelbg" left="0" top="130" right="0" height="27"/>
              <Static id="Static27" taborder="58" cssclass="sta_WF_Labelbg" left="0" top="0" height="27" right="0"/>
              <Static id="Static10" taborder="61" cssclass="sta_WF_Labelbg" left="0" top="26" height="27" right="0"/>
              <Static id="Static14" taborder="62" cssclass="sta_WF_Labelbg" left="0" top="52" height="27" right="0"/>
              <Static id="Static15" taborder="63" cssclass="sta_WF_Labelbg" left="0" top="104" height="27" right="0"/>
              <Static id="Static16" taborder="64" cssclass="sta_WF_Labelbg" left="0" top="78" height="27" right="0"/>
              <Static id="Static00" taborder="0" text="발의일자" left="0" top="0" height="27" cssclass="sta_WF_Label" width="104"/>
              <Static id="Static02" taborder="2" text="원인행위일자" cssclass="sta_WF_Label" left="0" top="26" height="27" wordwrap="char" width="104"/>
              <Calendar id="cal_itncDe" taborder="35" left="106" top="3" height="21" style="align:center;" width="100" dateformat="yyyy-MM-dd" value="null"/>
              <Calendar id="cal_causeActionDe" taborder="38" left="106" top="29" width="100" height="21" style="align:center;" dateformat="yyyy-MM-dd"/>
              <Static id="Static05" taborder="40" text="개산일자" cssclass="sta_WF_Label" left="0" top="104" width="104" height="27"/>
              <Static id="Static06" taborder="41" text="지급발의일자" cssclass="sta_WF_Label" left="0" top="130" width="104" height="27"/>
              <Static id="Static07" taborder="42" text="지출예산통제" cssclass="sta_WF_Label" left="0" top="156" width="104" height="27"/>
              <Static id="Static08" taborder="43" text="자금지출부등기" cssclass="sta_WF_Label" left="0" top="182" width="104" height="27" onclick="div_detail1_Static08_onclick"/>
              <Calendar id="cal_expectDe" taborder="47" left="106" top="107" width="100" height="21" style="align:center;" dateformat="yyyy-MM-dd"/>
              <Calendar id="cal_pymntItncDe" taborder="48" left="106" top="133" width="100" height="21" style="align:center;" dateformat="yyyy-MM-dd"/>
              <Calendar id="cal_expndtrBudgetCnrlDe" taborder="49" left="106" top="159" width="100" height="21" style="align:center;" dateformat="yyyy-MM-dd"/>
              <Calendar id="cal_cptalExpndtrAcntbkDe" taborder="50" left="106" top="185" width="100" height="21" style="align:center;" dateformat="yyyy-MM-dd"/>
              <Static id="Static01" taborder="53" text="원인행위번호" wordwrap="char" cssclass="sta_WF_Label" left="0" top="52" width="104" height="27"/>
              <Edit id="Edit01" taborder="54" left="106" top="55" width="100" height="21" cssclass="edt_WF_Readonly" readonly="true"/>
              <Static id="Static03" taborder="3" text="채무확정일자" cssclass="sta_WF_Label" left="0%" top="78" height="27" width="104"/>
              <Calendar id="cal_detDcsnDe" taborder="45" left="106" top="81" width="100" height="21" style="align:center;" dateformat="yyyy-MM-dd"/>
              <Static id="Static04" taborder="69" text="정산금액" cssclass="sta_WF_Label" left="208" top="26" width="84" height="27"/>
              <Static id="Static09" taborder="70" text="지출계좌" cssclass="sta_WF_Label" left="208" top="156" width="84" height="53"/>
              <Static id="Static11" taborder="71" text="사업지구" wordwrap="char" cssclass="sta_WF_Label" left="208" top="104" width="84" height="53"/>
              <Static id="Static12" taborder="72" text="지급번호" cssclass="sta_WF_Label" left="208" top="78" width="84" height="27"/>
              <Static id="Static19" taborder="73" text="결의금액" cssclass="sta_WF_Label" left="208" top="52" width="84" height="27"/>
              <Static id="Static20" taborder="74" text="개산금액" cssclass="sta_WF_Label" left="208" top="0" width="84" height="27"/>
              <Button id="btn_bsnsPopup" taborder="75" onclick="fn_popup_onclick" cssclass="btn_WF_Search" enable="false" visible="false" left="269" top="119" width="21" height="21"/>
              <Button id="btn_branchAcnut" taborder="76" onclick="fn_popup_onclick" cssclass="btn_WF_Search" left="269" top="171" width="21" height="21"/>
              <MaskEdit id="msk_caActAmt00" taborder="77" readonly="true" mask="###,###,###,###,###" maskchar=" " limitbymask="integer" cssclass="msk_WF_Readonly" left="294" top="3" width="150" height="21"/>
              <MaskEdit id="msk_caActAmt01" taborder="78" readonly="true" mask="###,###,###,###,###" maskchar=" " limitbymask="integer" cssclass="msk_WF_Readonly" left="294" top="29" width="150" height="21"/>
              <MaskEdit id="msk_caActAmt03" taborder="79" readonly="true" mask="###,###,###,###,###" maskchar=" " limitbymask="integer" cssclass="msk_WF_Readonly" left="294" top="55" width="150" height="21"/>
              <Edit id="Edit00" taborder="80" readonly="true" cssclass="edt_WF_Essential" left="294" top="185" width="150" height="21" style="font:9 Gulim;"/>
              <Combo id="cmb_fnccInsttCode" taborder="81" readonly="true" innerdataset="@ds_fnncInstt" codecolumn="FNNC_INSTT_CODE" datacolumn="FNNC_INSTT_CODE_NM" cssclass="cmb_WF_Readonly" left="294" top="159" width="150" height="21"/>
              <Edit id="Edit02" taborder="82" readonly="true" cssclass="edt_WF_Readonly" left="294" top="81" width="150" height="21"/>
              <TextArea id="TextArea00" taborder="83" scrollbars="none" wordwrap="char" cssclass="txt_WF_Readonly" left="294" top="107" width="150" height="47"/>
              <Static id="Static21" taborder="84" cssclass="sta_WF_Labelbg" left="0" top="208" right="0" height="54"/>
              <Static id="Static22" taborder="85" text="적요" wordwrap="char" cssclass="sta_WF_Label" left="0" top="208" width="104" height="54" style="align:left;"/>
              <TextArea id="txt_sumry" taborder="86" wordwrap="char" cssclass="txt_WF_Essential" left="106" top="211" width="338" height="48"/>
              <Static id="Static24" taborder="87" text="수정요청 내용" cssclass="sta_WF_Label" left="0" top="261" width="104" height="27"/>
              <Edit id="edt_expndrUpdtReqCn" taborder="88" left="106" top="264" width="338" height="21"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="div_detail2" taborder="4" left="15" top="104" height="234" cssclass="div_detailBox" width="409">
          <Layouts>
            <Layout>
              <Static id="Static13" taborder="90" cssclass="sta_WF_Labelbg" left="0" top="52" right="0" height="27"/>
              <Static id="Static07" taborder="78" cssclass="sta_WF_Labelbg" left="0" top="130" height="27" right="0"/>
              <Static id="Static27" taborder="77" cssclass="sta_WF_Labelbg" left="0" top="0" height="27" right="0"/>
              <Static id="Static03" taborder="84" cssclass="sta_WF_Labelbg" left="0" top="78" height="27" right="0"/>
              <Static id="Static09" taborder="85" cssclass="sta_WF_Labelbg" left="0" top="104" height="27" right="0"/>
              <Static id="Static10" taborder="86" cssclass="sta_WF_Labelbg" left="0" top="26" height="27" right="0"/>
              <Static id="Static01" taborder="17" text="예산계정" cssclass="sta_WF_Label" left="0" top="52" height="53" width="80"/>
              <Static id="Static02" taborder="18" text="부기" wordwrap="char" cssclass="sta_WF_Label" left="0" top="104" height="53" width="80"/>
              <Edit id="edt_bukipCode" taborder="54" left="82" top="107" height="21" width="120" cssclass="edt_WF_Essential" readonly="true"/>
              <Edit id="Edit01" taborder="55" left="82" top="133" height="21" width="324" cssclass="edt_WF_Readonly" readonly="true"/>
              <Edit id="Edit04" taborder="57" left="82" top="55" height="21" width="120" cssclass="edt_WF_Readonly" readonly="true"/>
              <Static id="Static04" taborder="61" text="결의번호" cssclass="sta_WF_Label" left="0" top="0" width="80" height="27"/>
              <Edit id="Edit02" taborder="65" left="82" top="81" width="324" height="21" cssclass="edt_WF_Readonly" readonly="true"/>
              <Edit id="Edit05" taborder="68" left="82" top="3" width="120" height="21" cssclass="edt_WF_Readonly" readonly="true"/>
              <MaskEdit id="msk_caActAmt" taborder="69" mask="###,###,###,###,###" left="286" top="55" width="120" height="21" cssclass="msk_WF_Readonly" readonly="true" maskchar=" " limitbymask="integer"/>
              <Static id="Static05" taborder="70" text="배정잔액" cssclass="sta_WF_Label" left="204" top="52" width="80" height="27"/>
              <Static id="Static06" taborder="71" text="부기잔액" cssclass="sta_WF_Label" left="204" top="104" width="80" height="27"/>
              <MaskEdit id="msk_caActAmt00" taborder="72" mask="###,###,###,###,###" left="286" top="107" width="120" height="21" cssclass="msk_WF_Readonly" readonly="true" maskchar=" " limitbymask="integer"/>
              <Static id="Static00" taborder="80" text="예산구분" cssclass="sta_WF_Label" left="0" top="26" width="80" height="27"/>
              <Combo id="Combo01" taborder="81" readonly="true" innerdataset="@ds_bdg001" codecolumn="CODE" datacolumn="CODE_NM" cssclass="cmb_WF_Readonly" left="82" top="29" width="120" height="21"/>
              <Static id="Static17" taborder="91" cssclass="sta_WF_Labelbg" left="79" top="182" right="165" height="27"/>
              <Static id="Static08" taborder="92" text="거래유형" cssclass="sta_WF_Label" left="0" top="156" width="80" height="27"/>
              <Static id="Static14" taborder="93" text="차변" cssclass="sta_WF_Label" left="79" top="156" width="165" height="27" style="align:center middle;"/>
              <Static id="Static16" taborder="94" text="대변" cssclass="sta_WF_Label" left="243" top="156" width="166" height="27" style="align:center middle;"/>
              <Static id="Static18" taborder="95" cssclass="sta_WF_Labelbg" left="0" top="182" right="329" height="27"/>
              <Edit id="Edit03" taborder="96" readonly="true" cssclass="edt_WF_Readonly" left="82" top="185" width="159" height="21"/>
              <Static id="Static19" taborder="97" cssclass="sta_WF_Labelbg" left="243" top="182" right="0" height="27"/>
              <Edit id="Edit06" taborder="98" readonly="true" cssclass="edt_WF_Readonly" left="246" top="185" width="160" height="21"/>
              <Static id="Static20" taborder="99" cssclass="sta_WF_Labelbg" left="79" top="207" right="165" height="27"/>
              <Static id="Static21" taborder="100" cssclass="sta_WF_Labelbg" left="0" top="207" right="329" height="27"/>
              <Edit id="Edit07" taborder="101" readonly="true" cssclass="edt_WF_Readonly" left="82" top="210" width="159" height="21"/>
              <Static id="Static22" taborder="102" cssclass="sta_WF_Labelbg" left="243" top="207" right="0" height="27"/>
              <Edit id="Edit08" taborder="103" readonly="true" cssclass="edt_WF_Readonly" left="246" top="210" width="160" height="21"/>
              <Button id="btn_atmcJrnlzTy" taborder="104" onclick="fn_popup_onclick" cssclass="btn_WF_Search" left="59" top="159" width="21" height="21"/>
              <Edit id="Edit09" taborder="105" readonly="true" cssclass="edt_WF_Readonly" left="3" top="185" width="74" height="21" value="채무확정"/>
              <Edit id="Edit10" taborder="106" readonly="true" cssclass="edt_WF_Readonly" left="3" top="210" width="74" height="21" value="지급"/>
              <Button id="btn_budgetAcntPopup" taborder="108" onclick="fn_popup_onclick" cssclass="btn_WF_Search" left="181" top="107" width="21" height="21"/>
              <Combo id="cmb_CYFD_SE" taborder="109" readonly="false" innerdataset="ds_acc046" codecolumn="CODE" datacolumn="CODE_NM" left="204" top="29" width="66" height="21"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static06" taborder="11" text="15" visible="false" left="0" top="0" width="903" height="15" style="background:#dc143c3c;align:center middle;"/>
        <Static id="Static05" taborder="12" text="15" visible="false" left="0" top="0" bottom="0" width="15" style="background:#1b3cd23c;align:center middle;"/>
        <Static id="Static01" taborder="13" text="15" visible="false" top="0" bottom="0" style="background:#1b3cd23c;align:center middle;" right="0" width="15"/>
        <Button id="btn_save" taborder="1" text="저장" onclick="fn_save" cssclass="btn_WF_CRUD" top="15" right="68" width="50" height="25"/>
        <Button id="btn_close2" taborder="2" text="종료" onclick="fn_close" cssclass="btn_WF_CRUD" top="15" right="15" width="50" height="25"/>
        <Static id="sta_title" taborder="14" text="여비지출결의서" cssclass="sta_WF_Title01" left="17" top="17" width="197" height="21"/>
        <Static id="Static07" taborder="15" text="10" visible="false" left="0" top="78" width="903" height="10" style="background:#dc143c3c;align:center middle;"/>
        <Static id="Static12" taborder="16" text="5" visible="false" left="0" top="40" width="903" height="5" style="background:#dc143c3c;align:center middle;"/>
        <Div id="div_search" taborder="3" left="15" top="45" right="15" height="33" cssclass="div_WFSA_Box">
          <Layouts>
            <Layout>
              <Static id="Static16" taborder="18" text="부서" cssclass="sta_WFSA_Label" left="169" top="5" width="38" height="21"/>
              <Div id="div_dept" taborder="19" url="com::deptCode.xfdl" left="212" top="5" width="195" height="22" async="false"/>
              <Static id="Static00" taborder="20" text="회계년도" cssclass="sta_WFSA_Label" left="15" top="5" width="64" height="21"/>
              <Spin id="Spin02" taborder="21" value="0" readonly="true" cssclass="spn_WF_Readonly" left="84" top="5" width="70" height="21" style="align:center middle;"/>
              <Static id="sta_sanctn" taborder="24" text="결재상태" cssclass="sta_WFSA_Label" visible="true" left="677" top="5" right="133" height="21"/>
              <Combo id="cmb_sanctn" taborder="25" readonly="true" innerdataset="@ds_com022" codecolumn="CODE" datacolumn="CODE_NM" cssclass="cmb_WF_Readonly" visible="true" left="748" top="5" height="21" width="112"/>
              <Static id="sta_bizplc" taborder="26" text="사업소" cssclass="sta_WFSA_Label" left="424" top="5" width="51" height="21" visible="false"/>
              <Edit id="edt_bizplc" taborder="27" left="475" top="5" width="160" height="22" readonly="true" cssclass="edt_WF_Readonly" visible="false"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static31" taborder="17" text="계정정보" cssclass="sta_WF_Title02" left="15" top="84" width="130" height="21"/>
        <Static id="Static08" taborder="18" text="5" visible="false" left="0" top="99" width="903" height="5" style="background:#dc143c3c;align:center middle;"/>
        <Static id="Static02" taborder="20" text="지출결의정보" cssclass="sta_WF_Title02" left="432" top="84" width="130" height="21"/>
        <Static id="Static15" taborder="27" text="15" visible="false" left="0" width="903" height="15" style="background:#dc143c3c;align:center middle;" bottom="0"/>
        <Button id="btn_sanctn" taborder="36" text="결재" onclick="fn_sanction" cssclass="btn_WF_CRUD" top="15" right="121" height="25" visible="true" width="50" enable="true"/>
        <Button id="btn_add" taborder="38" text="행추가" onclick="btn_add_onclick" cssclass="btn_WF_Gridadd" left="690" top="404" right="148" height="19"/>
        <Button id="btn_del" taborder="39" text="행삭제" onclick="btn_del_onclick" cssclass="btn_WF_Griddel" left="756" top="404" right="80" height="19"/>
        <Button id="btn_reset" taborder="40" text="행취소" onclick="btn_reset_onclick" cssclass="btn_WF_Gridcnl" left="823" top="404" right="13" height="19"/>
        <Button id="btn_rciptDown" taborder="51" text="영수증 받기(일괄)" top="404" right="14" height="19" width="104" style="border:1 solid #b5b5b5ff ;padding:3 0 0 0;font:-11 Dotum;" onclick="btn_rciptDown_onclick" visible="false"/>
        <Static id="sta_msg" taborder="52" text="(해당 지출 담당자 승인 후에 전자결재 상신이 가능합니다)" visible="false" left="404" top="19" width="317" height="21" style="color:blue;"/>
        <Static id="Static00" taborder="53" text="5" visible="false" left="0" top="392" width="903" height="5" style="background:#dc143c3c;align:center middle;"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_expDsnMastr" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_expDsnMastr_oncolumnchanged" cancolumnchange="ds_expDsnMastr_cancolumnchange">
        <ColumnInfo>
          <Column id="DECSN_YEAR" type="STRING" size="4"/>
          <Column id="DECSN_NO" type="STRING" size="10"/>
          <Column id="CAUSE_ACTION_NO" type="STRING" size="10"/>
          <Column id="BUDGET_YEAR" type="STRING" size="4"/>
          <Column id="BSNS_SE" type="STRING" size="1"/>
          <Column id="BALC_SE" type="STRING" size="1"/>
          <Column id="BUDGET_ACNT_CODE" type="STRING" size="8"/>
          <Column id="BUDGET_ACNT_NM" type="STRING" size="256"/>
          <Column id="ANACT_KND" type="STRING" size="2"/>
          <Column id="DEPT_CODE" type="STRING" size="6"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="CYFD_SE" type="STRING" size="1"/>
          <Column id="ITNC_DE" type="STRING" size="8"/>
          <Column id="PYMNT_ITNC_DE" type="STRING" size="8"/>
          <Column id="DET_DCSN_DE" type="STRING" size="8"/>
          <Column id="PRMPC_JRNLZPR_RGIST_DE" type="STRING" size="8"/>
          <Column id="CPTAL_EXPNDTR_ACNTBK_DE" type="STRING" size="8"/>
          <Column id="EXPNDTR_BUDGET_CNRL_DE" type="STRING" size="8"/>
          <Column id="CAUSE_ACTION_DE" type="STRING" size="8"/>
          <Column id="DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="BUDGET_ACNT_BLCE" type="BIGDECIMAL" size="22"/>
          <Column id="EXPNDTR_UNIT_CODE" type="STRING" size="8"/>
          <Column id="EXPNDTR_UNIT_NM" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_CODE_BLCE" type="BIGDECIMAL" size="22"/>
          <Column id="CPTAL_CHRG_CONFM" type="STRING" size="1"/>
          <Column id="TIMHDER_CONFM" type="STRING" size="1"/>
          <Column id="CNTRCT_NO" type="STRING" size="11"/>
          <Column id="FNNC_INSTT_CODE" type="STRING" size="3"/>
          <Column id="ACNUTNO" type="STRING" size="20"/>
          <Column id="SUMRY" type="STRING" size="200"/>
          <Column id="BSNS_CODE" type="STRING" size="5"/>
          <Column id="BSNS_NM" type="STRING" size="256"/>
          <Column id="PRMPC_YEAR" type="STRING" size="256"/>
          <Column id="PRMPC_CODE" type="STRING" size="6"/>
          <Column id="PRMPC_NM" type="STRING" size="256"/>
          <Column id="REGISTER_ID" type="STRING" size="12"/>
          <Column id="REGIST_DT" type="STRING" size="8"/>
          <Column id="UPDUSR_ID" type="STRING" size="12"/>
          <Column id="UPDT_DT" type="DATE" size="7"/>
          <Column id="EXPNDTR_CNFIRM_AT" type="STRING" size="2"/>
          <Column id="ATMC_JRNLZ_TY_CODE" type="STRING" size="256"/>
          <Column id="GNRL_DEBTOR_ACNT_NM" type="STRING" size="256"/>
          <Column id="GNRL_CRDIT_ACNT_NM" type="STRING" size="256"/>
          <Column id="SETOFF_DEBTOR_ACNT_NM" type="STRING" size="256"/>
          <Column id="SETOFF_CRDIT_ACNT_NM" type="STRING" size="256"/>
          <Column id="FILE_SN" type="STRING" size="256"/>
          <Column id="CHECK_NO" type="STRING" size="256"/>
          <Column id="SANCTN_NO" type="STRING" size="256"/>
          <Column id="SANCTN_SE" type="STRING" size="256"/>
          <Column id="LAST_SANCTN_STTUS" type="STRING" size="256"/>
          <Column id="INC_EXP_AT" type="STRING" size="256"/>
          <Column id="CPTAL_DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="DRFT_APPRID" type="STRING" size="256"/>
          <Column id="DRFT_DOCREGNO" type="STRING" size="256"/>
          <Column id="DRFT_DATE" type="STRING" size="256"/>
          <Column id="DRFT_USERID" type="STRING" size="256"/>
          <Column id="TRG_FORM_ID" type="STRING" size="256"/>
          <Column id="TRG_FORM_ID2" type="STRING" size="256"/>
          <Column id="BUDGET_CNRL_AT" type="STRING" size="256"/>
          <Column id="CAUSE_ACTION_ANACT_KND" type="STRING" size="256"/>
          <Column id="CAUSE_ACTION_REGIST_SE" type="STRING" size="256"/>
          <Column id="CHI_CNT" type="STRING" size="256"/>
          <Column id="CHI_AT" type="STRING" size="256"/>
          <Column id="WIK_CPTAL_PLAN_AT" type="STRING" size="256"/>
          <Column id="ACNUT_NM" type="STRING" size="256"/>
          <Column id="GWAN_NM" type="STRING" size="256"/>
          <Column id="HANG_NM" type="STRING" size="256"/>
          <Column id="SEHANG_NM" type="STRING" size="256"/>
          <Column id="MOK_NM" type="STRING" size="256"/>
          <Column id="SEMOK_NM" type="STRING" size="256"/>
          <Column id="BUDGET_DEPT_CODE" type="STRING" size="256"/>
          <Column id="SANCTN_KND" type="STRING" size="256"/>
          <Column id="ASIGN_JAN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="EXPNDTR_UPDT_REQ_CN" type="STRING" size="256"/>
          <Column id="UPDT_REQ_AT" type="STRING" size="256"/>
          <Column id="REGISTER_EMPNO" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_trvctExpDsnMtrDet" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DECSN_YEAR" type="STRING" size="4"/>
          <Column id="DECSN_NO" type="STRING" size="10"/>
          <Column id="EXPECT_DE" type="STRING" size="8"/>
          <Column id="EXPECT_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="EXCCLC_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="REGISTER_ID" type="STRING" size="12"/>
          <Column id="REGIST_DT" type="STRING" size="8"/>
          <Column id="UPDUSR_ID" type="STRING" size="12"/>
          <Column id="UPDT_DT" type="DATE" size="7"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DECSN_YEAR" type="STRING" size="256"/>
          <Column id="DECSN_NO" type="STRING" size="256"/>
          <Column id="ANACT_KND" type="STRING" size="256"/>
          <Column id="CAUSE_ACTION_NO" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_expDsnDetailTrvct" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_expDsnDetailTrvct_oncolumnchanged" onrowposchanged="ds_expDsnDetailTrvct_onrowposchanged">
        <ColumnInfo>
          <Column id="DECSN_YEAR" type="STRING" size="4"/>
          <Column id="DECSN_NO" type="STRING" size="10"/>
          <Column id="SEQ" type="BIGDECIMAL" size="22"/>
          <Column id="EXPECT_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="EXCCLC_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="RQEST_DE" type="STRING" size="8"/>
          <Column id="RQEST_MAN_EMPNO" type="STRING" size="8"/>
          <Column id="RQEST_MAN" type="STRING" size="100"/>
          <Column id="RQEST_DEPT_NM" type="STRING" size="30"/>
          <Column id="RQEST_CLSF" type="STRING" size="100"/>
          <Column id="RCPT_DE" type="STRING" size="8"/>
          <Column id="RCPT_MAN_EMPNO" type="STRING" size="8"/>
          <Column id="RCPT_MAN" type="STRING" size="100"/>
          <Column id="FNNC_INSTT_CODE" type="STRING" size="3"/>
          <Column id="ACNUTNO" type="STRING" size="20"/>
          <Column id="REGISTER_ID" type="STRING" size="12"/>
          <Column id="REGIST_DT" type="STRING" size="8"/>
          <Column id="UPDUSR_ID" type="STRING" size="12"/>
          <Column id="UPDT_DT" type="DATE" size="7"/>
          <Column id="ERROR_AT" type="STRING" size="256"/>
          <Column id="ERROR_AT_TRVCT" type="STRING" size="256"/>
          <Column id="CHGHY" type="STRING" size="256"/>
          <Column id="MTCHG_SE" type="STRING" size="256"/>
          <Column id="SUM_ACPLC_ACT" type="BIGDECIMAL" size="22"/>
          <Column id="SUM_ETC_EXPENS" type="BIGDECIMAL" size="22"/>
          <Column id="SUM_DAIL" type="BIGDECIMAL" size="22"/>
          <Column id="SUM_MAEL" type="BIGDECIMAL" size="22"/>
          <Column id="SUM_TRNSPORT" type="BIGDECIMAL" size="22"/>
          <Column id="SUM_STAYNG" type="BIGDECIMAL" size="22"/>
          <Column id="TOT_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="CPR_CARD_AMOUNT" type="BIGDECIMAL" size="22"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_bdg001" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_acc002" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_acc003" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_bdg002" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_fnncInstt" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="FNNC_INSTT_CODE" type="STRING" size="3"/>
          <Column id="FNNC_INSTT_CODE_NM" type="STRING" size="50"/>
          <Column id="USE_AT" type="STRING" size="1"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_wikCptalPlan" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="PLAN_YM" type="STRING" size="256"/>
          <Column id="WEEK_ATMB" type="STRING" size="256"/>
          <Column id="SE" type="STRING" size="256"/>
          <Column id="CYFD_SE" type="STRING" size="256"/>
          <Column id="SN" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="BUDGET_YEAR" type="STRING" size="256"/>
          <Column id="BSNS_SE" type="STRING" size="256"/>
          <Column id="BALC_SE" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_CODE" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_NM" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_CODE" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_NM" type="STRING" size="256"/>
          <Column id="DECSN_YN" type="STRING" size="256"/>
          <Column id="UPDT_DT" type="STRING" size="256"/>
          <Column id="CPTAL_CHRG_CONFM_YN" type="STRING" size="256"/>
          <Column id="TIMHDER_CONFM_YN" type="STRING" size="256"/>
          <Column id="EXPNDTR_BUDGET_CNRL_DE" type="STRING" size="256"/>
          <Column id="CPTAL_EXPNDTR_ACNTBK_RGIST_DE" type="STRING" size="256"/>
          <Column id="ITNC_DE" type="STRING" size="256"/>
          <Column id="DCSN_AMOUNT" type="BIGDECIMAL" size="256"/>
          <Column id="ANACT_KND" type="STRING" size="256"/>
          <Column id="CAUSE_ACTION_NO" type="STRING" size="256"/>
          <Column id="DECSN_YEAR" type="STRING" size="256"/>
          <Column id="DECSN_NO" type="STRING" size="256"/>
          <Column id="PLAN_AMOUNT" type="BIGDECIMAL" size="256"/>
          <Column id="CONFM_AT" type="STRING" size="256"/>
          <Column id="RM" type="STRING" size="256"/>
          <Column id="EXPNDTR_CNFIRM_YN" type="STRING" size="256"/>
          <Column id="REGISTER_ID" type="STRING" size="256"/>
          <Column id="REGIST_DT" type="STRING" size="256"/>
          <Column id="UPDUSR_ID" type="STRING" size="256"/>
          <Column id="REGISTER_EMPNM" type="STRING" size="256"/>
          <Column id="UPDUSR_EMPNM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_dscsnNo" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_validation" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="compId" type="STRING" size="256"/>
          <Column id="colId" type="STRING" size="256"/>
          <Column id="PK" type="STRING" size="256"/>
          <Column id="notNull" type="STRING" size="256"/>
          <Column id="type" type="STRING" size="256"/>
          <Column id="nlength" type="STRING" size="256"/>
          <Column id="from" type="STRING" size="256"/>
          <Column id="to" type="STRING" size="256"/>
          <Column id="lengthChkGb" type="STRING" size="256"/>
          <Column id="msgId" type="STRING" size="256"/>
          <Column id="expr" type="STRING" size="256"/>
          <Column id="func" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="colId">EXPNDTR_UNIT_CODE</Col>
            <Col id="compId">ds_expDsnMastr</Col>
            <Col id="msgId">[계정정보]부기코드</Col>
            <Col id="notNull">Y</Col>
            <Col id="lengthChkGb">LE</Col>
            <Col id="nlength">8</Col>
          </Row>
          <Row>
            <Col id="colId">SUMRY</Col>
            <Col id="compId">ds_expDsnMastr</Col>
            <Col id="msgId">[계정정보]적요</Col>
            <Col id="notNull">Y</Col>
            <Col id="PK"/>
            <Col id="nlength">100</Col>
            <Col id="lengthChkGb">LE</Col>
          </Row>
          <Row>
            <Col id="colId">ACNUTNO</Col>
            <Col id="compId">ds_expDsnMastr</Col>
            <Col id="PK"/>
            <Col id="notNull">Y</Col>
            <Col id="nlength">20</Col>
            <Col id="lengthChkGb">LE</Col>
            <Col id="msgId">[내용]계좌번호</Col>
          </Row>
          <Row>
            <Col id="colId">FNNC_INSTT_CODE</Col>
            <Col id="compId">ds_expDsnMastr</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">[내용]지출은행</Col>
          </Row>
          <Row>
            <Col id="compId">ds_expDsnDetailTrvct</Col>
            <Col id="colId">DECSN_AMOUNT</Col>
            <Col id="notNull">Y</Col>
            <Col id="nlength">15</Col>
            <Col id="lengthChkGb">LE</Col>
            <Col id="msgId">세부내용-결의금액</Col>
          </Row>
          <Row>
            <Col id="compId">ds_expDsnDetailTrvct</Col>
            <Col id="colId">TAXXPT_AMOUNT</Col>
            <Col id="notNull"/>
            <Col id="msgId">세부내용-개산금액</Col>
            <Col id="lengthChkGb">LE</Col>
            <Col id="nlength">15</Col>
          </Row>
          <Row>
            <Col id="compId">ds_expDsnDetailTrvct</Col>
            <Col id="colId">VAT_DECSN_AMOUNT</Col>
            <Col id="msgId">세부내용-정산금액</Col>
            <Col id="notNull"/>
            <Col id="lengthChkGb">LE</Col>
            <Col id="nlength">15</Col>
          </Row>
          <Row>
            <Col id="compId">ds_expDsnDetailTrvct</Col>
            <Col id="colId">RCPT_MAN</Col>
            <Col id="notNull"/>
            <Col id="msgId">세부내용-영수자</Col>
            <Col id="lengthChkGb">LE</Col>
            <Col id="nlength">15</Col>
          </Row>
          <Row>
            <Col id="colId">ACNUTNO</Col>
            <Col id="msgId">세부내용-계좌번호</Col>
            <Col id="compId">ds_expDsnDetailTrvct</Col>
            <Col id="notNull">Y</Col>
            <Col id="lengthChkGb">LE</Col>
            <Col id="nlength">20</Col>
          </Row>
          <Row>
            <Col id="colId">FNNC_INSTT_CODE</Col>
            <Col id="msgId">세부내용-지급은행</Col>
            <Col id="compId">ds_expDsnDetailTrvct</Col>
            <Col id="notNull">Y</Col>
            <Col id="lengthChkGb">LE</Col>
            <Col id="nlength">3</Col>
          </Row>
          <Row>
            <Col id="compId">ds_expDsnMastr</Col>
            <Col id="colId">EXPNDTR_UPDT_REQ_CN</Col>
            <Col id="PK"/>
            <Col id="notNull"/>
            <Col id="type"/>
            <Col id="nlength">100</Col>
            <Col id="from"/>
            <Col id="to"/>
            <Col id="lengthChkGb">LE</Col>
            <Col id="msgId">수정요청내용</Col>
            <Col id="expr"/>
            <Col id="func"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_com022" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_fileList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="PROGRS" type="BIGDECIMAL" size="16"/>
          <Column id="ORGINL_FILE_NM" type="string" size="32"/>
          <Column id="FILE_EXTSN" type="string" size="32"/>
          <Column id="FILE_STRE_COURS" type="string" size="32"/>
          <Column id="FILE_ID" type="string" size="32"/>
          <Column id="SN" type="bigdecimal" size="16"/>
          <Column id="SYS_SE_CODE" type="string" size="32"/>
          <Column id="FILE_IMAGE" type="string" size="32"/>
          <Column id="FILE_TY" type="string" size="32"/>
          <Column id="JOB_SE" type="string" size="32"/>
          <Column id="DELETE_IMAGE" type="string" size="32"/>
          <Column id="STRE_FILE_NM" type="string" size="32"/>
          <Column id="FILE_MG" type="bigdecimal" size="16"/>
          <Column id="FILE_CN" type="string" size="32"/>
          <Column id="FILE_ORDR" type="bigdecimal" size="16"/>
          <Column id="TRNSMIS_FILE_SIZE" type="string" size="32"/>
          <Column id="USE_AT" type="string" size="32"/>
          <Column id="STTUS" type="string" size="32"/>
          <Column id="FILE_SN" type="bigdecimal" size="16"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_fxamtPymnt" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="EMPNO" type="STRING" size="8"/>
          <Column id="EMPNM" type="STRING" size="256"/>
          <Column id="BSRP_SEQ" type="BIGDECIMAL" size="6"/>
          <Column id="EXCCLC_SN" type="BIGDECIMAL" size="6"/>
          <Column id="EXCCLC_SE" type="STRING" size="3"/>
          <Column id="BTRPS_SE" type="STRING" size="3"/>
          <Column id="EDCCT_SE" type="STRING" size="3"/>
          <Column id="USE_DE" type="STRING" size="8"/>
          <Column id="USE_AM" type="BIGDECIMAL" size="15"/>
          <Column id="FILE_SN" type="STRING" size="256"/>
          <Column id="FILE_CNT" type="STRING" size="256"/>
          <Column id="RM" type="STRING" size="300"/>
          <Column id="BANK_CD" type="STRING" size="256"/>
          <Column id="CARD_NO" type="STRING" size="256"/>
          <Column id="APPR_TIME" type="STRING" size="256"/>
          <Column id="APPR_NO" type="STRING" size="256"/>
          <Column id="CANCEL_YN" type="STRING" size="256"/>
          <Column id="CARD_NM" type="STRING" size="256"/>
          <Column id="CHAIN_NM" type="STRING" size="256"/>
          <Column id="BRANCHTYPE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_rcipt" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_rcipt_onrowposchanged">
        <ColumnInfo>
          <Column id="EMPNO" type="STRING" size="8"/>
          <Column id="EMPNM" type="STRING" size="256"/>
          <Column id="BSRP_SEQ" type="BIGDECIMAL" size="6"/>
          <Column id="EXCCLC_SN" type="BIGDECIMAL" size="6"/>
          <Column id="EXCCLC_SE" type="STRING" size="3"/>
          <Column id="BTRPS_SE" type="STRING" size="3"/>
          <Column id="EDCCT_SE" type="STRING" size="3"/>
          <Column id="USE_DE" type="STRING" size="8"/>
          <Column id="USE_AM" type="BIGDECIMAL" size="15"/>
          <Column id="FILE_SN" type="STRING" size="256"/>
          <Column id="FILE_CNT" type="STRING" size="256"/>
          <Column id="RM" type="STRING" size="300"/>
          <Column id="BANK_CD" type="STRING" size="256"/>
          <Column id="CARD_NO" type="STRING" size="256"/>
          <Column id="APPR_TIME" type="STRING" size="256"/>
          <Column id="APPR_NO" type="STRING" size="256"/>
          <Column id="CANCEL_YN" type="STRING" size="256"/>
          <Column id="CARD_NM" type="STRING" size="256"/>
          <Column id="CHAIN_NM" type="STRING" size="256"/>
          <Column id="BRANCHTYPE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cprCardUseDtls" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="EMPNO" type="STRING" size="8"/>
          <Column id="EMPNM" type="STRING" size="256"/>
          <Column id="BSRP_SEQ" type="BIGDECIMAL" size="6"/>
          <Column id="EXCCLC_SN" type="BIGDECIMAL" size="6"/>
          <Column id="EXCCLC_SE" type="STRING" size="3"/>
          <Column id="BTRPS_SE" type="STRING" size="3"/>
          <Column id="EDCCT_SE" type="STRING" size="3"/>
          <Column id="USE_DE" type="STRING" size="8"/>
          <Column id="USE_AM" type="BIGDECIMAL" size="15"/>
          <Column id="FILE_SN" type="STRING" size="256"/>
          <Column id="FILE_CNT" type="STRING" size="256"/>
          <Column id="RM" type="STRING" size="300"/>
          <Column id="BANK_CD" type="STRING" size="256"/>
          <Column id="CARD_NO" type="STRING" size="256"/>
          <Column id="APPR_TIME" type="STRING" size="256"/>
          <Column id="APPR_NO" type="STRING" size="256"/>
          <Column id="CANCEL_YN" type="STRING" size="256"/>
          <Column id="CARD_NM" type="STRING" size="256"/>
          <Column id="CHAIN_NM" type="STRING" size="256"/>
          <Column id="BRANCHTYPE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_bsrpList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" keystring="G:EMPNO+EMPNM+JSSFC_CLSF_NM+DEPT_NM+S:EMPNO+">
        <ColumnInfo>
          <Column id="EMPNO" type="STRING" size="8"/>
          <Column id="EMPNM" type="STRING" size="256"/>
          <Column id="JSSFC_SE" type="STRING" size="256"/>
          <Column id="JSSFC_NM" type="STRING" size="256"/>
          <Column id="CLSF_SE" type="STRING" size="256"/>
          <Column id="CLSF_NM" type="STRING" size="256"/>
          <Column id="JSSFC_CLSF_NM" type="STRING" size="256"/>
          <Column id="BSRP_SEQ" type="BIGDECIMAL" size="6"/>
          <Column id="DEPT_CODE" type="STRING" size="6"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="WHTHRC_AT" type="STRING" size="256"/>
          <Column id="BSRP_PURPS" type="STRING" size="256"/>
          <Column id="DSTN_NM" type="STRING" size="256"/>
          <Column id="BSRP_BGNDE" type="STRING" size="256"/>
          <Column id="BSRP_BEGIN_TM" type="STRING" size="256"/>
          <Column id="BSRP_BEGIN_DT" type="STRING" size="256"/>
          <Column id="BSRP_ENDDE" type="STRING" size="256"/>
          <Column id="BSRP_END_TM" type="STRING" size="256"/>
          <Column id="BSRP_END_DT" type="STRING" size="256"/>
          <Column id="CONFM_AT" type="STRING" size="1"/>
          <Column id="SANCTN_NO" type="STRING" size="16"/>
          <Column id="SANCTN_STS" type="STRING" size="256"/>
          <Column id="TRVCT_TOTAMT" type="BIGDECIMAL" size="15"/>
          <Column id="EXCCLC_AMOUNT" type="BIGDECIMAL" size="15"/>
          <Column id="BLCE" type="BIGDECIMAL" size="15"/>
          <Column id="ENABLE_AT" type="STRING" size="256"/>
          <Column id="EXCCLC_AT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_hrm055" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_condFile" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="FILE_SN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_edcList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="YEAR" type="STRING" size="4"/>
          <Column id="EMPNO" type="STRING" size="8"/>
          <Column id="EMPNM" type="STRING" size="256"/>
          <Column id="SN" type="BIGDECIMAL" size="6"/>
          <Column id="EDC_TY" type="STRING" size="1"/>
          <Column id="DEPT_CODE" type="STRING" size="6"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="EDC_TY_SN" type="BIGDECIMAL" size="6"/>
          <Column id="EDC_TY_NM" type="STRING" size="2100"/>
          <Column id="EDC_CL_SN" type="STRING" size="3"/>
          <Column id="EDC_CL_NM" type="STRING" size="2100"/>
          <Column id="EDC_INSTT" type="STRING" size="500"/>
          <Column id="CRSE_NM" type="STRING" size="2000"/>
          <Column id="EDC_PLACE" type="STRING" size="300"/>
          <Column id="EDC_BGNDE" type="STRING" size="8"/>
          <Column id="EDC_ENDDE" type="STRING" size="8"/>
          <Column id="CONFM_AT" type="STRING" size="1"/>
          <Column id="SANCTN_NO" type="STRING" size="16"/>
          <Column id="SANCTN_STS" type="STRING" size="256"/>
          <Column id="DE_CT" type="BIGDECIMAL" size="15"/>
          <Column id="MEAL_CT" type="BIGDECIMAL" size="15"/>
          <Column id="TRNSPORT_CT" type="BIGDECIMAL" size="15"/>
          <Column id="STAYNG_CT" type="BIGDECIMAL" size="15"/>
          <Column id="EDC_CNSUL_AM" type="BIGDECIMAL" size="15"/>
          <Column id="EXCCLC_AM" type="BIGDECIMAL" size="15"/>
          <Column id="SUM_DE" type="BIGDECIMAL" size="15"/>
          <Column id="SUM_MEAL" type="BIGDECIMAL" size="15"/>
          <Column id="SUM_TRNSPORT" type="BIGDECIMAL" size="15"/>
          <Column id="SUM_STAYNG" type="BIGDECIMAL" size="15"/>
          <Column id="BLCE" type="BIGDECIMAL" size="15"/>
          <Column id="ENABLE_AT" type="STRING" size="256"/>
          <Column id="EXCCLC_AT" type="STRING" size="256"/>
          <Column id="EXCCLC_CONFM_AT" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_CODE" type="STRING" size="256"/>
          <Column id="BUDGET_DEPT" type="STRING" size="256"/>
          <Column id="EDCCT_FILE_SN" type="STRING" size="256"/>
          <Column id="CNFIRM_AT" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_NM" type="STRING" size="256"/>
          <Column id="BUDGET_DEPT_CODE" type="STRING" size="256"/>
          <Column id="DECSN_NO_VIEW" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_fileList2" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="PROGRS" type="BIGDECIMAL" size="16"/>
          <Column id="ORGINL_FILE_NM" type="string" size="32"/>
          <Column id="FILE_EXTSN" type="string" size="32"/>
          <Column id="FILE_STRE_COURS" type="string" size="32"/>
          <Column id="FILE_ID" type="string" size="32"/>
          <Column id="SN" type="bigdecimal" size="16"/>
          <Column id="SYS_SE_CODE" type="string" size="32"/>
          <Column id="FILE_IMAGE" type="string" size="32"/>
          <Column id="FILE_TY" type="string" size="32"/>
          <Column id="JOB_SE" type="string" size="32"/>
          <Column id="DELETE_IMAGE" type="string" size="32"/>
          <Column id="STRE_FILE_NM" type="string" size="32"/>
          <Column id="FILE_MG" type="bigdecimal" size="16"/>
          <Column id="FILE_CN" type="string" size="32"/>
          <Column id="FILE_ORDR" type="bigdecimal" size="16"/>
          <Column id="TRNSMIS_FILE_SIZE" type="string" size="32"/>
          <Column id="USE_AT" type="string" size="32"/>
          <Column id="STTUS" type="string" size="32"/>
          <Column id="FILE_SN" type="bigdecimal" size="16"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_acc046">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item4" compid="div_detail1.cal_itncDe" propid="value" datasetid="ds_expDsnMastr" columnid="ITNC_DE"/>
      <BindItem id="item0" compid="div_detail2.edt_bukipCode" propid="value" datasetid="ds_expDsnMastr" columnid="EXPNDTR_UNIT_CODE"/>
      <BindItem id="item1" compid="div_detail2.Edit04" propid="value" datasetid="ds_expDsnMastr" columnid="BUDGET_ACNT_CODE"/>
      <BindItem id="item10" compid="div_detail2.Edit05" propid="value" datasetid="ds_expDsnMastr" columnid="DECSN_NO"/>
      <BindItem id="item11" compid="div_detail2.msk_caActAmt" propid="value" datasetid="ds_expDsnMastr" columnid="ASIGN_JAN_AMOUNT"/>
      <BindItem id="item12" compid="div_detail2.msk_caActAmt00" propid="value" datasetid="ds_expDsnMastr" columnid="EXPNDTR_UNIT_CODE_BLCE"/>
      <BindItem id="item2" compid="div_detail1.cal_causeActionDe" propid="value" datasetid="ds_expDsnMastr" columnid="CAUSE_ACTION_DE"/>
      <BindItem id="item3" compid="div_detail1.cal_detDcsnDe" propid="value" datasetid="ds_expDsnMastr" columnid="DET_DCSN_DE"/>
      <BindItem id="item9" compid="div_detail1.cal_expectDe" propid="value" datasetid="ds_trvctExpDsnMtrDet" columnid="EXPECT_DE"/>
      <BindItem id="item13" compid="div_detail1.cal_pymntItncDe" propid="value" datasetid="ds_expDsnMastr" columnid="PYMNT_ITNC_DE"/>
      <BindItem id="item14" compid="div_detail1.cal_expndtrBudgetCnrlDe" propid="value" datasetid="ds_expDsnMastr" columnid="EXPNDTR_BUDGET_CNRL_DE"/>
      <BindItem id="item16" compid="div_detail1.cal_cptalExpndtrAcntbkDe" propid="value" datasetid="ds_expDsnMastr" columnid="CPTAL_EXPNDTR_ACNTBK_DE"/>
      <BindItem id="item6" compid="div_detail1.Edit01" propid="value" datasetid="ds_expDsnMastr" columnid="CAUSE_ACTION_NO"/>
      <BindItem id="item30" compid="tab.tabpage1.div_detail1.msk_DECSN_AMOUNT" propid="value" datasetid="ds_expDsnDetailTrvct" columnid="DECSN_AMOUNT"/>
      <BindItem id="item33" compid="tab.tabpage1.div_detail1.cal_rcptDe" propid="value" datasetid="ds_expDsnDetailTrvct" columnid="RCPT_DE"/>
      <BindItem id="item34" compid="tab.tabpage1.div_detail1.edt_rcptMan" propid="value" datasetid="ds_expDsnDetailTrvct" columnid="RCPT_MAN"/>
      <BindItem id="item35" compid="tab.tabpage1.div_detail1.cmd_fnncInstt" propid="value" datasetid="ds_expDsnDetailTrvct" columnid="FNNC_INSTT_CODE"/>
      <BindItem id="item36" compid="tab.tabpage1.div_detail1.edt_acnutno" propid="value" datasetid="ds_expDsnDetailTrvct" columnid="ACNUTNO"/>
      <BindItem id="item68" compid="div_search.Spin02" propid="value" datasetid="ds_expDsnMastr" columnid="DECSN_YEAR"/>
      <BindItem id="item69" compid="div_detail2.Edit02" propid="value" datasetid="ds_expDsnMastr" columnid="BUDGET_ACNT_NM"/>
      <BindItem id="item70" compid="div_detail2.Edit01" propid="value" datasetid="ds_expDsnMastr" columnid="EXPNDTR_UNIT_NM"/>
      <BindItem id="item22" compid="div_detail2.Combo01" propid="value" datasetid="ds_expDsnMastr" columnid="BSNS_SE"/>
      <BindItem id="item71" compid="div_detail2.Edit03" propid="value" datasetid="ds_expDsnMastr" columnid="GNRL_DEBTOR_ACNT_NM"/>
      <BindItem id="item72" compid="div_detail2.Edit06" propid="value" datasetid="ds_expDsnMastr" columnid="GNRL_CRDIT_ACNT_NM"/>
      <BindItem id="item73" compid="div_detail2.Edit07" propid="value" datasetid="ds_expDsnMastr" columnid="SETOFF_DEBTOR_ACNT_NM"/>
      <BindItem id="item74" compid="div_detail2.Edit08" propid="value" datasetid="ds_expDsnMastr" columnid="SETOFF_CRDIT_ACNT_NM"/>
      <BindItem id="item82" compid="div_search.cmb_sanctn" propid="value" datasetid="ds_expDsnMastr" columnid="SANCTN_KND"/>
      <BindItem id="item18" compid="div_detail1.msk_caActAmt00" propid="value" datasetid="ds_trvctExpDsnMtrDet" columnid="EXPECT_AMOUNT"/>
      <BindItem id="item19" compid="div_detail1.msk_caActAmt01" propid="value" datasetid="ds_trvctExpDsnMtrDet" columnid="EXCCLC_AMOUNT"/>
      <BindItem id="item20" compid="div_detail1.msk_caActAmt03" propid="value" datasetid="ds_expDsnMastr" columnid="DECSN_AMOUNT"/>
      <BindItem id="item5" compid="div_detail1.Edit00" propid="value" datasetid="ds_expDsnMastr" columnid="ACNUTNO"/>
      <BindItem id="item60" compid="div_detail1.cmb_fnccInsttCode" propid="value" datasetid="ds_expDsnMastr" columnid="FNNC_INSTT_CODE"/>
      <BindItem id="item67" compid="div_detail1.Edit02" propid="value" datasetid="ds_expDsnMastr" columnid="CHECK_NO"/>
      <BindItem id="item8" compid="div_detail1.TextArea00" propid="value" datasetid="ds_expDsnMastr" columnid="BSNS_NM"/>
      <BindItem id="item15" compid="div_detail1.txt_sumry" propid="value" datasetid="ds_expDsnMastr" columnid="SUMRY"/>
      <BindItem id="item17" compid="tab.tabpage1.div_detail1.msk_TOT_AMOUNT" propid="value" datasetid="ds_expDsnDetailTrvct" columnid="TOT_AMOUNT"/>
      <BindItem id="item21" compid="tab.tabpage1.div_detail1.msk_CPR_CARD_AMOUNT" propid="value" datasetid="ds_expDsnDetailTrvct" columnid="CPR_CARD_AMOUNT"/>
      <BindItem id="item23" compid="tab.tabpage1.div_detail1.msk_SUM_STAYNG" propid="value" datasetid="ds_expDsnDetailTrvct" columnid="SUM_STAYNG"/>
      <BindItem id="item24" compid="tab.tabpage1.div_detail1.msk_SUM_DAIL" propid="value" datasetid="ds_expDsnDetailTrvct" columnid="SUM_DAIL"/>
      <BindItem id="item25" compid="tab.tabpage1.div_detail1.msk_SUM_MAEL" propid="value" datasetid="ds_expDsnDetailTrvct" columnid="SUM_MAEL"/>
      <BindItem id="item26" compid="tab.tabpage1.div_detail1.msk_SUM_ACPLC_ACT" propid="value" datasetid="ds_expDsnDetailTrvct" columnid="SUM_ACPLC_ACT"/>
      <BindItem id="item27" compid="tab.tabpage1.div_detail1.msk_SUM_ETC_EXPENS" propid="value" datasetid="ds_expDsnDetailTrvct" columnid="SUM_ETC_EXPENS"/>
      <BindItem id="item28" compid="tab.tabpage1.div_detail1.msk_SUM_TRNSPORT" propid="value" datasetid="ds_expDsnDetailTrvct" columnid="SUM_TRNSPORT"/>
      <BindItem id="item7" compid="div_detail2.cmb_CYFD_SE" propid="value" datasetid="ds_expDsnMastr" columnid="CYFD_SE"/>
      <BindItem id="item29" compid="div_detail1.edt_expndrUpdtReqCn" propid="value" datasetid="ds_expDsnMastr" columnid="EXPNDTR_UPDT_REQ_CN"/>
    </Bind>
    <Script type="xscript5.0"><![CDATA[/***********************************************************************
 * 화면ID   : ACC020201_P03
 * 화면명   : 여비지출결의서
 * 화면설명 : 여비지출결의서를 등록한다.
 * 작성일   : 2017.07.20
 * 작성자   : 이상명
 * 수정이력 : 
 ***********************************************************************
 *     수정일     수정자   내용
 ***********************************************************************
 *    
 ***********************************************************************
 */

/***********************************************************************
 * Script Include 
 ************************************************************************/
// 시스템 공통 라이브러리 Include
include "lib::comInclude.xjs";
include "mis_lib::misUtil.xjs";
include "lib::comInnerSanct.xjs";
include "lib::comUpDownUtils.xjs";

// 업무에 필요한 공통 라이브러리 파일을 추가할 수 있다.
// TODO

/***********************************************************************
 * 화면 변수 선언부
 ***********************************************************************/
this.strRtnGbn	= "";	// 팝업 this.close()시 리턴값(I:신규, U:수정, C:닫기)
this.innerSanctU = "";	// 내부결재 업데이트시 U
this.File_UpDownManager = null;
this.trgFormId;

/***********************************************************************
 * onInit / onLoad 영역
 ***********************************************************************/
this.ACC020203_P03_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{
	this.fn_misFormInit(this);
	
	// 다른 팝업을 통해서 간접 호출된 경우에만 최초적용
	this.trgFormId = this.getOwnerFrame().trgFormId;
	
	// 파일 메니저 설정
	var fileConfig = {
		useMultiUpload : true,
		onChange: this.fn_onFileSelected,	// 파일 선택 이벤트 핸들러
		onSuccess : this.fn_onFileSuccess	// 전송 성공 이벤트 핸들러
	};
	this.File_UpDownManager = new this.fileUpDownManager(this, "MIS", "ACC");
	this.File_UpDownManager.init(fileConfig);
	
	// 데이터셋 동적 바인딩
	this.div_search.div_dept.fn_setBind("ds_expDsnMastr","DEPT_CODE","DEPT_NM");
	if(this.gfn_authGrpId("ACC_ADMIN") == -1 && this.gfn_authGrpId("ACC_USER") == -1) {
         this.div_search.div_dept.fn_setReadonly(true);
    }
	
	// 결의서코드 정보
	this.fn_transaction("selectExpCode");
	
	// 공통코드
	var comboParams = [
		["ds_acc002", "ACC002", "Y", "D", "B"],	// 지출결의서 구분
		["ds_acc003", "ACC003", "Y", "D", "B"],	// 지출은행
	    ["ds_bdg001", "BDG001", "Y", "D", "B"],	// 사업구분
	    ["ds_bdg002", "BDG002", "Y", "D", "B"],	// 수지구분
	    ["ds_hrm055", "HRM055", "Y", "D", "B"],	// 정산지급구분
	    ["ds_com022", "COM022", "Y", "D", "B"],	// 결재상태
	    ["ds_acc046", "ACC046", "Y", "D", "B"]	// 이월구분
	];
	var callback = function (svcId, errorCode, errorMsg) {
		if(this.trgFormId == "HRM070206") {
			trace(this.tab.removeTabpage(2));
		} else if(this.trgFormId == "HRM080306") {
			this.tab.removeTabpage(1);
			this.tab.tabpage4.grd_cprCardUseDtls.set_formatid("edc");
			this.tab.tabpage5.grd_rciptUseDtls.set_formatid("edc");
			this.tab.tabpage6.grd_fxamtPymnt.set_formatid("edc");
		}
		this.fn_search();	//  최초조회
	};
	this.gfn_comboLoad (comboParams, callback);
}

/***********************************************************************
 * Transaction 관련 이벤트 핸들러 
 **********************************************************************/
/*
 * 함수명  	: fn_search
 * 설명 		: 조회 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_search();
 */
this.fn_search = function()
{	
	var decsnYear = this.getOwnerFrame().decsnYear;		// 결의년도
	var decsnNo	  = this.getOwnerFrame().decsnNo;		// 결의번호
	
	if(!this.comUtils.isNull(decsnNo)) {
		this.strRtnGbn = "U";
		// 여비지출결의서 조회
		this.btn_sanctn.set_enable(true);
		//결재 visible 버튼 설정
		this.ds_cond.clearData();
		this.ds_cond.addRow();
		this.ds_cond.setColumn(0, "DECSN_YEAR"	, decsnYear);
		this.ds_cond.setColumn(0, "DECSN_NO"	, decsnNo);
		this.ds_cond.setColumn(0, "ANACT_KND"	, "01");
		
		//해당 부서만 
		this.ds_cond.setColumn(0, "DEPT_CODE"	, this.gfn_getDeptId());	// 부서코드
		this.ds_cond.setColumn(0, "DEPT_NM"		, this.gfn_getDeptName());	// 부서명
		
		this.fn_transaction("selectExpDsn");
		
	} else {
		this.strRtnGbn = "I";
		this.btn_sanctn.set_enable(false);
		this.sta_msg.set_visible(true);
		// 신규 여비지출결의서 작성
		
		var today = this.dateUtils.today();
		//20200507 재무팀수정요청내용 컬럼 추가로인한 수정 by 권재만
		this.div_detail1.edt_expndrUpdtReqCn.set_cssclass("edt_WF_Readonly");
		this.div_detail1.edt_expndrUpdtReqCn.set_readonly(true);
		
		
		// 지출결의마스터 생성 및 초기값 설정(부모창에서 넘겨받은 데이터셋이 있으면 셋팅)
		if(this.comUtils.isNull(this.getOwnerFrame().dsExpDsnMastr)) {
			this.ds_expDsnMastr.addRow();
			this.ds_expDsnMastr.setColumn(0, "DECSN_YEAR"				, decsnYear);	// 결의년도
			this.ds_expDsnMastr.setColumn(0, "BUDGET_YEAR"				, decsnYear);	// 예산년도
			this.ds_expDsnMastr.setColumn(0, "ANACT_KND"				, "01");		// 결의서종류
			this.ds_expDsnMastr.setColumn(0, "ITNC_DE"					, today);		// 발의일자
			this.ds_expDsnMastr.setColumn(0, "DET_DCSN_DE"				, today);		// 채무확정일자
			this.ds_expDsnMastr.setColumn(0, "PYMNT_ITNC_DE"			, today);		// 지급발의일자
			this.ds_expDsnMastr.setColumn(0, "PRMPC_JRNLZPR_RGIST_DE"	, today);		// 원가분개장등기
			this.ds_expDsnMastr.setColumn(0, "EXPNDTR_BUDGET_CNRL_DE"	, today);		// 지출예산통제
			this.ds_expDsnMastr.setColumn(0, "CAUSE_ACTION_DE"			, today);		// 원인행위일자
			this.ds_expDsnMastr.setColumn(0, "CPTAL_EXPNDTR_ACNTBK_DE"	, today);		// 자금지출부
			this.ds_expDsnMastr.setColumn(0, "DECSN_AMOUNT"				, "0");			// 결의금액
			this.ds_expDsnMastr.setColumn(0, "DEPT_CODE"				, this.gfn_getDeptId());	// 부서코드
			this.ds_expDsnMastr.setColumn(0, "DEPT_NM"					, this.gfn_getDeptName());	// 부서명
			this.ds_expDsnMastr.setColumn(0, "CYFD_SE"					, "0");						// 이월구분	
			
			
		} else {
			this.fn_loadXml(this.getOwnerFrame().dsExpDsnMastr, this.ds_expDsnMastr);
			
			// 자금승인된 경우 예산계정 수정 불가
			if(this.ds_expDsnMastr.getColumn(0, "CPTAL_CHRG_CONFM") == "1") {
				this.fn_setReadonly(this.div_detail2.btn_budgetAcntPopup, null);
			}
			
			// 예산정보 조회
			var dsBudget = this.fn_getBudgetInfo(this.ds_expDsnMastr);
			if(dsBudget.getRowCount() > 0) {
				this.ds_expDsnMastr.setColumn(0, "BUDGET_ACNT_NM", 			dsBudget.getColumn(0, "BUDGET_ACNT_NM"));
				this.ds_expDsnMastr.setColumn(0, "EXPNDTR_UNIT_NM", 		dsBudget.getColumn(0, "EXPNDTR_UNIT_NM"));
				this.ds_expDsnMastr.setColumn(0, "BUDGET_ACNT_BLCE", 		dsBudget.getColumn(0, "BUDGET_ACNT_BLCE"));
				this.ds_expDsnMastr.setColumn(0, "EXPNDTR_UNIT_CODE_BLCE", 	dsBudget.getColumn(0, "EXPNDTR_UNIT_CODE_BLCE"));
			}
			
			this.fn_setDatasetType(this.ds_expDsnMastr, "I");
		}
		
		this.ds_expDsnMastr.setColumn(0, "TRG_FORM_ID"				, this.getOwnerFrame().trgFormId);	// 화면제어
		this.ds_expDsnMastr.setColumn(0, "TRG_FORM_ID2"				, this.getOwnerFrame().trgFormId2);	// PMS 화면,삭제제어
	
		// 지출결의마스터상세 생성 및 초기값 설정(부모창에서 넘겨받은 데이터셋이 있으면 셋팅)
		if(this.comUtils.isNull(this.getOwnerFrame().dsTrvctExpDsnMtrDet)) {
			this.ds_trvctExpDsnMtrDet.addRow();
			this.ds_trvctExpDsnMtrDet.setColumn(0, "EXPECT_DE"			, today);		// 개산일자
			this.ds_trvctExpDsnMtrDet.setColumn(0, "EXPECT_AMOUNT"		, "0");			// 개산금액
			this.ds_trvctExpDsnMtrDet.setColumn(0, "EXCCLC_AMOUNT"		, "0");			// 정산금액
		} else {
			this.fn_loadXml(this.getOwnerFrame().dsTrvctExpDsnMtrDet, this.ds_trvctExpDsnMtrDet);
			this.fn_setDatasetType(this.ds_trvctExpDsnMtrDet, "I");
		}
		
		// 지출결의세부 생성 및 초기값 설정(부모창에서 넘겨받은 데이터셋이 있으면 셋팅)
		if(this.comUtils.isNull(this.getOwnerFrame().dsExpDsnDetailTrvct)) {
			;
		} else {
			this.fn_loadXml(this.getOwnerFrame().dsExpDsnDetailTrvct, this.ds_expDsnDetailTrvct);
			this.fn_setDatasetType(this.ds_expDsnDetailTrvct, "I");
		}
		
		// 결의번호가 등록되어야하는 테이블의 Dataset
		if(!this.comUtils.isNull(this.getOwnerFrame().dsDecsnNo)) {
			this.ds_dscsnNo.loadXML(this.getOwnerFrame().dsDecsnNo);
		}
	}
}

/*
 * 함수명  	: fn_save
 * 설명 		: 저장 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_save();
 */
this.fn_save= function()
{
	if(Ex.util.isUpdated(this.ds_expDsnMastr) 			|| 
	   Ex.util.isUpdated(this.ds_trvctExpDsnMtrDet) 	||
	   Ex.util.isUpdated(this.ds_expDsnDetailTrvct)) {
	   
		//채무확정건 필수 제거
		if(this.ds_expDsnMastr.getColumn(0, "EXPNDTR_BUDGET_CNRL_DE") == null || this.ds_expDsnMastr.getColumn(0, "EXPNDTR_BUDGET_CNRL_DE") == ""){
			this.ds_validation.setColumn(this.ds_validation.findRowExpr("colId=='MTCHG_SE' && compId=='ds_expDsnDetailTrvct'"), "notNull", "N");
			this.ds_validation.setColumn(this.ds_validation.findRowExpr("colId=='FNNC_INSTT_CODE' && compId=='ds_expDsnDetailTrvct'"), "notNull", "N");
			this.ds_validation.setColumn(this.ds_validation.findRowExpr("colId=='ACNUTNO' && compId=='ds_expDsnDetailTrvct'"), "notNull", "N");
		}
		
		var year 	   = String(this.ds_expDsnMastr.getColumn(0, "CPTAL_EXPNDTR_ACNTBK_DE")).substr(0,4);
		var decsnYear  = this.ds_expDsnMastr.getColumn(0, "DECSN_YEAR");
		var budgetYear = this.ds_expDsnMastr.getColumn(0, "BUDGET_YEAR");
		if(year != decsnYear || year != budgetYear) {
			this.gfn_message("info.처리불가","자금지출부등기일은 선택된 회계년도 내에서만 입력 가능합니다.");
			return;
		}
		
		if(!this.gfn_checkValidation_NoUpdChk(this.ds_expDsnMastr, this.ds_validation)) {
			return;
		}
		
		if(!this.gfn_checkValidation_NoUpdChk(this.ds_expDsnDetailTrvct, this.ds_validation)) {
			return;
		}
				
		// 거래유형 필수입력 처리
		if(this.ds_expDsnMastr.getColumn(0,"DECSN_YEAR") >= 2016 && this.comUtils.isNull(this.ds_expDsnMastr.getColumn(0,"ATMC_JRNLZ_TY_CODE"))) {
			this.gfn_message("info.처리불가","[계정정보] 거래유형을 선택하십시오.");
			return false;
		}
		
		// 수정요청건인지 판단
		if(this.strRtnGbn == "U") {
			var reqCn    = this.ds_expDsnMastr.getColumn(0, "EXPNDTR_UPDT_REQ_CN");
			var orgReqCn = this.ds_expDsnMastr.getOrgColumn(0, "EXPNDTR_UPDT_REQ_CN");
			
			// 수정요청내용이 존재하며 기존값과 다를 경우 수정요청건으로 판단
			if(!this.comUtils.isNull(reqCn) && reqCn != orgReqCn) {
				this.ds_expDsnMastr.setColumn(0, "UPDT_REQ_AT", "1");
			}
		}
		
		this.fn_transaction("saveExpDsn");
	} else {
		this.gfn_message("comm.내역.변경.없음");
	}
}

/*
 * 함수명  	: fn_sanction
 * 설명 		: '결재' 버튼 클릭 후
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_sanction();
 */
this.fn_sanction = function()
{
	// 유효성 체크
	if(this.comUtils.isDatasetUpdated(this.ds_expDsnMastr) 			|| 
	   this.comUtils.isDatasetUpdated(this.ds_trvctExpDsnMtrDet) 	||
	   this.comUtils.isDatasetUpdated(this.ds_expDsnDetailTrvct)
		) {
		this.gfn_message("comm.정보.저장.요청", "여비지출결의서");
		return;
	}
	if(this.ds_expDsnMastr.getRowCount() == 0) {
		this.gfn_message("info.처리불가","계정정보/결의정보를 찾을 수 없습니다.");
		return;
	}
	if(this.ds_expDsnDetailTrvct.getRowCount() == 0) {
		this.gfn_message("info.처리불가","세부내용을 찾을 수 없습니다.");
		return;
	}
	
	// 청구자
	var rqestMan = this.ds_expDsnDetailTrvct.getColumn(0,"RCPT_MAN");
	if(this.ds_expDsnDetailTrvct.getRowCount() > 1) {
		rqestMan += " 외 "+(this.ds_expDsnDetailTrvct.getRowCount() - 1) + "명";
	}
	
	var bsrpStr = "";
	for(var fRow = 0; fRow < this.ds_bsrpList.getRowCount(); fRow++) {
		var deptNm      = this.ds_bsrpList.getColumn(fRow, "DEPT_NM");
		var empnm       = this.ds_bsrpList.getColumn(fRow, "EMPNM");
		var jssfcClsfNm = this.ds_bsrpList.getColumn(fRow, "JSSFC_CLSF_NM");
		var bsrpPurps   = this.ds_bsrpList.getColumn(fRow, "BSRP_PURPS");
		var whthrcAt    = this.ds_bsrpList.getColumn(fRow, "WHTHRC_AT");
		var dstnNm      = this.ds_bsrpList.getColumn(fRow, "DSTN_NM");
		var bsrpBeginDt = this.ds_bsrpList.getColumn(fRow, "BSRP_BEGIN_DT");
		var bsrpEndDt   = this.ds_bsrpList.getColumn(fRow, "BSRP_END_DT");
		var trvctTotAmt = this.ds_bsrpList.getColumn(fRow, "EXCCLC_AMOUNT");
		
		whthrcAt = whthrcAt == '1' ? '관내' : '관외';
		var detailData = "";
		if(this.ds_bsrpList.getRowType(fRow) == Dataset.ROWTYPE_GROUP) {
			detailData = "소계 : " + this.comUtils.formatComma(nexacro.toNumber(trvctTotAmt,0,0,0));
		} else {
			detailData = bsrpPurps + " / " + whthrcAt + " / " + dstnNm + " / " + bsrpBeginDt + " / " + bsrpEndDt + " / " + this.comUtils.formatComma(nexacro.toNumber(trvctTotAmt,0,0,0))
		}
		
		bsrpStr += deptNm + " / " + empnm + " / " + jssfcClsfNm + " / " + detailData;
		if(this.ds_bsrpList.getRowType(fRow) == Dataset.ROWTYPE_GROUP) {
			bsrpStr += "\\r\\n";
		}
		bsrpStr += "\\r\\n";
	}
	if(this.ds_bsrpList.getRowCount() > 0) {
		bsrpStr += "\\r\\n";
		bsrpStr += "총계 : " + this.comUtils.formatComma(nexacro.toNumber(this.ds_bsrpList.getSum("EXCCLC_AMOUNT"),0,0,0));
	}
	
	// 결재상신
	var arrSancData = [
		 "[지출]"+this.ds_expDsnMastr.getColumn(0,"SUMRY")										//결재제목
		,this.ds_expDsnMastr.getColumn(0,"DECSN_YEAR")											//결재연도
		,this.fn_dateStr(this.ds_expDsnMastr.getColumn(0,"ITNC_DE"),".")						//발의일자
		,this.fn_dateStr(this.ds_expDsnMastr.getColumn(0,"CAUSE_ACTION_DE"),".")				//원인행위부등기
		,this.fn_dateStr(this.ds_expDsnMastr.getColumn(0,"DET_DCSN_DE"),".")					//채무확정액등기
		,this.ds_expDsnMastr.getColumn(0,"GWAN_NM")												//관
		,this.ds_expDsnMastr.getColumn(0,"HANG_NM")												//항
		,this.ds_expDsnMastr.getColumn(0,"SEHANG_NM")											//세항
		,this.ds_expDsnMastr.getColumn(0,"MOK_NM")												//목
		,this.ds_expDsnMastr.getColumn(0,"SEMOK_NM")											//세목
		,this.fn_dateStr(this.ds_expDsnMastr.getColumn(0,"EXPNDTR_BUDGET_CNRL_DE"),".")			//지출예산통제원장등기
		,this.fn_dateStr(this.ds_expDsnMastr.getColumn(0,"CPTAL_EXPNDTR_ACNTBK_DE"),".")		//자금지출기록부등기
		,this.ds_expDsnMastr.getColumn(0,"CHECK_NO")											//지급번호
		,this.fn_dateStr(this.ds_trvctExpDsnMtrDet.getColumn(0,"EXPECT_DE"),".")			 	//개산금_일자
		,this.comUtils.formatComma(this.ds_trvctExpDsnMtrDet.getColumn(0,"EXPECT_AMOUNT")) 		//개산금_금액
		,this.comUtils.formatComma(this.ds_trvctExpDsnMtrDet.getColumn(0,"EXCCLC_AMOUNT")) 		//정산액
		,"일금 "+this.fn_numToHangul(this.ds_expDsnMastr.getColumn(0,"DECSN_AMOUNT"))+"원정"	//총금액_한글
		,"\\"+this.comUtils.formatComma(this.ds_expDsnMastr.getColumn(0,"DECSN_AMOUNT"))		//총금액
		,this.ds_expDsnMastr.getColumn(0,"SUMRY")							//적요
		,""//출장자_근무처
		,rqestMan																				//출장자
		,this.fn_dateStr(this.ds_expDsnDetailTrvct.getColumn(0,"RCPT_DE"),".") 					//영수일자
		,this.ds_expDsnDetailTrvct.getColumn(0,"RCPT_MAN")										//영수자
		,""//용무
		,bsrpStr//출장지
		,this.fn_dateStr(this.ds_expDsnMastr.getColumn(0,"PYMNT_ITNC_DE"),".")					//지급발의일자
	];
	
	//trace(arrSancData.join("|"));

	var formId = '0000000063';
	if(this.gfn_getDeptId() == '010000') {
		formId = '0000000062';	// 감사팀 결재양식
	}

	this.fn_callHandySanc2(
		 this						// context
		,formId						// formId
		,this.ds_expDsnMastr		// misDataset
		,"TBACC_EXP_DSN_MASTR"		// tableName
		,["DECSN_YEAR","DECSN_NO"]	// tableKey
		,arrSancData				// arrSancData
		,null
		,null
		,null
		,this.ds_fileList2
	);

}
/**********************************************************************
 * CALL TRANSACTION 영역
 **********************************************************************/
 
/*
 * 함수명  	: fn_transaction
 * 설명 		: Transaction 요청 처리 함수
 * params  		: strSvcId : 서비스요청 ID
 * return Type 	: None
 * 사용법		: this.fn_transaction("SELECT");
 */
this.fn_transaction = function(strSvcId)
{
	var sArgs = "";
	
	switch (strSvcId) {
		case "selectExpDsn":
			var sController   	= "hsco/mis/acc/ACC020203/selectExpDsn.do";
			var sInDatasets   	= "input1=ds_cond";
			var sOutDatasets  	= "ds_expDsnMastr=output1 ds_trvctExpDsnMtrDet=output5 ds_expDsnDetailTrvct=output7";
			break;

		case "saveExpDsn":
			var sController   	= "hsco/mis/acc/ACC020203/saveExpDsn.do";
			var sInDatasets   	= "input1=ds_expDsnMastr:A input5=ds_trvctExpDsnMtrDet:U input7=ds_expDsnDetailTrvct:U input16=ds_wikCptalPlan:A input20=ds_dscsnNo:A";
			var sOutDatasets  	= "ds_expDsnMastr=output1";
			
			// 결의서 팝업을 호출한 화면ID를 넘긴다.
			if(!this.comUtils.isNull(this.getOwnerFrame().trgFormId)) {
				sArgs = "TRG_FORM_ID=" + this.getOwnerFrame().trgFormId;
			}
			
			break;	
		case "selectExpCode":	// 지출결의서 코드정보
			var sController   	= "hsco/mis/acc/ACC020203/selectExpCode.do";
			var sInDatasets   	= "";
			var sOutDatasets  	= "ds_fnncInstt=output1";
			break;
		
		case "selectFileList":			// 첨부파일 조회
			var sController   	= "";
			var sInDatasets   	= "input1=ds_condFile";
			var sOutDatasets  	= "ds_fileList=output1";
			if(this.trgFormId == "HRM070206") {
				sController   	= "hsco/mis/hrm/HRM070206/selectFileList.do";
			} else if(this.trgFormId == "HRM080306") {
				sController   	= "hsco/mis/hrm/HRM080306/selectFileList.do";
			}
			break;
		
		case "selectExpDsnDetailTrvct":		// 출장내역
			var sController   	= "";
			var sInDatasets   	= "";
			var sOutDatasets  	= "";
			if(this.trgFormId == "HRM070206") {
				sController   	= "hsco/mis/hrm/HRM070206/selectExpDsnDetailTrvct.do";
				sInDatasets   	= "input1=ds_cond";
				sOutDatasets  	= "ds_bsrpList=output2 ds_cprCardUseDtls=output3 ds_rcipt=output4 ds_fxamtPymnt=output5 ds_fileList2=output6";
			} else if(this.trgFormId == "HRM080306") {
				sController   	= "hsco/mis/hrm/HRM080306/selectExpDsnDetailTrvct.do";
				sInDatasets   	= "input1=ds_cond";
				sOutDatasets  	= "ds_edcList=output2 ds_cprCardUseDtls=output3 ds_rcipt=output4 ds_fxamtPymnt=output5 ds_fileList2=output6";
			}
			break;
		
		default:
			break;
	}

	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets, sArgs); 
}

 /**********************************************************************
 * Transaction Callback 영역
 ***********************************************************************/

 /*
 * 함수명  	: fn_callBack
 * 설명 		: Transaction Callback 처리
 * params  		: strSvcId    : 서비스요청 ID
 *                nErrorCode  : 오류 메시지 코드 ([예] 0 : Success, 그밖의 경우, error)
 *                strErrorMsg : 오류 메시지([예]  success.insert|정상적으로 등록되었습니다.)
 * return Type 	: None
 * 사용법		: 
 */
this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg)
{
	
	if (nErrorCode == 0) {
		switch(strSvcId) {
			case "selectExpDsn":
				this.fn_authCheck();	// 권한체크
				
				// 내부 결재상태와 양식 visible 처리 
				var SANCTN_NO = this.ds_expDsnMastr.getColumn(0, "SANCTN_NO");				
				if( this.comUtils.isNullEmpty(SANCTN_NO) || SANCTN_NO == "0"){
					this.div_search.sta_sanctn.set_visible(false);
					this.div_search.cmb_sanctn.set_visible(false);
				} else{
					this.div_search.sta_sanctn.set_visible(true);
					this.div_search.cmb_sanctn.set_visible(true);
				}
				
				// 회계 화면에서 호출된 경우, 최초 1회에 한하여 탭 정리
				if(this.comUtils.isNull(this.trgFormId) || this.trgFormId.substr(0,3) != "HRM") {
					this.trgFormId = this.ds_expDsnMastr.getColumn(0, "TRG_FORM_ID");
					if(this.trgFormId == "HRM070206") {
						this.tab.removeTabpage(2);
					} else if(this.trgFormId == "HRM080306") {
						this.tab.removeTabpage(1);
						this.tab.tabpage4.grd_cprCardUseDtls.set_formatid("edc");
						this.tab.tabpage5.grd_rciptUseDtls.set_formatid("edc");
						this.tab.tabpage6.grd_fxamtPymnt.set_formatid("edc");
					}
				}
				
				// 출장/교육 내역 조회
				if(this.trgFormId == "HRM070206" || this.trgFormId == "HRM080306") {
					this.fn_transaction("selectExpDsnDetailTrvct");
				}
				break;

			case "saveExpDsn":
			    this.alert("저장 되었습니다.");
				//this.close(this.strRtnGbn);
				break;
			case "selectExpCode":		// 결의서 코드정보
				this.ds_fnncInstt.insertRow(0);
				this.ds_fnncInstt.setColumn(0, "FNNC_INSTT_CODE_NM", "미선택");
				break;
			
			default:
				break;
		}
	}
	
	// 오류 및 성공 메시지를 화면에 보여준다.
	this.gfn_callback_message(strSvcId, nErrorCode, strErrorMsg);	
}

/***********************************************************************
 * non-Transaction 관련 컴포넌트 이벤트 처리 함수
 ***********************************************************************/
/*
 * 함수명  	: fn_close
 * 설명 		: 종료 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_close();
 */
this.fn_close = function()
{
	this.close("C");	
}


/*
 * 함수명  	: tab_onchanged
 * 설명 		: 탭 변경 후처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.tab_onchanged();
 */
this.tab_onchanged = function(obj:Tab, e:nexacro.TabIndexChangeEventInfo)
{	
	switch(obj.tabindex){
		case 0:
			this.btn_add.set_visible(true);
			this.btn_del.set_visible(true);
			this.btn_reset.set_visible(true);
			this.btn_rciptDown.set_visible(false);
			break;
		case 4:
			this.btn_rciptDown.set_visible(true);
			break;
		default:
			this.btn_add.set_visible(false);
			this.btn_del.set_visible(false);
			this.btn_reset.set_visible(false);
			this.btn_rciptDown.set_visible(false);
			break;
	}
}

/*
 * 함수명  	: ds_expDsnMastr_oncolumnchanged
 * 설명 		: 지출결의마스터 데이터 변경시 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_expDsnMastr_oncolumnchanged();
 */
this.ds_expDsnMastr_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	switch(e.columnid) {
		
		case "DET_DCSN_DE":				// 채무확정일자
			obj.setColumn(e.row, "PRMPC_JRNLZPR_RGIST_DE"	, e.newvalue);	// 원가분개장등기
			break;
		
		case "EXPNDTR_BUDGET_CNRL_DE":	// 지출예산통제
			obj.setColumn(e.row, "PYMNT_ITNC_DE"			, e.newvalue);	// 지급발의일자
			obj.setColumn(e.row, "CPTAL_EXPNDTR_ACNTBK_DE"	, e.newvalue);	// 자금지출부등기
			
			// 지출예산통제일자 변경시 영수일자 동일하게 변경
			for(i=0; i < this.ds_expDsnDetailTrvct.rowcount ; i++){
				this.ds_expDsnDetailTrvct.setColumn(i, "RCPT_DE"	, e.newvalue);	// 영수일자
			}	
					
			if(e.newvalue == null || e.newvalue == ""){
				this.tab.tabpage1.div_detail1.cmd_fnncInstt.set_cssclass("");
				this.tab.tabpage1.div_detail1.edt_acnutno.set_cssclass("");
			}else{
				this.tab.tabpage1.div_detail1.cmd_fnncInstt.set_cssclass("cmb_WF_Essential");
				this.tab.tabpage1.div_detail1.edt_acnutno.set_cssclass("edt_WF_Essential");
			}
			
			break;	
			
			
		// 발의일자 변경시 다른일자 동일하게 변경 
		case "ITNC_DE":				
			//obj.setColumn(e.row, "DET_DCSN_DE"	, e.newvalue);	// 채무확정일자
			obj.setColumn(e.row, "PYMNT_ITNC_DE"	, e.newvalue);	// 지급발의일자
			
			//obj.setColumn(e.row, "PRMPC_JRNLZPR_RGIST_DE"	, e.newvalue);	// 원가분개장등기
			obj.setColumn(e.row, "EXPNDTR_BUDGET_CNRL_DE"	, e.newvalue);	// 지출예산통제 일자
			obj.setColumn(e.row, "CPTAL_EXPNDTR_ACNTBK_DE"	, e.newvalue);	// 자금지출부등기
			//obj.setColumn(e.row, "CAUSE_ACTION_DE"	, e.newvalue);	// 원인행위일자
			this.ds_trvctExpDsnMtrDet.setColumn(this.ds_trvctExpDsnMtrDet.rowposition, "EXPECT_DE"	, e.newvalue);	// 개산일자
			
			break;
			
		default:
			break;
	}
}



/*
 * 함수명  	: ds_expDsnDetailTrvct_oncolumnchanged
 * 설명 		: 세부내용 데이터 변경시 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_expDsnDetailTrvct_oncolumnchanged();
 */
this.ds_expDsnDetailTrvct_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	switch(e.columnid) {
		case "DECSN_AMOUNT":
			this.ds_expDsnMastr.setColumn(0, "DECSN_AMOUNT", obj.getSum("DECSN_AMOUNT"));
			break;
		case "EXPECT_AMOUNT":	// 개산금액
			this.ds_trvctExpDsnMtrDet.setColumn(0, "EXPECT_AMOUNT", obj.getSum("EXPECT_AMOUNT"));	// 개산금액 합계
			break;
		case "EXCCLC_AMOUNT":	// 정산금액
			this.ds_trvctExpDsnMtrDet.setColumn(0, "EXCCLC_AMOUNT", obj.getSum("EXCCLC_AMOUNT"));	// 정산금액 합계
			break;
			
		//오류시 은행,계좌번호 변경시 오류여부 초기화 
		case "FNNC_INSTT_CODE":// 은행
		case "ACNUTNO": //계좌번호

			var CHGHY = this.ds_expDsnDetailTrvct.getColumn(this.ds_expDsnDetailTrvct.rowposition, "CHGHY");
			if( e.oldvalue != e.newvalue && !this.comUtils.isNullEmpty(CHGHY) ){
				this.ds_expDsnDetailTrvct.setColumn(this.ds_expDsnDetailTrvct.rowposition, "ERROR_AT", "0");	// 에러여부
			}
			break;

		default:
			break;
	}
}


/*
 * 함수명  	: fn_totalSum
 * 설명 		: 여비명세서 총계
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_totalSum();
 */
this.fn_totalSum = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	// 여비명세서 총계 계산
	obj.setColumn(e.row, "SM", this.fn_getNumber(obj.getColumn(e.row,"RLROAD_CYCHG_2")) + this.fn_getNumber(obj.getColumn(e.row,"RLROAD_CYCHG_4")) 
							 + this.fn_getNumber(obj.getColumn(e.row,"SHIP_CYCHG_2")) + this.fn_getNumber(obj.getColumn(e.row, "SHIP_CYCHG_4")) 
							 + this.fn_getNumber(obj.getColumn(e.row, "CAR_CYCHG_2")) + this.fn_getNumber(obj.getColumn(e.row, "CGFFD_2"))
							 + this.fn_getNumber(obj.getColumn(e.row, "CGFFD_4")) + this.fn_getNumber(obj.getColumn(e.row, "STAYNG_CHRGE_2")) 
							 + this.fn_getNumber(obj.getColumn(e.row, "STAYNG_CHRGE_4")) + this.fn_getNumber(obj.getColumn(e.row, "TRNSPORT_NON_2"))
							 + this.fn_getNumber(obj.getColumn(e.row, "ACPLC_TRNSPORT_NON_MIDDL")));
							 
	// 결의금액 셋팅
	this.ds_expDsnMastr.setColumn(0, "DECSN_AMOUNT", obj.getColumn(e.row, "SM"));
}

/*
 * 함수명  	: fn_getNumber
 * 설명 		: 숫자값 취득
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_getNumber();
 */
this.fn_getNumber = function(obj)
{
	return isFinite(parseInt(obj)) ? parseInt(obj) : 0;
}


/*
 * 함수명  	: fn_popup_onclick
 * 설명 		: 팝업
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_close();
 */
this.fn_popup_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	switch(obj.name) {
		case "btn_budgetAcntPopup":	// 예산계정과목 팝업
			var parm = {
				  arg_0      : this
				 ,searchDs   : this.ds_expDsnMastr.saveXML()       	// 검색조건(YEAR, BSNS_SE, BALC_SE, DEPT_CODE 컬럼만 이용)
				 ,strObj     : "edt_YEAR,rdo_BALC_SE" 			// 수정불가능 처리할 오브젝트 명(ex : "edt_YEAR,cbo_BSNS_SE,rdo_BALC_SE,div_srchDept")
				 ,year_S     : this.ds_expDsnMastr.getColumn(0,"BUDGET_YEAR")         // 예산년도(srchDs보다 우선순위를 가짐)
				 ,bsnsSe_S   : null         // 사업구분(srchDs보다 우선순위를 가짐)
				 ,balcSe_S   : null         // 수지구분(srchDs보다 우선순위를 가짐)
				 ,deptCode_S : null         // 부서코드(srchDs보다 우선순위를 가짐)
				 ,acntPopup  : false        // (true : 예산계정코드선택팝업, false : 지출단위선택팝업)
				 ,acntCode_S : null         // 고정 처리할 예산계정코드 목록 (0000000)
				 ,bAccPopup  : true
			};
			this.gfn_popup("btn_budgetAcntPopup", 800, 620, "예산계정과목", parm, "com::bdgAcntPop.xfdl", "fn_popupCallBack", true);
			break;
		case "btn_bsnsPopup":		// 사업지구 팝업
			this.gfn_popup("btn_bsnsPopup", 500, 500, "사업지구", "", "pms_prj::popBsns.xfdl", "fn_popupCallBack", true);
			break;

		case "btn_actPopup":		// 원인행위정보 팝업
			//원인행위번호
			var CAUSE_ACTION_NO = "";
			if(this.strRtnGbn == "U") {
				CAUSE_ACTION_NO = this.ds_expDsnMastr.getColumn(0, "CAUSE_ACTION_NO"); 
			}
			
			var param = {
				 arg_0		: this
				,anactKnd	: '01'
				,deptCode	: this.ds_expDsnMastr.getColumn(0, "DEPT_CODE")
				,deptNm		: this.ds_expDsnMastr.getColumn(0, "DEPT_NM")
				,BUDGET_ACNT_CODE		: this.ds_expDsnMastr.getColumn(0, "BUDGET_ACNT_CODE")//예산계정코드 
				,EXPNDTR_UNIT_CODE		: this.ds_expDsnMastr.getColumn(0, "EXPNDTR_UNIT_CODE")//지출단위코드 
				,CAUSE_ACTION_NO		: CAUSE_ACTION_NO
				,CPTAL_CHRG_CONFM		: this.ds_expDsnMastr.getColumn(0, "CPTAL_CHRG_CONFM")
				,DECSN_YEAR		: this.ds_expDsnMastr.getColumn(0, "DECSN_YEAR")	//지출년도
				,DECSN_NO		: this.ds_expDsnMastr.getColumn(0, "DECSN_NO")		//지출결의서 번호
				
			};
			this.gfn_popup("btn_actPopup", 600, 500, "원인행위정보", param, "mis_acc::ACC020203_P09.xfdl", "fn_popupCallBack", true);
			break;
		case "btn_actPopupView":
			if(this.comUtils.isNotNull(this.ds_expDsnMastr.getColumn(0, "CAUSE_ACTION_NO"))){
				var args	 = {
									 anactKnd	: '03'
									,dsActMastr	: this.ds_expDsnMastr.saveXML()
							   };
				this.gfn_popup("actPopupView", 885, 665, "원인행위조회", args, "mis_acc::ACC020201_P01.xfdl", "fn_popupCallBack", true);
			}
		break;
		case "btn_atmcJrnlzTy":		// 자동분개유형 팝업
			
			var parm = {
				  arg_0      : this
				 ,year       : this.ds_expDsnMastr.getColumn(0, "BUDGET_YEAR")
				 ,bsnsSe     : this.ds_expDsnMastr.getColumn(0, "BSNS_SE")
				 ,balcSe     : this.ds_expDsnMastr.getColumn(0, "BALC_SE")
				 ,acntCode   : this.ds_expDsnMastr.getColumn(0, "BUDGET_ACNT_CODE")
				 ,bukipCode  : this.ds_expDsnMastr.getColumn(0, "EXPNDTR_UNIT_CODE")
			};			
			
			if(this.comUtils.isNull(parm.year) ||
				this.comUtils.isNull(parm.bsnsSe) ||
				this.comUtils.isNull(parm.balcSe) ||
				this.comUtils.isNull(parm.acntCode)) {
				this.gfn_message("comm.항목.선택.요청", "예산계정과목");
				return;
			}
			
			this.gfn_popup("btn_atmcJrnlzTy", 815, 563, "자동분개유형", parm, "mis_acc::ACC020203_P12.xfdl", "fn_popupCallBack", true);
			break;
		case "btn_rqestPopup":	// 청구자 사원팝업
			var parm = {
				arg_0      : this
			};
			this.gfn_popup(obj.name, 800, 530, "사원 선택", parm, "com::empno_P01.xfdl", "fn_popupCallBack", true);
			break;
		case "btn_cnsulPopup":
			this.gfn_popup("btn_cnsulPopup", 0, 0, "품의서 조회", "", "mis_acc::ACC020203_P14.xfdl", "fn_popupCallBack",true);
			break;
		case "btn_branchAcnut":
			var parm = {
				arg_0 : this  //==> 필수, 팝업을 호출하는 form을 참조할 수 있도록 팝업에 Argument로 넘겨준다. (반드시 기술해야 함.)
			};

			this.gfn_popup("btn_branchAcnut", 563, 500, "브런치계좌조회", parm, "mis_fun::FUN010103_P01.xfdl", "fn_popupCallBack", true);
			break;
		default:
			break;
	}
}

/*
 * 함수명  	: fn_popupCallback
 * 설명 		: 팝업 콜백함수
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_popupCallback();
 */
this.fn_popupCallBack = function(strID, variant) {

	switch(strID) {
		case "btn_budgetAcntPopup":	// 예산계정과목 팝업 콜백
			if(variant != null && variant.length > 0) {
				var dsTemp = new Dataset();
				dsTemp.loadXML(variant);
				this.ds_expDsnMastr.setColumn(0, "DECSN_YEAR", 				dsTemp.getColumn(0, "YEAR"));					// 회계년도
				this.ds_expDsnMastr.setColumn(0, "BUDGET_YEAR", 			dsTemp.getColumn(0, "YEAR"));					// 예산년도
				this.ds_expDsnMastr.setColumn(0, "BSNS_SE", 				dsTemp.getColumn(0, "BSNS_SE"));				// 사업구분
				this.ds_expDsnMastr.setColumn(0, "BALC_SE", 				dsTemp.getColumn(0, "BALC_SE"));				// 수지구분
				this.ds_expDsnMastr.setColumn(0, "BUDGET_ACNT_CODE", 		dsTemp.getColumn(0, "BUDGET_ACNT_CODE"));		// 예산계정코드
				this.ds_expDsnMastr.setColumn(0, "BUDGET_ACNT_NM", 			"("+dsTemp.getColumn(0, "DEPT_NM")+")"+ dsTemp.getColumn(0, "BUDGET_TREE_NM"));			// 예산계정명
				this.ds_expDsnMastr.setColumn(0, "BUDGET_ACNT_BLCE", 		dsTemp.getColumn(0, "BUDGET_BALC"));			// 예산잔액
				this.ds_expDsnMastr.setColumn(0, "EXPNDTR_UNIT_CODE", 		dsTemp.getColumn(0, "EXPNDTR_UNIT_CODE"));		// 지출단위코드
				this.ds_expDsnMastr.setColumn(0, "EXPNDTR_UNIT_CODE_BLCE", 	dsTemp.getColumn(0, "EXPNDTR_UNIT_BALC"));		// 지출단위잔액
				this.ds_expDsnMastr.setColumn(0, "EXPNDTR_UNIT_NM", 		dsTemp.getColumn(0, "EXPNDTR_UNIT_NM"));	// 지출단위코드명
				this.ds_expDsnMastr.setColumn(0, "ASIGN_JAN_AMOUNT", 		dsTemp.getColumn(0, "ASIGN_JAN_AMOUNT"));		// 배정잔액
				
				//사업지구 팝업 대신
				this.ds_expDsnMastr.setColumn(0, "BSNS_CODE",			dsTemp.getColumn(0, "DETAIL_BSNS_CODE"));	// 사업지구코드
				this.ds_expDsnMastr.setColumn(0, "BSNS_NM",				dsTemp.getColumn(0, "DETAIL_BSNS_NM"));		// 사업지구명
				
				this.ds_expDsnMastr.setColumn(0, "BUDGET_DEPT_CODE"				, dsTemp.getColumn(0, "DEPT_CODE"));			// 예산부서코드
				
				// 거래유형 초기화(예산계정과목 변경후엔 거래유형을 다시 선택하게 해야 함)
				this.ds_expDsnMastr.setColumn(0, "ATMC_JRNLZ_TY_CODE"	, 	"");	// 자동분개유형
				this.ds_expDsnMastr.setColumn(0, "GNRL_DEBTOR_ACNT_NM"	, 	"");	// 일반_차변계정
				this.ds_expDsnMastr.setColumn(0, "GNRL_CRDIT_ACNT_NM"	, 	"");	// 일반_대변계정
				this.ds_expDsnMastr.setColumn(0, "SETOFF_DEBTOR_ACNT_NM", 	"");	// 상계_차변계정
				this.ds_expDsnMastr.setColumn(0, "SETOFF_CRDIT_ACNT_NM"	, 	"");	// 상계_대변계정
				
				// 거래유형 팝업 호출
				this.fn_popup_onclick({ name:"btn_atmcJrnlzTy" } , null);
			}
			break;
		case "btn_bsnsPopup":
			if(variant != null && variant.length > 0) {
				var dsTemp = new Dataset();
				dsTemp.loadXML(variant);
				this.ds_expDsnMastr.setColumn(0, "BSNS_CODE",			dsTemp.getColumn(0, "BSNS_CODE"));			// 사업지구코드
				this.ds_expDsnMastr.setColumn(0, "BSNS_NM",				dsTemp.getColumn(0, "BSNS_NM"));			// 사업지구명
			}
			break;
	
		case "btn_actPopup":		// 원인행위정보 팝업 콜백

			if(variant != null && variant.length > 0) {
				var dsTemp = new Dataset();
				dsTemp.loadXML(variant);
				
				var SUMRY = this.ds_expDsnMastr.getColumn(0, "SUMRY");
				var CAUSE_ACTION_NO = dsTemp.getColumn(0, "CAUSE_ACTION_NO");																// 원인행위번호
				
				this.ds_expDsnMastr.copyRow(0, dsTemp, 0);
				
				this.ds_expDsnMastr.setColumn(this.ds_expDsnMastr.rowposition, "CAUSE_ACTION_NO", 	 CAUSE_ACTION_NO);						// 원인행위번호
				this.ds_expDsnMastr.setColumn(this.ds_expDsnMastr.rowposition, "CAUSE_ACTION_SUMRY", dsTemp.getColumn(0, "SUMRY"));			// 원인행위적요
				this.ds_expDsnMastr.setColumn(this.ds_expDsnMastr.rowposition, "SUMRY", 			 SUMRY);								// 적요
				
				if(this.ds_cond.getRowCount() == 0) {
					this.ds_cond.addRow();
				}
				
				if(this.strRtnGbn == "I") {
					this.ds_cond.setColumn(0, "CAUSE_ACTION_NO", CAUSE_ACTION_NO);
					
					//this.fn_transaction("caActToExpDsn"); 미사용(삭제함)				
				} 
				else if(this.strRtnGbn == "U") {
					this.ds_expDsnMastr.setColumn(0, "CAUSE_ACTION_NO", CAUSE_ACTION_NO);
				}
			}
			break;
		case "btn_atmcJrnlzTy":		// 자동분개유형
			if(variant != null && variant.length > 0) {
				var dsTemp = new Dataset();
				dsTemp.loadXML(variant);
				this.ds_expDsnMastr.setColumn(0, "ATMC_JRNLZ_TY_CODE", 		dsTemp.getColumn(0, "SN"));						// 자동분개유형코드
				this.ds_expDsnMastr.setColumn(0, "GNRL_DEBTOR_ACNT_NM", 	dsTemp.getColumn(0, "GNRL_DEBTOR_ACNT_NM"));	// 일반_차변계정
				this.ds_expDsnMastr.setColumn(0, "GNRL_CRDIT_ACNT_NM", 		dsTemp.getColumn(0, "GNRL_CRDIT_ACNT_NM"));		// 일반_대변계정
				this.ds_expDsnMastr.setColumn(0, "SETOFF_DEBTOR_ACNT_NM", 	dsTemp.getColumn(0, "SETOFF_DEBTOR_ACNT_NM"));	// 상계_차변계정
				this.ds_expDsnMastr.setColumn(0, "SETOFF_CRDIT_ACNT_NM", 	dsTemp.getColumn(0, "SETOFF_CRDIT_ACNT_NM"));	// 상계_대변계정
			}
			break;
		case "btn_rqestPopup":		// 청구자 사원팝업
			if(variant != null && variant.length > 0) {
				var nRow = this.ds_expDsnDetailTrvct.rowposition;
				var dsTemp = new Dataset();
				dsTemp.loadXML(variant);
				this.ds_expDsnDetailTrvct.setColumn(nRow, "RQEST_MAN_EMPNO", 	dsTemp.getColumn(0, "EMPNO"));		// 사원번호
				this.ds_expDsnDetailTrvct.setColumn(nRow, "RQEST_MAN", 			dsTemp.getColumn(0, "EMPNM"));		// 청구자
				this.ds_expDsnDetailTrvct.setColumn(nRow, "RQEST_DEPT_NM", 		dsTemp.getColumn(0, "DEPT_NM"));	// 부서
				this.ds_expDsnDetailTrvct.setColumn(nRow, "RQEST_CLSF", 		dsTemp.getColumn(0, "HR_CLSF_NM"));	// 직급
				this.ds_expDsnDetailTrvct.setColumn(nRow, "RCPT_MAN", 			dsTemp.getColumn(0, "EMPNM"));		// 영수자
			}
			break;
		case "btn_cnsulPopup":
			if(variant != null && variant.length > 0) {
				var dsTemp = new Dataset();
				dsTemp.loadXML(variant);
				this.ds_expDsnMastr.setColumn(0 ,"DRFT_APPRID",		  dsTemp.getColumn(0, "APPRID"));
				this.ds_expDsnMastr.setColumn(0 ,"DRFT_DATE",		  dsTemp.getColumn(0, "DRAFTDATE"));
				this.ds_expDsnMastr.setColumn(0 ,"DRFT_USERID",		  dsTemp.getColumn(0, "DRAFTERID"));
				this.ds_expDsnMastr.setColumn(0 ,"DRFT_DOCREGNO",	  dsTemp.getColumn(0, "DOCREGNO"));
			}
			break;
		case "btn_branchAcnut":
			if(variant != null && variant.length > 0) {
				var dsTemp = new Dataset();
				trace(variant);
				dsTemp.loadXML(variant);
				this.ds_expDsnMastr.setColumn(0, "ACNUTNO", dsTemp.getColumn(0, "ACNUTNO"));
				this.ds_expDsnMastr.setColumn(0, "FNNC_INSTT_CODE", dsTemp.getColumn(0, "BANK_CODE"));
			}
			
			break;
	}
}

/***********************************************************************
* 사용자 정의 함수
************************************************************************/
/*
 * 함수명  	: btn_add_onclick
 * 설명 		: 행추가 버튼
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_add_onclick();
 */
this.btn_add_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.tab.tabindex == 0) {		
		var nRow = this.ds_expDsnDetailTrvct.addRow();
		this.ds_expDsnDetailTrvct.setColumn(nRow, "DECSN_AMOUNT"	, "0");	// 결의금액
		this.ds_expDsnDetailTrvct.setColumn(nRow, "EXPECT_AMOUNT"	, "0");	// 개산금액
		this.ds_expDsnDetailTrvct.setColumn(nRow, "EXCCLC_AMOUNT"	, "0");	// 정산금액
		this.ds_expDsnDetailTrvct.setColumn(nRow, "RQEST_DE"		, this.ds_expDsnMastr.getColumn(0,"EXPNDTR_BUDGET_CNRL_DE"));	// 청구일자
		this.ds_expDsnDetailTrvct.setColumn(nRow, "RCPT_DE"			, this.ds_expDsnMastr.getColumn(0,"EXPNDTR_BUDGET_CNRL_DE"));	// 영수일자
	}
}

/*
 * 함수명  	: btn_del_onclick
 * 설명 		: 행삭제 버튼
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_del_onclick();
 */
this.btn_del_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.tab.tabindex == 0) {
		// 세부내용 행삭제
		if(this.ds_expDsnDetailTrvct.getRowCount() > 0) {
			if (this.gfn_message("confirm.삭제여부") ) {
				this.ds_expDsnDetailTrvct.deleteRow(this.ds_expDsnDetailTrvct.rowposition);
			}
		}
	}
}

/*
 * 함수명  	: btn_del_onclick
 * 설명 		: 행취소 버튼
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_reset_onclick();
 */
this.btn_reset_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.tab.tabindex == 0) {
		// 세부내용 행 초기화
		if(this.gfn_message("confirm.취소여부") ){
			this.ds_expDsnDetailTrvct.reset();
			this.ds_expDsnDetailTrvct.applyChange();
			return;
		}
	} 
}


/*
 * 함수명  	: fn_authCheck
 * 설명 		: 지출결의서 권한 체크
 * params  		: 
 * return Type 	: None
 * 사용법		: 
 */
this.fn_authCheck = function() 
{
	var sanctnKnd = ['1','4','5'];	// 1:상신, 4:중간결재, 5:결재완료
	
	switch(this.getOwnerFrame().trgFormId) {
		case "ACC020203":	// 지출결의서 관리
			if(sanctnKnd.indexOf(this.ds_expDsnMastr.getColumn(0, "SANCTN_KND")) > -1) {
				var except = [
					 "btn_save"				// 저장 버튼
					,"btn_close2"			// 종료 버튼
					,"btn_downFiles"		// 첨부파일 다운로드
					,"btn_rciptDown"		// 영수증 일괄다운
					,"grd_file"
					,"txt_sumry" 			// 적요 
					,"edt_rcptMan"			// 영수자
					,"cmd_fnncInstt"		// 지급은행
					,"edt_acnutno"			// 계좌번호
					,"cal_detDcsnDe"			// 채무확정일자
					,"cal_prmpcJrnlzprRgistDe"	// 분개장등기
					,"cal_pymntItncDe"			// 지급발의일자
					,"cal_expndtrBudgetCnrlDe"	// 지출예산통제
					,"cal_cptalExpndtrAcntbkDe"	// 자금지출부등기
					,"btn_branchAcnut"			// 지출계좌
					,"btn_atmcJrnlzTy"			// 분개유형
				];
				this.fn_setReadonly(this, except);
			}
			break;
		case "ACC020305":	// 중소기업구매실적
				var except = [
					 "btn_save"				// 저장 버튼
					,"btn_close2"			// 종료 버튼
					,"btn_downFiles"		// 첨부파일 다운로드
					,"btn_rciptDown"		// 영수증 일괄다운
					,"grd_file"
				]
			this.fn_setReadonly(this, except);
			break;
		default:			// 그 외 모든화면
			if(sanctnKnd.indexOf(this.ds_expDsnMastr.getColumn(0, "SANCTN_KND")) > -1) {
				var except = [
					 "btn_save"				// 저장 버튼
					,"btn_close2"			// 종료 버튼
					,"btn_downFiles"		// 첨부파일 다운로드
					,"btn_rciptDown"		// 영수증 일괄다운
					,"grd_file"
					//,"txt_sumry" 			// 적요 
				];
				this.fn_setReadonly(this, except);
			} else if(this.ds_expDsnMastr.getColumn(0, "EXPNDTR_CNFIRM_AT") == "1") {	// 재무팀승인
				var except = [
					 "btn_sanctn"			// 결재 버튼
					,"btn_save"				// 저장 버튼
					,"btn_close2"			// 종료 버튼
					,"btn_downFiles"		// 첨부파일 다운로드
					,"btn_rciptDown"		// 영수증 일괄다운
					,"grd_file"
					//,"txt_sumry" 			// 적요 
					
				];
				this.fn_setReadonly(this, except);
			}
	}
	
	// 재무팀 승인 전엔 결재버튼 비활성화
	if(sanctnKnd.indexOf(this.ds_expDsnMastr.getColumn(0, "SANCTN_KND")) == -1 && this.ds_expDsnMastr.getColumn(0, "EXPNDTR_CNFIRM_AT") != "1") {
		this.sta_msg.set_visible(true);
		this.fn_setReadonly(this.btn_sanctn, null);
	}
	
	//전송오류 체크 
	//this.fn_errorCheck();

}


//=============================
//전송오류 체크
//=============================
this.fn_errorCheck = function(){

	//전송오류시 은행 계좌번호 수정 가능하게 
	/*
	var LAST_SANCTN_STTUS  = this.ds_expDsnMastr.getColumn(this.ds_expDsnMastr.rowposition, "LAST_SANCTN_STTUS");
	
	if(this.comUtils.isNullEmpty(CMPNSP_NO) && ERROR_AT == "1"){

		this.btn_save.set_enable(true);
		this.btn_close2.set_enable(true);
		this.btn_actPopup.set_enable(false);
		
		this.tab.tabpage1.div_detail1.cmd_fnncInstt.set_readonly(false);
		this.tab.tabpage1.div_detail1.edt_acnutno.set_readonly(false);
		this.tab.tabpage1.div_detail1.edt_chghy.set_readonly(false);
				
		this.tab.tabpage1.div_detail1.cmd_fnncInstt.set_cssclass();
		this.tab.tabpage1.div_detail1.edt_acnutno.set_cssclass();
		this.tab.tabpage1.div_detail1.edt_chghy.set_cssclass();
		
	}
	else if(LAST_SANCTN_STTUS == "S00" || LAST_SANCTN_STTUS == "S01"){
	
		this.tab.tabpage1.div_detail1.cmd_fnncInstt.set_readonly(true);
		this.tab.tabpage1.div_detail1.edt_acnutno.set_readonly(true);
		this.tab.tabpage1.div_detail1.edt_chghy.set_readonly(true);
				
		this.tab.tabpage1.div_detail1.cmd_fnncInstt.set_cssclass("cmb_WF_Readonly");
		this.tab.tabpage1.div_detail1.edt_acnutno.set_cssclass("edt_WF_Readonly");
		this.tab.tabpage1.div_detail1.edt_chghy.set_cssclass("edt_WF_Readonly");
	
	}
	*/
}



/*
 * 함수명  	: ds_rcipt_onrowposchanged
 * 설명 		: (현금)영수증 사용내역 행 변경시 이벤트 처리
 * params  		: none
 * return Type 	: none
 * 사용법		: this.ds_rcipt_onrowposchanged(obj, e)
 */
this.ds_rcipt_onrowposchanged = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{
	this.ds_fileList.clearData();
	
	if(e.newrow > -1) {
		var fileSn = obj.getColumn(e.newrow, "FILE_SN");
		
		if(!this.comUtils.isNull(fileSn)) {
			this.ds_condFile.clearData();
			this.ds_condFile.addRow();
			this.ds_condFile.setColumn(0, "FILE_SN", fileSn);
			
			this.ds_fileList.clearData();
			
			this.fn_transaction("selectFileList");  // 첨부파일 조회
		}
	}
}


/*
 * 함수명  	: grd_rciptUseDtls_oncellclick
 * 설명 		: (현금)영수증 그리드 셀 클릭시 이벤트 처리
 * params  		: none
 * return Type 	: none
 * 사용법		: this.grd_rciptUseDtls_oncellclick(obj, e)
 */
this.grd_rciptUseDtls_oncellclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	if(e.col == '5') {
		var nRow = this.ds_rcipt.rowposition;
		var fileCnt = this.ds_rcipt.getColumn(nRow, "FILE_CNT");
		
		if(this.ds_rcipt.getColumn(nRow, "FILE_SN")) {
			this.ds_condFile.setColumn(0, "FILE_SN", this.ds_rcipt.getColumn(nRow, "FILE_SN"));
			var fileSn    = this.ds_fileList.getColumn(this.ds_fileList.rowposition, "FILE_SN");
			var fileOrder = this.ds_fileList.getColumn(this.ds_fileList.rowposition, "FILE_ORDR");
			var fileName  = this.ds_fileList.getColumn(this.ds_fileList.rowposition, "ORGINL_FILE_NM");
			
			this.File_UpDownManager.download(fileSn, fileOrder, fileName);
		}
	}
}


/*
 * 함수명  	: btn_rciptDown_onclick
 * 설명 		: 영수증 다운로드 버튼 클릭 시 이벤트 처리
 * params  		: none
 * return Type 	: none
 * 사용법		: this.btn_rciptDown_onclick(obj, e)
 */
this.btn_rciptDown_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	for(var fRow = 0; fRow < this.ds_fileList2.getRowCount(); fRow++) {
		var fileSn    = this.ds_fileList2.getColumn(fRow, "FILE_SN");
		var fileOrder = this.ds_fileList2.getColumn(fRow, "FILE_ORDR");
		var fileName  = this.ds_fileList2.getColumn(fRow, "ORGINL_FILE_NM");
		
		this.File_UpDownManager.download(fileSn, fileOrder, fileName);
	}
}

this.ds_expDsnMastr_cancolumnchange = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	switch(e.columnid) {
		case "CPTAL_EXPNDTR_ACNTBK_DE":
			var year 	   = String(e.newvalue).substr(0,4);
			var decsnYear  = obj.getColumn(e.row, "DECSN_YEAR");
			var budgetYear = obj.getColumn(e.row, "BUDGET_YEAR");
			if(year != decsnYear || year != budgetYear) {
				this.gfn_message("info.처리불가","자금지출부등기일은 선택된 회계년도 내에서만 입력 가능합니다.");
				return false;
			}
			break;
		default:
			break;
	}
	
	return true;
}
]]></Script>
  </Form>
</FDL>
