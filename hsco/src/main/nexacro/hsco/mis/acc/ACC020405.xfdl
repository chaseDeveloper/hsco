<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\default_typedef.xml"/>
  <Form id="ACC020405" classname="ACC020405" left="0" top="0" width="1059" height="735" titletext="자금지출기록부" onload="ACC020405_onload">
    <Layouts>
      <Layout>
        <Grid id="grd_result" taborder="2" binddataset="ds_result" autoenter="select" useinputpanel="false" cellsizingtype="col" cellmovingtype="col" treeusecheckbox="false" treeuseimage="false" treeinitstatus="expand,all" treeuseexpandkey="true" left="0" top="93" right="28" bottom="0" oncelldblclick="grd_result_oncelldblclick" autosizingtype="none">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="59"/>
                <Column size="100"/>
                <Column size="250"/>
                <Column size="150"/>
                <Column size="65"/>
                <Column size="120"/>
                <Column size="120"/>
                <Column size="120"/>
                <Column size="120"/>
                <Column size="120"/>
                <Column size="120"/>
                <Column size="120"/>
                <Column size="120"/>
                <Column size="120"/>
                <Column size="120"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="3" text="지출여부"/>
                <Cell col="1" rowspan="3" text="지출일자"/>
                <Cell col="2" rowspan="3" text="적요"/>
                <Cell col="3" rowspan="3" text="채주"/>
                <Cell col="4" rowspan="3" text="지급번호"/>
                <Cell col="5" colspan="2" text="자금배정액"/>
                <Cell col="7" colspan="2" text="지출액(대변)"/>
                <Cell col="9" colspan="4" text="지출내역(차변)"/>
                <Cell col="13" colspan="2" text="잔액"/>
                <Cell row="1" col="5" text="국민은행"/>
                <Cell row="1" col="6" text="화성은행"/>
                <Cell row="1" col="7" text="국민은행"/>
                <Cell row="1" col="8" text="화성은행"/>
                <Cell row="1" col="9" rowspan="2" text="미지급금"/>
                <Cell row="1" col="10" rowspan="2" text="미지급비용"/>
                <Cell row="1" col="11" colspan="2" text="기타계정"/>
                <Cell row="1" col="13" text="국민은행"/>
                <Cell row="1" col="14" text="화성은행"/>
                <Cell row="2" col="5" text="우리은행"/>
                <Cell row="2" col="6" text="소     계"/>
                <Cell row="2" col="7" text="우리은행"/>
                <Cell row="2" col="8" style="color2: ;" text="소     계"/>
                <Cell row="2" col="11" style="color2: ;" text="계정명"/>
                <Cell row="2" col="12" text="금액"/>
                <Cell row="2" col="13" text="우리은행"/>
                <Cell row="2" col="14" style="color2: ;" text="소     계"/>
              </Band>
              <Band id="body">
                <Cell rowspan="2" displaytype="expr:UNION_ORDER == &quot;2&quot; ? &quot;checkbox&quot; : &quot;none&quot;" style="background:snow;controlborder:1 none #808080ff ;" text="expr:UNION_ORDER == &quot;2&quot; ? TIMHDER_CONFM : &quot;&quot;"/>
                <Cell col="1" rowspan="2" displaytype="date" style="background:snow;" text="bind:CPTAL_EXPNDTR_ACNTBK_DE" calendardisplaynulltype="none"/>
                <Cell col="2" rowspan="2" style="align:left middle;background:snow;" text="bind:SUMRY" wordwrap="char" autosizerow="limitmin"/>
                <Cell col="3" rowspan="2" style="align:left middle;background:snow;" text="bind:RCPT_MAN"/>
                <Cell col="4" rowspan="2" displaytype="number" style="align:right middle;background:snow;" text="bind:CHECK_NO"/>
                <Cell col="5" displaytype="number" style="align:right middle;background:snow;" text="bind:ASIGN_AMOUNT01"/>
                <Cell col="6" displaytype="number" style="align:right middle;background:snow;" text="bind:ASIGN_AMOUNT02"/>
                <Cell col="7" displaytype="number" style="align:right middle;background:snow;" text="bind:FNNC004_EXPNDTR_AMT"/>
                <Cell col="8" displaytype="number" style="align:right middle;background:snow;" text="bind:FNNC031_EXPNDTR_AMT"/>
                <Cell col="9" rowspan="2" displaytype="number" style="align:right middle;background:snow;" text="bind:MIJIGUK_AMT01"/>
                <Cell col="10" rowspan="2" displaytype="number" style="align:right middle;background:snow;" text="bind:MIJIGUK_AMT02"/>
                <Cell col="11" rowspan="2" style="background:snow;" text="bind:BUDGET_ACNT_NM"/>
                <Cell col="12" rowspan="2" displaytype="number" style="align:right middle;background:snow;" text="bind:MIJIGUK_AMT03"/>
                <Cell col="13" displaytype="number" style="align:right middle;background:snow;" text="bind:ASIGN_BLCE01"/>
                <Cell col="14" displaytype="number" style="align:right middle;background:snow;" text="bind:ASIGN_BLCE02"/>
                <Cell row="1" col="5" displaytype="number" style="align:right middle;background:snow;" text="bind:ASIGN_AMOUNT03"/>
                <Cell row="1" col="6" displaytype="number" style="align:right middle;background:snow;" text="bind:ASIGN_SUM_AMOUNT"/>
                <Cell row="1" col="7" displaytype="number" style="align:right middle;background:snow;" text="bind:FNNC020_EXPNDTR_AMT"/>
                <Cell row="1" col="8" displaytype="number" style="align:right middle;background:snow;" text="bind:FNNC_EXPNDTR_AMT"/>
                <Cell row="1" col="13" displaytype="number" style="align:right middle;background:snow;" text="bind:ASIGN_BLCE03"/>
                <Cell row="1" col="14" displaytype="number" style="align:right middle;background:snow;" text="bind:ASIGN_BLCE"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Div id="div_search" taborder="0" left="0" top="0" right="28" height="59" cssclass="div_WFSA_Box">
          <Layouts>
            <Layout>
              <Static id="Static36" taborder="56" text="5" visible="false" left="264" top="0" width="38" height="5" style="background:#fa794f66;align:center middle;"/>
              <Static id="Static37" taborder="57" text="5" visible="false" left="450" width="38" height="5" style="background:#fa794f66;align:center middle;" bottom="0"/>
              <Static id="Static04" taborder="58" text="15" visible="false" left="0" top="5" width="15" style="background:#00ffff66;" height="21"/>
              <Static id="sta_SRCH_DT" taborder="60" text="조회일자" wordwrap="char" cssclass="sta_WFSA_Label" left="15" top="5" width="64" height="21"/>
              <Static id="sta_ODR" taborder="63" text="정렬기준" wordwrap="char" cssclass="sta_WFSA_Label" left="391" top="31" width="64" height="21"/>
              <Calendar id="cal_SRCH_DT" taborder="1" left="79" top="5" width="110" height="21" dateformat="yyyy-MM-dd " value="null" cssclass="cal_WF_Essential"/>
              <Static id="Static01" taborder="67" text="15" visible="false" left="189" top="5" width="15" height="21" style="background:#00ffff66;"/>
              <Radio id="rdo_sortOdr" taborder="2" left="460" top="31" width="152" height="21" innerdataset="@ds_sortOdr" codecolumn="CODE" datacolumn="CODE_NM" direction="vertical"/>
              <CheckBox id="chk_MTCHG_SE_ORDER" taborder="68" text="국비" left="617" top="31" width="54" height="21" truevalue="1" falsevalue="0"/>
              <CheckBox id="CheckBox00" taborder="70" text="월계표시여부" left="94" top="31" width="94" height="21" truevalue="1" falsevalue="0"/>
              <Radio id="Radio00" taborder="71" left="198" top="31" width="168" height="21" codecolumn="codecolumn" datacolumn="datacolumn" direction="vertical">
                <Dataset id="innerdataset">
                  <ColumnInfo>
                    <Column id="codecolumn" size="256"/>
                    <Column id="datacolumn" size="256"/>
                  </ColumnInfo>
                  <Rows>
                    <Row>
                      <Col id="codecolumn">%</Col>
                      <Col id="datacolumn">전체</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">0</Col>
                      <Col id="datacolumn">미승인</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">1</Col>
                      <Col id="datacolumn">승인</Col>
                    </Row>
                  </Rows>
                </Dataset>
              </Radio>
              <Static id="sta_SITE_SE00" taborder="72" text="조회조건" wordwrap="char" cssclass="sta_WFSA_Label" left="15" top="31" width="77" height="21"/>
              <Static id="sta_ODR00" taborder="73" text="출력형식" wordwrap="char" cssclass="sta_WFSA_Label" left="205" top="5" width="64" height="21"/>
              <Radio id="Radio01" taborder="74" left="274" top="5" width="161" height="21" codecolumn="codecolumn" datacolumn="datacolumn" direction="vertical">
                <Dataset id="innerdataset">
                  <ColumnInfo>
                    <Column id="codecolumn" size="256"/>
                    <Column id="datacolumn" size="256"/>
                  </ColumnInfo>
                  <Rows>
                    <Row>
                      <Col id="codecolumn">1</Col>
                      <Col id="datacolumn">A4 사이즈</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">2</Col>
                      <Col id="datacolumn">A3 사이즈</Col>
                    </Row>
                  </Rows>
                </Dataset>
              </Radio>
              <Div id="div_srchDept" taborder="75" url="com::deptCode.xfdl" left="484" top="5" width="195" height="21" async="false" enable="true"/>
              <Static id="sta_DEPT_CODE" taborder="76" text="부서" wordwrap="char" cssclass="sta_WFSA_Label" left="441" top="5" width="38" height="21"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static06" taborder="35" text="15" visible="false" left="1031" top="0" width="15" height="735" style="background:#1b3cd23c;align:center middle;"/>
        <Static id="Static07" taborder="36" text="스&#13;&#10;크&#13;&#10;롤&#13;&#10;13" visible="false" top="0" right="0" width="13" height="735" style="background:#d07b173c;align:center middle;"/>
        <Static id="sta_title" taborder="39" text="자금지출기록부" cssclass="sta_WF_Title02" left="0" top="69" right="908" height="19"/>
        <Static id="Static08" taborder="41" text="5" visible="false" left="0" top="88" right="28" height="5" style="background:#dc143c3c;align:center middle;"/>
        <Static id="Static00" taborder="42" text="10" visible="false" left="0" top="59" right="28" height="10" style="background:#dc143c3c;align:center middle;"/>
        <Button id="btn_excelDn00" taborder="43" onclick="btn_excelExport_onclick" cssclass="btn_WF_Gridexceldn" top="69" right="28" width="25" height="19"/>
        <Button id="btn_Confirm" taborder="44" text="개별승인" onclick="btn_onclick" enable="false" top="67" right="240" width="89" height="21"/>
        <Button id="btn_Confirm_All" taborder="45" text="일괄승인" onclick="btn_onclick" top="67" right="148" width="89" height="21"/>
        <Button id="btn_Cancel_All" taborder="46" text="일괄승인취소" onclick="btn_onclick" top="67" right="56" width="89" height="21"/>
        <Static id="sta_ODR01" taborder="47" text="결재상태" wordwrap="char" cssclass="sta_WFSA_Label" top="67" width="64" height="21" right="438" visible="false"/>
        <Combo id="cmb_SITE_SE00" taborder="48" innerdataset="@ds_com032" codecolumn="CODE" datacolumn="CODE_NM" cssclass="cmb_WF_Readonly" top="67" width="120" height="21" right="537" visible="false"/>
        <Button id="btn_sanctnInfo" taborder="49" onclick="fn_InnerSactionPop" visible="false" top="67" width="66" height="21" right="334" text="결재정보"/>
        <ImageViewer id="ImageViewer00" taborder="50" top="67" width="35" height="21" stretch="none" right="403" style="border:0 solid #bdbdbdff ;" visible="false"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cond" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="SITE_SE" type="STRING" size="4"/>
          <Column id="SRCH_DT" type="STRING" size="8"/>
          <Column id="SORT_ODR" type="STRING" size="256"/>
          <Column id="MTCHG_SE_ORDER" type="STRING" size="256"/>
          <Column id="SUM_MONTH_AT" type="STRING" size="1"/>
          <Column id="TIMHDER_CONFM" type="STRING" size="1"/>
          <Column id="PRINT_DS" type="STRING" size="1"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_result" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_result_onrowposchanged">
        <ColumnInfo>
          <Column id="TIMHDER_CONFM" type="STRING" size="256"/>
          <Column id="CPTAL_EXPNDTR_ACNTBK_DE" type="STRING" size="256"/>
          <Column id="SUMRY" type="STRING" size="256"/>
          <Column id="RCPT_MAN" type="STRING" size="256"/>
          <Column id="CHECK_NO" type="STRING" size="256"/>
          <Column id="ASIGN_AMOUNT01" type="BIGDECIMAL" size="256"/>
          <Column id="ASIGN_AMOUNT02" type="BIGDECIMAL" size="256"/>
          <Column id="ASIGN_AMOUNT03" type="BIGDECIMAL" size="256"/>
          <Column id="ASIGN_SUM_AMOUNT" type="BIGDECIMAL" size="256"/>
          <Column id="FNNC_INSTT_CODE" type="STRING" size="256"/>
          <Column id="FNNC_INSTT_NM" type="STRING" size="256"/>
          <Column id="FNNC004_EXPNDTR_AMT" type="BIGDECIMAL" size="256"/>
          <Column id="FNNC020_EXPNDTR_AMT" type="BIGDECIMAL" size="256"/>
          <Column id="FNNC031_EXPNDTR_AMT" type="BIGDECIMAL" size="256"/>
          <Column id="FNNC_EXPNDTR_AMT" type="STRING" size="256"/>
          <Column id="MIJIGUK_AMT01" type="BIGDECIMAL" size="256"/>
          <Column id="MIJIGUK_AMT02" type="BIGDECIMAL" size="256"/>
          <Column id="MIJIGUK_AMT03" type="BIGDECIMAL" size="256"/>
          <Column id="MIJIGUK_AMT" type="STRING" size="256"/>
          <Column id="DECSN_YEAR" type="STRING" size="256"/>
          <Column id="DECSN_NO" type="STRING" size="256"/>
          <Column id="ANACT_KND" type="STRING" size="256"/>
          <Column id="BSNS_BALC_SE" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_CODE" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_NM" type="STRING" size="256"/>
          <Column id="ASIGN_BLCE01" type="STRING" size="256"/>
          <Column id="ASIGN_BLCE02" type="STRING" size="256"/>
          <Column id="ASIGN_BLCE03" type="STRING" size="256"/>
          <Column id="ASIGN_BLCE" type="STRING" size="256"/>
          <Column id="UNION_ORDER" type="STRING" size="256"/>
          <Column id="CMPNSP_NO_CNT" type="BIGDECIMAL" size="256"/>
          <Column id="OUT_SLIP_NO" type="STRING" size="256"/>
          <Column id="OUT_RESULT_MSG" type="STRING" size="256"/>
          <Column id="S2_EMPNO" type="STRING" size="256"/>
          <Column id="S3_EMPNO" type="STRING" size="256"/>
          <Column id="S2_SANCTN_DT" type="STRING" size="256"/>
          <Column id="S3_SANCTN_DT" type="STRING" size="256"/>
          <Column id="SANCTN_NO" type="STRING" size="256"/>
          <Column id="LAST_SANCTN_STTUS" type="STRING" size="256"/>
          <Column id="LAST_SANCTNSTS_IMG" type="STRING" size="256"/>
          <Column id="REGIST_DT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_acc001" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sortOdr" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="string" size="32"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">CHECK_NO</Col>
            <Col id="CODE_NM">지급번호</Col>
          </Row>
          <Row>
            <Col id="CODE">FNNC_EXPNDTR_AMT</Col>
            <Col id="CODE_NM">지출액</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_validation" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="compId" type="STRING" size="256"/>
          <Column id="colId" type="STRING" size="256"/>
          <Column id="PK" type="STRING" size="256"/>
          <Column id="notNull" type="STRING" size="256"/>
          <Column id="type" type="STRING" size="256"/>
          <Column id="nlength" type="STRING" size="256"/>
          <Column id="from" type="STRING" size="256"/>
          <Column id="to" type="STRING" size="256"/>
          <Column id="lengthChkGb" type="STRING" size="256"/>
          <Column id="msgId" type="STRING" size="256"/>
          <Column id="expr" type="STRING" size="256"/>
          <Column id="func" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="compId">ds_cond</Col>
            <Col id="PK"/>
            <Col id="colId">SRCH_DT</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">조회일자</Col>
            <Col id="from"/>
            <Col id="to"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_recomInfo" useclientlayout="true">
        <ColumnInfo>
          <Column id="INNER_SANCTN_ID" type="STRING" size="16"/>
          <Column id="INNER_SANCTN_MDL_ID" type="STRING" size="10"/>
          <Column id="SYS_SE_CODE" type="STRING" size="256"/>
          <Column id="JOB_SE" type="STRING" size="256"/>
          <Column id="LAST_SANCTN_STEP" type="STRING" size="256"/>
          <Column id="SANCTN_STEP" type="STRING" size="256"/>
          <Column id="LAST_SANCTNER_ID" type="STRING" size="256"/>
          <Column id="LAST_SANCTN_DT" type="STRING" size="256"/>
          <Column id="JOB_KEY" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_innerSanctnChek" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond02" useclientlayout="true">
        <ColumnInfo>
          <Column id="CPTAL_EXPNDTR_ACNTBK_DE" type="STRING" size="256"/>
          <Column id="SANCTN_NO" type="STRING" size="256"/>
          <Column id="BPLC_SE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond03" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="KEY" type="STRING" size="256"/>
          <Column id="CHK" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sancNo" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="SANCTN_NO" type="STRING" size="256"/>
          <Column id="SANCTN_STTUS" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_com032" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_selectSancEmpno" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="S2_EMPNO" type="STRING" size="256"/>
          <Column id="S3_EMPNO" type="STRING" size="256"/>
          <Column id="S2_SANCTN_DT" type="STRING" size="256"/>
          <Column id="S3_SANCTN_DT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="gds_apprline" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="APPRLINE_COL1" type="STRING" size="256"/>
          <Column id="APPRLINE_COL2" type="STRING" size="256"/>
          <Column id="APPRLINE_COL3" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_innerSanctnParam" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="INNER_SANCTN_MDL_ID" type="STRING" size="256"/>
          <Column id="SYS_SE_CODE" type="STRING" size="256"/>
          <Column id="JOB_SE" type="STRING" size="256"/>
          <Column id="JOB_KEY" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item1" compid="div_search.cal_SRCH_DT" propid="value" datasetid="ds_cond" columnid="SRCH_DT"/>
      <BindItem id="item2" compid="div_search.rdo_sortOdr" propid="value" datasetid="ds_cond" columnid="SORT_ODR"/>
      <BindItem id="item3" compid="div_search.chk_MTCHG_SE_ORDER" propid="value" datasetid="ds_cond" columnid="MTCHG_SE_ORDER"/>
      <BindItem id="item4" compid="div_search.CheckBox00" propid="value" datasetid="ds_cond" columnid="SUM_MONTH_AT"/>
      <BindItem id="item5" compid="div_search.Radio00" propid="value" datasetid="ds_cond" columnid="TIMHDER_CONFM"/>
      <BindItem id="item6" compid="div_search.Radio01" propid="value" datasetid="ds_cond" columnid="PRINT_DS"/>
      <BindItem id="item7" compid="cmb_SITE_SE00" propid="value" datasetid="ds_sancNo" columnid="SANCTN_STTUS"/>
      <BindItem id="item8" compid="ImageViewer00" propid="image" datasetid="ds_result" columnid="LAST_SANCTNSTS_IMG"/>
    </Bind>
    <Script type="xscript5.0"><![CDATA[/**********************************************************************
* 화면ID   : ACC020405.xfdl
* 화면명   : 자금지출기록부 조회
* 화면설명 : 자금지출기록부을 조회한다.
* 작성일   : 2015.11.25
* 작성자   : 정윤원
* 수정이력 : 
***********************************************************************
*     수정일     수정자   내용
***********************************************************************
*
***********************************************************************
*/


/**********************************************************************
* Script Include 
***********************************************************************/
// 시스템 공통 라이브러리 Include
include "lib::comInclude.xjs";
include "mis_lib::misUtil.xjs";
include "lib::comInnerSanct.xjs";



/**********************************************************************
* 화면 변수 선언부
***********************************************************************/
this.currow 	= 0;
this.scrollpos 	= 0;


/**********************************************************************
* onInit / onLoad 영역
***********************************************************************/
this.ACC020405_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{
	// Form 초기화
	this.fn_init_form();
	this.fn_misFormInit(this);
	
	// DataSet 초기화
	this.fn_init_dataset();
}



/**********************************************************************
* Form/Dataset 오브젝트 초기화
***********************************************************************/

/*
 * 함수명  	: initForm
 * 설명 		: Form을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initForm();
 */
this.fn_init_form = function()
{
	this.gfn_initForm(this);	// 시스템 공통으로 Form을 Initialize 한다.
	
	// 데이터셋 동적 바인딩
	this.div_search.div_srchDept.fn_setBind("ds_cond","DEPT_CODE","DEPT_NM");
	
	this.ds_cond.clearData();
	var nRow = this.ds_cond.addRow();
	
	var comboParams = [
	    ["ds_acc001", "ACC001", "Y", "D", "B"]	// ds_acc001 : 사업장구분
	    ,["ds_com032", "COM032", "Y", "D", "B"]	// ds_com032 : 결재상태
	];
	var callback = function (svcId, errorCode, errorMsg) {
		
		var iRow = this.ds_acc001.insertRow(0);
		this.ds_acc001.setColumn(iRow, "CODE", "");
		this.ds_acc001.setColumn(iRow, "CODE_NM", "전체");
		
		if(this.gfn_getDeptId() == "020900"){
			this.ds_cond.setColumn(nRow, "SITE_SE", "03");			// 사업장구분
		}else if(this.gfn_getDeptId() == "020800"){
			this.ds_cond.setColumn(nRow, "SITE_SE", "02");			// 사업장구분
		}else{
			this.ds_cond.setColumn(nRow, "SITE_SE", "01");			// 사업장구분
		}
		this.ds_cond.setColumn(nRow, "SRCH_DT", this.comUtils.getClientDate("YYYYMMDD"));			// 당일
		this.ds_cond.setColumn(nRow, "SORT_ODR", "CHECK_NO");			// 정렬기준:지급번호
		this.ds_cond.setColumn(nRow, "SUM_MONTH_AT", "0");		// 월계표시여부
		this.ds_cond.setColumn(nRow, "TIMHDER_CONFM", "%");
		this.ds_cond.setColumn(nRow, "PRINT_DS", "1");
		
		//해당 부서만 2016.08.31
		//this.ds_cond.setColumn(nRow, "DEPT_CODE"		, this.gfn_getDeptId());	// 부서코드
		//this.ds_cond.setColumn(nRow, "DEPT_NM"			, this.gfn_getDeptName());	// 부서명

		//전체 조회토록 수정 2016.09.03
		this.ds_cond.setColumn(nRow, "DEPT_CODE", "000000");	// 부서코드
		this.ds_cond.setColumn(nRow, "DEPT_NM"	, "화성도시공사");	// 부서명
		
		//this.fn_search();
	};
	this.gfn_comboLoad (comboParams, callback);
}


/*
 * 함수명  	: initDataset
 * 설명 		: Dataset을 초기화한다
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initDataset();
 */
this.fn_init_dataset = function()
{
	// 조건 Dataset 외에 초기화가 필요한 Dataset에 대한 초기화 코드를 추가
}



/**********************************************************************
* Transaction 영역 시작
***********************************************************************
*
* 1. Transaction 관련 이벤트 핸들러
* 2. call Transaction 영역
* 3. callback 영역(Transaction, Popup)
* 
***********************************************************************/



/**********************************************************************
* Transaction 관련 이벤트 핸들러 
***********************************************************************/

/*
 * 함수명  	: fn_search
 * 설명 		: 조회 이벤트 처리(자금지출기록부)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_search();
 */
this.fn_search = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	// validation 체크
	if(!this.gfn_checkValidation_NoUpdChk(this.ds_cond, this.ds_validation)) {
		return false;
	}

	this.ds_result.clearData();		// 자금지출기록부
	
	// transaction
	this.fn_transaction("select");
}



/**********************************************************************
* call Transaction 영역
***********************************************************************/

/*
 * 함수명  	: fn_transaction
 * 설명 		: Transaction 요청 처리 함수
 * params  		: strSvcId : 서비스요청 ID
 * return Type 	: None
 * 사용법		: this.fn_transaction("SELECT");
 */
this.fn_transaction = function(strSvcId)
{
	switch (strSvcId) {
		case "select":			// 자금지출기록부 조회
			var sController   	= "/hsco/mis/acc/ACC020405/select.do";
			var sInDatasets   	= "input1=ds_cond";
			var sOutDatasets  	= "ds_result=output1 ds_sancNo=output2";
			trace(this.ds_sancNo.saveXML());
			break;
		case "timhderConfmU":	// 승인/취소
			var sController   	= "/hsco/mis/acc/ACC020405/timhderConfmU.do";
			var sInDatasets   	= "input1=ds_cond input2=ds_result:A";
			var sOutDatasets  	= "ds_result=output1";
			break;
		
		//내부결재 관련
		case "saveInnerSanc": // 내부결재 저장
			var sController   	= "hsco/mis/acc/ACC020405/saveInnerSanc.do";
			var sInDatasets   	= "input1=ds_cond02:U";
			var sOutDatasets  	= "";
			break;
			
		case "GetInnerSanctnId": // 내부결재id 조회   
			var sController   	= "hsco/com/sym/ism/SYM090200/InnerSanctionId.do";
			var sInDatasets   	= "input1=ds_recomInfo";
			var sOutDatasets  	= "ds_recomInfo=output1";
		break;
		case "innerSanctnUbiDataset": // 시스템연계 내부결재보고서 정보 조회
			var sController   	= "hsco/mis/acc/ACC020405/innerSanctnUbiDataset.do";
			var sInDatasets   	= "input1=ds_cond";
			var sOutDatasets  	= "ds_result=output1";
		break;
		//최초 내부결재 팝업 호출 시 저장버튼을 눌러 시작되었는지, 닫기버튼을 눌러 취소를 했는지 여부check
		case "selectInnerSanctnMasterCheck"	:
			var sController   	= "hsco/mis/aud/AUD010101/selectInnerSanctnMasterCheck.do";
			var sInDatasets   	= "input1=ds_cond03";
			var sOutDatasets  	= "ds_innerSanctnChek=output1";
		break;
	}
	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets); 
}



/**********************************************************************
* Transaction Callback 영역
***********************************************************************/

/*
* 함수명  	: fn_callBack
* 설명 		: Transaction Callback 처리
* params  		: strSvcId    : 서비스요청 ID
*                nErrorCode  : 오류 메시지 코드 ([예] 0 : Success, 그밖의 경우, error)
*                strErrorMsg : 오류 메시지([예]  success.insert|정상적으로 등록되었습니다.)
* return Type 	: None
* 사용법		: 
*/
this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg)
{
	if(nErrorCode != '0') {
		this.gfn_callback_message(strSvcId, nErrorCode, strErrorMsg);
	}

	if (nErrorCode == 0){
		switch (strSvcId) {
			case "select":			// 자금지출기록부 조회
				
				//2016.08.02
				if(this.ds_sancNo.getRowCount() == 0){
					this.btn_sanctnInfo.set_visible(false);
				}
				else{
					this.btn_sanctnInfo.set_visible(true);
				}

				break;
			case "timhderConfmU":	// 승인/취소
				
				this.ds_result.set_rowposition(this.currow);
				this.grd_result.vscrollbar.set_pos(this.scrollpos);
				
				this.gfn_message("success.처리.성공");

				break;
			
			case "GetInnerSanctnId":
				
				if(this.ds_sancNo.getRowCount() < 1){
					this.ds_sancNo.addRow();
				}
				this.ds_sancNo.setColumn(0, "SANCTN_NO", this.ds_recomInfo.getColumn(0, "INNER_SANCTN_ID"));
				
				this.ds_cond02.clearData();
				this.ds_cond02.addRow();
				this.ds_cond02.setColumn(0, "CPTAL_EXPNDTR_ACNTBK_DE", this.ds_cond.getOrgColumn(0, "SRCH_DT"));
				this.ds_cond02.setColumn(0, "SANCTN_NO", this.ds_sancNo.getColumn(0, "SANCTN_NO"));
				
				this.fn_popup_InnerSanctionDrft();
				break;
			
			case "innerSanctnUbiDataset":
				break;
			
			case "selectInnerSanctnMasterCheck":
				if(this.ds_innerSanctnChek.getColumn(this.ds_innerSanctnChek.rowposition, "CHK") == 1)
				{
					this.fn_transaction("saveInnerSanc");
				}
				break;
			
			case "saveInnerSanc":
				this.fn_transaction("select");
				break;
		}
	}
}


/**********************************************************************
* Transaction 영역 끝
***********************************************************************/




/**********************************************************************
* non-Transaction 관련 컴포넌트 이벤트 처리 함수
***********************************************************************
*
* 1. Button 관련 이벤트 처리
* 2. 공통 Button 관련 이벤트 처리
* 
***********************************************************************/



/**********************************************************************
* Button 관련 이벤트 처리
***********************************************************************/

/*
 * 함수명  	: btn_excelExport_onclick
 * 설명 		: '엑셀파일 전환' 버튼 클릭 후 이벤트 처리(Grid)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_excelExport_onclick(obj,e);
 */
this.btn_excelExport_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.gfn_exportExcel(this.grd_result, "Excel File Download");
}



/**********************************************************************
* 공통 Button 관련 이벤트 처리
***********************************************************************/

/*
 * 함수명  	: fn_sanction
 * 설명 		: '결재' 버튼 클릭 후
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_sanction();
 */
this.fn_sanction = function()
{
	/*
	//구버전 사용안함 2016.08.02
	if(this.comUtils.isNull(this.ds_sancNo.getColumn(0, "SANCTN_STTUS"))){
		this.ds_sancNo.clearData();
	}
	this.ds_cond02.clearData();
	this.ds_recomInfo.clearData();

	switch(this.ds_sancNo.getColumn(0, "SANCTN_STTUS")){
	case "T05":
	case "T07":
	case "T11":
	case "T14":
	case "T15":
		if(this.gfn_message("comm.행위여부","내부결재 재상신을 진행") ){
			this.ds_sancNo.clearData();
			this.ds_recomInfo.clearData();
		}else{
			break;
		}
	default:
		var innerSanctnMdlId = "ACC-100050"; // 내부결재모형ID
		var sysSeCode = "SYS";
		var jobSe = "MIS";
		var svcId = "GetInnerSanctnId";
		if(this.ds_recomInfo.getRowCount() ==0) this.ds_recomInfo.addRow();
		

		var key = "ACC-100050" + "^" + this.ds_cond.getOrgColumn(0, "SRCH_DT");
		this.ds_recomInfo.setColumn(0, "JOB_KEY", key);
		this.ds_recomInfo.setColumn(0, "INNER_SANCTN_MDL_ID", innerSanctnMdlId);
		this.ds_recomInfo.setColumn(0, "INNER_SANCTN_ID", this.ds_sancNo.getColumn(0, "SANCTN_NO"));
		
		this.ds_recomInfo.setColumn(0, "SYS_SE_CODE", sysSeCode);
		this.ds_recomInfo.setColumn(0, "JOB_SE", jobSe);
		this.fn_ManageInnerSanction(innerSanctnMdlId, sysSeCode, jobSe, svcId);
	break;
	}
	*/
	
	var BPLC_SE = this.div_search.cmb_SITE_SE.value;
	trace("########## BPLC_SE : " + BPLC_SE);
	
	if(this.comUtils.isNullEmpty(BPLC_SE)){
		this.gfn_message("info.처리불가","사업장별로 결재해야 합니다. 사업장별로 조회 후 진행하세요.");
		return;
	}
	
	
	//신규 내부결재 2016.08.02
	var gridObj = this.ds_result;				//그리드
	var gridSelectedRow = gridObj.rowposition;	//그리드 선택로우
	
	//내부결재정보가 있으면 내부결재정보 팝업으로...
	var SANCTN_NO = gridObj.getColumn(gridSelectedRow, "SANCTN_NO");
	var LAST_SANCTN_STTUS = gridObj.getColumn(gridSelectedRow, "LAST_SANCTN_STTUS");
	//alert( "SANCTN_NO = " + SANCTN_NO + "     LAST_SANCTN_STTUS = " + LAST_SANCTN_STTUS);
	if(LAST_SANCTN_STTUS == 'S00' || LAST_SANCTN_STTUS == 'S01'){ //대기,완료
		this.fn_InnerSactionPop(SANCTN_NO);
	}

	
	//보고서변환
	//if("" != gridObj.getColumn( gridSelectedRow , "LAST_SANCTN_STTUS")){	

		var sanctnId = "";		
		var innerSanctnMdlId = "ACC-100050"; // 내부결재모형ID
		//alert("innerSanctnMdlId = " +innerSanctnMdlId);
		var strSvcId = "SanctnSvcId";
		
		var reportTitle  = "자금지출기록부내부결재";
		var saveFileName = "자금지출기록부내부결재";
		
		var reportUri       = "/mis/acc/ACC020405_R3.jrf";
		var sController   	= "hsco/mis/acc/ACC020405/innerSanctnUbiDataset.do";
		var sInDatasets   	= "input1=ds_cond";
		var sOutDatasets  	= "ds_result=output1";
				
		this.gfn_makeReportTranInfo(sanctnId, strSvcId, sController, sInDatasets, sOutDatasets, reportTitle, reportUri, saveFileName);
	//}
	
	//내부결재요청
	//업무키 조합한다.
	//alert("SRCH_DT = " + this.ds_cond.getOrgColumn(0, "SRCH_DT"));
	var key = "ACC-100050" + "^" + this.ds_cond.getOrgColumn(0, "SRCH_DT") + "^" + BPLC_SE;
			
	this.ds_innerSanctnParam.clearData();
	this.ds_innerSanctnParam.addRow();
	this.ds_innerSanctnParam.setColumn(0, "INNER_SANCTN_MDL_ID", innerSanctnMdlId);	/*내부결재모형ID*/
	this.ds_innerSanctnParam.setColumn(0, "SYS_SE_CODE", "MIS");			/*시스템구분 COM024*/
	this.ds_innerSanctnParam.setColumn(0, "JOB_SE", "ACC");				/*업무구분 COM025*/
	this.ds_innerSanctnParam.setColumn(0, "JOB_KEY", key);				/*시스템 업무별 UNIQUE KEY*/
	
	//공통요청 2016.08.30
	var REGIST_DT = this.ds_result.getColumn(this.ds_result.rowposition, "REGIST_DT");
	//alert("REGIST_DT = " + REGIST_DT);
	var fn_cb = function(sPopupId, sReturn){
		var sanctnResult = sReturn.split("^"); /*index 0: 응답코드, index 1 : 내부결재ID*/
		if("0000" == sanctnResult[0]){
			if(this.comUtils.isNotNull(sanctnResult[1])){
				//sanctnResult[1] : INNER_SANCTN_ID 내부결재ID
				//내부결재ID가 필요한경우 처리
				//alert("sanctnResult[1] = " + sanctnResult[1]);
				
				this.ds_cond02.clearData();
				this.ds_cond02.addRow();
		
				this.ds_cond02.setColumn(this.ds_cond02.rowposition, "SANCTN_NO",sanctnResult[1]);
				this.ds_cond02.setColumn(this.ds_cond02.rowposition, "CPTAL_EXPNDTR_ACNTBK_DE", this.ds_cond.getOrgColumn(0, "SRCH_DT"));
				this.ds_cond02.setColumn(this.ds_cond02.rowposition, "BPLC_SE", BPLC_SE);
				this.fn_transaction("saveInnerSanc");
			}			
			//결재요청 정상처리응답
			//this.fn_transaction("조회서비스");
		}
	}
	var result = this.gfn_openInnerSanctionPopup(this.ds_innerSanctnParam, fn_cb, REGIST_DT);
}



//전자결재정보(사용안함)
this.fn_InnerSactionPop = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var SANCTN_NO = this.ds_result.getColumn(this.ds_result.rowposition, "SANCTN_NO");
	var REGIST_DT = this.ds_result.getColumn(this.ds_result.rowposition, "REGIST_DT");
	if(this.comUtils.isNullEmpty(SANCTN_NO) && SANCTN_NO > 0){
		return;
	}
	
	var param = {
		arg_0 : this,  
		arg_1 : SANCTN_NO,
		arg_2 : REGIST_DT
	};
	
	var fn_cb = function(sPopupId, sReturn) {
		//결재완료
	}
	
	this.gfn_popup("SYM101000_P20", 1100, 730, "결재정보", param, "com_sym_ism::SYM101000_P20.xfdl", fn_cb, REGIST_DT);
}

/*
 * 함수명  	: fn_print
 * 설명 		: 인쇄
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_print();
 */
this.fn_print = function()
{
	if(this.comUtils.isNullEmpty(this.ds_cond.getColumn(0, "PRINT_DS"))){
		this.gfn_message("comm.항목.선택.요청","출력용지(를)");
		return;
	}
	var vOpts = new this.cf_Opts();
		vOpts.setToolbar(false);
		vOpts.setScale(100);
		vOpts.setIsStreaming(true);
		vOpts.setScrollPage(true);
		
		if(this.ds_cond.getColumn(0, "PRINT_DS") == "1"){
			vOpts.setReportPath("/mis/acc/ACC020405_R1.jrf");
		}
		else{
			vOpts.setReportPath("/mis/acc/ACC020405_R2.jrf");
		}
		vOpts.setSaveFilename("자금지출기록부");
		vOpts.setLocalDs(["ds_result", this.ds_result]);
		var parm = {
			arg_0 : this,  //==> 필수, 팝업을 호출하는 form을 참조할 수 있도록 팝업에 Argument로 넘겨준다. (반드시 기술해야 함.)
			opts : vOpts
		};
		this.gfn_popup("Popup_Report", 1200, 800, "자금지출기록부", parm, "common::frmReportPopup.xfdl", "report_callback");
}


/*
 * 함수명  	: btn_onclick
 * 설명 		: 버튼 클릭 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_onclick();
 */
this.btn_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.currow 	= this.ds_result.rowposition;
	this.scrollpos	= this.grd_result.vscrollbar.pos;

	switch(obj.name) {
		case "btn_Confirm":		// 개별승인
			if(this.currow > -1) {
				if(this.ds_result.getColumn(this.currow, "TIMHDER_CONFM") == "0") {
					if(this.gfn_message("comm.행위여부","개별승인 처리") ){
						this.ds_result.setColumn(this.currow, "TIMHDER_CONFM", "1");
					}
					else {
						return;
					}
				} else {
					if(this.ds_result.getColumn(this.currow, "CMPNSP_NO_CNT") == 0) {
						if(this.gfn_message("comm.행위여부","개별취소 처리") ){
							this.ds_result.setColumn(this.currow, "TIMHDER_CONFM", "0");
						}
						else {
							return;
						}
					} else {
						this.gfn_message("info.처리불가","지출이 완료된 자료입니다.");
						return;
					}
				}
			}
			break;
		case "btn_Confirm_All":	// 일괄승인
			if(this.gfn_message("comm.행위여부","일괄승인 처리") ){
				for(i = 0; i < this.ds_result.getRowCount(); i++) {
					if(this.ds_result.getColumn(i, "TIMHDER_CONFM") == "0" && this.ds_result.getColumn(i, "UNION_ORDER") == "2") {
						this.ds_result.setColumn(i, "TIMHDER_CONFM", "1");
					}
				}
			}
			else {
				return;
			}
			break;
		case "btn_Cancel_All":	// 일괄승인취소
			if(this.gfn_message("comm.행위여부","일괄승인취소 처리") ){
				for(i = 0; i < this.ds_result.getRowCount(); i++) {
					if(this.ds_result.getColumn(i, "TIMHDER_CONFM") == "1" && this.ds_result.getColumn(i, "CMPNSP_NO_CNT") == 0 && this.ds_result.getColumn(i, "UNION_ORDER") == "2") {
						this.ds_result.setColumn(i, "TIMHDER_CONFM", "0");
					}
				}
			}
			else {
				return;
			}
			break;
		default:
			break;
	}
	
	// 지출확인,취소 처리
	this.ds_cond.reset();
	this.fn_transaction("timhderConfmU");
}

/*
 * 함수명  	: ds_result_onrowposchanged
 * 설명 		: 데이터셋 행변경 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_result_onrowposchanged();
 */
this.ds_result_onrowposchanged = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{
	// 지출된 데이터는 버튼 비활성화
	this.btn_Confirm.set_enable(obj.getColumn(e.newrow, "CMPNSP_NO_CNT") == 0);
	
	// 지출확인여부에 따라 버튼명칭 변경
	this.btn_Confirm.set_text(obj.getColumn(e.newrow, "TIMHDER_CONFM") == "1" ? "개별취소" : "개별승인");
}

/*
 * 함수명  	: grd_result_oncelldblclick
 * 설명 		: 그리드 더블클릭 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.grd_result_oncelldblclick();
 */
this.grd_result_oncelldblclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	if(this.ds_result.getColumn(e.row, "UNION_ORDER") == "2") {
	
		var args = {
			  anactKnd	: this.ds_result.getColumn(e.row, "ANACT_KND")
			, decsnYear	: this.ds_result.getColumn(e.row, "DECSN_YEAR")
			, decsnNo	: this.ds_result.getColumn(e.row, "DECSN_NO")
		};
				   
		var arrStrUrl = {
			 "01": "mis_acc::ACC020203_P03.xfdl"	// 여비지출결의서
			,"02": "mis_acc::ACC020203_P02.xfdl"	// 구입과지출결의서
			,"03": "mis_acc::ACC020203_P01.xfdl"	// 지출결의서
			,"04": "mis_acc::ACC020203_P04.xfdl"	// 임차와지출결의서
			,"05": "mis_acc::ACC020203_P05.xfdl"	// 반납결의서
			,"06": "mis_acc::ACC020203_P06.xfdl"	// 공사와집행결의서
			,"07": "mis_acc::ACC020203_P07.xfdl"	// 봉급지출결의서
			,"08": "mis_acc::ACC020203_P08.xfdl"	// 용역과지출결의서
		};
		
		this.gfn_popup("expDsnPopup", 842, 903, "결의서", args, arrStrUrl[args.anactKnd], "fn_popupCallBack", true);
		
	}
}

/***********************************************************************
 * 자금지출기록부 내부결재
 ***********************************************************************/
/*
 * 함수명  	: fn_popup_InnerSanctionDrft
 * 설명 		: 보고서 생성 초기 데이터를 설정하고, 기안을 위한 내부결재관리 팝업창을 팝업처리한다.
 * params  		: 
 * return Type 	: None
 * 사용법		: this.fn_popup_InnerSanctionDrft();
 */
this.fn_popup_InnerSanctionDrft = function(){
	var sanctnId = this.ds_recomInfo.getColumn(0, "INNER_SANCTN_ID");  //내부결재ID
	var strSvcId= "innerSanctnUbiDataset";

	var reportTitle  = "자금지출기록부내부결재";
	var saveFileName = "자금지출기록부내부결재";
	var reportUri       = "/mis/acc/ACC020405_R3.jrf";
	var sController   	= "hsco/mis/acc/ACC020405/innerSanctnUbiDataset.do";
	var sInDatasets   	= "input1=ds_cond";
	var sOutDatasets  	= "ds_result=output1";
	this.gfn_makeReportTranInfo(sanctnId, strSvcId, sController, sInDatasets, sOutDatasets, reportTitle, reportUri, saveFileName);
	this.gfn_openInnerSanctionPopup(this.ds_recomInfo);
}
	
/*
 * 함수명  	: ManageInnerSanction
 * 설명 		: 내부결재ID 채번 여부에 따라 기안기 팝업창과 기결재진행 팝업창을 분기하여 팝업한다.
 * params  		: dsParam 파라미터로 전달할 데이터셋(this.ds_recomInfo)
                  innerSanctnMdlId 내부결재모형ID
                  sysSeCode    시스템코드
                  jobSe  업무구분코드
                  svcId transaction service Id
 * return Type 	: None
 * 사용법		: this.ManageInnerSanction();
 */
this.fn_ManageInnerSanction = function(innerSanctnMdlId, sysSeCode, jobSe, svcId){
    
    var BPLC_SE = this.div_search.cmb_SITE_SE.value;
    
 	var cnt = this.ds_recomInfo.getRowCount(); 	
	if(cnt > 0){
	    var sanctionId = this.ds_recomInfo.getColumn(0, "INNER_SANCTN_ID");

	    if(sanctionId != "" && sanctionId != null && sanctionId != undefined){
	        //기존결재ID 있을 경우.
	        this.ds_recomInfo.setColumn(0, "INNER_SANCTN_MDL_ID", innerSanctnMdlId);
	        this.ds_recomInfo.setColumn(0, "SYS_SE_CODE", sysSeCode);
	        this.ds_recomInfo.setColumn(0, "JOB_SE", jobSe);
		
			var key = "ACC-100050" + "^" + this.ds_cond.getOrgColumn(0, "SRCH_DT") + "^" + BPLC_SE;
			this.ds_recomInfo.setColumn(0, "JOB_KEY",key);
			
	        this.fn_popup_InnerSaction();	//내부결재 팝업호출
	    } else {
	        // 기존결재ID 없을 경우
	        this.ds_recomInfo.addRow();
            this.ds_recomInfo.setColumn(0, "INNER_SANCTN_MDL_ID", innerSanctnMdlId);
            this.ds_recomInfo.setColumn(0, "SYS_SE_CODE", sysSeCode);
            this.ds_recomInfo.setColumn(0, "JOB_SE", jobSe);
           
			var key = "ACC-100050" + "^" + this.ds_cond.getOrgColumn(0, "SRCH_DT") + "^" + BPLC_SE;
			this.ds_recomInfo.setColumn(0, "JOB_KEY",key);
			
	        // 내부결재ID를 채번한다.
            this.fn_transaction(svcId);
	    }
	} else {
	    // 기존결재ID 없을 경우
	    this.ds_recomInfo.addRow();
        this.ds_recomInfo.setColumn(0, "INNER_SANCTN_MDL_ID", innerSanctnMdlId);
        this.ds_recomInfo.setColumn(0, "SYS_SE_CODE", sysSeCode);
        this.ds_recomInfo.setColumn(0, "JOB_SE", jobSe);
	
		var key = "ACC-100050" + "^" + this.ds_cond.getOrgColumn(0, "SRCH_DT") + "^" + BPLC_SE;
		this.ds_recomInfo.setColumn(0, "JOB_KEY",  key);
		
	    // 내부결재ID를 채번한다.
        this.fn_transaction(svcId);
	}
}

/*
 * 함수명  	: fn_popup_InnerSanctionDrft
 * 설명 		: 진행중인 결재건인 경우, 내부결재ID를 가진 데이터셋으로 내부결재관리 팝업창을 팝업한다.
 * params  		: 
 * return Type 	: None
 * 사용법		: this.fn_popup_InnerSaction();
 */ 
this.fn_popup_InnerSaction = function(){
    var param = {
		arg_0 : this,  
		arg_1 : this.ds_recomInfo
	};
	this.gfn_popup("InnerSactionPopup2", 999, 735, "내부결재관리", param, "com_sym_ism::SYM090200_P02.xfdl", "fn_InnerSactionPopup_callback");
}

/*
 * 함수명  	: fn_InnerSactionPopup_callback
 * 설명 		: 내부결재 팝업창이 닫혀질 때의 콜백
 * params  		: id 팝업창 ID
                  rtn 반환 데이터셋 문자열
 * return Type 	: None
 * 사용법		: this.fn_InnerSactionPopup_callback();
 */
this.fn_InnerSactionPopup_callback = function (id, rtn){
    var jobKey = this.ds_recomInfo.getColumn(0, "JOB_KEY");
    this.ds_recomInfo.loadXML(rtn);
	this.fn_transaction("select");
}


this.gfn_InnerSactionPopup_callback = function (id, rtn){
	this.ds_cond03.clearData();
	this.ds_cond03.addRow();
	this.ds_cond03.setColumn(0, "KEY",this.ds_recomInfo.getColumn(0, "INNER_SANCTN_ID"));
	this.fn_transaction("selectInnerSanctnMasterCheck");

}


this.div_search_cmb_SITE_SE_onitemchanged = function(obj:Combo, e:nexacro.ItemChangeEventInfo)
{
	if (e.posttext == "전체") {
	    this.sta_ODR01.set_visible(false);
	    this.ImageViewer00.set_visible(false);
	} else {
	    this.sta_ODR01.set_visible(true);
	    this.ImageViewer00.set_visible(true);
	}
}
]]></Script>
  </Form>
</FDL>
