<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\default_typedef.xml"/>
  <Form id="ACC020201" classname="UI_ACC020201" left="0" top="0" width="1059" height="735" titletext="원인행위등록" onload="ACC020201_onload">
    <Layouts>
      <Layout>
        <Div id="div_detail1" taborder="2" cssclass="div_detailBox" left="0" bottom="161" height="184" width="1031">
          <Layouts>
            <Layout width="476" height="122">
              <Static id="Static07" taborder="43" cssclass="sta_WF_Labelbg" left="103" top="52" width="334" height="27"/>
              <Static id="Static11" taborder="44" cssclass="sta_WF_Labelbg" left="103" top="26" width="334" height="27"/>
              <Static id="Static12" taborder="45" cssclass="sta_WF_Labelbg" left="103" top="104" width="334" height="27"/>
              <Static id="Static06" taborder="42" cssclass="sta_WF_Labelbg" left="551" top="104" height="27" right="0"/>
              <Static id="Static05" taborder="41" cssclass="sta_WF_Labelbg" left="103" top="78" width="334" height="27"/>
              <Static id="Static37" taborder="40" cssclass="sta_WF_Labelbg" left="103" top="0" height="27" width="334"/>
              <Static id="Static00" taborder="0" text="원인행위번호" left="0" top="0" height="27" cssclass="sta_WF_Label" width="104"/>
              <Static id="Static01" taborder="1" text="품의금액" cssclass="sta_WF_Label" left="448" top="104" height="27" width="104"/>
              <Static id="Static02" taborder="2" text="품의일자" cssclass="sta_WF_Label" left="0" top="52" height="27" wordwrap="char" width="104"/>
              <Static id="Static15" taborder="15" text="부서" cssclass="sta_WF_Label" left="0" top="78" height="27" width="104"/>
              <MaskEdit id="msk_cnsulAmount" taborder="17" left="554" top="107" height="21" mask="#,###" width="110" cssclass="msk_WF_Essential"/>
              <Calendar id="Calendar03" taborder="35" left="106" top="55" height="21" style="align:center;" width="110" enable="true" cssclass="cal_WF_Readonly" dateformat="yyyy-MM-dd" readonly="true"/>
              <Edit id="Edit00" taborder="39" left="106" top="3" height="21" width="110" cssclass="edt_WF_Readonly" readonly="true"/>
              <Static id="Static04" taborder="46" text="품의제목" cssclass="sta_WF_Label" left="0" top="26" width="104" height="27"/>
              <Edit id="edt_cnsulSj" taborder="47" left="106" top="29" width="328" height="21" cssclass="edt_WF_Essential" lengthunit="utf8" maxlength="100"/>
              <Static id="Static03" taborder="48" text="계정구분" cssclass="sta_WF_Label" left="448" top="0" width="104" height="27"/>
              <Static id="Static08" taborder="49" cssclass="sta_WF_Labelbg" left="551" top="0" height="27" right="0"/>
              <Static id="Static09" taborder="50" text="예산계정과목" wordwrap="char" cssclass="sta_WF_Label" left="448" top="26" width="104" height="27"/>
              <Static id="Static10" taborder="51" cssclass="sta_WF_Labelbg" left="551" top="26" height="27" right="0"/>
              <Static id="Static13" taborder="52" text="부기코드" cssclass="sta_WF_Label" left="448" top="52" width="104" height="27"/>
              <Static id="Static14" taborder="53" cssclass="sta_WF_Labelbg" left="551" top="52" height="27" right="0"/>
              <Static id="Static16" taborder="57" text="이월구분" cssclass="sta_WF_Label" left="666" top="0" width="104" height="27"/>
              <Combo id="Combo00" taborder="58" readonly="true" innerdataset="@ds_bdg001" codecolumn="CODE" datacolumn="CODE_NM" cssclass="cmb_WF_Readonly" left="554" top="3" width="110" height="21"/>
              <Edit id="Edit01" taborder="59" readonly="true" cssclass="edt_WF_Readonly" left="666" top="29" width="362" height="21"/>
              <Edit id="edt_budgetAcntCode" taborder="60" readonly="true" cssclass="edt_WF_Essential" left="555" top="29" width="110" height="21"/>
              <Edit id="Edit03" taborder="61" readonly="true" cssclass="edt_WF_Readonly" left="666" top="55" width="362" height="21"/>
              <Edit id="Edit04" taborder="62" readonly="true" cssclass="edt_WF_Readonly" left="555" top="55" width="110" height="21"/>
              <Static id="Static17" taborder="63" text="결재상태" cssclass="sta_WF_Label" left="218" top="0" width="104" height="27"/>
              <Static id="Static18" taborder="64" text="사업코드" cssclass="sta_WF_Label" left="448" top="78" width="104" height="27"/>
              <Static id="Static19" taborder="65" cssclass="sta_WF_Labelbg" left="551" top="78" height="27" right="0"/>
              <Edit id="Edit05" taborder="66" readonly="true" cssclass="edt_WF_Readonly" left="555" top="81" width="110" height="21"/>
              <Edit id="Edit06" taborder="67" readonly="true" cssclass="edt_WF_Readonly" left="666" top="81" width="362" height="21"/>
              <Static id="Static20" taborder="68" text="품의집행금액" cssclass="sta_WF_Label" left="666" top="104" width="104" height="27"/>
              <MaskEdit id="MaskEdit00" taborder="69" readonly="true" mask="#,###" cssclass="msk_WF_Readonly" left="772" top="107" width="110" height="21"/>
              <Static id="Static21" taborder="70" text="품의회수금액" cssclass="sta_WF_Label" left="448" top="130" width="104" height="27"/>
              <Static id="Static22" taborder="72" cssclass="sta_WF_Labelbg" left="551" top="130" height="27" right="0"/>
              <MaskEdit id="msk_cnsulRtrvlAmount" taborder="71" mask="#,###" left="554" top="133" width="110" height="21" cssclass="msk_WF_Readonly" readonly="true"/>
              <Static id="Static23" taborder="73" text="품의잔액" cssclass="sta_WF_Label" left="666" top="130" width="104" height="27"/>
              <MaskEdit id="MaskEdit03" taborder="74" readonly="true" mask="#,###" cssclass="msk_WF_Readonly" left="772" top="133" width="110" height="21"/>
              <Static id="Static24" taborder="75" text="배정잔액(세목)" cssclass="sta_WF_Label" left="448" top="156" width="104" height="27"/>
              <Static id="Static25" taborder="77" cssclass="sta_WF_Labelbg" left="551" top="156" height="27" right="0"/>
              <MaskEdit id="MaskEdit04" taborder="76" readonly="true" mask="#,###" cssclass="msk_WF_Readonly" left="554" top="159" width="110" height="21"/>
              <Combo id="Combo01" taborder="78" readonly="true" cssclass="cmb_WF_Readonly" left="324" top="3" width="110" height="21" innerdataset="@ds_com022" codecolumn="CODE" datacolumn="CODE_NM"/>
              <Static id="Static26" taborder="79" text="사원" cssclass="sta_WF_Label" left="0" top="104" width="104" height="27"/>
              <Static id="Static27" taborder="80" text="품의내역" cssclass="sta_WF_Label" left="0" top="130" width="104" height="53"/>
              <Static id="Static28" taborder="81" cssclass="sta_WF_Labelbg" left="103" top="130" width="334" height="53"/>
              <TextArea id="txt_sumry" taborder="82" left="106" top="134" width="327" height="46" lengthunit="utf8" maxlength="200" cssclass="txt_WF_Essential"/>
              <Div id="div_EMP" taborder="83" url="com::empno.xfdl" text="Div00" left="106" top="107" width="328" height="21" onkeyup="div_SEARCH_div_EMP_onkeyup" async="false"/>
              <Edit id="Edit07" taborder="84" left="106" top="81" width="85" height="21" cssclass="edt_WF_Readonly" readonly="true"/>
              <Edit id="Edit08" taborder="85" left="193" top="81" width="241" height="21" cssclass="edt_WF_Readonly" readonly="true"/>
              <Button id="btn_cnsulBlceRtrvl" taborder="86" text="품의잔액회수" onclick="btn_onclick" cssclass="btn_WF_Process" left="884" bottom="31" width="84" height="19"/>
              <Button id="btn_budgetAcntPopup" taborder="87" onclick="btn_onclick" cssclass="btn_WF_Search" left="644" bottom="135" width="22" height="19"/>
              <Static id="Static29" taborder="88" text="부기잔액" cssclass="sta_WF_Label" left="666" top="156" width="104" height="27"/>
              <MaskEdit id="MaskEdit01" taborder="89" readonly="true" mask="#,###" cssclass="msk_WF_Readonly" left="772" top="159" width="110" height="21"/>
              <Combo id="cbo_CYFD_SE" taborder="90" readonly="false" innerdataset="@ds_acc046" codecolumn="CODE" datacolumn="CODE_NM" left="773" top="3" width="110" height="21" cssclass="cmb_WF_Essential"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="div_SEARCH" taborder="0" text="Div00" left="0" top="0" right="28" height="59" cssclass="div_WFSA_Box">
          <Layouts>
            <Layout>
              <Static id="sta_EMPL_SE00" taborder="36" text="품의일자" wordwrap="char" left="16" top="5" height="21" cssclass="sta_WFSA_Label" width="64"/>
              <Calendar id="Calendar00" taborder="1" left="80" top="5" height="21" width="100" dateformat="yyyy-MM-dd" value="null" cssclass="cal_WF_Essential"/>
              <Static id="Static00" taborder="39" text="~" left="182" top="5" height="21" style="align:center;" width="15"/>
              <Calendar id="Calendar01" taborder="2" left="199" top="5" height="21" width="100" dateformat="yyyy-MM-dd" value="null" cssclass="cal_WF_Essential"/>
              <Static id="sta_EMPL_SE03" taborder="45" text="제목" wordwrap="char" left="562" top="5" height="21" cssclass="sta_WFSA_Label" width="38"/>
              <Edit id="Edit00" taborder="3" left="600" top="5" height="21" width="195"/>
              <Static id="Static09" taborder="48" text="15" visible="false" left="0" top="0" width="15" height="59" style="background:#00ffff66;"/>
              <Div id="div_srchDept" taborder="53" url="com::deptCode.xfdl" left="352" top="5" width="195" height="21" async="false" enable="true"/>
              <Static id="sta_DEPT_CODE" taborder="54" text="부서" wordwrap="char" cssclass="sta_WFSA_Label" left="314" top="5" width="38" height="21"/>
              <Static id="sta_EMPL_SE01" taborder="55" text="결재상태" wordwrap="char" cssclass="sta_WFSA_Label" left="16" top="31" width="64" height="21" onclick="div_SEARCH_sta_EMPL_SE01_onclick"/>
              <Combo id="cmb_srchSancKnd" taborder="56" left="80" top="31" width="110" height="21" innerdataset="@ds_com022" codecolumn="CODE" datacolumn="CODE_NM" onitemchanged="div_SEARCH_cmb_srchSancKnd_onitemchanged"/>
              <Static id="sta_EMPL_SE02" taborder="57" text="지출결의여부" wordwrap="char" cssclass="sta_WFSA_Label" left="205" top="31" width="90" height="21"/>
              <Combo id="cmb_expDsnAt" taborder="58" innerdataset="@ds_acc045" codecolumn="CODE" datacolumn="CODE_NM" left="295" top="31" width="110" height="21"/>
              <Static id="Static01" taborder="59" text="15" visible="false" left="299" top="0" width="15" height="20" style="background:#00ffff66;"/>
              <Static id="Static02" taborder="60" text="15" visible="false" left="547" top="0" width="15" height="59" style="background:#00ffff66;"/>
              <Static id="Static03" taborder="61" text="15" visible="false" left="190" top="31" width="15" height="20" style="background:#00ffff66;"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static03" taborder="24" text="15" visible="false" left="1031" top="0" width="15" height="735" style="background:#1b3cd23c;align:center middle;"/>
        <Static id="Static05" taborder="25" text="스&#13;&#10;크&#13;&#10;롤&#13;&#10;13" visible="false" top="0" right="0" width="13" height="735" style="background:#d07b173c;align:center middle;"/>
        <Static id="Static36" taborder="26" text="10" visible="false" left="0" top="59" width="1031" height="10" style="background:#dc143c3c;align:center middle;"/>
        <Static id="Static04" taborder="27" text="품의내역" cssclass="sta_WF_Title02" left="0" top="66" right="873" height="19"/>
        <Static id="Static11" taborder="28" text="5" visible="false" left="0" top="80" right="27" height="5" style="background:#dc143c3c;align:center middle;"/>
        <Static id="Static00" taborder="29" text="품의상세정보" cssclass="sta_WF_Title03" height="19" width="186" left="0" bottom="349"/>
        <Grid id="grd_cnsul" taborder="31" useinputpanel="false" left="0" top="84" right="28" binddataset="ds_cnsul" autosizingtype="row" autofittype="col" oncelldblclick="grd_cnsul_oncelldblclick" extendsizetype="row" bottom="372">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="70"/>
                <Column size="90"/>
                <Column size="200"/>
                <Column size="100"/>
                <Column size="120"/>
                <Column size="70"/>
                <Column size="150"/>
                <Column size="120"/>
                <Column size="110"/>
                <Column size="256"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="결재상태"/>
                <Cell col="1" text="원인행위번호"/>
                <Cell col="2" text="품의제목"/>
                <Cell col="3" text="품의일자"/>
                <Cell col="4" text="부서"/>
                <Cell col="5" text="성명"/>
                <Cell col="6" text="예산계정과목명"/>
                <Cell col="7" text="부기명"/>
                <Cell col="8" text="품의금액"/>
                <Cell col="9" text="품의내역"/>
              </Band>
              <Band id="body">
                <Cell displaytype="image" text="expr:comp.parent.fn_get_imgUrl(SANCTN_KND)" autosizecol="default"/>
                <Cell col="1" text="bind:CAUSE_ACTION_NO" autosizecol="default"/>
                <Cell col="2" style="align:left;" text="bind:CNSUL_SJ"/>
                <Cell col="3" displaytype="date" text="bind:CNSUL_DE" calendardisplay="edit" calendardisplaynulltype="none" autosizecol="default"/>
                <Cell col="4" text="bind:DEPT_NM" autosizecol="default"/>
                <Cell col="5" text="bind:EMPNM" autosizecol="default"/>
                <Cell col="6" style="align:left middle;padding:0 0 0 5;" text="bind:BUDGET_ACNT_NM"/>
                <Cell col="7" style="align:left middle;padding:0 0 0 5;" text="bind:BUKIP_NM"/>
                <Cell col="8" displaytype="number" style="align:right;" text="bind:CNSUL_AMOUNT" autosizecol="default"/>
                <Cell col="9" displaytype="text" style="align:left;" text="bind:SUMRY" wordwrap="char" autosizerow="limitmin"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static01" taborder="32" text="품의예산정보" cssclass="sta_WF_Title03" left="450" width="186" height="19" bottom="349"/>
        <Button id="btn_sanRegist3" taborder="33" text="기타" width="45" height="19" style="background:#ff9999ff;border:1 solid #ff4d4dff ;color:#333333ff;" left="393" bottom="349" onclick="btn_sanRegist_onclick" cssclass="btn_Red_Emphasis"/>
        <Button id="btn_sanRegist2" taborder="34" text="공과금" onclick="btn_sanRegist_onclick" left="345" bottom="349" width="45" height="19" style="background:#ff9999ff;border:1 solid #ff4d4dff ;color:#333333ff;" cssclass="btn_Red_Emphasis"/>
        <Button id="btn_sanRegist1" taborder="35" text="급여" onclick="btn_sanRegist_onclick" left="297" bottom="349" width="45" height="19" style="background:#ff9999ff;border:1 solid #ff4d4dff ;color:#333333ff;" cssclass="btn_Red_Emphasis"/>
        <Static id="Static02" taborder="36" text="5" visible="false" left="0" top="363" right="27" height="5" style="background:#dc143c3c;align:center middle;"/>
        <Static id="Static06" taborder="37" text="5" visible="false" left="0" top="573" right="27" height="5" style="background:#dc143c3c;align:center middle;"/>
        <Static id="Static07" taborder="38" text="첨부파일" cssclass="sta_WF_Title03" left="0" bottom="138" width="186" height="19"/>
        <Static id="Static08" taborder="39" text="5" visible="false" left="0" top="597" right="27" height="5" style="background:#dc143c3c;align:center middle;"/>
        <Grid id="grd_cmmnAtchmnfl" taborder="40" binddataset="ds_fileList" autoenter="select" useinputpanel="false" cellsizingtype="col" autofittype="col" left="0" bottom="0" height="133" right="28" onheadclick="grd_cmmnAtchmnfl_onheadclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="65"/>
                <Column size="300"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="40"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="checkbox" edittype="checkbox"/>
                <Cell col="1" text="파일형식"/>
                <Cell col="2" celltype="head" text="파일명"/>
                <Cell col="3" text="확장자"/>
                <Cell col="4" text="사이즈"/>
              </Band>
              <Band id="body">
                <Cell displaytype="checkbox" edittype="checkbox" text="bind:CHK"/>
                <Cell col="1" displaytype="image" text="bind:FILE_IMAGE" autosizerow="limitmin" autosizecol="limitmin"/>
                <Cell col="2" displaytype="normal" style="align:left middle;" text="bind:ORGINL_FILE_NM"/>
                <Cell col="3" text="bind:FILE_EXTSN"/>
                <Cell col="4" text="bind:FILE_MG"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_delFiles" taborder="41" text="선택삭제" onclick="btn_click" cssclass="btn_WF_Process" width="67" height="19" bottom="138" right="188"/>
        <Button id="btn_uploadFiles" taborder="42" text="파일업로드" onclick="btn_click" cssclass="btn_WF_Process" width="68" height="19" bottom="138" right="116"/>
        <Button id="btn_downFiles" taborder="43" text="선택다운로드" onclick="btn_click" cssclass="btn_WF_Process" width="85" height="19" bottom="138" right="28"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cond" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="SRCH_ST_DE" type="STRING" size="256"/>
          <Column id="SRCH_ED_DE" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="CNSUL_SJ" type="STRING" size="256"/>
          <Column id="SANCTN_KND" type="STRING" size="256"/>
          <Column id="EXP_DSN_AT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_validation" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="compId" type="STRING" size="256"/>
          <Column id="colId" type="STRING" size="256"/>
          <Column id="PK" type="STRING" size="256"/>
          <Column id="notNull" type="STRING" size="256"/>
          <Column id="type" type="STRING" size="256"/>
          <Column id="nlength" type="STRING" size="256"/>
          <Column id="from" type="STRING" size="256"/>
          <Column id="to" type="STRING" size="256"/>
          <Column id="lengthChkGb" type="STRING" size="256"/>
          <Column id="msgId" type="STRING" size="256"/>
          <Column id="expr" type="STRING" size="256"/>
          <Column id="func" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="compId">ds_cond</Col>
            <Col id="colId">SRCH_ST_DE</Col>
            <Col id="notNull">Y</Col>
            <Col id="from">SRCH_ST_DE</Col>
            <Col id="to">SRCH_ED_DE</Col>
            <Col id="msgId">품의일자</Col>
          </Row>
          <Row>
            <Col id="compId">ds_cond</Col>
            <Col id="colId">SRCH_ED_DE</Col>
            <Col id="notNull">Y</Col>
            <Col id="from">SRCH_ST_DE</Col>
            <Col id="to">SRCH_ED_DE</Col>
            <Col id="msgId">품의일자</Col>
          </Row>
          <Row>
            <Col id="compId">ds_cnsul</Col>
            <Col id="colId">CNSUL_SJ</Col>
            <Col id="notNull">Y</Col>
            <Col id="nlength"/>
            <Col id="msgId">품의제목</Col>
            <Col id="lengthChkGb"/>
          </Row>
          <Row>
            <Col id="compId">ds_cnsul</Col>
            <Col id="colId">EMPNO</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">사원</Col>
          </Row>
          <Row>
            <Col id="compId">ds_cnsul</Col>
            <Col id="colId">BUDGET_ACNT_CODE</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">예산계정과목</Col>
          </Row>
          <Row>
            <Col id="compId">ds_cnsul</Col>
            <Col id="colId">CNSUL_AMOUNT</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">품의금액</Col>
          </Row>
          <Row>
            <Col id="compId">ds_cnsul</Col>
            <Col id="colId">SUMRY</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">품의내역</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_bdg001" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_bdg002" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cnsul" useclientlayout="true" onrowsetchanged="ds_cnsul_onrowsetchanged" onrowposchanged="ds_cnsul_onrowposchanged">
        <ColumnInfo>
          <Column id="CAUSE_ACTION_NO" type="STRING" size="256"/>
          <Column id="BUDGET_YEAR" type="STRING" size="256"/>
          <Column id="BSNS_SE" type="STRING" size="256"/>
          <Column id="BALC_SE" type="STRING" size="256"/>
          <Column id="BSNS_CODE" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_CODE" type="STRING" size="256"/>
          <Column id="BUKIP_CODE" type="STRING" size="256"/>
          <Column id="EMPNO" type="STRING" size="256"/>
          <Column id="CNSUL_SJ" type="STRING" size="256"/>
          <Column id="CNSUL_DE" type="STRING" size="256"/>
          <Column id="CNSUL_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="CNSUL_RTRVL_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="SUMRY" type="STRING" size="256"/>
          <Column id="REGISTER_ID" type="STRING" size="256"/>
          <Column id="REGIST_DT" type="STRING" size="256"/>
          <Column id="UPDUSR_ID" type="STRING" size="256"/>
          <Column id="UPDT_DT" type="STRING" size="256"/>
          <Column id="BUDGET_ACNT_NM" type="STRING" size="256"/>
          <Column id="BUKIP_NM" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="EMPNM" type="STRING" size="256"/>
          <Column id="DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="CNSUL_BLCE" type="BIGDECIMAL" size="22"/>
          <Column id="BUDGET_BLCE" type="BIGDECIMAL" size="22"/>
          <Column id="BSNS_NM" type="STRING" size="256"/>
          <Column id="SANCTN_KND" type="STRING" size="256"/>
          <Column id="GWAN_NM" type="STRING" size="256"/>
          <Column id="HANG_NM" type="STRING" size="256"/>
          <Column id="SEHANG_NM" type="STRING" size="256"/>
          <Column id="MOK_NM" type="STRING" size="256"/>
          <Column id="SEMOK_NM" type="STRING" size="256"/>
          <Column id="BUDGET_AM" type="BIGDECIMAL" size="256"/>
          <Column id="BUDGET_DECSN_AMOUNT" type="BIGDECIMAL" size="256"/>
          <Column id="SANCTN_NO" type="STRING" size="256"/>
          <Column id="BUDGET_DEPT_CODE" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_BLCE" type="BIGDECIMAL" size="22"/>
          <Column id="EXECUT_BUDGET_JAN_AM" type="BIGDECIMAL" size="22"/>
          <Column id="ASIGN_JAN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="DCSN_DE" type="STRING" size="256"/>
          <Column id="ASIGN_AMOUNT" type="BIGDECIMAL" size="256"/>
          <Column id="FILE_SN" type="STRING" size="256"/>
          <Column id="CYFD_SE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_com022" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_enfrcSanc" useclientlayout="true">
        <ColumnInfo>
          <Column id="CAUSE_ACTION_NO" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond_file" firenextcount="0" useclientlayout="true">
        <ColumnInfo>
          <Column id="FILE_SN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_fileList" firenextcount="0" useclientlayout="true">
        <ColumnInfo>
          <Column id="FILE_SN" type="BIGDECIMAL" size="20"/>
          <Column id="FILE_ORDR" type="INT" size="3"/>
          <Column id="FILE_STRE_COURS" type="STRING" size="2000"/>
          <Column id="STRE_FILE_NM" type="STRING" size="255"/>
          <Column id="ORGINL_FILE_NM" type="STRING" size="255"/>
          <Column id="FILE_EXTSN" type="STRING" size="20"/>
          <Column id="FILE_CN" type="STRING" size="4000"/>
          <Column id="FILE_MG" type="INT" size="8"/>
          <Column id="USE_AT" type="STRING" size="1"/>
          <Column id="FILE_ID" type="STRING" size="256"/>
          <Column id="SN" type="INT" size="5"/>
          <Column id="SYS_SE_CODE" type="STRING" size="6"/>
          <Column id="JOB_SE" type="STRING" size="3"/>
          <Column id="FILE_TY" type="STRING" size="256"/>
          <Column id="FILE_IMAGE" type="STRING" size="256"/>
          <Column id="PROGRS" type="INT" size="5"/>
          <Column id="TRNSMIS_FILE_SIZE" type="INT" size="256"/>
          <Column id="DELETE_IMAGE" type="STRING" size="256"/>
          <Column id="STTUS" type="STRING" size="256"/>
          <Column id="FILE_KEY" type="STRING" size="256"/>
          <Column id="CHK" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_acc045" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_acc046" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item23" compid="div_SEARCH.Calendar00" propid="value" datasetid="ds_cond" columnid="SRCH_ST_DE"/>
      <BindItem id="item25" compid="div_SEARCH.Calendar01" propid="value" datasetid="ds_cond" columnid="SRCH_ED_DE"/>
      <BindItem id="item2" compid="div_detail1.msk_cnsulAmount" propid="value" datasetid="ds_cnsul" columnid="CNSUL_AMOUNT"/>
      <BindItem id="item4" compid="div_detail1.Calendar03" propid="value" datasetid="ds_cnsul" columnid="CNSUL_DE"/>
      <BindItem id="item1" compid="div_SEARCH.Edit00" propid="value" datasetid="ds_cond" columnid="CNSUL_SJ"/>
      <BindItem id="item12" compid="div_detail1.Edit00" propid="value" datasetid="ds_cnsul" columnid="CAUSE_ACTION_NO"/>
      <BindItem id="item16" compid="div_detail1.edt_cnsulSj" propid="value" datasetid="ds_cnsul" columnid="CNSUL_SJ"/>
      <BindItem id="item14" compid="div_detail1.Combo00" propid="value" datasetid="ds_cnsul" columnid="BSNS_SE"/>
      <BindItem id="item8" compid="div_detail1.Edit01" propid="value" datasetid="ds_cnsul" columnid="BUDGET_ACNT_NM"/>
      <BindItem id="item10" compid="div_detail1.edt_budgetAcntCode" propid="value" datasetid="ds_cnsul" columnid="BUDGET_ACNT_CODE"/>
      <BindItem id="item13" compid="div_detail1.Edit03" propid="value" datasetid="ds_cnsul" columnid="BUKIP_NM"/>
      <BindItem id="item11" compid="div_detail1.Edit04" propid="value" datasetid="ds_cnsul" columnid="BUKIP_CODE"/>
      <BindItem id="item0" compid="div_detail1.Edit05" propid="value" datasetid="ds_cnsul" columnid="BSNS_CODE"/>
      <BindItem id="item3" compid="div_detail1.Edit06" propid="value" datasetid="ds_cnsul" columnid="BSNS_NM"/>
      <BindItem id="item5" compid="div_detail1.MaskEdit00" propid="value" datasetid="ds_cnsul" columnid="DECSN_AMOUNT"/>
      <BindItem id="item6" compid="div_detail1.msk_cnsulRtrvlAmount" propid="value" datasetid="ds_cnsul" columnid="CNSUL_RTRVL_AMOUNT"/>
      <BindItem id="item7" compid="div_detail1.MaskEdit03" propid="value" datasetid="ds_cnsul" columnid="CNSUL_BLCE"/>
      <BindItem id="item9" compid="div_detail1.MaskEdit04" propid="value" datasetid="ds_cnsul" columnid="ASIGN_JAN_AMOUNT"/>
      <BindItem id="item15" compid="div_detail1.txt_sumry" propid="value" datasetid="ds_cnsul" columnid="SUMRY"/>
      <BindItem id="item18" compid="div_detail1.Edit07" propid="value" datasetid="ds_cnsul" columnid="DEPT_CODE"/>
      <BindItem id="item19" compid="div_detail1.Edit08" propid="value" datasetid="ds_cnsul" columnid="DEPT_NM"/>
      <BindItem id="item17" compid="div_SEARCH.cmb_srchSancKnd" propid="value" datasetid="ds_cond" columnid="SANCTN_KND"/>
      <BindItem id="item22" compid="div_detail1.Edit01" propid="tooltiptext" datasetid="ds_cnsul" columnid="BUDGET_ACNT_NM"/>
      <BindItem id="item20" compid="div_detail1.Combo01" propid="value" datasetid="ds_cnsul" columnid="SANCTN_KND"/>
      <BindItem id="item24" compid="div_detail1.MaskEdit01" propid="value" datasetid="ds_cnsul" columnid="EXECUT_BUDGET_JAN_AM"/>
      <BindItem id="item26" compid="div_SEARCH.cmb_expDsnAt" propid="value" datasetid="ds_cond" columnid="EXP_DSN_AT"/>
      <BindItem id="item21" compid="div_detail1.cbo_CYFD_SE" propid="value" datasetid="ds_cnsul" columnid="CYFD_SE"/>
    </Bind>
    <Script type="xscript5.0"><![CDATA[/***********************************************************************
 * 화면ID   : ACC020201
 * 화면명   : 원인행위등록
 * 화면설명 : 원인행위를 등록한다.
 * 작성일   : 2017.07.20
 * 작성자   : 이상명
 * 수정이력 : 
 ***********************************************************************
 *     수정일     수정자   내용
 ***********************************************************************
 *    
 ***********************************************************************
 */

/***********************************************************************
 * Script Include 
 ************************************************************************/
// 시스템 공통 라이브러리 Include
include "mis_lib::misUtil.xjs";
include "lib::comInclude.xjs";
include "lib::comUpDownUtils.xjs";

/***********************************************************************
 * 화면 변수 선언부
 ***********************************************************************/
this.File_UpDownManager = null;

/***********************************************************************
 * onInit / onLoad 영역
 ***********************************************************************/
this.ACC020201_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{
	// Form 초기화
	this.fn_misFormInit(this);
	this.fn_init_form(); 

	// DataSet 초기화
	this.fn_init_dataset();

	// 파일 메니저 설정
	var fileConfig = {
		useMultiUpload : true,
		onChange: this.fn_onFileSelected,	// 파일 선택 이벤트 핸들러
		onSuccess : this.fn_onFileSuccess	// 전송 성공 이벤트 핸들러
	};
	this.File_UpDownManager = new this.fileUpDownManager(this, "MIS", "ACC");
	this.File_UpDownManager.init(fileConfig);
	
	// 공통코드
	var comboParams = [
		 ["ds_bdg001", "BDG001", "Y", "D", "B"]	// 사업구분
		,["ds_bdg002", "BDG002", "Y", "D", "B"]	// 수지구분
		,["ds_com022", "COM022", "Y", "전체", "B"]	// 결재상태
		,["ds_acc045", "ACC045", "Y", "전체", "B"]	// 지출결의등록여부
		,["ds_acc046", "ACC046", "Y", "D", "B"]	// 이월구분
	];
	var callback = function (svcId, errorCode, errorMsg) {
		// 조회 이벤트 / 함수 호출
		
		var today = this.dateUtils.today();
		
		this.ds_cond.clearData();
		this.ds_cond.addRow();
		this.ds_cond.setColumn(0, "SRCH_ST_DE", today.substr(0,6)+"01");
		this.ds_cond.setColumn(0, "SRCH_ED_DE", this.dateUtils.getLastDay(today,"s"));
		this.ds_cond.setColumn(0, "DEPT_CODE", this.gfn_getDeptId()  );	// 부서코드
		this.ds_cond.setColumn(0, "DEPT_NM",   this.gfn_getDeptName());	// 부서명
		this.ds_cond.setColumn(0, "SANCTN_KND", "");
		this.ds_cond.setColumn(0, "EXP_DSN_AT", "");
		this.fn_search();
	};
	this.gfn_comboLoad (comboParams, callback);
}

/***********************************************************************
 * Form/Dataset 오브젝트 초기화
 ***********************************************************************/
 
/*
 * 함수명  	: initForm
 * 설명 		: Form을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initForm();
 */
this.fn_init_form = function()
{
	// 데이터셋 동적 바인딩
	this.div_SEARCH.div_srchDept.fn_setBind("ds_cond","DEPT_CODE","DEPT_NM");
	this.div_detail1.div_EMP.fn_setBind("ds_cnsul","EMPNO","EMPNM");

	if(this.gfn_authGrpId("ACC_ADMIN") == -1 && this.gfn_authGrpId("ACC_USER") == -1 && this.gfn_authGrpId("BDG_TIMHDER") == -1 && this.gfn_authGrpId("BDG_ADMIN") == -1) {
         this.div_SEARCH.div_srchDept.fn_setReadonly(true);
    }

	// 시스템 공통으로 Form을 Initialize 한다.
	this.gfn_initForm(this);

}

/*
 * 함수명  	: initDataset
 * 설명 		: Dataset을 초기화한다.
 *                주로, 조건 Dataset들(ds_cond, ds_cond_00, ds_cond_01, ...) 을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initDataset();
 */
this.fn_init_dataset = function()
{
	this.gfn_initCondDs(this, this.div_search);
	
	// 조건 Dataset 외에 초기화가 필요한 Dataset에 대한 초기화 코드를 추가한다.
	// TODO
	var fileConfig = {
		useMultiUpload : true,
		onChange: this.fn_onFileSelected,	// 파일 선택 이벤트 핸들러
		onSuccess : this.fn_onFileSuccess	// 전송 성공 이벤트 핸들러
	};
	this.File_UpDownManager = new this.fileUpDownManager(this, "PMS", "PRJ");
	this.File_UpDownManager.init(fileConfig);
}

/**********************************************************************
 * CALL TRANSACTION 영역
 **********************************************************************/
 
/*
 * 함수명  	: fn_transaction
 * 설명 		: Transaction 요청 처리 함수
 * params  		: strSvcId : 서비스요청 ID
 * return Type 	: None
 * 사용법		: this.fn_transaction("SELECT");
 */
this.fn_transaction = function(strSvcId)
{
	switch (strSvcId) {
		case "SRCH": // 원인행위 목록
			var sController   	= "hsco/mis/acc/ACC020201/cnsulList.do";
			var sInDatasets   	= "input1=ds_cond";
			var sOutDatasets  	= "ds_cnsul=output1";
			break;
		case "SAVE": // 원인행위 저장
			var sController   	= "hsco/mis/acc/ACC020201/cnsulCUD.do";
			var sInDatasets   	= "input1=ds_cnsul:U";
			var sOutDatasets  	= "";
			break;
		case "enfrcSanc": // 원인행위 저장
			var sController   	= "hsco/mis/acc/ACC020201/enfrcSanc.do";
			var sInDatasets   	= "input1=ds_enfrcSanc:U";
			var sOutDatasets  	= "";
			break;
		// ======== 첨부파일 관련 transaction ========
		case "selectAtchFile":
			var sController  = "hsco/mis/acc/ACC020201/selectAtchFile.do";
			var sInDatasets  = "input1=ds_cond_file";
			var sOutDatasets = "ds_fileList=output1";
			break;
		case "deleteFile":
			var sController  = "hsco/cmm/file/deleteFile.do";
			var sInDatasets  = "input1=ds_fileList:U";
			var sOutDatasets = "ds_fileList=output1";
			break;
	}

	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets); 
}

 /**********************************************************************
 * Transaction Callback 영역
 ***********************************************************************/

 /*
 * 함수명  	: fn_callBack
 * 설명 		: Transaction Callback 처리
 * params  		: strSvcId    : 서비스요청 ID
 *                nErrorCode  : 오류 메시지 코드 ([예] 0 : Success, 그밖의 경우, error)
 *                strErrorMsg : 오류 메시지([예]  success.insert|정상적으로 등록되었습니다.)
 * return Type 	: None
 * 사용법		: 
 */
this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg)
{
	
	if (nErrorCode != 0) {
		// 오류 및 성공 메시지를 화면에 보여준다.
		this.gfn_callback_message(strSvcId, nErrorCode, strErrorMsg);
	} else {
		// 성공 메시지를 보여주는 동작 외에 처리할 내용이 있으면 아래에 기술.
		// 처리할 내용이 없다면, switch 문은 생략합니다.
		switch(strSvcId) {
			case "SRCH":
				break;
			case "SAVE":
				this.fn_transaction("SRCH");
				break;
			case "enfrcSanc":
				this.fn_transaction("SRCH");
				break;
			// ======== 첨부파일 관련 transaction ========
			case "selectAtchFile":
				break;
			case "deleteFile":
				this.fn_transaction("selectAtchFile");
				break;
			default:
				break;
		}
	}
}

/**********************************************************************
* 공통 Button 관련 이벤트 처리
***********************************************************************/

/*
 * 함수명  	: fn_search
 * 설명 		: 조회
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_search();
 */
this.fn_search = function()
{	
	// validation 체크
	if(!this.gfn_checkValidation_NoUpdChk(this.ds_cond, this.ds_validation)) {
		return false;
	}
	this.ds_fileList.clearData();
	this.fn_transaction("SRCH");
}

/*
 * 함수명  	: fn_save
 * 설명 		: 저장
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_save();
 */
this.fn_save= function()
{
	// validation 체크
	if(!this.gfn_checkValidation_NoUpdChk(this.ds_cnsul, this.ds_validation)) {
		return false;
	}
	this.fn_transaction("SAVE");
}

/*
 * 함수명  	: fn_insert
 * 설명 		: 원인행위 생성
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_insert();
 */
this.fn_insert = function()
{
	var nRow = this.ds_cnsul.insertRow(0);
	this.ds_cnsul.setColumn(nRow, "CNSUL_DE"	, this.dateUtils.today());
	this.ds_cnsul.setColumn(nRow, "DEPT_CODE"	, application.gds_userInfo.getColumn(0,"DEPT_CODE"));
	this.ds_cnsul.setColumn(nRow, "DEPT_NM"		, application.gds_userInfo.getColumn(0,"DEPT_NM"));
	this.ds_cnsul.setColumn(nRow, "EMPNO"		, application.gds_userInfo.getColumn(0,"EMPNO"));
	this.ds_cnsul.setColumn(nRow, "EMPNM"		, application.gds_userInfo.getColumn(0,"EMPNM"));
	this.ds_cnsul.setColumn(nRow, "CYFD_SE", "0");
	
	this.btn_uploadFiles.set_enable(true);
	this.btn_delFiles.set_enable(true);
	this.ds_fileList.clearData();
}


/*
 * 함수명  	: fn_delete
 * 설명 		: 원인행위 삭제
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_delete();
 */
this.fn_delete= function()
{	
	var nRow = this.ds_cnsul.rowposition;
	if(nRow > -1) {
		if(['1','4','5'].indexOf(this.ds_cnsul.getColumn(this.ds_cnsul.rowposition, "SANCTN_KND")) > -1) {
			this.gfn_message("info.처리불가","결재가 진행중이거나 완료된 데이터는 삭제할 수 없습니다.");
			return;
		}
		
		if(this.ds_cnsul.getColumn(this.ds_cnsul.rowposition, "EMPNO") != this.fn_getEmpno() && this.gfn_authGrpId("ALL_ADMIN") == -1){
			this.gfn_message("info.처리불가","해당 원인행위 담당자만 삭제할 수 있습니다.");
			return;
		}
		
		this.ds_cnsul.deleteRow(nRow);
		
		// 첨부파일
		this.ds_cond_file.clearData();
		var nRow = this.ds_cond_file.addRow();
		this.ds_cond_file.setColumn(nRow, "FILE_SN",   this.ds_cnsul.getColumn(nRow, "FILE_SN"));
		
		this.fn_transaction("selectAtchFile");
	}
}


/*
 * 함수명  	: fn_cancel
 * 설명 		: 취소 버튼 이벤트 처리(Dataset 변경 내역 Reset)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_cancel();
 */
this.fn_cancel= function()
{
	if(this.gfn_message("confirm.취소여부") ){
		this.ds_cnsul.reset();
		this.ds_cnsul.applyChange();
	}	

}

/*
 * 함수명  	: fn_sanction
 * 설명 		: 결재 버튼 이벤트 처리(Dataset 변경 내역 Reset)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_sanction();
 */
this.fn_sanction = function()
{
	var currow = this.ds_cnsul.rowposition;
	
	// 결재 전 유효성 체크
	if(this.comUtils.isDatasetUpdated(this.ds_cnsul)) {
		this.gfn_message("comm.정보.저장.요청", "품의내역");
		return;
	}
	
	if(currow < 0) {
		this.gfn_message("info.선택데이터.없음.선택.요청");
		return;
	}
	
	if(['1','4','5'].indexOf(this.ds_cnsul.getColumn(currow, "SANCTN_KND")) > -1) {
      this.gfn_message("info.처리불가","결재가 진행중이거나 완료된 데이터는 결재할 수 없습니다.");
      return;
	}
	
	if(this.ds_cnsul.getColumn(currow, "EMPNO") != this.fn_getEmpno()){
		this.gfn_message("info.처리불가","해당 원인행위 담당자만 결재할 수 있습니다.");
		return;
	}
	
	if(this.ds_cnsul.getColumn(currow, "EXECUT_BUDGET_JAN_AM") < 0) {
		this.gfn_message("info.처리불가","부기 잔액이 초과되었습니다.");
		return;
	}
	
	var cnsulAmount = this.ds_cnsul.getColumn(currow,"CNSUL_AMOUNT");		// 품의금액
	
	// 2020.10.22
	// 결재시 개행문자 인식하지 못해 수정
	//var enter = String.fromCharCode(13);
	var enter = "\\r\\n";
	
	var sumry = this.comUtils.isNull(this.ds_cnsul.getColumn(currow,"SUMRY")) ? " ○○○○○○" : this.ds_cnsul.getColumn(currow,"SUMRY");
	var porpose = sumry + enter + enter;
	porpose    += " 1. 구입금액 : ";
	porpose    += "일금"+this.fn_numToHangul(cnsulAmount)+"원정" + "(￦" + this.comUtils.formatComma(cnsulAmount) + ")" + enter;
	//porpose    += " 2. 예산현황 : ";
	
	
	// 결재상신
	var arrSancData = new Array();
	arrSancData[ 0] = "[품의]"+this.ds_cnsul.getColumn(currow,"CNSUL_SJ");								//결재제목
	arrSancData[ 1] = "";																				//계약의뢰일자
	arrSancData[ 2] = this.ds_cnsul.getColumn(currow,"DEPT_NM");										//기안부서
	arrSancData[ 3] = porpose;		// 집행목적
	arrSancData[ 4] = this.comUtils.formatComma(this.ds_cnsul.getColumn(currow,"BUDGET_AM"));			//예산액
	arrSancData[ 5] = this.comUtils.formatComma(this.ds_cnsul.getColumn(currow,"BUDGET_DECSN_AMOUNT"));	//기집행액
	arrSancData[ 6] = this.comUtils.formatComma(this.ds_cnsul.getColumn(currow,"CNSUL_AMOUNT"));		//금회집행액
	arrSancData[ 7] = this.comUtils.formatComma(this.ds_cnsul.getColumn(currow,"BUDGET_BLCE"));			//집행잔액
	arrSancData[ 8] = "";																				//비고
	arrSancData[ 9] = this.ds_cnsul.getColumn(currow,"SUMRY");											//품의내역_비고
	arrSancData[10] = "일금"+this.fn_numToHangul(cnsulAmount)+"원정" + "(￦" + this.comUtils.formatComma(cnsulAmount) + ")";		//소요예산액
	arrSancData[11] = "";																				//소요예산조치일
	arrSancData[12] = "일금"+this.fn_numToHangul(this.ds_cnsul.getColumn(currow,"ASIGN_AMOUNT"))+"원정" + "(￦" + this.comUtils.formatComma(this.ds_cnsul.getColumn(currow,"ASIGN_AMOUNT")) + ")";		//소요예산배정액
	arrSancData[13] = this.fn_dateStr(this.ds_cnsul.getColumn(currow,"DCSN_DE"),".");					//소요예산배정일
	arrSancData[14] = "";																				//소요예산재원내역
	arrSancData[15] = this.ds_cnsul.getColumn(currow,"GWAN_NM");										//관
	arrSancData[16] = this.ds_cnsul.getColumn(currow,"HANG_NM");										//항
	arrSancData[17] = this.ds_cnsul.getColumn(currow,"SEHANG_NM");										//세항
	arrSancData[18] = this.ds_cnsul.getColumn(currow,"MOK_NM");											//목
	arrSancData[19] = this.ds_cnsul.getColumn(currow,"SEMOK_NM") + "(" + this.ds_cnsul.getColumn(currow,"BUKIP_NM") + ")";	//세목(부기)

	this.fn_callHandySanc2(
		 this						// context
		,'0000000070'				// formId
		,this.ds_cnsul				// misDataset
		,"TBACC_CNSUL"				// tableName
		,["CAUSE_ACTION_NO"]		// tableKey
		,arrSancData				// arrSancData
		,null						// subData
		,null						// multiCheck(0 or 1)
		,null						// otherColumn
		,this.ds_fileList			// file Dataset
	);
}

/*
 * 함수명  	: btn_onclick
 * 설명 		: 버튼 클릭 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_onclick();
 */
this.btn_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	switch(obj.name) {
		case "btn_budgetAcntPopup":	// 예산계정과목 팝업
		
			var dsTemp = new Dataset();
			dsTemp.copyData(this.ds_cnsul);
			dsTemp.clearData();
			dsTemp.addRow();
			dsTemp.copyRow(0, this.ds_cnsul, this.ds_cnsul.rowposition);
			var parm = {
				  arg_0      : this
				 ,searchDs   : dsTemp.saveXML()       	// 검색조건(YEAR, BSNS_SE, BALC_SE, DEPT_CODE 컬럼만 이용)
				 ,strObj     : "rdo_BALC_SE" 			// 수정불가능 처리할 오브젝트 명(ex : "edt_YEAR,cbo_BSNS_SE,rdo_BALC_SE,div_srchDept")
				 ,year_S     : dsTemp.getColumn(0,"BUDGET_YEAR")         // 예산년도(srchDs보다 우선순위를 가짐)
				 ,bsnsSe_S   : null         // 사업구분(srchDs보다 우선순위를 가짐)
				 ,balcSe_S   : null         // 수지구분(srchDs보다 우선순위를 가짐)
				 ,deptCode_S : null         // 부서코드(srchDs보다 우선순위를 가짐)
				 ,acntPopup  : false        // (true : 예산계정코드선택팝업, false : 부기선택팝업)
				 ,acntCode_S : null         // 고정 처리할 예산계정코드 목록 (0000000)
				 ,bAccPopup  : true
			};
			this.gfn_popup("btn_budgetAcntPopup", 800, 620, "예산계정과목", parm, "com::bdgAcntPop.xfdl", "fn_popupCallBack", true);
			break;
		case "btn_cnsulBlceRtrvl":	// 품의잔액회수
			var currow 		= this.ds_cnsul.rowposition;
			if(this.gfn_message("confirm.삭제.진행","품의잔액을 전액 회수합니다.") ){
				var rtrvlAmt 	= this.ds_cnsul.getColumn(currow, "CNSUL_RTRVL_AMOUNT");
				var cnsulBlce 	= this.ds_cnsul.getColumn(currow, "CNSUL_BLCE");
				this.ds_cnsul.setColumn(this.ds_cnsul.rowposition, "CNSUL_RTRVL_AMOUNT", rtrvlAmt + cnsulBlce);
				this.ds_cnsul.setColumn(this.ds_cnsul.rowposition, "CNSUL_BLCE", "0");
			}
			break;
		default:
			break;
	}
}

/*
 * 함수명  	: fn_popupCallBack
 * 설명 		: 팝업창 콜백 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_popupCallBack();
 */
this.fn_popupCallBack = function(strID, variant)
{

	switch(strID) {
		case "btn_budgetAcntPopup":	// 예산계정과목 팝업 콜백
			if(variant != null && variant.length > 0) {
				var nRow = this.ds_cnsul.rowposition;
				var dsTemp = new Dataset();
				dsTemp.loadXML(variant);
				this.ds_cnsul.setColumn(nRow, "BUDGET_YEAR", 		dsTemp.getColumn(0, "YEAR"));					// 예산년도
				this.ds_cnsul.setColumn(nRow, "BSNS_SE", 			dsTemp.getColumn(0, "BSNS_SE"));				// 사업구분
				this.ds_cnsul.setColumn(nRow, "BALC_SE", 			dsTemp.getColumn(0, "BALC_SE"));				// 수지구분
				this.ds_cnsul.setColumn(nRow, "BUDGET_ACNT_CODE", 	dsTemp.getColumn(0, "BUDGET_ACNT_CODE"));		// 예산계정코드
				this.ds_cnsul.setColumn(nRow, "BUDGET_ACNT_NM", 	dsTemp.getColumn(0, "BUDGET_TREE_NM"));			// 예산계정명
				this.ds_cnsul.setColumn(nRow, "BUDGET_BLCE", 		dsTemp.getColumn(0, "BUDGET_BALC"));			// 예산잔액
				this.ds_cnsul.setColumn(nRow, "EXPNDTR_UNIT_BLCE", 	dsTemp.getColumn(0, "EXPNDTR_UNIT_BALC"));		// 부기잔액
				this.ds_cnsul.setColumn(nRow, "BUKIP_CODE", 		dsTemp.getColumn(0, "EXPNDTR_UNIT_CODE"));		// 부기코드
				this.ds_cnsul.setColumn(nRow, "BUKIP_NM", 			dsTemp.getColumn(0, "EXPNDTR_UNIT_NM"));		// 부기코드명
				this.ds_cnsul.setColumn(nRow, "BSNS_CODE",			dsTemp.getColumn(0, "DETAIL_BSNS_CODE"));		// 사업지구코드
				this.ds_cnsul.setColumn(nRow, "BSNS_NM",			dsTemp.getColumn(0, "DETAIL_BSNS_NM"));			// 사업지구명
				this.ds_cnsul.setColumn(nRow, "BUDGET_DEPT_CODE", 	dsTemp.getColumn(0, "DEPT_CODE"));				// 부서코드
				this.ds_cnsul.setColumn(nRow, "EXECUT_BUDGET_JAN_AM", "");
			}
			break;
		default:
			break;
	}
	
}


this.ds_cnsul_onrowposchanged = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{
	if(e.newrow > -1) {
		switch(obj.getRowType(e.newrow)) {
			case Dataset.ROWTYPE_INSERT:
				this.div_detail1.btn_cnsulBlceRtrvl.set_enable(false);
				break;
			default:
				this.div_detail1.btn_cnsulBlceRtrvl.set_enable(true);
				break;
		}
		
		if(obj.getColumn(e.newrow, "SANCTN_KND") == '0' && obj.getColumn(e.newrow, "EMPNO") == this.fn_getEmpno()) {
			this.btn_sanRegist1.set_enable(true);
			this.btn_sanRegist1.style.set_border("#ff4d4dff");
			this.btn_sanRegist1.style.set_background("#ff9999ff");
			this.btn_sanRegist2.set_enable(true);
			this.btn_sanRegist2.style.set_border("#ff4d4dff");
			this.btn_sanRegist2.style.set_background("#ff9999ff");
			this.btn_sanRegist3.set_enable(true);
			this.btn_sanRegist3.style.set_border("#ff4d4dff");
			this.btn_sanRegist3.style.set_background("#ff9999ff");
		}else{
			this.btn_sanRegist1.set_enable(false);
			this.btn_sanRegist1.style.set_border("#a6a6a6ff");
			this.btn_sanRegist1.style.set_background("#aaaaaaff");
			this.btn_sanRegist2.set_enable(false);
			this.btn_sanRegist2.style.set_border("#a6a6a6ff");
			this.btn_sanRegist2.style.set_background("#aaaaaaff");
			this.btn_sanRegist3.set_enable(false);
			this.btn_sanRegist3.style.set_border("#a6a6a6ff");
			this.btn_sanRegist3.style.set_background("#aaaaaaff");
		}
		
		var case1 = (['1','4','5'].indexOf(obj.getColumn(e.newrow, "SANCTN_KND")) > -1);
		var case2 = obj.getRowType(e.newrow) == Dataset.ROWTYPE_INSERT ? false : (obj.getColumn(e.newrow, "EMPNO") != this.fn_getEmpno());
		if(case1 || case2) {
			this.div_detail1.edt_cnsulSj.set_readonly(true);
			this.div_detail1.edt_cnsulSj.set_cssclass("edt_WF_Readonly");
			this.div_detail1.txt_sumry.set_readonly(true);
			this.div_detail1.txt_sumry.set_cssclass("txt_WF_Readonly");
			this.div_detail1.edt_budgetAcntCode.set_cssclass("edt_WF_Readonly");
			this.div_detail1.msk_cnsulAmount.set_readonly(true);
			this.div_detail1.msk_cnsulAmount.set_cssclass("msk_WF_Readonly");
			this.div_detail1.btn_budgetAcntPopup.set_enable(false);
			this.div_detail1.div_EMP.fn_set_readonly(true);		
				
			this.div_detail1.cbo_CYFD_SE.set_readonly(true);
			this.div_detail1.cbo_CYFD_SE.set_cssclass("edt_WF_Readonly");
			
			if(obj.getRowType(e.newrow) != Dataset.ROWTYPE_INSERT){
				this.btn_uploadFiles.set_enable(false);
				this.btn_delFiles.set_enable(false);
			}else{
				this.btn_uploadFiles.set_enable(true);
				this.btn_delFiles.set_enable(true);
			}
		} else {
			this.div_detail1.edt_cnsulSj.set_readonly(false);
			this.div_detail1.edt_cnsulSj.set_cssclass("edt_WF_Essential");
			this.div_detail1.txt_sumry.set_readonly(false);
			this.div_detail1.txt_sumry.set_cssclass("txt_WF_Essential");
			this.div_detail1.edt_budgetAcntCode.set_cssclass("edt_WF_Essential");
			this.div_detail1.msk_cnsulAmount.set_readonly(false);
			this.div_detail1.msk_cnsulAmount.set_cssclass("msk_WF_Essential");
			this.div_detail1.btn_budgetAcntPopup.set_enable(true);
			this.div_detail1.div_EMP.fn_set_readonly(false);
			
			this.div_detail1.cbo_CYFD_SE.set_readonly(false);
			this.div_detail1.cbo_CYFD_SE.set_cssclass("");
			
			this.btn_uploadFiles.set_enable(true);
			this.btn_delFiles.set_enable(true);
		}
		
		// 첨부파일
		this.ds_cond_file.clearData();
		var nRow = this.ds_cond_file.addRow();
		this.ds_cond_file.setColumn(nRow, "FILE_SN",   obj.getColumn(e.newrow, "FILE_SN"));
		
		this.fn_transaction("selectAtchFile");
	}
}

this.ds_cnsul_onrowsetchanged = function(obj:Dataset, e:nexacro.DSRowsetChangeEventInfo)
{
	switch(e.reason) {
		case Dataset.REASON_APPEND:
			this.div_detail1.btn_cnsulBlceRtrvl.set_enable(false);
			this.div_detail1.edt_cnsulSj.set_readonly(false);
			this.div_detail1.edt_cnsulSj.set_cssclass("edt_WF_Essential");
			this.div_detail1.txt_sumry.set_readonly(false);
			this.div_detail1.txt_sumry.set_cssclass("txt_WF_Essential");
			this.div_detail1.edt_budgetAcntCode.set_cssclass("edt_WF_Essential");
			this.div_detail1.msk_cnsulAmount.set_readonly(false);
			this.div_detail1.msk_cnsulAmount.set_cssclass("msk_WF_Essential");
			this.div_detail1.btn_budgetAcntPopup.set_enable(true);
			this.div_detail1.div_EMP.fn_set_readonly(false);
			this.div_detail1.cbo_CYFD_SE.set_readonly(false);
			this.div_detail1.cbo_CYFD_SE.set_cssclass("");
			break;
	}
}

this.fn_get_imgUrl = function(sanctnKnd)
{
	return this.gfn_getSanctnImgUrl(sanctnKnd);
}

this.grd_cnsul_oncelldblclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	if(e.col == 0) {
		var nRow = this.ds_cnsul.rowposition;
		if(['1','2','3','4','5'].indexOf(this.ds_cnsul.getColumn(nRow, "SANCTN_KND")) > -1) {
			this.fn_openSanc(this.ds_cnsul.getColumn(nRow, "SANCTN_NO"));
		}
	}
}

/*
 * 함수명  	: btn_sanRegist_onclick
 * 설명 		: 강제 결재완료
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_sanRegist_onclick();
 */
this.btn_sanRegist_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(Ex.util.isUpdated(this.ds_cnsul)) {
		this.gfn_message("comm.정보.저장.요청","먼저 변경된 품의");
	}else{
		if(this.gfn_message("confirm.삭제.진행","[내부결재가 필요없는 건에 한하여 해당기능을 이용해주세요]\n결재상태를 강제로 완료처리 합니다. ") ){
			this.ds_enfrcSanc.clearData();
			this.ds_enfrcSanc.addRow();
			this.ds_enfrcSanc.setColumn(0, "CAUSE_ACTION_NO", this.ds_cnsul.getColumn(this.ds_cnsul.rowposition, "CAUSE_ACTION_NO"));
			this.fn_transaction("enfrcSanc");
		}
	}
}


/**********************************************************************
* 첨부파일 관련
***********************************************************************/

this.grd_cmmnAtchmnfl_onheadclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	if(e.col == "0") {
		this.gfn_setGridCheckAll(obj, e);
	}
}

/*
 * 함수명  	: btn_click
 * 설명 		: Grid Cell 클릭 후 이벤트 처리(첨부파일)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.grd_file_oncellclick(obj,e);
 */
this.btn_click = function(obj:Button, e:nexacro.ClickEventInfo)
{
	// 업로드
	if(obj.name == "btn_uploadFiles") {
		// 첨부파일 업로드(fileSn 자동채번 / 첨부파일 Master에 ROW추가 / 파일 업로드 및 자동저장 / 테이블에 fileSn반영 / 데이터셋에 fileSn반영, 단 신규 ROW가 아닐경우 ROWTYPE은 유지)
		this.fn_autoFileSn(
			 "MIS"									// 대분류   (SYS_SE)
			,"ACC"									// 업무구분 (JOB_SE)
			, this.File_UpDownManager				// fileManager 오브젝트
			, this.ds_fileList						// fileObject
			, this.ds_cnsul							// fileSn을 불러오거나 반영해야 하는 컬럼
			, "TBACC_CNSUL"							// fileSn을 저장할 테이블
			, "FILE_SN"								// fileSn 컬럼명이 다를 경우를 대비
			, ["CAUSE_ACTION_NO"]					// fileSn을 저장할 테이블의 PK (FileSn 확인 및 자동반영목적)
		);
	}
	
	// 삭제
	if(obj.name == "btn_delFiles") {
		var findRow = this.ds_fileList.findRow("CHK", "1");
		if(findRow < 0) {
			this.gfn_message("comm.데이터.선택.없음");
				return;
		}
		
		if(!this.gfn_message("confirm.선택파일.삭제여부", "들")){
			return false;
		}
		
		for(var fRow = this.ds_fileList.getRowCount()-1; fRow >= 0; fRow--) {
			var chkVal = this.ds_fileList.getColumn(fRow, "CHK");
			if(chkVal == '1') {
				this.ds_fileList.deleteRow(fRow);
			}
		}
		
		var strSvcId   	 = "deleteFile";
		var sController  = "hsco/mis/mis/MIS000000/deleteFile.do";
		var sInDatasets  = "input1=ds_fileList:U";
		var sOutDatasets = "ds_fileList=output1";
		
		Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets);
	}
	
	// 다운로드
	if(obj.name == "btn_downFiles") {
		var findRow = this.ds_fileList.findRow("CHK", "1");
		if(findRow < 0) {
			this.gfn_message("comm.데이터.선택.없음");
			return;
		}
		
		for(var fRow = 0; fRow < this.ds_fileList.getRowCount(); fRow++) {
			var fileSn    = this.ds_fileList.getColumn(fRow, "FILE_SN");
			var fileOrder = this.ds_fileList.getColumn(fRow, "FILE_ORDR");
			var fileName  = this.ds_fileList.getColumn(fRow, "ORGINL_FILE_NM");
			var chk       = this.ds_fileList.getColumn(fRow, "CHK");
			if(chk == '1') {
				this.File_UpDownManager.download(fileSn, fileOrder, fileName);
			}
		}
		if(this.ds_fileList.getRowCount() == 0) {
			this.gfn_message("err.파일.다운로드.정보없음");
			return false;
		}
	}
}]]></Script>
  </Form>
</FDL>
