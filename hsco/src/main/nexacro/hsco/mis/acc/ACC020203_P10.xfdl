<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\default_typedef.xml"/>
  <Form id="ACC020203_P10" classname="UI_ACC020203_P10" left="0" top="0" width="902" height="751" titletext="지출결의서(법인카드)" onload="ACC020203_P10_onload" scrollbars="autoboth" style="font:8 Gulim;">
    <Layouts>
      <Layout>
        <Tab id="tab" taborder="11" left="14" top="396" tabindex="0" scrollbars="autoboth" width="875" style="showextrabutton:false;" onchanged="tab_onchanged" bottom="0">
          <Tabpages>
            <Tabpage id="tabpage1" text="세부내용">
              <Layouts>
                <Layout width="885" height="281">
                  <Grid id="grd" taborder="0" binddataset="ds_expDsnDetail" useinputpanel="false" extendsizetype="row" autosizingtype="row" left="0" top="5" height="117" autofittype="col" width="873">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="120"/>
                          <Column size="300"/>
                          <Column size="200"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="순번"/>
                          <Cell col="1" text="결의금액"/>
                          <Cell col="2" text="영수자"/>
                          <Cell col="3" text="계좌번호"/>
                        </Band>
                        <Band id="body">
                          <Cell text="expr:currow+1"/>
                          <Cell col="1" displaytype="number" style="align:right;" text="bind:DECSN_AMOUNT"/>
                          <Cell col="2" style="align:left;" text="bind:RCPT_MAN" wordwrap="char" autosizerow="limitmin"/>
                          <Cell col="3" style="align:left;" text="bind:ACNUTNO"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Div id="div_detail00" taborder="1" left="0" top="153" height="157" cssclass="div_detailBox" width="873">
                    <Layouts>
                      <Layout width="476" height="122">
                        <Static id="Static27" taborder="46" cssclass="sta_WF_Labelbg" left="83" top="0" height="27" width="790"/>
                        <Static id="Static15" taborder="47" cssclass="sta_WF_Labelbg" left="83" top="26" height="27" width="790"/>
                        <Static id="Static17" taborder="49" cssclass="sta_WF_Labelbg" left="83" top="52" height="27" width="790"/>
                        <Static id="Static18" taborder="50" cssclass="sta_WF_Labelbg" left="83" top="78" height="27" width="790"/>
                        <Static id="Static19" taborder="51" cssclass="sta_WF_Labelbg" left="83" top="104" height="27" width="790"/>
                        <Static id="Static00" taborder="32" text="결의금액" cssclass="sta_WF_Label" left="0" top="0" width="104" height="27"/>
                        <Static id="Static02" taborder="34" text="영수일자" wordwrap="char" cssclass="sta_WF_Label" left="0" top="52" width="104" height="27"/>
                        <Static id="Static06" taborder="36" text="거래처" cssclass="sta_WF_Label" left="0" top="26" width="104" height="27"/>
                        <Static id="Static07" taborder="38" text="지급은행" wordwrap="char" cssclass="sta_WF_Label" left="0" top="78" width="104" height="27"/>
                        <Static id="Static11" taborder="39" text="계좌번호" cssclass="sta_WF_Label" left="321" top="78" width="116" height="27"/>
                        <MaskEdit id="msk_caActAmt00" taborder="0" mask="###,###,###,###,###" left="106" top="3" width="110" height="21" limitbymask="integer" cssclass="msk_WF_Readonly" readonly="true"/>
                        <Static id="Static05" taborder="40" text="공급가액" cssclass="sta_WF_Label" left="218" top="0" width="104" height="27"/>
                        <MaskEdit id="msk_caActAmt05" taborder="3" mask="###,###,###,###,###" left="324" top="3" width="110" height="21" limitbymask="integer" readonly="true" cssclass="msk_WF_Readonly"/>
                        <Edit id="Edit04" taborder="4" left="106" top="29" height="21" width="110" cssclass="edt_WF_Readonly" readonly="false"/>
                        <Edit id="Edit05" taborder="5" left="218" top="29" height="21" width="434" cssclass="edt_WF_Readonly" readonly="false"/>
                        <Static id="Static04" taborder="41" text="부가세액" cssclass="sta_WF_Label" left="436" top="0" width="104" height="27"/>
                        <MaskEdit id="msk_caActAmt01" taborder="7" mask="###,###,###,###,###" left="542" top="3" width="110" height="21" limitbymask="integer" readonly="true" cssclass="msk_WF_Readonly"/>
                        <Static id="Static08" taborder="42" text="부가세여부" cssclass="sta_WF_Label" left="654" top="0" width="104" height="27"/>
                        <Combo id="Combo00" taborder="9" left="760" top="3" width="110" height="21" innerdataset="@ds_acc005" codecolumn="CODE" datacolumn="CODE_NM" readonly="false"/>
                        <Static id="Static09" taborder="43" text="대표자성명" cssclass="sta_WF_Label" left="654" top="26" width="104" height="27"/>
                        <Edit id="Edit06" taborder="6" left="760" top="29" height="21" width="110" maxlength="15" readonly="true" cssclass="edt_WF_Readonly"/>
                        <Calendar id="Calendar00" taborder="10" left="106" top="55" height="21" width="110" dateformat="yyyy-MM-dd" value="null" readonly="false"/>
                        <Static id="Static12" taborder="44" text="영수자" cssclass="sta_WF_Label" left="218" top="52" width="104" height="27"/>
                        <Edit id="edt_rcptMan" taborder="11" left="324" top="55" width="110" height="21" maxlength="15" readonly="true" cssclass="edt_WF_Readonly"/>
                        <Edit id="edt_acnutno" taborder="14" left="439" top="81" width="213" height="21" inputtype="number" maxlength="20" readonly="false" lengthunit="utf8"/>
                        <Combo id="cmd_fnncInstt" taborder="13" left="106" top="81" width="213" height="21" innerdataset="@ds_fnncInstt" codecolumn="FNNC_INSTT_CODE" datacolumn="FNNC_INSTT_CODE_NM" readonly="false"/>
                        <Static id="Static13" taborder="45" text="기업구분" cssclass="sta_WF_Label" left="654" top="78" width="104" height="27"/>
                        <Combo id="cmb_entrprsSe" taborder="15" left="760" top="81" width="110" height="21" codecolumn="codecolumn" datacolumn="datacolumn">
                          <Dataset id="innerdataset">
                            <ColumnInfo>
                              <Column id="codecolumn" size="256"/>
                              <Column id="datacolumn" size="256"/>
                            </ColumnInfo>
                            <Rows>
                              <Row>
                                <Col id="codecolumn"/>
                                <Col id="datacolumn"/>
                              </Row>
                              <Row>
                                <Col id="codecolumn">2</Col>
                                <Col id="datacolumn">대기업/기타</Col>
                              </Row>
                              <Row>
                                <Col id="codecolumn">1</Col>
                                <Col id="datacolumn">중소기업</Col>
                              </Row>
                            </Rows>
                          </Dataset>
                        </Combo>
                        <Button id="btn_bcncPopup" taborder="52" cssclass="btn_WF_Search" left="195" top="29" width="21" height="21" onclick="fn_popup_onclick" enable="false"/>
                        <Static id="Static20" taborder="53" cssclass="sta_WF_Labelbg" left="83" top="130" width="790" height="27"/>
                        <Static id="Static21" taborder="54" text="제품구분" cssclass="sta_WF_Label" left="0" top="104" width="104" height="53"/>
                        <Div id="div_PrductSe" taborder="55" text="Div00" left="106" top="108" width="761" height="46">
                          <Layouts>
                            <Layout>
                              <CheckBox id="chk_evrfrnd" taborder="16" text="친환경" value="0" truevalue="1" falsevalue="0" left="0" top="0" width="60" height="20"/>
                              <CheckBox id="chk_tcndvlp" taborder="17" text="기술개발" value="0" truevalue="1" falsevalue="0" left="62" top="0" width="73" height="20"/>
                              <CheckBox id="chk_cntrwkPrposMtril" taborder="18" text="공사용자재" value="0" truevalue="1" falsevalue="0" left="137" top="0" width="86" height="20"/>
                              <CheckBox id="chk_areaEntrps" taborder="19" text="지역업체" value="0" truevalue="1" falsevalue="0" left="225" top="1" width="73" height="20"/>
                              <CheckBox id="chk_femaleEntrprs" taborder="20" text="여성기업" value="0" truevalue="1" falsevalue="0" left="300" top="1" width="73" height="20"/>
                              <CheckBox id="chk_dspsn" taborder="21" text="장애인" value="0" truevalue="1" falsevalue="0" left="375" top="1" width="60" height="20"/>
                              <CheckBox id="chk_srsillDspsn" taborder="22" text="중증장애인" value="0" truevalue="1" falsevalue="0" left="437" top="1" width="86" height="20"/>
                              <CheckBox id="chk_soctyEntrprs" taborder="23" text="사회적기업" value="0" truevalue="1" falsevalue="0" left="525" top="1" width="86" height="20"/>
                              <CheckBox id="chk_greenPrduct" taborder="24" text="녹색제품" value="0" truevalue="1" falsevalue="0" left="613" top="1" width="73" height="20"/>
                              <CheckBox id="chk_dspsnPrdctnFclty" taborder="25" text="장애인생산시설" value="0" truevalue="1" falsevalue="0" left="0" top="26" width="112" height="20"/>
                              <CheckBox id="chk_soctyCperMxtr" taborder="26" text="사회적협동조합" value="0" truevalue="1" falsevalue="0" left="114" top="26" width="112" height="20"/>
                              <CheckBox id="CheckBox11" taborder="27" text="장애인표준사업장" value="0" truevalue="1" falsevalue="0" left="228" top="26" width="125" height="20"/>
                              <CheckBox id="CheckBox14" taborder="28" text="물산업" value="0" truevalue="1" falsevalue="0" left="355" top="26" width="65" height="20"/>
                              <CheckBox id="CheckBox15" taborder="29" text="의료산업" value="0" truevalue="1" falsevalue="0" left="422" top="26" width="73" height="20"/>
                              <CheckBox id="CheckBox16" taborder="30" text="농업산업" value="0" truevalue="1" falsevalue="0" left="497" top="26" width="73" height="20"/>
                              <CheckBox id="CheckBox17" taborder="31" text="에너지산업" value="0" truevalue="1" falsevalue="0" left="572" top="26" width="86" height="20"/>
                            </Layout>
                          </Layouts>
                        </Div>
                        <Static id="Static01" taborder="56" text="주소" cssclass="sta_WF_Label" left="436" top="52" width="104" height="27"/>
                        <Edit id="Edit09" taborder="57" maxlength="100" left="542" top="55" width="328" height="21"/>
                      </Layout>
                    </Layouts>
                  </Div>
                  <Static id="Static10" taborder="3" cssclass="sta_WF_Labelbg" left="0" top="127" right="0" height="27"/>
                  <Static id="Static04" taborder="4" text="실사용자" cssclass="sta_WF_Label" left="0" top="127" width="104" height="27"/>
                  <Edit id="edt_ATNDNC_MAN" taborder="7" maxlength="100" left="324" top="130" width="213" height="21" readonly="true" cssclass="edt_WF_Readonly"/>
                  <Static id="Static12" taborder="5" text="참석자" wordwrap="char" cssclass="sta_WF_Label" left="218" top="127" width="104" height="27"/>
                  <Static id="Static00" taborder="8" text="사유" wordwrap="char" cssclass="sta_WF_Label" left="539" top="127" width="58" height="27"/>
                  <Edit id="edt_PRVONSH" taborder="10" maxlength="100" left="599" top="130" width="271" height="21" readonly="true" cssclass="edt_WF_Readonly"/>
                  <Edit id="edt_rcptMan00" taborder="13" readonly="true" maxlength="15" enable="true" left="106" top="130" width="110" height="21" oneditclick="tab_tabpage1_edt_rcptMan00_oneditclick" cssclass="edt_WF_Readonly"/>
                  <Static id="Static11" taborder="14" text="10" visible="false" left="0" top="122" height="5" style="background:#dc143c3c;align:center middle;" right="0"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage2" text="지출결의내역">
              <Layouts>
                <Layout width="885" height="251">
                  <Grid id="grd" taborder="0" binddataset="ds_expDsnDtls" useinputpanel="false" left="0" top="5" autofittype="col" autoenter="select" right="0" bottom="15">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="51"/>
                          <Column size="160"/>
                          <Column size="434"/>
                          <Column size="120"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="순번"/>
                          <Cell col="1" cssclass="Cellgrd_WF_HeadEssential" text="금액"/>
                          <Cell col="2" cssclass="Cellgrd_WF_HeadEssential" text="사유"/>
                          <Cell col="3" text="성명"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:SEQ"/>
                          <Cell col="1" displaytype="number" edittype="masknumber" style="align:right;" text="bind:AMOUNT" mask="###,###,###,###,###" editlimitbymask="integer"/>
                          <Cell col="2" edittype="text" style="align:left;" text="bind:SUMRY" editlimit="100"/>
                          <Cell col="3" edittype="text" text="bind:NM" editlimit="15"/>
                        </Band>
                        <Band id="summary">
                          <Cell text="합계"/>
                          <Cell col="1" displaytype="number" style="align:right;" text="expr:dataset.getSum(&quot;AMOUNT&quot;)"/>
                          <Cell col="2"/>
                          <Cell col="3"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage3" text="첨부파일">
              <Layouts>
                <Layout>
                  <Grid id="grd_file" taborder="0" binddataset="ds_fileList" useinputpanel="false" left="0" top="5" right="0" bottom="15" oncelldblclick="tab_tabpage3_grd_file_oncelldblclick">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="65"/>
                          <Column size="500"/>
                          <Column size="80"/>
                          <Column size="80"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="40"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="checkbox" edittype="checkbox"/>
                          <Cell col="1" text="파일형식"/>
                          <Cell col="2" celltype="head" text="파일명"/>
                          <Cell col="3" text="확장자"/>
                          <Cell col="4" text="사이즈"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="checkbox" edittype="checkbox" text="bind:CHK"/>
                          <Cell col="1" displaytype="image" text="bind:FILE_IMAGE" autosizerow="limitmin" autosizecol="limitmin"/>
                          <Cell col="2" displaytype="normal" style="align:left middle;" text="bind:ORGINL_FILE_NM"/>
                          <Cell col="3" text="bind:FILE_EXTSN"/>
                          <Cell col="4" text="bind:FILE_MG"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Div id="div_detail1" taborder="5" left="15" top="181" height="208" cssclass="div_detailBox" width="415">
          <Layouts>
            <Layout>
              <Static id="Static17" taborder="35" cssclass="sta_WF_Labelbg" left="79" top="156" right="165" height="27"/>
              <Static id="Static10" taborder="23" cssclass="sta_WF_Labelbg" left="0" top="104" right="0" height="27"/>
              <Static id="Static04" taborder="22" cssclass="sta_WF_Labelbg" left="0" top="78" right="0" height="27"/>
              <Static id="Static27" taborder="15" cssclass="sta_WF_Labelbg" left="0" top="0" height="27" right="0"/>
              <Static id="Static08" taborder="17" cssclass="sta_WF_Labelbg" left="0" top="52" height="27" right="0"/>
              <Static id="Static07" taborder="16" cssclass="sta_WF_Labelbg" left="0" top="26" height="27" right="0"/>
              <Static id="Static01" taborder="10" text="예산계정" cssclass="sta_WF_Label" left="0" top="26" height="27" width="70"/>
              <Static id="Static02" taborder="11" text="부기" wordwrap="char" cssclass="sta_WF_Label" left="0" top="78" height="53" width="80"/>
              <Edit id="edt_bukipCode" taborder="7" left="82" top="81" height="21" width="120" cssclass="edt_WF_Essential" readonly="true"/>
              <Edit id="Edit01" taborder="8" left="82" top="107" height="21" width="330" cssclass="edt_WF_Readonly" readonly="true"/>
              <Edit id="Edit04" taborder="4" left="73" top="29" height="21" width="120" cssclass="edt_WF_Readonly" readonly="true"/>
              <Static id="Static03" taborder="12" text="결의번호" cssclass="sta_WF_Label" left="0" top="0" width="70" height="27"/>
              <Edit id="Edit02" taborder="5" left="3" top="55" width="409" height="21" cssclass="edt_WF_Readonly" readonly="true"/>
              <Edit id="Edit05" taborder="2" left="73" top="3" width="120" height="21" cssclass="edt_WF_Readonly" readonly="true"/>
              <MaskEdit id="msk_caActAmt" taborder="6" mask="###,###,###,###,###" left="264" top="29" width="148" height="21" cssclass="msk_WF_Readonly" readonly="true" limitbymask="integer"/>
              <Static id="Static05" taborder="13" text="배정잔액" cssclass="sta_WF_Label" left="196" top="26" width="65" height="27"/>
              <Static id="Static06" taborder="14" text="부기잔액" cssclass="sta_WF_Label" left="204" top="78" width="70" height="27"/>
              <MaskEdit id="msk_caActAmt00" taborder="9" mask="###,###,###,###,###" left="276" top="81" width="136" height="21" cssclass="msk_WF_Readonly" readonly="true" limitbymask="integer"/>
              <Static id="Static09" taborder="18" text="예산구분" cssclass="sta_WF_Label" left="196" top="0" width="65" height="27"/>
              <Combo id="Combo01" taborder="0" cssclass="cmb_WF_Readonly" left="264" top="3" width="86" height="21" innerdataset="@ds_bdg001" codecolumn="CODE" datacolumn="CODE_NM" readonly="true" index="-1"/>
              <Button id="btn_budgetAcntPopup" taborder="19" onclick="fn_popup_onclick" cssclass="btn_WF_Search" left="59" top="94" width="21" height="21"/>
              <Static id="Static00" taborder="29" text="거래유형" cssclass="sta_WF_Label" left="0" top="130" width="80" height="27"/>
              <Static id="Static11" taborder="30" text="차변" cssclass="sta_WF_Label" left="79" top="130" width="168" height="27" style="align:center middle;"/>
              <Static id="Static14" taborder="31" text="대변" cssclass="sta_WF_Label" left="246" top="130" width="169" height="27" style="align:center middle;"/>
              <Static id="Static15" taborder="32" cssclass="sta_WF_Labelbg" left="0" top="156" right="335" height="27"/>
              <Edit id="Edit03" taborder="34" readonly="true" cssclass="edt_WF_Essential" left="82" top="159" width="162" height="21"/>
              <Static id="Static18" taborder="36" cssclass="sta_WF_Labelbg" left="246" top="156" right="0" height="27"/>
              <Edit id="Edit06" taborder="37" readonly="true" cssclass="edt_WF_Essential" left="249" top="159" width="163" height="21"/>
              <Static id="Static16" taborder="38" cssclass="sta_WF_Labelbg" left="79" top="181" right="165" height="27"/>
              <Static id="Static19" taborder="39" cssclass="sta_WF_Labelbg" left="0" top="181" right="335" height="27"/>
              <Edit id="Edit07" taborder="40" readonly="true" cssclass="edt_WF_Essential" left="82" top="184" width="162" height="21"/>
              <Static id="Static20" taborder="41" cssclass="sta_WF_Labelbg" left="246" top="181" right="0" height="27"/>
              <Edit id="Edit08" taborder="42" readonly="true" cssclass="edt_WF_Essential" left="249" top="184" width="163" height="21"/>
              <Button id="btn_atmcJrnlzTy" taborder="43" onclick="fn_popup_onclick" cssclass="btn_WF_Search" left="59" top="133" width="21" height="21"/>
              <Edit id="Edit09" taborder="44" readonly="true" cssclass="edt_WF_Readonly" left="3" top="159" width="74" height="21" value="채무확정"/>
              <Edit id="Edit10" taborder="45" readonly="true" cssclass="edt_WF_Readonly" left="3" top="184" width="74" height="21" value="지급"/>
              <Combo id="cmb_CYFD_SE" taborder="46" readonly="false" innerdataset="ds_acc046" codecolumn="CODE" datacolumn="CODE_NM" left="352" top="3" width="60" height="21" index="-1"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static06" taborder="12" text="15" visible="false" left="0" top="0" width="903" height="15" style="background:#dc143c3c;align:center middle;"/>
        <Static id="Static05" taborder="13" text="15" visible="false" left="0" top="0" width="15" style="background:#1b3cd23c;align:center middle;" bottom="0"/>
        <Button id="btn_close2" taborder="3" text="종료" cssclass="btn_WF_CRUD" top="15" right="15" width="50" height="25" onclick="fn_close"/>
        <Button id="btn_save" taborder="2" text="저장" cssclass="btn_WF_CRUD" top="15" right="68" width="50" height="25" onclick="fn_save"/>
        <Static id="sta_title" taborder="0" text="지출결의서(법인카드)" cssclass="sta_WF_Title01" left="17" top="17" width="197" height="21"/>
        <Static id="Static01" taborder="14" text="15" visible="false" left="887" top="0" width="15" style="background:#1b3cd23c;align:center middle;" bottom="0"/>
        <Static id="Static07" taborder="15" text="10" visible="false" left="0" top="78" width="903" height="10" style="background:#dc143c3c;align:center middle;"/>
        <Static id="Static31" taborder="16" text="계정정보" cssclass="sta_WF_Title02" left="15" top="158" width="130" height="21"/>
        <Static id="Static08" taborder="17" text="5" visible="false" left="0" top="99" width="903" height="5" style="background:#dc143c3c;align:center middle;"/>
        <Static id="Static12" taborder="18" text="5" visible="false" left="0" top="40" width="903" height="5" style="background:#dc143c3c;align:center middle;"/>
        <Div id="div_search" taborder="4" left="15" top="45" right="15" height="33" cssclass="div_WFSA_Box">
          <Layouts>
            <Layout>
              <Static id="Static16" taborder="12" text="부서" cssclass="sta_WFSA_Label" left="169" top="5" width="38" height="21"/>
              <Div id="div_dept" taborder="1" url="com::deptCode.xfdl" left="212" top="5" width="195" height="22" async="false" enable="true"/>
              <Static id="Static00" taborder="14" text="회계년도" cssclass="sta_WFSA_Label" left="15" top="5" width="64" height="21"/>
              <Spin id="Spin02" taborder="0" value="0" readonly="true" cssclass="spn_WF_Readonly" left="84" top="5" width="70" height="21" style="align:center;"/>
              <Static id="sta_sanctn" taborder="17" text="결재상태" cssclass="sta_WFSA_Label" visible="true" top="5" right="127" height="21" width="66"/>
              <Combo id="cmb_sanctn" taborder="18" readonly="true" innerdataset="@ds_com022" codecolumn="CODE" datacolumn="CODE_NM" cssclass="cmb_WF_Readonly" visible="true" top="5" right="10" height="21" width="112"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static02" taborder="20" text="지출결의정보" cssclass="sta_WF_Title02" left="440" top="84" width="130" height="21"/>
        <Static id="Static11" taborder="25" text="10" visible="false" left="0" top="391" width="903" height="5" style="background:#dc143c3c;align:center middle;"/>
        <Button id="btn_add" taborder="8" text="행추가" cssclass="btn_WF_Gridadd" left="690" top="404" width="64" height="19" onclick="btn_add_onclick" visible="false"/>
        <Button id="btn_del" taborder="9" text="행삭제" cssclass="btn_WF_Griddel" left="757" top="404" width="64" height="19" onclick="btn_del_onclick" visible="false"/>
        <Button id="btn_reset" taborder="10" text="행취소" cssclass="btn_WF_Gridcnl" left="824" top="404" height="19" width="64" onclick="btn_reset_onclick" visible="false"/>
        <Div id="div_detail2" taborder="6" left="440" top="104" cssclass="div_detailBox" height="288" width="447">
          <Layouts>
            <Layout width="476" height="122">
              <Static id="Static09" taborder="68" cssclass="sta_WF_Labelbg" left="0" top="130" right="0" height="27"/>
              <Static id="Static15" taborder="61" cssclass="sta_WF_Labelbg" left="0" top="78" right="0" height="27"/>
              <Static id="Static27" taborder="55" cssclass="sta_WF_Labelbg" left="0" top="0" height="27" right="0"/>
              <Static id="Static11" taborder="56" cssclass="sta_WF_Labelbg" left="0" top="78" height="27" right="0"/>
              <Static id="Static12" taborder="57" cssclass="sta_WF_Labelbg" left="0" top="156" height="27" right="0"/>
              <Static id="Static00" taborder="11" text="발의일자" left="0" top="0" height="27" cssclass="sta_WF_Label" width="104"/>
              <Calendar id="cal_itncDe" taborder="0" left="106" top="3" height="21" style="align:center;" width="100" dateformat="yyyy-MM-dd" value="null"/>
              <Static id="Static13" taborder="59" cssclass="sta_WF_Labelbg" left="0" top="26" right="0" height="27"/>
              <Static id="Static14" taborder="60" cssclass="sta_WF_Labelbg" left="0" top="52" right="0" height="27"/>
              <Static id="Static16" taborder="62" cssclass="sta_WF_Labelbg" left="0" top="104" right="0" height="27"/>
              <Static id="Static18" taborder="64" cssclass="sta_WF_Labelbg" left="0" top="182" right="0" height="27"/>
              <Static id="Static19" taborder="65" cssclass="sta_WF_Labelbg" left="0" top="208" right="0" height="27"/>
              <Static id="Static05" taborder="40" text="검수일자" cssclass="sta_WF_Label" left="0" top="78" width="104" height="27"/>
              <Calendar id="cal_acptncDe" taborder="9" left="106" top="81" width="100" height="21" style="align:center;" dateformat="yyyy-MM-dd" value="null"/>
              <Static id="Static01" taborder="12" text="계약일자" cssclass="sta_WF_Label" left="0" top="26" height="27" width="104"/>
              <Calendar id="cal_cntrctDe" taborder="3" left="106" top="29" height="21" style="align:center;" width="100" dateformat="yyyy-MM-dd" value="null"/>
              <Static id="Static06" taborder="41" text="지급발의일자" cssclass="sta_WF_Label" left="0" top="156" width="104" height="27"/>
              <Calendar id="cal_pymntItncDe" taborder="2" left="106" top="159" width="100" height="21" style="align:center;" dateformat="yyyy-MM-dd" value="null"/>
              <Static id="Static02" taborder="13" text="원인행위일자" cssclass="sta_WF_Label" left="0" top="52" height="27" wordwrap="char" width="104"/>
              <Calendar id="cal_causeActionDe" taborder="7" left="106" top="55" width="100" height="21" style="align:center;" dateformat="yyyy-MM-dd" value="null"/>
              <Static id="Static08" taborder="43" text="자금지출부등기" cssclass="sta_WF_Label" left="0" top="208" width="104" height="27"/>
              <Calendar id="cal_cptalExpndtrAcntbkDe" taborder="6" left="106" top="211" width="100" height="21" style="align:center;" dateformat="yyyy-MM-dd" value="null"/>
              <Static id="Static07" taborder="42" text="지출예산통제" cssclass="sta_WF_Label" left="0" top="182" width="104" height="27"/>
              <Calendar id="cal_expndtrBudgetCnrlDe" taborder="5" left="106" top="185" width="100" height="21" style="align:center;" dateformat="yyyy-MM-dd" value="null"/>
              <Static id="Static03" taborder="14" text="채무확정일자" cssclass="sta_WF_Label" left="0" top="104" height="27" width="104"/>
              <Calendar id="cal_detDcsnDe" taborder="1" left="106" top="107" width="100" height="21" style="align:center;" dateformat="yyyy-MM-dd" value="null"/>
              <Calendar id="cal_prmpcJrnlzprRgistDe" taborder="66" dateformat="yyyy-MM-dd" left="106" top="133" width="100" height="21" style="align:center;"/>
              <Static id="Static04" taborder="67" text="분개장등기" cssclass="sta_WF_Label" left="0" top="130" width="104" height="27"/>
              <Static id="Static10" taborder="69" text="결의금액" cssclass="sta_WF_Label" left="208" top="0" width="84" height="27"/>
              <Static id="Static17" taborder="70" text="공급가액" cssclass="sta_WF_Label" left="208" top="26" width="84" height="27"/>
              <Static id="Static20" taborder="71" text="부가세액" cssclass="sta_WF_Label" left="208" top="52" width="84" height="27"/>
              <Static id="Static21" taborder="72" text="지급번호" cssclass="sta_WF_Label" left="208" top="78" width="84" height="27"/>
              <Static id="Static22" taborder="73" text="사업지구" wordwrap="char" cssclass="sta_WF_Label" left="208" top="104" width="84" height="53"/>
              <MaskEdit id="msk_caActAmt00" taborder="74" readonly="true" mask="###,###,###,###,###" limitbymask="integer" cssclass="msk_WF_Readonly" left="294" top="3" width="150" height="21"/>
              <Button id="btn_bsnsPopup" taborder="76" onclick="fn_popup_onclick" cssclass="btn_WF_Search" visible="false" left="271" top="119" width="21" height="21"/>
              <MaskEdit id="msk_caActAmt03" taborder="77" readonly="true" mask="###,###,###,###,###" limitbymask="integer" cssclass="msk_WF_Readonly" left="294" top="29" width="150" height="21"/>
              <MaskEdit id="msk_caActAmt04" taborder="78" readonly="true" mask="###,###,###,###,###" limitbymask="integer" cssclass="msk_WF_Readonly" left="294" top="55" width="150" height="21"/>
              <Edit id="Edit00" taborder="79" readonly="true" cssclass="edt_WF_Readonly" left="294" top="81" width="150" height="21"/>
              <TextArea id="TextArea00" taborder="80" scrollbars="none" wordwrap="char" cssclass="txt_WF_Readonly" left="294" top="107" width="150" height="47"/>
              <Static id="Static23" taborder="81" cssclass="sta_WF_Labelbg" left="1" top="234" height="54" right="0"/>
              <Static id="Static24" taborder="82" text="적요" wordwrap="char" cssclass="sta_WF_Label" left="1" top="234" width="102" height="54"/>
              <TextArea id="txt_sumry" taborder="83" wordwrap="char" maxlength="100" cssclass="txt_WF_Essential" left="105" top="237" width="339" height="48"/>
              <Static id="Static25" taborder="84" text="지출계좌" cssclass="sta_WF_Label" left="208" top="156" width="84" height="53"/>
              <Button id="btn_branchAcnut" taborder="85" onclick="fn_popup_onclick" cssclass="btn_WF_Search" left="272" top="173" width="21" height="21"/>
              <Combo id="cmb_fnccInsttCode" taborder="86" readonly="true" innerdataset="@ds_fnncInstt" codecolumn="FNNC_INSTT_CODE" datacolumn="FNNC_INSTT_CODE_NM" cssclass="cmb_WF_Readonly" left="294" top="159" width="150" height="21"/>
              <Edit id="Edit01" taborder="87" readonly="true" cssclass="edt_WF_Essential" left="294" top="185" width="150" height="21" style="font:9 Gulim;"/>
              <Static id="Static26" taborder="88" cssclass="sta_WF_Label" left="208" top="208" width="84" height="27"/>
            </Layout>
          </Layouts>
        </Div>
        <Button id="btn_delFiles" taborder="44" text="선택삭제" onclick="btn_delFiles_onclick" cssclass="btn_WF_Process" visible="false" top="404" right="175" width="67" height="19"/>
        <Button id="btn_uploadFiles" taborder="45" text="파일업로드" onclick="btn_uploadFiles_onclick" cssclass="btn_WF_Process" visible="false" top="404" right="103" width="68" height="19"/>
        <Button id="btn_downFiles" taborder="46" text="선택다운로드" onclick="btn_downFiles_onclick" cssclass="btn_WF_Process" visible="false" top="404" right="15" width="85" height="19"/>
        <Button id="btn_sanctn" taborder="47" text="결재" onclick="fn_sanction" cssclass="btn_WF_CRUD" top="15" right="121" height="25" width="50" visible="true"/>
        <Static id="Static15" taborder="48" text="15" visible="false" left="0" right="0" bottom="0" height="15" style="background:#dc143c3c;align:center middle;"/>
        <Static id="Static27" taborder="49" cssclass="sta_WF_Labelbg" left="15" top="104" width="415" height="53"/>
        <Button id="btn_actPopupView" taborder="50" text="보기" onclick="fn_popup_onclick" cssclass="btn_WF_Process" top="131" right="784" width="49" height="21"/>
        <Button id="btn_actPopup" taborder="51" text="선택" onclick="fn_popup_onclick" cssclass="btn_WF_Process" top="131" right="836" width="48" height="21"/>
        <Static id="Static04" taborder="52" text="원인행위" cssclass="sta_WF_Title02" left="15" top="84" width="130" height="21"/>
        <Edit id="Edit03" taborder="53" readonly="true" cssclass="edt_WF_Essential" left="18" top="107" width="100" height="21"/>
        <TextArea id="txt_cnsulNo" taborder="54" scrollbars="none" wordwrap="char" cssclass="txt_WF_Readonly" left="120" top="107" width="307" height="47"/>
        <Static id="sta_msg" taborder="55" text="(해당 지출 담당자 승인 후에 전자결재 상신이 가능합니다)" visible="false" left="404" top="19" width="317" height="21" style="color:blue;"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_expDsnMastr" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_expDsnMastr_oncolumnchanged" cancolumnchange="ds_expDsnMastr_cancolumnchange">
        <ColumnInfo>
          <Column id="DECSN_YEAR" type="STRING" size="4"/>
          <Column id="DECSN_NO" type="STRING" size="10"/>
          <Column id="CAUSE_ACTION_NO" type="STRING" size="10"/>
          <Column id="BUDGET_YEAR" type="STRING" size="4"/>
          <Column id="BSNS_SE" type="STRING" size="1"/>
          <Column id="BALC_SE" type="STRING" size="1"/>
          <Column id="BUDGET_ACNT_CODE" type="STRING" size="8"/>
          <Column id="BUDGET_ACNT_NM" type="STRING" size="256"/>
          <Column id="ANACT_KND" type="STRING" size="2"/>
          <Column id="DEPT_CODE" type="STRING" size="6"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="CYFD_SE" type="STRING" size="1"/>
          <Column id="ITNC_DE" type="STRING" size="8"/>
          <Column id="PYMNT_ITNC_DE" type="STRING" size="8"/>
          <Column id="DET_DCSN_DE" type="STRING" size="8"/>
          <Column id="PRMPC_JRNLZPR_RGIST_DE" type="STRING" size="8"/>
          <Column id="CPTAL_EXPNDTR_ACNTBK_DE" type="STRING" size="8"/>
          <Column id="EXPNDTR_BUDGET_CNRL_DE" type="STRING" size="8"/>
          <Column id="CAUSE_ACTION_DE" type="STRING" size="8"/>
          <Column id="DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="BUDGET_ACNT_BLCE" type="BIGDECIMAL" size="22"/>
          <Column id="EXPNDTR_UNIT_CODE" type="STRING" size="8"/>
          <Column id="EXPNDTR_UNIT_NM" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_CODE_BLCE" type="BIGDECIMAL" size="22"/>
          <Column id="CPTAL_CHRG_CONFM" type="STRING" size="1"/>
          <Column id="TIMHDER_CONFM" type="STRING" size="1"/>
          <Column id="CNTRCT_NO" type="STRING" size="11"/>
          <Column id="FNNC_INSTT_CODE" type="STRING" size="3"/>
          <Column id="ACNUTNO" type="STRING" size="20"/>
          <Column id="ACNUT_NM" type="STRING" size="256"/>
          <Column id="SUMRY" type="STRING" size="200"/>
          <Column id="BSNS_CODE" type="STRING" size="5"/>
          <Column id="BSNS_NM" type="STRING" size="256"/>
          <Column id="PRMPC_YEAR" type="STRING" size="256"/>
          <Column id="PRMPC_CODE" type="STRING" size="6"/>
          <Column id="PRMPC_NM" type="STRING" size="256"/>
          <Column id="REGISTER_ID" type="STRING" size="12"/>
          <Column id="REGIST_DT" type="STRING" size="8"/>
          <Column id="UPDUSR_ID" type="STRING" size="12"/>
          <Column id="UPDT_DT" type="STRING" size="8"/>
          <Column id="EXPNDTR_CNFIRM_AT" type="STRING" size="2"/>
          <Column id="ATMC_JRNLZ_TY_CODE" type="STRING" size="256"/>
          <Column id="GNRL_DEBTOR_ACNT_NM" type="STRING" size="256"/>
          <Column id="GNRL_CRDIT_ACNT_NM" type="STRING" size="256"/>
          <Column id="SETOFF_DEBTOR_ACNT_NM" type="STRING" size="256"/>
          <Column id="SETOFF_CRDIT_ACNT_NM" type="STRING" size="256"/>
          <Column id="FILE_SN" type="STRING" size="256"/>
          <Column id="CHECK_NO" type="STRING" size="256"/>
          <Column id="SANCTN_NO" type="STRING" size="256"/>
          <Column id="SANCTN_SE" type="STRING" size="256"/>
          <Column id="LAST_SANCTN_STTUS" type="STRING" size="256"/>
          <Column id="INC_EXP_AT" type="STRING" size="256"/>
          <Column id="CPTAL_DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="TRG_FORM_ID" type="STRING" size="256"/>
          <Column id="TRG_FORM_ID2" type="STRING" size="256"/>
          <Column id="BUDGET_CNRL_AT" type="STRING" size="256"/>
          <Column id="CAUSE_ACTION_SUMRY" type="STRING" size="256"/>
          <Column id="GWAN_NM" type="STRING" size="256"/>
          <Column id="HANG_NM" type="STRING" size="256"/>
          <Column id="SEHANG_NM" type="STRING" size="256"/>
          <Column id="MOK_NM" type="STRING" size="256"/>
          <Column id="SEMOK_NM" type="STRING" size="256"/>
          <Column id="BUDGET_DEPT_CODE" type="STRING" size="256"/>
          <Column id="SANCTN_KND" type="STRING" size="256"/>
          <Column id="CNSUL_SJ" type="STRING" size="256"/>
          <Column id="PRUF_SE_CODE" type="STRING" size="256"/>
          <Column id="ASIGN_JAN_AMOUNT" type="BIGDECIMAL" size="22"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_expDsnMtrDet" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_expDsnMtrDet_oncolumnchanged">
        <ColumnInfo>
          <Column id="DECSN_YEAR" type="STRING" size="4"/>
          <Column id="DECSN_NO" type="STRING" size="11"/>
          <Column id="CNTRCT_DE" type="STRING" size="8"/>
          <Column id="ACPTNC_DE" type="STRING" size="8"/>
          <Column id="ORDER_DE" type="STRING" size="8"/>
          <Column id="DVYFG_DE" type="STRING" size="8"/>
          <Column id="PYMNT_CMMND_PBLICTE_DE" type="STRING" size="8"/>
          <Column id="TAXXPT_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="VAT_DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="SUPLY_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="VAT_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="DSGN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="CNTRCT_SE" type="STRING" size="3"/>
          <Column id="CNTRCT_MTHD" type="STRING" size="1"/>
          <Column id="ATCH_FILE" type="STRING" size="100"/>
          <Column id="ATCH_FLPTH" type="STRING" size="200"/>
          <Column id="ATCH_FILE_1" type="STRING" size="100"/>
          <Column id="ATCH_FLPTH_1" type="STRING" size="200"/>
          <Column id="REGISTER_ID" type="STRING" size="12"/>
          <Column id="REGIST_DT" type="DATE" size="8"/>
          <Column id="UPDUSR_ID" type="STRING" size="12"/>
          <Column id="UPDT_DT" type="DATE" size="8"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_expDsnDetail" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_expDsnDetail_oncolumnchanged" onrowsetchanged="ds_expDsnDetail_onrowsetchanged" onrowposchanged="ds_expDsnDetail_onrowposchanged">
        <ColumnInfo>
          <Column id="DECSN_YEAR" type="STRING" size="4"/>
          <Column id="DECSN_NO" type="STRING" size="11"/>
          <Column id="SEQ" type="BIGDECIMAL" size="22"/>
          <Column id="DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="TAXXPT_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="VAT_AT" type="STRING" size="1"/>
          <Column id="BILL_KND" type="STRING" size="1"/>
          <Column id="VAT_DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="SUPLY_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="VAT" type="BIGDECIMAL" size="22"/>
          <Column id="BCNC_CODE" type="STRING" size="10"/>
          <Column id="BCNC_NM" type="STRING" size="256"/>
          <Column id="NM" type="STRING" size="30"/>
          <Column id="ADRES" type="STRING" size="200"/>
          <Column id="RQEST_DE" type="STRING" size="8"/>
          <Column id="RQEST_MAN" type="STRING" size="30"/>
          <Column id="RCPT_DE" type="STRING" size="8"/>
          <Column id="RCPT_MAN" type="STRING" size="30"/>
          <Column id="FNNC_INSTT_CODE" type="STRING" size="3"/>
          <Column id="ACNUTNO" type="STRING" size="20"/>
          <Column id="ENTRPRS_SE" type="STRING" size="1"/>
          <Column id="EVRFRND" type="STRING" size="1"/>
          <Column id="TCNDVLP" type="STRING" size="1"/>
          <Column id="CNTRWK_PRPOS_MTRIL" type="STRING" size="1"/>
          <Column id="AREA_ENTRPS" type="STRING" size="1"/>
          <Column id="FEMALE_ENTRPRS" type="STRING" size="1"/>
          <Column id="MIDDL_PD_CMPET_PRDUCT" type="STRING" size="1"/>
          <Column id="FRGCPT_ENTRPRS" type="STRING" size="1"/>
          <Column id="DSPSN" type="STRING" size="1"/>
          <Column id="SRSILL_DSPSN" type="STRING" size="1"/>
          <Column id="SOCTY_ENTRPRS" type="STRING" size="1"/>
          <Column id="DSPSN_PRDCTN_FCLTY" type="STRING" size="1"/>
          <Column id="SOCTY_CPER_MXTR" type="STRING" size="1"/>
          <Column id="GREEN_PRDUCT" type="STRING" size="1"/>
          <Column id="DSPSN_STD_BPLC" type="STRING" size="1"/>
          <Column id="WATER_INDUST" type="STRING" size="1"/>
          <Column id="MDLC_INDUST" type="STRING" size="1"/>
          <Column id="FARMNG_INDUST" type="STRING" size="1"/>
          <Column id="ENERGY_INDUST" type="STRING" size="1"/>
          <Column id="WHTAX_AT" type="STRING" size="1"/>
          <Column id="WHTAX_KND" type="STRING" size="1"/>
          <Column id="WHTAX_ADRES" type="STRING" size="200"/>
          <Column id="IHDNUM" type="STRING" size="256"/>
          <Column id="INCMTAX" type="BIGDECIMAL" size="22"/>
          <Column id="IHNTS" type="BIGDECIMAL" size="22"/>
          <Column id="WHTAX_INCOME_SE_CODE" type="STRING" size="256"/>
          <Column id="WHTAX_INDUTY_CODE" type="STRING" size="256"/>
          <Column id="WHTAX_PYMNT_TOTAMT" type="BIGDECIMAL" size="22"/>
          <Column id="MTCHG_SE" type="STRING" size="5"/>
          <Column id="BRRW_AMOUNT_INTR_RPAY_AT" type="STRING" size="1"/>
          <Column id="RM" type="STRING" size="200"/>
          <Column id="CMPNSP_NO" type="STRING" size="30"/>
          <Column id="PRPDVS_TRGET_CODE" type="STRING" size="4"/>
          <Column id="REGISTER_ID" type="STRING" size="12"/>
          <Column id="REGIST_DT" type="DATE" size="8"/>
          <Column id="UPDUSR_ID" type="STRING" size="12"/>
          <Column id="UPDT_DT" type="DATE" size="8"/>
          <Column id="ENDW_INTR_AT" type="STRING" size="256"/>
          <Column id="PBNCD_NO" type="STRING" size="256"/>
          <Column id="ERROR_AT" type="STRING" size="256"/>
          <Column id="CHGHY" type="STRING" size="256"/>
          <Column id="ATNDNC_MAN" type="STRING" size="256"/>
          <Column id="PRVONSH" type="STRING" size="256"/>
          <Column id="REAL_USER" type="STRING" size="256"/>
          <Column id="REAL_USER_NM" type="STRING" size="256"/>
          <Column id="BANK_CD" type="STRING" size="256"/>
          <Column id="CARD_NO" type="STRING" size="256"/>
          <Column id="APPR_DATE" type="STRING" size="256"/>
          <Column id="APPR_NO" type="STRING" size="256"/>
          <Column id="CANCEL_YN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_expDsnDtls" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DECSN_YEAR" type="STRING" size="4"/>
          <Column id="DECSN_NO" type="STRING" size="11"/>
          <Column id="SEQ" type="BIGDECIMAL" size="22"/>
          <Column id="IHIDNUM" type="STRING" size="32"/>
          <Column id="RPAY_SE" type="STRING" size="6"/>
          <Column id="AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="NM" type="STRING" size="30"/>
          <Column id="SUMRY" type="STRING" size="200"/>
          <Column id="REGISTER_ID" type="STRING" size="12"/>
          <Column id="REGIST_DT" type="DATE" size="8"/>
          <Column id="UPDUSR_ID" type="STRING" size="12"/>
          <Column id="UPDT_DT" type="DATE" size="8"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DECSN_YEAR" type="STRING" size="256"/>
          <Column id="DECSN_NO" type="STRING" size="256"/>
          <Column id="ANACT_KND" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_bdg001" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_acc002" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_acc003" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ctr022" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ctr049" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_acc005" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_fnncInstt" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="FNNC_INSTT_CODE" type="STRING" size="3"/>
          <Column id="FNNC_INSTT_CODE_NM" type="STRING" size="50"/>
          <Column id="USE_AT" type="STRING" size="1"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_bdg002" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ccmAppr" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="BANK_CD" type="STRING" size="256"/>
          <Column id="CARD_NO" type="STRING" size="256"/>
          <Column id="APPR_DATE" type="STRING" size="256"/>
          <Column id="APPR_SEQ" type="STRING" size="256"/>
          <Column id="DECSN_YEAR" type="STRING" size="256"/>
          <Column id="DECSN_NO" type="STRING" size="256"/>
          <Column id="ATNDNC_MAN" type="STRING" size="256"/>
          <Column id="PRVONSH" type="STRING" size="256"/>
          <Column id="REAL_USER" type="STRING" size="256"/>
          <Column id="REAL_USER_NM" type="STRING" size="256"/>
          <Column id="APPR_AMT" type="STRING" size="256"/>
          <Column id="CHAIN_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_decsnNo" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DECSN_YEAR" type="STRING" size="256"/>
          <Column id="DECSN_NO" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_validation" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="compId" type="STRING" size="256"/>
          <Column id="colId" type="STRING" size="256"/>
          <Column id="PK" type="STRING" size="256"/>
          <Column id="notNull" type="STRING" size="256"/>
          <Column id="type" type="STRING" size="256"/>
          <Column id="nlength" type="STRING" size="256"/>
          <Column id="from" type="STRING" size="256"/>
          <Column id="to" type="STRING" size="256"/>
          <Column id="lengthChkGb" type="STRING" size="256"/>
          <Column id="msgId" type="STRING" size="256"/>
          <Column id="expr" type="STRING" size="256"/>
          <Column id="func" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="colId">CAUSE_ACTION_NO</Col>
            <Col id="compId">ds_expDsnMastr</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">원인행위</Col>
          </Row>
          <Row>
            <Col id="colId">EXPNDTR_UNIT_CODE</Col>
            <Col id="compId">ds_expDsnMastr</Col>
            <Col id="msgId">[계정정보]지출단위</Col>
            <Col id="notNull">Y</Col>
            <Col id="PK">Y</Col>
            <Col id="nlength"/>
            <Col id="lengthChkGb">LT</Col>
          </Row>
          <Row>
            <Col id="colId">SUMRY</Col>
            <Col id="compId">ds_expDsnMastr</Col>
            <Col id="PK"/>
            <Col id="notNull">Y</Col>
            <Col id="nlength">100</Col>
            <Col id="lengthChkGb">LE</Col>
            <Col id="msgId">[계정정보]적요</Col>
          </Row>
          <Row>
            <Col id="colId">ACNUTNO</Col>
            <Col id="compId">ds_expDsnMastr</Col>
            <Col id="nlength">20</Col>
            <Col id="lengthChkGb">LE</Col>
            <Col id="msgId">[내용]지출계좌</Col>
            <Col id="notNull">Y</Col>
          </Row>
          <Row>
            <Col id="compId">ds_ccmAppr</Col>
            <Col id="colId">PRVONSH</Col>
            <Col id="nlength">100</Col>
            <Col id="msgId">[세부내용]사유</Col>
            <Col id="lengthChkGb">LE</Col>
            <Col id="notNull"/>
          </Row>
          <Row>
            <Col id="compId">ds_ccmAppr</Col>
            <Col id="colId">ATNDNC_MAN</Col>
            <Col id="nlength">100</Col>
            <Col id="msgId">[세부내용]참석자</Col>
            <Col id="lengthChkGb">LE</Col>
            <Col id="notNull"/>
          </Row>
          <Row>
            <Col id="compId">ds_ccmAppr</Col>
            <Col id="colId">REAL_USER</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">[세부내용]실사용자</Col>
          </Row>
          <Row>
            <Col id="compId">ds_expDsnDetail</Col>
            <Col id="colId">DECSN_AMOUNT</Col>
            <Col id="notNull">Y</Col>
            <Col id="nlength">15</Col>
            <Col id="lengthChkGb">LE</Col>
            <Col id="msgId">[세부내용]결의금액</Col>
          </Row>
          <Row>
            <Col id="compId">ds_expDsnDtls</Col>
            <Col id="colId">AMOUNT</Col>
            <Col id="notNull">Y</Col>
            <Col id="nlength">15</Col>
            <Col id="lengthChkGb">LE</Col>
            <Col id="msgId">[지출결의내역]금액</Col>
          </Row>
          <Row>
            <Col id="compId">ds_expDsnDtls</Col>
            <Col id="colId">SUMRY</Col>
            <Col id="notNull">Y</Col>
            <Col id="nlength">100</Col>
            <Col id="lengthChkGb">LE</Col>
            <Col id="msgId">[지출결의내역]사유</Col>
          </Row>
          <Row>
            <Col id="compId">ds_expDsnDtls</Col>
            <Col id="colId">NM</Col>
            <Col id="nlength">15</Col>
            <Col id="lengthChkGb">LE</Col>
            <Col id="msgId">[지출결의내역]성명</Col>
          </Row>
          <Row>
            <Col id="compId">ds_expDsnDetail</Col>
            <Col id="colId">TAXXPT_AMOUNT</Col>
            <Col id="lengthChkGb">LE</Col>
            <Col id="msgId">세부내용-면세금액</Col>
          </Row>
          <Row>
            <Col id="compId">ds_expDsnDetail</Col>
            <Col id="colId">SUPLY_AMOUNT</Col>
            <Col id="lengthChkGb">LE</Col>
            <Col id="msgId">세부내용-공급가액</Col>
          </Row>
          <Row>
            <Col id="compId">ds_expDsnDetail</Col>
            <Col id="colId">VAT</Col>
            <Col id="lengthChkGb">LE</Col>
            <Col id="msgId">세부내용-부가세액</Col>
          </Row>
          <Row>
            <Col id="compId">ds_expDsnDetail</Col>
            <Col id="colId">RCPT_MAN</Col>
            <Col id="lengthChkGb">LE</Col>
            <Col id="msgId">세부내용-영수자</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_fileList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="PROGRS" type="BIGDECIMAL" size="16"/>
          <Column id="ORGINL_FILE_NM" type="string" size="32"/>
          <Column id="FILE_EXTSN" type="string" size="32"/>
          <Column id="FILE_STRE_COURS" type="string" size="32"/>
          <Column id="FILE_ID" type="string" size="32"/>
          <Column id="SN" type="bigdecimal" size="16"/>
          <Column id="SYS_SE_CODE" type="string" size="32"/>
          <Column id="FILE_IMAGE" type="string" size="32"/>
          <Column id="FILE_TY" type="string" size="32"/>
          <Column id="JOB_SE" type="string" size="32"/>
          <Column id="DELETE_IMAGE" type="string" size="32"/>
          <Column id="STRE_FILE_NM" type="string" size="32"/>
          <Column id="FILE_MG" type="bigdecimal" size="16"/>
          <Column id="FILE_CN" type="string" size="32"/>
          <Column id="FILE_ORDR" type="bigdecimal" size="16"/>
          <Column id="TRNSMIS_FILE_SIZE" type="string" size="32"/>
          <Column id="USE_AT" type="string" size="32"/>
          <Column id="STTUS" type="string" size="32"/>
          <Column id="FILE_SN" type="bigdecimal" size="16"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_com022" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_acc046">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item6" compid="div_detail2.cal_cntrctDe" propid="value" datasetid="ds_expDsnMtrDet" columnid="CNTRCT_DE"/>
      <BindItem id="item4" compid="div_detail2.cal_itncDe" propid="value" datasetid="ds_expDsnMastr" columnid="ITNC_DE"/>
      <BindItem id="item15" compid="div_detail03.Edit04" propid="value" datasetid="ds_actMastr" columnid="PRMPC_CODE"/>
      <BindItem id="item25" compid="div_detail03.Edit00" propid="value" datasetid="ds_actMastr" columnid="BSNS_CODE"/>
      <BindItem id="item0" compid="div_detail1.edt_bukipCode" propid="value" datasetid="ds_expDsnMastr" columnid="EXPNDTR_UNIT_CODE"/>
      <BindItem id="item1" compid="div_detail1.Edit04" propid="value" datasetid="ds_expDsnMastr" columnid="BUDGET_ACNT_CODE"/>
      <BindItem id="item10" compid="div_detail1.Edit05" propid="value" datasetid="ds_expDsnMastr" columnid="DECSN_NO"/>
      <BindItem id="item11" compid="div_detail1.msk_caActAmt" propid="value" datasetid="ds_expDsnMastr" columnid="ASIGN_JAN_AMOUNT"/>
      <BindItem id="item12" compid="div_detail1.msk_caActAmt00" propid="value" datasetid="ds_expDsnMastr" columnid="EXPNDTR_UNIT_CODE_BLCE"/>
      <BindItem id="item2" compid="div_detail2.cal_causeActionDe" propid="value" datasetid="ds_expDsnMastr" columnid="CAUSE_ACTION_DE"/>
      <BindItem id="item3" compid="div_detail2.cal_detDcsnDe" propid="value" datasetid="ds_expDsnMastr" columnid="DET_DCSN_DE"/>
      <BindItem id="item9" compid="div_detail2.cal_acptncDe" propid="value" datasetid="ds_expDsnMtrDet" columnid="ACPTNC_DE"/>
      <BindItem id="item13" compid="div_detail2.cal_pymntItncDe" propid="value" datasetid="ds_expDsnMastr" columnid="PYMNT_ITNC_DE"/>
      <BindItem id="item14" compid="div_detail2.cal_expndtrBudgetCnrlDe" propid="value" datasetid="ds_expDsnMastr" columnid="EXPNDTR_BUDGET_CNRL_DE"/>
      <BindItem id="item16" compid="div_detail2.cal_cptalExpndtrAcntbkDe" propid="value" datasetid="ds_expDsnMastr" columnid="CPTAL_EXPNDTR_ACNTBK_DE"/>
      <BindItem id="item28" compid="tab.tabpage1.div_detail00.msk_caActAmt00" propid="value" datasetid="ds_expDsnDetail" columnid="DECSN_AMOUNT"/>
      <BindItem id="item31" compid="tab.tabpage1.div_detail00.msk_caActAmt05" propid="value" datasetid="ds_expDsnDetail" columnid="SUPLY_AMOUNT"/>
      <BindItem id="item32" compid="tab.tabpage1.div_detail00.Edit04" propid="value" datasetid="ds_expDsnDetail" columnid="BCNC_CODE"/>
      <BindItem id="item33" compid="tab.tabpage1.div_detail00.Edit06" propid="value" datasetid="ds_expDsnDetail" columnid="NM"/>
      <BindItem id="item34" compid="tab.tabpage1.div_detail00.msk_caActAmt01" propid="value" datasetid="ds_expDsnDetail" columnid="VAT"/>
      <BindItem id="item36" compid="tab.tabpage1.div_detail00.Combo00" propid="value" datasetid="ds_expDsnDetail" columnid="VAT_AT"/>
      <BindItem id="item37" compid="tab.tabpage1.div_detail00.Calendar00" propid="value" datasetid="ds_expDsnDetail" columnid="RCPT_DE"/>
      <BindItem id="item38" compid="tab.tabpage1.div_detail00.edt_rcptMan" propid="value" datasetid="ds_expDsnDetail" columnid="RCPT_MAN"/>
      <BindItem id="item39" compid="tab.tabpage1.div_detail00.cmd_fnncInstt" propid="value" datasetid="ds_expDsnDetail" columnid="FNNC_INSTT_CODE"/>
      <BindItem id="item40" compid="tab.tabpage1.div_detail00.edt_acnutno" propid="value" datasetid="ds_expDsnDetail" columnid="ACNUTNO"/>
      <BindItem id="item41" compid="tab.tabpage1.div_detail00.cmb_entrprsSe" propid="value" datasetid="ds_expDsnDetail" columnid="ENTRPRS_SE"/>
      <BindItem id="item55" compid="div_detail2.CheckBox00" propid="value" datasetid="ds_expDsnMastr" columnid="CYFD_SE"/>
      <BindItem id="item56" compid="div_search.Spin02" propid="value" datasetid="ds_expDsnMastr" columnid="DECSN_YEAR"/>
      <BindItem id="item61" compid="tab.tabpage1.div_detail00.Edit05" propid="value" datasetid="ds_expDsnDetail" columnid="BCNC_NM"/>
      <BindItem id="item63" compid="div_detail1.Edit01" propid="value" datasetid="ds_expDsnMastr" columnid="EXPNDTR_UNIT_NM"/>
      <BindItem id="item64" compid="div_detail1.Edit02" propid="value" datasetid="ds_expDsnMastr" columnid="BUDGET_ACNT_NM"/>
      <BindItem id="item8" compid="div_detail1.Combo01" propid="value" datasetid="ds_expDsnMastr" columnid="BSNS_SE"/>
      <BindItem id="item71" compid="div_detail1.Edit03" propid="value" datasetid="ds_expDsnMastr" columnid="GNRL_DEBTOR_ACNT_NM"/>
      <BindItem id="item72" compid="div_detail1.Edit06" propid="value" datasetid="ds_expDsnMastr" columnid="GNRL_CRDIT_ACNT_NM"/>
      <BindItem id="item73" compid="div_detail1.Edit07" propid="value" datasetid="ds_expDsnMastr" columnid="SETOFF_DEBTOR_ACNT_NM"/>
      <BindItem id="item74" compid="div_detail1.Edit08" propid="value" datasetid="ds_expDsnMastr" columnid="SETOFF_CRDIT_ACNT_NM"/>
      <BindItem id="item82" compid="div_search.cmb_sanctn" propid="value" datasetid="ds_expDsnMastr" columnid="SANCTN_KND"/>
      <BindItem id="item47" compid="tab.tabpage1.div_detail00.div_PrductSe.chk_evrfrnd" propid="value" datasetid="ds_expDsnDetail" columnid="EVRFRND"/>
      <BindItem id="item48" compid="tab.tabpage1.div_detail00.div_PrductSe.chk_tcndvlp" propid="value" datasetid="ds_expDsnDetail" columnid="TCNDVLP"/>
      <BindItem id="item49" compid="tab.tabpage1.div_detail00.div_PrductSe.chk_cntrwkPrposMtril" propid="value" datasetid="ds_expDsnDetail" columnid="CNTRWK_PRPOS_MTRIL"/>
      <BindItem id="item42" compid="tab.tabpage1.div_detail00.div_PrductSe.chk_areaEntrps" propid="value" datasetid="ds_expDsnDetail" columnid="AREA_ENTRPS"/>
      <BindItem id="item43" compid="tab.tabpage1.div_detail00.div_PrductSe.chk_femaleEntrprs" propid="value" datasetid="ds_expDsnDetail" columnid="FEMALE_ENTRPRS"/>
      <BindItem id="item44" compid="tab.tabpage1.div_detail00.div_PrductSe.chk_dspsn" propid="value" datasetid="ds_expDsnDetail" columnid="DSPSN"/>
      <BindItem id="item45" compid="tab.tabpage1.div_detail00.div_PrductSe.chk_srsillDspsn" propid="value" datasetid="ds_expDsnDetail" columnid="SRSILL_DSPSN"/>
      <BindItem id="item46" compid="tab.tabpage1.div_detail00.div_PrductSe.chk_soctyEntrprs" propid="value" datasetid="ds_expDsnDetail" columnid="SOCTY_ENTRPRS"/>
      <BindItem id="item59" compid="tab.tabpage1.div_detail00.div_PrductSe.chk_greenPrduct" propid="value" datasetid="ds_expDsnDetail" columnid="GREEN_PRDUCT"/>
      <BindItem id="item54" compid="tab.tabpage1.div_detail00.div_PrductSe.chk_dspsnPrdctnFclty" propid="value" datasetid="ds_expDsnDetail" columnid="DSPSN_PRDCTN_FCLTY"/>
      <BindItem id="item58" compid="tab.tabpage1.div_detail00.div_PrductSe.chk_soctyCperMxtr" propid="value" datasetid="ds_expDsnDetail" columnid="SOCTY_CPER_MXTR"/>
      <BindItem id="item66" compid="tab.tabpage1.div_detail00.div_PrductSe.CheckBox11" propid="value" datasetid="ds_expDsnDetail" columnid="DSPSN_STD_BPLC"/>
      <BindItem id="item78" compid="tab.tabpage1.div_detail00.div_PrductSe.CheckBox14" propid="value" datasetid="ds_expDsnDetail" columnid="WATER_INDUST"/>
      <BindItem id="item79" compid="tab.tabpage1.div_detail00.div_PrductSe.CheckBox15" propid="value" datasetid="ds_expDsnDetail" columnid="MDLC_INDUST"/>
      <BindItem id="item80" compid="tab.tabpage1.div_detail00.div_PrductSe.CheckBox16" propid="value" datasetid="ds_expDsnDetail" columnid="FARMNG_INDUST"/>
      <BindItem id="item83" compid="tab.tabpage1.div_detail00.div_PrductSe.CheckBox17" propid="value" datasetid="ds_expDsnDetail" columnid="ENERGY_INDUST"/>
      <BindItem id="item27" compid="tab.tabpage1.edt_ATNDNC_MAN" propid="value" datasetid="ds_expDsnDetail" columnid="ATNDNC_MAN"/>
      <BindItem id="item75" compid="tab.tabpage1.edt_PRVONSH" propid="value" datasetid="ds_expDsnDetail" columnid="PRVONSH"/>
      <BindItem id="item24" compid="tab.tabpage1.edt_rcptMan00" propid="value" datasetid="ds_expDsnDetail" columnid="REAL_USER_NM"/>
      <BindItem id="item68" compid="div_detail2.cal_prmpcJrnlzprRgistDe" propid="value" datasetid="ds_expDsnMastr" columnid="PRMPC_JRNLZPR_RGIST_DE"/>
      <BindItem id="item18" compid="div_detail2.msk_caActAmt00" propid="value" datasetid="ds_expDsnMastr" columnid="DECSN_AMOUNT"/>
      <BindItem id="item20" compid="div_detail2.msk_caActAmt03" propid="value" datasetid="ds_expDsnMtrDet" columnid="SUPLY_AMOUNT"/>
      <BindItem id="item21" compid="div_detail2.msk_caActAmt04" propid="value" datasetid="ds_expDsnMtrDet" columnid="VAT_AMOUNT"/>
      <BindItem id="item17" compid="div_detail2.Edit00" propid="value" datasetid="ds_expDsnMastr" columnid="CHECK_NO"/>
      <BindItem id="item5" compid="div_detail2.TextArea00" propid="value" datasetid="ds_expDsnMastr" columnid="BSNS_NM"/>
      <BindItem id="item77" compid="div_detail2.txt_sumry" propid="value" datasetid="ds_expDsnMastr" columnid="SUMRY"/>
      <BindItem id="item60" compid="div_detail2.cmb_fnccInsttCode" propid="value" datasetid="ds_expDsnMastr" columnid="FNNC_INSTT_CODE"/>
      <BindItem id="item7" compid="div_detail2.Edit01" propid="value" datasetid="ds_expDsnMastr" columnid="ACNUTNO"/>
      <BindItem id="item65" compid="Edit03" propid="value" datasetid="ds_expDsnMastr" columnid="CAUSE_ACTION_NO"/>
      <BindItem id="item22" compid="txt_cnsulNo" propid="value" datasetid="ds_expDsnMastr" columnid="CNSUL_SJ"/>
      <BindItem id="item35" compid="tab.tabpage1.div_detail00.Edit09" propid="value" datasetid="ds_expDsnDetail" columnid="ADRES"/>
      <BindItem id="item19" compid="div_detail1.Edit02" propid="tooltiptext" datasetid="ds_expDsnMastr" columnid="BUDGET_ACNT_NM"/>
      <BindItem id="item30" compid="div_detail1.cmb_CYFD_SE" propid="value" datasetid="ds_expDsnMastr" columnid="CYFD_SE"/>
    </Bind>
    <Script type="xscript5.0"><![CDATA[/***********************************************************************
 * 화면ID   : ACC020203_P10
 * 화면명   : 지출결의서(법인카드)
 * 화면설명 : 지출결의서(법인카드)를 등록한다.
 * 작성일   : 2017.07.20
 * 작성자   : 이상명
 * 수정이력 : 
 ***********************************************************************
 *     수정일     수정자   내용
 ***********************************************************************
 *    
 ***********************************************************************
 */

/***********************************************************************
 * Script Include 
 ************************************************************************/
// 시스템 공통 라이브러리 Include
include "lib::comInclude.xjs";
include "mis_lib::misUtil.xjs";
include "lib::comUpDownUtils.xjs";

// 업무에 필요한 공통 라이브러리 파일을 추가할 수 있다.
// TODO

/***********************************************************************
 * 화면 변수 선언부
 ***********************************************************************/
this.strRtnGbn			= "";		// 팝업 this.close()시 리턴값(I:신규, U:수정, C:닫기)
this.File_UpDownManager = null;

/***********************************************************************
 * onInit / onLoad 영역
 ***********************************************************************/
this.ACC020203_P10_onload = function(obj:Form, e:nexacro.LoadEventInfo){

	this.fn_misFormInit(this);
	// 데이터셋 동적 바인딩
	this.div_search.div_dept.fn_setBind("ds_expDsnMastr","DEPT_CODE","DEPT_NM");
	if(this.gfn_authGrpId("ACC_ADMIN") == -1 && this.gfn_authGrpId("ACC_USER") == -1) {
         this.div_search.div_dept.fn_setReadonly(true);
    }
	
		// 파일 메니저 설정
	var fileConfig = {
		useMultiUpload : true,
		onChange: this.fn_onFileSelected,	// 파일 선택 이벤트 핸들러
		onSuccess : this.fn_onFileSuccess	// 전송 성공 이벤트 핸들러
	};
	this.File_UpDownManager = new this.fileUpDownManager(this, "MIS", "ACC");
	this.File_UpDownManager.init(fileConfig);
	
	// 결의서코드 정보
	this.fn_transaction("selectExpCode");
	
	// 공통코드
	var comboParams = [
		["ds_acc002", "ACC002", "Y", "D", "B"],	// 지출결의서 구분
		["ds_acc003", "ACC003", "Y", "D", "B"],	// 지출은행
		["ds_acc005", "ACC005", "Y", "D", "B"],	// 부가세여부
		["ds_ctr022", "CTR022", "Y", "S", "B"],	// 계약구분
		["ds_ctr049", "CTR049", "Y", "S", "B"],	// 계약방식
	    ["ds_bdg001", "BDG001", "Y", "D", "B"],	// 사업구분
	    ["ds_bdg002", "BDG002", "Y", "D", "B"], // 수지구분
	    ["ds_com022", "COM022", "Y", "D", "B"],	// 결재상태
	    ["ds_acc046", "ACC046", "Y", "D", "B"]	// 이월구분
	];
	
	var callback = function (svcId, errorCode, errorMsg) {
		
		// 최초조회
		this.fn_search();
	};
	this.gfn_comboLoad (comboParams, callback);
}

/***********************************************************************
 * Transaction 관련 이벤트 핸들러 
 **********************************************************************/
/*
 * 함수명  	: fn_search
 * 설명 		: 조회 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_search();
 */
this.fn_search = function()
{	
	var decsnYear = this.getOwnerFrame().decsnYear;		// 결의년도
	var decsnNo	  = this.getOwnerFrame().decsnNo;		// 결의번호	
	
	// 결의번호가 있을 경우 지출결의서 조회, 없을경우 신규 지출결의서 작성
	if(!this.comUtils.isNull(decsnNo)) {
		
		this.btn_sanctn.set_visible(true);
		//결재 버튼 및 결재상태 visible false 처리
		
		// 지출결의서 조회
		this.ds_cond.clearData();
		this.ds_cond.addRow();
		this.ds_cond.setColumn(0, "DECSN_YEAR"	, decsnYear);
		this.ds_cond.setColumn(0, "DECSN_NO"	, decsnNo);
		this.ds_cond.setColumn(0, "ANACT_KND"	, "03");
		
		this.fn_transaction("selectExpDsn");
		
	} else {
		this.strRtnGbn = "I";
		this.btn_sanctn.set_enable(false);
		this.sta_msg.set_visible(true);
		var today = this.dateUtils.today();
		// 신규 지출결의서 작성
		var today = this.dateUtils.today();	
		// 지출결의마스터 생성 및 초기값 설정(부모창에서 넘겨받은 데이터셋이 있으면 셋팅)
		
		if(this.comUtils.isNull(this.getOwnerFrame().dsExpDsnMastr)) {
			this.ds_expDsnMastr.addRow();
			this.ds_expDsnMastr.setColumn(0, "DECSN_YEAR"				, decsnYear);	// 결의년도
			this.ds_expDsnMastr.setColumn(0, "BUDGET_YEAR"				, decsnYear);	// 예산년도
			this.ds_expDsnMastr.setColumn(0, "ANACT_KND"				, "03");		// 결의서종류
			this.ds_expDsnMastr.setColumn(0, "ITNC_DE"					, today);		// 발의일자
			this.ds_expDsnMastr.setColumn(0, "DET_DCSN_DE"				, today);		// 채무확정일자
			this.ds_expDsnMastr.setColumn(0, "PYMNT_ITNC_DE"			, today);		// 지급발의일자
			this.ds_expDsnMastr.setColumn(0, "PRMPC_JRNLZPR_RGIST_DE"	, today);		// 원가분개장등기
			this.ds_expDsnMastr.setColumn(0, "EXPNDTR_BUDGET_CNRL_DE"	, today);		// 지출예산통제
			this.ds_expDsnMastr.setColumn(0, "CPTAL_EXPNDTR_ACNTBK_DE"	, today);		// 자금지출부
			this.ds_expDsnMastr.setColumn(0, "CAUSE_ACTION_DE"			, today);		// 원인행위일자
			this.ds_expDsnMastr.setColumn(0, "DEPT_CODE"				, this.gfn_getDeptId());	// 부서코드
			this.ds_expDsnMastr.setColumn(0, "DEPT_NM"					, this.gfn_getDeptName());	// 부서명
			
			this.ds_expDsnMastr.setColumn(0, "TRG_FORM_ID"				, this.getOwnerFrame().trgFormId);	// 화면제어
			this.ds_expDsnMastr.setColumn(0, "TRG_FORM_ID2"				, this.getOwnerFrame().trgFormId2);	// PMS 화면,삭제제어
			
			this.ds_expDsnMastr.setColumn(0, "CYFD_SE"					, "0");								// 이월구분	
			
		} else {
			this.fn_loadXml(this.getOwnerFrame().dsExpDsnMastr, this.ds_expDsnMastr);
		
			// 예산정보 조회
			var dsBudget = this.fn_getBudgetInfo(this.ds_expDsnMastr);
			if(dsBudget.getRowCount() > 0) {
				this.ds_expDsnMastr.setColumn(0, "BUDGET_ACNT_NM", 			dsBudget.getColumn(0, "BUDGET_ACNT_NM"));
				this.ds_expDsnMastr.setColumn(0, "EXPNDTR_UNIT_NM", 		dsBudget.getColumn(0, "EXPNDTR_UNIT_NM"));
				this.ds_expDsnMastr.setColumn(0, "BUDGET_ACNT_BLCE", 		dsBudget.getColumn(0, "BUDGET_ACNT_BLCE"));
				this.ds_expDsnMastr.setColumn(0, "EXPNDTR_UNIT_CODE_BLCE", 	dsBudget.getColumn(0, "EXPNDTR_UNIT_CODE_BLCE"));
			}
			
			if(!this.comUtils.isNull(this.getOwnerFrame().trgFormId)) {
				this.ds_expDsnMastr.setColumn(0, "TRG_FORM_ID"				, this.getOwnerFrame().trgFormId);
			}
			
			this.fn_setDatasetType(this.ds_expDsnMastr, "I");
		}
	
		// 지출결의마스터상세 생성 및 초기값 설정(부모창에서 넘겨받은 데이터셋이 있으면 셋팅)
		if(this.comUtils.isNull(this.getOwnerFrame().dsExpDsnMtrDet)) {
			this.ds_expDsnMtrDet.addRow();
		} else {
			this.fn_loadXml(this.getOwnerFrame().dsExpDsnMtrDet, this.ds_expDsnMtrDet);
			this.fn_setDatasetType(this.ds_expDsnMtrDet, "I");
		}
		
		// 지출결의세부 생성 및 초기값 설정(부모창에서 넘겨받은 데이터셋이 있으면 셋팅)
		if(this.comUtils.isNull(this.getOwnerFrame().dsExpDsnDetail)) {
			this.btn_add_onclick(null, null);
		} else {
			this.fn_loadXml(this.getOwnerFrame().dsExpDsnDetail, this.ds_expDsnDetail);
			this.fn_setDatasetType(this.ds_expDsnDetail, "I");
		}
		
		// 지출결의내역 생성 및 초기값 설정(부모창에서 넘겨받은 데이터셋이 있으면 셋팅)
		if(this.comUtils.isNull(this.getOwnerFrame().dsExpDsnDtls)) {
			;
		} else {
			this.fn_loadXml(this.getOwnerFrame().dsExpDsnDtls, this.ds_expDsnDtls);
			this.fn_setDatasetType(this.ds_expDsnDtls, "I");
		}
		
		// 자금지출계획
		if(!this.comUtils.isNull(this.getOwnerFrame().dsWikCptalPlan)) {
			this.fn_loadXml(this.getOwnerFrame().dsWikCptalPlan, this.ds_wikCptalPlan);
		}
		
		// 결의번호가 등록되어야하는 테이블의 Dataset
		if(!this.comUtils.isNull(this.getOwnerFrame().dsDecsnNo)) {
			this.ds_dscsnNo.loadXML(this.getOwnerFrame().dsDecsnNo);
		}

	}
}

/*
 * 함수명  	: fn_save
 * 설명 		: 저장 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_save();
 */
this.fn_save= function()
{
	var year 	   = String(this.ds_expDsnMastr.getColumn(0, "CPTAL_EXPNDTR_ACNTBK_DE")).substr(0,4);
	var decsnYear  = this.ds_expDsnMastr.getColumn(0, "DECSN_YEAR");
	var budgetYear = this.ds_expDsnMastr.getColumn(0, "BUDGET_YEAR");
	if(year != decsnYear || year != budgetYear) {
		this.gfn_message("info.처리불가","자금지출부등기일은 선택된 회계년도 내에서만 입력 가능합니다.");
		return;
	}

	/// validation 체크
	if(!this.gfn_checkValidation_NoUpdChk(this.ds_expDsnMastr, this.ds_validation)) {
		return false;
	}
	// validation 체크
	if(!this.gfn_checkValidation_NoUpdChk(this.ds_ccmAppr, this.ds_validation)) {
		return false;
	}
	// validation 체크
	if(!this.gfn_checkValidation_NoUpdChk(this.ds_expDsnDetail, this.ds_validation)) {
		return false;
	}
	
	var fRow = this.ds_expDsnDetail.findRowExpr("VAT_AT == '1' && BILL_KND == ''");
	if(fRow > -1) {
		this.gfn_message("info.처리불가","["+(fRow+1)+"행] 계산서구분이 선택되지 않았습니다");
		return;
	}
	
	if(!this.gfn_checkValidation_NoUpdChk(this.ds_expDsnDtls, this.ds_validation)) {
		return false;
	}
	
	/*
	//첨부파일 필수입력 
	if(this.ds_fileList.rowcount == 0 && this.strRtnGbn == "I"){
		this.gfn_message("info.처리불가", "첨부파일을 등록해 주세요.");
		this.tab.set_tabindex(2);
		return;
	}
	*/
	
	// 거래유형 필수입력 처리
	if(this.comUtils.isNull(this.ds_expDsnMastr.getColumn(0,"ATMC_JRNLZ_TY_CODE"))) {
		this.gfn_message("info.처리불가","[계정정보] 거래유형을 선택하십시오.");
		return false;
	}

	
	if (!this.comUtils.isDatasetUpdated(this.ds_expDsnMastr) || !this.comUtils.isDatasetUpdated(this.ds_expDsnMtrDet)
		|| !this.comUtils.isDatasetUpdated(this.ds_expDsnDetail) || !this.comUtils.isDatasetUpdated(this.ds_expDsnDtls)) {
			this.fn_transaction("saveExpDsn");
	} else {
		if(this.strRtnGbn=="U"){
			this.gfn_message("comm.내역.변경.없음");
		}else{
			this.fn_transaction("saveExpDsn");
		}
	}
}


/*
 * 함수명  	: fn_sanction
 * 설명 		: '결재' 버튼 클릭 후
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_sanction();
 */
this.fn_sanction = function()
{
	// 유효성 체크
	if(this.comUtils.isDatasetUpdated(this.ds_expDsnMastr) || 
		this.comUtils.isDatasetUpdated(this.ds_expDsnMtrDet)|| 
		this.comUtils.isDatasetUpdated(this.ds_expDsnDetail)|| 
		this.comUtils.isDatasetUpdated(this.ds_expDsnDtls)||
		this.comUtils.isDatasetUpdated(this.ds_fileList)
		) {
		this.gfn_message("comm.정보.저장.요청", "지출결의서");
		return;
	}
	if(this.ds_expDsnMastr.getRowCount() == 0) {
		this.gfn_message("info.처리불가","계정정보/결의정보를 찾을 수 없습니다.");
		return;
	}
	if(this.ds_expDsnDetail.getRowCount() == 0) {
		this.gfn_message("info.처리불가","세부내용을 찾을 수 없습니다.");
		return;
	}
	
	// 금융기관
	var fRow = this.ds_fnncInstt.findRow("FNNC_INSTT_CODE",this.ds_expDsnDetail.getColumn(0,"FNNC_INSTT_CODE"));
	var fnncInsttNm = "";
	if(fRow > -1) {
		fnncInsttNm = this.ds_fnncInstt.getColumn(fRow, "FNNC_INSTT_CODE_NM");
	}
	// 상호
	var bcncNm = this.ds_expDsnDetail.getColumn(0,"BCNC_NM");
	if(this.ds_expDsnDetail.getRowCount() > 1) {
		bcncNm += " 외 "+(this.ds_expDsnDetail.getRowCount() - 1) + "명";
	}
	
	// 결재상신
	var arrSancData = [
		 "[지출]"+this.ds_expDsnMastr.getColumn(0,"SUMRY")										//결재제목
		,this.ds_expDsnMastr.getColumn(0,"DECSN_YEAR")											//결재연도
		,this.fn_dateStr(this.ds_expDsnMastr.getColumn(0,"ITNC_DE"),".")						//발의일자
		,this.fn_dateStr(this.ds_expDsnMastr.getColumn(0,"CNTRCT_DE"),".")						//계약일자
		,this.fn_dateStr(this.ds_expDsnMastr.getColumn(0,"CAUSE_ACTION_DE"),".")				//원인행위부등기
		,this.fn_dateStr(this.ds_expDsnMastr.getColumn(0,"ACPTNC_DE"),".")						//검수일자
		,this.fn_dateStr(this.ds_expDsnMastr.getColumn(0,"DET_DCSN_DE"),".")					//채무확정액등기
		,this.fn_dateStr(this.ds_expDsnMastr.getColumn(0,"PRMPC_JRNLZPR_RGIST_DE"),".")			//재고분개장등기
		,this.ds_expDsnMastr.getColumn(0,"GWAN_NM")												//관
		,this.ds_expDsnMastr.getColumn(0,"HANG_NM")												//항
		,this.ds_expDsnMastr.getColumn(0,"SEHANG_NM")											//세항
		,this.ds_expDsnMastr.getColumn(0,"MOK_NM")												//목
		,this.ds_expDsnMastr.getColumn(0,"SEMOK_NM")											//세목
		,this.fn_dateStr(this.ds_expDsnMastr.getColumn(0,"EXPNDTR_BUDGET_CNRL_DE"),".")			//지출예산통제원장등기
		,this.fn_dateStr(this.ds_expDsnMastr.getColumn(0,"CPTAL_EXPNDTR_ACNTBK_DE"),".")		//자금지출기록부등기
		,this.ds_expDsnMastr.getColumn(0,"CHECK_NO")											//지급번호
		,"일금 "+this.fn_numToHangul(this.ds_expDsnMastr.getColumn(0,"DECSN_AMOUNT"))+"원정"	//총금액_한글
		,"\\"+this.comUtils.formatComma(this.ds_expDsnMastr.getColumn(0,"DECSN_AMOUNT"))		//총금액
		,"\\"+this.comUtils.formatComma(this.ds_expDsnMtrDet.getColumn(0,"SUPLY_AMOUNT"))		//공급가액
		,"\\"+this.comUtils.formatComma(this.ds_expDsnMtrDet.getColumn(0,"VAT_AMOUNT"))			//부가가치세
		,this.ds_expDsnMastr.getColumn(0,"SUMRY")							//적요
		,this.ds_expDsnDetail.getColumn(0,"ADRES")												//주소
		,bcncNm																					//상호
		,this.ds_expDsnDetail.getColumn(0,"NM")													//채주_성명
		,this.fn_dateStr(this.ds_expDsnDetail.getColumn(0,"RCPT_DE"),".")						//영수일자
		,this.ds_expDsnDetail.getColumn(0,"RCPT_MAN")											//영수자_성명
		,fnncInsttNm																			//거래금융기관
		,this.ds_expDsnDetail.getColumn(0,"ACNUTNO")											//계좌번호
		,this.ds_expDsnDetail.getColumn(0,"RCPT_MAN")											//성명
		,this.fn_dateStr(this.ds_expDsnMastr.getColumn(0,"PYMNT_ITNC_DE"),".")					//지급발의일자
	];
	
	var formId = '0000000055';
	if(this.gfn_getDeptId() == '010000') {
		formId = '0000000054';	// 감사팀 결재양식
	}

	this.fn_callHandySanc2(
		 this						// context
		,formId						// formId
		,this.ds_expDsnMastr		// misDataset
		,"TBACC_EXP_DSN_MASTR"		// tableName
		,["DECSN_YEAR","DECSN_NO"]	// tableKey
		,arrSancData				// arrSancData
		,null
		,null
		,null
		,this.ds_fileList
	);
}

/**********************************************************************
 * CALL TRANSACTION 영역
 **********************************************************************/
 
/*
 * 함수명  	: fn_transaction
 * 설명 		: Transaction 요청 처리 함수
 * params  		: strSvcId : 서비스요청 ID
 * return Type 	: None
 * 사용법		: this.fn_transaction("SELECT");
 */
this.fn_transaction = function(strSvcId)
{
	var sArgs = "";
	
	switch (strSvcId) {
		case "selectExpDsn":
			var sController   	= "hsco/mis/acc/ACC020203/selectExpDsn.do";
			var sInDatasets   	= "input1=ds_cond";
			var sOutDatasets  	= "ds_expDsnMastr=output1 ds_expDsnMtrDet=output2 ds_expDsnDetail=output6 ds_expDsnDtls=output9";
			break;
		case "saveExpDsn":
			var sController   	= "hsco/mis/acc/ACC020203/saveExpDsn.do";
			var sInDatasets   	= "input1=ds_expDsnMastr:A input2=ds_expDsnMtrDet:U input6=ds_expDsnDetail:U input9=ds_expDsnDtls:U";
			var sOutDatasets  	= "ds_expDsnMastr=output1";
			
			// 결의서 팝업을 호출한 화면ID를 넘긴다.
			if(!this.comUtils.isNull(this.getOwnerFrame().trgFormId)) {
				sArgs = "TRG_FORM_ID=" + this.getOwnerFrame().trgFormId;
			}
			break;		
		case "selectExpCode":	// 지출결의서 코드정보
			var sController   	= "hsco/mis/acc/ACC020203/selectExpCode.do";
			var sInDatasets   	= "";
			var sOutDatasets  	= "ds_fnncInstt=output1";
			break;
		case "selectAtchFile":		// 첨부파일 조회
			var sController   	= "hsco/mis/acc/ACC020203/selectAtchFile.do";
			var sInDatasets   	= "input1=ds_expDsnMastr";
			var sOutDatasets  	= "ds_fileList=output1";
			break;	

		default:
			break;
	}

	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets, sArgs); 
}

 /**********************************************************************
 * Transaction Callback 영역
 ***********************************************************************/

 /*
 * 함수명  	: fn_callBack
 * 설명 		: Transaction Callback 처리
 * params  		: strSvcId    : 서비스요청 ID
 *                nErrorCode  : 오류 메시지 코드 ([예] 0 : Success, 그밖의 경우, error)
 *                strErrorMsg : 오류 메시지([예]  success.insert|정상적으로 등록되었습니다.)
 * return Type 	: None
 * 사용법		: 
 */
this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg)
{
	// 오류 및 성공 메시지를 화면에 보여준다.
	if (nErrorCode != 0) {
		//this.gfn_callback_message(strSvcId, nErrorCode, strErrorMsg);
	} 
	else {		
		// 성공 메시지를 보여주는 동작 외에 처리할 내용이 있으면 아래에 기술.
		// 처리할 내용이 없다면, switch 문은 생략합니다.
		switch(strSvcId) {
			case "selectExpDsn":
				
				this.fn_authCheck();	// 권한체크
				
				if(this.comUtils.isNotNull(this.ds_expDsnMastr.getColumn(0, "FILE_SN"))){
					this.fn_transaction("selectAtchFile");
				}
				break;
				
			case "saveExpDsn":
			    this.alert("저장 되었습니다.");
				//this.close(this.strRtnGbn);
				break;
				
			case "selectExpCode":		// 결의서 코드정보
				this.ds_fnncInstt.insertRow(0);
				this.ds_fnncInstt.setColumn(0, "FNNC_INSTT_CODE_NM", "미선택");
				break;

			default:
				break;
		}
	}
	
	// 오류 및 성공 메시지를 화면에 보여준다.
	this.gfn_callback_message(strSvcId, nErrorCode, strErrorMsg);
}

/***********************************************************************
 * non-Transaction 관련 컴포넌트 이벤트 처리 함수
 ***********************************************************************/
/*
 * 함수명  	: fn_close
 * 설명 		: 종료 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_close();
 */
this.fn_close = function()
{
	this.close(this.strRtnGbn);
}

/*
 * 함수명  	: ds_expDsnMastr_oncolumnchanged
 * 설명 		: 지출결의마스터 데이터 변경시 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_expDsnMastr_oncolumnchanged();
 */
this.ds_expDsnMastr_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	switch(e.columnid) {
		
		case "DET_DCSN_DE":				// 채무확정일자
			obj.setColumn(e.row, "PRMPC_JRNLZPR_RGIST_DE"	, e.newvalue);	// 원가분개장등기
			break;
		
		case "EXPNDTR_BUDGET_CNRL_DE":	// 지출예산통제
			obj.setColumn(e.row, "PYMNT_ITNC_DE"			, e.newvalue);	// 지급발의일자
			obj.setColumn(e.row, "CPTAL_EXPNDTR_ACNTBK_DE"	, e.newvalue);	// 자금지출부등기
			
			// 지출예산통제일자 변경시 영수일자 동일하게 변경 2019.09.08		
			for(i=0; i < this.ds_expDsnDetail.rowcount ; i++){
				this.ds_expDsnDetail.setColumn(i, "RCPT_DE"	, e.newvalue);	// 영수일자
			}
						
			break;

			
		// 발의일자 변경시 다른일자 동일하게 변경 
		case "ITNC_DE":				
			//obj.setColumn(e.row, "DET_DCSN_DE"	, e.newvalue);	// 채무확정일자 //주석처리 2019.09.07
			obj.setColumn(e.row, "PYMNT_ITNC_DE"	, e.newvalue);	// 지급발의일자			
			//obj.setColumn(e.row, "PRMPC_JRNLZPR_RGIST_DE"	, e.newvalue);	// 원가분개장등기 //주석처리 2019.09.07
			obj.setColumn(e.row, "EXPNDTR_BUDGET_CNRL_DE"	, e.newvalue);	// 지출예산통제 일자
			obj.setColumn(e.row, "CPTAL_EXPNDTR_ACNTBK_DE"	, e.newvalue);	// 자금지출부등기
			//obj.setColumn(e.row, "CAUSE_ACTION_DE"	, e.newvalue);	// 원인행위일자
			//this.ds_expDsnMtrDet.setColumn(this.ds_expDsnMtrDet.rowposition, "CNTRCT_DE"	, e.newvalue);	// 계약일자
			//this.ds_expDsnMtrDet.setColumn(this.ds_expDsnMtrDet.rowposition, "ACPTNC_DE"	, e.newvalue);	// 검수일자
			
			break;
				
		default:
			break;
	}
}

// 검수일자 변경시 다른일자 동일하게 변경
this.ds_expDsnMtrDet_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	switch(e.columnid) {
		case "ACPTNC_DE":				
			this.ds_expDsnMastr.setColumn(0, "DET_DCSN_DE"	, e.newvalue);	// 채무확정일자			
			this.ds_expDsnMastr.setColumn(0, "PRMPC_JRNLZPR_RGIST_DE"	, e.newvalue);	// 원가분개장등기		
			break;
			
		default:
			break;
	}
}

/*
 * 함수명  	: ds_expDsnDetail_oncolumnchanged
 * 설명 		: 지출결의세부 데이터 변경시 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_expDsnDetail_oncolumnchanged();
 */
this.ds_expDsnDetail_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	switch(e.columnid) {
		case "DECSN_AMOUNT":	// 결의금액	
			obj.setColumn(e.row, "SUPLY_AMOUNT", e.newvalue - obj.getColumn(e.row, "VAT"));
			this.ds_expDsnMastr.setColumn(0, "DECSN_AMOUNT", obj.getSum("DECSN_AMOUNT"));			// 결의금액 합계
			this.ds_expDsnMtrDet.setColumn(0, "SUPLY_AMOUNT", obj.getSum("SUPLY_AMOUNT"));			// 공급가액 합계
			this.ds_expDsnMtrDet.setColumn(0, "VAT_AMOUNT", obj.getSum("VAT"));						// 부가세액 합계
			break;
			
		case "SUPLY_AMOUNT":	// 공급가액
		case "VAT":				// 부가세액			
			obj.setColumn(e.row, "DECSN_AMOUNT", obj.getColumn(e.row, "SUPLY_AMOUNT")+obj.getColumn(e.row, "VAT"));
			this.ds_expDsnMastr.setColumn(0, "DECSN_AMOUNT", obj.getSum("DECSN_AMOUNT"));			// 결의금액 합계
			this.ds_expDsnMtrDet.setColumn(0, "SUPLY_AMOUNT", obj.getSum("SUPLY_AMOUNT"));			// 공급가액 합계
			this.ds_expDsnMtrDet.setColumn(0, "VAT_AMOUNT", obj.getSum("VAT"));						// 부가세액 합계
			break;	
			
		//오류시 은행,계좌번호 변경시 오류여부 초기화
		case "FNNC_INSTT_CODE":// 은행
		case "ACNUTNO": //계좌번호
		
			var CHGHY = this.ds_expDsnDetail.getColumn(this.ds_expDsnDetail.rowposition, "CHGHY");
			if( e.oldvalue != e.newvalue && !this.comUtils.isNullEmpty(CHGHY) ){
				this.ds_expDsnDetail.setColumn(this.ds_expDsnDetail.rowposition, "ERROR_AT", "0");	// 에러여부
			}
			break;
		case "REAL_USER":
		case "ATNDNC_MAN":
		case "PRVONSH":
			this.ds_ccmAppr.setColumn(e.row, e.columnid, e.newvalue);
			break;
		default:
			break;
	}
}

/*
 * 함수명  	: ds_expDsnDetail_onrowsetchanged
 * 설명 		: 지출결의세부 데이터 변경시 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_expDsnDetail_onrowsetchanged();
 */
this.ds_expDsnDetail_onrowsetchanged = function(obj:Dataset, e:nexacro.DSRowsetChangeEventInfo)
{
	this.ds_expDsnMastr.setColumn(0, "DECSN_AMOUNT", obj.getSum("DECSN_AMOUNT"));			// 결의금액 합계
	this.ds_expDsnMtrDet.setColumn(0, "SUPLY_AMOUNT", obj.getSum("SUPLY_AMOUNT"));			// 공급가액 합계
	this.ds_expDsnMtrDet.setColumn(0, "VAT_AMOUNT", obj.getSum("VAT"));						// 부가세액 합계
}

/*
 * 함수명  	: fn_popup_onclick
 * 설명 		: 팝업창 호출
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_popup_onclick();
 */
this.fn_popup_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	switch(obj.name) {
		case "btn_empPopup":
			this.gfn_popup("btn_empPopup", 800, 530, "", "", "com::empno_P01.xfdl", "fn_popupCallBack", true);
			break;
			
		case "btn_budgetAcntPopup":	// 예산계정과목 팝업
			var parm = {
				  arg_0      : this
				 ,searchDs   : this.ds_expDsnMastr.saveXML()       	// 검색조건(YEAR, BSNS_SE, BALC_SE, DEPT_CODE 컬럼만 이용)
				 ,strObj     : "edt_YEAR,rdo_BALC_SE" 			// 수정불가능 처리할 오브젝트 명(ex : "edt_YEAR,cbo_BSNS_SE,rdo_BALC_SE,div_srchDept")
				 ,year_S     : this.ds_expDsnMastr.getColumn(0,"BUDGET_YEAR")         // 예산년도(srchDs보다 우선순위를 가짐)
				 ,bsnsSe_S   : null         // 사업구분(srchDs보다 우선순위를 가짐)
				 ,balcSe_S   : null         // 수지구분(srchDs보다 우선순위를 가짐)
				 ,deptCode_S : null         // 부서코드(srchDs보다 우선순위를 가짐)
				 ,acntPopup  : false        // (true : 예산계정코드선택팝업, false : 지출단위선택팝업)
				 ,acntCode_S : null         // 고정 처리할 예산계정코드 목록 (0000000)
				 ,bAccPopup  : true
				 ,pageId  : "ACC020203_P10"
			};
			this.gfn_popup("btn_budgetAcntPopup", 800, 620, "예산계정과목", parm, "com::bdgAcntPop.xfdl", "fn_popupCallBack", true);
			break;
			
		case "btn_bsnsPopup":		// 사업지구 팝업
			this.gfn_popup("btn_bsnsPopup", 500, 500, "사업지구", "", "pms_prj::popBsns.xfdl", "fn_popupCallBack", true);
			break;
			
		case "btn_bcncPopup":		// 거래처 팝업
			if(this.ds_expDsnDetail.getRowCount() > 0) {
				this.gfn_popup("btn_bcncPopup", 600, 500, "거래처", {searchDs:this.ds_cond.saveXML(),bAcnutPop:true}, "mis_ctr::CTR010101_P02.xfdl", "fn_popupCallBack", true);
			}
			break;
			
		case "btn_actPopup":		// 원인행위정보 팝업
			var param = {
				 arg_0		: this
				,anactKnd	: '03'
				,deptCode	: this.ds_expDsnMastr.getColumn(0, "DEPT_CODE")
				,deptNm		: this.ds_expDsnMastr.getColumn(0, "DEPT_NM")
			};
			this.gfn_popup("btn_actPopup", 600, 500, "원인행위정보", param, "mis_acc::ACC020203_P09.xfdl", "fn_popupCallBack", true);
			break;
			
		case "btn_actPopupView":
			var causeActionNo = this.ds_expDsnMastr.getColumn(0, "CAUSE_ACTION_NO");
			if(this.comUtils.isNotNull(causeActionNo)){
				var args	 = {
					causeActionNo	: causeActionNo
				};
				this.gfn_popup("actPopupView", 885, 665, "원인행위조회", args, "mis_acc::ACC020201_P01.xfdl", "fn_popupCallBack", true);
			}
			break;
		
		case "btn_atmcJrnlzTy":		// 자동분개유형 팝업
			
			var parm = {
				  arg_0      : this
				 ,year       : this.ds_expDsnMastr.getColumn(0, "BUDGET_YEAR")
				 ,bsnsSe     : this.ds_expDsnMastr.getColumn(0, "BSNS_SE")
				 ,balcSe     : this.ds_expDsnMastr.getColumn(0, "BALC_SE")
				 ,acntCode   : this.ds_expDsnMastr.getColumn(0, "BUDGET_ACNT_CODE")
				 ,bukipCode  : this.ds_expDsnMastr.getColumn(0, "EXPNDTR_UNIT_CODE")
				 ,cardAt	 : '1' // 카드여부
			};			
			
			if(this.comUtils.isNull(parm.year) ||
				this.comUtils.isNull(parm.bsnsSe) ||
				this.comUtils.isNull(parm.balcSe) ||
				this.comUtils.isNull(parm.acntCode)) {
				this.gfn_message("comm.항목.선택.요청", "예산계정과목");
				return;
			}
			
			this.gfn_popup("btn_atmcJrnlzTy", 815, 563, "자동분개유형", parm, "mis_acc::ACC020203_P12.xfdl", "fn_popupCallBack", true);
			break;		
	
		case "btn_branchAcnut":
			var parm = {
				arg_0 : this 
			};

			this.gfn_popup("btn_branchAcnut", 563, 500, "브런치계좌조회", parm, "mis_fun::FUN010103_P01.xfdl", "fn_popupCallBack", true);
			break;
			
		default:
			break;
	}
}

/*
 * 함수명  	: fn_popupCallBack
 * 설명 		: 팝업창 콜백 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_popupCallBack();
 */
this.fn_popupCallBack = function(strID, variant)
{
	switch(strID) {
		case "btn_empPopup":
			if(variant != null && variant.length > 0) {
				var dsTemp = new Dataset();
				dsTemp.loadXML(variant);
				this.ds_expDsnDetail.setColumn(this.ds_expDsnDetail.rowposition, "REAL_USER",    	 dsTemp.getColumn(0, "EMPNO"));
				this.ds_expDsnDetail.setColumn(this.ds_expDsnDetail.rowposition, "REAL_USER_NM",     dsTemp.getColumn(0, "EMPNM"));
			}
		break;
		
		case "btn_budgetAcntPopup":	// 예산계정과목 팝업 콜백
			if(variant != null && variant.length > 0) {
				var dsTemp = new Dataset();
				dsTemp.loadXML(variant);
				this.ds_expDsnMastr.setColumn(0, "DECSN_YEAR", 				dsTemp.getColumn(0, "YEAR"));					// 회계년도
				this.ds_expDsnMastr.setColumn(0, "BUDGET_YEAR", 			dsTemp.getColumn(0, "YEAR"));					// 예산년도
				this.ds_expDsnMastr.setColumn(0, "BSNS_SE", 				dsTemp.getColumn(0, "BSNS_SE"));				// 사업구분
				this.ds_expDsnMastr.setColumn(0, "BALC_SE", 				dsTemp.getColumn(0, "BALC_SE"));				// 수지구분
				this.ds_expDsnMastr.setColumn(0, "BUDGET_ACNT_CODE", 		dsTemp.getColumn(0, "BUDGET_ACNT_CODE"));		// 예산계정코드
				this.ds_expDsnMastr.setColumn(0, "BUDGET_ACNT_NM", 			"("+dsTemp.getColumn(0, "DEPT_NM")+")"+ dsTemp.getColumn(0, "BUDGET_TREE_NM"));			// 예산계정명
				this.ds_expDsnMastr.setColumn(0, "BUDGET_ACNT_BLCE", 		dsTemp.getColumn(0, "BUDGET_BALC"));			// 예산잔액
				this.ds_expDsnMastr.setColumn(0, "EXPNDTR_UNIT_CODE", 		dsTemp.getColumn(0, "EXPNDTR_UNIT_CODE"));		// 지출단위코드
				this.ds_expDsnMastr.setColumn(0, "EXPNDTR_UNIT_CODE_BLCE", 	dsTemp.getColumn(0, "EXPNDTR_UNIT_BALC"));		// 부기잔액
				this.ds_expDsnMastr.setColumn(0, "EXPNDTR_UNIT_NM", 		dsTemp.getColumn(0, "EXPNDTR_UNIT_NM"));		// 부기코드명
				this.ds_expDsnMastr.setColumn(0, "ASIGN_JAN_AMOUNT", 		dsTemp.getColumn(0, "ASIGN_JAN_AMOUNT"));		// 배정잔액
				
				//사업지구
				this.ds_expDsnMastr.setColumn(0, "BSNS_CODE",			dsTemp.getColumn(0, "DETAIL_BSNS_CODE"));	// 사업지구코드
				this.ds_expDsnMastr.setColumn(0, "BSNS_NM",				dsTemp.getColumn(0, "DETAIL_BSNS_NM"));		// 사업지구명
				this.ds_expDsnMastr.setColumn(0, "BUDGET_DEPT_CODE"				, dsTemp.getColumn(0, "DEPT_CODE"));	// 예산부서코드
				
				// 거래유형 초기화(예산계정과목 변경후엔 거래유형을 다시 선택하게 해야 함)
				this.ds_expDsnMastr.setColumn(0, "ATMC_JRNLZ_TY_CODE"	, 	"");	// 자동분개유형
				this.ds_expDsnMastr.setColumn(0, "GNRL_DEBTOR_ACNT_NM"	, 	"");	// 일반_차변계정
				this.ds_expDsnMastr.setColumn(0, "GNRL_CRDIT_ACNT_NM"	, 	"");	// 일반_대변계정
				this.ds_expDsnMastr.setColumn(0, "SETOFF_DEBTOR_ACNT_NM", 	"");	// 상계_차변계정
				this.ds_expDsnMastr.setColumn(0, "SETOFF_CRDIT_ACNT_NM"	, 	"");	// 상계_대변계정
				
				// 거래유형 팝업 호출
				this.fn_popup_onclick({ name:"btn_atmcJrnlzTy" } , null);
			}
			break;
			
		case "btn_bsnsPopup":		// 사업지구 팝업 콜백
			if(variant != null && variant.length > 0) {
				var dsTemp = new Dataset();
				dsTemp.loadXML(variant);
				this.ds_expDsnMastr.setColumn(0, "BSNS_CODE",			dsTemp.getColumn(0, "BSNS_CODE"));			// 사업지구코드
				this.ds_expDsnMastr.setColumn(0, "BSNS_NM",				dsTemp.getColumn(0, "BSNS_NM"));			// 사업지구명
			}
			break;

		case "btn_bcncPopup":		// 거래처 팝업 콜백
			
			if(variant != null && variant.length > 0) {
				var currow = this.ds_expDsnDetail.rowposition;
				var dsTemp = new Dataset();
				dsTemp.loadXML(variant);
				this.ds_expDsnDetail.setColumn(currow, "BCNC_CODE", dsTemp.getColumn(0, "BCNC_CODE"));					// 거래처코드
				this.ds_expDsnDetail.setColumn(currow, "BCNC_NM", dsTemp.getColumn(0, "BCNC_NM"));						// 거래처명
				this.ds_expDsnDetail.setColumn(currow, "NM", dsTemp.getColumn(0, "RPRSNTV"));							// 대표자명

				//this.ds_expDsnDetail.setColumn(currow, "RCPT_MAN", dsTemp.getColumn(0, "RPRSNTV"));					// 영수자							
				this.ds_expDsnDetail.setColumn(currow, "RCPT_MAN", dsTemp.getColumn(0, "DPSTR_NM"));	// 영수자 <- 예금주명
								
				var addr = "";
				if(!this.comUtils.isNull(dsTemp.getColumn(0, "RN"))) {
					addr += dsTemp.getColumn(0, "RN");
					if(!this.comUtils.isNull(dsTemp.getColumn(0, "DETAIL_RDNMADR"))) {
						addr += "";
					}
				}
				if(!this.comUtils.isNull(dsTemp.getColumn(0, "DETAIL_RDNMADR"))) {
					addr += dsTemp.getColumn(0, "DETAIL_RDNMADR");
				}
				if(this.comUtils.isNull(addr)) {
					if(!this.comUtils.isNull(dsTemp.getColumn(0, "ADRES"))) {
						addr += dsTemp.getColumn(0, "ADRES");
						if(!this.comUtils.isNull(dsTemp.getColumn(0, "DETAIL_ADRES"))) {
							addr += "";
						}
					}
					if(!this.comUtils.isNull(dsTemp.getColumn(0, "DETAIL_ADRES"))) {
						addr += dsTemp.getColumn(0, "DETAIL_ADRES");
					}
				}
				this.ds_expDsnDetail.setColumn(currow, "ADRES", addr);	// 주소
				this.ds_expDsnDetail.setColumn(currow, "FNNC_INSTT_CODE", dsTemp.getColumn(0, "BANK_CODE"));			// 지급은행
				this.ds_expDsnDetail.setColumn(currow, "ACNUTNO", dsTemp.getColumn(0, "ACNUTNO"));						// 계좌번호
				
				this.ds_expDsnDetail.setColumn(currow, "ENTRPRS_SE"			, dsTemp.getColumn(0, "SMLPZ_SE"));					// 기업구분(중소기업,대기업)
				this.ds_expDsnDetail.setColumn(currow, "EVRFRND"			, dsTemp.getColumn(0, "EVRFRND_AT"));				// 친환경
				this.ds_expDsnDetail.setColumn(currow, "TCNDVLP"			, dsTemp.getColumn(0, "TCNDVLP"));					// 기술개발
				this.ds_expDsnDetail.setColumn(currow, "CNTRWK_PRPOS_MTRIL"	, dsTemp.getColumn(0, "CNTRWK_PRPOS_MTRIL"));		// 공사용자재
				this.ds_expDsnDetail.setColumn(currow, "AREA_ENTRPS"		, dsTemp.getColumn(0, "AREA_ENTRPS_AT"));			// 지역업체
				this.ds_expDsnDetail.setColumn(currow, "FEMALE_ENTRPRS"		, dsTemp.getColumn(0, "FEMALE_ENTRPRS_AT"));		// 여성기업
				this.ds_expDsnDetail.setColumn(currow, "DSPSN"				, dsTemp.getColumn(0, "DSPSN_ENTRPRS_AT"));			// 장애인
				this.ds_expDsnDetail.setColumn(currow, "SRSILL_DSPSN"		, dsTemp.getColumn(0, "SRSILL_DSPSN_ENTRPRS_AT"));	// 중증장애인
				this.ds_expDsnDetail.setColumn(currow, "SOCTY_ENTRPRS"		, dsTemp.getColumn(0, "SOCENT_AT"));				// 사회적기업
				this.ds_expDsnDetail.setColumn(currow, "GREEN_PRDUCT"		, dsTemp.getColumn(0, "GREEN_PRDUCT_AT"));			// 녹색제품
				this.ds_expDsnDetail.setColumn(currow, "DSPSN_PRDCTN_FCLTY"	, dsTemp.getColumn(0, "DSPSN_PRDCTN_FCLTY_AT"));	// 장애인생산시설
				this.ds_expDsnDetail.setColumn(currow, "SOCTY_CPER_MXTR"	, dsTemp.getColumn(0, "SOCTY_CPER_MXTR_AT"));		// 사회적협동조합
				this.ds_expDsnDetail.setColumn(currow, "DSPSN_STD_BPLC"		, dsTemp.getColumn(0, "DSPSN_STD_BPLC"));			// 장애인표준사업장
				this.ds_expDsnDetail.setColumn(currow, "WATER_INDUST"		, dsTemp.getColumn(0, "WATER_INDUST"));				// 물산업
				this.ds_expDsnDetail.setColumn(currow, "MDLC_INDUST"		, dsTemp.getColumn(0, "MDLC_INDUST"));				// 의료산업
				this.ds_expDsnDetail.setColumn(currow, "FARMNG_INDUST"		, dsTemp.getColumn(0, "FARMNG_INDUST"));			// 농업사업
				this.ds_expDsnDetail.setColumn(currow, "ENERGY_INDUST"		, dsTemp.getColumn(0, "ENERGY_INDUST"));			// 에너지산업
			}
			break;
		case "btn_actPopup":		// 원인행위정보 팝업 콜백
			if(variant != null && variant.length > 0) {
				var dsTemp = new Dataset();
				dsTemp.loadXML(variant);
				
				// 데이터셋 복사 칼럼 지정
				var strColInfo = [
					 "CAUSE_ACTION_NO=CAUSE_ACTION_NO"
					,"CNSUL_SJ=CNSUL_SJ"
					,"BUDGET_YEAR=BUDGET_YEAR"
					,"BSNS_SE=BSNS_SE"
					,"BALC_SE=BALC_SE"
					,"BSNS_CODE=BSNS_CODE"
					,"BSNS_NM=BSNS_NM"
					,"BUDGET_DEPT_CODE=BUDGET_DEPT_CODE"
					,"BUDGET_ACNT_CODE=BUDGET_ACNT_CODE"
					,"BUDGET_ACNT_NM=BUDGET_ACNT_NM"
					,"EXPNDTR_UNIT_CODE=BUKIP_CODE"
					,"EXPNDTR_UNIT_NM=BUKIP_NM"
					,"CAUSE_ACTION_DE=CNSUL_DE"
					,"EXPNDTR_UNIT_CODE_BLCE=EXECUT_BUDGET_JAN_AM"
					,"ASIGN_JAN_AMOUNT=ASIGN_JAN_AMOUNT"
					,"CYFD_SE=CYFD_SE"
					,"DECSN_YEAR=BUDGET_YEAR"
				];
				this.ds_expDsnMastr.copyRow(0, dsTemp, 0, strColInfo.join(","));
				
				if(this.ds_expDsnDetail.getRowCount() == 0) {
					this.ds_expDsnDetail.addRow();
				}
				
				// 예산 등 수정불가 항목 설정
				this.fn_setReadonly(this.div_detail1.cmb_CYFD_SE, null);
				this.fn_setReadonly(this.div_detail1.btn_budgetAcntPopup, null);
				this.fn_setReadonly(this.div_detail1.edt_bukipCode, null);
							
				// 거래유형 팝업 호출
				this.fn_popup_onclick({ name:"btn_atmcJrnlzTy" } , null);
			}
			break;
			
		case "btn_atmcJrnlzTy":		// 자동분개유형
			if(variant != null && variant.length > 0) {
				var dsTemp = new Dataset();
				dsTemp.loadXML(variant);
				this.ds_expDsnMastr.setColumn(0, "ATMC_JRNLZ_TY_CODE", 		dsTemp.getColumn(0, "SN"));						// 자동분개유형코드
				this.ds_expDsnMastr.setColumn(0, "GNRL_DEBTOR_ACNT_NM", 	dsTemp.getColumn(0, "GNRL_DEBTOR_ACNT_NM"));	// 일반_차변계정
				this.ds_expDsnMastr.setColumn(0, "GNRL_CRDIT_ACNT_NM", 		dsTemp.getColumn(0, "GNRL_CRDIT_ACNT_NM"));		// 일반_대변계정
				this.ds_expDsnMastr.setColumn(0, "SETOFF_DEBTOR_ACNT_NM", 	dsTemp.getColumn(0, "SETOFF_DEBTOR_ACNT_NM"));	// 상계_차변계정
				this.ds_expDsnMastr.setColumn(0, "SETOFF_CRDIT_ACNT_NM", 	dsTemp.getColumn(0, "SETOFF_CRDIT_ACNT_NM"));	// 상계_대변계정
			}
			break;
						
		case "btn_branchAcnut":
			if(variant != null && variant.length > 0) {				var dsTemp = new Dataset();
				dsTemp.loadXML(variant);
				this.ds_expDsnMastr.setColumn(0, "ACNUTNO", dsTemp.getColumn(0, "ACNUTNO"));
				this.ds_expDsnMastr.setColumn(0, "FNNC_INSTT_CODE", dsTemp.getColumn(0, "BANK_CODE"));
			}
			
			break;
		break;
	}
}

/*
 * 함수명  	: btn_add_onclick
 * 설명 		: 행추가 버튼
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_add_onclick();
 */
this.btn_add_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.tab.tabindex == 0) {
		// 세부내용 행추가
		var nRow = this.ds_expDsnDetail.addRow();
		this.ds_expDsnDetail.setColumn(nRow, "DECSN_AMOUNT"		, "0");	// 결의금액
		this.ds_expDsnDetail.setColumn(nRow, "TAXXPT_AMOUNT"	, "0");	// 면세금액
		this.ds_expDsnDetail.setColumn(nRow, "SUPLY_AMOUNT"		, "0");	// 공급가액
		this.ds_expDsnDetail.setColumn(nRow, "VAT"				, "0");	// 부가세액
		this.ds_expDsnDetail.setColumn(nRow, "VAT_DECSN_AMOUNT"	, "0");	// 부가세결의금액
		this.ds_expDsnDetail.setColumn(nRow, "VAT_AT"			, "0");	// 부가세여부
		this.ds_expDsnDetail.setColumn(nRow, "RCPT_DE"			, this.ds_expDsnMastr.getColumn(0,"EXPNDTR_BUDGET_CNRL_DE"));	// 영수일자
	} else if(this.tab.tabindex == 1) {
		// 지출결의내용 행추가
		var nRow = this.ds_expDsnDtls.addRow();
	}
}

/*
 * 함수명  	: btn_del_onclick
 * 설명 		: 행삭제 버튼
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_del_onclick();
 */
this.btn_del_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.tab.tabindex == 0) {
		// 세부내용 행삭제
		if(this.ds_expDsnDetail.getRowCount() > 0) {
			if (this.gfn_message("confirm.삭제여부") ) {
				this.ds_expDsnDetail.deleteRow(this.ds_expDsnDetail.rowposition);
			}
		}
	} else if(this.tab.tabindex == 1) {
		// 지출결의내용 행삭제
		if(this.ds_expDsnDtls.getRowCount() > 0) {
			if (this.gfn_message("confirm.삭제여부") ) {
				this.ds_expDsnDtls.deleteRow(this.ds_expDsnDtls.rowposition);
			}
		}
	}
}

/*
 * 함수명  	: btn_del_onclick
 * 설명 		: 행취소 버튼
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_reset_onclick();
 */
this.btn_reset_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.tab.tabindex == 0) {
		// 지출결의내용 행 초기화
		if(this.gfn_message("confirm.취소여부") ){
			this.ds_expDsnDetail.reset();
			this.ds_expDsnDetail.applyChange();
			return;
		}
	} else if(this.tab.tabindex == 1) {
		// 지출결의내용 행 초기화
		if(this.gfn_message("confirm.취소여부") ){
			this.ds_expDsnDtls.reset();
			this.ds_expDsnDtls.applyChange();
			return;
		}
	}
}

/***********************************************************************
* 사용자 정의 함수
************************************************************************/
/*
 * 함수명  	: tab_onchanged
 * 설명 		: 탭페이지에 따른 버튼 visible 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: n/a
 */
this.tab_onchanged = function(obj:Tab, e:nexacro.TabIndexChangeEventInfo)
{
	switch(obj.tabindex){
		case 0:
			this.btn_delFiles.set_visible(false);
			this.btn_uploadFiles.set_visible(false);
			this.btn_downFiles.set_visible(false);
			
			this.btn_add.set_visible(false);
			this.btn_reset.set_visible(false);
			this.btn_del.set_visible(false);
			break;
			
		case 1:
			this.btn_delFiles.set_visible(false);
			this.btn_uploadFiles.set_visible(false);
			this.btn_downFiles.set_visible(false);
			
			this.btn_add.set_visible(true);
			this.btn_reset.set_visible(true);
			this.btn_del.set_visible(true);
			break;
			
		case 2:
			this.btn_delFiles.set_visible(true);
			this.btn_uploadFiles.set_visible(true);
			this.btn_downFiles.set_visible(true);
			
			this.btn_add.set_visible(false);
			this.btn_reset.set_visible(false);
			this.btn_del.set_visible(false);
			break;
	}
}


/*
 * 함수명  	: btn_uploadFiles_onclick
 * 설명 		: '파일업로드' 버튼 클릭 후 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_uploadFiles_onclick(obj,e);
 */
this.btn_uploadFiles_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	// 첨부파일 업로드(fileSn 자동채번 / 첨부파일 Master에 ROW추가 / 파일 업로드 및 자동저장 / 테이블에 fileSn반영 / 데이터셋에 fileSn반영, 단 신규 ROW가 아닐경우 ROWTYPE은 유지)
	this.fn_autoFileSn(
		 "MIS"									// 대분류   (SYS_SE)
		,"ACC"									// 업무구분 (JOB_SE)
		, this.File_UpDownManager				// fileManager 오브젝트
		, this.ds_fileList						// fileObject
		, this.ds_expDsnMastr					// fileSn을 불러오거나 반영해야 하는 컬럼
		, "TBACC_EXP_DSN_MASTR"					// fileSn을 저장할 테이블
		, "FILE_SN"								// fileSn 컬럼명이 다를 경우를 대비
		, ["DECSN_NO","DECSN_YEAR"]				// fileSn을 저장할 테이블의 PK (FileSn 확인 및 자동반영목적)
	);
}

/*
 * 함수명  	: btn_downFiles_onclick
 * 설명 		: '선택다운로드' 버튼 클릭 후 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_downFiles_onclick(obj,e);
 */
this.btn_downFiles_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var findRow = this.ds_fileList.findRow("CHK", "1");
	if(findRow < 0) {
		this.gfn_message("comm.데이터.선택.없음");
		return;
	}
	
	for(var fRow = 0; fRow < this.ds_fileList.getRowCount(); fRow++) {
		var fileSn    = this.ds_fileList.getColumn(fRow, "FILE_SN");
		var fileOrder = this.ds_fileList.getColumn(fRow, "FILE_ORDR");
		var fileName  = this.ds_fileList.getColumn(fRow, "ORGINL_FILE_NM");
		var chk       = this.ds_fileList.getColumn(fRow, "CHK");
		if(chk == '1') {
			this.File_UpDownManager.download(fileSn, fileOrder, fileName);
		}
	}
}


/*
 * 함수명  	: btn_delFiles_onclick
 * 설명 		: '선택삭제' 버튼 클릭 후 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_delFiles_onclick(obj,e);
 */
this.btn_delFiles_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var findRow = this.ds_fileList.findRow("CHK", "1");
	if(findRow < 0) {
		this.gfn_message("comm.데이터.선택.없음");
			return;
	}
	
	if(!this.gfn_message("confirm.선택파일.삭제여부", "들")){
		return false;
	}
	
	for(var fRow = this.ds_fileList.getRowCount()-1; fRow >= 0; fRow--) {
		var chkVal = this.ds_fileList.getColumn(fRow, "CHK");
		if(chkVal == '1') {
			this.ds_fileList.deleteRow(fRow);
		}
	}
	
	var strSvcId   	 = "deleteFile";
	var sController  = "hsco/cmm/file/deleteFile.do";
	var sInDatasets  = "input1=ds_fileList:U";
	var sOutDatasets = "ds_fileList=output1";
	
	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets); 
}

/*
 * 함수명  	: grd_cmmnAtchmnfl_onheadclick
 * 설명 		: Grid expand 이미지 클릭 후 이벤트 처리(자동분개유형 Grid)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.grd_cmmnAtchmnfl_onheadclick(obj,e);
 */

this.tab_tabpage3_grd_file_onheadclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
		if(e.col == 0) {
		var strVal = obj.getCellProperty("head", e.cell, "text");
		if (this.comUtils.isNullEmpty(strVal)) {
			strVal = "0";	// 값이 존재하지 않는 경우 해제
		}
		
		// Head값 반전
		if (strVal == "0") {
			obj.setCellProperty("head", e.cell, "text", '1');
			strVal = "1";
		} else {
			obj.setCellProperty("head", e.cell, "text", '0');
			strVal = "0";
		}
		
		// Body 셋팅
		this.ds_fileList.set_enableevent(false);
		for (var cRow = 0; cRow < this.ds_fileList.getRowCount(); cRow++) {
			this.ds_fileList.setColumn(cRow, "CHK", strVal);
		}
		this.ds_fileList.set_enableevent(true);
	}
}


/*
 * 함수명  	: fn_authCheck
 * 설명 		: 지출결의서 권한 체크
 * params  		: 
 * return Type 	: None
 * 사용법		: 
 */
this.fn_authCheck = function() 
{
	var sanctnKnd = ['1','4','5'];	// 1:상신, 4:중간결재, 5:결재완료
	
	switch(this.getOwnerFrame().trgFormId) {
		case "ACC020203":	// 지출결의서 관리
			if(sanctnKnd.indexOf(this.ds_expDsnMastr.getColumn(0, "SANCTN_KND")) > -1) {
				var except = [
					 "btn_save"				// 저장 버튼
					,"btn_close2"			// 종료 버튼
					,"btn_downFiles"		// 첨부파일 다운로드
					,"grd_file"
					,"txt_sumry" 			// 적요 
					,"cmb_entrprsSe"		// 기업구분
					,"div_PrductSe"			// 제품구분
					,"btn_actPopupView"		// 원인행위정보 버튼
					,"edt_rcptMan"			// 영수자
					,"cmd_fnncInstt"		// 지급은행
					,"edt_acnutno"			// 계좌번호
					,"cal_detDcsnDe"			// 채무확정일자
					,"cal_prmpcJrnlzprRgistDe"	// 분개장등기
					,"cal_pymntItncDe"			// 지급발의일자
					,"cal_expndtrBudgetCnrlDe"	// 지출예산통제
					,"cal_cptalExpndtrAcntbkDe"	// 자금지출부등기
					,"btn_branchAcnut"			// 지출계좌
					,"btn_atmcJrnlzTy"			// 분개유형
					,"btn_delFiles"				// 파일삭제
					,"btn_uploadFiles"			// 파일업로드
					,"btn_downFiles"			// 파일 다운로드
				];
				this.fn_setReadonly(this, except);
			}
			break;
			
		case "ACC020305":	// 중소기업구매실적
			var except = [
				 "btn_save"				// 저장 버튼
				,"btn_close2"			// 종료 버튼
				,"btn_downFiles"		// 첨부파일 다운로드
				,"grd_file"
				,"cmb_entrprsSe"		// 기업구분
				,"div_PrductSe"			// 제품구분
			];
			this.fn_setReadonly(this, except);
			break;
			
		case "AUD020101":	// 법인카드내역관리	
			var except = [
				  "btn_close2"			// 종료 버튼
				 ,"btn_downFiles"		// 첨부파일 다운로드
				 ,"grd_file"
			];
			this.fn_setReadonly(this, except);			
			break;
				
		default:			// 그 외 모든화면
			if(sanctnKnd.indexOf(this.ds_expDsnMastr.getColumn(0, "SANCTN_KND")) > -1) {
				var except = [
					 "btn_save"				// 저장 버튼
					,"btn_close2"			// 종료 버튼
					,"btn_downFiles"		// 첨부파일 다운로드
					,"grd_file"
					//,"txt_sumry" 			// 적요 
					,"cmb_entrprsSe"		// 기업구분
					,"div_PrductSe"			// 제품구분
					,"btn_actPopupView"		// 원인행위정보 버튼
				];
				this.fn_setReadonly(this, except);
			} else if(this.ds_expDsnMastr.getColumn(0, "EXPNDTR_CNFIRM_AT") == "1") {	// 재무팀승인
				var except = [
					 "btn_sanctn"			// 결재 버튼
					,"btn_save"				// 저장 버튼
					,"btn_close2"			// 종료 버튼
					,"btn_downFiles"		// 첨부파일 다운로드
					,"grd_file"
					//,"txt_sumry" 			// 적요 
					,"cmb_entrprsSe"		// 기업구분
					,"div_PrductSe"			// 제품구분
					,"btn_actPopupView"		// 원인행위정보 버튼
					
				];
				this.fn_setReadonly(this, except);
			}
			break;
	}
	
	// 재무팀 승인 전엔 결재버튼 비활성화
	if(sanctnKnd.indexOf(this.ds_expDsnMastr.getColumn(0, "SANCTN_KND")) == -1 && this.ds_expDsnMastr.getColumn(0, "EXPNDTR_CNFIRM_AT") != "1") {
		this.sta_msg.set_visible(true);
		this.fn_setReadonly(this.btn_sanctn, null);
	}
	
}
this.ds_expDsnDetail_onrowposchanged = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{
	//오류시 첨부파일 삭제버튼 사용 금지 2016.08.20
	var ERROR_AT = obj.getColumn(e.newrow, "ERROR_AT");
	if(ERROR_AT == "1"){
		this.btn_delFiles.set_enable(false);
	}
	else{
		this.btn_delFiles.set_enable(true);
	}
}


this.tab_tabpage3_grd_file_oncelldblclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	var fileSn    = this.ds_fileList.getColumn(this.ds_fileList.rowposition, "FILE_SN");
	var fileOrder = this.ds_fileList.getColumn(this.ds_fileList.rowposition, "FILE_ORDR");
	var fileName  = this.ds_fileList.getColumn(this.ds_fileList.rowposition, "ORGINL_FILE_NM");
	this.File_UpDownManager.download(fileSn, fileOrder, fileName);
}

this.ds_expDsnMastr_cancolumnchange = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	switch(e.columnid) {
		case "CPTAL_EXPNDTR_ACNTBK_DE":
			var year 	   = String(e.newvalue).substr(0,4);
			var decsnYear  = obj.getColumn(e.row, "DECSN_YEAR");
			var budgetYear = obj.getColumn(e.row, "BUDGET_YEAR");
			if(year != decsnYear || year != budgetYear) {
				this.gfn_message("info.처리불가","자금지출부등기일은 선택된 회계년도 내에서만 입력 가능합니다.");
				return false;
			}
			break;
		default:
			break;
	}
	
	return true;
}
]]></Script>
  </Form>
</FDL>
