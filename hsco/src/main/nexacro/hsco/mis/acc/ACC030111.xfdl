<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\default_typedef.xml"/>
  <Form id="ACC030111" classname="UI_ACC030111" left="0" top="0" width="1059" height="735" titletext="매입전표생성" onload="ACC030111_onload" oninit="ACC030111_oninit">
    <Layouts>
      <Layout>
        <Div id="div_SEARCH" taborder="0" text="Div00" left="0" top="0" right="28" height="59" applystyletype="cascade,keep" cssclass="div_WFSA_Box">
          <Layouts>
            <Layout>
              <Static id="sta_EMPL_SE00" taborder="6" text="사업자번호" cssclass="sta_WFSA_Label" left="15" top="31" width="77" height="21"/>
              <Static id="sta_regsDate" taborder="7" text="작성일" cssclass="sta_WFSA_Label" left="15" top="5" width="51" height="21"/>
              <Static id="Static09" taborder="8" text="15" visible="false" left="0" top="0" width="15" height="57" style="background:#00ffff66;"/>
              <Calendar id="cal_bgnde" taborder="0" dateformat="yyyy-MM-dd" cssclass="cal_WF_Essential" left="92" top="5" width="100" height="21"/>
              <Calendar id="cal_endde" taborder="1" dateformat="yyyy-MM-dd" cssclass="cal_WF_Essential" left="209" top="5" width="100" height="21"/>
              <Static id="Static00" taborder="9" text="~" left="194" top="5" width="13" height="21" style="align:center;"/>
              <Static id="sta_bcncNm" taborder="10" text="거래처명" cssclass="sta_WFSA_Label" left="324" top="32" width="64" height="21"/>
              <Static id="sta_billKnd" taborder="11" text="계산서구분" cssclass="sta_WFSA_Label" left="631" top="5" width="77" height="21"/>
              <Edit id="edt_bcncNm" taborder="5" left="414" top="32" width="202" height="21"/>
              <Combo id="cmb_billKnd" taborder="3" innerdataset="@ds_acc030" codecolumn="CODE" datacolumn="CODE_NM" left="708" top="5" width="150" height="21"/>
              <Edit id="edt_selrCorpNo" taborder="4" left="92" top="32" width="217" height="21"/>
              <Static id="sta_email" taborder="12" text="수신자이메일" cssclass="sta_WFSA_Label" left="324" top="5" width="90" height="21"/>
              <Edit id="edt_email" taborder="2" left="414" top="5" width="202" height="21"/>
              <Static id="Static01" taborder="13" text="15" visible="false" left="309" top="0" width="15" height="57" style="background:#00ffff66;"/>
              <Static id="Static02" taborder="14" text="15" visible="false" left="616" top="0" width="15" height="57" style="background:#00ffff66;"/>
              <Static id="sta_processSe" taborder="15" text="처리구분" cssclass="sta_WFSA_Label" left="631" top="32" width="77" height="21"/>
              <Combo id="cmb_processSe" taborder="16" innerdataset="@ds_cus009" codecolumn="CODE" datacolumn="CODE_NM" left="708" top="32" width="90" height="21"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static00" taborder="4" text="15" visible="false" left="1031" top="0" width="15" height="735" style="background:#1b3cd23c;align:center middle;"/>
        <Static id="Static01" taborder="5" text="스&#13;&#10;크&#13;&#10;롤&#13;&#10;13" visible="false" top="0" right="0" width="13" height="735" style="background:#d07b173c;align:center middle;"/>
        <Static id="Static36" taborder="6" text="10" visible="false" left="0" top="59" width="1031" height="10" style="background:#dc143c3c;align:center middle;"/>
        <Static id="sta_title01" taborder="7" text="매입세금계산서 현황" cssclass="sta_WF_Title02" left="0" top="69" width="140" height="19" style="align:left middle;"/>
        <Static id="Static51" taborder="8" text="5" visible="false" left="0" top="88" width="1031" height="5" style="background:#dc143c3c;align:center middle;"/>
        <Grid id="grd_vatSttus" taborder="3" useinputpanel="false" left="0" top="93" bottom="0" right="28" binddataset="ds_vatSttus" autoenter="select" autoupdatetype="itemselect" oncelldblclick="grd_vatSttus_oncelldblclick" oncellclick="grd_vatSttus_oncellclick" onexpandup="grd_vatSttus_onexpandup">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="160"/>
                <Column size="80"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="120"/>
                <Column size="70"/>
                <Column size="100"/>
                <Column size="70"/>
                <Column size="200"/>
                <Column size="100"/>
                <Column size="60"/>
                <Column size="120"/>
                <Column size="110"/>
                <Column size="110"/>
                <Column size="110"/>
                <Column size="150"/>
                <Column size="200"/>
                <Column size="200"/>
                <Column size="150"/>
                <Column size="200"/>
                <Column size="100"/>
                <Column size="180"/>
              </Columns>
              <Rows>
                <Row size="36" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell/>
                <Cell col="1" text="사업지구"/>
                <Cell col="2" text="작성일"/>
                <Cell col="3" text="계산서번호"/>
                <Cell col="4" text="계산서구분"/>
                <Cell col="5" text="세금계산서종류"/>
                <Cell col="6" text="영수/청구&#13;&#10;구분"/>
                <Cell col="7" text="사업자번호"/>
                <Cell col="8" text="종사업장&#13;&#10;번호"/>
                <Cell col="9" text="업체명"/>
                <Cell col="10" text="대표자"/>
                <Cell col="11" text="부가세&#13;&#10;여부"/>
                <Cell col="12" text="불공제사유"/>
                <Cell col="13" text="총 금액"/>
                <Cell col="14" text="공급가액"/>
                <Cell col="15" text="부가세액"/>
                <Cell col="16" text="수신자이메일"/>
                <Cell col="17" text="비고"/>
                <Cell col="18" text="상세비고"/>
                <Cell col="19" text="수정사유"/>
                <Cell col="20" text="세부품목명"/>
                <Cell col="21" text="국세청전송일시"/>
                <Cell col="22" text="국세청승인번호"/>
              </Band>
              <Band id="body">
                <Cell displaytype="expr:DECSN_NO ? 'none' : 'checkbox'" text="bind:CHK"/>
                <Cell col="1" style="align:left;" text="bind:BSNS_NM" expandshow="show"/>
                <Cell col="2" displaytype="date" text="bind:REGS_DATE" calendardisplaynulltype="none"/>
                <Cell col="3" text="bind:TAXBILL_NO"/>
                <Cell col="4" displaytype="combo" style="align:left middle;padding:0 0 0 5;" text="bind:BILL_KND" combodataset="ds_acc030" combocodecol="CODE" combodatacol="CODE_NM"/>
                <Cell col="5" displaytype="combo" style="align:left middle;padding:0 0 0 5;" text="bind:TAX_TYPE" combodataset="ds_acc036" combocodecol="CODE" combodatacol="CODE_NM"/>
                <Cell col="6" displaytype="combo" text="bind:POPS_CODE" combodataset="ds_acc038" combocodecol="CODE" combodatacol="CODE_NM"/>
                <Cell col="7" text="bind:SELR_CORP_NO" mask="expr:String(SELR_CORP_NO).length == 10 ? &quot;###-##-#####&quot; : (String(BIZRNO).length == 13 ? &quot;######-#######&quot; : &quot;&quot;)"/>
                <Cell col="8" text="bind:SELR_CODE"/>
                <Cell col="9" style="align:left middle;padding:0 0 0 5;" text="bind:SELR_CORP_NM" tooltiptext="bind:SELR_CORP_NM"/>
                <Cell col="10" style="align:left middle;padding:0 0 0 5;" text="bind:SELR_CEO" tooltiptext="bind:SELR_CEO"/>
                <Cell col="11" displaytype="checkbox" edittype="expr:(comp.parent.comUtils.isNull(TAXBILL_NO) &amp;&amp; TAX_AMT != 0) ? 'checkbox' : 'none'" text="bind:TAX_DEDUC_YN"/>
                <Cell col="12" displaytype="combo" edittype="expr:(TAX_AMT != 0 &amp;&amp; TAX_DEDUC_YN == '0') ? 'combo' : 'none'" text="bind:PCHS_TAX_NOTAX_RSN" combodataset="ds_acc039" combocodecol="CODE" combodatacol="CODE_NM" combodisplay="expr:(TAX_AMT != 0 &amp;&amp; TAX_DEDUC_YN == '0') ? 'display' : 'edit'" tooltiptext="expr:comp.parent.ds_acc039.getColumn(comp.parent.ds_acc039.findRow(&quot;CODE&quot;, PCHS_TAX_NOTAX_RSN), &quot;CODE_NM&quot;)"/>
                <Cell col="13" displaytype="number" style="align:right middle;padding:0 5 0 0;" text="bind:TOTL_AMT"/>
                <Cell col="14" displaytype="number" style="align:right middle;padding:0 5 0 0;" text="bind:CHRG_AMT"/>
                <Cell col="15" displaytype="number" style="align:right middle;padding:0 5 0 0;" text="bind:TAX_AMT"/>
                <Cell col="16" style="align:left middle;padding:0 0 0 5;" text="bind:SELR_CHRG_EMAIL" tooltiptext="bind:SELR_CHRG_EMAIL"/>
                <Cell col="17" style="align:left middle;padding:0 0 0 5;" text="bind:NOTE1" tooltiptext="bind:NOTE1"/>
                <Cell col="18" style="align:left middle;padding:0 0 0 5;" text="bind:ITEM_DESP" tooltiptext="bind:ITEM_DESP"/>
                <Cell col="19" displaytype="combo" style="align:left middle;padding:0 0 0 5;" text="bind:MODY_CODE" combodataset="ds_acc037" combocodecol="CODE" combodatacol="CODE_NM" tooltiptext="expr:comp.parent.ds_acc037.getColumn(comp.parent.ds_acc037.findRow(&quot;CODE&quot;, MODY_CODE), &quot;CODE_NM&quot;)"/>
                <Cell col="20" style="align:left middle;padding:0 0 0 5;" text="bind:ITEM_NM" tooltiptext="bind:ITEM_NM"/>
                <Cell col="21" displaytype="date" style="align: ;" text="bind:ISSU_DATE" calendardisplaynulltype="none"/>
                <Cell col="22" style="align:left middle;padding:0 0 0 5;" text="bind:ISSU_ID"/>
              </Band>
              <Band id="summary">
                <Cell/>
                <Cell col="1"/>
                <Cell col="2"/>
                <Cell col="3"/>
                <Cell col="4"/>
                <Cell col="5"/>
                <Cell col="6"/>
                <Cell col="7"/>
                <Cell col="8"/>
                <Cell col="9"/>
                <Cell col="10"/>
                <Cell col="11"/>
                <Cell col="12" text="합계"/>
                <Cell col="13" displaytype="number" style="align:right middle;padding:0 5 0 0;" text="expr:dataset.getSum(&quot;TOTL_AMT&quot;)"/>
                <Cell col="14" displaytype="number" style="align:right middle;padding:0 5 0 0;" text="expr:dataset.getSum(&quot;CHRG_AMT&quot;)"/>
                <Cell col="15" displaytype="number" style="align:right middle;padding:0 5 0 0;" text="expr:dataset.getSum(&quot;TAX_AMT&quot;)"/>
                <Cell col="16"/>
                <Cell col="17"/>
                <Cell col="18"/>
                <Cell col="19"/>
                <Cell col="20"/>
                <Cell col="21"/>
                <Cell col="22"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_updtTaxbilPuchasRegist" taborder="1" text="수정세금계산서 매입장 등록" cssclass="btn_WF_Process" top="69" right="287" width="160" height="19" onclick="btn_updtTaxbilPuchasRegist_onclick"/>
        <Button id="btn_excelDn" taborder="2" onclick="btn_excelDn_onclick" cssclass="btn_WF_Gridexceldn" top="69" right="28" width="25" height="19"/>
        <Button id="btn_expDsnRegist" taborder="9" text="지출결의등록" cssclass="btn_WF_Process" top="69" right="56" width="90" height="19" onclick="btn_expDsnRegist_onclick"/>
        <Button id="btn_etcExpDsnRegist" taborder="10" text="기타증빙/지출결의등록" cssclass="btn_WF_Process" top="69" right="149" width="135" height="19" onclick="btn_etcExpDsnRegist_onclick"/>
        <Static id="Static02" taborder="11" text="(도시사업부 이외는 부가세 여부, 불공제 사유를 면세사업으로 저장 후 지출결의)" top="68" width="436" height="21" right="455" style="color:blue;font:9 Gulim;"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cond" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="PBLICTE_FROM_DE" type="STRING" size="256"/>
          <Column id="PBLICTE_TO_DE" type="STRING" size="256"/>
          <Column id="BCNC_NM" type="STRING" size="256"/>
          <Column id="SELR_CORP_NO" type="STRING" size="256"/>
          <Column id="EMAIL" type="STRING" size="256"/>
          <Column id="TAX_TYPE" type="STRING" size="256"/>
          <Column id="PROCESS_SE" type="STRING" size="256"/>
          <Column id="BILL_KND" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_vatSttus" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_vatSttus_oncolumnchanged">
        <ColumnInfo>
          <Column id="TAXBILL_NO" type="STRING" size="256"/>
          <Column id="REGS_DATE" type="STRING" size="256"/>
          <Column id="SELR_CORP_NO" type="STRING" size="256"/>
          <Column id="SELR_CODE" type="STRING" size="256"/>
          <Column id="SELR_CORP_NM" type="STRING" size="256"/>
          <Column id="SELR_CEO" type="STRING" size="256"/>
          <Column id="TOTL_AMT" type="BIGDECIMAL" size="27"/>
          <Column id="CHRG_AMT" type="BIGDECIMAL" size="27"/>
          <Column id="TAX_AMT" type="BIGDECIMAL" size="27"/>
          <Column id="NOTE1" type="STRING" size="256"/>
          <Column id="ITEM_DESP" type="STRING" size="256"/>
          <Column id="ITEM_NM" type="STRING" size="256"/>
          <Column id="SELR_CHRG_EMAIL" type="STRING" size="256"/>
          <Column id="ISSU_SEQNO" type="STRING" size="256"/>
          <Column id="BILL_TYPE" type="STRING" size="256"/>
          <Column id="ISSU_DATE" type="STRING" size="256"/>
          <Column id="ISSU_ID" type="STRING" size="256"/>
          <Column id="TAX_TYPE" type="STRING" size="256"/>
          <Column id="BILL_KND" type="STRING" size="256"/>
          <Column id="POPS_CODE" type="STRING" size="256"/>
          <Column id="MODY_CODE" type="STRING" size="256"/>
          <Column id="STAT_CODE" type="STRING" size="256"/>
          <Column id="TAX_DEDUC_YN" type="STRING" size="256"/>
          <Column id="PCHS_TAX_NOTAX_RSN" type="STRING" size="256"/>
          <Column id="DECSN_YEAR" type="STRING" size="256"/>
          <Column id="DECSN_NO" type="STRING" size="256"/>
          <Column id="DECSN_AMOUNT" type="BIGDECIMAL" size="15"/>
          <Column id="BCNC_CODE" type="STRING" size="256"/>
          <Column id="BIZRNO" type="STRING" size="256"/>
          <Column id="BCNC_NM" type="STRING" size="256"/>
          <Column id="RPRSNTV" type="STRING" size="256"/>
          <Column id="BIZCND" type="STRING" size="256"/>
          <Column id="INDUTY" type="STRING" size="256"/>
          <Column id="RN" type="STRING" size="300"/>
          <Column id="DETAIL_RDNMADR" type="STRING" size="300"/>
          <Column id="ADRES" type="STRING" size="300"/>
          <Column id="DETAIL_ADRES" type="STRING" size="300"/>
          <Column id="SMLPZ_SE" type="STRING" size="256"/>
          <Column id="EVRFRND_AT" type="STRING" size="256"/>
          <Column id="TCNDVLP" type="STRING" size="256"/>
          <Column id="CNTRWK_PRPOS_MTRIL" type="STRING" size="256"/>
          <Column id="AREA_ENTRPS_AT" type="STRING" size="256"/>
          <Column id="FEMALE_ENTRPRS_AT" type="STRING" size="256"/>
          <Column id="DSPSN_ENTRPRS_AT" type="STRING" size="256"/>
          <Column id="SRSILL_DSPSN_ENTRPRS_AT" type="STRING" size="256"/>
          <Column id="SOCENT_AT" type="STRING" size="256"/>
          <Column id="GREEN_PRDUCT_AT" type="STRING" size="256"/>
          <Column id="DSPSN_PRDCTN_FCLTY_AT" type="STRING" size="256"/>
          <Column id="SOCTY_CPER_MXTR_AT" type="STRING" size="256"/>
          <Column id="DSPSN_STD_BPLC" type="STRING" size="256"/>
          <Column id="WATER_INDUST" type="STRING" size="256"/>
          <Column id="MDLC_INDUST" type="STRING" size="256"/>
          <Column id="FARMNG_INDUST" type="STRING" size="256"/>
          <Column id="ENERGY_INDUST" type="STRING" size="256"/>
          <Column id="BANK_CODE" type="STRING" size="256"/>
          <Column id="DPSTR_NM" type="STRING" size="256"/>
          <Column id="ACNUTNO" type="STRING" size="256"/>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="BSNS_CODE" type="STRING" size="256"/>
          <Column id="BSNS_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_acc038" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_validation" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="compId" type="STRING" size="256"/>
          <Column id="colId" type="STRING" size="256"/>
          <Column id="msgId" type="STRING" size="256"/>
          <Column id="PK" type="STRING" size="256"/>
          <Column id="notNull" type="STRING" size="256"/>
          <Column id="nlength" type="STRING" size="256"/>
          <Column id="lengthChkGb" type="STRING" size="256"/>
          <Column id="type" type="STRING" size="256"/>
          <Column id="from" type="STRING" size="256"/>
          <Column id="to" type="STRING" size="256"/>
          <Column id="expr" type="STRING" size="256"/>
          <Column id="func" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="compId">ds_cond</Col>
            <Col id="colId">PBLICTE_FROM_DE</Col>
            <Col id="msgId">조회시작일</Col>
            <Col id="notNull">Y</Col>
          </Row>
          <Row>
            <Col id="compId">ds_cond</Col>
            <Col id="colId">PBLICTE_TO_DE</Col>
            <Col id="msgId">조회종료일</Col>
            <Col id="notNull">Y</Col>
          </Row>
          <Row>
            <Col id="compId">ds_cond</Col>
            <Col id="colId">PBLICTE_TO_DE</Col>
            <Col id="msgId">조회종료일^조회시작일</Col>
            <Col id="from">PBLICTE_FROM_DE</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_acc036" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_acc037" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_acc039" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_acc030" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_expDsnMastr" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_expDsnMastr_oncolumnchanged">
        <ColumnInfo>
          <Column id="DECSN_YEAR" type="STRING" size="4"/>
          <Column id="DECSN_NO" type="STRING" size="10"/>
          <Column id="CAUSE_ACTION_NO" type="STRING" size="10"/>
          <Column id="BUDGET_YEAR" type="STRING" size="4"/>
          <Column id="BSNS_SE" type="STRING" size="1"/>
          <Column id="BALC_SE" type="STRING" size="1"/>
          <Column id="BUDGET_ACNT_CODE" type="STRING" size="8"/>
          <Column id="BUDGET_ACNT_NM" type="STRING" size="256"/>
          <Column id="ANACT_KND" type="STRING" size="2"/>
          <Column id="DEPT_CODE" type="STRING" size="6"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="CYFD_SE" type="STRING" size="1"/>
          <Column id="ITNC_DE" type="STRING" size="8"/>
          <Column id="PYMNT_ITNC_DE" type="STRING" size="8"/>
          <Column id="DET_DCSN_DE" type="STRING" size="8"/>
          <Column id="PRMPC_JRNLZPR_RGIST_DE" type="STRING" size="8"/>
          <Column id="CPTAL_EXPNDTR_ACNTBK_DE" type="STRING" size="8"/>
          <Column id="EXPNDTR_BUDGET_CNRL_DE" type="STRING" size="8"/>
          <Column id="CAUSE_ACTION_DE" type="STRING" size="8"/>
          <Column id="DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="BUDGET_ACNT_BLCE" type="BIGDECIMAL" size="22"/>
          <Column id="EXPNDTR_UNIT_CODE" type="STRING" size="8"/>
          <Column id="EXPNDTR_UNIT_NM" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_CODE_BLCE" type="BIGDECIMAL" size="22"/>
          <Column id="CPTAL_CHRG_CONFM" type="STRING" size="1"/>
          <Column id="TIMHDER_CONFM" type="STRING" size="1"/>
          <Column id="CNTRCT_NO" type="STRING" size="11"/>
          <Column id="FNNC_INSTT_CODE" type="STRING" size="3"/>
          <Column id="ACNUTNO" type="STRING" size="20"/>
          <Column id="SUMRY" type="STRING" size="200"/>
          <Column id="BSNS_CODE" type="STRING" size="5"/>
          <Column id="BSNS_NM" type="STRING" size="256"/>
          <Column id="PRMPC_YEAR" type="STRING" size="256"/>
          <Column id="PRMPC_CODE" type="STRING" size="6"/>
          <Column id="PRMPC_NM" type="STRING" size="256"/>
          <Column id="REGISTER_ID" type="STRING" size="12"/>
          <Column id="REGIST_DT" type="STRING" size="8"/>
          <Column id="UPDUSR_ID" type="STRING" size="12"/>
          <Column id="UPDT_DT" type="DATE" size="8"/>
          <Column id="EXPNDTR_CNFIRM_AT" type="STRING" size="2"/>
          <Column id="ATMC_JRNLZ_TY_CODE" type="STRING" size="256"/>
          <Column id="GNRL_DEBTOR_ACNT_NM" type="STRING" size="256"/>
          <Column id="GNRL_CRDIT_ACNT_NM" type="STRING" size="256"/>
          <Column id="SETOFF_DEBTOR_ACNT_NM" type="STRING" size="256"/>
          <Column id="SETOFF_CRDIT_ACNT_NM" type="STRING" size="256"/>
          <Column id="FILE_SN" type="STRING" size="256"/>
          <Column id="CHECK_NO" type="STRING" size="256"/>
          <Column id="SANCTN_NO" type="STRING" size="256"/>
          <Column id="SANCTN_SE" type="STRING" size="256"/>
          <Column id="LAST_SANCTN_STTUS" type="STRING" size="256"/>
          <Column id="INC_EXP_AT" type="STRING" size="256"/>
          <Column id="CPTAL_DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="DRFT_APPRID" type="STRING" size="256"/>
          <Column id="DRFT_DOCREGNO" type="STRING" size="256"/>
          <Column id="DRFT_DATE" type="STRING" size="256"/>
          <Column id="DRFT_USERID" type="STRING" size="256"/>
          <Column id="TRG_FORM_ID" type="STRING" size="256"/>
          <Column id="TRG_FORM_ID2" type="STRING" size="256"/>
          <Column id="SANCTN_STS" type="STRING" size="256"/>
          <Column id="BUDGET_CNRL_AT" type="STRING" size="256"/>
          <Column id="CAUSE_ACTION_ANACT_KND" type="STRING" size="256"/>
          <Column id="CAUSE_ACTION_REGIST_SE" type="STRING" size="256"/>
          <Column id="CHI_CNT" type="STRING" size="256"/>
          <Column id="CHI_AT" type="STRING" size="256"/>
          <Column id="WIK_CPTAL_PLAN_AT" type="STRING" size="256"/>
          <Column id="CNSUL_SJ" type="STRING" size="256"/>
          <Column id="PRUF_SE_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_expDsnMtrDet" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_expDsnMtrDet_oncolumnchanged">
        <ColumnInfo>
          <Column id="DECSN_YEAR" type="STRING" size="4"/>
          <Column id="DECSN_NO" type="STRING" size="11"/>
          <Column id="CNTRCT_DE" type="STRING" size="8"/>
          <Column id="ACPTNC_DE" type="STRING" size="8"/>
          <Column id="ORDER_DE" type="STRING" size="8"/>
          <Column id="DVYFG_DE" type="STRING" size="8"/>
          <Column id="PYMNT_CMMND_PBLICTE_DE" type="STRING" size="8"/>
          <Column id="TAXXPT_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="VAT_DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="SUPLY_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="VAT_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="DSGN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="CNTRCT_SE" type="STRING" size="3"/>
          <Column id="CNTRCT_MTHD" type="STRING" size="1"/>
          <Column id="ATCH_FILE" type="STRING" size="100"/>
          <Column id="ATCH_FLPTH" type="STRING" size="200"/>
          <Column id="ATCH_FILE_1" type="STRING" size="100"/>
          <Column id="ATCH_FLPTH_1" type="STRING" size="200"/>
          <Column id="REGISTER_ID" type="STRING" size="12"/>
          <Column id="REGIST_DT" type="STRING" size="8"/>
          <Column id="UPDUSR_ID" type="STRING" size="12"/>
          <Column id="UPDT_DT" type="DATE" size="7"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_expDsnDetail" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_expDsnDetail_oncolumnchanged" onrowsetchanged="ds_expDsnDetail_onrowsetchanged" onrowposchanged="ds_expDsnDetail_onrowposchanged" cancolumnchange="ds_expDsnDetail_cancolumnchange">
        <ColumnInfo>
          <Column id="DECSN_YEAR" type="STRING" size="4"/>
          <Column id="DECSN_NO" type="STRING" size="11"/>
          <Column id="SEQ" type="BIGDECIMAL" size="22"/>
          <Column id="DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="TAXXPT_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="VAT_AT" type="STRING" size="1"/>
          <Column id="BILL_KND" type="STRING" size="1"/>
          <Column id="VAT_DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="SUPLY_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="VAT" type="BIGDECIMAL" size="22"/>
          <Column id="BCNC_CODE" type="STRING" size="10"/>
          <Column id="BCNC_NM" type="STRING" size="256"/>
          <Column id="NM" type="STRING" size="30"/>
          <Column id="ADRES" type="STRING" size="200"/>
          <Column id="RQEST_DE" type="STRING" size="8"/>
          <Column id="RQEST_MAN" type="STRING" size="30"/>
          <Column id="RCPT_DE" type="STRING" size="8"/>
          <Column id="RCPT_MAN" type="STRING" size="30"/>
          <Column id="FNNC_INSTT_CODE" type="STRING" size="3"/>
          <Column id="ACNUTNO" type="STRING" size="20"/>
          <Column id="ENTRPRS_SE" type="STRING" size="1"/>
          <Column id="EVRFRND" type="STRING" size="1"/>
          <Column id="TCNDVLP" type="STRING" size="1"/>
          <Column id="CNTRWK_PRPOS_MTRIL" type="STRING" size="1"/>
          <Column id="AREA_ENTRPS" type="STRING" size="1"/>
          <Column id="FEMALE_ENTRPRS" type="STRING" size="1"/>
          <Column id="MIDDL_PD_CMPET_PRDUCT" type="STRING" size="1"/>
          <Column id="FRGCPT_ENTRPRS" type="STRING" size="1"/>
          <Column id="DSPSN" type="STRING" size="1"/>
          <Column id="SRSILL_DSPSN" type="STRING" size="1"/>
          <Column id="SOCTY_ENTRPRS" type="STRING" size="1"/>
          <Column id="DSPSN_PRDCTN_FCLTY" type="STRING" size="1"/>
          <Column id="SOCTY_CPER_MXTR" type="STRING" size="1"/>
          <Column id="GREEN_PRDUCT" type="STRING" size="1"/>
          <Column id="DSPSN_STD_BPLC" type="STRING" size="1"/>
          <Column id="WATER_INDUST" type="STRING" size="1"/>
          <Column id="MDLC_INDUST" type="STRING" size="1"/>
          <Column id="FARMNG_INDUST" type="STRING" size="1"/>
          <Column id="ENERGY_INDUST" type="STRING" size="1"/>
          <Column id="WHTAX_AT" type="STRING" size="1"/>
          <Column id="WHTAX_KND" type="STRING" size="1"/>
          <Column id="WHTAX_ADRES" type="STRING" size="200"/>
          <Column id="IHDNUM" type="STRING" size="256"/>
          <Column id="INCMTAX" type="BIGDECIMAL" size="22"/>
          <Column id="IHNTS" type="BIGDECIMAL" size="22"/>
          <Column id="WHTAX_INCOME_SE_CODE" type="STRING" size="256"/>
          <Column id="WHTAX_INDUTY_CODE" type="STRING" size="256"/>
          <Column id="WHTAX_PYMNT_TOTAMT" type="BIGDECIMAL" size="22"/>
          <Column id="MTCHG_SE" type="STRING" size="5"/>
          <Column id="BRRW_AMOUNT_INTR_RPAY_AT" type="STRING" size="1"/>
          <Column id="RM" type="STRING" size="200"/>
          <Column id="CMPNSP_NO" type="STRING" size="30"/>
          <Column id="PRPDVS_TRGET_CODE" type="STRING" size="4"/>
          <Column id="REGISTER_ID" type="STRING" size="12"/>
          <Column id="REGIST_DT" type="STRING" size="8"/>
          <Column id="UPDUSR_ID" type="STRING" size="12"/>
          <Column id="UPDT_DT" type="DATE" size="7"/>
          <Column id="ENDW_INTR_AT" type="STRING" size="256"/>
          <Column id="PBNCD_NO" type="STRING" size="256"/>
          <Column id="ERROR_AT" type="STRING" size="256"/>
          <Column id="CHGHY" type="STRING" size="256"/>
          <Column id="ISSU_SEQNO" type="STRING" size="256"/>
          <Column id="BILL_TYPE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_decsnNo" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="TAXBILL_NO" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cus009" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_detIssuMstr" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="ISSU_SEQNO" type="STRING" size="256"/>
          <Column id="BILL_TYPE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item0" compid="div_SEARCH.cal_bgnde" propid="value" datasetid="ds_cond" columnid="PBLICTE_FROM_DE"/>
      <BindItem id="item1" compid="div_SEARCH.cal_endde" propid="value" datasetid="ds_cond" columnid="PBLICTE_TO_DE"/>
      <BindItem id="item4" compid="div_SEARCH.edt_bcncNm" propid="value" datasetid="ds_cond" columnid="BCNC_NM"/>
      <BindItem id="item2" compid="div_SEARCH.cmb_billKnd" propid="value" datasetid="ds_cond" columnid="BILL_KND"/>
      <BindItem id="item3" compid="div_SEARCH.edt_selrCorpNo" propid="value" datasetid="ds_cond" columnid="SELR_CORP_NO"/>
      <BindItem id="item5" compid="div_SEARCH.edt_email" propid="value" datasetid="ds_cond" columnid="EMAIL"/>
      <BindItem id="item6" compid="div_SEARCH.cmb_processSe" propid="value" datasetid="ds_cond" columnid="PROCESS_SE"/>
    </Bind>
    <Script type="xscript5.0"><![CDATA[/***********************************************************************
 * 업무구분	: 회계 > 세무관리 > 세금계산서 관리 > 매입전표생성
 * 화면ID		: ACC030111
 * 화면명		: 매입전표생성
 * 화면설명	: 매입전표를 생성한다.
 * 작성일		: 2017.11.23
 * 작성자		: 김형태
 * 수정이력	: 
 ***********************************************************************
 *     수정일     수정자   내용
 ***********************************************************************
 *    
 ***********************************************************************
 */


/***********************************************************************
 * Script Include 
 ************************************************************************/
// 시스템 공통 라이브러리 Include
include "lib::comInclude.xjs";
include "mis_lib::misUtil.xjs";

// 업무에 필요한 공통 라이브러리 파일을 추가할 수 있다.
// TODO


/***********************************************************************
 * 화면 변수 선언부
 ***********************************************************************/
 this.saveRow = -1;
 
 
 /***********************************************************************
 * onInit / onLoad 영역
 ***********************************************************************/
this.ACC030111_oninit = function(obj:Form, e:nexacro.InitEventInfo)
{
	// ..
}

this.ACC030111_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{
	// form 초기화
	this.fn_init_form();

	// dataset 초기화
	this.fn_init_dataset();
}

/***********************************************************************
 * Form/Dataset 오브젝트 초기화
 ***********************************************************************/
 
/*
 * 함수명  	: initForm
 * 설명 		: Form을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initForm();
 */
this.fn_init_form = function()
{
	this.gfn_initForm(this);
	this.fn_misFormInit(this);
	
	// 초기조회조건 세팅
	var today = this.dateUtils.today();
	this.ds_cond.clearData();
	this.ds_cond.addRow();
	this.ds_cond.setColumn(0, "PBLICTE_FROM_DE", today.substr(0,4)+"0101");
	this.ds_cond.setColumn(0, "PBLICTE_TO_DE", today);
	
	// 공통코드
	var comboParams = [
		 ["ds_acc030", "ACC030", "Y", "A", "B"]	// 계산서종류
		,["ds_acc036", "ACC036", "Y", "A", "B"]	// 세금계산서종류
		,["ds_acc037", "ACC037", "Y", "A", "B"]	// 수정세금계산서 사유
		,["ds_acc038", "ACC038", "Y", "A", "B"]	// 청구/영구
		,["ds_acc039", "ACC039", "Y", "D", "B"]	// 불공제사유구분
		,["ds_cus009", "CUS009", "Y", "A", "B"]	// 처리상태
	];
	var callback = function (svcId, errorCode, errorMsg) {
		this.ds_cond.setColumn(0, "PROCESS_SE", "2");	// 처리구분-미처리
		
		this.fn_search();
	};
	this.gfn_comboLoad (comboParams, callback);
}

/*
 * 함수명  	: initDataset
 * 설명 		: Dataset을 초기화한다.
 *                주로, 조건 Dataset들(ds_cond, ds_cond_00, ds_cond_01, ...) 을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initDataset();
 */
this.fn_init_dataset = function()
{
	// 조건 Dataset 외에 초기화가 필요한 Dataset에 대한 초기화 코드를 추가한다.
	// TODO
}

/***********************************************************************
 * Transaction 관련 이벤트 핸들러 
 **********************************************************************/
/*
 * 함수명  	: fn_search
 * 설명 		: 조회 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_search();
 */
this.fn_search = function()
{
	// validation 체크
	if(!this.gfn_checkValidation_NoUpdChk(this.ds_cond, this.ds_validation)) {
		return false;
	}
	
	this.fn_transaction("vatSttusList");
}


/*
 * 함수명  	: fn_save
 * 설명 		: 저장 이벤트 처리(매입세금계산서 현황)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_save();
 */
this.fn_save = function()
{
	// 데이터셋 수정 여부체크
	if (!this.comUtils.isDatasetUpdated(this.ds_vatSttus)) {
		this.gfn_message("comm.데이터.변경.없음");
		return false;
	}
	
	var fRow = this.ds_vatSttus.findRowExpr("TAX_DEDUC_YN != '1' && PCHS_TAX_NOTAX_RSN == null");
	if(fRow > -1) {
		this.gfn_message("info.처리불가", "["+(fRow+1)+"행]불공제사유가 입력되지 않았습니다.");
		return false;
	}
	
	if(this.gfn_message("confirm.저장.여부")) {
		this.saveRow = this.ds_vatSttus.rowposition;
		this.fn_transaction("save");
	}
}


/*
 * 함수명  	: fn_cancel
 * 설명 		: 취소 버튼 이벤트 처리(Dataset 변경 내역 Reset)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_cancel();
 */
this.fn_cancel = function()
{
	if(Ex.util.isUpdated(this.ds_vatSttus)) {
		if(!this.gfn_message("confirm.변경.취소.여부")) {
			return false;	// 아니오
		}
		this.ds_vatSttus.reset();		//DATASET ROLLBACK
		this.ds_vatSttus.applyChange();	//DATASET COMMIT
	}
}


/**********************************************************************
 * CALL TRANSACTION 영역
 **********************************************************************/
 
/*
 * 설명 		: Transaction 요청 처리 함수
 * 함수명  	: fn_transaction
 * params  		: strSvcId : 서비스요청 ID
 * return Type 	: None
 * 사용법		: this.fn_transaction("SELECT");
 */
this.fn_transaction = function(strSvcId)
{
	switch (strSvcId) {
		case "vatSttusList": // 매입세금계산서 조회
			var sController   	= "hsco/mis/acc/ACC030111/vatSttusList.do";
			var sInDatasets   	= "input1=ds_cond";
			var sOutDatasets  	= "ds_vatSttus=output1";
			break;
		case "save": 		// 저장
			var sController   	= "hsco/mis/acc/ACC030111/save.do";
			var sInDatasets   	= "input1=ds_vatSttus:U";
			var sOutDatasets  	= "";
			break;
	}
	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets); 
}

/**********************************************************************
 * Transaction Callback 영역
 ***********************************************************************/

 /*
 * 함수명  	: fn_callBack
 * 설명 		: Transaction Callback 처리
 * params  		: strSvcId    : 서비스요청 ID
 *                nErrorCode  : 오류 메시지 코드 ([예] 0 : Success, 그밖의 경우, error)
 *                strErrorMsg : 오류 메시지([예]  success.insert|정상적으로 등록되었습니다.)
 * return Type 	: None
 * 사용법		: 
 */
this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg)
{
	if (nErrorCode != 0) {
		this.gfn_callback_message(strSvcId, nErrorCode, strErrorMsg);
	} else {
		switch(strSvcId) {
			case "vatSttusList":	// 매입세금계산서 조회
				if(this.saveRow > -1){
					this.ds_vatSttus.set_rowposition(this.saveRow);
					this.saveRow = -1;
				}
				break;
			case "save":			// 저장
				this.gfn_message("success.처리.성공");
				this.fn_search();
				break;
		}
	}
}


/*
 * 함수명  	: fn_popupCallBack
 * 설명 		: Popup Callback 처리
 * params  		: sPopupId    : 팝업 ID
 *                sReturn  : 팝업 처리 결과(dataset.saveXML())
 * return Type 	: None
 * 사용법		: 
 */
this.fn_popupCallBack = function(sPopupId, sReturn)
{
	// 수정세금계산서 매입장 등록
	if(sPopupId == "taxbilPop") {
		this.fn_search();
	}
	// 지출결의등록
	if(sPopupId == "expDsnPopup") {
		this.fn_search();
	}
	// 결의서보기
	if(sPopupId == "expPopup") {
		// ..
	}
	
	if(sPopupId == "bsnsPopup") {
		if(sReturn != null && sReturn.length > 0) {
			var dsTemp = new Dataset();
			var currow = this.ds_vatSttus.rowposition;
			dsTemp.loadXML(sReturn);
			this.ds_vatSttus.setColumn(currow, "BSNS_CODE",	dsTemp.getColumn(0, "BSNS_CODE"));			// 사업지구코드
			this.ds_vatSttus.setColumn(currow, "BSNS_NM",	dsTemp.getColumn(0, "BSNS_NM"));			// 사업지구명
		}
	}
}

/***********************************************************************
* 버튼 클릭시 이벤트
************************************************************************/
/*
 * 함수명  	: btn_excelDn_onclick
 * 설명 		: 그리드 엑셀 다운로드
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_excelDn_onclick();
 */
this.btn_excelDn_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.gfn_exportExcel(this.grd_vatSttus, "exportExl");
}


/*
 * 함수명  	: btn_updtTaxbilPuchasRegist_onclick
 * 설명 		: 수정세금계산서 매입장 등록
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_updtTaxbilPuchasRegist_onclick();
 */
this.btn_updtTaxbilPuchasRegist_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(Ex.util.isUpdated(this.ds_vatSttus)) {
		if(!this.gfn_message("confirm.변경.취소.여부")) {
			return false;	// 아니오
		}
		this.ds_vatSttus.reset();		//DATASET ROLLBACK
		this.ds_vatSttus.applyChange();	//DATASET COMMIT
	}
	
	var nRow = this.ds_vatSttus.rowposition;
	var issuId = this.ds_vatSttus.getColumn(nRow, "ISSU_ID");
	this.saveRow = this.ds_vatSttus.rowposition;
	
	var parm = {
		 arg_0      : this
		,issuId		: issuId
	};
	this.gfn_popup("taxbilPop", 1011, 600, "", parm, "mis_acc::ACC030111_P01.xfdl", "fn_popupCallBack", true);
}

/*
 * 함수명  	: btn_expDsnRegist_onclick
 * 설명 		: 지출결의등록
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_expDsnRegist_onclick();
 */
this.btn_expDsnRegist_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{	
	if(Ex.util.isUpdated(this.ds_vatSttus)) {
		if(!this.gfn_message("confirm.변경.취소.여부")) {
			return false;	// 아니오
		}
		this.ds_vatSttus.reset();		//DATASET ROLLBACK
		this.ds_vatSttus.applyChange();	//DATASET COMMIT
	}
	
	if(this.ds_vatSttus.getCaseCount("CHK == '1'") <= 0) {
		this.gfn_message("info.처리불가", "매입세금계산서가 선택되지 않았습니다.");
		return false;
	}
	
	if(['030100','030200','030300','030400','030500'].indexOf(this.gfn_getDeptId()) == -1) {
		var fRow = this.ds_vatSttus.findRowExpr("CHK == '1' && TAX_DEDUC_YN == '1'");
		if(fRow > -1) {
			if(!application.confirm("부가세 여부가 선택된 건이 있습니다.\n도시사업부 이외는 부가세 여부, 불공제 사유를 면세사업으로 저장한 후 진행하시기 바랍니다.\n계속 하시겠습니까?")) {
				return false;
			}	
			
		}
	}
	
	var nRow = -1;
	var addr = "";
	var today = this.dateUtils.today();
	
	this.ds_expDsnDetail.clearData();	
	for(i = 0; i < this.ds_vatSttus.getRowCount(); i++) {
		if(this.ds_vatSttus.getColumn(i, "CHK") == "1") {			
			addr = "";
			if(!this.comUtils.isNull(this.ds_vatSttus.getColumn(i, "RN"))) {
				addr += this.ds_vatSttus.getColumn(i, "RN");
				if(!this.comUtils.isNull(this.ds_vatSttus.getColumn(i, "DETAIL_RDNMADR"))) {
					addr += "";
				}
			}
			if(!this.comUtils.isNull(this.ds_vatSttus.getColumn(i, "DETAIL_RDNMADR"))) {
				addr += this.ds_vatSttus.getColumn(i, "DETAIL_RDNMADR");
			}
			if(this.comUtils.isNull(addr)) {
				if(!this.comUtils.isNull(this.ds_vatSttus.getColumn(i, "ADRES"))) {
					addr += this.ds_vatSttus.getColumn(i, "ADRES");
					if(!this.comUtils.isNull(this.ds_vatSttus.getColumn(i, "DETAIL_ADRES"))) {
						addr += "";
					}
				}
				if(!this.comUtils.isNull(this.ds_vatSttus.getColumn(i, "DETAIL_ADRES"))) {
					addr += this.ds_vatSttus.getColumn(i, "DETAIL_ADRES");
				}
			}
			addr = addr.substr(0, 150);
			// 결의세부			
			nRow = this.ds_expDsnDetail.addRow();
			this.ds_expDsnDetail.setColumn(nRow, "DECSN_AMOUNT"      , this.ds_vatSttus.getColumn(i, "TOTL_AMT"));	// 결의금액
			this.ds_expDsnDetail.setColumn(nRow, "TAXXPT_AMOUNT"     , "0");					// 면세금액
			this.ds_expDsnDetail.setColumn(nRow, "VAT_AT"            , this.ds_vatSttus.getColumn(i, "TAX_DEDUC_YN"));				// 부가세여부
			this.ds_expDsnDetail.setColumn(nRow, "VAT_DECSN_AMOUNT"  , "0");				// 부가세결의금액
			this.ds_expDsnDetail.setColumn(nRow, "SUPLY_AMOUNT"      , this.ds_vatSttus.getColumn(i, "CHRG_AMT"));					// 공급가액
			this.ds_expDsnDetail.setColumn(nRow, "VAT"               , this.ds_vatSttus.getColumn(i, "TAX_AMT"));					// 부가세금액
			this.ds_expDsnDetail.setColumn(nRow, "RCPT_DE"           , today);				// 영수일자
			this.ds_expDsnDetail.setColumn(nRow, "BCNC_CODE"         , this.ds_vatSttus.getColumn(i, "BCNC_CODE"));					// 거래처코드
			this.ds_expDsnDetail.setColumn(nRow, "BCNC_NM"           , this.ds_vatSttus.getColumn(i, "BCNC_NM"));					// 거래처명
			this.ds_expDsnDetail.setColumn(nRow, "NM"                , this.ds_vatSttus.getColumn(i, "RPRSNTV"));					// 대표자명
			this.ds_expDsnDetail.setColumn(nRow, "ENTRPRS_SE"        , this.ds_vatSttus.getColumn(i, "SMLPZ_SE"));					// 기업구분(중소기업,대기업)
			this.ds_expDsnDetail.setColumn(nRow, "EVRFRND"           , this.ds_vatSttus.getColumn(i, "EVRFRND_AT"));				// 친환경
			this.ds_expDsnDetail.setColumn(nRow, "TCNDVLP"           , this.ds_vatSttus.getColumn(i, "TCNDVLP"));					// 기술개발
			this.ds_expDsnDetail.setColumn(nRow, "CNTRWK_PRPOS_MTRIL", this.ds_vatSttus.getColumn(i, "CNTRWK_PRPOS_MTRIL"));		// 공사용자재
			this.ds_expDsnDetail.setColumn(nRow, "AREA_ENTRPS"       , this.ds_vatSttus.getColumn(i, "AREA_ENTRPS_AT"));			// 지역업체
			this.ds_expDsnDetail.setColumn(nRow, "FEMALE_ENTRPRS"    , this.ds_vatSttus.getColumn(i, "FEMALE_ENTRPRS_AT"));			// 여성기업
			this.ds_expDsnDetail.setColumn(nRow, "DSPSN"             , this.ds_vatSttus.getColumn(i, "DSPSN_ENTRPRS_AT"));			// 장애인
			this.ds_expDsnDetail.setColumn(nRow, "SRSILL_DSPSN"      , this.ds_vatSttus.getColumn(i, "SRSILL_DSPSN_ENTRPRS_AT"));	// 중증장애인
			this.ds_expDsnDetail.setColumn(nRow, "SOCTY_ENTRPRS"     , this.ds_vatSttus.getColumn(i, "SOCENT_AT"));					// 사회적기업
			this.ds_expDsnDetail.setColumn(nRow, "GREEN_PRDUCT"      , this.ds_vatSttus.getColumn(i, "GREEN_PRDUCT_AT"));			// 녹색제품
			this.ds_expDsnDetail.setColumn(nRow, "DSPSN_PRDCTN_FCLTY", this.ds_vatSttus.getColumn(i, "DSPSN_PRDCTN_FCLTY_AT"));		// 장애인생산시설
			this.ds_expDsnDetail.setColumn(nRow, "SOCTY_CPER_MXTR"   , this.ds_vatSttus.getColumn(i, "SOCTY_CPER_MXTR_AT"));		// 사회적협동조합
			this.ds_expDsnDetail.setColumn(nRow, "DSPSN_STD_BPLC"    , this.ds_vatSttus.getColumn(i, "DSPSN_STD_BPLC"));			// 장애인표준사업장
			this.ds_expDsnDetail.setColumn(nRow, "WATER_INDUST"      , this.ds_vatSttus.getColumn(i, "WATER_INDUST"));				// 물산업
			this.ds_expDsnDetail.setColumn(nRow, "MDLC_INDUST"       , this.ds_vatSttus.getColumn(i, "MDLC_INDUST"));				// 의료산업
			this.ds_expDsnDetail.setColumn(nRow, "FARMNG_INDUST"     , this.ds_vatSttus.getColumn(i, "FARMNG_INDUST"));				// 농업사업
			this.ds_expDsnDetail.setColumn(nRow, "ENERGY_INDUST"     , this.ds_vatSttus.getColumn(i, "ENERGY_INDUST"));				// 에너지산업
			this.ds_expDsnDetail.setColumn(nRow, "FNNC_INSTT_CODE"   , this.ds_vatSttus.getColumn(i, "BANK_CODE"));					// 지급은행
			if(this.comUtils.isNull(this.ds_vatSttus.getColumn(i, "DPSTR_NM"))) {
				this.ds_expDsnDetail.setColumn(nRow, "RCPT_MAN", this.ds_vatSttus.getColumn(i, "BCNC_NM"));	// 영수자
			} else {
				this.ds_expDsnDetail.setColumn(nRow, "RCPT_MAN", this.ds_vatSttus.getColumn(i, "DPSTR_NM"));	// 영수자 <- 예금주명
			}
			
			this.ds_expDsnDetail.setColumn(nRow, "ACNUTNO"           , this.ds_vatSttus.getColumn(i, "ACNUTNO"));					// 계좌번호
			this.ds_expDsnDetail.setColumn(nRow, "ADRES"             , addr);														// 주소
			this.ds_expDsnDetail.setColumn(nRow, "BILL_KND"          , this.ds_vatSttus.getColumn(i, "BILL_KND"));					// 계산서구분
			
			this.ds_expDsnDetail.setColumn(nRow, "ISSU_SEQNO"		 , this.ds_vatSttus.getColumn(i, "ISSU_SEQNO"));
			this.ds_expDsnDetail.setColumn(nRow, "BILL_TYPE" 		 , this.ds_vatSttus.getColumn(i, "BILL_TYPE"));
		}
	}
	
	// 결의마스터 셋팅
	this.ds_expDsnMastr.clearData();
	this.ds_expDsnMastr.addRow();
	this.ds_expDsnMastr.setColumn(0, "DECSN_YEAR"             , today.substring(0,4));		// 회계년월
	this.ds_expDsnMastr.setColumn(0, "ANACT_KND"              , "03");						// 결의서구분
	this.ds_expDsnMastr.setColumn(0, "DEPT_CODE"              , this.gfn_getDeptId());		// 부서코드
	this.ds_expDsnMastr.setColumn(0, "DEPT_NM"			      , this.gfn_getDeptName());	// 부서명
	
	this.ds_expDsnMastr.setColumn(0, "ITNC_DE"                , today);						// 발의일자
	this.ds_expDsnMastr.setColumn(0, "DET_DCSN_DE"            , today);						// 채무확정일자
	this.ds_expDsnMastr.setColumn(0, "PYMNT_ITNC_DE"          , today);					// 지급발의일자
	this.ds_expDsnMastr.setColumn(0, "PRMPC_JRNLZPR_RGIST_DE" , today);						// 원장분개장등기
	this.ds_expDsnMastr.setColumn(0, "EXPNDTR_BUDGET_CNRL_DE" , today);					// 지출예산통제
	this.ds_expDsnMastr.setColumn(0, "CPTAL_EXPNDTR_ACNTBK_DE", today);					// 자금지출부등기
	
	this.ds_expDsnMastr.setColumn(0, "DECSN_AMOUNT"           ,this.ds_expDsnDetail.getSum("DECSN_AMOUNT"));					// 총금액 -> 결의금액
	
	// 결의마스터상세
	this.ds_expDsnMtrDet.clearData();
	this.ds_expDsnMtrDet.addRow();
	this.ds_expDsnMtrDet.setColumn(0, "TAXXPT_AMOUNT"	, "0");		// 면세금액
	this.ds_expDsnMtrDet.setColumn(0, "VAT_DECSN_AMOUNT", "0");	// 부가세결의금액
	this.ds_expDsnMtrDet.setColumn(0, "SUPLY_AMOUNT"	, this.ds_expDsnDetail.getSum("SUPLY_AMOUNT"));	// 공급가액
	this.ds_expDsnMtrDet.setColumn(0, "VAT_AMOUNT"		, this.ds_expDsnDetail.getSum("VAT"));	// 부가세금액


	// 계산서 원장 테이블 PK 세팅
	
	this.saveRow = this.ds_vatSttus.rowposition;
	
	var args = {
		  arg_0				: this
		, trgFormId			: "ACC030111"						// 팝업을 호출하는 화면의 ID
		, trgFormId2		: "MIS"								// 삭제방지코드
		, anactKnd			: "03"								// 지출결의서
		, dsExpDsnMastr		: this.ds_expDsnMastr.saveXML()		// 결의마스터(Dataset)
		, dsExpDsnMtrDet	: this.ds_expDsnMtrDet.saveXML()	// 결의마스터상세(Dataset)
		, dsExpDsnDetail	: this.ds_expDsnDetail.saveXML()	// 결의세부(Dataset)
    };
	
	this.gfn_popup("expDsnPopup", 903, 842, "지출결의서", args, "mis_acc::ACC020203_P01.xfdl", "fn_popupCallBack",true);
}


/*
 * 함수명  	: btn_etcExpDsnRegist_onclick
 * 설명 		: 기타증빙/지출결의등록
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_etcExpDsnRegist_onclick();
 */
this.btn_etcExpDsnRegist_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var args = {
		  arg_0				: this
    };
	
	this.gfn_popup("etcExpDsnPopup", 0, 0, "", args, "mis_acc::ACC030111_P02.xfdl", "fn_popupCallBack",true);
}


/***********************************************************************
* Grid 이벤트 처리
************************************************************************/

/*
 * 함수명  	: grd_vatSttus_oncelldblclick
 * 설명 		: 매입세금계산서 현황 그리드 더블클릭시 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.grd_vatSttus_oncelldblclick();
 */
this.grd_vatSttus_oncelldblclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	var nRow = this.ds_vatSttus.rowposition;
	var taxbillNo = this.ds_vatSttus.getColumn(nRow, "TAXBILL_NO");
	var decsnYear = this.ds_vatSttus.getColumn(nRow, "DECSN_YEAR");
	var decsnNo   = this.ds_vatSttus.getColumn(nRow, "DECSN_NO");
	
	if(!this.comUtils.isNull(decsnYear)) {
		var args = {
			  arg_0     : this
			, trgFormId	: "ACC030111"	// 팝업을 호출하는 화면의 ID
			, trgFormId2: "MIS"			// 삭제방지코드
			, anactKnd	: "03"
			, decsnYear	: decsnYear
			, decsnNo	: decsnNo
		};
		
		this.gfn_popup("expPopup", 903, 842, "지출결의서", args, "mis_acc::ACC020203_P01.xfdl", "fn_popupCallBack", true);
	}
}


/***********************************************************************
* Dataset 이벤트 처리
************************************************************************/

/*
 * 함수명  	: ds_vatSttus_oncolumnchanged
 * 설명 		: 매입세금계산서현황 그리드 컬럼 변경시 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_vatSttus_oncolumnchanged(obj,e);
 */
this.ds_vatSttus_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	if(e.columnid == "TAX_DEDUC_YN") {
		obj.setColumn(e.row, "PCHS_TAX_NOTAX_RSN", null);
	}
}

this.grd_vatSttus_oncellclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	if(e.col == 0) { 
		var nRow = this.ds_vatSttus.rowposition;
		if(this.comUtils.isNull(this.ds_vatSttus.getColumn(nRow, "DECSN_NO"))) {
			var registChk = this.ds_vatSttus.getColumn(nRow, "CHK");
			registChk = registChk == '1' ? '0' : '1';
			this.ds_vatSttus.set_updatecontrol(false);
			this.ds_vatSttus.set_enableevent(false);
			this.ds_vatSttus.setColumn(nRow, "CHK", registChk);
			this.ds_vatSttus.set_enableevent(true);
			this.ds_vatSttus.set_updatecontrol(true);
		}
	}
}

this.grd_vatSttus_onexpandup = function(obj:Grid, e:nexacro.GridMouseEventInfo)
{
	if(e.col == 1) {
		this.gfn_popup("bsnsPopup", 500, 500, "사업지구", "", "pms_prj::popBsns.xfdl", "fn_popupCallBack", true);
	}
}
]]></Script>
  </Form>
</FDL>
