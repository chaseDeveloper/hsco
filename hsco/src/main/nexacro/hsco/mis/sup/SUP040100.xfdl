<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\default_typedef.xml"/>
  <Form id="SUP040100" classname="SUP040100" left="0" top="0" width="1059" height="735" titletext="이사회임원관리" oninit="SUP040100_oninit" onload="SUP040100_onload">
    <Layouts>
      <Layout>
        <Static id="sta_WFDA_Label07" taborder="36" cssclass="sta_WF_Labelbg" top="173" width="299" height="27" style="border:1 solid #e9eaecff ;" right="182"/>
        <Static id="sta_WFDA_Label04" taborder="30" cssclass="sta_WF_Labelbg" top="147" width="299" height="27" style="border:1 solid #e9eaecff ;" right="182"/>
        <Static id="sta_WFDA_Label00" taborder="31" cssclass="sta_WF_Labelbg" top="121" width="299" height="27" style="border:1 solid #e9eaecff ;" right="182"/>
        <Static id="sta_WFDA_Label01" taborder="32" cssclass="sta_WF_Labelbg" top="69" width="299" height="27" style="border:1 solid #e9eaecff ;" right="182"/>
        <Static id="sta_WFDA_Label02" taborder="35" cssclass="sta_WF_Labelbg" top="95" width="299" height="27" style="border:1 solid #e9eaecff ;" right="182"/>
        <Div id="div_search" taborder="0" left="0" top="0" right="28" height="33" style="padding:0 0 0 0;" cssclass="div_WFSA_Box">
          <Layouts>
            <Layout>
              <Static id="Static00" taborder="1" text="15" visible="false" left="0" top="2" width="15" height="34" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="Static01" taborder="2" text="9" visible="false" left="9" top="0" width="1000" height="5" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="sta_year" taborder="3" text="기준년도" cssclass="sta_WFSA_Label" left="15" top="5" width="64" height="21"/>
              <Static id="Static03" taborder="4" text="5" visible="false" left="74" top="2" width="5" height="34" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Static id="Static09" taborder="5" text="9" visible="false" left="9" top="32" width="1000" height="9" style="background:aqua;align:center middle;font:bold 9 Dotum;opacity:50;"/>
              <Spin id="spn_year" taborder="0" value="0" max="9999" min="1000" left="79" top="5" width="70" height="21" cssclass="spn_WF_Essential"/>
            </Layout>
          </Layouts>
          <InitValue/>
        </Div>
        <Static id="Static04" taborder="26" text="10" visible="false" left="0" top="33" right="34" height="10" style="background:bisque;border:0 none transparent ;"/>
        <Grid id="grd_bodNmst" taborder="6" binddataset="ds_bodNmst" useinputpanel="false" cellsizingtype="col" autofittype="col" autosizingtype="row" left="0" top="68" right="609" bottom="0">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="94"/>
                <Column size="105"/>
                <Column size="217"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="순번"/>
                <Cell col="1" text="임원번호"/>
                <Cell col="2" text="직위"/>
                <Cell col="3" text="성명"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow + 1"/>
                <Cell col="1" style="color: ;" text="bind:EXCTV_NO" autosizerow="limitmin" autosizecol="limitmin"/>
                <Cell col="2" text="bind:OFCPS_NM"/>
                <Cell col="3" text="bind:NM"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static00" taborder="1" text="임원현황" cssclass="sta_WF_Title02" left="0" top="43" width="186" height="19"/>
        <Static id="Static01" taborder="27" text="5" visible="false" left="0" top="63" right="34" height="5" style="background:bisque;border:0 none transparent ;"/>
        <Static id="Static05" taborder="28" text="10" visible="false" left="450" top="0" width="10" height="735" style="background:#1b3cd23c;align:center middle;"/>
        <Edit id="edt_ofcpsNm" taborder="8" top="72" width="100" height="21" right="377" cssclass="edt_WF_Essential"/>
        <Static id="sta_WFDA_Label06" taborder="33" cssclass="sta_WF_Labelbg" top="303" width="452" height="200" style="border:1 solid #e9eaecff ;" right="28"/>
        <TextArea id="txt_mainCareer" taborder="25" wordwrap="char" top="306" width="444" height="194" right="33"/>
        <Static id="Static02" taborder="34" text="상세정보" cssclass="sta_WF_Title02" top="43" width="186" height="19" right="414"/>
        <Edit id="edt_nm" taborder="10" enable="true" top="98" width="100" height="21" right="377" cssclass="edt_WF_Essential"/>
        <Calendar id="cal_tenureBeginDe" taborder="12" top="124" width="110" height="21" right="367" cssclass="cal_WF_Essential"/>
        <Static id="sta_ACNUTNO00" taborder="11" text="임기기간" cssclass="sta_WF_Label" top="121" width="120" height="27" style="padding:0 0 0 10;align:left middle;" right="479"/>
        <Static id="sta_ACNUTNO03" taborder="14" text="연락처1" cssclass="sta_WF_Label" top="147" width="120" height="27" style="padding:0 0 0 10;align:left middle;" right="479"/>
        <Static id="sta_ACNUTNO06" taborder="18" text="연락처2" cssclass="sta_WF_Label" top="173" width="120" height="27" style="padding:0 0 0 10;align:left middle;" right="479"/>
        <Static id="sta_ACNUTNO" taborder="7" text="직위" cssclass="sta_WF_Label" top="69" width="120" height="27" style="padding:0 0 0 10;align:left middle;" right="479"/>
        <Static id="sta_ACNUTNO01" taborder="9" text="성명" cssclass="sta_WF_Label" top="95" width="120" height="27" style="padding:0 0 0 10;align:left middle;" right="479"/>
        <Static id="sta_ACNUTNO05" taborder="24" text="주요경력" cssclass="sta_WF_Label" top="303" width="120" height="200" style="padding:0 0 0 10;align:left middle;" right="479"/>
        <Static id="Static34" taborder="37" text="~" top="124" width="14" height="21" style="align:center middle;" right="351"/>
        <Calendar id="cal_tenureEndDe" taborder="13" top="124" width="110" height="21" right="240" cssclass="cal_WF_Essential"/>
        <Static id="Static03" taborder="38" text="-" top="150" width="14" height="21" style="align:center middle;" right="412"/>
        <Static id="Static06" taborder="39" text="-" top="150" width="14" height="21" style="align:center middle;" right="345"/>
        <Static id="Static07" taborder="40" text="-" top="176" width="14" height="21" style="align:center middle;" right="345"/>
        <Static id="Static08" taborder="41" text="-" top="176" width="14" height="21" style="align:center middle;" right="412"/>
        <Static id="sta_WFDA_Label03" taborder="42" cssclass="sta_WF_Labelbg" top="69" right="28" width="155" height="131" style="border:1 solid #e9eaecff ;"/>
        <ImageViewer id="ImageViewer04" taborder="43" top="80" width="118" height="110" right="47" image="URL('theme://images\img_sample.png')" style="opacity:100;" stretch="fit"/>
        <Grid id="grd_EXCEL_SAMPLE" taborder="47" useinputpanel="false" onheadclick="grd_EXCEL_onheadclick" top="571" width="492" height="155" binddataset="ds_uploadSample" right="103" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="250"/>
                <Column size="250"/>
                <Column size="200"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="40"/>
              </Rows>
              <Band id="head">
                <Cell style="line:1 solid #808080 ;background:yellow;background2:yellow;" text="★명부년도"/>
                <Cell col="1" style="line:1 solid #808080 ;background:yellow;background2:yellow;" text="★직위명"/>
                <Cell col="2" style="line:1 solid #808080 ;background:yellow;background2:yellow;" text="★성명"/>
                <Cell col="3" style="line:1 solid #808080 ;background:yellow;background2:yellow;" text="★임기시작일"/>
                <Cell col="4" style="line:1 solid #808080 ;background:yellow;background2:yellow;" text="★임기종료일"/>
                <Cell col="5" style="line:1 solid #808080 ;background:yellow;background2:yellow;" text="연락처1_1"/>
                <Cell col="6" style="line:1 solid #808080 ;background:yellow;background2:yellow;" text="연락처1_2"/>
                <Cell col="7" style="line:1 solid #808080 ;background:yellow;background2:yellow;" text="연락처1_3"/>
                <Cell col="8" style="line:1 solid #808080 ;background:yellow;background2:yellow;" text="연락처2_1"/>
                <Cell col="9" style="line:1 solid #808080 ;background:yellow;background2:yellow;" text="연락처2_2"/>
                <Cell col="10" style="line:1 solid #808080 ;background:yellow;background2:yellow;" text="연락처2_3"/>
                <Cell col="11" style="line:1 solid #808080 ;background:yellow;background2:yellow;" text="우편번호"/>
                <Cell col="12" style="line:1 solid #808080 ;background:yellow;background2:yellow;" text="도로명주소"/>
                <Cell col="13" style="line:1 solid #808080 ;background:yellow;background2:yellow;" text="지번주소"/>
                <Cell col="14" style="line:1 solid #808080 ;background:yellow;background2:yellow;" text="주요경력"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="color:red;color2:red;" text="bind:NMST_YEAR"/>
                <Cell col="1" displaytype="text" style="color:blue;color2:blue;" text="bind:OFCPS_NM"/>
                <Cell col="2" displaytype="text" style="color:blue;color2:blue;" text="bind:NM"/>
                <Cell col="3" displaytype="text" style="color:blue;color2:blue;" text="bind:TENURE_BEGIN_DE"/>
                <Cell col="4" displaytype="text" style="color:blue;color2:blue;" text="bind:TENURE_END_DE"/>
                <Cell col="5" displaytype="text" style="color:blue;color2:blue;" text="bind:CTTPC1S"/>
                <Cell col="6" displaytype="text" style="color:blue;color2:blue;" text="bind:CTTPC1M"/>
                <Cell col="7" displaytype="text" style="color:blue;color2:blue;" text="bind:CTTPC1E"/>
                <Cell col="8" displaytype="text" style="color:blue;color2:blue;" text="bind:CTTPC2S"/>
                <Cell col="9" displaytype="text" style="color:blue;color2:blue;" text="bind:CTTPC2M"/>
                <Cell col="10" displaytype="text" style="color:blue;color2:blue;" text="bind:CTTPC2E"/>
                <Cell col="11" displaytype="text" style="color:blue;color2:blue;" text="bind:ZIP"/>
                <Cell col="12" text="bind:RDNMADR"/>
                <Cell col="13" text="bind:LNM_ADRES"/>
                <Cell col="14" displaytype="text" style="color:blue;color2:blue;" text="bind:MAIN_CAREER"/>
                <Cell row="1" colspan="15" style="align:left;font:bold 10 arial;" text="※ 첫번째(제목) 행을 제외한 샘플데이터 삭제 후 업로드 해주시기 바랍니다. &#13;&#10;★ : 필수 입력 항목"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_EXCEL_IMP" taborder="3" cssclass="btn_WF_Gridexcelup" top="43" width="25" height="19" right="609" onclick="btn_EXCEL_IMP_onclick"/>
        <Button id="Button46" taborder="4" text="사진등록" cssclass="btn_WF_Process" top="43" width="66" height="19" onclick="btn_photo_onclick" right="96"/>
        <Button id="Button00" taborder="5" text="사진삭제" onclick="btn_del_photo_onclick" cssclass="btn_WF_Process" top="43" width="66" height="19" right="28"/>
        <Static id="Static09" taborder="48" cssclass="sta_WF_Labelbg" top="277" width="462" height="27" right="28"/>
        <Static id="Static10" taborder="49" cssclass="sta_WF_Labelbg" top="251" width="462" height="27" right="28"/>
        <Static id="Static11" taborder="50" cssclass="sta_WF_Labelbg" top="225" width="462" height="27" right="28"/>
        <Static id="Static12" taborder="51" cssclass="sta_WF_Labelbg" top="199" width="462" height="27" right="28"/>
        <Static id="sta_zip" taborder="52" text="지번주소" cssclass="sta_WF_Label" top="251" width="120" height="27" style="align:left middle;font:9 Dotum;" right="479"/>
        <Static id="sta_detailAdres" taborder="53" text="지번상세주소" cssclass="sta_WF_Label" top="277" width="120" height="27" style="align:left middle;font:9 Dotum;" right="479"/>
        <Edit id="edt_adres00" taborder="55" readonly="false" top="254" width="444" height="21" right="33"/>
        <Edit id="edt_detailAdres" taborder="56" autoselect="true" top="280" width="444" height="21" right="33"/>
        <Edit id="edt_zip" taborder="69" top="202" right="399" width="78" height="21"/>
        <Edit id="edt_rn" taborder="57" readonly="false" top="202" width="364" height="21" right="33"/>
        <Edit id="edt_detailRdnmadr" taborder="58" autoselect="true" top="228" width="444" height="21" right="33"/>
        <Static id="sta_detailRdnmadr" taborder="60" text="도로명상세주소" cssclass="sta_WF_Label" top="225" width="120" height="27" style="align:left middle;font:9 Dotum;" right="479"/>
        <Static id="sta_rn" taborder="61" text="우편번호/도로명" cssclass="sta_WF_Label" top="199" width="120" height="27" style="align:left middle;font:9 Dotum;" right="479"/>
        <Button id="btn_COPY" taborder="62" text="양식 다운로드" onclick="btn_excelDn_onclick" cssclass="btn_WF_Process" top="43" right="644" width="92" height="19"/>
        <MaskEdit id="msk_cttpc1S" taborder="63" top="150" width="49" height="21" right="428" mask="###" limitbymask="integer" type="string" maskchar="_"/>
        <MaskEdit id="msk_cttpc1M" taborder="64" top="150" right="361" width="49" height="21" mask="####" limitbymask="integer" type="string"/>
        <MaskEdit id="msk_cttpc1E" taborder="65" top="150" right="294" width="49" height="21" mask="####" limitbymask="integer" type="string"/>
        <MaskEdit id="msk_cttpc1S00" taborder="66" type="string" mask="###" limitbymask="integer" top="176" right="428" width="49" height="21"/>
        <MaskEdit id="msk_cttpc1M00" taborder="67" type="string" mask="####" limitbymask="integer" top="176" right="361" width="49" height="21"/>
        <MaskEdit id="msk_cttpc1E00" taborder="68" type="string" mask="####" limitbymask="integer" top="176" right="294" width="49" height="21"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item2" compid="div_search.spn_year" propid="value" datasetid="ds_cond" columnid="YEAR"/>
      <BindItem id="item0" compid="edt_ofcpsNm" propid="value" datasetid="ds_bodNmst" columnid="OFCPS_NM"/>
      <BindItem id="item1" compid="edt_nm" propid="value" datasetid="ds_bodNmst" columnid="NM"/>
      <BindItem id="item3" compid="cal_tenureBeginDe" propid="value" datasetid="ds_bodNmst" columnid="TENURE_BEGIN_DE"/>
      <BindItem id="item4" compid="cal_tenureEndDe" propid="value" datasetid="ds_bodNmst" columnid="TENURE_END_DE"/>
      <BindItem id="item12" compid="txt_mainCareer" propid="value" datasetid="ds_bodNmst" columnid="MAIN_CAREER"/>
      <BindItem id="item14" compid="edt_adres00" propid="value" datasetid="ds_bodNmst" columnid="LNM_ADRES"/>
      <BindItem id="item15" compid="edt_detailAdres" propid="value" datasetid="ds_bodNmst" columnid="DETAIL_LNM_ADRES"/>
      <BindItem id="item16" compid="edt_rn" propid="value" datasetid="ds_bodNmst" columnid="RDNMADR"/>
      <BindItem id="item17" compid="edt_detailRdnmadr" propid="value" datasetid="ds_bodNmst" columnid="DETAIL_RDNMADR"/>
      <BindItem id="item11" compid="msk_cttpc1S" propid="value" datasetid="ds_bodNmst" columnid="CTTPC1S"/>
      <BindItem id="item5" compid="msk_cttpc1M" propid="value" datasetid="ds_bodNmst" columnid="CTTPC1M"/>
      <BindItem id="item6" compid="msk_cttpc1E" propid="value" datasetid="ds_bodNmst" columnid="CTTPC1E"/>
      <BindItem id="item7" compid="msk_cttpc1S00" propid="value" datasetid="ds_bodNmst" columnid="CTTPC2S"/>
      <BindItem id="item18" compid="msk_cttpc1M00" propid="value" datasetid="ds_bodNmst" columnid="CTTPC2M"/>
      <BindItem id="item19" compid="msk_cttpc1E00" propid="value" datasetid="ds_bodNmst" columnid="CTTPC2E"/>
      <BindItem id="item8" compid="edt_zip" propid="value" datasetid="ds_bodNmst" columnid="ZIP"/>
    </Bind>
    <Objects>
      <Dataset id="ds_cond" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="YEAR" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_bodNmst" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_bodNmst_onrowposchanged">
        <ColumnInfo>
          <Column id="EXCTV_NO" type="STRING" size="256"/>
          <Column id="NMST_YEAR" type="STRING" size="256"/>
          <Column id="OFCPS_NM" type="STRING" size="256"/>
          <Column id="NM" type="STRING" size="256"/>
          <Column id="TENURE_BEGIN_DE" type="STRING" size="256"/>
          <Column id="TENURE_END_DE" type="STRING" size="256"/>
          <Column id="CTTPC1S" type="STRING" size="256"/>
          <Column id="CTTPC1M" type="STRING" size="256"/>
          <Column id="CTTPC1E" type="STRING" size="256"/>
          <Column id="CTTPC2S" type="STRING" size="256"/>
          <Column id="CTTPC2M" type="STRING" size="256"/>
          <Column id="CTTPC2E" type="STRING" size="256"/>
          <Column id="ZIP" type="STRING" size="256"/>
          <Column id="RDNMADR" type="STRING" size="256"/>
          <Column id="DETAIL_RDNMADR" type="STRING" size="256"/>
          <Column id="LNM_ADRES" type="STRING" size="256"/>
          <Column id="DETAIL_LNM_ADRES" type="STRING" size="256"/>
          <Column id="MAIN_CAREER" type="STRING" size="256"/>
          <Column id="REGISTER_ID" type="STRING" size="256"/>
          <Column id="REGIST_DT" type="STRING" size="256"/>
          <Column id="UPDUSR_ID" type="STRING" size="256"/>
          <Column id="UPDT_DT" type="STRING" size="256"/>
          <Column id="FILE_SN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_import" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onload="DS_IMPORT_onload">
        <ColumnInfo>
          <Column id="Column0" type="STRING" size="256"/>
          <Column id="Column1" type="STRING" size="256"/>
          <Column id="Column2" type="STRING" size="256"/>
          <Column id="Column3" type="STRING" size="256"/>
          <Column id="Column4" type="STRING" size="256"/>
          <Column id="Column5" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_upload" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="FILE_NM" type="STRING" size="256"/>
          <Column id="EXCTV_NO" type="STRING" size="256"/>
          <Column id="FILE_SN" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_cond_file" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="FILE_SN" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_uploadSample" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="NMST_YEAR" type="STRING" size="256"/>
          <Column id="OFCPS_NM" type="STRING" size="256"/>
          <Column id="NM" type="STRING" size="256"/>
          <Column id="TENURE_BEGIN_DE" type="STRING" size="256"/>
          <Column id="TENURE_END_DE" type="STRING" size="256"/>
          <Column id="CTTPC1S" type="STRING" size="256"/>
          <Column id="CTTPC1M" type="STRING" size="256"/>
          <Column id="CTTPC1E" type="STRING" size="256"/>
          <Column id="CTTPC2S" type="STRING" size="256"/>
          <Column id="CTTPC2M" type="STRING" size="256"/>
          <Column id="CTTPC2E" type="STRING" size="256"/>
          <Column id="ZIP" type="STRING" size="256"/>
          <Column id="RDNMADR" type="STRING" size="256"/>
          <Column id="LNM_ADRES" type="STRING" size="256"/>
          <Column id="MAIN_CAREER" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="NMST_YEAR">2015</Col>
            <Col id="OFCPS_NM">위원장</Col>
            <Col id="NM">홍길동</Col>
            <Col id="TENURE_BEGIN_DE">20150101</Col>
            <Col id="TENURE_END_DE">20151231</Col>
            <Col id="CTTPC1S">010</Col>
            <Col id="CTTPC1M">1234</Col>
            <Col id="CTTPC1E">5678</Col>
            <Col id="CTTPC2S">053</Col>
            <Col id="CTTPC2M">3500</Col>
            <Col id="CTTPC2E">3900</Col>
            <Col id="ZIP">41594</Col>
            <Col id="RDNMADR">화성광역시 북구 침산로 73</Col>
            <Col id="LNM_ADRES">화성광역시 북구 고성동3가</Col>
            <Col id="MAIN_CAREER"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_delete" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="EXCTV_NO" type="STRING" size="256"/>
          <Column id="FILE_SN" type="STRING" size="256"/>
          <Column id="FILE_ORDR" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_validation" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="compId" type="STRING" size="256"/>
          <Column id="colId" type="STRING" size="256"/>
          <Column id="PK" type="STRING" size="256"/>
          <Column id="notNull" type="STRING" size="256"/>
          <Column id="type" type="STRING" size="256"/>
          <Column id="nlength" type="STRING" size="256"/>
          <Column id="from" type="STRING" size="256"/>
          <Column id="to" type="STRING" size="256"/>
          <Column id="lengthChkGb" type="STRING" size="256"/>
          <Column id="msgId" type="STRING" size="256"/>
          <Column id="expr" type="STRING" size="256"/>
          <Column id="func" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="compId">ds_cond</Col>
            <Col id="notNull">Y</Col>
            <Col id="colId">YEAR</Col>
            <Col id="msgId">검색 기준년도</Col>
          </Row>
          <Row>
            <Col id="compId">ds_bodNmst</Col>
            <Col id="colId">OFCPS_NM</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">직위</Col>
          </Row>
          <Row>
            <Col id="compId">ds_bodNmst</Col>
            <Col id="colId">NM</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">성명</Col>
          </Row>
          <Row>
            <Col id="colId">TENURE_BEGIN_DE</Col>
            <Col id="compId">ds_bodNmst</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">임기시작일</Col>
            <Col id="from"/>
            <Col id="to"/>
          </Row>
          <Row>
            <Col id="colId">TENURE_END_DE</Col>
            <Col id="compId">ds_bodNmst</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">임기종료일</Col>
            <Col id="from"/>
          </Row>
          <Row>
            <Col id="compId">ds_bodNmst</Col>
            <Col id="colId">TENURE_BEGIN_DE</Col>
            <Col id="PK">[Undefined]</Col>
            <Col id="notNull"/>
            <Col id="type">[Undefined]</Col>
            <Col id="nlength">[Undefined]</Col>
            <Col id="from">TENURE_BEGIN_DE</Col>
            <Col id="to">TENURE_END_DE</Col>
            <Col id="lengthChkGb">[Undefined]</Col>
            <Col id="msgId">임기시작일^임기종료일</Col>
            <Col id="expr">[Undefined]</Col>
            <Col id="func">[Undefined]</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_temp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="YEAR" type="STRING" size="256"/>
          <Column id="CNT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_fileList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="PROGRS" type="BIGDECIMAL" size="16"/>
          <Column id="ORGINL_FILE_NM" type="string" size="32"/>
          <Column id="FILE_EXTSN" type="string" size="32"/>
          <Column id="FILE_STRE_COURS" type="string" size="32"/>
          <Column id="FILE_ID" type="string" size="32"/>
          <Column id="SN" type="bigdecimal" size="16"/>
          <Column id="SYS_SE_CODE" type="string" size="32"/>
          <Column id="FILE_IMAGE" type="string" size="32"/>
          <Column id="FILE_TY" type="string" size="32"/>
          <Column id="JOB_SE" type="string" size="32"/>
          <Column id="DELETE_IMAGE" type="string" size="32"/>
          <Column id="STRE_FILE_NM" type="string" size="32"/>
          <Column id="FILE_MG" type="bigdecimal" size="16"/>
          <Column id="FILE_CN" type="string" size="32"/>
          <Column id="FILE_ORDR" type="bigdecimal" size="16"/>
          <Column id="TRNSMIS_FILE_SIZE" type="string" size="32"/>
          <Column id="USE_AT" type="string" size="32"/>
          <Column id="STTUS" type="string" size="32"/>
          <Column id="FILE_SN" type="bigdecimal" size="16"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript5.0"><![CDATA[/***********************************************************************
 * 화면ID   : SUP040100
 * 화면명   : 이사회임원관리
 * 화면설명 : 이사회임원명부를 관리한다.
 * 작성일   : 2015.10.14
 * 작성자   : 양성모
 * 수정이력 : 
 ***********************************************************************
 *     수정일     수정자   내용
 ***********************************************************************
 *    
 ***********************************************************************
 */

/***********************************************************************
 * Script Include 
 ***********************************************************************/
include "lib::comInclude.xjs";
include "mis_lib::misUtil.xjs";
include "lib::comUpDownUtils.xjs";
/***********************************************************************
 * 화면 변수 선언부
 ***********************************************************************/
this.checkDs = [this.ds_bodNmst];
this.year;
this.saveRow = -1;
this.File_UpDownManager = null;

/***********************************************************************
 * onInit / onLoad 영역
 ***********************************************************************/
this.SUP040100_oninit = function(obj:Form, e:nexacro.InitEventInfo)
{
	// Form 초기화
	this.fn_init_form();

	// DataSet 초기화
	this.fn_init_dataset();
}

this.SUP040100_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{	
	// 초기 검색조건
	this.ds_cond.setColumn(0, "YEAR",   this.dateUtils.today().substr(0,4));
	
	this.fn_search();
}

/***********************************************************************
 * Form/Dataset 오브젝트 초기화
 ***********************************************************************/
/*
 * 함수명  	: initForm
 * 설명 		: Form을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initForm();
 */
this.fn_init_form = function()
{
	// 시스템 공통으로 Form을 Initialize 한다.
	this.gfn_initForm(this);
	this.fn_misFormInit(this);
}

/*
 * 함수명  	: initDataset
 * 설명 		: Dataset을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initDataset();
 */
this.fn_init_dataset = function()
{
	this.gfn_initCondDs(this, this.div_search);
	
	// 파일 메니저 설정
	var fileConfig = {
		useMultiUpload : false,
		onChange: this.fn_onFileSelected,	// 파일 선택 이벤트 핸들러
		onSuccess : this.fn_onFileSuccess,	// 전송 성공 이벤트 핸들러
		onError : this.fn_onFileError,
		allowTypes : ["jpg","jpeg","gif","png"]	// 선택 허용 파일유형
		//responseGrid : this.div_multiFile.grd_fileList,
		//responseArea : this.div_multiFile.sta_helpMessage
	};
	this.File_UpDownManager = new this.fileUpDownManager(this, "MIS", "SUP");
	this.File_UpDownManager.init(fileConfig);
}


/***********************************************************************
* Transaction 영역 시작
************************************************************************/

/***********************************************************************
 * Transaction 관련 이벤트 핸들러 
 **********************************************************************/
/*
 * 함수명  	: fn_search
 * 설명 		: 조회 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_search();
 */
this.fn_search = function()
{
	// validation 체크
	if(!this.gfn_checkValidation_NoUpdChk(this.ds_cond, this.ds_validation)) {
		return false;
	}
		
	// 데이터셋 클리어
	this.ds_bodNmst.clearData();
	
	this.fn_transaction("select");
}

/*
 * 함수명  	: fn_save
 * 설명 		: 저장 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_save();
 */
this.fn_save= function()
{
	if(Ex.util.isUpdated(this.ds_bodNmst)) {
		// validation 체크
		if(!this.gfn_checkValidation_NoUpdChk(this.ds_bodNmst, this.ds_validation)) {
			return false;
		}
		
		this.saveRow = this.ds_bodNmst.rowposition;
		this.ds_temp.clearData();
		this.ds_temp.addRow();
		this.ds_temp.setColumn(0, "YEAR", this.year);
		this.ds_temp.setColumn(0, "CNT", this.ds_bodNmst.rowcount);
		
		this.fn_transaction("save");
	} else {	
	    this.gfn_message("comm.데이터.변경.없음");
	}

}


/*
 * 함수명  	: this.fn_save2
 * 설명 		: 첨부파일 조회 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_save2();
 */
this.fn_selectFile = function()
{
	this.ds_cond_file.clearData();
	this.ds_cond_file.addRow();
	
	this.ds_cond_file.setColumn(0, "FILE_SN",     this.ds_bodNmst.getColumn(this.ds_bodNmst.rowposition, "FILE_SN"));
	this.ImageViewer04.set_image("URL('theme://images/img_sample.png')");
	this.fn_transaction("selectFileList");	
}

/**********************************************************************
 * CALL TRANSACTION 영역
 **********************************************************************/
 
/*
 * 함수명  	: fn_transaction
 * 설명 		: Transaction 요청 처리 함수
 * params  		: strSvcId : 서비스요청 ID
 * return Type 	: None
 * 사용법		: this.fn_transaction("SELECT");
 */
this.fn_transaction = function(strSvcId)
{

	switch (strSvcId) {
		case "select":    			// 이사회임원명부 조회
			var sController   	= "hsco/mis/sup/SUP040100/selectBodNmstList.do";
			var sInDatasets   	= "input1=ds_cond";
			var sOutDatasets  	= "ds_bodNmst=output1";
			break;
		case "save":    			// 이사회임원명부 저장
			var sController   	= "hsco/mis/sup/SUP040100/saveBodNmst.do";
			var sInDatasets   	= "input1=ds_bodNmst:U input2=ds_temp";
			var sOutDatasets  	= "";
			break;
		case "selectFileList":      // 첨부파일 조회
			var sController   	= "hsco/mis/sup/SUP040100/selectFileList.do";
			var sInDatasets   	= "input1=ds_cond_file";
			var sOutDatasets  	= "ds_fileList=output1";
			break;
	}

	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets);
}

 /**********************************************************************
 * Transaction Callback 영역
 ***********************************************************************/
 
 /*
 * 함수명  	: fn_callBack
 * 설명 		: Transaction Callback 처리
 * params  		: strSvcId    : 서비스요청 ID
 *                nErrorCode  : 오류 메시지 코드 ([예] 0 : Success, 그밖의 경우, error)
 *                strErrorMsg : 오류 메시지([예]  success.insert|정상적으로 등록되었습니다.)
 * return Type 	: None
 * 사용법		: 
 */
this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg)
{

	// 오류 및 성공 메시지를 화면에 보여준다.
	if (nErrorCode != 0){
		this.gfn_callback_message(strSvcId, nErrorCode, strErrorMsg);
	} else {
		// 실패 메시지를 보여주는 동작 외에 처리할 내용이 있으면 아래에 기술.
		switch (strSvcId) {	
			case "select":	// 임원관리명부 조회
				this.ds_bodNmst.applyChange();
				this.year = this.ds_cond.getColumn(0, "YEAR");
				
				if(this.saveRow > -1){
					this.ds_bodNmst.set_rowposition(this.saveRow);
					this.saveRow = -1;
				}
				break;
			case "save":	// 임원관리명부 저장
			    this.gfn_message("success.처리.성공");
			    this.fn_search();
				break;
			case "selectFileList":      // 첨부파일 조회
				if(this.ds_fileList.rowcount > 0){
					var fileExtsn = this.ds_fileList.getColumn(0, "FILE_EXTSN");
					var fileSn = this.ds_fileList.getColumn(0, "FILE_SN");			// atchFileInfArr[0];	// 파일일련번호(파일경로)
					var fileOrder = this.ds_fileList.getColumn(0, "FILE_ORDR");	// atchFileInfArr.length > 2 ? atchFileInfArr[1] : "";	// 파일 순차번호
					var fileName = this.ds_fileList.getColumn(0, "ATCH_FILE");		// 실제 파일명
					var fileType = this.ds_fileList.getColumn(0, "FILE_TY");  // 파일 타입
					
					if(fileType.indexOf("image/")>-1){
						var param = {};
						param["FILE_SN"] = fileSn;
						param["FILE_ORDR"] = fileOrder;
						
						var strUrl = application.gv_host + "hsco/cmm/download/viewImage.do";
						var params = "?FILE_SN=" + fileSn + "&FILE_ORDR=" + fileOrder;
						this.ImageViewer04.set_image(strUrl + params);
					}
				}
			break;
		}
	}
}

/***********************************************************************
* Transaction 영역 끝
************************************************************************/

/***********************************************************************
* non-Transaction 관련 컴포넌트 이벤트 처리 함수
************************************************************************
* 
* 1. Button 영역 
* 2. Dataset 영역 
************************************************************************/


/**********************************************************************
* Button 영역 
***********************************************************************/
/*
 * 함수명  	: btn_Add_R_onclick
 * 설명 		: 신규 버튼 이벤트
 * params  		: strSvcId : 서비스요청 ID
 * return Type 	: None
 * 사용법		: this.btn_Add_R_onclick();
 */
this.fn_insert= function()
{
	var nRow = this.ds_bodNmst.addRow();
	this.ds_bodNmst.setColumn(nRow, "NMST_YEAR", this.year);
}

/*
 * 함수명  	: btn_Del_R_onclick
 * 설명 		: 삭제 버튼 이벤트
 * params  		: strSvcId : 서비스요청 ID
 * return Type 	: None
 * 사용법		: this.btn_Del_R_onclick();
 */
this.fn_delete= function()
{
	if(this.gfn_message("confirm.삭제여부")){
		var nRow = this.ds_bodNmst.rowposition;
		this.ds_bodNmst.deleteRow(nRow);
	}
}

/*
 * 함수명  	: btn_Can_R_onclick
 * 설명 		: 취소 버튼 이벤트
 * params  		: strSvcId : 서비스요청 ID
 * return Type 	: None
 * 사용법		: this.btn_Can_R_onclick();
 */
this.fn_cancel= function()
{
	if (this.gfn_message("confirm.취소여부")) {
		this.ds_bodNmst.reset();		                                 //DATASET ROLLBACK
		this.ds_bodNmst.applyChange();	                                 //DATASET COMMIT
		return;
	}	
}


/*
 * 함수명  	: btn_EXCEL_IMP_onclick
 * 설명 		: 엑셀 업로드 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_EXCEL_IMP_onclick();
 */
this.btn_EXCEL_IMP_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var arg = {
		targetDs : this.ds_import,
		headSet : false,
		callBack : function () {
			if(this.ds_import.rowcount > 1){
				var nRow;
				for(i=1; i< this.ds_import.rowcount; i++) {
					nRow = this.ds_bodNmst.addRow();
					this.ds_bodNmst.setColumn(nRow, "NMST_YEAR",       this.ds_import.getColumn(i, "Column0"));
					this.ds_bodNmst.setColumn(nRow, "OFCPS_NM",        this.ds_import.getColumn(i, "Column1"));
					this.ds_bodNmst.setColumn(nRow, "NM",              this.ds_import.getColumn(i, "Column2"));
					this.ds_bodNmst.setColumn(nRow, "TENURE_BEGIN_DE", this.ds_import.getColumn(i, "Column3"));
					this.ds_bodNmst.setColumn(nRow, "TENURE_END_DE",   this.ds_import.getColumn(i, "Column4"));
					this.ds_bodNmst.setColumn(nRow, "CTTPC1S",         this.ds_import.getColumn(i, "Column5"));
					this.ds_bodNmst.setColumn(nRow, "CTTPC1M",         this.ds_import.getColumn(i, "Column6"));
					this.ds_bodNmst.setColumn(nRow, "CTTPC1E",         this.ds_import.getColumn(i, "Column7"));
					this.ds_bodNmst.setColumn(nRow, "CTTPC2S",         this.ds_import.getColumn(i, "Column8"));
					this.ds_bodNmst.setColumn(nRow, "CTTPC2M",         this.ds_import.getColumn(i, "Column9"));
					this.ds_bodNmst.setColumn(nRow, "CTTPC2E",         this.ds_import.getColumn(i, "Column10"));
					this.ds_bodNmst.setColumn(nRow, "ZIP",             this.ds_import.getColumn(i, "Column11"));
					this.ds_bodNmst.setColumn(nRow, "RDNMADR",         this.ds_import.getColumn(i, "Column12"));
					this.ds_bodNmst.setColumn(nRow, "LNM_ADRES",       this.ds_import.getColumn(i, "Column13"));
					this.ds_bodNmst.setColumn(nRow, "MAIN_CAREER",     this.ds_import.getColumn(i, "Column14"));
				}
			}
		}
	};
	
	this.gfn_importExcel(arg);
}

/*
 * 함수명  	: btn_excelDn_onclick
 * 설명 		: 그리드 엑셀 다운로드
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_excelDn_onclick();
 */
this.btn_excelDn_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.gfn_exportExcel(this.grd_EXCEL_SAMPLE, "EXCEL_UPLOAD_FORM");
}

/*
 * 함수명  	: btn_photo_onclick
 * 설명 		: 사진첨부 버튼 클릭 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_photo_onclick();
 */
this.btn_photo_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.ds_bodNmst.rowposition >= 0){
		if(this.ds_bodNmst.getRowType(this.ds_bodNmst.rowposition) != 2){
			if(this.ds_fileList.rowcount < 1){
				
				mCallback = function() {
					this.fn_autoFileSn(
						 "MIS"									// 대분류   (SYS_SE)
						,"SUP"									// 업무구분 (JOB_SE)
						, this.File_UpDownManager	            // fileManager 오브젝트
						, this.ds_fileList		                // fileObject
						, this.ds_bodNmst	            		// fileSn을 불러오거나 반영해야 하는 컬럼
						, "TBSUP_BOD_NMST"         				// fileSn을 저장할 테이블
						, "FILE_SN"								// fileSn 컬럼명이 다를 경우를 대비
						, ["EXCTV_NO"]							// fileSn을 저장할 테이블의 PK (FileSn 확인 및 자동반영목적)
					);
				}
				
				this.gfn_message("info.저장.초과", "이미지 파일만", null, null, mCallback);
				
			} else {
				this.gfn_message("info.저장.초과", "최대 1개 까지만");
			}
		} else {
			this.gfn_message("info.진행가능", "신규 임원은 저장");
		}
	} else {
		this.gfn_message("info.항목.선택.알림", "임원");
	}
}

/*
 * 함수명  	: btn_del_photo_onclick
 * 설명 		: 사진삭제 버튼 클릭 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_del_photo_onclick();
 */
this.btn_del_photo_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var fileSn = this.ds_bodNmst.getColumn(this.ds_bodNmst.rowposition, "FILE_SN");
	if(!fileSn){
		this.gfn_message("info.파일정보.없음");
	} else {
		if ( this.gfn_message("confirm.삭제여부") ) {
			this.ds_fileList.deleteRow(0);
			
			var strSvcId   	 = "deleteFile";
			var sController  = "hsco/cmm/file/deleteFile.do";
			var sInDatasets  = "input1=ds_fileList:U";
			var sOutDatasets = "ds_fileList=output1";
			Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets); 
			
			this.ImageViewer04.set_image("URL('theme://images/img_sample.png')");
		}
	}
}

 /*
 * 함수명  	: fn_onFileSuccess
 * 설명 		: 파일 업로드 성공시 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_onFileSuccess();
 */
this.fn_onFileSuccess = function(){
	
	this.fn_selectFile();	
}

 /*
 * 함수명  	: fn_onFileError
 * 설명 		: 파일 업로드 실패시 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_onFileError();
 */
this.fn_onFileError = function(){
	
	this.gfn_message("info.저장.초과", "이미지 파일만");	
}

/**********************************************************************
* Dataset 영역 
***********************************************************************/

/*
 * 함수명  	: ds_bodNmst_onrowposchanged
 * 설명 		: 임원 변경 시 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_bodNmst_onrowposchanged();
 */
this.ds_bodNmst_onrowposchanged = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{
	this.ds_fileList.clearData();
	this.fn_selectFile();
// 	if(this.ds_bodNmst.getRowType(this.ds_bodNmst.rowposition) != 2){
// 		this.fn_selectFile();
// 	}
}
]]></Script>
  </Form>
</FDL>
