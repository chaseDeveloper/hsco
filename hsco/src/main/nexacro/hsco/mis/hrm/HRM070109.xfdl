<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\default_typedef.xml"/>
  <Form id="HRM070109" classname="HRM070109" left="0" top="0" width="1059" height="735" titletext="부서별 근태현황" oninit="HRM070109_oninit" onload="HRM070109_onload">
    <Layouts>
      <Layout>
        <Div id="div_search" taborder="0" left="0" top="0" height="33" cssclass="div_WFSA_Box" right="28">
          <Layouts>
            <Layout>
              <Static id="Static06" taborder="1" text="15" visible="false" left="0" top="0" width="15" height="33" style="background:#00ffff66;"/>
              <Static id="sta_gnfdDe" taborder="3" text="조회기간" cssclass="sta_WFSA_Label" left="15" top="5" width="64" height="21"/>
              <Static id="sta_dept" taborder="5" text="조회부서" cssclass="sta_WFSA_Label" left="319" top="5" width="64" height="21"/>
              <Div id="div_deptCode" taborder="4" url="com::deptCode.xfdl" left="388" top="5" width="195" height="22" async="false"/>
              <Calendar id="cal_searchBgnDe" taborder="0" left="84" top="5" width="100" height="21" dateformat="yyyy-MM-dd" value="null" cssclass="cal_WF_Essential"/>
              <Calendar id="cal_searchEndDe" taborder="2" dateformat="yyyy-MM-dd" cssclass="cal_WF_Essential" left="204" top="5" width="100" height="21"/>
              <Static id="Static00" taborder="6" text="~" left="189" top="5" width="10" height="21"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static03" taborder="1" text="15" visible="false" left="1031" top="0" width="15" height="735" style="background:#1b3cd23c;align:center middle;"/>
        <Static id="Static04" taborder="2" text="스&#13;&#10;크&#13;&#10;롤&#13;&#10;13" visible="false" top="0" right="0" width="13" height="735" style="background:#d07b173c;align:center middle;"/>
        <Div id="div_work" taborder="3" left="0" top="33" right="28" height="692">
          <Layouts>
            <Layout>
              <Static id="Static36" taborder="16" text="10" visible="false" left="0" top="0" width="1031" height="10" style="background:#dc143c3c;align:center middle;"/>
              <Tab id="HRM070109" taborder="17" left="0" top="10" tabindex="0" scrollbars="autoboth" height="672" style="showextrabutton:false;" right="0" onchanged="div_work_HRM070109_onchanged">
                <Tabpages>
                  <Tabpage id="T01" text="근태현황_일반">
                    <Layouts>
                      <Layout>
                        <Grid id="Grid00" taborder="0" useinputpanel="false" left="1" top="5" height="185" right="1" autoenter="select" autofittype="col" binddataset="ds_deptDclzList">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="100"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                              </Rows>
                              <Band id="head">
                                <Cell text="구분"/>
                                <Cell col="1" colspan="5" text="인원"/>
                                <Cell col="6" colspan="4" text="출근"/>
                                <Cell col="10" colspan="4" text="퇴근"/>
                                <Cell col="14" colspan="13" text="근무상황"/>
                                <Cell col="27" rowspan="2" text="출장"/>
                                <Cell col="28" rowspan="2" text="교육"/>
                                <Cell row="1" text="소속"/>
                                <Cell row="1" col="1" text="계"/>
                                <Cell row="1" col="2" text="정상"/>
                                <Cell row="1" col="3" text="유연"/>
                                <Cell row="1" col="4" text="현장"/>
                                <Cell row="1" col="5" text="기타"/>
                                <Cell row="1" col="6" text="소계"/>
                                <Cell row="1" col="7" text="정상"/>
                                <Cell row="1" col="8" text="미확인"/>
                                <Cell row="1" col="9" text="지각"/>
                                <Cell row="1" col="10" text="소계"/>
                                <Cell row="1" col="11" text="정상"/>
                                <Cell row="1" col="12" text="미확인"/>
                                <Cell row="1" col="13" text="조기퇴근"/>
                                <Cell row="1" col="14" text="소계"/>
                                <Cell row="1" col="15" text="연차"/>
                                <Cell row="1" col="16" text="공가"/>
                                <Cell row="1" col="17" text="병가"/>
                                <Cell row="1" col="18" text="포상"/>
                                <Cell row="1" col="19" text="안식"/>
                                <Cell row="1" col="20" text="대체"/>
                                <Cell row="1" col="21" text="휴직"/>
                                <Cell row="1" col="22" text="청원"/>
                                <Cell row="1" col="23" text="출산"/>
                                <Cell row="1" col="24" text="장기"/>
                                <Cell row="1" col="25" text="결근"/>
                                <Cell row="1" col="26" text="조퇴"/>
                              </Band>
                              <Band id="body">
                                <Cell text="bind:DEPT_NM"/>
                                <Cell col="1" displaytype="number" text="bind:SUM"/>
                                <Cell col="2" displaytype="number" text="bind:WORK_SE_1"/>
                                <Cell col="3" displaytype="number" text="bind:WORK_SE_2"/>
                                <Cell col="4" displaytype="number" text="bind:WORK_SE_3"/>
                                <Cell col="5" displaytype="number" text="bind:WORK_SE_4"/>
                                <Cell col="6" displaytype="number" text="bind:SUB_SUM_1"/>
                                <Cell col="7" displaytype="number" text="bind:ATTEND_SE_1"/>
                                <Cell col="8" displaytype="number" text="bind:ATTEND_SE_2"/>
                                <Cell col="9" displaytype="number" text="bind:ATTEND_SE_3"/>
                                <Cell col="10" displaytype="number" text="bind:SUB_SUM_2"/>
                                <Cell col="11" displaytype="number" text="bind:LVFFC_TM_SE_1"/>
                                <Cell col="12" displaytype="number" text="bind:LVFFC_TM_SE_2"/>
                                <Cell col="13" displaytype="number" text="bind:LVFFC_TM_SE_3"/>
                                <Cell col="14" displaytype="number" text="bind:SUB_SUM_3"/>
                                <Cell col="15" displaytype="number" text="bind:DCLZ_SE_1"/>
                                <Cell col="16" displaytype="number" text="bind:DCLZ_SE_2"/>
                                <Cell col="17" displaytype="number" text="bind:DCLZ_SE_3"/>
                                <Cell col="18" displaytype="number" text="bind:DCLZ_SE_4"/>
                                <Cell col="19" displaytype="number" text="bind:DCLZ_SE_5"/>
                                <Cell col="20" displaytype="number" text="bind:DCLZ_SE_6"/>
                                <Cell col="21" displaytype="number" text="bind:DCLZ_SE_7"/>
                                <Cell col="22" displaytype="number" text="bind:DCLZ_SE_8"/>
                                <Cell col="23" displaytype="number" text="bind:DCLZ_SE_9"/>
                                <Cell col="24" displaytype="number" text="bind:DCLZ_SE_10"/>
                                <Cell col="25" displaytype="number" text="bind:DCLZ_SE_11"/>
                                <Cell col="26" displaytype="number" text="bind:DCLZ_SE_12"/>
                                <Cell col="27" displaytype="number" text="bind:BSRP_PURPS"/>
                                <Cell col="28" displaytype="number" text="bind:EDC_NM"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                        <Static id="Static36" taborder="3" text="5" visible="false" left="0" top="0" width="1031" height="5" style="background:#dc143c3c;align:center middle;"/>
                        <Static id="Static00" taborder="4" text="5" visible="false" left="0" top="190" width="1031" height="5" style="background:#dc143c3c;align:center middle;"/>
                        <Grid id="Grid02" taborder="2" useinputpanel="false" left="1" top="385" right="1" bottom="1" autoenter="select" autofittype="col" binddataset="ds_dayDclzList">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="80"/>
                                <Column size="80"/>
                                <Column size="90"/>
                                <Column size="60"/>
                                <Column size="60"/>
                                <Column size="60"/>
                                <Column size="60"/>
                                <Column size="60"/>
                                <Column size="60"/>
                                <Column size="60"/>
                                <Column size="60"/>
                                <Column size="60"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                              </Rows>
                              <Band id="head">
                                <Cell colspan="2" text="구분"/>
                                <Cell col="2"/>
                                <Cell col="3" colspan="3" text="출근"/>
                                <Cell col="6" colspan="3" text="퇴근"/>
                                <Cell col="9" colspan="3" text="근무상황"/>
                                <Cell row="1" text="사번"/>
                                <Cell row="1" col="1" text="성명"/>
                                <Cell row="1" col="2" text="일자"/>
                                <Cell row="1" col="3" text="구분"/>
                                <Cell row="1" col="4" text="출근시간"/>
                                <Cell row="1" col="5" text="유연근무"/>
                                <Cell row="1" col="6" text="구분"/>
                                <Cell row="1" col="7" text="퇴근시간"/>
                                <Cell row="1" col="8" text="유연근무"/>
                                <Cell row="1" col="9" text="근무상황"/>
                                <Cell row="1" col="10" text="출장"/>
                                <Cell row="1" col="11" text="교육"/>
                              </Band>
                              <Band id="body">
                                <Cell text="bind:EMPNO" suppress="1" suppressalign="middle"/>
                                <Cell col="1" text="bind:EMPNM" suppress="2" suppressalign="middle"/>
                                <Cell col="2" displaytype="date" text="bind:WORK_DE"/>
                                <Cell col="3" displaytype="combo" text="bind:ATTEND_TM_RE" combodataset="ds_attendSe" combocodecol="CODE" combodatacol="CODE_NM"/>
                                <Cell col="4" text="bind:ATTEND_TM"/>
                                <Cell col="5" text="bind:F_ATTEND_TM"/>
                                <Cell col="6" displaytype="combo" text="bind:LVFFC_TM_RE" combodataset="ds_lvffcSe" combocodecol="CODE" combodatacol="CODE_NM"/>
                                <Cell col="7" text="bind:LVFFC_TM"/>
                                <Cell col="8" text="bind:F_LVFFC_TM"/>
                                <Cell col="9" displaytype="combo" text="bind:DCLZ_SE" combodataset="ds_dclzSe" combocodecol="CODE" combodatacol="CODE_NM"/>
                                <Cell col="10" text="bind:BSRP_PURPS"/>
                                <Cell col="11" text="bind:EDC_NM"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                        <Static id="Static01" taborder="5" text="5" visible="false" left="0" top="380" width="1031" height="5" style="background:#dc143c3c;align:center middle;"/>
                        <Grid id="Grid01" taborder="1" useinputpanel="false" left="1" top="195" height="185" right="1" autoenter="select" autofittype="col" binddataset="ds_empDclzList">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="100"/>
                                <Column size="80"/>
                                <Column size="80"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="34"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                              </Rows>
                              <Band id="head">
                                <Cell colspan="3" text="구분"/>
                                <Cell col="3" colspan="5" text="인원"/>
                                <Cell col="8" colspan="4" text="출근"/>
                                <Cell col="12" colspan="4" text="퇴근"/>
                                <Cell col="16" colspan="13" text="근무상황"/>
                                <Cell col="29" rowspan="2" text="출장"/>
                                <Cell col="30" rowspan="2" text="교육"/>
                                <Cell row="1" text="소속"/>
                                <Cell row="1" col="1" text="사번"/>
                                <Cell row="1" col="2" text="성명"/>
                                <Cell row="1" col="3" text="계"/>
                                <Cell row="1" col="4" text="정상"/>
                                <Cell row="1" col="5" text="유연"/>
                                <Cell row="1" col="6" text="현장"/>
                                <Cell row="1" col="7" text="기타"/>
                                <Cell row="1" col="8" text="소계"/>
                                <Cell row="1" col="9" text="정상"/>
                                <Cell row="1" col="10" text="미확인"/>
                                <Cell row="1" col="11" text="지각"/>
                                <Cell row="1" col="12" text="소계"/>
                                <Cell row="1" col="13" text="정상"/>
                                <Cell row="1" col="14" text="미확인"/>
                                <Cell row="1" col="15" text="조기퇴근"/>
                                <Cell row="1" col="16" text="소계"/>
                                <Cell row="1" col="17" text="연차"/>
                                <Cell row="1" col="18" text="공가"/>
                                <Cell row="1" col="19" text="병가"/>
                                <Cell row="1" col="20" text="포상"/>
                                <Cell row="1" col="21" text="안식"/>
                                <Cell row="1" col="22" text="대체"/>
                                <Cell row="1" col="23" text="휴직"/>
                                <Cell row="1" col="24" text="청원"/>
                                <Cell row="1" col="25" text="출산"/>
                                <Cell row="1" col="26" text="장기"/>
                                <Cell row="1" col="27" text="결근"/>
                                <Cell row="1" col="28" text="조퇴"/>
                              </Band>
                              <Band id="body">
                                <Cell text="bind:DEPT_NM" suppress="1" suppressalign="middle"/>
                                <Cell col="1" text="bind:EMPNO"/>
                                <Cell col="2" text="bind:EMPNM"/>
                                <Cell col="3" displaytype="number" text="bind:SUM"/>
                                <Cell col="4" displaytype="number" text="bind:WORK_SE_1"/>
                                <Cell col="5" displaytype="number" text="bind:WORK_SE_2"/>
                                <Cell col="6" displaytype="number" text="bind:WORK_SE_3"/>
                                <Cell col="7" displaytype="number" text="bind:WORK_SE_4"/>
                                <Cell col="8" displaytype="number" text="bind:SUB_SUM_1"/>
                                <Cell col="9" displaytype="number" text="bind:ATTEND_SE_1"/>
                                <Cell col="10" displaytype="number" text="bind:ATTEND_SE_2"/>
                                <Cell col="11" displaytype="number" text="bind:ATTEND_SE_3"/>
                                <Cell col="12" displaytype="number" text="bind:SUB_SUM_2"/>
                                <Cell col="13" displaytype="number" text="bind:LVFFC_SE_1"/>
                                <Cell col="14" displaytype="number" text="bind:LVFFC_SE_2"/>
                                <Cell col="15" displaytype="number" text="bind:LVFFC_SE_3"/>
                                <Cell col="16" displaytype="number" text="bind:SUB_SUM_3"/>
                                <Cell col="17" displaytype="number" text="bind:DCLZ_SE_1"/>
                                <Cell col="18" displaytype="number" text="bind:DCLZ_SE_2"/>
                                <Cell col="19" displaytype="number" text="bind:DCLZ_SE_3"/>
                                <Cell col="20" displaytype="number" text="bind:DCLZ_SE_4"/>
                                <Cell col="21" displaytype="number" text="bind:DCLZ_SE_5"/>
                                <Cell col="22" displaytype="number" text="bind:DCLZ_SE_6"/>
                                <Cell col="23" displaytype="number" text="bind:DCLZ_SE_7"/>
                                <Cell col="24" displaytype="number" text="bind:DCLZ_SE_8"/>
                                <Cell col="25" displaytype="number" text="bind:DCLZ_SE_9"/>
                                <Cell col="26" displaytype="number" text="bind:DCLZ_SE_10"/>
                                <Cell col="27" displaytype="number" text="bind:DCLZ_SE_11"/>
                                <Cell col="28" displaytype="number" text="bind:DCLZ_SE_12"/>
                                <Cell col="29" displaytype="number" text="bind:BSRP_PURPS"/>
                                <Cell col="30" displaytype="number" text="bind:EDC_NM"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="T02" text="근태현황_기타">
                    <Layouts>
                      <Layout>
                        <Grid id="Grid00" taborder="0" useinputpanel="false" left="1" top="5" right="1" bottom="1" autofittype="col" autoenter="select" binddataset="ds_etcDclzList">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="120"/>
                                <Column size="60"/>
                                <Column size="60"/>
                                <Column size="60"/>
                                <Column size="60"/>
                                <Column size="60"/>
                                <Column size="60"/>
                                <Column size="60"/>
                                <Column size="60"/>
                                <Column size="60"/>
                                <Column size="60"/>
                                <Column size="60"/>
                                <Column size="60"/>
                                <Column size="60"/>
                                <Column size="60"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                              </Rows>
                              <Band id="head">
                                <Cell text="구분"/>
                                <Cell col="1" colspan="2" text="출장"/>
                                <Cell col="3" colspan="2" text="휴가"/>
                                <Cell col="5" colspan="2" text="교육"/>
                                <Cell col="7" colspan="2" text="지각"/>
                                <Cell col="9" colspan="2" text="출근미확인"/>
                                <Cell col="11" colspan="2" text="조기퇴근"/>
                                <Cell col="13" colspan="2" text="퇴근미확인"/>
                                <Cell row="1" text="소속"/>
                                <Cell row="1" col="1" text="일수"/>
                                <Cell row="1" col="2" text="인원"/>
                                <Cell row="1" col="3" text="일수"/>
                                <Cell row="1" col="4" text="인원"/>
                                <Cell row="1" col="5" text="일수"/>
                                <Cell row="1" col="6" text="인원"/>
                                <Cell row="1" col="7" text="일수"/>
                                <Cell row="1" col="8" text="인원"/>
                                <Cell row="1" col="9" text="일수"/>
                                <Cell row="1" col="10" text="인원"/>
                                <Cell row="1" col="11" text="일수"/>
                                <Cell row="1" col="12" text="인원"/>
                                <Cell row="1" col="13" text="일수"/>
                                <Cell row="1" col="14" text="인원"/>
                              </Band>
                              <Band id="body">
                                <Cell text="bind:DEPT_NM"/>
                                <Cell col="1" text="bind:BSRP_PURPS_DAYCNT"/>
                                <Cell col="2" text="bind:BSRP_PURPS_PECNT"/>
                                <Cell col="3" text="bind:DCLZ_SE_DAYCNT"/>
                                <Cell col="4" text="bind:DCLZ_SE_PECNT"/>
                                <Cell col="5" text="bind:EDC_DAYCNT"/>
                                <Cell col="6" text="bind:EDC_PECNT"/>
                                <Cell col="7" text="bind:ATTEND_SE_3_DAYCNT"/>
                                <Cell col="8" text="bind:ATTEND_SE_3_PECNT"/>
                                <Cell col="9" text="bind:ATTEND_SE_2_DAYCNT"/>
                                <Cell col="10" text="bind:ATTEND_SE_2_PECNT"/>
                                <Cell col="11" text="bind:LVFFC_TM_SE_3_DAYCNT"/>
                                <Cell col="12" text="bind:LVFFC_TM_SE_3_PECNT"/>
                                <Cell col="13" text="bind:LVFFC_TM_SE_2_DAYCNT"/>
                                <Cell col="14" text="bind:LVFFC_TM_SE_2_PECNT"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                </Tabpages>
              </Tab>
              <Button id="btn_excel" taborder="18" onclick="btn_excel_onclick" cssclass="btn_WF_Gridexceldn" top="14" right="6" width="25" height="19"/>
            </Layout>
          </Layouts>
        </Div>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_deptDclzList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_deptDclzList_onrowposchanged">
        <ColumnInfo>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="SUM" type="STRING" size="256"/>
          <Column id="WORK_SE_1" type="STRING" size="256"/>
          <Column id="WORK_SE_2" type="STRING" size="256"/>
          <Column id="WORK_SE_3" type="STRING" size="256"/>
          <Column id="WORK_SE_4" type="STRING" size="256"/>
          <Column id="SUB_SUM_1" type="STRING" size="256"/>
          <Column id="ATTEND_SE_1" type="STRING" size="256"/>
          <Column id="ATTEND_SE_2" type="STRING" size="256"/>
          <Column id="ATTEND_SE_3" type="STRING" size="256"/>
          <Column id="SUB_SUM_2" type="STRING" size="256"/>
          <Column id="LVFFC_TM_SE_1" type="STRING" size="256"/>
          <Column id="LVFFC_TM_SE_2" type="STRING" size="256"/>
          <Column id="LVFFC_TM_SE_3" type="STRING" size="256"/>
          <Column id="SUB_SUM_3" type="STRING" size="256"/>
          <Column id="DCLZ_SE_1" type="STRING" size="256"/>
          <Column id="DCLZ_SE_2" type="STRING" size="256"/>
          <Column id="DCLZ_SE_3" type="STRING" size="256"/>
          <Column id="DCLZ_SE_4" type="STRING" size="256"/>
          <Column id="DCLZ_SE_5" type="STRING" size="256"/>
          <Column id="DCLZ_SE_6" type="STRING" size="256"/>
          <Column id="DCLZ_SE_7" type="STRING" size="256"/>
          <Column id="DCLZ_SE_8" type="STRING" size="256"/>
          <Column id="DCLZ_SE_9" type="STRING" size="256"/>
          <Column id="DCLZ_SE_10" type="STRING" size="256"/>
          <Column id="DCLZ_SE_11" type="STRING" size="256"/>
          <Column id="DCLZ_SE_12" type="STRING" size="256"/>
          <Column id="BSRP_PURPS" type="STRING" size="256"/>
          <Column id="EDC_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_empDclzList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_empDclzList_onrowposchanged">
        <ColumnInfo>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="EMPNO" type="STRING" size="256"/>
          <Column id="EMPNM" type="STRING" size="256"/>
          <Column id="SUM" type="STRING" size="256"/>
          <Column id="WORK_SE_1" type="STRING" size="256"/>
          <Column id="WORK_SE_2" type="STRING" size="256"/>
          <Column id="WORK_SE_3" type="STRING" size="256"/>
          <Column id="WORK_SE_4" type="STRING" size="256"/>
          <Column id="SUB_SUM_1" type="STRING" size="256"/>
          <Column id="ATTEND_SE_1" type="STRING" size="256"/>
          <Column id="ATTEND_SE_2" type="STRING" size="256"/>
          <Column id="ATTEND_SE_3" type="STRING" size="256"/>
          <Column id="SUB_SUM_2" type="STRING" size="256"/>
          <Column id="LVFFC_SE_1" type="STRING" size="256"/>
          <Column id="LVFFC_SE_2" type="STRING" size="256"/>
          <Column id="LVFFC_SE_3" type="STRING" size="256"/>
          <Column id="SUB_SUM_3" type="STRING" size="256"/>
          <Column id="DCLZ_SE_1" type="STRING" size="256"/>
          <Column id="DCLZ_SE_2" type="STRING" size="256"/>
          <Column id="DCLZ_SE_3" type="STRING" size="256"/>
          <Column id="DCLZ_SE_4" type="STRING" size="256"/>
          <Column id="DCLZ_SE_5" type="STRING" size="256"/>
          <Column id="DCLZ_SE_6" type="STRING" size="256"/>
          <Column id="DCLZ_SE_7" type="STRING" size="256"/>
          <Column id="DCLZ_SE_8" type="STRING" size="256"/>
          <Column id="DCLZ_SE_9" type="STRING" size="256"/>
          <Column id="DCLZ_SE_10" type="STRING" size="256"/>
          <Column id="DCLZ_SE_11" type="STRING" size="256"/>
          <Column id="DCLZ_SE_12" type="STRING" size="256"/>
          <Column id="BSRP_PURPS" type="STRING" size="256"/>
          <Column id="EDC_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_dayDclzList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="WORK_DE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="EMPNO" type="STRING" size="256"/>
          <Column id="EMPNM" type="STRING" size="256"/>
          <Column id="ATTEND_TM_RE" type="STRING" size="256"/>
          <Column id="ATTEND_TM" type="STRING" size="256"/>
          <Column id="F_ATTEND_TM" type="STRING" size="256"/>
          <Column id="LVFFC_TM_RE" type="STRING" size="256"/>
          <Column id="LVFFC_TM" type="STRING" size="256"/>
          <Column id="F_LVFFC_TM" type="STRING" size="256"/>
          <Column id="FLXWK_AT" type="STRING" size="256"/>
          <Column id="DCLZ_SE" type="STRING" size="256"/>
          <Column id="BSRP_PURPS" type="STRING" size="256"/>
          <Column id="EDC_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_etcDclzList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="BSRP_PURPS_DAYCNT" type="STRING" size="256"/>
          <Column id="BSRP_PURPS_PECNT" type="STRING" size="256"/>
          <Column id="DCLZ_SE_DAYCNT" type="STRING" size="256"/>
          <Column id="DCLZ_SE_PECNT" type="STRING" size="256"/>
          <Column id="EDC_DAYCNT" type="STRING" size="256"/>
          <Column id="EDC_PECNT" type="STRING" size="256"/>
          <Column id="ATTEND_SE_3_DAYCNT" type="STRING" size="256"/>
          <Column id="ATTEND_SE_3_PECNT" type="STRING" size="256"/>
          <Column id="ATTEND_SE_2_DAYCNT" type="STRING" size="256"/>
          <Column id="ATTEND_SE_2_PECNT" type="STRING" size="256"/>
          <Column id="LVFFC_TM_SE_3_DAYCNT" type="STRING" size="256"/>
          <Column id="LVFFC_TM_SE_3_PECNT" type="STRING" size="256"/>
          <Column id="LVFFC_TM_SE_2_DAYCNT" type="STRING" size="256"/>
          <Column id="LVFFC_TM_SE_2_PECNT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" cancolumnchange="ds_cond_cancolumnchange">
        <ColumnInfo>
          <Column id="STDR_BGN_DE" type="STRING" size="256"/>
          <Column id="STDR_END_DE" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond2" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="EMPNO" type="STRING" size="256"/>
          <Column id="STDR_BGN_DE" type="STRING" size="256"/>
          <Column id="STDR_END_DE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_dclzSe" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_attendSe" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">1</Col>
            <Col id="CODE_NM">정상</Col>
          </Row>
          <Row>
            <Col id="CODE">2</Col>
            <Col id="CODE_NM">지각</Col>
          </Row>
          <Row>
            <Col id="CODE">3</Col>
            <Col id="CODE_NM">미확인</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_lvffcSe" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">1</Col>
            <Col id="CODE_NM">정상</Col>
          </Row>
          <Row>
            <Col id="CODE">2</Col>
            <Col id="CODE_NM">조기퇴근</Col>
          </Row>
          <Row>
            <Col id="CODE">3</Col>
            <Col id="CODE_NM">미확인</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item0" compid="div_search.cal_searchBgnDe" propid="value" datasetid="ds_cond" columnid="STDR_BGN_DE"/>
      <BindItem id="item1" compid="div_search.cal_searchEndDe" propid="value" datasetid="ds_cond" columnid="STDR_END_DE"/>
    </Bind>
    <Script type="xscript5.0"><![CDATA[/***********************************************************************
 * 화면ID    : HRM070109.xfdl
 * 화면명    : 부서별 근태현황
 * 화면설명  : 부서별 근태현황(일반, 기타) 목록을 조회한다.
 * 작성일    : 2015.12.16
 * 작성자    : 이지영
 * 수정이력  : 
 ***********************************************************************
 *     수정일     수정자   내용
 ***********************************************************************
 *    
 ***********************************************************************/

/***********************************************************************
 * Script Include 
 ***********************************************************************/
include "lib::comInclude.xjs";
include "mis_lib::misUtil.xjs";

/***********************************************************************
* 화면 변수 선언부
***********************************************************************/
this.checkDs = [
  this.ds_deptDclzList
 ,this.ds_empDclzList 
 ,this.ds_dayDclzList
 ,this.ds_etcDclzList
];

/***********************************************************************
* onInit 영역
***********************************************************************/
this.HRM070109_oninit = function(obj:Form, e:nexacro.InitEventInfo)
{	
	// Form 초기화
	this.fn_init_form();

	// DataSet 초기화
	this.fn_init_dataset();	
}
/***********************************************************************
 * onLoad 영역
 ***********************************************************************/
this.HRM070109_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{ 	
	//this.fn_search();
}

/**********************************************************************
* Form 오브젝트 초기화
***********************************************************************/
this.fn_init_form = function()
{
	this.gfn_initForm(this);	// 시스템 공통으로 Form을 Initialize 한다.
	this.fn_misFormInit(this);
	this.ds_cond.clearData();
	this.ds_cond.addRow();		
	this.div_search.div_deptCode.fn_setBind("ds_cond","DEPT_CODE","DEPT_NM");
	this.ds_cond.setColumn(0, "STDR_BGN_DE", this.gfn_today().substring(0,6)+'01');
	this.ds_cond.setColumn(0, "STDR_END_DE", this.gfn_today());
	// 공통코드
	var comboParams = [["ds_dclzSe",   "SAL009", "1", ""],//근태구분
		              ];
		              
	var callback = function (svcId, errorCode, errorMsg) {
		this.fn_search();
	};
	this.gfn_comboLoad (comboParams, callback);

}


/**********************************************************************
* dataset 오브젝트 초기화
***********************************************************************/
this.fn_init_dataset = function()
{
	
}

/***********************************************************************
* 상단 조회처리
************************************************************************/
this.fn_search = function()
{	
 	if(this.div_work.HRM070109.tabindex == 0)
 	{
 		this.fn_transaction("selectdeptDclzList");
 	}else{
 		this.fn_transaction("selectEtcDclzList");
 	}
}

/**********************************************************************
 * CALL TRANSACTION 영역
 **********************************************************************/ 
this.fn_transaction = function(strSvcId)
{
	switch (strSvcId) {
		//근태현황_일반(부서별) 목록 조회
		case "selectdeptDclzList":
			this.ds_deptDclzList.clearData();			
			var sController   	= "hsco/mis/hrm/HRM070109/selectdeptDclzList.do";
			var sInDatasets   	= "input01=ds_cond";
			var sOutDatasets  	= "ds_deptDclzList=output01";
		break;	
		
		//근태현황_일반(사원별) 목록 조회
		case "selectEmpDclzList":
			this.ds_empDclzList.clearData();
			this.ds_cond2.clearData();
			this.ds_cond2.addRow();
			this.ds_cond2.setColumn(0, "DEPT_CODE", this.ds_deptDclzList.getColumn(this.ds_deptDclzList.rowposition, "DEPT_CODE"));
			this.ds_cond2.setColumn(0, "STDR_BGN_DE", this.ds_cond.getColumn(0, "STDR_BGN_DE"));
			this.ds_cond2.setColumn(0, "STDR_END_DE", this.ds_cond.getColumn(0, "STDR_END_DE"));
			var sController   	= "hsco/mis/hrm/HRM070109/selectEmpDclzList.do";
			var sInDatasets   	= "input02=ds_cond2";
			var sOutDatasets  	= "ds_empDclzList=output02";
		break;	
				
		//근태현황_일반(일자별) 목록 조회
		case "selectDayDclzList":
			this.ds_dayDclzList.clearData();
			this.ds_cond2.clearData();
			this.ds_cond2.addRow();
			this.ds_cond2.setColumn(0, "STDR_BGN_DE", this.ds_cond.getColumn(0, "STDR_BGN_DE"));
			this.ds_cond2.setColumn(0, "STDR_END_DE", this.ds_cond.getColumn(0, "STDR_END_DE"));
			this.ds_cond2.setColumn(0, "EMPNO",       this.ds_empDclzList.getColumn(this.ds_empDclzList.rowposition, "EMPNO"));
			var sController   	= "hsco/mis/hrm/HRM070109/selectDayDclzList.do";
			var sInDatasets   	= "input03=ds_cond2";
			var sOutDatasets  	= "ds_dayDclzList=output03";
		break;	
			
		//근태현황_기타 목록 조회
		case "selectEtcDclzList":
			this.ds_etcDclzList.clearData();
			var sController   	= "hsco/mis/hrm/HRM070109/selectEtcDclzList.do";
			var sInDatasets   	= "input04=ds_cond";
			var sOutDatasets  	= "ds_etcDclzList=output04";
		break;
	}
	var sArgs = "";	
	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets, sArgs); 
}

 /**********************************************************************
 * Transaction Callback 영역
 ***********************************************************************/ 
this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg)
{
	if (nErrorCode != 0){
		this.gfn_callback_message(strSvcId, nErrorCode, strErrorMsg);	
	} else {		
		switch (strSvcId) {
			//근태현황_일반 목록 조회 콜백 
			case "selectdeptDclzList":
				if(this.ds_deptDclzList.getRowCount() == 0) {
					this.gfn_message("info.데이터.없음");
				}
			break;
			
			//근태현황_기타 목록 조회 콜백 
			case "selectEtcDclzList":
				if(this.ds_etcDclzList.getRowCount() == 0) {
					this.gfn_message("info.데이터.없음");
				}
			break;
		}
	}
}

/**********************************************************************
 * 조회기간 변경 시 
 ***********************************************************************/ 
this.ds_cond_cancolumnchange = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	if(e.columnid == "BGNDE")
	{
		if(e.newvalue > this.div_search.cal_searchEndDe.value) 
		{
			this.gfn_message("errors.시작일자.종료일자.이하","|");
			return false;
		}
		return true;
	}
	//종료일 변경시
	if(e.columnid == "ENDDE")
	{
		if(e.newvalue < this.div_search.cal_searchBgnDe.value) 
		{
			this.gfn_message("errors.종료일자.시작일자.이상","|");
			return false;
		}
		return true;

	}
}

/******************************************************************************
 * grid1 (부서별 근태현황[일반] 부서별 목록 행 변경 시 사원별 목록 조회
*******************************************************************************/
this.ds_deptDclzList_onrowposchanged = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{
	this.fn_transaction("selectEmpDclzList");
}
/******************************************************************************
 * grid2 (부서별 근태현황[일반] 사원별 목록 행 변경 시 일자별 목록 조회 
*******************************************************************************/
this.ds_empDclzList_onrowposchanged = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{
	this.fn_transaction("selectDayDclzList");
}

/******************************************************************************
 * 탭 인덱스 변경 시 
*******************************************************************************/
this.div_work_HRM070109_onchanged = function(obj:Tab, e:nexacro.TabIndexChangeEventInfo)
{
	this.fn_search();
}


this.btn_excel_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.gfn_exportExcel(this.div_work.HRM070109.T01.Grid00, "exportExl_1");
	this.gfn_exportExcel(this.div_work.HRM070109.T01.Grid01, "exportExl_2");
	this.gfn_exportExcel(this.div_work.HRM070109.T01.Grid02, "exportExl_3");
	this.gfn_exportExcel(this.div_work.HRM070109.T02.Grid00, "exportExl_4");
}
]]></Script>
  </Form>
</FDL>
