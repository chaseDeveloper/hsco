<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\default_typedef.xml"/>
  <Form id="HRM070118_P1" classname="HRM070118_P1" left="0" top="0" width="466" height="425" titletext="보상휴가신청" onload="HRM070118_P1_onload">
    <Layouts>
      <Layout>
        <Static id="sta_backgroundLabel00" taborder="63" cssclass="sta_WF_Labelbg" top="222" right="15" width="352" height="27"/>
        <Static id="Static06" taborder="6" text="15" visible="false" left="15" top="0" height="15" style="background:#dc143c3c;align:center middle;" right="15"/>
        <Static id="Static12" taborder="12" text="5" visible="false" left="15" top="61" height="5" style="background:#dc143c3c;align:center middle;" right="15"/>
        <Static id="Static03" taborder="19" text="15" visible="false" left="15" height="15" style="background:#dc143c3c;align:center middle;" right="15" bottom="0"/>
        <Static id="Static02" taborder="21" text="15" visible="false" top="0" style="background:#1b3cd23c;align:center middle;" bottom="0" left="0" width="15"/>
        <Static id="Static00" taborder="22" text="15" visible="false" top="0" style="background:#1b3cd23c;align:center middle;" width="15" bottom="0" right="0"/>
        <Static id="sta_REGIST_NM00" taborder="25" text="신청자" cssclass="sta_WF_Title02" left="17" top="46" height="21" style="font:bold 9 Gulim;" right="361"/>
        <Static id="sta_DETAIL00" taborder="23" text="상세내용" cssclass="sta_WF_Title02" left="17" top="124" height="21" style="align:left middle;font:bold 9 Gulim;" right="362"/>
        <Static id="Static01" taborder="24" text="10" visible="false" left="15" top="118" height="10" style="background:#dc143c3c;align:center middle;" right="15"/>
        <Static id="sta_WFDA_Label01" taborder="26" cssclass="sta_WF_Labelbg" top="65" height="27" width="352" right="15"/>
        <Edit id="edt_EMPNO" taborder="27" readonly="true" cssclass="edt_WF_Readonly" left="110" top="68" width="111" height="21"/>
        <Edit id="edt_EMPNM" taborder="28" readonly="true" cssclass="edt_WF_Readonly" left="223" top="68" width="137" height="21"/>
        <Button id="btn_Vrsc_man_search00" taborder="30" onclick="div_detail00_btn_Vrsc_man_search_onclick" top="72" height="13" style="background:URL('theme://images\btn_WF_Search.png');border:0 solid #8d8d8dff ;cursor:default;" left="345" width="13"/>
        <Static id="Static04" taborder="31" text="5" visible="false" left="15" top="139" height="5" style="background:#dc143c3c;align:center middle;" right="15"/>
        <Static id="sta_backgroundLabel04" taborder="32" cssclass="sta_WF_Labelbg" top="144" height="27" width="352" right="15"/>
        <Static id="sta_backgroundLabel03" taborder="33" cssclass="sta_WF_Labelbg" height="27" width="352" right="15" top="170"/>
        <Static id="sta_backgroundLabel08" taborder="34" cssclass="sta_WF_Labelbg" height="0px" width="0px" top="0px" left="0px"/>
        <Static id="sta_APYEXM_NO01" taborder="39" text="사유/용무" cssclass="sta_WF_Label" left="15" width="93" height="27" style="padding:0 4 0 12;align:right middle;font:9 Dotum;" top="222"/>
        <Edit id="edt_PRVONSH" taborder="40" lengthunit="ascii" maxlength="200" left="110" width="336" height="21" top="225"/>
        <Calendar id="cal_BGNDE" taborder="41" dateformat="yyyy-MM-dd" cssclass="cal_WF_Essential" left="110" width="117" height="21" style="align:center middle;" top="173"/>
        <Static id="sta_empTitle11" taborder="43" text="시작일" cssclass="sta_WF_Label" left="15" width="93" height="27" style="padding:0 4 0 12;align:right middle;font:9 Dotum;" top="170"/>
        <Combo id="cmb_ASORT_CODE" taborder="42" innerdataset="@ds_hrm029" codecolumn="CODE" datacolumn="CODE_NM" cssclass="cmb_WF_Essential" left="329" top="147" width="117" height="21" index="-1"/>
        <Static id="sta_empTitle10" taborder="44" text="시작시각" cssclass="sta_WF_Label" left="234" width="93" height="27" style="padding:0 4 0 12;align:right middle;font:9 Dotum;" top="170"/>
        <Static id="sta_empTitle03" taborder="45" text="보상휴가구분" cssclass="sta_WF_Label" left="234" top="144" width="93" height="27" style="padding:0 4 0 12;align:right middle;font:9 Dotum;"/>
        <Static id="sta_backgroundLabel01" taborder="46" cssclass="sta_WF_Labelbg" height="27" width="352" right="15" top="196"/>
        <Static id="sta_empTitle00" taborder="47" text="종료시각" cssclass="sta_WF_Label" left="234" width="93" height="27" style="padding:0 4 0 12;align:right middle;font:9 Dotum;" top="196"/>
        <Static id="sta_empTitle06" taborder="48" text="종료일" cssclass="sta_WF_Label" left="15" width="93" height="27" style="padding:0 4 0 12;align:right middle;font:9 Dotum;" top="196"/>
        <Calendar id="cal_ENDDE" taborder="49" dateformat="yyyy-MM-dd" cssclass="msk_WF_Readonly" left="110" width="117" height="21" style="align:center middle;" readonly="true" top="199"/>
        <MaskEdit id="msk_BEGIN_TM" taborder="50" type="string" mask="##:##" width="71" height="21" style="align:center middle;" left="329" cssclass="msk_WF_Readonly" readonly="true" top="173"/>
        <MaskEdit id="msk_END_TM" taborder="51" type="string" mask="##:##" cssclass="msk_WF_Readonly" width="71" height="21" style="align:center middle;" left="329" readonly="true" top="199"/>
        <Static id="Static10" taborder="54" text="10" visible="false" left="15" top="40" right="15" height="10" style="background:#dc143c3c;align:center middle;"/>
        <Button id="btn_Save" taborder="55" text="저장" onclick="fn_save" cssclass="btn_WF_CRUD" top="15" right="67" width="50" height="25" style="background:#4563a1ff;border:1 solid #2d4d8eff ;bordertype:round 2 2 ;font:bold 9 Gulim;" userdata="A:T;"/>
        <Button id="btn_Close" taborder="56" text="닫기" onclick="btn_Close_onclick" cssclass="btn_WF_CRUD" top="15" right="15" width="50" height="25" style="background:#4563a1ff;border:1 solid #2d4d8eff ;bordertype:round 2 2 ;font:bold 9 Gulim;gradation:linear 0,0 #f4f4f4ff 0,100 #e2e7edff;" userdata="A:T;"/>
        <Static id="sta_title" taborder="57" text="보상휴가 신청" cssclass="sta_WF_Title01" left="17" top="17" width="197" height="21"/>
        <Static id="sta_WFDA_Label00" taborder="62" cssclass="sta_WF_Labelbg" top="91" right="15" width="352" height="27"/>
        <MaskEdit id="msk_OVTIME_REMNDR" taborder="64" readonly="true" type="string" mask="##:##" cssclass="rdo_WF_Essential" left="110" top="94" width="71" height="21" style="color:tomato;align:center middle;"/>
        <Static id="sta_empTitle01" taborder="66" text="신청시간" cssclass="sta_WF_Label" left="15" top="144" width="93" height="27" style="padding:0 4 0 12;align:right middle;font:9 Dotum;"/>
        <Static id="sta_EMP" taborder="29" text="신청자" cssclass="sta_WF_Label" top="65" right="358" width="93" height="27" style="font:9 Dotum;" positionstep="-1"/>
        <Static id="sta_OVTIME_REMNDR" taborder="60" text="시간외근무&#13;&#10;잔여시간" cssclass="sta_WF_Label" top="91" right="358" width="93" height="27" positionstep="-1" style="font:9 Dotum;"/>
        <Radio id="rdo_timeSe" taborder="67" left="110" top="147" width="116" height="21" codecolumn="codecolumn" datacolumn="datacolumn" direction="vertical" cssclass="rdo_WF_Essential">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">1</Col>
                <Col id="datacolumn">3시간</Col>
              </Row>
              <Row>
                <Col id="codecolumn">2</Col>
                <Col id="datacolumn">8시간</Col>
              </Row>
            </Rows>
          </Dataset>
        </Radio>
        <Static id="sta_ACNT_LEVEL" taborder="65" text="- 보상휴가 신청 규정 -&#13;&#10;① 초과근무 사후결재 완료 시간으로 사용.&#13;&#10;② 평일, 토요일, 법정공휴일 초과근무건으로 한정.&#13;&#10;③ 3시간, 8시간 초과근무건으로 한정.&#13;&#10;④ 전환(사용) 방법 :　&#13;&#10;　 (3시간) 4.5시간 오전반차(09:00~14:30) / 오후반차(13:30~18:00) &#13;&#10;　 (8시간) 12시간, 연차(전일14:00~당일18:00) / 연차(당일09:00~후일14:00)" wordwrap="char" onclick="sta_ACNT_LEVEL_onclick" left="22" top="256" width="433" height="154" style="linespace:8;background:transparent;padding:0 0 0 0;align:left middle;"/>
        <Combo id="cmb_SANCTN_STS" taborder="68" innerdataset="ds_com022" codecolumn="CODE" datacolumn="CODE_NM" left="110" top="94" width="83" height="21" cssclass="cmb_WF_Readonly" readonly="true" visible="false"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item0" compid="edt_EMPNO" propid="value" datasetid="ds_wrkcp" columnid="EMPNO"/>
      <BindItem id="item1" compid="edt_EMPNM" propid="value" datasetid="ds_wrkcp" columnid="EMPNM"/>
      <BindItem id="item24" compid="edt_PRVONSH" propid="value" datasetid="ds_wrkcp" columnid="PRVONSH"/>
      <BindItem id="item15" compid="edt_PRVONSH" propid="tooltiptext" datasetid="ds_wrkcp" columnid="PRVONSH"/>
      <BindItem id="item33" compid="cal_BGNDE" propid="value" datasetid="ds_wrkcp" columnid="BGNDE"/>
      <BindItem id="item29" compid="cmb_ASORT_CODE" propid="value" datasetid="ds_wrkcp" columnid="ASORT_CODE"/>
      <BindItem id="item3" compid="cal_ENDDE" propid="value" datasetid="ds_wrkcp" columnid="ENDDE"/>
      <BindItem id="item9" compid="msk_BEGIN_TM" propid="value" datasetid="ds_wrkcp" columnid="BEGIN_TM"/>
      <BindItem id="item2" compid="msk_END_TM" propid="value" datasetid="ds_wrkcp" columnid="END_TM"/>
      <BindItem id="item5" compid="msk_OVTIME_REMNDR" propid="value" datasetid="ds_wrkcp" columnid="OVTIME_REMNDR"/>
      <BindItem id="item4" compid="rdo_timeSe" propid="value" datasetid="ds_wrkcp" columnid="TIME_SE"/>
      <BindItem id="item6" compid="cmb_SANCTN_STS" propid="value" datasetid="ds_wrkcp" columnid="SANCTN_STS"/>
    </Bind>
    <Objects>
      <Dataset id="ds_wrkcp" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_wrkcp_oncolumnchanged" cancolumnchange="ds_wrkcp_cancolumnchange">
        <ColumnInfo>
          <Column id="EMPNO" type="STRING" size="256"/>
          <Column id="EMPNM" type="STRING" size="256"/>
          <Column id="SEQ" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="ASORT_CODE" type="STRING" size="256"/>
          <Column id="BGNDE" type="STRING" size="256"/>
          <Column id="BEGIN_TM" type="STRING" size="256"/>
          <Column id="ENDDE" type="STRING" size="256"/>
          <Column id="END_TM" type="STRING" size="256"/>
          <Column id="DAYCNT" type="STRING" size="256"/>
          <Column id="TIME" type="STRING" size="256"/>
          <Column id="PRVONSH" type="STRING" size="256"/>
          <Column id="FILE_SN" type="STRING" size="256"/>
          <Column id="CNFIRM_AT" type="STRING" size="256"/>
          <Column id="SANCTN_NO" type="STRING" size="256"/>
          <Column id="SANCTN_STS" type="STRING" size="256"/>
          <Column id="REGIST_DT" type="STRING" size="256"/>
          <Column id="OVTIME_REMNDR" type="STRING" size="256"/>
          <Column id="REWARD_SEQ" type="STRING" size="256"/>
          <Column id="WRKCP_SEQ" type="STRING" size="256"/>
          <Column id="OVTMWRK_YM" type="STRING" size="256"/>
          <Column id="OVTMWRK_TM" type="STRING" size="256"/>
          <Column id="TIME_SE" type="STRING" size="256"/>
          <Column id="REWARD_SE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_hrm029" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="GRP_CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="CODE_CN" type="STRING" size="256"/>
          <Column id="CODE_ORDR" type="STRING" size="256"/>
          <Column id="VAL0" type="STRING" size="256"/>
          <Column id="VAL1" type="STRING" size="256"/>
          <Column id="VAL2" type="STRING" size="256"/>
          <Column id="VAL3" type="STRING" size="256"/>
          <Column id="VAL4" type="STRING" size="256"/>
          <Column id="INT_VAL" type="STRING" size="256"/>
          <Column id="MSTK_VAL" type="STRING" size="256"/>
          <Column id="ETC1" type="STRING" size="256"/>
          <Column id="ETC2" type="STRING" size="256"/>
          <Column id="ETC3" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="ALL_CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_validation" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="compId" type="STRING" size="256"/>
          <Column id="colId" type="STRING" size="256"/>
          <Column id="PK" type="STRING" size="256"/>
          <Column id="notNull" type="STRING" size="256"/>
          <Column id="type" type="STRING" size="256"/>
          <Column id="nlength" type="STRING" size="256"/>
          <Column id="from" type="STRING" size="256"/>
          <Column id="to" type="STRING" size="256"/>
          <Column id="lengthChkGb" type="STRING" size="256"/>
          <Column id="msgId" type="STRING" size="256"/>
          <Column id="expr" type="STRING" size="256"/>
          <Column id="func" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="compId">ds_wrkcp</Col>
            <Col id="colId">ASORT_CODE</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">보상휴가구분</Col>
          </Row>
          <Row>
            <Col id="compId">ds_wrkcp</Col>
            <Col id="colId">BGNDE</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">시작일</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_cond" useclientlayout="true">
        <ColumnInfo>
          <Column id="REWARD_SEQ" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_com022" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="GRP_CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="CODE_CN" type="STRING" size="256"/>
          <Column id="CODE_ORDR" type="STRING" size="256"/>
          <Column id="VAL0" type="STRING" size="256"/>
          <Column id="VAL1" type="STRING" size="256"/>
          <Column id="VAL2" type="STRING" size="256"/>
          <Column id="VAL3" type="STRING" size="256"/>
          <Column id="VAL4" type="STRING" size="256"/>
          <Column id="INT_VAL" type="STRING" size="256"/>
          <Column id="MSTK_VAL" type="STRING" size="256"/>
          <Column id="ETC1" type="STRING" size="256"/>
          <Column id="ETC2" type="STRING" size="256"/>
          <Column id="ETC3" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="ALL_CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript5.0"><![CDATA[/***********************************************************************
 * 01. 업무구분 : 보상휴가신청
 * 02. 화면명   : HRM070118_P1.xfdl
 * 03. 화면설명 : 보상휴가신청
 * 04. 작성일   : 2017.05.18
 * 05. 작성자   : 이수지
 ***********************************************************************
 *     수정일     작성자   내용
 ***********************************************************************
 *    2017.05.17   이수지   최초
 ***********************************************************************
 */

/***********************************************************************
 * Script Include 
 ************************************************************************/
include "lib::comInclude.xjs";
include "mis_lib::misUtil.xjs";
this.fv_objForm;


/***********************************************************************
* 폼로드 시 처리
************************************************************************/
this.HRM070118_P1_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{	
	this.fn_loadCombo();
}

/*
 * 함수명  	: fn_loadCombo
 * 설명 		: 화면의 Combo 에 데이터를 불러온다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_loadCombo();
 */
this.fn_loadCombo = function ()
{	
	var comboParams = [ 
		    ["ds_hrm029", "HRM029", "1", ""],   //보상휴가구분
		    ["ds_com022", "COM022", "1", ""],   //전자결재상태
	];
	
	this.gfn_comboLoad(comboParams, this.fn_callbackAfter());
}

/*
 * 함수명  	: fn_callbackAfter
 * 설명 		: 공통 callback
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_callbackAfter();
 */
this.fn_callbackAfter = function ()
{
	this.fv_objForm = this.parent.art_0;
	
	this.ds_wrkcp.clearData();
	this.ds_wrkcp.addRow();
	
	this.ds_wrkcp.setColumn(0,"DEPT_CODE" ,     this.parent.arg_1);
	this.ds_wrkcp.setColumn(0,"DEPT_NM" ,       this.parent.arg_2);
	this.ds_wrkcp.setColumn(0,"EMPNO" ,         this.parent.arg_3);
	this.ds_wrkcp.setColumn(0,"EMPNM" ,         this.parent.arg_4);
	this.ds_wrkcp.setColumn(0,"OVTIME_REMNDR" , this.parent.arg_5);
	this.ds_wrkcp.setColumn(0,"OVTMWRK_YM"    , this.parent.arg_6);
	
	var rewardSeq = this.parent.arg_7;
	if(this.comUtils.isNotNull(rewardSeq)){
		this.ds_cond.clearData();
		this.ds_cond.addRow();
		this.ds_cond.setColumn(0, "REWARD_SEQ"    , rewardSeq);
		this.fn_transaction("selectRewordManage");
	}
	
	this.ds_wrkcp.setColumn(0,"REWARD_SE"     , 1);
	
	if(Number(this.ds_wrkcp.getColumn(0,"OVTIME_REMNDR"))<800){	
		this.ds_hrm029.filter("CODE == '313' || CODE == '314' ");
		this.ds_wrkcp.setColumn(0, "TIME_SE", "1");
		this.rdo_timeSe.set_readonly(true);
		this.rdo_timeSe.set_cssclass("rdo_WF_Readonly");
		this.ds_wrkcp.setColumn(0, "DAYCNT", "0.5");
		this.ds_wrkcp.setColumn(0, "TIME", "0430");
		this.ds_wrkcp.setColumn(0, "OVTMWRK_TM", "0300");
		this.ds_wrkcp.setColumn(0, "ASORT_CODE", "313");
		this.ds_wrkcp.setColumn(0, "BEGIN_TM", "0900");
		this.ds_wrkcp.setColumn(0, "END_TM", "1430");
		this.ds_wrkcp.setColumn(0, "ENDDE", this.ds_wrkcp.getColumn(0, "BGNDE"));
	}else{
		this.ds_hrm029.filter("CODE = ''");
	}
}

/***********************************************************************
 * 설명: 저장버튼 클릭시
 ************************************************************************/
this.fn_save= function()
{	

	// validation 체크
	if(!this.gfn_checkValidation_NoUpdChk(this.ds_wrkcp, this.ds_validation)) {
		return;
	}
	
	
	if(this.gfn_message("comm.행위여부", "근무상황부와 보상휴가계획에 해당데이터를 저장합니다.\n계속")){
		this.fn_transaction("saveRewordManage");
	}
	
}

/***********************************************************************
 * 설명: 닫기
 ************************************************************************/
this.btn_Close_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.close();
}


/**********************************************************************
 * CALL TRANSACTION 영역
 **********************************************************************/ 
/*
 * 함수명  	: fn_transaction
 * 설명 		: Transaction 요청 처리 함수
 * params  		: strSvcId : 서비스요청 ID
 * return Type 	: None
 * 사용법		: this.fn_transaction("SELECT");
 */
this.fn_transaction = function(strSvcId)
{
	switch (strSvcId) {
		case "selectRewordManage":
			var sController   	= "hsco/mis/hrm/HRM070118/selectRewordManage.do";
			var sInDatasets   	= "input1=ds_cond";
			var sOutDatasets  	= "ds_wrkcp=output1";
			break;
		case "saveRewordManage":
			var sController   	= "hsco/mis/hrm/HRM070118/saveRewordManage.do";
			var sInDatasets   	= "input1=ds_wrkcp";
			var sOutDatasets  	= "";
			break;
	}

	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets);
}



/**********************************************************************
* Transaction Callback 영역
***********************************************************************/
 
 /*
 * 함수명  	: fn_callBack
 * 설명 		: Transaction Callback 처리
 * params  		: strSvcId    : 서비스요청 ID
 *                nErrorCode  : 오류 메시지 코드 ([예] 0 : Success, 그밖의 경우, error)
 *                strErrorMsg : 오류 메시지([예]  success.insert|정상적으로 등록되었습니다.)
 * return Type 	: None
 * 사용법		: 
 */
this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg)
{
	if(nErrorCode != '0') {
		this.gfn_callback_message(strSvcId, nErrorCode, strErrorMsg);
	}
	
	if (nErrorCode == '0'){
		switch (strSvcId) {
			case "selectRewordManage":
				this.btn_Save.set_visible(false);
				this.sta_OVTIME_REMNDR.set_text("결재상태");
				this.cmb_SANCTN_STS.set_visible(true);
				this.edt_PRVONSH.set_readonly(true);
				this.cal_BGNDE.set_readonly(true);
				this.cal_ENDDE.set_readonly(true);
				this.cmb_ASORT_CODE.set_readonly(true);
				this.rdo_timeSe.set_readonly(true);
			break;
			case "saveRewordManage":
				this.gfn_message("success.처리.성공");
				this.btn_Save.set_visible(false);
			break;
		}
	}
}


/***********************************************************************
* Transaction 영역 끝
************************************************************************/

/**********************************************************************
* non-Transaction 관련 컴포넌트 이벤트 처리 함수
***********************************************************************
*
* 1. 공통함수 처리
* 2. Grid 관련 이벤트 처리
* 3. Object 관련 이벤트 처리
* 4. Dataset 관련 이벤트 처리
*
***********************************************************************/



/**********************************************************************
* 공통함수 처리
***********************************************************************/

/**********************************************************************
* Dataset 관련 이벤트 처리
***********************************************************************/


this.ds_wrkcp_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	if(e.columnid == "TIME_SE"){
		if(e.newvalue == 1){
			this.ds_hrm029.filter("CODE == '313' || CODE == '314' ");
			this.ds_wrkcp.setColumn(0, "DAYCNT", "0.5");
			this.ds_wrkcp.setColumn(0, "TIME", "0430");
			this.ds_wrkcp.setColumn(0, "OVTMWRK_TM", "0300");
			this.ds_wrkcp.setColumn(0, "ASORT_CODE", "313");
			this.ds_wrkcp.setColumn(0, "BEGIN_TM", "0900");
			this.ds_wrkcp.setColumn(0, "END_TM", "1430");
			obj.setColumn(e.row, "ENDDE", this.ds_wrkcp.getColumn(e.row, "BGNDE"));
		}else{
			this.ds_hrm029.filter("CODE == '311' || CODE == '312' ");
			this.ds_wrkcp.setColumn(0, "DAYCNT", "1.5");
			this.ds_wrkcp.setColumn(0, "TIME", "1200");
			this.ds_wrkcp.setColumn(0, "OVTMWRK_TM", "0800");
			this.ds_wrkcp.setColumn(0, "ASORT_CODE", "311");
			this.ds_wrkcp.setColumn(0, "BEGIN_TM", "1330");
			this.ds_wrkcp.setColumn(0, "END_TM", "1800");
			obj.setColumn(e.row, "ENDDE", Number(this.ds_wrkcp.getColumn(e.row, "BGNDE"))+1);
		}
		
	}
	
	if(e.columnid == "ASORT_CODE"){
		switch(e.newvalue){
			case "311":	//연차[전]
				this.ds_wrkcp.setColumn(0, "BEGIN_TM", "1330");
				this.ds_wrkcp.setColumn(0, "END_TM", "1800");
			break;
			case "312":	//연차[후]
				this.ds_wrkcp.setColumn(0, "BEGIN_TM", "0900");
				this.ds_wrkcp.setColumn(0, "END_TM", "1430");
			break;
			case "313":	//오전반차
				this.ds_wrkcp.setColumn(0, "BEGIN_TM", "0900");
				this.ds_wrkcp.setColumn(0, "END_TM", "1430");
			break;
			case "314":	//오후반차
				this.ds_wrkcp.setColumn(0, "BEGIN_TM", "1330");
				this.ds_wrkcp.setColumn(0, "END_TM", "1800");
			break;
		}
	}
	
	if(e.columnid == "BGNDE"){
		switch(obj.getColumn(e.row, "ASORT_CODE")){
			case "311":	//연차[전]
			case "312":	//연차[후]
				var endDate = this.dateUtils.addDate(e.newvalue, 1, 's');
				var week = "";
				while(1){
					week = this.dateUtils.format(endDate, "E");
					if(week == "토요일" || week == "일요일"){
						endDate = this.dateUtils.addDate(endDate, 1, 's');
						continue;
					}else{
						obj.setColumn(e.row, "ENDDE", endDate);
						break;
					}
				}
				break;
			case "313":	//오전반차
			case "314":	//오후반차
				obj.setColumn(e.row, "ENDDE", e.newvalue);
				break;
		}
	}
}
this.ds_wrkcp_cancolumnchange = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	if(e.columnid == "BGNDE"){
		var week = this.dateUtils.format(e.newvalue, "E");
		switch(week){
			case "토요일":
			case "일요일":
				this.gfn_message("comm.항목.선택.요청", "평일");
				return false;
				break;
		}
	}
}
]]></Script>
  </Form>
</FDL>
