<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\default_typedef.xml"/>
  <Form id="HRM080207" classname="HRM080207" left="0" top="0" width="1059" height="735" titletext="집합교육관리" oninit="HRM080207_oninit" onload="HRM080207_onload">
    <Layouts>
      <Layout>
        <Static id="Static28" taborder="73" cssclass="sta_WF_Labelbg" top="244" right="28" width="355" height="27"/>
        <Static id="Static24" taborder="65" cssclass="sta_WF_Labelbg" top="460" right="28" width="359" height="27"/>
        <Static id="Static23" taborder="63" cssclass="sta_WF_Labelbg" top="270" right="28" width="355" height="104"/>
        <Static id="Static22" taborder="61" cssclass="sta_WF_Labelbg" top="373" right="28" width="355" height="88"/>
        <Static id="Static04" taborder="26" text="스&#13;&#10;크&#13;&#10;롤&#13;&#10;13" visible="false" top="0" right="0" width="13" height="735" style="background:#d07b173c;align:center middle;"/>
        <Static id="Static03" taborder="27" text="15" visible="false" left="1031" top="0" width="15" height="735" style="background:#1b3cd23c;align:center middle;"/>
        <Static id="sta_gnfdList" taborder="28" text="집합교육상세" cssclass="sta_WF_Title02" top="41" width="141" height="19" style="align:left middle;" right="351"/>
        <Static id="Static36" taborder="29" text="10" visible="false" left="0" top="32" width="1031" height="10" style="background:#dc143c3c;align:center middle;"/>
        <Static id="Static01" taborder="30" text="5" visible="false" left="0" top="60" width="1031" height="5" style="background:#dc143c3c;align:center middle;"/>
        <Div id="div_search" taborder="0" left="0" top="0" right="28" height="33" cssclass="div_WFSA_Box">
          <Layouts>
            <Layout>
              <Static id="sta_gnfdDe" taborder="6" text="조회년도" cssclass="sta_WFSA_Label" left="15" top="5" width="64" height="19"/>
              <Static id="Static06" taborder="7" text="15" visible="false" left="0" top="0" width="15" height="33" style="background:#00ffff66;"/>
              <Static id="sta_de00" taborder="8" cssclass="sta_WFSA_Label" left="177" top="5" width="64" height="21" wordwrap="none" text="교육유형"/>
              <Static id="Static01" taborder="9" text="15" visible="false" left="162" top="-1" width="15" height="33" style="background:#00ffff66;"/>
              <Static id="Static02" taborder="10" text="15" visible="false" left="287" top="162" width="15" height="33" style="background:#00ffff66;"/>
              <Static id="sta_de01" taborder="11" text="교육분류" cssclass="sta_WFSA_Label" left="454" top="5" width="64" height="21" onclick="div_search_sta_de01_onclick"/>
              <Static id="Static03" taborder="12" text="15" visible="false" left="725" top="0" width="15" height="33" style="background:#00ffff66;" onclick="div_search_Static03_onclick"/>
              <Spin id="spn_year" taborder="0" value="0" cssclass="spn_WF_Essential" left="84" top="5" width="78" height="21" style="align:center;"/>
              <Static id="Static00" taborder="13" text="15" visible="false" left="440" top="-1" width="15" height="33" style="background:#00ffff66;" onclick="div_search_Static00_onclick"/>
              <Edit id="edt_edcTyNm_s" taborder="1" left="244" top="5" width="198" height="21" onchanged="div_search_edt_edcTyNm_s_onchanged"/>
              <Edit id="edt_edcClNm_s" taborder="3" left="523" top="5" width="201" height="21" onchanged="div_search_edt_edcClNm_s_onchanged"/>
              <Button id="div_edcTySearch_s" taborder="2" onclick="div_edcTySearch_s_onclick" cssclass="btn_WF_Search" left="419" top="6" width="21" height="22"/>
              <Button id="div_edcClSearch_s" taborder="4" onclick="div_edcClSearch_s_onclick" cssclass="btn_WF_Search" left="703" top="6" width="21" height="22"/>
              <Static id="sta_edcCrseNm" taborder="14" text="교육과정" cssclass="sta_WFSA_Label" left="741" top="7" width="64" height="21"/>
              <Edit id="edt_crseNm_s" taborder="5" left="806" top="5" width="217" height="21" lengthunit="ascii" maxlength="1000"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="sta_gnfdList00" taborder="31" text="집합교육내역" cssclass="sta_WF_Title02" left="0" top="41" width="141" height="19" style="align:left middle;"/>
        <Static id="Static00" taborder="32" text="10" visible="false" left="0" top="487" width="1031" height="10" style="background:#dc143c3c;align:center middle;"/>
        <Static id="sta_gnfdList01" taborder="33" text="대상자" cssclass="sta_WF_Title02" left="0" top="496" width="141" height="19" style="align:left middle;"/>
        <Static id="Static02" taborder="34" text="5" visible="false" left="0" top="515" width="1031" height="5" style="background:#dc143c3c;align:center middle;"/>
        <Static id="sta_gnfdList02" taborder="35" text="전체사원 목록" cssclass="sta_WF_Title02" top="497" height="19" style="align:left middle;" right="523" width="101"/>
        <Grid id="grd_grupEdcTrgterManageList" taborder="16" useinputpanel="false" left="0" top="520" bottom="0" right="652" binddataset="ds_grupEdcTrgterManageList">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="110"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="순번"/>
                <Cell col="1" text="부서명"/>
                <Cell col="2" text="직종"/>
                <Cell col="3" text="직급"/>
                <Cell col="4" text="직위"/>
                <Cell col="5" text="사원번호"/>
                <Cell col="6" text="사원명"/>
                <Cell col="7" text="참석여부"/>
                <Cell col="8" text="교육인정시간"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" style="align:left;" text="bind:DEPT_NM"/>
                <Cell col="2" style="align: ;" text="bind:JSSFC_NM"/>
                <Cell col="3" style="align: ;" text="bind:HR_CLSF_NM"/>
                <Cell col="4" text="bind:OFCPS_NM"/>
                <Cell col="5" text="bind:EMPNO"/>
                <Cell col="6" text="bind:EMPNM"/>
                <Cell col="7" displaytype="checkbox" edittype="expr:comp.parent.fn_updateYn() ? 'checkbox' : 'none'" text="bind:PARTCPTN_AT"/>
                <Cell col="8" displaytype="number" edittype="expr:comp.parent.fn_updateYn() ? 'masknumber' : 'none'" style="align:right;" text="bind:EDC_RCOGN_TIME" mask="999" editdisplay="expr:comp.parent.fn_updateYn() ? 'display' : 'edit'" editlimitbymask="both"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="grd_empList" taborder="20" useinputpanel="false" top="520" right="28" bottom="0" width="596" binddataset="ds_empList">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="30"/>
                <Column size="110"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="checkbox" text="bind:CHK"/>
                <Cell col="1" text="부서명"/>
                <Cell col="2" text="직종"/>
                <Cell col="3" text="직급"/>
                <Cell col="4" text="직위"/>
                <Cell col="5" text="사원번호"/>
                <Cell col="6" text="사원명"/>
              </Band>
              <Band id="body">
                <Cell displaytype="checkbox" edittype="checkbox" text="bind:CHK"/>
                <Cell col="1" style="align:left;" text="bind:DEPT_NM"/>
                <Cell col="2" text="bind:JSSFC_NM"/>
                <Cell col="3" text="bind:HR_CLSF_NM"/>
                <Cell col="4" text="bind:OFCPS_NM"/>
                <Cell col="5" text="bind:EMPNO"/>
                <Cell col="6" text="bind:EMPNM"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_deleteGrupEdcTrgterManage" taborder="14" text="행삭제" onclick="btn_deleteGrupEdcTrgterManage_onclick" cssclass="btn_WF_Griddel" top="495" right="832" width="63" height="20"/>
        <Button id="btn_cancelGrupEdcTrgterManage" taborder="15" text="행취소" onclick="btn_cancelGrupEdcTrgterManage_onclick" cssclass="btn_WF_Gridcnl" top="495" right="766" width="64" height="20"/>
        <Div id="div_DeptComp" taborder="17" url="com::deptCode.xfdl" top="495" width="194" height="21" async="false" right="290"/>
        <Static id="Static06" taborder="36" text="15" visible="false" top="495" width="10" height="21" style="background:#00ffff66;" right="280"/>
        <Static id="Static07" taborder="37" text="15" visible="false" top="495" width="10" height="21" style="background:#00ffff66;" right="517"/>
        <Div id="div_EMP" taborder="18" url="com::empno.xfdl" top="494" height="21" onkeyup="div_SEARCH_div_EMP_onkeyup" right="77" width="169" async="false"/>
        <Static id="Static08" taborder="38" text="부서" cssclass="sta_WFSA_Label" top="496" width="38" height="21" right="480"/>
        <Static id="Static05" taborder="39" text="성명" cssclass="sta_WFSA_Label" top="496" width="38" height="21" right="244"/>
        <Button id="btn_empSearch" taborder="19" text="조회" onclick="btn_empSearch_onclick" cssclass="btn_WF_Process" top="496" right="28" width="40" height="19"/>
        <Static id="Static09" taborder="40" text="15" visible="false" top="495" height="21" style="background:#00ffff66;" width="10" right="68"/>
        <Button id="btn_move" taborder="21" onclick="btn_move_onclick" cssclass="btn_WF_ShuttleL" top="601" right="627" width="21" height="55"/>
        <Static id="Static13" taborder="41" text="5" visible="false" width="5" style="background:#1b3cd23c;align:center middle;" right="623" bottom="0" height="240"/>
        <Static id="Static10" taborder="42" text="5" visible="false" bottom="-1" width="5" height="240" style="background:#1b3cd23c;align:center middle;" left="406"/>
        <Static id="Static11" taborder="43" cssclass="sta_WF_Labelbg" width="355" height="27" right="28" top="64"/>
        <Static id="sta_jssfcClsfNm" taborder="44" text="교육과정" cssclass="sta_WF_Label" width="110" height="27" style="align:right middle;" right="382" top="64"/>
        <Static id="Static12" taborder="45" cssclass="sta_WF_Labelbg" top="90" right="28" width="355" height="27"/>
        <Edit id="edt_edcInstt" taborder="3" top="93" right="31" width="349" height="21" cssclass="edt_WF_Essential" lengthunit="ascii" maxlength="500"/>
        <Static id="sta_jssfcClsfNm00" taborder="46" text="교육기관" cssclass="sta_WF_Label" top="90" right="382" width="110" height="27" style="align:right middle;"/>
        <Static id="Static14" taborder="48" cssclass="sta_WF_Labelbg" top="166" right="28" width="355" height="27" onclick="Static14_onclick"/>
        <Static id="Static15" taborder="50" cssclass="sta_WF_Labelbg" top="218" right="28" width="355" height="27"/>
        <Static id="sta_jssfcClsfNm02" taborder="49" text="관련직무" cssclass="sta_WF_Label" top="244" right="382" width="110" height="27" style="align:right middle;"/>
        <Static id="sta_jssfcClsfNm04" taborder="51" text="지정학습여부" cssclass="sta_WF_Label" top="218" right="382" width="110" height="27" style="align:right middle;" onclick="sta_jssfcClsfNm04_onclick"/>
        <Combo id="cmb_relateDty" taborder="10" codecolumn="CODE" datacolumn="CODE_NM" onitemchanged="div_search_Combo00_onitemchanged" top="247" width="150" height="21" right="230" innerdataset="@ds_relateDtySe"/>
        <Combo id="cmb_month01" taborder="52" innerdataset="ds_month" codecolumn="CODE" datacolumn="CODE_NM" onitemchanged="div_search_Combo00_onitemchanged" top="0px" width="0px" height="0px" left="0px"/>
        <Static id="sta_jssfcClsfNm06" taborder="53" text="교육유형" cssclass="sta_WF_Label" top="166" right="382" width="110" height="27" style="align:right middle;"/>
        <Static id="Static18" taborder="54" cssclass="sta_WF_Labelbg" top="116" right="28" width="355" height="27"/>
        <Static id="sta_jssfcClsfNm01" taborder="47" text="교육기간" cssclass="sta_WF_Label" top="116" right="382" width="110" height="27" style="align:right middle;"/>
        <Static id="Static19" taborder="55" onclick="Static14_onclick" cssclass="sta_WF_Labelbg" top="192" right="28" width="355" height="27"/>
        <Static id="sta_jssfcClsfNm07" taborder="56" text="교육분류(역량)" cssclass="sta_WF_Label" top="192" right="382" width="110" height="27" style="align:right middle;"/>
        <Edit id="edt_edcTyNm" top="169" right="31" width="349" height="21" readonly="true" cssclass="edt_WF_Essential" oneditclick="edt_edcTyNm_oneditclick" taborder="23"/>
        <Static id="Static20" taborder="57" text="15" visible="false" left="1031" top="0" width="15" height="735" style="background:#1b3cd23c;align:center middle;"/>
        <Combo id="cmb_appnLrnAt" taborder="11" codecolumn="CODE" datacolumn="CODE_NM" onitemchanged="div_search_Combo00_onitemchanged" top="221" right="263" width="117" height="21" innerdataset="@ds_appnLrnAt" index="-1"/>
        <Edit id="edt_crseNm" taborder="2" top="67" right="31" width="349" height="21" cssclass="edt_WF_Essential" lengthunit="ascii" maxlength="2000"/>
        <Calendar id="cal_bgnDe" taborder="4" dateformat="yyyy-MM-dd" top="120" width="100" height="19" right="280"/>
        <Static id="Static16" taborder="58" text="~" top="121" width="10" height="19" right="267"/>
        <Calendar id="cal_endDe" taborder="5" dateformat="yyyy-MM-dd" cssclass="cal_WF_Essetial" top="120" width="100" height="19" right="166"/>
        <Static id="Static21" taborder="59" text="(          일           시간)" top="119" width="130" height="21" right="35"/>
        <Edit id="edt_edcDayCnt" taborder="22" top="120" width="35" height="19" right="121" readonly="true" cssclass="edt_WF_Readonly"/>
        <Edit id="edt_edcTime" taborder="6" top="120" right="65" width="35" height="19" readonly="false" cssclass="edt_WF_Essential" inputtype="number" oneditclick="edt_edcTime_oneditclick" maxlength="3"/>
        <Static id="sta_jssfcClsfNm03" taborder="60" text="강사정보" cssclass="sta_WF_Label" top="373" right="382" width="110" height="88" style="align:right middle;"/>
        <Static id="sta_jssfcClsfNm05" taborder="62" text="교육내용" cssclass="sta_WF_Label" top="270" right="382" width="110" height="104" style="align:right middle;" onclick="sta_jssfcClsfNm05_onclick"/>
        <TextArea id="txt_edcCn" taborder="12" top="273" width="349" height="98" right="31" oneditclick="txt_edcCn_oneditclick" lengthunit="ascii" maxlength="2000"/>
        <TextArea id="txt_instrctrInfo" taborder="13" top="376" right="31" width="349" height="82" lengthunit="ascii" maxlength="1000"/>
        <Static id="sta_jssfcClsfNm08" taborder="64" text="비고" cssclass="sta_WF_Label" top="460" right="382" width="110" height="27" style="align:right middle;"/>
        <Edit id="edt_rm" taborder="25" top="463" right="31" width="349" height="21" readonly="false" maxlength="1000" lengthunit="ascii"/>
        <Grid id="grd_edcCrseManageList" taborder="1" binddataset="ds_edcCrseManageList" useinputpanel="false" left="0" top="64" right="500" height="423" oncellclick="grd_edcCrseManageList_oncellclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="30"/>
                <Column size="60"/>
                <Column size="200"/>
                <Column size="250"/>
                <Column size="180"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="58"/>
                <Column size="58"/>
                <Column size="120"/>
                <Column size="300"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="200"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="순번"/>
                <Cell col="1" text="이관"/>
                <Cell col="2" text="교육분류"/>
                <Cell col="3" text="교육과정"/>
                <Cell col="4" text="교육기관"/>
                <Cell col="5" text="시작일"/>
                <Cell col="6" text="종료일"/>
                <Cell col="7" text="교육일수"/>
                <Cell col="8" text="교육시간"/>
                <Cell col="9" text="교육장소"/>
                <Cell col="10" text="교육유형"/>
                <Cell col="11" text="관련직무"/>
                <Cell col="12" text="지정학습여부"/>
                <Cell col="13" text="비고"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" displaytype="button" text="expr:TRNSFER_YN == '1' ? '완료' : '실행'"/>
                <Cell col="2" style="align:left;" text="bind:EDC_CL_SN_NM"/>
                <Cell col="3" style="align:left;" text="bind:CRSE_NM" tooltiptext="bind:CRSE_NM"/>
                <Cell col="4" style="align:left;" text="bind:EDC_INSTT" tooltiptext="bind:EDC_INSTT"/>
                <Cell col="5" displaytype="date" text="bind:EDC_BGNDE" calendardisplaynulltype="none"/>
                <Cell col="6" displaytype="date" text="bind:EDC_ENDDE" calendardisplaynulltype="none"/>
                <Cell col="7" text="bind:EDC_DAYCNT"/>
                <Cell col="8" text="bind:EDC_TIME"/>
                <Cell col="9" text="bind:EDC_PLACE"/>
                <Cell col="10" style="align:left;" text="bind:EDC_TY_NM" tooltiptext="bind:EDC_TY_NM"/>
                <Cell col="11" displaytype="combo" style="align:left;" text="bind:RELATE_DTY" combodataset="ds_relateDtySe" combocodecol="CODE" combodatacol="CODE_NM"/>
                <Cell col="12" displaytype="checkbox" style="align:center;" text="bind:APPN_LRN_AT"/>
                <Cell col="13" style="align:left;" text="bind:RM" tooltiptext="bind:RM"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static17" taborder="67" cssclass="sta_WF_Labelbg" top="141" right="28" width="355" height="27"/>
        <Edit id="edt_edcPlace" taborder="7" top="144" right="31" width="349" height="21" lengthunit="ascii" maxlength="300"/>
        <Static id="sta_edcPlace" taborder="66" text="교육장소" cssclass="sta_WF_Label" top="141" right="382" width="110" height="27" style="align:right middle;"/>
        <Edit id="edt_edcClNm" readonly="true" oneditclick="edt_edcClNm_oneditclick" cssclass="edt_WF_Readonly" top="195" right="31" width="349" height="21" taborder="24"/>
        <Static id="Static25" taborder="68" top="171" width="15" height="18" style="background:white;" right="43"/>
        <Static id="Static26" taborder="69" top="171" width="23" height="16" style="background:#fef8f8ff;" right="36"/>
        <Button id="div_edcTySearch" taborder="8" cssclass="btn_WF_Search" width="21" height="22" right="31" top="168" onclick="div_edcTySearch_onclick" style="background:transparent;"/>
        <Static id="Static27" taborder="70" top="197" width="23" height="16" style="background:#f0f0f0ff;" right="32"/>
        <Button id="div_edcClSearch" taborder="9" onclick="div_edcClSearch_onclick" cssclass="btn_WF_Search" top="195" right="31" width="21" height="22"/>
        <Static id="sta_dutyEdcAt" taborder="71" text="의무교육여부" onclick="sta_jssfcClsfNm04_onclick" cssclass="sta_WF_Label" top="218" right="151" width="110" height="27" style="align:right middle;"/>
        <Combo id="cmb_dutyEdcAt" taborder="72" codecolumn="codecolumn" datacolumn="datacolumn" onitemchanged="div_search_Combo00_onitemchanged" top="221" right="31" width="118" height="21">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">1</Col>
                <Col id="datacolumn">예</Col>
              </Row>
              <Row>
                <Col id="codecolumn">0</Col>
                <Col id="datacolumn">아니오</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Button id="btn_download" taborder="74" text="양식 다운로드" top="496" right="681" width="82" height="19" onclick="btn_download_onclick"/>
        <Button id="btn_upload" taborder="75" cssclass="btn_WF_Gridexcelup" top="496" right="653" width="25" height="19" onclick="btn_upload_onclick"/>
        <Grid id="grd_sample" taborder="76" useinputpanel="false" left="0.19%" top="780" right="74.32%" height="180" binddataset="ds_sample" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="부서명"/>
                <Cell col="1" disptype="normal" text="사원명"/>
                <Cell col="2" disptype="normal" text="교육인정시간"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:부서명"/>
                <Cell col="1" disptype="normal" text="bind:사원명"/>
                <Cell col="2" disptype="normal" text="bind:교육인정시간"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cond" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_cond_oncolumnchanged" cancolumnchange="ds_cond_cancolumnchange">
        <ColumnInfo>
          <Column id="YEAR" type="STRING" size="256"/>
          <Column id="EDC_TY_SN" type="STRING" size="256"/>
          <Column id="EDC_CL_SN" type="STRING" size="256"/>
          <Column id="CRSE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_validation" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="compId" type="STRING" size="256"/>
          <Column id="colId" type="STRING" size="256"/>
          <Column id="PK" type="STRING" size="256"/>
          <Column id="notNull" type="STRING" size="256"/>
          <Column id="type" type="STRING" size="256"/>
          <Column id="nlength" type="STRING" size="256"/>
          <Column id="from" type="STRING" size="256"/>
          <Column id="to" type="STRING" size="256"/>
          <Column id="lengthChkGb" type="STRING" size="256"/>
          <Column id="msgId" type="STRING" size="256"/>
          <Column id="expr" type="STRING" size="256"/>
          <Column id="func" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="compId">ds_cond</Col>
            <Col id="colId">YEAR</Col>
            <Col id="from"/>
            <Col id="to"/>
            <Col id="msgId">조회년도</Col>
            <Col id="notNull">Y</Col>
            <Col id="PK"/>
            <Col id="nlength">4</Col>
            <Col id="lengthChkGb">EQ</Col>
          </Row>
          <Row>
            <Col id="compId">ds_edcCrseManageList</Col>
            <Col id="colId">CRSE_NM</Col>
            <Col id="PK"/>
            <Col id="notNull">Y</Col>
            <Col id="nlength"/>
            <Col id="lengthChkGb"/>
            <Col id="msgId">교욱과정</Col>
            <Col id="type"/>
            <Col id="from"/>
            <Col id="to"/>
            <Col id="expr"/>
            <Col id="func"/>
          </Row>
          <Row>
            <Col id="compId">ds_edcCrseManageList</Col>
            <Col id="colId">EDC_INSTT</Col>
            <Col id="PK"/>
            <Col id="notNull">Y</Col>
            <Col id="nlength"/>
            <Col id="lengthChkGb"/>
            <Col id="msgId">교육기관</Col>
            <Col id="type"/>
            <Col id="from"/>
            <Col id="to"/>
            <Col id="expr"/>
            <Col id="func"/>
          </Row>
          <Row>
            <Col id="compId">ds_edcCrseManageList</Col>
            <Col id="colId">EDC_BGNDE</Col>
            <Col id="PK"/>
            <Col id="notNull">N</Col>
            <Col id="nlength">8</Col>
            <Col id="lengthChkGb">EQ</Col>
            <Col id="msgId">교육시작일</Col>
            <Col id="type"/>
            <Col id="from"/>
            <Col id="to"/>
            <Col id="expr"/>
            <Col id="func"/>
          </Row>
          <Row>
            <Col id="compId">ds_edcCrseManageList</Col>
            <Col id="colId">EDC_ENDDE</Col>
            <Col id="PK"/>
            <Col id="notNull">N</Col>
            <Col id="nlength">8</Col>
            <Col id="lengthChkGb">EQ</Col>
            <Col id="msgId">교육종료일</Col>
            <Col id="type"/>
            <Col id="from"/>
            <Col id="to"/>
            <Col id="expr"/>
            <Col id="func"/>
          </Row>
          <Row>
            <Col id="compId">ds_edcCrseManageList</Col>
            <Col id="colId">EDC_BGNDE</Col>
            <Col id="PK"/>
            <Col id="notNull">N</Col>
            <Col id="to">EDC_ENDDE</Col>
            <Col id="msgId">교육시작일^교육종료일</Col>
          </Row>
          <Row>
            <Col id="compId">ds_edcCrseManageList</Col>
            <Col id="colId">EDC_TIME</Col>
            <Col id="notNull">Y</Col>
            <Col id="PK"/>
            <Col id="msgId">교육시간</Col>
            <Col id="lengthChkGb">LE</Col>
            <Col id="nlength">3</Col>
          </Row>
          <Row>
            <Col id="compId">ds_edcCrseManageList</Col>
            <Col id="colId">EDC_TY_SN</Col>
            <Col id="notNull">Y</Col>
            <Col id="PK"/>
            <Col id="msgId">교육유형</Col>
          </Row>
          <Row>
            <Col id="compId">ds_grupEdcTrgterManageList</Col>
            <Col id="colId">EDC_RCOGN_TIME</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">교육인정시간</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_edcCrseManageList" useclientlayout="true" onrowposchanged="ds_edcCrseManageList_onrowposchanged" oncolumnchanged="ds_edcCrseManageList_oncolumnchanged" canrowposchange="ds_edcCrseManageList_canrowposchange">
        <ColumnInfo>
          <Column id="YEAR" type="STRING" size="256"/>
          <Column id="SN" type="STRING" size="256"/>
          <Column id="EDC_TY_SN" type="STRING" size="256"/>
          <Column id="EDC_TY_NM" type="STRING" size="256"/>
          <Column id="EDC_CL_SN" type="STRING" size="256"/>
          <Column id="EDC_CL_SN_NM" type="STRING" size="256"/>
          <Column id="EDC_INSTT" type="STRING" size="256"/>
          <Column id="CRSE_NM" type="STRING" size="256"/>
          <Column id="EDC_PLACE" type="STRING" size="256"/>
          <Column id="APPN_LRN_AT" type="STRING" size="256"/>
          <Column id="DUTY_EDC_AT" type="STRING" size="256"/>
          <Column id="RELATE_DTY" type="STRING" size="256"/>
          <Column id="EDC_BGNDE" type="STRING" size="256"/>
          <Column id="EDC_ENDDE" type="STRING" size="256"/>
          <Column id="EDC_DAYCNT" type="STRING" size="256"/>
          <Column id="EDC_TIME" type="STRING" size="256"/>
          <Column id="EDC_CN" type="STRING" size="256"/>
          <Column id="INSTRCTR_INFO" type="STRING" size="256"/>
          <Column id="SANCTN_NO" type="STRING" size="256"/>
          <Column id="RM" type="STRING" size="256"/>
          <Column id="TRNSFER_YN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_grupEdcTrgterManageList" useclientlayout="true">
        <ColumnInfo>
          <Column id="YEAR" type="STRING" size="256"/>
          <Column id="SN" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="JSSFC_SE" type="STRING" size="256"/>
          <Column id="JSSFC_NM" type="STRING" size="256"/>
          <Column id="HR_CLSF_SE" type="STRING" size="256"/>
          <Column id="HR_CLSF_NM" type="STRING" size="256"/>
          <Column id="OFCPS_SE" type="STRING" size="256"/>
          <Column id="OFCPS_NM" type="STRING" size="256"/>
          <Column id="EMPNO" type="STRING" size="256"/>
          <Column id="EMPNM" type="STRING" size="256"/>
          <Column id="PARTCPTN_AT" type="STRING" size="256"/>
          <Column id="EDC_RCOGN_TIME" type="STRING" size="256"/>
          <Column id="EDC_TIME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_empList" useclientlayout="true">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="JSSFC_SE" type="STRING" size="256"/>
          <Column id="JSSFC_NM" type="STRING" size="256"/>
          <Column id="HR_CLSF_SE" type="STRING" size="256"/>
          <Column id="HR_CLSF_NM" type="STRING" size="256"/>
          <Column id="OFCPS_SE" type="STRING" size="256"/>
          <Column id="OFCPS_NM" type="STRING" size="256"/>
          <Column id="EMPNO" type="STRING" size="256"/>
          <Column id="EMPNM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_abilityCodeList" useclientlayout="true">
        <ColumnInfo>
          <Column id="YEAR" type="STRING" size="256"/>
          <Column id="SN" type="STRING" size="256"/>
          <Column id="ABILITY_SE" type="STRING" size="256"/>
          <Column id="ABILITY_GROUP_CODE" type="STRING" size="256"/>
          <Column id="ABILITY_CODE" type="STRING" size="256"/>
          <Column id="ABILITY_NM" type="STRING" size="256"/>
          <Column id="DFN" type="STRING" size="256"/>
          <Column id="RM" type="STRING" size="256"/>
          <Column id="USE_AT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond2" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="YEAR" type="STRING" size="256"/>
          <Column id="SN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond_emp" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="EMPNO" type="STRING" size="256"/>
          <Column id="EMPNM" type="STRING" size="256"/>
          <Column id="YEAR" type="STRING" size="256"/>
          <Column id="SN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_appnLrnAt" useclientlayout="true">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_popup" firefirstcount="0" firenextcount="0" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" useclientlayout="true"/>
      <Dataset id="ds_relateDtySe" useclientlayout="true">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond_t" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_cond_oncolumnchanged" cancolumnchange="ds_cond_cancolumnchange">
        <ColumnInfo>
          <Column id="YEAR" type="STRING" size="256"/>
          <Column id="SN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sample" useclientlayout="true">
        <ColumnInfo>
          <Column id="부서명" type="STRING" size="256"/>
          <Column id="사원명" type="STRING" size="256"/>
          <Column id="교육인정시간" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="부서명">경영지원팀</Col>
            <Col id="사원명">홍길동</Col>
            <Col id="교육인정시간">2</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_import">
        <ColumnInfo>
          <Column id="Column0" type="STRING" size="256"/>
          <Column id="Column1" type="STRING" size="256"/>
          <Column id="Column2" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item4" compid="edt_edcInstt" propid="value" datasetid="ds_edcCrseManageList" columnid="EDC_INSTT"/>
      <BindItem id="item6" compid="cmb_relateDty" propid="value" datasetid="ds_edcCrseManageList" columnid="RELATE_DTY"/>
      <BindItem id="item7" compid="cmb_month01" propid="value" datasetid="ds_cond" columnid="MONTH"/>
      <BindItem id="item10" compid="cmb_appnLrnAt" propid="value" datasetid="ds_edcCrseManageList" columnid="APPN_LRN_AT"/>
      <BindItem id="item9" compid="edt_crseNm" propid="value" datasetid="ds_edcCrseManageList" columnid="CRSE_NM"/>
      <BindItem id="item11" compid="cal_bgnDe" propid="value" datasetid="ds_edcCrseManageList" columnid="EDC_BGNDE"/>
      <BindItem id="item12" compid="cal_endDe" propid="value" datasetid="ds_edcCrseManageList" columnid="EDC_ENDDE"/>
      <BindItem id="item8" compid="edt_rm" propid="value" datasetid="ds_edcCrseManageList" columnid="RM"/>
      <BindItem id="item13" compid="edt_edcDayCnt" propid="value" datasetid="ds_edcCrseManageList" columnid="EDC_DAYCNT"/>
      <BindItem id="item14" compid="edt_edcTime" propid="value" datasetid="ds_edcCrseManageList" columnid="EDC_TIME"/>
      <BindItem id="item0" compid="div_search.spn_year" propid="value" datasetid="ds_cond" columnid="YEAR"/>
      <BindItem id="item18" compid="edt_edcPlace" propid="value" datasetid="ds_edcCrseManageList" columnid="EDC_PLACE"/>
      <BindItem id="item3" compid="edt_edcTyNm" propid="value" datasetid="ds_edcCrseManageList" columnid="EDC_TY_NM"/>
      <BindItem id="item15" compid="edt_edcClNm" propid="value" datasetid="ds_edcCrseManageList" columnid="EDC_CL_SN_NM"/>
      <BindItem id="item1" compid="div_search.edt_edcTyNm_s" propid="value" datasetid="ds_edcCrseManageList" columnid=""/>
      <BindItem id="item2" compid="div_search.edt_edcClNm_s" propid="value" datasetid="ds_edcCrseManageList" columnid=""/>
      <BindItem id="item5" compid="div_search.edt_crseNm_s" propid="value" datasetid="ds_cond" columnid="CRSE_NM"/>
      <BindItem id="item19" compid="txt_edcCn" propid="value" datasetid="ds_edcCrseManageList" columnid="EDC_CN"/>
      <BindItem id="item16" compid="txt_instrctrInfo" propid="value" datasetid="ds_edcCrseManageList" columnid="INSTRCTR_INFO"/>
      <BindItem id="item17" compid="cmb_dutyEdcAt" propid="value" datasetid="ds_edcCrseManageList" columnid="DUTY_EDC_AT"/>
    </Bind>
    <Script type="xscript5.0"><![CDATA[/***********************************************************************
 * 업무구분 : 집합교육관리
 * 화면ID   : HRM080207
 * 화면명   : 집합교육관리
 * 화면설명 : 집합교육을 관리한다.
 * 작성일   : 2017.06.05
 * 작성자   : 정 민
 * 수정이력 : 
 ***********************************************************************
 *     수정일     수정자   내용
 ***********************************************************************
 *    
 *   
 ***********************************************************************
 */

/***********************************************************************
 * Script Include 
 ***********************************************************************/
// 시스템 공통 라이브러리 Include
include "mis_lib::misUtil.xjs";
include "lib::comInclude.xjs";


/***********************************************************************
 * 화면 변수 선언부
 ***********************************************************************/
this.checkDs = [
	 this.ds_edcCrseManageList
	,this.ds_grupEdcTrgterManageList
	,this.ds_empList
];

this.saveRow  = -1;
this.saveRow2 = -1;
/***********************************************************************
 * onInit / onLoad 영역
 ***********************************************************************/
this.HRM080207_oninit = function(obj:Form, e:nexacro.InitEventInfo)
{
	this.fn_init_form();
	this.fn_init_dataset();
}
this.HRM080207_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{
	this.fn_loadCombo();
}

/***********************************************************************
 * Form 오브젝트 초기화
 ***********************************************************************/ 
this.fn_init_form = function()
{
	this.gfn_initForm(this);
	this.fn_misFormInit(this);
}

/***********************************************************************
 * Dataset 오브젝트 초기화
 ***********************************************************************/ 
this.fn_init_dataset = function()
{
	this.gfn_initCondDs(this, this.div_search);

}


/*
 * 함수명  	: fn_loadCombo
 * 설명 		: 화면의 Combo 에 데이터를 불러온다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_loadCombo();
 */
this.fn_loadCombo = function ()
{
	var comboParams = [
							["ds_relateDtySe", "HRM045", "1", ""]		// 관련직무구분
					  ];
	this.gfn_comboLoad(comboParams, this.fn_callbackAfter);
}

/*
 * 함수명  	: fn_callbackAfter
 * 설명 		: 공통 callback
 * params  		: None
 * return Type 	: None 
 * 사용법		: this.fn_callbackAfter();
 */
this.fn_callbackAfter = function ()
{
	// 검색 데이터셋 초기화
	this.ds_cond.clearData();
	this.ds_cond.addRow();
	
	// 조회년도 현재년도로 셋팅
	this.ds_cond.setColumn(0, "YEAR", this.dateUtils.format(this.gfn_today(),"yyyy"));
	
	// 전체사원 목록 검색조건 바인딩
	this.div_EMP.fn_setBind("ds_cond_emp", "EMPNO", "EMPNM");
	this.div_DeptComp.fn_setBind("ds_cond_emp","DEPT_CODE","DEPT_NM");
	
	// 지정학습여부 셋팅
	this.ds_appnLrnAt.clearData();
	var nRow = this.ds_appnLrnAt.addRow();
	this.ds_appnLrnAt.setColumn(nRow, "CODE"   , "0");
	this.ds_appnLrnAt.setColumn(nRow, "CODE_NM", "아니오");
	nRow = this.ds_appnLrnAt.addRow();
	this.ds_appnLrnAt.setColumn(nRow, "CODE"   , "1");
	this.ds_appnLrnAt.setColumn(nRow, "CODE_NM", "예");
	
	this.fn_search();
}
/***********************************************************************
* Transaction 영역 시작
************************************************************************/

/***********************************************************************
 * Transaction 관련 이벤트 핸들러 
 **********************************************************************/

/*
 * 함수명  	: fn_search
 * 설명 		: 교육신청관리 조회 이벤트 처리     
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_search();
 */
this.fn_search = function()
{
	// validation 체크
	if(!this.gfn_checkValidation_NoUpdChk(this.ds_cond, this.ds_validation)) {
		return;
	}
	this.ds_edcCrseManageList.clearData();
	this.ds_grupEdcTrgterManageList.clearData();
	this.ds_empList.clearData();
	this.fn_transaction("selectEdcCrseManageList");
}


/*
 * 함수명  	: fn_save
 * 설명 		: 저장 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_save();
 */
this.fn_save = function()
{
	// 데이터셋 수정 여부체크
	if (!this.comUtils.isDatasetUpdated(this.ds_edcCrseManageList) && !this.comUtils.isDatasetUpdated(this.ds_grupEdcTrgterManageList)) {
		this.gfn_message("comm.데이터.변경.없음");
		return false;
	}
	
	// validation 체크(집합교육내역)
	if(!this.gfn_checkValidation_NoUpdChk(this.ds_edcCrseManageList, this.ds_validation)) {
		return;
	}
	
	// validation 체크(대상자)
	if(!this.gfn_checkValidation_NoUpdChk(this.ds_grupEdcTrgterManageList, this.ds_validation)) {
		return;
	}

	var cRowp = this.ds_edcCrseManageList.rowposition;
	var bgnDe = this.ds_edcCrseManageList.getColumn(cRowp, "EDC_BGNDE");
	var endDe = this.ds_edcCrseManageList.getColumn(cRowp, "EDC_ENDDE");
	
	if ((bgnDe != "" && typeof bgnDe != "undefined") && (endDe != "" && typeof endDe != "undefined")){
		var dayCnt = (this.dateUtils.between(bgnDe , endDe))+"";

		if(dayCnt > -1 && dayCnt.length > 3 ) {
			alert("교육종료일자와 교육시작일자 차가 999일을 넘길 수 없습니다.");
			return false;
		}
	}
	
	if(this.gfn_message("confirm.저장.여부"))	{
		this.saveRow  = this.ds_edcCrseManageList.rowposition;
		this.saveRow2 = this.ds_grupEdcTrgterManageList.rowposition;
		this.fn_transaction("saveEdcCrseManage");
	}
}

/*
 * 함수명  	: ds_edcCrseManageList_onrowposchanged
 * 설명 		: 집합교육내역 rowposition 변경시 발생
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_edcCrseManageList_onrowposchanged
 */
this.ds_edcCrseManageList_onrowposchanged = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{
	if(obj.getRowCount() > 0) {
		var enableSttus = false;
		
		if(obj.getColumn(e.newrow, "TRNSFER_YN") != '1'){
			enableSttus = true;
		}
		
		this.edt_crseNm.set_enable(enableSttus);
		this.edt_edcInstt.set_enable(enableSttus);
		this.cal_bgnDe.set_enable(enableSttus);
		this.cal_endDe.set_enable(enableSttus);
		this.edt_edcTime.set_enable(enableSttus);
		this.edt_edcPlace.set_enable(enableSttus);
		this.div_edcTySearch.set_enable(enableSttus);
		this.edt_edcTyNm.set_enable(enableSttus);
		this.div_edcClSearch.set_enable(enableSttus);
		this.cmb_appnLrnAt.set_enable(enableSttus);
		this.cmb_dutyEdcAt.set_enable(enableSttus);
		this.cmb_relateDty.set_enable(enableSttus);
		this.txt_edcCn.set_enable(enableSttus);
		this.txt_instrctrInfo.set_enable(enableSttus);
		this.edt_rm.set_enable(enableSttus);
		this.btn_deleteGrupEdcTrgterManage.set_enable(enableSttus);
		this.btn_cancelGrupEdcTrgterManage.set_enable(enableSttus);
		this.btn_move.set_enable(enableSttus);
		
		var cRowp = obj.rowposition;
		this.ds_cond2.clearData();
		this.ds_cond2.addRow();
		this.ds_cond2.setColumn(0, "YEAR", this.ds_cond.getColumn(0, "YEAR"));
		this.ds_cond2.setColumn(0, "SN"  , obj.getColumn(cRowp, "SN"));
		
		this.fn_transaction("selectGrupEdcTrgterManageList");
	}
}

/*
 * 함수명  	: btn_empSearch_onclick
 * 설명 		: 전체사원 목록 조회 버튼
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_empSearch_onclick
 */
this.btn_empSearch_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.ds_cond_emp.setColumn(0, "YEAR", this.ds_cond2.getColumn(0, "YEAR"));
	this.ds_cond_emp.setColumn(0, "SN"  , this.ds_cond2.getColumn(0, "SN"));
	this.fn_transaction("selectEmpList");
}
/**********************************************************************
 * CALL TRANSACTION 영역
 **********************************************************************/
this.fn_transaction = function(strSvcId)
{
	switch (strSvcId) {
		// 집합교육 목록 조회
		case "selectEdcCrseManageList":
			var sController   	= "hsco/mis/hrm/HRM080207/selectEdcCrseManageList.do";
			var sInDatasets   	= "input1=ds_cond";
			var sOutDatasets  	= "ds_edcCrseManageList=output1";
			break;
		// 대상자 목록 조회
		case "selectGrupEdcTrgterManageList":
			var sController   	= "hsco/mis/hrm/HRM080207/selectGrupEdcTrgterManageList.do";
			var sInDatasets   	= "input1=ds_cond2";
			var sOutDatasets  	= "ds_grupEdcTrgterManageList=output1";
			break;
		// 집합교육관리 저장
		case "saveEdcCrseManage":
			var sController   	= "hsco/mis/hrm/HRM080207/saveEdcCrseManage.do";
			var sInDatasets   	= "input1=ds_edcCrseManageList:U input2=ds_grupEdcTrgterManageList:U";
			var sOutDatasets  	= "";
			break;
		// 전체사원 목록 조회
		case "selectEmpList":
			var sController   	= "hsco/mis/hrm/HRM080207/selectEmpList.do";
			var sInDatasets   	= "input1=ds_cond_emp";
			var sOutDatasets  	= "ds_empList=output1";
			break;
		// 교육분류(역량코드) 목록 조회
		case "selectAbilityCodeManageList":
			var sController   	= "hsco/mis/hrm/HRM080207/selectAbilityCodeManageList.do";
			var sInDatasets   	= "input1=ds_cond";
			var sOutDatasets  	= "ds_abilityCodeManageList=output1";
			break;
		// 개인실적등록 데이터 이관 실행
		case "trnsferEdcManage":
			var sController   	= "hsco/mis/hrm/HRM080207/trnsferEdcManage.do";
			var sInDatasets   	= "input1=ds_cond_t";
			var sOutDatasets  	= "";
			break;
		// 엑셀업로드
		case "excelUpload":
			var sController   	= "hsco/mis/hrm/HRM080207/excelUpload.do";
			var sInDatasets   	= "input1=ds_cond_t input2=ds_grupEdcTrgterManageList:A";
			var sOutDatasets  	= "";
			break;

	}

	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets); 
}

 /**********************************************************************
 * Transaction Callback 영역
 ***********************************************************************/

this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg)
{	
	// 오류 및 성공 메시지를 화면에 보여준다.
	if(nErrorCode != 0) {
	  this.gfn_callback_message(strSvcId, nErrorCode, strErrorMsg);
	}
	if (nErrorCode != 0){
	} else {
		switch (strSvcId) {	
			// 집합교육 목록 조회
 			case "selectEdcCrseManageList":
 			 	if(this.saveRow > -1){
					this.ds_edcCrseManageList.set_rowposition(this.saveRow);
					this.saveRow = -1;
				}
				break;
			// 대상자 목록 조회
 			case "selectGrupEdcTrgterManageList":
				if(this.saveRow2 > -1){
					this.ds_grupEdcTrgterManageList.set_rowposition(this.saveRow2);
					this.saveRow2 = -1;
				}
				break;
			// 집합교육관리 저장
 			case "saveEdcCrseManage":
				this.gfn_message("success.처리.성공");
				this.fn_search();
				break;
			// 전체사원 목록 조회
 			case "selectEmpList":
				break;
			// 교육분류(역량코드) 목록 조회 / 팝업2 교육분류(역량) 조회
 			case "selectAbilityCodeManageList":
				break;
			// 팝업1 교육유형 조회
 			case "selectEdcTyRcognTimeList":
				break;
			// 개인실적등록 데이터 이관 실행
 			case "trnsferEdcManage":
				this.gfn_message("success.처리.성공");
				this.fn_search();
				break;
			// 엑셀업로드
 			case "excelUpload":
				this.gfn_message("success.처리.성공");
				this.fn_search();
				break;
		}
	}
}

/***********************************************************************
* Transaction 영역 끝
************************************************************************/

/***********************************************************************
 * non-Transaction 관련 컴포넌트 이벤트 처리 함수
 *********************************** ************************************/

/*
 * 함수명  	: fn_insert
 * 설명 		: 추가 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_insert ();
 */
this.fn_insert = function()
{
	var nRow = this.ds_edcCrseManageList.addRow();
	this.ds_edcCrseManageList.setColumn(nRow, "YEAR", this.ds_cond.getColumn(0, "YEAR")); 
}


/*
 * 함수명  	: fn_delete
 * 설명 		: 삭제 이벤트 처리 
 * params  		: None1
 * return Type 	: None
 * 사용법		: this.fn_delete
 */
this.fn_delete= function()
{	
	if(this.ds_edcCrseManageList.getColumn(this.ds_edcCrseManageList.rowposition, "TRNSFER_YN") != '1'){
		if (this.gfn_message("confirm.삭제여부")) {  
			this.ds_edcCrseManageList.set_enableevent(false);
			var nRow = this.ds_edcCrseManageList.rowposition;
			this.ds_edcCrseManageList.deleteRow(nRow);
			this.ds_edcCrseManageList.set_enableevent(true);
		}	
	} else {
		this.gfn_message("info.처리불가", "이관이 완료되어 실행할 수 없습니다.");
	}
}


/*
 * 함수명  	: fn_cancel
 * 설명 		: 취소 버튼 이벤트 처리(Dataset 변경 내역 Reset)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_cancel();
 */
this.fn_cancel = function()
{
	if(Ex.util.isUpdated(this.ds_edcCrseManageList)
		|| Ex.util.isUpdated(this.ds_grupEdcTrgterManageList)) {
		if(!this.gfn_message("confirm.변경.취소.여부")) {
			return false;	// 아니오
		}
	}

	if (this.gfn_message("confirm.취소여부")) {
		this.ds_edcCrseManageList.reset();			//DATASET ROLLBACK
		this.ds_edcCrseManageList.applyChange();	//DATASET COMMIT
		this.btn_cancelGrupEdcTrgterManage_onclick();
		return;
	}
}




/*
 * 함수명  	: btn_move_onclick
 * 설명 		: 전체사원 목록에서 선택한 사원 대상자 그리드로 옮기는 작업
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_move_onclick
 */
this.btn_move_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var ecmRow = this.ds_edcCrseManageList.rowposition;
	var edcTime = this.ds_edcCrseManageList.getColumn(ecmRow, "EDC_TIME");
	
	var dsChkEmp = new Dataset(); 
	dsChkEmp = this.gfn_getCheckData(this.grd_empList, "CHK");
	for(var i=0; i<dsChkEmp.getRowCount(); i++){
		var empno = dsChkEmp.getColumn(i, "EMPNO");
		var findRow = this.ds_grupEdcTrgterManageList.findRow("EMPNO", empno);
		
		// 사원이 없을 때
		if(findRow == -1) {
			var nRow = this.ds_grupEdcTrgterManageList.addRow();
			this.ds_grupEdcTrgterManageList.setColumn(nRow, "YEAR"   	 , this.ds_cond.getColumn(0, "YEAR"));
			this.ds_grupEdcTrgterManageList.setColumn(nRow, "SN"   		 , this.ds_edcCrseManageList.getColumn(this.ds_edcCrseManageList.rowposition, "SN"));
			this.ds_grupEdcTrgterManageList.setColumn(nRow, "DEPT_CODE"  , dsChkEmp.getColumn(i, "DEPT_CODE"));
			this.ds_grupEdcTrgterManageList.setColumn(nRow, "DEPT_NM"    , dsChkEmp.getColumn(i, "DEPT_NM"));
			this.ds_grupEdcTrgterManageList.setColumn(nRow, "JSSFC_SE"   , dsChkEmp.getColumn(i, "JSSFC_SE"));
			this.ds_grupEdcTrgterManageList.setColumn(nRow, "JSSFC_NM"   , dsChkEmp.getColumn(i, "JSSFC_NM"));
			this.ds_grupEdcTrgterManageList.setColumn(nRow, "HR_CLSF_SE" , dsChkEmp.getColumn(i, "HR_CLSF_NM"));
			this.ds_grupEdcTrgterManageList.setColumn(nRow, "HR_CLSF_SE" , dsChkEmp.getColumn(i, "HR_CLSF_NM"));
			this.ds_grupEdcTrgterManageList.setColumn(nRow, "OFCPS_SE"   , dsChkEmp.getColumn(i, "OFCPS_SE"));
			this.ds_grupEdcTrgterManageList.setColumn(nRow, "OFCPS_NM"   , dsChkEmp.getColumn(i, "OFCPS_NM"));
			this.ds_grupEdcTrgterManageList.setColumn(nRow, "EMPNO"      , dsChkEmp.getColumn(i, "EMPNO"));
			this.ds_grupEdcTrgterManageList.setColumn(nRow, "EMPNM"      , dsChkEmp.getColumn(i, "EMPNM"));
			this.ds_grupEdcTrgterManageList.setColumn(nRow, "PARTCPTN_AT", "1");
			this.ds_grupEdcTrgterManageList.setColumn(nRow, "EDC_RCOGN_TIME", edcTime);
			this.ds_grupEdcTrgterManageList.setColumn(nRow, "EDC_TIME"      , edcTime);
		}
	} 
}


/*
 * 함수명  	: btn_edcTySearch_onclick
 * 설명 		: 검색_교육유형 팝업 호출
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_edcTySearch_onclick
 */
this.div_edcTySearch_s_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{

	var schYear = this.ds_cond.getColumn(0, "YEAR");
	var parm = {
	   arg_0      : this
	  , year      : schYear
	  , formId    : "HRM080207"
	};
	this.gfn_popup("popEdcTy_s", 500, 465, "", parm, "mis_hrm::HRM080207_P01.xfdl", "fn_popEdcTyCallBack", true);
}



/*
 * 함수명  	: btn_edcClSearch_onclick
 * 설명 		: 검색_교육분류(역량) 팝업 호출
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_edcClSearch_onclick
 */
this.div_edcClSearch_s_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{

	var schYear = this.ds_cond.getColumn(0, "YEAR");
	var parm = {
	    arg_0      : this
	  , year      : schYear
	};
	this.gfn_popup("popEdcCl_s", 500, 465, "", parm, "mis_hrm::HRM080207_P02.xfdl", "fn_popEdcClCallBack", true);
}


/*
 * 함수명  	: btn_edcTySearch_onclick
 * 설명 		: 교육유형 팝업 호출
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_edcTySearch_onclick
 */
this.div_edcTySearch_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{

	var schYear = this.ds_cond.getColumn(0, "YEAR");
	var parm = {
	   arg_0      : this
	  , year      : schYear
	  , formId    : "HRM080207"
	};
	this.gfn_popup("popEdcTy", 500, 465, "", parm, "mis_hrm::HRM080207_P01.xfdl", "fn_popEdcTyCallBack", true);
}



/*
 * 함수명  	: btn_edcClSearch_onclick
 * 설명 		: 교육분류(역량) 팝업 호출
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_edcClSearch_onclick
 */
this.div_edcClSearch_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{

	var schYear = this.ds_cond.getColumn(0, "YEAR");
	var parm = {
	    arg_0      : this
	  , year      : schYear
	};
	this.gfn_popup("popEdcCl", 500, 465, "", parm, "mis_hrm::HRM080207_P02.xfdl", "fn_popEdcClCallBack", true);
}



/*
 * 함수명  	: fn_callback2
 * 설명 		: 교육유형 팝업 호출
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_callback2
 */
this.fn_popEdcTyCallBack = function(sPopupId, sReturn)
{
	if(sPopupId == "popEdcTy" || sPopupId == "popEdcTy_s")
	{
		var dsTemp = new Dataset();
		var loadCnt = dsTemp.loadXML(sReturn);
        if(loadCnt) {
			if(sPopupId == "popEdcTy") {
				this.ds_edcCrseManageList.setColumn(this.ds_edcCrseManageList.rowposition, "EDC_TY_SN", 	dsTemp.getColumn(0, "SN"));
				this.edt_edcTyNm.set_value(dsTemp.getColumn(0, "EDC_TY_LCLAS")+" - "+dsTemp.getColumn(0, "EDC_TY_SCLAS"));
			}else {
				this.ds_cond.setColumn(0, "EDC_TY_SN", dsTemp.getColumn(0, "SN"));
				this.div_search.edt_edcTyNm_s.set_value(dsTemp.getColumn(0, "EDC_TY_LCLAS")+" - "+dsTemp.getColumn(0, "EDC_TY_SCLAS"));
			}
        }
	}
}

/*
 * 함수명  	: fn_callback3
 * 설명 		: 교육유형 팝업 콜백 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_callback3
 */
this.fn_popEdcClCallBack = function(sPopupId, sReturn)
{
	if(sPopupId == "popEdcCl" || sPopupId == "popEdcCl_s")
	{
		var dsTemp = new Dataset();
		var loadCnt = dsTemp.loadXML(sReturn);
		
        if(loadCnt){
			if(sPopupId == "popEdcCl") {
				this.ds_edcCrseManageList.setColumn(this.ds_edcCrseManageList.rowposition, "EDC_CL_SN", 	dsTemp.getColumn(0, "SN"));
				this.edt_edcClNm.set_value(dsTemp.getColumn(0, "ABILITY_SE_NM")+" - "+dsTemp.getColumn(0, "ABILITY_NM"));
			}else {
				this.ds_cond.setColumn(0, "EDC_CL_SN_SN", dsTemp.getColumn(0, "SN"));
				this.div_search.edt_edcClNm_s.set_value(dsTemp.getColumn(0, "ABILITY_SE_NM")+" - "+dsTemp.getColumn(0, "ABILITY_NM"));
			}
		}
	}
}


 /*
 * 함수명  	: edt_edcTyNm_s_onkeyup
 * 설명 		: 검색조건 교육유형명 지울 때 데이터셋에서 교육유형값 지우기
 * params  		: None
 * return Type 	: None
 * 사용법		: this.edt_edcTyNm_s_onkeyup();
 */
this.div_search_edt_edcTyNm_s_onchanged = function(obj:Edit, e:nexacro.KeyEventInfo)
{
	if(this.comUtils.isNull()) {
		this.div_search.edt_edcTyNm_s.set_value("");
		this.ds_cond.setColumn(0, "EDC_TY_SN", "");
	}
}


 /*
 * 함수명  	: edt_edcClNm_s_onkeyup
 * 설명 		: 검색조건 교육분류(역량)명 지울 때 데이터셋에서 교육분류값 지우기
 * params  		: None
 * return Type 	: None
 * 사용법		: this.edt_edcClNm_s_onkeyup();
 */
this.div_search_edt_edcClNm_s_onchanged = function(obj:Edit, e:nexacro.KeyEventInfo)
{
	if(this.comUtils.isNull()) {
		this.div_search.edt_edcClNm_s.set_value("");
		this.ds_cond.setColumn(0, "EDC_CL_SN", "");
	}
}



 /*
 * 함수명  	: ds_cond_oncolumnchanged
 * 설명 		: 검색조건 조회년도 변경 시 다른 검색조건 초기화
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_cond_oncolumnchanged();
 */
this.ds_cond_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	if(e.columnid == "YEAR") {
		this.div_search.edt_edcTyNm_s.set_value("");
		this.div_search.edt_edcClNm_s.set_value("");
		this.ds_cond.setColumn(0, "EDC_TY_SN", "");
		this.ds_cond.setColumn(0, "EDC_CL_SN", "");
	}
}


 /*
 * 함수명  	: btn_deleteGrupEdcTrgterManage_onclick
 * 설명 		: 대상자 행삭제 
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_deleteGrupEdcTrgterManage_onclick();
 */
this.btn_deleteGrupEdcTrgterManage_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var cRowp = this.ds_grupEdcTrgterManageList.rowposition;
	this.ds_grupEdcTrgterManageList.deleteRow(cRowp);
}


 /*
 * 함수명  	: btn_cancelGrupEdcTrgterManage_onclick
 * 설명 		: 대상자 행취소    
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_cancelGrupEdcTrgterManage_onclick();
 */
this.btn_cancelGrupEdcTrgterManage_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.ds_grupEdcTrgterManageList.reset();	
	this.ds_grupEdcTrgterManageList.applyChange();
}

 /*
 * 함수명  	: ds_rwardCnferList_canrowposchange
 * 설명 		: 행 변경 전 데이터 작업 취소 여부              
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_rwardCnferList_canrowposchange();
 */
this.ds_edcCrseManageList_canrowposchange = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{
	if(obj.getRowType(e.newrow) == Dataset.ROWTYPE_INSERT) {
		return;
	}
	
	if(Ex.util.isUpdated(this.ds_edcCrseManageList) || Ex.util.isUpdated(this.ds_grupEdcTrgterManageList)) {
		if(!application.confirm("저장하지 않은 데이터가 존재합니다.\n현재 작업을 취소하시겠습까?")) {
			return false;	// 아니오
		}else {
			this.ds_edcCrseManageList.reset();
			this.ds_grupEdcTrgterManageList.reset();
			this.ds_edcCrseManageList.applyChange();
			this.ds_grupEdcTrgterManageList.applyChange();
		}
	}
}

 /*
 * 함수명  	: grd_edcCrseManageList_oncellclick
 * 설명 		: 개인별 실적 등록 데이터 이관 실행         
 * params  		: None
 * return Type 	: None
 * 사용법		: this.grd_edcCrseManageList_oncellclick();
 */
this.grd_edcCrseManageList_oncellclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	if(e.cell == 1){
		var trnYn = this.ds_edcCrseManageList.getColumn(e.row, "TRNSFER_YN");
		
		if(trnYn != '1'){
			
			var rowType = this.ds_edcCrseManageList.getRowType(e.row);
			
			if(rowType == 1){ // ROWTYPE_NORMAL
				if(this.ds_grupEdcTrgterManageList.rowcount > 0){
					if(!this.comUtils.isDatasetUpdated(this.ds_grupEdcTrgterManageList)){
						if(application.confirm("이관처리를 실행하시겠습니까?")) {
							var year = this.ds_edcCrseManageList.getColumn(e.row, "YEAR");
							var sn = this.ds_edcCrseManageList.getColumn(e.row, "SN");
							
							this.ds_cond_t.clearData();
							this.ds_cond_t.addRow();
							this.ds_cond_t.setColumn(0, "YEAR", year);
							this.ds_cond_t.setColumn(0, "SN", sn);
							
							this.fn_transaction("trnsferEdcManage");
						}
					} else {
						this.gfn_message("info.처리불가", "변경된 데이터가 존재하여 실행할 수 없습니다.");
					}
				} else {
					this.gfn_message("info.처리불가", "대상자가 존재하지 않아 실행할 수 없습니다.");
				}
			} else {
				this.gfn_message("info.처리불가", "변경된 데이터가 존재하여 실행할 수 없습니다.");
			}
			
		} else {
			this.gfn_message("info.처리불가", "이미 완료되어 실행할 수 없습니다.");
		}
	}
}

 /*
 * 함수명  	: grd_edcCrseManageList_oncellclick
 * 설명 		: 개인별 실적 등록 데이터 이관 실행         
 * params  		: None
 * return Type 	: None
 * 사용법		: this.grd_edcCrseManageList_oncellclick();
 */
this.fn_updateYn = function()
{
	return this.ds_edcCrseManageList.getColumn(this.ds_edcCrseManageList.rowposition, "TRNSFER_YN") != '1' ? true : false;
}



/*
 * 함수명  	: fn_excelUpload
 * 설명 		: 엑셀 업로드
 * params  		: None
 * return Type 	: None
 * 사용법		: this.div_work_btn_upload_onclick();
 */
this.btn_upload_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	// 데이터셋 변경 체크
    if(Ex.util.isUpdated(this.ds_grupEdcTrgterManageList)) {
        if(!this.gfn_message("confirm.변경.취소.여부")) {
            return false;
        }
    }
    
    var mRow = this.ds_edcCrseManageList.rowposition;
	var year = this.ds_edcCrseManageList.getColumn(mRow, "YEAR");
	var sn = this.ds_edcCrseManageList.getColumn(mRow, "SN");

	this.ds_cond_t.clearData();
	this.ds_cond_t.addRow();
	this.ds_cond_t.setColumn(0, "YEAR", year);
	this.ds_cond_t.setColumn(0, "SN", sn);
     	
	var arg = {
		targetDs : this.ds_import,
		headSet : false,
		callBack : function () {
						
			if(this.ds_import.getRowCount() > 1){
				this.ds_grupEdcTrgterManageList.clearData();
				for(i=1; i< this.ds_import.rowcount; i++) {
					
					var col0 = this.ds_import.getColumn(i, "Column0");		// 부서명
					var col1 = this.ds_import.getColumn(i, "Column1");		// 사원명
					var col2 = this.ds_import.getColumn(i, "Column2");		// 인정시간
					
					if(!this.comUtils.isNull(col0) && !this.comUtils.isNull(col1)) {
						col1 = col1.replace(/[ ]/g, "");
						if(this.ds_grupEdcTrgterManageList.findRow("EMPNM", col1) == -1) {
						
								// 행추가
								var nRow = this.ds_grupEdcTrgterManageList.addRow();
								
								this.ds_grupEdcTrgterManageList.setColumn(nRow, "YEAR"          , year);    
								this.ds_grupEdcTrgterManageList.setColumn(nRow, "SN"            , sn);    
								this.ds_grupEdcTrgterManageList.setColumn(nRow, "DEPT_NM"       , col0);
								this.ds_grupEdcTrgterManageList.setColumn(nRow, "EMPNM"         , col1);    
								this.ds_grupEdcTrgterManageList.setColumn(nRow, "EDC_RCOGN_TIME", col2);   
								this.ds_grupEdcTrgterManageList.setColumn(nRow, "PARTCPTN_AT"   , "1");    
						}else {
							alert(col1+" 사원이 이미 존재합니다. 다시 한번 확인하신 후 진행해주십시오.");
							this.ds_grupEdcTrgterManageList.reset();			//DATASET ROLLBACK
							this.ds_grupEdcTrgterManageList.applyChange();
							return false;
						}
					}
				}
				this.fn_transaction("excelUpload");
			}
		}
	};
	this.gfn_importExcel(arg);
}


this.btn_download_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.gfn_exportExcel(this.grd_sample, "grd_sample");	
}

]]></Script>
  </Form>
</FDL>
