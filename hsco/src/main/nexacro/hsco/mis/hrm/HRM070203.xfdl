<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\default_typedef.xml"/>
  <Form id="HRM070203" classname="HRM070203" left="0" top="0" width="1059" height="735" titletext="해외출장신청" oninit="HRM070203_oninit" onload="HRM070203_onload">
    <Layouts>
      <Layout>
        <Div id="div_search" taborder="1" left="0" top="0" right="28" height="33" cssclass="div_WFSA_Box">
          <Layouts>
            <Layout>
              <Static id="sta_gnfdDe" taborder="33" text="조회기간" cssclass="sta_WFSA_Label" left="15" top="6" width="64" height="19"/>
              <Calendar id="cal_bgnde1" taborder="34" dateformat="yyyy-MM-dd" cssclass="cal_WF_Essential" left="79" top="6" width="110" height="19"/>
              <Calendar id="cal_bgnde2" taborder="35" dateformat="yyyy-MM-dd" cssclass="cal_WF_Essential" left="207" top="6" width="110" height="19"/>
              <Static id="sta_empnm" taborder="36" text="출장자" cssclass="sta_WFSA_Label" left="594" top="6" width="51" height="19"/>
              <Static id="sta_purps" taborder="37" text="출장부서" cssclass="sta_WFSA_Label" left="332" top="6" width="62" height="19"/>
              <Edit id="edt_purps" taborder="38" left="645" top="6" width="142" height="19"/>
              <Static id="Static04" taborder="40" text="~" left="189" top="6" width="18" height="19" style="align:center middle;"/>
              <Static id="Static00" taborder="41" text="15" visible="false" left="317" top="0" width="15" height="33" style="background:#00ffff66;"/>
              <Div id="div_DeptComp" taborder="44" url="com::deptCode.xfdl" left="409" top="5" width="170" height="21" async="false"/>
              <Static id="Static01" taborder="45" text="15" visible="false" left="394" top="0" width="15" height="33" style="background:#00ffff66;"/>
              <Static id="Static02" taborder="46" text="15" visible="false" left="579" top="0" width="15" height="33" style="background:#00ffff66;"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static03" taborder="2" text="15" visible="false" left="1031" top="0" width="15" height="735" style="background:#1b3cd23c;align:center middle;"/>
        <Static id="Static05" taborder="3" text="스&#13;&#10;크&#13;&#10;롤&#13;&#10;13" visible="false" top="0" right="0" width="13" height="735" style="background:#d07b173c;align:center middle;"/>
        <Static id="Static36" taborder="4" text="10" visible="false" left="0" top="33" right="28" height="10" style="background:#dc143c3c;align:center middle;"/>
        <Static id="Static01" taborder="5" text="5" visible="false" left="0" top="62" width="1031" height="5" style="background:#dc143c3c;align:center middle;"/>
        <Static id="sta_bsrpDtls01" taborder="6" text="개인별 국외출장내역" cssclass="sta_WF_Title02" left="0" top="43" width="140" height="19" style="align:left middle;"/>
        <Grid id="grd_indvdl" taborder="7" binddataset="ds_bsrpIndvdl" autoupdatetype="itemselect" useinputpanel="false" onexpandup="grd_indvdl_onexpandup" left="0" top="67" right="28" bottom="254" oncellclick="grd_indvdl_oncellclick" onheadclick="grd_indvdl_onheadclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="30"/>
                <Column size="80"/>
                <Column size="50"/>
                <Column size="50"/>
                <Column size="80"/>
                <Column size="230"/>
                <Column size="300"/>
                <Column size="100"/>
                <Column size="80"/>
                <Column size="60"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="120"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="checkbox" edittype="checkbox"/>
                <Cell col="1" rowspan="2" text="결재상태"/>
                <Cell col="2" colspan="2" text="부서명"/>
                <Cell col="4" cssclass="Cellgrd_WF_HeadEssential" text="사원번호"/>
                <Cell col="5" cssclass="Cellgrd_WF_HeadEssential" text="출장국가"/>
                <Cell col="6" cssclass="Cellgrd_WF_HeadEssential" text="이동경로"/>
                <Cell col="7" cssclass="Cellgrd_WF_HeadEssential" text="시작일자"/>
                <Cell col="8" cssclass="Cellgrd_WF_HeadEssential" text="시작시각"/>
                <Cell col="9" text="출장일수"/>
                <Cell col="10" text="항공운임"/>
                <Cell col="11" text="식비"/>
                <Cell col="12" text="준비금"/>
                <Cell col="13" text="총액"/>
                <Cell col="14" cssclass="Cellgrd_WF_HeadEssential" text="예산부서"/>
                <Cell row="1" col="2" text="직종"/>
                <Cell row="1" col="3" text="직급"/>
                <Cell row="1" col="4" cssclass="Cellgrd_WF_HeadEssential" text="사원명"/>
                <Cell row="1" col="5" cssclass="Cellgrd_WF_HeadEssential" text="목적지"/>
                <Cell row="1" col="6" cssclass="Cellgrd_WF_HeadEssential" text="출장목적"/>
                <Cell row="1" col="7" cssclass="Cellgrd_WF_HeadEssential" text="종료일자"/>
                <Cell row="1" col="8" cssclass="Cellgrd_WF_HeadEssential" text="종료시각"/>
                <Cell row="1" col="9" text="숙박일수"/>
                <Cell row="1" col="10" text="숙박비"/>
                <Cell row="1" col="11" text="일비"/>
                <Cell row="1" col="12" text="기타경비"/>
                <Cell row="1" col="13" text="정산금액"/>
                <Cell row="1" col="14" text="결의번호"/>
              </Band>
              <Band id="body" style="cellbackground2:#fffff2ff;">
                <Cell rowspan="2" displaytype="expr:['0','2','3'].indexOf(SANCTN_STS) &gt; -1 ? &quot;checkbox&quot; : &quot;none&quot;" style="line:2 solid silver,1 solid #ddddddff;selectline:2 solid silver,1 solid #ddddddff;" text="bind:SANC_CHK"/>
                <Cell col="1" rowspan="2" displaytype="image" style="line:2 solid silver,1 solid #ddddddff;selectline:2 solid silver,1 solid #ddddddff;" text="expr:comp.parent.fn_get_imgUrl(SANCTN_STS)"/>
                <Cell col="2" colspan="2" text="bind:DEPT_NM"/>
                <Cell col="4" text="bind:EMPNO"/>
                <Cell col="5" displaytype="normal" edittype="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'normal' : 'none'" text="bind:NATION_NM" editlimit="100" editdisplay="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'display' : 'edit'" editlengthunit="ascii"/>
                <Cell col="6" edittype="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'normal' : 'none'" style="align:left;" text="bind:MVMN_COURS" editlimit="200" editdisplay="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'display' : 'edit'" editlengthunit="ascii"/>
                <Cell col="7" displaytype="date" edittype="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'date' : 'none'" style="align:center;" text="bind:BSRP_BGNDE" calendardisplay="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'display' : 'edit'" calendardisplaynulltype="none"/>
                <Cell col="8" edittype="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'mask' : 'none'" style="align:center;" text="bind:BSRP_BEGIN_TM" mask="##:##" editdisplay="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'display' : 'edit'" editlimitbymask="both"/>
                <Cell col="9" displaytype="number" edittype="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'masknumber' : 'none'" style="align:center;" text="bind:BSRP_DAYCNT" mask="!##0" editdisplay="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'display' : 'edit'"/>
                <Cell col="10" displaytype="number" edittype="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'masknumber' : 'none'" style="align:right;" text="bind:TRNSPORT_CT" mask="!###,###,###,###,##0" editdisplay="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'display' : 'edit'"/>
                <Cell col="11" displaytype="number" edittype="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'masknumber' : 'none'" style="align:right;" text="bind:MEAL_CT" mask="!###,###,###,###,##0" editdisplay="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'display' : 'edit'"/>
                <Cell col="12" displaytype="number" style="align:right;" text="bind:PRPARE_CT" mask="!###,###,###,###,##0"/>
                <Cell col="13" displaytype="number" style="align:right;" text="bind:TRVCT_TOTAMT" mask="!###,###,###,###,##0"/>
                <Cell col="14" text="bind:BUDGET_DEPT_NM" expandshow="expr:CONFM_AT == '1' ? 'hide' : UPDATE_POSBL_AT == '1' ? 'show' : 'hide'"/>
                <Cell row="1" col="2" style="line:2 solid silver,1 solid #ddddddff;selectline:2 solid silver,1 solid #ddddddff;" text="bind:JSSFC_NM"/>
                <Cell row="1" col="3" style="line:2 solid silver,1 solid #ddddddff;selectline:2 solid silver,1 solid #ddddddff;" text="bind:CLSF_NM"/>
                <Cell row="1" col="4" style="line:2 solid silver,1 solid #ddddddff;selectline:2 solid silver,1 solid #ddddddff;" text="bind:EMPNM" expandshow="expr:CONFM_AT == '1' ? 'hide' : dataset.getRowType(currow) == Dataset.ROWTYPE_INSERT ? 'show' : 'hide'"/>
                <Cell row="1" col="5" edittype="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'normal' : 'none'" style="align:left;line:2 solid silver,1 solid #ddddddff;selectline:2 solid silver,1 solid #ddddddff;" text="bind:DSTN_NM" editlimit="100" editdisplay="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'display' : 'edit'" editlengthunit="ascii"/>
                <Cell row="1" col="6" edittype="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'normal' : 'none'" style="align:left;line:2 solid silver,1 solid #ddddddff;selectline:2 solid silver,1 solid #ddddddff;" text="bind:BSRP_PURPS" editlimit="200" editdisplay="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'display' : 'edit'" editlengthunit="ascii"/>
                <Cell row="1" col="7" displaytype="date" edittype="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'date' : 'none'" style="align:center;line:2 solid silver,1 solid #ddddddff;selectline:2 solid silver,1 solid #ddddddff;" text="bind:BSRP_ENDDE" calendardisplay="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'display' : 'edit'" calendardisplaynulltype="none"/>
                <Cell row="1" col="8" edittype="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'mask' : 'none'" style="align:center;line:2 solid silver,1 solid #ddddddff;selectline:2 solid silver,1 solid #ddddddff;" text="bind:BSRP_END_TM" mask="##:##" editdisplay="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'display' : 'edit'" editlimitbymask="both"/>
                <Cell row="1" col="9" displaytype="number" edittype="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'masknumber' : 'none'" style="align:center;line:2 solid silver,1 solid #ddddddff;selectline:2 solid silver,1 solid #ddddddff;" text="bind:STAYNG_DAYCNT" mask="!##0" editdisplay="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'display' : 'edit'"/>
                <Cell row="1" col="10" displaytype="number" edittype="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'masknumber' : 'none'" style="align:right;line:2 solid silver,1 solid #ddddddff;selectline:2 solid silver,1 solid #ddddddff;" text="bind:STAYNG_CT" mask="!###,###,###,###,##0" editdisplay="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'display' : 'edit'"/>
                <Cell row="1" col="11" displaytype="number" edittype="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'masknumber' : 'none'" style="align:right;line:2 solid silver,1 solid #ddddddff;selectline:2 solid silver,1 solid #ddddddff;" text="bind:DAIL_CT" mask="!###,###,###,###,##0" editdisplay="expr:CONFM_AT == '1' ? 'none' : UPDATE_POSBL_AT == '1' ? 'display' : 'edit'"/>
                <Cell row="1" col="12" displaytype="number" style="align:right;line:2 solid silver,1 solid #ddddddff;selectline:2 solid silver,1 solid #ddddddff;" text="bind:ETC_EXPENS" mask="!###,###,###,###,##0"/>
                <Cell row="1" col="13" displaytype="number" style="align:right;line:2 solid silver,1 solid #ddddddff;selectline:2 solid silver,1 solid #ddddddff;" text="bind:EXCCLC_AMOUNT" mask="!###,###,###,###,##0"/>
                <Cell row="1" col="14" style="line:2 solid silver,1 solid #ddddddff;selectline:2 solid silver,1 solid #ddddddff;" text="bind:DECSN_NO"/>
              </Band>
              <Band id="summary">
                <Cell/>
                <Cell col="1"/>
                <Cell col="2"/>
                <Cell col="3"/>
                <Cell col="4"/>
                <Cell col="5"/>
                <Cell col="6"/>
                <Cell col="7"/>
                <Cell col="8"/>
                <Cell col="9"/>
                <Cell col="10"/>
                <Cell col="11"/>
                <Cell col="12"/>
                <Cell col="13"/>
                <Cell col="14"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static02" taborder="9" text="10" visible="false" left="0" top="480" right="28" height="10" style="background:#dc143c3c;align:center middle;"/>
        <Tab id="tab_bsrp" taborder="10" bottom="0" height="245" tabindex="0" scrollbars="autoboth" style="buttonpadding:8 20 8 20;showextrabutton:false;" left="0" right="28">
          <Tabpages>
            <Tabpage id="tabpage1" text="현지활동 및 기타경비 상세">
              <Layouts>
                <Layout>
                  <Grid id="grd_indvdlExpens" taborder="7" binddataset="ds_indvdlExpens" autoupdatetype="itemselect" useinputpanel="false" left="5" top="29" right="5" bottom="5">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="100"/>
                          <Column size="120"/>
                          <Column size="200"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="No"/>
                          <Cell col="1" cssclass="Cellgrd_WF_HeadEssential" text="경비구분"/>
                          <Cell col="2" cssclass="Cellgrd_WF_HeadEssential" text="사용경비"/>
                          <Cell col="3" text="내역명"/>
                        </Band>
                        <Band id="body">
                          <Cell text="expr:currow+1"/>
                          <Cell col="1" displaytype="combo" edittype="expr:comp.parent.parent.parent.fn_update_at() ? 'combo' : 'none'" text="bind:EXPENS_SE" combodataset="ds_hrm027" combocodecol="CODE" combodatacol="CODE_NM" combodisplaynulltext="선택" combodisplay="expr:comp.parent.parent.parent.fn_update_at() ? 'display' : 'edit'"/>
                          <Cell col="2" displaytype="number" edittype="expr:comp.parent.parent.parent.fn_update_at() ? 'masknumber' : 'none'" style="align:right;" text="bind:USE_EXPENS" mask="!###,###,###,###,##0" editdisplay="expr:comp.parent.parent.parent.fn_update_at() ? 'display' : 'edit'"/>
                          <Cell col="3" edittype="expr:comp.parent.parent.parent.fn_update_at() ? 'normal' : 'none'" style="align:left;" text="bind:DTLS_NM" editlimit="200" editdisplay="expr:comp.parent.parent.parent.fn_update_at() ? 'display' : 'edit'" editlengthunit="ascii"/>
                        </Band>
                        <Band id="summary">
                          <Cell/>
                          <Cell col="1"/>
                          <Cell col="2" displaytype="number" text="expr:dataset.getSum(&quot;USE_EXPENS&quot;)"/>
                          <Cell col="3"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Button id="btn_Can_R01" taborder="8" text="행취소" onclick="btn_Can_R01_onclick" cssclass="btn_WF_Gridcnl" top="5" right="0" width="64" height="19"/>
                  <Button id="btn_Add_R01" taborder="9" text="행추가" onclick="btn_Add_R01_onclick" cssclass="btn_WF_Gridadd" top="5" right="134" width="64" height="19"/>
                  <Button id="btn_Del_R01" taborder="10" text="행삭제" onclick="btn_Del_R01_onclick" cssclass="btn_WF_Griddel" top="5" right="67" width="64" height="19"/>
                  <Static id="Static07" taborder="11" text="5" visible="false" left="0" top="24" right="0" height="5" style="background:#dc143c3c;align:center middle;"/>
                  <Static id="Static02" taborder="12" text="5" visible="false" left="0" top="0" right="0" height="5" style="background:#dc143c3c;align:center middle;"/>
                  <Static id="sta_useDtls01" taborder="13" text="경비상세정보" cssclass="sta_WF_Title02" left="5" top="4" width="196" height="21"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage2" text="첨부파일">
              <Layouts>
                <Layout>
                  <Grid id="grd_cmmnAtchmnfl" taborder="10" binddataset="ds_fileList" autoenter="select" useinputpanel="false" cellsizingtype="col" autofittype="col" onheadclick="grd_cmmnAtchmnfl_onheadclick" left="5" top="29" right="5" bottom="5">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="300"/>
                          <Column size="80"/>
                          <Column size="80"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="checkbox" edittype="checkbox"/>
                          <Cell col="1" celltype="head" text="파일명"/>
                          <Cell col="2" text="확장자"/>
                          <Cell col="3" text="사이즈"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="checkbox" edittype="checkbox" text="bind:CHK"/>
                          <Cell col="1" displaytype="normal" style="align:left middle;" text="bind:ORGINL_FILE_NM"/>
                          <Cell col="2" text="bind:FILE_EXTSN"/>
                          <Cell col="3" text="bind:FILE_MG"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static07" taborder="11" text="5" visible="false" left="0" top="24" right="0" height="5" style="background:#dc143c3c;align:center middle;"/>
                  <Static id="Static02" taborder="12" text="5" visible="false" left="0" top="0" right="0" height="5" style="background:#dc143c3c;align:center middle;"/>
                  <Static id="Static00" taborder="13" text="5" visible="false" left="524" top="484" width="508" height="5" style="background:#dc143c3c;align:center middle;"/>
                  <Button id="btn_delFiles" taborder="14" text="선택삭제" onclick="btn_delFiles_onclick" cssclass="btn_WF_Process" top="5" right="159" width="67" height="19"/>
                  <Button id="btn_uploadFiles" taborder="15" text="파일업로드" onclick="btn_uploadFiles_onclick" cssclass="btn_WF_Process" top="5" right="88" width="68" height="19"/>
                  <Button id="btn_downFiles" taborder="16" text="선택다운로드" onclick="btn_downFiles_onclick" cssclass="btn_WF_Process" top="5" right="0" width="85" height="19"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item11" compid="Div00.edt_allot02" propid="value" datasetid="ds_bsrpIndvdl" columnid="NATION_NM"/>
      <BindItem id="item25" compid="Div00.Spin00" propid="value" datasetid="ds_bsrpIndvdl" columnid="BSRP_DAYCNT"/>
      <BindItem id="item27" compid="Div00.Spin03" propid="value" datasetid="ds_bsrpIndvdl" columnid="STAYNG_DAYCNT"/>
      <BindItem id="item28" compid="Div00.edt_allot00" propid="value" datasetid="ds_bsrpIndvdl" columnid="DSTN_NM"/>
      <BindItem id="item29" compid="Div00.edt_allot01" propid="value" datasetid="ds_bsrpIndvdl" columnid="MVMN_COURS"/>
      <BindItem id="item30" compid="Div00.Combo03" propid="value" datasetid="ds_bsrpIndvdl" columnid="TFCMN_SE"/>
      <BindItem id="item31" compid="Div00.edt_allot04" propid="value" datasetid="ds_bsrpIndvdl" columnid="DEPT_NM"/>
      <BindItem id="item32" compid="Div00.edt_allot03" propid="value" datasetid="ds_bsrpIndvdl" columnid="EMPNM"/>
      <BindItem id="item33" compid="Div00.cal_stdrDe01" propid="value" datasetid="ds_bsrpIndvdl" columnid="BSRP_ENDDE"/>
      <BindItem id="item34" compid="Div00.cal_stdrDe00" propid="value" datasetid="ds_bsrpIndvdl" columnid="BSRP_BGNDE"/>
      <BindItem id="item35" compid="Div00.MaskEdit09" propid="value" datasetid="ds_bsrpIndvdl" columnid="BSRP_BEGIN_TM"/>
      <BindItem id="item36" compid="Div00.MaskEdit08" propid="value" datasetid="ds_bsrpIndvdl" columnid="BSRP_END_TM"/>
      <BindItem id="item37" compid="Div00.MaskEdit07" propid="value" datasetid="ds_bsrpIndvdl" columnid="EXCCLC_AMOUNT"/>
      <BindItem id="item38" compid="Div00.MaskEdit06" propid="value" datasetid="ds_bsrpIndvdl" columnid="TRVCT_TOTAMT"/>
      <BindItem id="item39" compid="Div00.MaskEdit05" propid="value" datasetid="ds_bsrpIndvdl" columnid="ETC_EXPENS"/>
      <BindItem id="item40" compid="Div00.MaskEdit04" propid="value" datasetid="ds_bsrpIndvdl" columnid="ACPLC_ACT_CT"/>
      <BindItem id="item41" compid="Div00.MaskEdit03" propid="value" datasetid="ds_bsrpIndvdl" columnid="DAIL_CT"/>
      <BindItem id="item42" compid="Div00.MaskEdit02" propid="value" datasetid="ds_bsrpIndvdl" columnid="MEAL_CT"/>
      <BindItem id="item43" compid="Div00.MaskEdit01" propid="value" datasetid="ds_bsrpIndvdl" columnid="STAYNG_CT"/>
      <BindItem id="item44" compid="Div00.MaskEdit00" propid="value" datasetid="ds_bsrpIndvdl" columnid="TRNSPORT_CT"/>
      <BindItem id="item45" compid="Div00.edt_allot09" propid="value" datasetid="ds_bsrpIndvdl" columnid="BUDGET_DEPT_NM"/>
      <BindItem id="item46" compid="Div00.txt_frmla" propid="value" datasetid="ds_bsrpIndvdl" columnid="RM"/>
      <BindItem id="item0" compid="div_search.cal_bgnde1" propid="value" datasetid="ds_cond" columnid="BGNDE"/>
      <BindItem id="item1" compid="div_search.cal_bgnde2" propid="value" datasetid="ds_cond" columnid="ENDDE"/>
      <BindItem id="item4" compid="div_search.edt_purps" propid="value" datasetid="ds_cond" columnid="BSRP_NM"/>
    </Bind>
    <Objects>
      <Dataset id="ds_cond_sub" useclientlayout="true">
        <ColumnInfo>
          <Column id="EMPNO" type="STRING" size="256"/>
          <Column id="BSRP_SEQ" type="STRING" size="256"/>
          <Column id="FILE_SN" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_hrm027" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_frmtnPd_onrowposchanged">
        <ColumnInfo>
          <Column id="ETC1" type="string" size="32"/>
          <Column id="VAL2" type="string" size="32"/>
          <Column id="CODE_CN" type="string" size="32"/>
          <Column id="VAL1" type="string" size="32"/>
          <Column id="USE_YN" type="string" size="32"/>
          <Column id="ETC3" type="string" size="32"/>
          <Column id="VAL4" type="string" size="32"/>
          <Column id="ETC2" type="string" size="32"/>
          <Column id="VAL3" type="string" size="32"/>
          <Column id="CODE_ORDR" type="bigdecimal" size="16"/>
          <Column id="MSTK_VAL" type="string" size="32"/>
          <Column id="ALL_CODE_NM" type="string" size="32"/>
          <Column id="CODE_NM" type="string" size="32"/>
          <Column id="INT_VAL" type="string" size="32"/>
          <Column id="GRP_CODE" type="string" size="32"/>
          <Column id="CODE" type="string" size="32"/>
          <Column id="VAL0" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_indvdlExpens" useclientlayout="true" oncolumnchanged="ds_indvdlExpens_oncolumnchanged">
        <ColumnInfo>
          <Column id="EMPNO" type="STRING" size="256"/>
          <Column id="BSRP_SEQ" type="STRING" size="256"/>
          <Column id="SEQ" type="STRING" size="256"/>
          <Column id="EXPENS_SE" type="STRING" size="256"/>
          <Column id="DTLS_NM" type="STRING" size="256"/>
          <Column id="USE_EXPENS" type="BIGDECIMAL" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_bsrpIndvdl" useclientlayout="true" onrowposchanged="ds_bsrpIndvdl_onrowposchanged" oncolumnchanged="ds_bsrpIndvdl_oncolumnchanged" canrowposchange="ds_bsrpIndvdl_canrowposchange">
        <ColumnInfo>
          <Column id="EMPNO" type="STRING" size="256"/>
          <Column id="EMPNM" type="STRING" size="256"/>
          <Column id="BSRP_SEQ" type="STRING" size="256"/>
          <Column id="JSSFC_SE" type="STRING" size="256"/>
          <Column id="JSSFC_NM" type="STRING" size="256"/>
          <Column id="CLSF_NM" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="BSRP_PURPS" type="STRING" size="256"/>
          <Column id="MVMN_COURS" type="STRING" size="256"/>
          <Column id="DSTN_NM" type="STRING" size="256"/>
          <Column id="NATION_NM" type="STRING" size="256"/>
          <Column id="BSRP_BGNDE" type="STRING" size="256"/>
          <Column id="BSRP_BEGIN_TM" type="STRING" size="256"/>
          <Column id="BSRP_ENDDE" type="STRING" size="256"/>
          <Column id="BSRP_END_TM" type="STRING" size="256"/>
          <Column id="BSRP_DAYCNT" type="BIGDECIMAL" size="256"/>
          <Column id="STAYNG_DAYCNT" type="BIGDECIMAL" size="256"/>
          <Column id="TRNSPORT_CT" type="BIGDECIMAL" size="256"/>
          <Column id="STAYNG_CT" type="BIGDECIMAL" size="256"/>
          <Column id="MEAL_CT" type="BIGDECIMAL" size="256"/>
          <Column id="DAIL_CT" type="BIGDECIMAL" size="256"/>
          <Column id="ACPLC_ACT_CT" type="BIGDECIMAL" size="256"/>
          <Column id="ETC_EXPENS" type="BIGDECIMAL" size="256"/>
          <Column id="TRVCT_TOTAMT" type="BIGDECIMAL" size="256"/>
          <Column id="EXCCLC_AMOUNT" type="BIGDECIMAL" size="256"/>
          <Column id="FILE_SN" type="STRING" size="256"/>
          <Column id="SANCTN_NO" type="STRING" size="256"/>
          <Column id="SANCTN_STS" type="STRING" size="256"/>
          <Column id="BUDGET_DEPT_CODE" type="STRING" size="256"/>
          <Column id="BUDGET_DEPT_NM" type="STRING" size="256"/>
          <Column id="DECSN_YEAR" type="STRING" size="256"/>
          <Column id="DECSN_NO" type="STRING" size="256"/>
          <Column id="CONFM_AT" type="STRING" size="256"/>
          <Column id="REGIST_DT" type="STRING" size="256"/>
          <Column id="UPDATE_POSBL_AT" type="STRING" size="256"/>
          <Column id="SANC_CHK" type="STRING" size="256"/>
          <Column id="PRPARE_CT" type="STRING" size="256"/>
          <Column id="EXPENS_LIST" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_fileList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="PROGRS" type="BIGDECIMAL" size="16"/>
          <Column id="ORGINL_FILE_NM" type="string" size="32"/>
          <Column id="FILE_EXTSN" type="string" size="32"/>
          <Column id="FILE_STRE_COURS" type="string" size="32"/>
          <Column id="FILE_ID" type="string" size="32"/>
          <Column id="SN" type="bigdecimal" size="16"/>
          <Column id="SYS_SE_CODE" type="string" size="32"/>
          <Column id="FILE_IMAGE" type="string" size="32"/>
          <Column id="FILE_TY" type="string" size="32"/>
          <Column id="JOB_SE" type="string" size="32"/>
          <Column id="DELETE_IMAGE" type="string" size="32"/>
          <Column id="STRE_FILE_NM" type="string" size="32"/>
          <Column id="FILE_MG" type="bigdecimal" size="16"/>
          <Column id="FILE_CN" type="string" size="32"/>
          <Column id="FILE_ORDR" type="bigdecimal" size="16"/>
          <Column id="TRNSMIS_FILE_SIZE" type="string" size="32"/>
          <Column id="USE_AT" type="string" size="32"/>
          <Column id="STTUS" type="string" size="32"/>
          <Column id="FILE_SN" type="bigdecimal" size="16"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond" useclientlayout="true">
        <ColumnInfo>
          <Column id="BGNDE" type="STRING" size="256"/>
          <Column id="ENDDE" type="STRING" size="256"/>
          <Column id="BSRP_NM" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="WHTHRC_AT" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="WHTHRC_AT"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_validation" firefirstcount="0" firenextcount="0" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" useclientlayout="true">
        <ColumnInfo>
          <Column id="compId" type="STRING" size="256"/>
          <Column id="colId" type="STRING" size="256"/>
          <Column id="msgId" type="STRING" size="256"/>
          <Column id="PK" type="STRING" size="256"/>
          <Column id="notNull" type="STRING" size="256"/>
          <Column id="nlength" type="STRING" size="256"/>
          <Column id="lengthChkGb" type="STRING" size="256"/>
          <Column id="type" type="STRING" size="256"/>
          <Column id="from" type="STRING" size="256"/>
          <Column id="to" type="STRING" size="256"/>
          <Column id="expr" type="STRING" size="256"/>
          <Column id="func" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="colId">BGNDE</Col>
            <Col id="msgId">조회시작일</Col>
            <Col id="lengthChkGb"/>
            <Col id="nlength"/>
            <Col id="compId">ds_cond</Col>
            <Col id="notNull">Y</Col>
            <Col id="from"/>
            <Col id="to"/>
            <Col id="expr"/>
          </Row>
          <Row>
            <Col id="colId">ENDDE</Col>
            <Col id="msgId">조회종료일</Col>
            <Col id="lengthChkGb"/>
            <Col id="nlength"/>
            <Col id="compId">ds_cond</Col>
            <Col id="notNull">Y</Col>
          </Row>
          <Row>
            <Col id="compId">ds_cond</Col>
            <Col id="colId">ENDDE</Col>
            <Col id="msgId">조회기간 종료일^조회기간 시작일</Col>
            <Col id="from">BGNDE</Col>
            <Col id="expr"/>
          </Row>
          <Row>
            <Col id="colId">EMPNO</Col>
            <Col id="compId">ds_bsrpIndvdl</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">출장자</Col>
            <Col id="PK"/>
          </Row>
          <Row>
            <Col id="compId">ds_bsrpIndvdl</Col>
            <Col id="colId">NATION_NM</Col>
            <Col id="msgId">출장국가</Col>
            <Col id="notNull">Y</Col>
          </Row>
          <Row>
            <Col id="compId">ds_bsrpIndvdl</Col>
            <Col id="colId">DSTN_NM</Col>
            <Col id="msgId">목적지</Col>
            <Col id="notNull">Y</Col>
          </Row>
          <Row>
            <Col id="colId">MVMN_COURS</Col>
            <Col id="compId">ds_bsrpIndvdl</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">이동경로</Col>
            <Col id="nlength"/>
            <Col id="type"/>
            <Col id="lengthChkGb"/>
          </Row>
          <Row>
            <Col id="colId">BSRP_PURPS</Col>
            <Col id="compId">ds_bsrpIndvdl</Col>
            <Col id="msgId">출장목적</Col>
            <Col id="notNull">Y</Col>
          </Row>
          <Row>
            <Col id="colId">BSRP_BGNDE</Col>
            <Col id="compId">ds_bsrpIndvdl</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">출장시작일</Col>
            <Col id="from"/>
            <Col id="to"/>
            <Col id="expr"/>
          </Row>
          <Row>
            <Col id="colId">BSRP_ENDDE</Col>
            <Col id="compId">ds_bsrpIndvdl</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">출장종료일</Col>
          </Row>
          <Row>
            <Col id="compId">ds_bsrpIndvdl</Col>
            <Col id="colId">BSRP_ENDDE</Col>
            <Col id="msgId">출장종료일자^출장시작일자</Col>
            <Col id="from">BSRP_BGNDE</Col>
          </Row>
          <Row>
            <Col id="compId">ds_bsrpIndvdl</Col>
            <Col id="colId">BSRP_BEGIN_TM</Col>
            <Col id="msgId">출장시작시각</Col>
            <Col id="PK"/>
            <Col id="notNull">Y</Col>
            <Col id="nlength"/>
            <Col id="lengthChkGb"/>
            <Col id="type"/>
            <Col id="from"/>
            <Col id="to"/>
            <Col id="expr"/>
            <Col id="func"/>
          </Row>
          <Row>
            <Col id="compId">ds_bsrpIndvdl</Col>
            <Col id="colId">BSRP_END_TM</Col>
            <Col id="msgId">출장종료시각</Col>
            <Col id="PK"/>
            <Col id="notNull">Y</Col>
            <Col id="nlength"/>
            <Col id="lengthChkGb"/>
            <Col id="type"/>
            <Col id="from"/>
            <Col id="to"/>
            <Col id="expr"/>
            <Col id="func"/>
          </Row>
          <Row>
            <Col id="compId">ds_bsrpIndvdl</Col>
            <Col id="colId">BUDGET_DEPT_CODE</Col>
            <Col id="msgId">예산부서</Col>
            <Col id="PK">[Undefined]</Col>
            <Col id="notNull">Y</Col>
          </Row>
          <Row>
            <Col id="colId">EXPENS_SE</Col>
            <Col id="msgId">경비구분</Col>
            <Col id="notNull">Y</Col>
            <Col id="compId">ds_indvdlExpens</Col>
          </Row>
          <Row>
            <Col id="colId">USE_EXPENS</Col>
            <Col id="msgId">사용경비</Col>
            <Col id="notNull">Y</Col>
            <Col id="compId">ds_indvdlExpens</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Script type="xscript5.0"><![CDATA[
/***********************************************************************
 * Script Include 
************************************************************************/

include "lib::comInclude.xjs";
include "mis_lib::misUtil.xjs";
include "lib::comUpDownUtils.xjs";



/***********************************************************************
 * 화면 변수 선언부
************************************************************************/

this.saveRow = -1;
this.File_UpDownManager = null;
this.acplcActCt = 0;
this.etcExpens = 0;
this.isAuth = false;
/***********************************************************************
 * onInit / onLoad 영역
************************************************************************/

this.HRM070203_oninit = function(obj:Form, e:nexacro.InitEventInfo)
{

}

this.HRM070203_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{	
	// Form 초기화
	this.fn_init_form();

	// DataSet 초기화
	this.fn_init_dataset();


	/* 권한 해제 요청 */
	if(this.gfn_authGrpId("HRM_ADMIN") != -1 || this.gfn_authGrpId("HRM_SRVIC") != -1) {// 이때는 담당자 플래그 true로 바꿔서 권한분리 부탁드립니다.
		this.isAuth = true;
	}else {
		this.isAuth = false;
	}
	
	// 검색조건 영역 바인딩
	this.div_search.div_DeptComp.fn_setBind("ds_cond","DEPT_CODE","DEPT_NM");
	this.div_search.div_DeptComp.fn_setReadonly(true);
	this.div_search.div_DeptComp.div_Search.btn_dept.set_visible(false);
	this.div_search.div_DeptComp.fn_setCssclass("edt_WF_Readonly");
	
	if(this.isAuth) {
		this.div_search.div_DeptComp.fn_setReadonly(false);
		this.div_search.div_DeptComp.div_Search.btn_dept.set_visible(true);
		this.div_search.div_DeptComp.fn_setCssclass("");
	}

	var comboParams = [
		["ds_hrm027", "HRM027", "1", "D"]			// 출장경비 구분
	];
	var callback = function (svcId, errorCode, errorMsg) { 
		this.tab_bsrp.tabpage1.btn_Add_R01.set_enable(false);
		this.tab_bsrp.tabpage1.btn_Can_R01.set_enable(false);
		this.tab_bsrp.tabpage1.btn_Del_R01.set_enable(false);
		
		this.tab_bsrp.tabpage2.btn_delFiles.set_enable(false);
		this.tab_bsrp.tabpage2.btn_uploadFiles.set_enable(false);
		
		this.ds_cond.clearData();
		var nRow = this.ds_cond.addRow();
		this.ds_cond.setColumn(nRow, "BGNDE",     this.dateUtils.addMonth(this.dateUtils.today(), -5, 's'));
		this.ds_cond.setColumn(nRow, "ENDDE",     this.dateUtils.today());
		this.ds_cond.setColumn(nRow, "DEPT_CODE", this.gfn_getDeptId());
		this.ds_cond.setColumn(nRow, "DEPT_NM",   this.gfn_getDeptName());
		
		this.fn_search();
	}
	this.gfn_comboLoad(comboParams, callback);
}



/**********************************************************************
* Form/Dataset 오브젝트 초기화
***********************************************************************/
/*
 * 함수명  	: initForm
 * 설명 		: Form을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.init_Form();
 */
this.fn_init_form = function()
{
	this.gfn_initForm(this);	// 시스템 공통으로 Form을 Initialize 한다.
	this.fn_misFormInit(this);
}


/*
 * 함수명  	: initDataset
 * 설명 		: Dataset을 초기화한다
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initDataset();
 */
this.fn_init_dataset = function()
{
	var fileConfig = {
      useMultiUpload : true,
      onChange: this.fn_onFileSelected,   // 파일 선택 이벤트 핸들러
      onSuccess : this.fn_onFileSuccess   // 전송 성공 이벤트 핸들러
   };
   this.File_UpDownManager = new this.fileUpDownManager(this, "MIS", "HRM");
   this.File_UpDownManager.init(fileConfig);
}



/**********************************************************************
* Transaction 영역 시작
***********************************************************************
*
* 1. Transaction 관련 이벤트 핸들러
* 2. call Transaction 영역
* 3. callback 영역(Transaction, Popup)
* 
***********************************************************************/



/**********************************************************************
* Transaction 관련 이벤트 핸들러 
***********************************************************************/

/*
 * 함수명  	: fn_search
 * 설명 		: 조회 이벤트 처리(휴직내역)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_search();
 */
this.fn_search = function()
{
	// validation 체크
	if(!this.gfn_checkValidation_NoUpdChk(this.ds_cond, this.ds_validation)) {
		return;
	}
	
	this.ds_bsrpIndvdl.clearData();
	this.ds_indvdlExpens.clearData();
	this.ds_fileList.clearData();
	
	this.fn_transaction("selectBsrpIndvdl");
}



/**********************************************************************
* call Transaction 영역
***********************************************************************/

/*
 * 함수명  	: fn_transaction
 * 설명 		: Transaction 요청 처리 함수
 * params  		: strSvcId : 서비스요청 ID
 * return Type 	: None
 * 사용법		: this.fn_transaction("SELECT");
 */
this.fn_transaction = function(strSvcId)
{
	switch (strSvcId) {
		case "selectBsrpIndvdl":	// 개인별 출장내역 조회
			var sController   	= "/hsco/mis/hrm/HRM070203/selectBsrpIndvdl.do";
			var sInDatasets   	= "input1=ds_cond";
			var sOutDatasets  	= "ds_bsrpIndvdl=output1";
			break;
		case "selectIndvdlExpens":	// 출장비 상세내역, 첨부파일 조회
			var sController   	= "/hsco/mis/hrm/HRM070203/selectIndvdlExpens.do";
			var sInDatasets   	= "input1=ds_cond_sub";
			var sOutDatasets  	= "ds_indvdlExpens=output1 ";		// 출장비 상세내역
			sOutDatasets       += "ds_fileList=output2";			// 첨부파일
			break;
		case "saveBsrpDtl":			// 출장내역 저장
			var sController   	= "/hsco/mis/hrm/HRM070203/saveBsrpDtl.do";
			var sInDatasets   	= "input1=ds_bsrpIndvdl:U input2=ds_indvdlExpens:U";
			var sOutDatasets  	= "";
			break;
	}
	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets); 
}



/**********************************************************************
* Transaction Callback 영역
***********************************************************************/

 /*
 * 함수명  	: fn_callBack
 * 설명 		: Transaction Callback 처리
 * params  		: strSvcId    : 서비스요청 ID
 *                nErrorCode  : 오류 메시지 코드 ([예] 0 : Success, 그밖의 경우, error)
 *                strErrorMsg : 오류 메시지([예]  success.insert|정상적으로 등록되었습니다.)
 * return Type 	: None
 * 사용법		: 
 */
this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg)
{
	if(nErrorCode != '0') {
		this.gfn_callback_message(strSvcId, nErrorCode, strErrorMsg);
	}

	if (nErrorCode == 0){
		switch (strSvcId) {
			case "selectBsrpIndvdl":	// 개인별 출장내역 조회
				break;
			case "selectIndvdlExpens":	// 출장비상세내역 조회
				break;
				break;
			case "saveBsrpDtl":	// 출장내역 저장
				this.gfn_message("success.처리.성공");
				this.fn_search();
				break;
		}
	}
}


/*
 * 함수명  	: fn_popupCallBack
 * 설명 		: Popup Callback 처리
 * params  		: sPopupId    : 팝업 ID
 *                sReturn  : 팝업 처리 결과(dataset.saveXML())
 * return Type 	: None
 * 사용법		: 
 */
this.fn_popupCallback = function(sPopupId, sReturn)
{
	var ds_Popup = new Dataset();
	var loadCnt = ds_Popup.loadXML(sReturn);
	var nRow    = this.ds_bsrpIndvdl.rowposition;
	
	if(loadCnt){
		if(sPopupId == "empPop") {	// 개인별출장-사원항목
			var DeptCode  = ds_Popup.getColumn(0, "DEPT_CODE");
			var DeptNm    = ds_Popup.getColumn(0, "DEPT_NM");
			var EmpCode   = ds_Popup.getColumn(0, "EMPNO");
			var EmpNm     = ds_Popup.getColumn(0, "EMPNM");
			var JssfcSe   = ds_Popup.getColumn(0, "JSSFC_SE");
			var JssfcNm   = ds_Popup.getColumn(0, "JSSFC_NM");
			var ClseNm    = ds_Popup.getColumn(0, "HR_CLSF_NM");
			
			this.ds_bsrpIndvdl.setColumn(nRow, "DEPT_CODE", DeptCode);
			this.ds_bsrpIndvdl.setColumn(nRow, "DEPT_NM",   DeptNm);
			this.ds_bsrpIndvdl.setColumn(nRow, "EMPNO",     EmpCode);
			this.ds_bsrpIndvdl.setColumn(nRow, "EMPNM",     EmpNm);
			this.ds_bsrpIndvdl.setColumn(nRow, "JSSFC_SE",  JssfcSe);
			this.ds_bsrpIndvdl.setColumn(nRow, "JSSFC_NM",  JssfcNm);
			this.ds_bsrpIndvdl.setColumn(nRow, "CLSF_NM",   ClseNm);
			this.ds_bsrpIndvdl.setColumn(nRow, "BUDGET_DEPT_CODE", DeptCode);
			this.ds_bsrpIndvdl.setColumn(nRow, "BUDGET_DEPT_NM",   DeptNm);
			
			var cnt = this.ds_indvdlExpens.rowcount;
			for(i=0; i<cnt; i++){
				this.ds_indvdlExpens.setColumn(i, "EMPNO", EmpCode);
			}
			
		} else if(sPopupId == "deptPop") {	// 개인별출장-예산부서항목
			var DeptCode  = ds_Popup.getColumn(0, "DEPT_CODE");
			var DeptNm    = ds_Popup.getColumn(0, "DEPT_NM");
			this.ds_bsrpIndvdl.setColumn(nRow, "BUDGET_DEPT_CODE", DeptCode);
			this.ds_bsrpIndvdl.setColumn(nRow, "BUDGET_DEPT_NM",   DeptNm);
			
		}
	}
}



/**********************************************************************
* Transaction 영역 끝
***********************************************************************/


/**********************************************************************
* non-Transaction 관련 컴포넌트 이벤트 처리 함수
***********************************************************************
*
* 1. Gird 관련 이벤트 처리
* 2. 공통함수
* 3. 사용자 정의 함수
* 
***********************************************************************/



/**********************************************************************
* Grid 관련 이벤트 처리
***********************************************************************/



/**********************************************************************
* 공통함수 처리
***********************************************************************/

/*
 * 함수명  	: fn_insert
 * 설명 		: 신규 버튼 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_insert();
 */
this.fn_insert = function()
{
	var nRow = this.ds_bsrpIndvdl.addRow();
	this.ds_bsrpIndvdl.setColumn(nRow, "SANCTN_STS",  '0');
	this.ds_bsrpIndvdl.setColumn(nRow, "UPDATE_POSBL_AT",  '1');
	this.ds_bsrpIndvdl.setColumn(nRow, "BSRP_BGNDE",  this.dateUtils.today());
	this.ds_bsrpIndvdl.setColumn(nRow, "BSRP_BEGIN_TM",  '0900');
	this.ds_bsrpIndvdl.setColumn(nRow, "BSRP_ENDDE",  this.dateUtils.today());
	this.ds_bsrpIndvdl.setColumn(nRow, "BSRP_END_TM",  '1800');
}

/*
 * 함수명  	: fn_save
 * 설명 		: 저장 버튼 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_save();
 */
this.fn_save = function()
{	
	// update check
	if (   !this.comUtils.isDatasetUpdated(this.ds_bsrpIndvdl)			// 개인별출장내역
		&& !this.comUtils.isDatasetUpdated(this.ds_indvdlExpens)		// 출장경비상세
	   ) {
		this.gfn_message("comm.데이터.변경.없음");
		return false;
	}
	
	// validation check
	if(!this.gfn_checkValidation_NoUpdChk(this.ds_bsrpIndvdl, this.ds_validation)) {			// 개인별출장내역
		return;
	}
	
	// 개인별출장내역 출장시간 입력 범위 정합성 체크
	var rowCnt = this.ds_bsrpIndvdl.rowcount;
	
	for(i=0; i<rowCnt; i++){
		var rowType = this.ds_bsrpIndvdl.getRowType(i);
		
		if(rowType == Dataset.ROWTYPE_INSERT || rowType == Dataset.ROWTYPE_UPDATE){
			//시작일시, 종료일시는 필수값.
			var stime = this.ds_bsrpIndvdl.getColumn(i, "BSRP_BEGIN_TM");
			var etime = this.ds_bsrpIndvdl.getColumn(i, "BSRP_END_TM");
			
			//시작시간 체크
			if (stime != "" && typeof stime != "undefined"){
				if (!this.comUtils.isTime(stime)){
					this.gfn_message("info.처리불가", "출장 시작시간은 00:00~23:59 사이여야 합니다.");
					return;
				}
			}
			//종료시간 체크
			if (etime != "" && typeof etime != "undefined"){
				if (!this.comUtils.isTime(etime)){
					this.gfn_message("info.처리불가", "출장 종료시간은 00:00~23:59 사이여야 합니다.");
					return; 
				}
			}
			
			var sd = this.ds_bsrpIndvdl.getColumn(i, "BSRP_BGNDE");
			var ed = this.ds_bsrpIndvdl.getColumn(i, "BSRP_ENDDE");
			
			var startDate = new Date(sd.substr(0,4)+"/"+sd.substr(4,2)+"/"+sd.substr(6,2)+" "+stime.substr(0,2)+":"+stime.substr(2,2)+":"+"00");
			var endDate  = new Date(ed.substr(0,4)+"/"+ed.substr(4,2)+"/"+ed.substr(6,2)+" "+etime.substr(0,2)+":"+etime.substr(2,2)+":"+"00");
			var tmp = endDate.getTime() - startDate.getTime();
			
			if(tmp < 0){
				this.gfn_message("errors.종료일자.시작일자.이상", "출장|출장");
				return;
			}
		}
	}

	if(!this.gfn_checkValidation_NoUpdChk(this.ds_indvdlExpens, this.ds_validation)) {		// 출장경비상세
		return;
	}
        
	// update check
	if(this.comUtils.isDatasetUpdated(this.ds_indvdlExpens)) {
		var acplcAct = 0;
		var etcExpens = 0;
		for(var i = 0; i < this.ds_indvdlExpens.getRowCount(); i++){
			var expensSe = this.ds_indvdlExpens.getColumn(i, "EXPENS_SE");
			if(expensSe == "001"){
				acplcAct += this.ds_indvdlExpens.getColumn(i, "USE_EXPENS");
			}else{
				etcExpens += this.ds_indvdlExpens.getColumn(i, "USE_EXPENS");
			}
		}
		this.ds_bsrpIndvdl.setColumn(this.ds_bsrpIndvdl.rowposition, "ACPLC_ACT_CT", acplcAct);
		this.ds_bsrpIndvdl.setColumn(this.ds_bsrpIndvdl.rowposition, "ETC_EXPENS"  , etcExpens);
	}

	this.fn_transaction("saveBsrpDtl");
}


/*
 * 함수명  	: fn_delete
 * 설명 		: 삭제 이벤트 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_delete();
 */
this.fn_delete = function()
{
	if(this.ds_bsrpIndvdl.rowposition > -1){
		
		var updatePosblAt = this.ds_bsrpIndvdl.getColumn(this.ds_bsrpIndvdl.rowposition, "UPDATE_POSBL_AT");
		var confmAt  = this.ds_bsrpIndvdl.getColumn(this.ds_bsrpIndvdl.rowposition, "CONFM_AT");
		
		if(updatePosblAt == '1' && confmAt != '1'){
			
			if(this.gfn_message("confirm.삭제여부")){
				
				//this.ds_carAlcFlwpsgList.clearData();
				//this.ds_carAlcInfo.clearData();
				this.ds_indvdlExpens.clearData();
				this.ds_bsrpIndvdl.deleteRow(this.ds_bsrpIndvdl.rowposition);
				
			}
		} else {
			this.gfn_message("info.처리불가", "현재 출장건은 수정할 수 없습니다.");
		}
	}
}


/*
 * 함수명  	: fn_cancel
 * 설명 		: 취소 버튼 이벤트 처리(Dataset 변경 내역 Reset)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_cancel();
 */
this.fn_cancel = function()
{
	if (this.gfn_message("confirm.취소여부")) {
		this.ds_bsrpIndvdl.reset();			//DATASET ROLLBACK
		this.ds_bsrpIndvdl.applyChange();	//DATASET COMMIT
		return;
	}
}


/***********************************************************************************
* 설명	: 결재
***********************************************************************************/
this.grd_indvdl_onheadclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	if(e.cell == 0) {
		this.ds_bsrpIndvdl.set_updatecontrol(false);
		this.ds_bsrpIndvdl.set_enableevent(false);
		this.allChk = this.allChk == '1' ? '0' : '1';
		for(var i = 0; i < this.ds_bsrpIndvdl.getRowCount(); i++) {
			if(['0','2','3'].indexOf(this.ds_bsrpIndvdl.getColumn(i, "SANCTN_STS")) > -1) {
				this.ds_bsrpIndvdl.setColumn(i, "SANC_CHK", this.allChk);
			}
		}
		this.ds_bsrpIndvdl.set_enableevent(true);
		this.ds_bsrpIndvdl.set_updatecontrol(true);
	}
}

this.grd_indvdl_oncellclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	if(e.col == '0') {
		if(this.ds_bsrpIndvdl.getRowType(e.row) != Dataset.ROWTYPE_NORMAL){
			this.gfn_message("info.진행가능","변경된 정보를 저장");
			return;
		}
		
		var fRow = this.ds_bsrpIndvdl.rowposition;
		var sancChk = this.ds_bsrpIndvdl.getColumn(fRow, "SANC_CHK");
		sancChk = sancChk == '1' ? '0' : '1';
		
		this.ds_bsrpIndvdl.set_updatecontrol(false);
		this.ds_bsrpIndvdl.set_enableevent(false);
		this.ds_bsrpIndvdl.setColumn(fRow, "SANC_CHK", sancChk);
		this.ds_bsrpIndvdl.set_enableevent(true);
		this.ds_bsrpIndvdl.set_updatecontrol(true);
	}
}



this.fn_sanction = function()
{
	if(this.comUtils.isDatasetUpdated(this.ds_bsrpIndvdl)) {
		this.gfn_message("comm.정보.저장.요청", "출장신청");
		return;
	}
   
	// 결재 전 유효성 체크
	var sancRowCount = this.ds_bsrpIndvdl.getCaseCount("SANC_CHK == '1'");
	if(sancRowCount < 1) {
		this.gfn_message("info.선택데이터.없음.선택.요청");
		return;
	}

	// 결재상신
	var canclAt         = "0";
	var subject         = "출장신청";
	var cnt 			= 0;
	var deptNm			= "";
	var mvmnCours		= "";
	var info			= new Array(11);
	var arrSancData 	= new Array(111);
	var arrSancSubData  = new Array();
	
	for(var i = 0; i < this.ds_bsrpIndvdl.rowcount; i++){
		if(this.ds_bsrpIndvdl.getColumn(i, "SANC_CHK") == '1'){
			var trnsportCt = this.ds_bsrpIndvdl.getColumn(i, "TRNSPORT_CT");
			if(!this.comUtils.isNull(trnsportCt)) {
				trnsportCt = "항공운임 " + this.comUtils.formatComma(trnsportCt) + "원 ";
			} else {
				trnsportCt = "";
			}
			
			var stayngCt = this.ds_bsrpIndvdl.getColumn(i, "STAYNG_CT");
			if(!this.comUtils.isNull(stayngCt)) {
				stayngCt = "숙박비 " + this.comUtils.formatComma(stayngCt) + "원 ";
			} else {
				stayngCt = "";
			}
			
			var mealCt = this.ds_bsrpIndvdl.getColumn(i, "MEAL_CT");
			if(!this.comUtils.isNull(mealCt)) {
				mealCt = "식비 " + this.comUtils.formatComma(mealCt) + "원 ";
			} else {
				mealCt = "";
			}
			
			var dailCt = this.ds_bsrpIndvdl.getColumn(i, "DAIL_CT");
			if(!this.comUtils.isNull(dailCt)) {
				dailCt = "일비 " + this.comUtils.formatComma(dailCt) + "원 ";
			} else {
				dailCt = "";
			}
			
// 			// 경비상세정보
//  			var detail = "";
//  			var expensSeText = "";
//  			for(var d = 0; d < this.ds_indvdlExpens.rowcount; d++) {
//  				var expensSe = this.ds_indvdlExpens.getColumn(d, "EXPENS_SE");
//  				var useExpens = this.ds_indvdlExpens.getColumn(d, "USE_EXPENS");
//  				var dtlsNm = this.ds_indvdlExpens.getColumn(d, "DTLS_NM");
//  				
//  				var hrm027Row = this.ds_hrm027.findRow("CODE", expensSe);
//  				var expensNm = this.ds_hrm027.getColumn(hrm027Row, "CODE_NM");	// 출장경비명
// 					
// 				trace("expensSe : "+expensSe+", dtlsNm : "+dtlsNm+", hrm027Row : "+hrm027Row+", expensNm : "+expensNm);
// 				detail += expensNm+" "+ this.comUtils.formatComma(useExpens) + "원";
// 				detail += (!this.comUtils.isNull(dtlsNm) ? "("+dtlsNm+") " :  " ");
//  			}
			
			// 여비
			var trvctTot = nexacro.toNumber(this.ds_bsrpIndvdl.getColumn(i, "TRVCT_TOTAMT"), 0, 0, 0);
			trvctTot = this.comUtils.formatComma(trvctTot.toString());
			
			// 경비상세정보
			var detail = !this.comUtils.isNull(this.ds_bsrpIndvdl.getColumn(i, "EXPENS_LIST")) ? this.ds_bsrpIndvdl.getColumn(i, "EXPENS_LIST") : "";
			
			// 정산
			var excclcAmt = trnsportCt + stayngCt + mealCt + dailCt + detail;
			
			var bsrpBgnde = this.dateUtils.format(this.ds_bsrpIndvdl.getColumn(i, "BSRP_BGNDE"), "yyyy. mm. dd");
			var bsrpEndde = this.dateUtils.format(this.ds_bsrpIndvdl.getColumn(i, "BSRP_ENDDE"), "yyyy. mm. dd");
			
			var bsrpBgnTm = this.comUtils.formatMask(this.ds_bsrpIndvdl.getColumn(i, "BSRP_BEGIN_TM"), "##:##");
			var bsrpEndTm = this.comUtils.formatMask(this.ds_bsrpIndvdl.getColumn(i, "BSRP_END_TM"), "##:##");
			
			// 출장목적
			var bsrpPurps = this.ds_bsrpIndvdl.getColumn(i, "BSRP_PURPS");
		
			info= [
				 this.ds_bsrpIndvdl.getColumn(i, "DEPT_NM")		// 부서
				,this.ds_bsrpIndvdl.getColumn(i, "CLSF_NM")		// 직급
				,this.ds_bsrpIndvdl.getColumn(i, "EMPNM")		// 성명
				,bsrpBgnde + ' ' + bsrpBgnTm					// 부터
				,bsrpEndde + ' ' + bsrpEndTm					// 까지
				,this.ds_bsrpIndvdl.getColumn(i, "NATION_NM")	// 출장국가
				,this.ds_bsrpIndvdl.getColumn(i, "DSTN_NM")		// 목적지
				,this.ds_bsrpIndvdl.getColumn(i, "MVMN_COURS")	// 이동경로
				,bsrpPurps										// 출장목적
				,excclcAmt										// 정산
				,trvctTot										// 총액
			];
			
			if(cnt == 0) {
				canclAt     = this.ds_bsrpIndvdl.getColumn(i, "CANCL_AT");
				deptNm 		= this.ds_bsrpIndvdl.getColumn(i, "DEPT_NM");
				mvmnCours	= this.ds_bsrpIndvdl.getColumn(i, "MVMN_COURS");
			}
			
			if(cnt < 10) {			
				arrSancData[  1 + cnt*11] = this.ds_bsrpIndvdl.getColumn(i, "DEPT_NM");     // 부서
				arrSancData[  2 + cnt*11] = this.ds_bsrpIndvdl.getColumn(i, "CLSF_NM");     // 직급
				arrSancData[  3 + cnt*11] = this.ds_bsrpIndvdl.getColumn(i, "EMPNM");       // 성명
				arrSancData[  4 + cnt*11] = bsrpBgnde + ' ' + bsrpBgnTm;					// 부터
				arrSancData[  5 + cnt*11] = bsrpEndde + ' ' + bsrpEndTm;					// 까지
				arrSancData[  6 + cnt*11] = this.ds_bsrpIndvdl.getColumn(i, "NATION_NM");   // 출장국가
				arrSancData[  7 + cnt*11] = this.ds_bsrpIndvdl.getColumn(i, "DSTN_NM");		// 목적지
				arrSancData[  8 + cnt*11] = this.ds_bsrpIndvdl.getColumn(i, "MVMN_COURS");	// 이동경로
				arrSancData[  9 + cnt*11] = bsrpPurps;										// 출장목적
				arrSancData[ 10 + cnt*11] = excclcAmt;										// 정산
				arrSancData[ 11 + cnt*11] = trvctTot;										// 총액
			} 
// 			else {
// 				arrSancSubData.push(info[0]);
// 				arrSancSubData.push(info[1]);
// 				arrSancSubData.push(info[2]);
// 				arrSancSubData.push(info[3]);
// 				arrSancSubData.push(info[4]);
// 				arrSancSubData.push(info[5]);
// 				arrSancSubData.push(info[6]);
// 				arrSancSubData.push(info[7]);
// 				arrSancSubData.push(info[8]);
// 				arrSancSubData.push(info[9]);
// 				arrSancSubData.push(info[10]);
// 			}
			cnt++;
		}
	}
	if(canclAt == "1"){
		subject = "출장취소신청";
	}
	if(cnt > 1) {
		arrSancData[ 0] = deptNm + " "+ arrSancData[5] + " 외 "+ (cnt - 1) + "건의 " + subject; //결재제목
	} else {
		arrSancData[ 0] = deptNm + " "+ arrSancData[5] + " " + subject; //결재제목
	}
	
	this.fn_callHandySanc2(
		 this						// context
		,'0000000085'				// formId
		,this.ds_bsrpIndvdl			// misDataset
		,"TBHRM_BSRP_INDVDL"		// tableName
		,["EMPNO", "BSRP_SEQ"]		// tableKey
		,arrSancData				// arrSancData
		,null						// arrSancSubData
		,"SANC_CHK"					// multiCheck(0 or 1)
// 		,null						// otherColumn
// 		,this.ds_fileList			// file Dataset
	);
}

/**********************************************************************
* 사용자 정의 함수
***********************************************************************/

/*
 * 함수명  	: fn_get_imgUrl
 * 설명 		: 전자결재종류 이미지 경로 리턴 함수
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_get_imgUrl();
 */
this.fn_get_imgUrl = function(sanctnSts)
{
	return this.gfn_getSanctnImgUrl(sanctnSts);
}

/*
 * 함수명  	: fn_get_imgUrl
 * 설명 		: 업데이트 가능 여부 리턴 함수
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_get_imgUrl();
 */
this.fn_update_at = function()
{	
	var confmAt = this.ds_bsrpIndvdl.getColumn(this.ds_bsrpIndvdl.rowposition, "CONFM_AT");
	var updateAt = this.ds_bsrpIndvdl.getColumn(this.ds_bsrpIndvdl.rowposition, "UPDATE_POSBL_AT");
	
	if(confmAt != '1' && updateAt == '1' ){
		return true;
	} else {
		return false;
	}
	
	//return this.ds_bsrpIndvdl.getColumn(this.ds_bsrpIndvdl.rowposition, "UPDATE_POSBL_AT") == '1' ? true : false;
	
}

/*
 * 함수명  	: fn_cal_etcAmt
 * 설명 		: 현지활동 및 기타경비 합계 계산 함수
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_cal_etcAmt();
 */
this.fn_cal_etcAmt = function(){
	var acplcActCt = this.ds_indvdlExpens.getCaseSum("EXPENS_SE == '001'", "USE_EXPENS");
	var etcExpens =  this.ds_indvdlExpens.getCaseSum("EXPENS_SE == '002'", "USE_EXPENS");
	var prpareCt =  this.ds_indvdlExpens.getCaseSum("EXPENS_SE == '003'", "USE_EXPENS");
	
	this.ds_bsrpIndvdl.setColumn(this.ds_bsrpIndvdl.rowposition, "ACPLC_ACT_CT", acplcActCt);
	this.ds_bsrpIndvdl.setColumn(this.ds_bsrpIndvdl.rowposition, "ETC_EXPENS", etcExpens);
	this.ds_bsrpIndvdl.setColumn(this.ds_bsrpIndvdl.rowposition, "PRPARE_CT", prpareCt);
}

/**********************************************************************
* Dataset 관련 이벤트 처리
***********************************************************************/

/*
 * 함수명  	: ds_bsrpIndvdl_canrowposchange
 * 설명 		: Dataset 행 변경 전 이벤트 처리(개인별출장)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_bsrpIndvdl_canrowposchange(obj,e);
 */
this.ds_bsrpIndvdl_canrowposchange = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{
	// 데이터셋 수정 여부체크(경비상세)
	if (this.comUtils.isDatasetUpdated(this.ds_indvdlExpens)) {
		obj.setColumn(e.oldrow, "ACPLC_ACT_CT", this.acplcActCt);
		obj.setColumn(e.oldrow, "ETC_EXPENS", this.etcExpens);
	}
}


/*
 * 함수명  	: ds_bsrpIndvdl_canrowposchange
 * 설명 		: Dataset 행 변경 후 이벤트 처리(개인별출장)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_bsrpIndvdl_canrowposchange(obj,e);
 */
this.ds_bsrpIndvdl_onrowposchanged = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{
	this.ds_indvdlExpens.clearData();
	this.ds_fileList.clearData();
	
	this.tab_bsrp.tabpage1.btn_Add_R01.set_enable(false);
	this.tab_bsrp.tabpage1.btn_Can_R01.set_enable(false);
	this.tab_bsrp.tabpage1.btn_Del_R01.set_enable(false);
	
	this.tab_bsrp.tabpage2.btn_delFiles.set_enable(false);
	this.tab_bsrp.tabpage2.btn_uploadFiles.set_enable(false);
		
	if(e.newrow>-1) {
		this.acplcActCt = obj.getColumn(e.newrow, "ACPLC_ACT_CT");	// 현지활동비 전역변수
		this.etcExpens = obj.getColumn(e.newrow, "ETC_EXPENS");		// 기타경비 전역변수
		
		var updateAt  = obj.getColumn(e.newrow, "UPDATE_POSBL_AT");	// 개인별 출장내역 업데이트 가능 여부(0:불가능, 1:가능)
		var confmAt  = obj.getColumn(e.newrow, "CONFM_AT");
		
		if(updateAt != '0' && confmAt != '1'){										// 업데이트 가능
			this.tab_bsrp.tabpage1.btn_Add_R01.set_enable(true);
			this.tab_bsrp.tabpage1.btn_Can_R01.set_enable(true);
			this.tab_bsrp.tabpage1.btn_Del_R01.set_enable(true);
			
			this.tab_bsrp.tabpage2.btn_delFiles.set_enable(true);
			this.tab_bsrp.tabpage2.btn_uploadFiles.set_enable(true);
		}
		
		if(obj.getRowType(e.newrow) != Dataset.ROWTYPE_INSERT) {	// 개인별출장의 현재 행 상태가 신규가 아닐때만 하단의 상세정보를 조회
			
			// 경비상세정보 검색조건 설정
			this.ds_cond_sub.clearData();
			this.ds_cond_sub.addRow();
			this.ds_cond_sub.setColumn(0, "EMPNO", obj.getColumn(e.newrow, "EMPNO"));			// 츨장비 상새내역 조회 검색조건 설정
			this.ds_cond_sub.setColumn(0, "BSRP_SEQ", obj.getColumn(e.newrow, "BSRP_SEQ"));		// 츨장비 상새내역 조회 검색조건 설정
			this.ds_cond_sub.setColumn(0, "FILE_SN", obj.getColumn(e.newrow, "FILE_SN"));		// 첨부파일조회 검색조건 설정
			this.fn_transaction("selectIndvdlExpens");
		}
	}
}

/*
 * 함수명  	: ds_bsrpIndvdl_oncolumnchanged
 * 설명 		: Dataset 데이터 변경 후 이벤트 처리(개인별출장)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_bsrpIndvdl_oncolumnchanged(obj,e);
 */
this.ds_bsrpIndvdl_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	if(e.columnid == "BSRP_BEGIN_TM") {
 		var newValue = e.newvalue.replace(/\s/g, '0');
 		obj.setColumn(e.row, e.columnid, newValue);
 		
	} else if(e.columnid == "BSRP_END_TM") {
 		var newValue = e.newvalue.replace(/\s/g, '0');
 		obj.setColumn(e.row, e.columnid, newValue);
 		
	} else if(e.columnid == "TRNSPORT_CT" || e.columnid == "STAYNG_CT" || e.columnid == "MEAL_CT" 
	       || e.columnid == "DAIL_CT" || e.columnid == "ACPLC_ACT_CT" || e.columnid == "ETC_EXPENS" || e.columnid == "ETC_EXPENS"){
			
		var temp1 = this.comUtils.isNull(obj.getColumn(e.row, "TRNSPORT_CT")) ? 0 : obj.getColumn(e.row, "TRNSPORT_CT");
		var temp2 = this.comUtils.isNull(obj.getColumn(e.row, "STAYNG_CT")) ? 0 : obj.getColumn(e.row, "STAYNG_CT");
		var temp3 = this.comUtils.isNull(obj.getColumn(e.row, "MEAL_CT")) ? 0 : obj.getColumn(e.row, "MEAL_CT");
		var temp4 = this.comUtils.isNull(obj.getColumn(e.row, "DAIL_CT")) ? 0 : obj.getColumn(e.row, "DAIL_CT");
		var temp5 = this.comUtils.isNull(obj.getColumn(e.row, "ACPLC_ACT_CT")) ? 0 : obj.getColumn(e.row, "ACPLC_ACT_CT");
		var temp6 = this.comUtils.isNull(obj.getColumn(e.row, "ETC_EXPENS")) ? 0 : obj.getColumn(e.row, "ETC_EXPENS");
		var temp7 = this.comUtils.isNull(obj.getColumn(e.row, "PRPARE_CT")) ? 0 : obj.getColumn(e.row, "PRPARE_CT");
		
		obj.setColumn(e.row, "TRVCT_TOTAMT", temp1+temp2+temp3+temp4+temp5+temp6);
		
	}
}

/*
 * 함수명  	: ds_indvdlExpens_oncolumnchanged
 * 설명 		: Dataset 데이터 변경 후 이벤트 처리(경비상세)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.ds_indvdlExpens_oncolumnchanged(obj,e);
 */
this.ds_indvdlExpens_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	if(e.columnid == "EXPENS_SE" || e.columnid == "USE_EXPENS"){
		this.fn_cal_etcAmt();	// 현지활동 및 기타경비계산 함수
	}
}

/**********************************************************************
* Button 관련 이벤트 처리
***********************************************************************/

/*
 * 함수명  	: btn_Add_R01_onclick
 * 설명 		: '경비상세-행추가' 버튼 클릭 후 이벤트 처리(출장비 내역)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_Add_R01_onclick();
 */
this.btn_Add_R01_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var updatePosblAt = this.ds_bsrpIndvdl.getColumn(this.ds_bsrpIndvdl.rowposition, "UPDATE_POSBL_AT");
	
	if(this.ds_bsrpIndvdl.rowposition > -1){
		if(updatePosblAt == '1'){
			var nRow = this.ds_indvdlExpens.addRow();
			this.ds_indvdlExpens.setColumn(nRow, "EMPNO", this.ds_bsrpIndvdl.getColumn(this.ds_bsrpIndvdl.rowposition, "EMPNO"));
			this.ds_indvdlExpens.setColumn(nRow, "BSRP_SEQ", this.ds_bsrpIndvdl.getColumn(this.ds_bsrpIndvdl.rowposition, "BSRP_SEQ"));
			this.ds_indvdlExpens.setColumn(nRow , "USE_EXPENS", 0);
		} else {
			this.gfn_message("info.처리불가", "현재 출장건은 수정할 수 없습니다.");
		}
	}
}


/*
 * 함수명  	: btn_Del_R01_onclick
 * 설명 		: '경비상세-행삭제' 버튼 클릭 후 이벤트 처리(출장비 내역)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_Del_R01_onclick();
 */
this.btn_Del_R01_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var updatePosblAt = this.ds_bsrpIndvdl.getColumn(this.ds_bsrpIndvdl.rowposition, "UPDATE_POSBL_AT");
	
	if(this.ds_indvdlExpens.rowposition > -1) {
		if(updatePosblAt == '1'){
			if(this.gfn_message("confirm.삭제여부")){
				this.ds_indvdlExpens.deleteRow(this.ds_indvdlExpens.rowposition);
				this.fn_cal_etcAmt();	// 현지활동 및 기타경비계산 함수
			}
		} else {
			this.gfn_message("info.처리불가", "현재 출장건은 수정할 수 없습니다.");
		}
	}
}


/*
 * 함수명  	: btn_Can_R01_onclick
 * 설명 		: '경비상세-행취소' 버튼 클릭 후 이벤트 처리(출장비 내역)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_Can_R01_onclick();
 */
this.btn_Can_R01_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.gfn_message("confirm.취소여부")) {
		this.ds_indvdlExpens.reset();
		this.fn_cal_etcAmt();	// 현지활동 및 기타경비계산 함수
	}
}


/*
 * 함수명  	: btn_uploadFiles_onclick
 * 설명 		: '파일업로드' 버튼 클릭 후 이벤트 처리(출장비 내역)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_uploadFiles_onclick();
 */
this.btn_uploadFiles_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var nRow     = this.ds_bsrpIndvdl.rowposition;	
	var nRowType = this.ds_bsrpIndvdl.getRowType(nRow);
	
	if(nRow < 0){
		this.gfn_message("comm.항목.선택.요청","대상 정보");
		return;
	}
	
	if(nRowType == 2){
		this.gfn_message("info.진행가능","신규 정보를 저장");
		return;
	}
	
	// 첨부파일 업로드(fileSn 자동채번 / 첨부파일 Master에 ROW추가 / 파일 업로드 및 자동저장 / 테이블에 fileSn반영 / 데이터셋에 fileSn반영, 단 신규 ROW가 아닐경우 ROWTYPE은 유지)
	this.mCallback = function() {
		this.fn_autoFileSn(
			 "MIS"									// 대분류   (SYS_SE)
			,"HRM"									// 업무구분 (JOB_SE)
			, this.File_UpDownManager	            // fileManager 오브젝트
			, this.ds_fileList		                // fileObject
			, this.ds_bsrpIndvdl	    		    // fileSn을 불러오거나 반영해야 하는 컬럼
			, "TBHRM_BSRP_INDVDL"	            	// fileSn을 저장할 테이블
			, "FILE_SN"								// fileSn 컬럼명이 다를 경우를 대비
			, ["EMPNO", "BSRP_SEQ"]					// fileSn을 저장할 테이블의 PK (FileSn 확인 및 자동반영목적)
		);
	}
	
	this.mCallback();
}


/*
 * 함수명  	: btn_uploadFiles_onclick
 * 설명 		: '파일다운로드' 버튼 클릭 후 이벤트 처리(출장비 내역)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_uploadFiles_onclick();
 */
this.btn_downFiles_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var findRow = this.ds_fileList.findRow("CHK", "1");
	if(findRow < 0) {
		this.gfn_message("comm.데이터.선택.없음");
		return;
	}
	
	for(var fRow = 0; fRow < this.ds_fileList.getRowCount(); fRow++) {
		var fileSn    = this.ds_fileList.getColumn(fRow, "FILE_SN");
		var fileOrder = this.ds_fileList.getColumn(fRow, "FILE_ORDR");
		var fileName  = this.ds_fileList.getColumn(fRow, "ORGINL_FILE_NM");
		var chk       = this.ds_fileList.getColumn(fRow, "CHK");
		if(chk == '1') {
			this.File_UpDownManager.download(fileSn, fileOrder, fileName);
		}
	}
}


/*
 * 함수명  	: btn_delFiles_onclick
 * 설명 		: '파일삭제' 버튼 클릭 후 이벤트 처리(출장비 내역)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_delFiles_onclick();
 */
this.btn_delFiles_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var findRow = this.ds_fileList.findRow("CHK", "1");
	if(findRow < 0) {
		this.gfn_message("comm.데이터.선택.없음");
			return;
	}
	
	if(!this.gfn_message("confirm.선택파일.삭제여부", "들")){
		return false;
	}
	
	for(var fRow = this.ds_fileList.getRowCount()-1; fRow >= 0; fRow--) {
		var chkVal = this.ds_fileList.getColumn(fRow, "CHK");
		if(chkVal == '1') {
			this.ds_fileList.deleteRow(fRow);
		}
	}
	var strSvcId   	 = "deleteFile";
	var sController  = "hsco/cmm/file/deleteFile.do";
	var sInDatasets  = "input1=ds_fileList:U";
	var sOutDatasets = "ds_fileList=output1";
	
	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets); 
}

 /*
 * 함수명  	: fn_onFileSuccess
 * 설명 		: 파일 업로드 성공시 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_onFileSuccess();
 */
this.fn_onFileSuccess = function(){
	this.gfn_message("success.처리.성공");
	
	//var nRow = this.ds_bsrpIndvdl.rowposition;
	//this.ds_cond.setColumn(0, "FILE_SN", this.ds_bsrpIndvdl.getColumn(nRow, "FILE_SN"));
	
	//this.fn_transaction("selectFileList");
}

 /*
 * 함수명  	: fn_onFileError
 * 설명 		: 파일 업로드 실패시 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_onFileError();
 */
this.fn_onFileError = function(){
	
	//this.gfn_message("info.저장.초과", "이미지 파일만");	
}

/*
 * 함수명  	: file_upload_popup
 * 설명 		: 첨부파일 그리드 전체파일선택 ON/OFF 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: this.file_upload_popup(obj,e);
 */
this.grd_cmmnAtchmnfl_onheadclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	if(e.col == 0) {
		this.gfn_setGridCheckAll(obj, e);
	}
}

/*
 * 함수명  	: file_upload_popup
 * 설명 		: 첨부파일 그리드 Body의 체크 버튼이 눌러졌을 때, Head 부분의 체크 버튼을 꺼 줌.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.file_upload_popup(obj,e);
 */
this.grd_cmmnAtchmnfl_oncellclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	if(e.cell == 0) {
		obj.setCellProperty("Head", e.cell, "text", "0");
	}
}

/***********************************************************************
* 그리드 관련 이벤트 처리
************************************************************************/
/*
 * 함수명  	: grd_indvdl_onexpandup
 * 설명 		: 그리드onexpandup 이벤트 처리(개인별출장)
 * params  		: None
 * return Type 	: None
 * 사용법		: this.grd_indvdl_onexpandup();
 */
this.grd_indvdl_onexpandup = function(obj:Grid, e:nexacro.GridMouseEventInfo)
{
	if(e.cell == 13){	// 예산부서 항목
		var parm = {
			 arg_0 : this  //==> 필수, 팝업을 호출하는 form을 참조할 수 있도록 팝업에 Argument로 넘겨준다. (반드시 기술해야 함.)
		};
		this.gfn_popup("deptPop", 400, 400, "부서조회팝업", parm, "com::deptCode_P01.xfdl", "fn_popupCallback", true);
	}
	
	if(e.cell == 16){	// 출장사원 항목
		var parm = {
			 arg_0 : this  //==> 필수, 팝업을 호출하는 form을 참조할 수 있도록 팝업에 Argument로 넘겨준다. (반드시 기술해야 함.)
			,deptCd : this.ds_cond.getColumn(0, "DEPT_CODE")
		};
		this.gfn_popup("empPop", 400, 400, "사원조회팝업", parm, "com::empno_P01.xfdl", "fn_popupCallback", true);
	}
}
]]></Script>
  </Form>
</FDL>
