<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\default_typedef.xml"/>
  <Form id="HPM070202" classname="HPM070202" left="0" top="0" width="1059" height="735" titletext="환불결의서 등록(대관外)" onload="HPM070202_onload">
    <Layouts>
      <Layout>
        <Div id="div_search" taborder="0" left="0" right="28" cssclass="div_WFSA_Box" height="33" top="0">
          <Layouts>
            <Layout width="1031" height="59">
              <Static id="Static06" taborder="37" text="15" visible="false" left="0" top="0" bottom="0" width="15" style="background:#00ffff66;"/>
              <Static id="Static51" taborder="38" text="5" visible="false" left="0" top="0" right="0" height="5" style="background:#dc143c3c;align:center middle;"/>
              <Static id="Static04" taborder="39" text="5" visible="false" left="0" top="66" right="0" height="5" style="background:#dc143c3c;align:center middle;"/>
              <Static id="Static00" taborder="43" text="15" visible="false" left="280" top="0" width="15" style="background:#00ffff66;" bottom="0"/>
              <Static id="sta_searchDe04" taborder="58" text="담당부서" cssclass="sta_WFSA_Label" left="15" top="5" width="64" height="21"/>
              <Static id="sta_searchCnd" taborder="60" text="환불요청기간" cssclass="sta_WFSA_Label" left="513" top="5" width="90" height="21"/>
              <Calendar id="cal_bgnDe" taborder="61" dateformat="yyyy-MM-dd" cssclass="cal_WF_Essential" left="606" top="5" width="100" height="21"/>
              <Static id="Static03" taborder="62" text="~" left="710" top="9" width="10" height="16"/>
              <Calendar id="cal_endDe" taborder="63" dateformat="yyyy-MM-dd" cssclass="cal_WF_Essential" left="724" top="5" width="102" height="21"/>
              <Static id="sta_" taborder="65" text="진행상태" cssclass="sta_WFSA_Label" left="843" top="5" width="64" height="21"/>
              <Combo id="cmb_setleSttusSe" taborder="66" innerdataset="@ds_setleSttusSe_s" codecolumn="CODE" datacolumn="CODE_NM" left="907" top="5" width="103" height="21" onitemchanged="div_search_cmb_setleSttusSe_onitemchanged"/>
              <Div id="div_dept" taborder="75" url="com::deptCode.xfdl" left="85" top="5" width="195" height="21" enable="false" async="false"/>
              <Static id="sta_bizplcList" taborder="79" cssclass="sta_WFSA_Label" left="295" top="5" width="51" height="21" text="사업소"/>
              <Combo id="cmb_bizplcList" taborder="80" innerdataset="@ds_bizplcList" codecolumn="BIZPLC_CODE" datacolumn="BIZPLC_NM" left="346" top="5" width="150" height="21" index="-1"/>
              <Static id="Static09" taborder="81" text="5" onclick="div_search_Static02_onclick" visible="false" left="0" top="37" right="0" height="5" style="background:#dc143c3c;align:center middle;"/>
              <Static id="Static08" taborder="82" text="15" visible="false" left="496" top="5" bottom="0" width="17" style="background:#00ffff66;"/>
              <Static id="Static01" taborder="83" text="15" visible="false" left="826" top="5" bottom="0" width="17" style="background:#00ffff66;"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="sta_gnfdList" taborder="3" text="환불신청목록" cssclass="sta_WF_Title02" top="44" width="120" height="19" style="align:left middle;" left="0"/>
        <Static id="Static02" taborder="4" text="5" visible="false" left="0" top="64" right="28" height="5" style="background:#dc143c3c;align:center middle;"/>
        <Static id="Static00" taborder="5" text="15" visible="false" left="1031" top="0" width="15" height="735" style="background:#1b3cd23c;align:center middle;"/>
        <Static id="Static01" taborder="6" text="스&#13;&#10;크&#13;&#10;롤&#13;&#10;13" visible="false" top="0" right="0" width="13" height="735" style="background:#d07b173c;align:center middle;"/>
        <Grid id="grd_rentReqstManageList" taborder="7" useinputpanel="false" left="0" top="68" right="28" binddataset="ds_rentReqstManageList" cellsizingtype="col" onheadclick="grd_rentReqstManageList_onheadclick" extendsizetype="row" bottom="0" oncelldblclick="grd_rentReqstManageList_oncelldblclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="30" band="left"/>
                <Column size="40"/>
                <Column size="100"/>
                <Column size="70"/>
                <Column size="90"/>
                <Column size="200"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="150"/>
                <Column size="130"/>
                <Column size="100"/>
                <Column size="300"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="checkbox" edittype="checkbox"/>
                <Cell col="1" text="순번"/>
                <Cell col="2" text="계좌정합성여부"/>
                <Cell col="3" text="결재상태"/>
                <Cell col="4" text="결의번호"/>
                <Cell col="5" text="적요"/>
                <Cell col="6" text="환불예금주"/>
                <Cell col="7" text="환불은행"/>
                <Cell col="8" text="환불계좌번호"/>
                <Cell col="9" text="환불액"/>
                <Cell col="10" text="환불요청일"/>
                <Cell col="11" text="환불사유"/>
              </Band>
              <Band id="body">
                <Cell displaytype="expr:DECSN_NO ? 'none' :  'checkbox'" edittype="expr:DECSN_NO ? 'none' :  'checkbox'" text="bind:CHK"/>
                <Cell col="1" text="expr:currow+1"/>
                <Cell col="2" displaytype="combo" style="color:EXPR(ACNUT_STBLT_AT == '0' || ACNUT_STBLT_AT == '1' ? '#000000' : ACNUT_STBLT_AT == '3' ? '#0000ff' : '#ff0000');color2:EXPR(ACNUT_STBLT_AT == '0' || ACNUT_STBLT_AT == '1' ? '#000000' : ACNUT_STBLT_AT == '3' ? '#0000ff' : '#ff0000');" text="bind:ACNUT_STBLT_AT" combodataset="ds_acc044" combocodecol="CODE" combodatacol="CODE_NM"/>
                <Cell col="3" displaytype="image" edittype="none" text="expr:comp.parent.gfn_getSanctnImgUrl(SANCTN_KND)" combodisplay="edit"/>
                <Cell col="4" text="bind:DECSN_NO"/>
                <Cell col="5" style="align:left;" text="bind:SUMRY"/>
                <Cell col="6" text="bind:REFND_DPSTR"/>
                <Cell col="7" displaytype="combo" text="bind:REFND_BANK_CODE" combodataset="ds_com021" combocodecol="CODE" combodatacol="CODE_NM"/>
                <Cell col="8" text="bind:REFND_ACNUTNO"/>
                <Cell col="9" displaytype="number" style="align:right;" text="bind:REFND_AM"/>
                <Cell col="10" displaytype="date" text="bind:REFND_REQST_DE" calendardisplaynulltype="none"/>
                <Cell col="11" style="align:left;" text="bind:REFND_PRVONSH"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_excelUpload" taborder="38" top="43" width="88" height="21" right="28" onclick="btn_excelUpload_onclick" text="엑셀업로드"/>
        <Button id="btn_bundleConfirm" taborder="42" text="일괄결의등록" onclick="btn_bundleConfirm_onclick" top="43" right="210" width="88" height="21"/>
        <Static id="Static36" taborder="43" text="10" visible="false" left="0" top="33" width="1031" height="10" style="background:#dc143c3c;align:center middle;"/>
        <Grid id="grd_excel" taborder="44" useinputpanel="false" extendsizetype="row" cellsizingtype="col" autosizingtype="row" onheadclick="grd_rentReqstManageList_onheadclick" oncelldblclick="grd_rentReqstManageList_oncelldblclick" left="0" top="756" right="397" bottom="-209" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="200"/>
                <Column size="200"/>
                <Column size="200"/>
                <Column size="200"/>
                <Column size="130"/>
                <Column size="500"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="예금주"/>
                <Cell col="1" text="은행코드"/>
                <Cell col="2" text="계좌"/>
                <Cell col="3" text="금액"/>
                <Cell col="4" text="환불요청일"/>
                <Cell col="5" text="환불사유"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" edittype="text" text="홍길동(해당행 삭제)"/>
                <Cell col="1" displaytype="text" edittype="text" text="001"/>
                <Cell col="2" displaytype="text" edittype="text" text="000-00-000000"/>
                <Cell col="3" displaytype="text" edittype="text" text="10000"/>
                <Cell col="4" displaytype="text" edittype="text" mask="####-##-##"/>
                <Cell col="5" style="align:left;"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="grd_bank" taborder="45" useinputpanel="false" extendsizetype="row" cellsizingtype="col" autosizingtype="row" onheadclick="grd_rentReqstManageList_onheadclick" oncelldblclick="grd_rentReqstManageList_oncelldblclick" visible="false" left="680" top="756" right="41" bottom="-209" binddataset="ds_com021">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="150"/>
                <Column size="150"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="은행코드"/>
                <Cell col="1" text="은행명"/>
              </Band>
              <Band id="body">
                <Cell text="bind:CODE"/>
                <Cell col="1" text="bind:CODE_NM"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_excelDn" taborder="46" text="양식다운로드" top="43" right="119" width="88" height="21" onclick="btn_excelDn_onclick"/>
        <Static id="Static03" taborder="47" text="※중복데이터에 대한 검증 미실시(엑셀업로드 시 중복건 확인요망)" top="44" width="389" height="19" style="color:red;align:right middle;font:bold 9 Gulim;" right="403"/>
        <Grid id="grd_rentReqstManageList00" taborder="48" binddataset="ds_rentReqstManageList" useinputpanel="false" extendsizetype="row" cellsizingtype="col" onheadclick="grd_rentReqstManageList_onheadclick" oncelldblclick="grd_rentReqstManageList_oncelldblclick" left="21" top="992" right="7" bottom="-554" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="30" band="left"/>
                <Column size="40"/>
                <Column size="477"/>
                <Column size="70"/>
                <Column size="90"/>
                <Column size="200"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="150"/>
                <Column size="130"/>
                <Column size="100"/>
                <Column size="40"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="checkbox"/>
                <Cell col="1" text="순번"/>
                <Cell col="2" text="계좌정합성여부"/>
                <Cell col="3" text="결재상태"/>
                <Cell col="4" text="결의번호"/>
                <Cell col="5" text="적요"/>
                <Cell col="6" text="환불예금주"/>
                <Cell col="7" text="환불은행"/>
                <Cell col="8" text="환불계좌번호"/>
                <Cell col="9" text="환불액"/>
                <Cell col="10" text="환불요청일"/>
                <Cell col="11"/>
              </Band>
              <Band id="body">
                <Cell displaytype="expr:DECSN_NO ? 'none' : 'checkbox'" edittype="expr:DECSN_NO ? 'none' : 'checkbox'" text="bind:CHK"/>
                <Cell col="1" text="expr:currow+1"/>
                <Cell col="2" text="콤보, default(미실행)/적합(파랑)/부적합(빨간색)"/>
                <Cell col="3" displaytype="image" edittype="none" text="expr:comp.parent.gfn_getSanctnImgUrl(SANCTN_KND)" combodisplay="edit"/>
                <Cell col="4" text="bind:DECSN_NO"/>
                <Cell col="5" style="align:left;" text="bind:SUMRY"/>
                <Cell col="6" text="bind:REFND_DPSTR"/>
                <Cell col="7" displaytype="combo" text="bind:REFND_BANK_CODE" combodataset="ds_com021" combocodecol="CODE" combodatacol="CODE_NM"/>
                <Cell col="8" text="bind:REFND_ACNUTNO"/>
                <Cell col="9" displaytype="number" style="align:right;" text="bind:REFND_AM"/>
                <Cell col="10" displaytype="date" text="bind:REFND_REQST_DE" calendardisplaynulltype="none"/>
                <Cell col="11" text="bind:CHK"/>
                <Cell row="1"/>
                <Cell row="1" col="1"/>
                <Cell row="1" col="2" text="적합만 결의등록"/>
                <Cell row="1" col="3"/>
                <Cell row="1" col="4"/>
                <Cell row="1" col="5"/>
                <Cell row="1" col="6"/>
                <Cell row="1" col="7"/>
                <Cell row="1" col="8"/>
                <Cell row="1" col="9"/>
                <Cell row="1" col="10"/>
                <Cell row="1" col="11"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_acnutStblt" taborder="49" text="계좌 정합성 체크" top="43" right="300" width="99" height="21" onclick="btn_acnutStblt_onclick"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item0" compid="div_search.cal_bgnDe" propid="value" datasetid="ds_cond" columnid="BGNDE"/>
      <BindItem id="item1" compid="div_search.cal_endDe" propid="value" datasetid="ds_cond" columnid="ENDDE"/>
      <BindItem id="item6" compid="div_search.cmb_setleSttusSe" propid="value" datasetid="ds_cond" columnid="SETLE_STTUS"/>
      <BindItem id="item8" compid="div_search.cmb_bizplcList" propid="value" datasetid="ds_cond" columnid="BIZPLC_CODE"/>
    </Bind>
    <Objects>
      <Dataset id="ds_cond" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_cond_oncolumnchanged">
        <ColumnInfo>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="SETLE_SE" type="STRING" size="256"/>
          <Column id="AM_SE" type="STRING" size="256"/>
          <Column id="SETLE_STTUS" type="STRING" size="256"/>
          <Column id="BGNDE" type="STRING" size="256"/>
          <Column id="ENDDE" type="STRING" size="256"/>
          <Column id="SEARCH_CND" type="STRING" size="256"/>
          <Column id="SEARCH_CND2" type="STRING" size="256"/>
          <Column id="SEARCH_VAL" type="STRING" size="256"/>
          <Column id="FCLTS_SN" type="STRING" size="256"/>
          <Column id="DELETE_AT" type="STRING" size="256"/>
          <Column id="RENT_CANCL_AT" type="STRING" size="256"/>
          <Column id="REPORT_SE" type="STRING" size="256"/>
          <Column id="BIZPLC_CODE" type="STRING" size="256"/>
          <Column id="USE_AT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_rentReqstManageList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="SANCTN_KND" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="BIZPLC_CODE" type="STRING" size="256"/>
          <Column id="SN" type="STRING" size="256"/>
          <Column id="REFND_DPSTR" type="STRING" size="256"/>
          <Column id="REFND_BANK_CODE" type="STRING" size="256"/>
          <Column id="REFND_ACNUTNO" type="STRING" size="256"/>
          <Column id="REFND_AM" type="STRING" size="256"/>
          <Column id="REFND_REQST_DE" type="STRING" size="256"/>
          <Column id="CMPNSP_NO" type="STRING" size="256"/>
          <Column id="BCNC_CODE" type="STRING" size="256"/>
          <Column id="DECSN_YEAR" type="STRING" size="256"/>
          <Column id="DECSN_NO" type="STRING" size="256"/>
          <Column id="SEQ" type="STRING" size="256"/>
          <Column id="REGISTER_ID" type="STRING" size="256"/>
          <Column id="REGIST_DT" type="STRING" size="256"/>
          <Column id="UPDUSR_ID" type="STRING" size="256"/>
          <Column id="SUMRY" type="STRING" size="256"/>
          <Column id="ACNUT_STBLT_AT" type="STRING" size="256"/>
          <Column id="REFND_PRVONSH" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_setleSe" useclientlayout="true">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_validation" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="compId" type="STRING" size="256"/>
          <Column id="colId" type="STRING" size="256"/>
          <Column id="PK" type="STRING" size="256"/>
          <Column id="notNull" type="STRING" size="256"/>
          <Column id="type" type="STRING" size="256"/>
          <Column id="nlength" type="STRING" size="256"/>
          <Column id="from" type="STRING" size="256"/>
          <Column id="to" type="STRING" size="256"/>
          <Column id="lengthChkGb" type="STRING" size="256"/>
          <Column id="msgId" type="STRING" size="256"/>
          <Column id="expr" type="STRING" size="256"/>
          <Column id="func" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="colId">DEPT_CODE</Col>
            <Col id="compId">ds_cond</Col>
            <Col id="msgId">담당부서</Col>
            <Col id="notNull">Y</Col>
          </Row>
          <Row>
            <Col id="compId">ds_cond</Col>
            <Col id="colId">BGNDE</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">환불요청기간 시작일</Col>
          </Row>
          <Row>
            <Col id="compId">ds_cond</Col>
            <Col id="colId">ENDDE</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">황불요청기간 종료일</Col>
          </Row>
          <Row>
            <Col id="compId">ds_cond</Col>
            <Col id="colId">ENDDE</Col>
            <Col id="from">BGNDE</Col>
            <Col id="msgId">환불요청기간 종료일^황불요청기간 시작일</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_setleSttusSe" canrowposchange="ds_setleSttusSe_canrowposchange" filterstr="CODE=='006'||CODE=='007'">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="VAL0" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond2" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="SETLE_AM" type="STRING" size="256"/>
          <Column id="REQST_DE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_rcpmnyDtlsManageList">
        <ColumnInfo>
          <Column id="RCPMNY_DTLS_SN" type="STRING" size="256"/>
          <Column id="RCPMNY_DTLS_NO" type="STRING" size="256"/>
          <Column id="STORE_ID" type="STRING" size="256"/>
          <Column id="SELNG_DE" type="STRING" size="256"/>
          <Column id="PYMNT_DE" type="STRING" size="256"/>
          <Column id="SETLE_SE" type="STRING" size="256"/>
          <Column id="PROCESS_STTUS" type="STRING" size="256"/>
          <Column id="SETLE_INSTT" type="STRING" size="256"/>
          <Column id="ORDER_NO" type="STRING" size="256"/>
          <Column id="SETLE_DE" type="STRING" size="256"/>
          <Column id="CONFM_NO" type="STRING" size="256"/>
          <Column id="AMOUNT" type="STRING" size="256"/>
          <Column id="SETLE_NO" type="STRING" size="256"/>
          <Column id="EXCCLC_AM" type="STRING" size="256"/>
          <Column id="PURCHSR" type="STRING" size="256"/>
          <Column id="RETRN_RESN" type="STRING" size="256"/>
          <Column id="PUCHAS_CANCL_REQUST_DE" type="STRING" size="256"/>
          <Column id="GOODS_INFO" type="STRING" size="256"/>
          <Column id="DELNG_NO" type="STRING" size="256"/>
          <Column id="RM" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="BIZPLC_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond3" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="FCLTS_SN" type="STRING" size="256"/>
          <Column id="USE_DE" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_import" useclientlayout="false">
        <ColumnInfo>
          <Column id="Column0" type="STRING" size="256"/>
          <Column id="Column1" type="STRING" size="256"/>
          <Column id="Column2" type="STRING" size="256"/>
          <Column id="Column3" type="STRING" size="256"/>
          <Column id="Column4" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_setleSe_s" useclientlayout="true">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_smsList" useclientlayout="true">
        <ColumnInfo>
          <Column id="MMS_MSG" type="STRING" size="256"/>
          <Column id="DEST_INFO" type="STRING" size="256"/>
          <Column id="MBER_ID" type="STRING" size="256"/>
          <Column id="MBTLNUM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_print">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE_NM">사용허가신청서</Col>
            <Col id="CODE">001</Col>
          </Row>
          <Row>
            <Col id="CODE">002</Col>
            <Col id="CODE_NM">사용허가서</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_report">
        <ColumnInfo>
          <Column id="REPORT_SE" type="STRING" size="256"/>
          <Column id="BGNDE" type="STRING" size="256"/>
          <Column id="ENDDE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_excelRentReqstManageList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="MBER_ID" type="STRING" size="256"/>
          <Column id="FCLTS_NM" type="STRING" size="256"/>
          <Column id="FCLTS_SN" type="STRING" size="256"/>
          <Column id="REQST_SN" type="STRING" size="256"/>
          <Column id="RCPMNY_DTLS_SN" type="STRING" size="256"/>
          <Column id="USE_DE" type="STRING" size="256"/>
          <Column id="BEGIN_TIME" type="STRING" size="256"/>
          <Column id="END_TIME" type="STRING" size="256"/>
          <Column id="USE_TIME" type="FLOAT" size="256"/>
          <Column id="USE_TIME2" type="STRING" size="256"/>
          <Column id="USE_PRPOS_SE" type="STRING" size="256"/>
          <Column id="USE_CN" type="STRING" size="256"/>
          <Column id="USE_NMPR" type="INT" size="256"/>
          <Column id="USE_AM" type="INT" size="256"/>
          <Column id="RM" type="STRING" size="256"/>
          <Column id="SETLE_SE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="SETLE_AM" type="INT" size="256"/>
          <Column id="SETLE_STTUS" type="STRING" size="256"/>
          <Column id="REQST_DE" type="STRING" size="256"/>
          <Column id="JDGMN_COMPT_DE" type="STRING" size="256"/>
          <Column id="SETLE_COMPT_DE" type="STRING" size="256"/>
          <Column id="REFND_BANK_CODE" type="STRING" size="256"/>
          <Column id="REFND_BANK_NM" type="STRING" size="256"/>
          <Column id="REFND_ACNUTNO" type="STRING" size="256"/>
          <Column id="REFND_DPSTR" type="STRING" size="256"/>
          <Column id="RCPMNY_BANK_CODE" type="STRING" size="256"/>
          <Column id="RCPMNY_BANK_NM" type="STRING" size="256"/>
          <Column id="RCPMNY_ACNUTNO" type="STRING" size="256"/>
          <Column id="RCPMNYER" type="STRING" size="256"/>
          <Column id="MBER_NM" type="STRING" size="256"/>
          <Column id="GRP_NM" type="STRING" size="256"/>
          <Column id="ADRES" type="STRING" size="256"/>
          <Column id="TELNO" type="STRING" size="256"/>
          <Column id="MBTLNUM" type="STRING" size="256"/>
          <Column id="SETLE_AT" type="STRING" size="256"/>
          <Column id="DELETE_AT" type="STRING" size="256"/>
          <Column id="USE_TIME_FOM" type="STRING" size="256"/>
          <Column id="MNGR_REGIST_AT" type="STRING" size="256"/>
          <Column id="MUMM_RESVE_TIME" type="STRING" size="256"/>
          <Column id="REFND_REQST_DE" type="STRING" size="256"/>
          <Column id="ORDER_NO" type="STRING" size="256"/>
          <Column id="RENT_CANCL_AT" type="STRING" size="256"/>
          <Column id="SMS_CHK" type="STRING" size="256"/>
          <Column id="SETLE_TMLMT_DE" type="STRING" size="256"/>
          <Column id="REFND_AM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond_print" useclientlayout="true">
        <ColumnInfo>
          <Column id="BUNDLE_AT" type="STRING" size="256"/>
          <Column id="REQST_SN" type="STRING" size="256"/>
          <Column id="PRINT_SE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_test">
        <ColumnInfo>
          <Column id="KEY" type="STRING" size="256"/>
          <Column id="VAL" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="KEY">1</Col>
            <Col id="VAL">일</Col>
          </Row>
          <Row>
            <Col id="KEY">2</Col>
            <Col id="VAL">이</Col>
          </Row>
          <Row>
            <Col id="KEY">3</Col>
            <Col id="VAL">삼</Col>
          </Row>
          <Row>
            <Col id="KEY">4</Col>
            <Col id="VAL">사</Col>
          </Row>
          <Row>
            <Col id="KEY">5</Col>
            <Col id="VAL">오</Col>
          </Row>
          <Row>
            <Col id="KEY">6</Col>
            <Col id="VAL">육</Col>
          </Row>
          <Row>
            <Col id="KEY">7</Col>
            <Col id="VAL">칠</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_bundleConfirm" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_rentReqstManageList_onrowposchanged" oncolumnchanged="ds_rentReqstManageList_oncolumnchanged" cancolumnchange="ds_rentReqstManageList_cancolumnchange" onrowsetchanged="ds_rentReqstManageList_onrowsetchanged">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="MBER_ID" type="STRING" size="256"/>
          <Column id="FCLTS_NM" type="STRING" size="256"/>
          <Column id="FCLTS_SN" type="STRING" size="256"/>
          <Column id="REQST_SN" type="STRING" size="256"/>
          <Column id="RCPMNY_DTLS_SN" type="STRING" size="256"/>
          <Column id="USE_DE" type="STRING" size="256"/>
          <Column id="BEGIN_TIME" type="STRING" size="256"/>
          <Column id="END_TIME" type="STRING" size="256"/>
          <Column id="USE_TIME" type="STRING" size="256"/>
          <Column id="USE_TIME2" type="FLOAT" size="256"/>
          <Column id="USE_PRPOS_SE" type="STRING" size="256"/>
          <Column id="USE_CN" type="STRING" size="256"/>
          <Column id="USE_NMPR" type="INT" size="256"/>
          <Column id="USE_AM" type="INT" size="256"/>
          <Column id="RM" type="STRING" size="256"/>
          <Column id="SETLE_SE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="SETLE_AM" type="INT" size="256"/>
          <Column id="SETLE_STTUS" type="STRING" size="256"/>
          <Column id="REQST_DE" type="STRING" size="256"/>
          <Column id="JDGMN_COMPT_DE" type="STRING" size="256"/>
          <Column id="SETLE_COMPT_DE" type="STRING" size="256"/>
          <Column id="REFND_BANK_CODE" type="STRING" size="256"/>
          <Column id="REFND_BANK_NM" type="STRING" size="256"/>
          <Column id="REFND_ACNUTNO" type="STRING" size="256"/>
          <Column id="REFND_DPSTR" type="STRING" size="256"/>
          <Column id="RCPMNY_BANK_CODE" type="STRING" size="256"/>
          <Column id="RCPMNY_BANK_NM" type="STRING" size="256"/>
          <Column id="RCPMNY_ACNUTNO" type="STRING" size="256"/>
          <Column id="RCPMNYER" type="STRING" size="256"/>
          <Column id="MBER_NM" type="STRING" size="256"/>
          <Column id="GRP_NM" type="STRING" size="256"/>
          <Column id="ADRES" type="STRING" size="256"/>
          <Column id="TELNO" type="STRING" size="256"/>
          <Column id="MBTLNUM" type="STRING" size="256"/>
          <Column id="SETLE_AT" type="STRING" size="256"/>
          <Column id="DELETE_AT" type="STRING" size="256"/>
          <Column id="USE_TIME_FOM" type="STRING" size="256"/>
          <Column id="MNGR_REGIST_AT" type="STRING" size="256"/>
          <Column id="MUMM_RESVE_TIME" type="STRING" size="256"/>
          <Column id="REFND_REQST_DE" type="STRING" size="256"/>
          <Column id="ORDER_NO" type="STRING" size="256"/>
          <Column id="RENT_CANCL_AT" type="STRING" size="256"/>
          <Column id="SETLE_TMLMT_DE" type="STRING" size="256"/>
          <Column id="REFND_AM" type="STRING" size="256"/>
          <Column id="MUMM_RESVE_TIME_SE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_bizplcList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" cancolumnchange="ds_bizplcList_cancolumnchange">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="BIZPLC_CODE" type="STRING" size="256"/>
          <Column id="BIZPLC_NM" type="STRING" size="256"/>
          <Column id="BIZPLC_TY" type="STRING" size="256"/>
          <Column id="BIZPLC_PLACE" type="STRING" size="256"/>
          <Column id="MANAGE_DEPT_CODE" type="STRING" size="256"/>
          <Column id="MANAGE_DEPT_NM" type="STRING" size="256"/>
          <Column id="TELNO" type="STRING" size="256"/>
          <Column id="USE_AT" type="STRING" size="256"/>
          <Column id="OUTPT_ORDR" type="STRING" size="256"/>
          <Column id="RM" type="STRING" size="256"/>
          <Column id="GW_BIZPLC_ID" type="STRING" size="256"/>
          <Column id="REGISTER_ID" type="STRING" size="256"/>
          <Column id="REGIST_DT" type="STRING" size="256"/>
          <Column id="UPDUSR_ID" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_setleSttusSe_s" canrowposchange="ds_setleSttusSe_canrowposchange" filterstr="CODE=='006'||CODE=='007'">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="VAL0" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_expDsnDtls" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DECSN_YEAR" type="STRING" size="4"/>
          <Column id="DECSN_NO" type="STRING" size="11"/>
          <Column id="SEQ" type="BIGDECIMAL" size="22"/>
          <Column id="IHIDNUM" type="STRING" size="32"/>
          <Column id="RPAY_SE" type="STRING" size="6"/>
          <Column id="AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="NM" type="STRING" size="30"/>
          <Column id="SUMRY" type="STRING" size="200"/>
          <Column id="REGISTER_ID" type="STRING" size="12"/>
          <Column id="REGIST_DT" type="STRING" size="8"/>
          <Column id="UPDUSR_ID" type="STRING" size="12"/>
          <Column id="UPDT_DT" type="DATE" size="7"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_expDsnMastr" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_expDsnMastr_oncolumnchanged">
        <ColumnInfo>
          <Column id="DECSN_YEAR" type="STRING" size="4"/>
          <Column id="DECSN_NO" type="STRING" size="10"/>
          <Column id="CAUSE_ACTION_NO" type="STRING" size="10"/>
          <Column id="BUDGET_YEAR" type="STRING" size="4"/>
          <Column id="BSNS_SE" type="STRING" size="1"/>
          <Column id="BALC_SE" type="STRING" size="1"/>
          <Column id="BUDGET_ACNT_CODE" type="STRING" size="8"/>
          <Column id="BUDGET_ACNT_NM" type="STRING" size="256"/>
          <Column id="ANACT_KND" type="STRING" size="2"/>
          <Column id="DEPT_CODE" type="STRING" size="6"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="CYFD_SE" type="STRING" size="1"/>
          <Column id="ITNC_DE" type="STRING" size="8"/>
          <Column id="PYMNT_ITNC_DE" type="STRING" size="8"/>
          <Column id="DET_DCSN_DE" type="STRING" size="8"/>
          <Column id="PRMPC_JRNLZPR_RGIST_DE" type="STRING" size="8"/>
          <Column id="CPTAL_EXPNDTR_ACNTBK_DE" type="STRING" size="8"/>
          <Column id="EXPNDTR_BUDGET_CNRL_DE" type="STRING" size="8"/>
          <Column id="CAUSE_ACTION_DE" type="STRING" size="8"/>
          <Column id="DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="BUDGET_ACNT_BLCE" type="BIGDECIMAL" size="22"/>
          <Column id="EXPNDTR_UNIT_CODE" type="STRING" size="8"/>
          <Column id="EXPNDTR_UNIT_NM" type="STRING" size="256"/>
          <Column id="EXPNDTR_UNIT_CODE_BLCE" type="BIGDECIMAL" size="22"/>
          <Column id="CPTAL_CHRG_CONFM" type="STRING" size="1"/>
          <Column id="TIMHDER_CONFM" type="STRING" size="1"/>
          <Column id="CNTRCT_NO" type="STRING" size="11"/>
          <Column id="FNNC_INSTT_CODE" type="STRING" size="3"/>
          <Column id="ACNUTNO" type="STRING" size="20"/>
          <Column id="SUMRY" type="STRING" size="200"/>
          <Column id="BSNS_CODE" type="STRING" size="5"/>
          <Column id="BSNS_NM" type="STRING" size="256"/>
          <Column id="PRMPC_YEAR" type="STRING" size="256"/>
          <Column id="PRMPC_CODE" type="STRING" size="6"/>
          <Column id="PRMPC_NM" type="STRING" size="256"/>
          <Column id="REGISTER_ID" type="STRING" size="12"/>
          <Column id="REGIST_DT" type="STRING" size="8"/>
          <Column id="UPDUSR_ID" type="STRING" size="12"/>
          <Column id="UPDT_DT" type="DATE" size="7"/>
          <Column id="EXPNDTR_CNFIRM_AT" type="STRING" size="2"/>
          <Column id="ATMC_JRNLZ_TY_CODE" type="STRING" size="256"/>
          <Column id="GNRL_DEBTOR_ACNT_NM" type="STRING" size="256"/>
          <Column id="GNRL_CRDIT_ACNT_NM" type="STRING" size="256"/>
          <Column id="SETOFF_DEBTOR_ACNT_NM" type="STRING" size="256"/>
          <Column id="SETOFF_CRDIT_ACNT_NM" type="STRING" size="256"/>
          <Column id="FILE_SN" type="STRING" size="256"/>
          <Column id="CHECK_NO" type="STRING" size="256"/>
          <Column id="SANCTN_NO" type="STRING" size="256"/>
          <Column id="LAST_SANCTN_STTUS" type="STRING" size="256"/>
          <Column id="LAST_SANCTNSTS_IMG" type="STRING" size="256"/>
          <Column id="PRUF_SE_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_expDsnMtrDet" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DECSN_YEAR" type="STRING" size="4"/>
          <Column id="DECSN_NO" type="STRING" size="11"/>
          <Column id="CNTRCT_DE" type="STRING" size="8"/>
          <Column id="ACPTNC_DE" type="STRING" size="8"/>
          <Column id="ORDER_DE" type="STRING" size="8"/>
          <Column id="DVYFG_DE" type="STRING" size="8"/>
          <Column id="PYMNT_CMMND_PBLICTE_DE" type="STRING" size="8"/>
          <Column id="TAXXPT_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="VAT_DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="SUPLY_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="VAT_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="DSGN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="CNTRCT_SE" type="STRING" size="3"/>
          <Column id="CNTRCT_MTHD" type="STRING" size="1"/>
          <Column id="ATCH_FILE" type="STRING" size="100"/>
          <Column id="ATCH_FLPTH" type="STRING" size="200"/>
          <Column id="ATCH_FILE_1" type="STRING" size="100"/>
          <Column id="ATCH_FLPTH_1" type="STRING" size="200"/>
          <Column id="REGISTER_ID" type="STRING" size="12"/>
          <Column id="REGIST_DT" type="STRING" size="8"/>
          <Column id="UPDUSR_ID" type="STRING" size="12"/>
          <Column id="UPDT_DT" type="DATE" size="7"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_expDsnDetail" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DECSN_YEAR" type="STRING" size="4"/>
          <Column id="DECSN_NO" type="STRING" size="11"/>
          <Column id="SEQ" type="BIGDECIMAL" size="22"/>
          <Column id="DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="TAXXPT_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="VAT_AT" type="STRING" size="1"/>
          <Column id="BILL_KND" type="STRING" size="1"/>
          <Column id="VAT_DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="SUPLY_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="VAT" type="BIGDECIMAL" size="22"/>
          <Column id="BCNC_CODE" type="STRING" size="10"/>
          <Column id="BCNC_NM" type="STRING" size="256"/>
          <Column id="NM" type="STRING" size="30"/>
          <Column id="ADRES" type="STRING" size="200"/>
          <Column id="RQEST_DE" type="STRING" size="8"/>
          <Column id="RQEST_MAN" type="STRING" size="30"/>
          <Column id="RCPT_DE" type="STRING" size="8"/>
          <Column id="RCPT_MAN" type="STRING" size="30"/>
          <Column id="FNNC_INSTT_CODE" type="STRING" size="3"/>
          <Column id="ACNUTNO" type="STRING" size="20"/>
          <Column id="ENTRPRS_SE" type="STRING" size="1"/>
          <Column id="EVRFRND" type="STRING" size="1"/>
          <Column id="TCNDVLP" type="STRING" size="1"/>
          <Column id="CNTRWK_PRPOS_MTRIL" type="STRING" size="1"/>
          <Column id="AREA_ENTRPS" type="STRING" size="1"/>
          <Column id="FEMALE_ENTRPRS" type="STRING" size="1"/>
          <Column id="MIDDL_PD_CMPET_PRDUCT" type="STRING" size="1"/>
          <Column id="FRGCPT_ENTRPRS" type="STRING" size="1"/>
          <Column id="DSPSN" type="STRING" size="1"/>
          <Column id="SRSILL_DSPSN" type="STRING" size="1"/>
          <Column id="SOCTY_ENTRPRS" type="STRING" size="1"/>
          <Column id="DSPSN_PRDCTN_FCLTY" type="STRING" size="1"/>
          <Column id="SOCTY_CPER_MXTR" type="STRING" size="1"/>
          <Column id="GREEN_PRDUCT" type="STRING" size="1"/>
          <Column id="WHTAX_AT" type="STRING" size="1"/>
          <Column id="WHTAX_KND" type="STRING" size="1"/>
          <Column id="WHTAX_ADRES" type="STRING" size="200"/>
          <Column id="IHDNUM" type="STRING" size="256"/>
          <Column id="INCMTAX" type="STRING" size="256"/>
          <Column id="IHNTS" type="STRING" size="256"/>
          <Column id="WHTAX_INCOME_SE_CODE" type="STRING" size="256"/>
          <Column id="WHTAX_INDUTY_CODE" type="STRING" size="256"/>
          <Column id="MTCHG_SE" type="STRING" size="5"/>
          <Column id="BRRW_AMOUNT_INTR_RPAY_AT" type="STRING" size="1"/>
          <Column id="RM" type="STRING" size="200"/>
          <Column id="CMPNSP_NO" type="STRING" size="30"/>
          <Column id="REGISTER_ID" type="STRING" size="12"/>
          <Column id="REGIST_DT" type="STRING" size="8"/>
          <Column id="UPDUSR_ID" type="STRING" size="12"/>
          <Column id="UPDT_DT" type="DATE" size="7"/>
          <Column id="APPR_NO" type="STRING" size="256"/>
          <Column id="ATNDNC_MAN" type="STRING" size="256"/>
          <Column id="PRVONSH" type="STRING" size="256"/>
          <Column id="REAL_USER" type="STRING" size="256"/>
          <Column id="REAL_USER_NM" type="STRING" size="256"/>
          <Column id="BANK_CD" type="STRING" size="256"/>
          <Column id="CARD_NO" type="STRING" size="256"/>
          <Column id="APPR_DATE" type="STRING" size="256"/>
          <Column id="CANCEL_YN" type="STRING" size="256"/>
          <Column id="MBER_ID" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="SUMRY" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_expDsnDetail2" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DECSN_YEAR" type="STRING" size="4"/>
          <Column id="DECSN_NO" type="STRING" size="11"/>
          <Column id="SEQ" type="BIGDECIMAL" size="22"/>
          <Column id="DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="TAXXPT_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="VAT_AT" type="STRING" size="1"/>
          <Column id="BILL_KND" type="STRING" size="1"/>
          <Column id="VAT_DECSN_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="SUPLY_AMOUNT" type="BIGDECIMAL" size="22"/>
          <Column id="VAT" type="BIGDECIMAL" size="22"/>
          <Column id="BCNC_CODE" type="STRING" size="10"/>
          <Column id="BCNC_NM" type="STRING" size="256"/>
          <Column id="NM" type="STRING" size="30"/>
          <Column id="ADRES" type="STRING" size="200"/>
          <Column id="RQEST_DE" type="STRING" size="8"/>
          <Column id="RQEST_MAN" type="STRING" size="30"/>
          <Column id="RCPT_DE" type="STRING" size="8"/>
          <Column id="RCPT_MAN" type="STRING" size="30"/>
          <Column id="FNNC_INSTT_CODE" type="STRING" size="3"/>
          <Column id="ACNUTNO" type="STRING" size="20"/>
          <Column id="ENTRPRS_SE" type="STRING" size="1"/>
          <Column id="EVRFRND" type="STRING" size="1"/>
          <Column id="TCNDVLP" type="STRING" size="1"/>
          <Column id="CNTRWK_PRPOS_MTRIL" type="STRING" size="1"/>
          <Column id="AREA_ENTRPS" type="STRING" size="1"/>
          <Column id="FEMALE_ENTRPRS" type="STRING" size="1"/>
          <Column id="MIDDL_PD_CMPET_PRDUCT" type="STRING" size="1"/>
          <Column id="FRGCPT_ENTRPRS" type="STRING" size="1"/>
          <Column id="DSPSN" type="STRING" size="1"/>
          <Column id="SRSILL_DSPSN" type="STRING" size="1"/>
          <Column id="SOCTY_ENTRPRS" type="STRING" size="1"/>
          <Column id="DSPSN_PRDCTN_FCLTY" type="STRING" size="1"/>
          <Column id="SOCTY_CPER_MXTR" type="STRING" size="1"/>
          <Column id="GREEN_PRDUCT" type="STRING" size="1"/>
          <Column id="WHTAX_AT" type="STRING" size="1"/>
          <Column id="WHTAX_KND" type="STRING" size="1"/>
          <Column id="WHTAX_ADRES" type="STRING" size="200"/>
          <Column id="IHDNUM" type="STRING" size="256"/>
          <Column id="INCMTAX" type="STRING" size="256"/>
          <Column id="IHNTS" type="STRING" size="256"/>
          <Column id="WHTAX_INCOME_SE_CODE" type="STRING" size="256"/>
          <Column id="WHTAX_INDUTY_CODE" type="STRING" size="256"/>
          <Column id="MTCHG_SE" type="STRING" size="5"/>
          <Column id="BRRW_AMOUNT_INTR_RPAY_AT" type="STRING" size="1"/>
          <Column id="RM" type="STRING" size="200"/>
          <Column id="CMPNSP_NO" type="STRING" size="30"/>
          <Column id="REGISTER_ID" type="STRING" size="12"/>
          <Column id="REGIST_DT" type="STRING" size="8"/>
          <Column id="UPDUSR_ID" type="STRING" size="12"/>
          <Column id="UPDT_DT" type="DATE" size="7"/>
          <Column id="APPR_NO" type="STRING" size="256"/>
          <Column id="ATNDNC_MAN" type="STRING" size="256"/>
          <Column id="PRVONSH" type="STRING" size="256"/>
          <Column id="REAL_USER" type="STRING" size="256"/>
          <Column id="REAL_USER_NM" type="STRING" size="256"/>
          <Column id="BANK_CD" type="STRING" size="256"/>
          <Column id="CARD_NO" type="STRING" size="256"/>
          <Column id="APPR_DATE" type="STRING" size="256"/>
          <Column id="CANCEL_YN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_decsnNo" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="BIZPLC_CODE" type="STRING" size="256"/>
          <Column id="SN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_com021" useclientlayout="true">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_acc044" useclientlayout="true">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript5.0"><![CDATA[/***********************************************************************
 * 화면ID      : HPM070202
 * 화면명      : 대관신청관리
 * 화면설명   : 대관신청을 관리한다.
 * 작성일      : 2018.01.17
 * 작성자      : 이수지
 * 수정이력   : 
 ***********************************************************************
 *     수정일     수정자   내용
 ***********************************************************************
 */
 
 
/***********************************************************************
 * Script Include
 ************************************************************************/
// 시스템 공통 라이브러리 Include
include "lib::comInclude.xjs";
include "mis_lib::misUtil.xjs";

/**********************************************************************
* 화면 변수 선언부
***********************************************************************/
this.saveRow = -1;

/***********************************************************************
 * onInit / onLoad 영역
 ***********************************************************************/

this.HPM070202_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{ 
    this.fn_init_form();
    this.fn_init_dataset();
    
	this.div_search.div_dept.fn_setBind("ds_cond", "DEPT_CODE", "DEPT_NM");
}

/**********************************************************************
* Form/Dataset 오브젝트 초기화
***********************************************************************/

/*
 * 함수명      : initForm
 * 설명         : Form을 초기화한다.
 * params          : None
 * return Type     : None
 * 사용법        : this.initForm();
 */
this.fn_init_form = function()
{
    this.gfn_initForm(this);
    this.fn_misFormInit(this);
    
	this.div_search.div_dept.fn_setCssclass("edt_WF_Essential");
	
	var nextMt = this.dateUtils.addMonth(this.dateUtils.today(),1,"s");
	var nLastDay  = this.dateUtils.getLastDay(nextMt).getDate();	//마지막날짜 구하기
	var nextDe = this.dateUtils.format(nextMt,"yyyymm")+nLastDay;

	this.ds_cond.clearData();
	this.ds_cond.addRow();
	this.ds_cond.setColumn(0, "SEARCH_CND" , "001");
	this.ds_cond.setColumn(0, "SEARCH_VAL" , "");
	this.ds_cond.setColumn(0, "SEARCH_CND2", "");
	this.ds_cond.setColumn(0, "SETLE_STTUS", "");
	this.ds_cond.setColumn(0, "AM_SE"      , "");
	this.ds_cond.setColumn(0, "SETLE_SE"   , "");
	this.ds_cond.setColumn(0, "FCLTS_SN"   , "");
// 	this.ds_cond.setColumn(0, "DEPT_CODE"  , "000000");
// 	this.ds_cond.setColumn(0, "DEPT_NM"    , "화성도시공사");
	this.ds_cond.setColumn(0, "DEPT_CODE"  , this.gfn_getDeptId());
	
	this.ds_cond.setColumn(0, "DEPT_NM"    , this.gfn_getDeptName());
	this.ds_cond.setColumn(0, "BGNDE"      , this.dateUtils.format(this.gfn_today(),"yyyymmdd"));
	this.ds_cond.setColumn(0, "ENDDE"      , nextDe);
	this.ds_cond.setColumn(0, "RENT_CANCL_AT", "0");
	this.ds_cond.setColumn(0, "DELETE_AT"    , "0");
	this.ds_cond.setColumn(0, "USE_AT"       , "1");
	
    // 공통코드
    var comboParams = [
						  ["ds_setleSttusSe_s" , "HPM008", "1", ""]        		// 신청상태구분(검색조건)
						 ,["ds_setleSttusSe"   , "HPM008", "1", ""]        		// 신청상태구분
						 ,["ds_setleSe_s"      , "HPM009", "1", "전체"]       	// 결제구분(검색조건)
						 ,["ds_setleSe"        , "HPM009", "1", ""]       	    // 결제구분
						 ,["ds_com021"         , "COM021", "1", ""]       	    // 은행코드
						 ,["ds_acc044"         , "ACC044", "1", ""]       	    // 계좌적합성
                      ];
    var callback = function (svcId, errorCode, errorMsg) {       
       
        // 공통코드와 연계된 초기검색조건 설정
		// 수정가능여부를 판별하기위해 권한그룹 체크
		if(this.gfn_authGrpId("DEV_GRP") != -1) {			// 개발자
			this.chargerAt = true;
			this.div_search.div_dept.set_enable(true);
		}
		if(this.gfn_authGrpId("HPM_ADMIN") != -1) {			// 대관관리자
			this.chargerAt = true;
		}
		if(this.gfn_authGrpId("ALL_ADMIN") != -1) {			// 전체권한
			this.chargerAt = true;
		}
		if(this.gfn_authGrpId("HSCO_ADMIN") != -1) {		// 루트권한자
			this.chargerAt = true;
		}
		
		// 수정가능한 경우 부서변경 가능
		if(this.chargerAt){
		}
    };
    
    this.gfn_comboLoad (comboParams, callback);
}


/*
 * 함수명      : initDataset
 * 설명         : Dataset을 초기화한다
 * params          : None
 * return Type     : None
 * 사용법        : this.initDataset();
 */
this.fn_init_dataset = function()
{
    this.gfn_initCondDs(this, this.div_search);   
}


/**********************************************************************
* Transaction 영역 시작
***********************************************************************
*
* 1. Transaction 관련 이벤트 핸들러
* 2. call Transaction 영역
* 3. callback 영역(Transaction, Popup)
*
***********************************************************************/



/**********************************************************************
* Transaction 관련 이벤트 핸들러
***********************************************************************/

/*
 * 함수명     : fn_search
 * 설명       : 조회 버튼 클릭시 이벤트 발생
 * params        : None
 * return Type    : None
 * 사용법      : this.fn_search();
 */
this.fn_search = function()
{
    if(Ex.util.isUpdated(this.ds_rentReqstManageList)) {
        if(!this.gfn_message("confirm.변경.취소.여부")) {
            return false;
        }
    }
    
   // dataset 초기화
   this.ds_rentReqstManageList.clearData();
   
   //validation 체크
    if(!this.gfn_checkValidation_NoUpdChk(this.ds_cond, this.ds_validation)) {
        return;
    }

   this.fn_transaction("selectRentReqstManageList");
}

/*
 * 함수명      : fn_save
 * 설명        : 저장 버튼 클릭시 이벤트 발생
 * params       : None
 * return Type  : None
 * 사용법      : this.fn_save();
 */
this.fn_save = function()
{
    // 데이터셋 미변경 체크
    if (!this.comUtils.isDatasetUpdated(this.ds_rentReqstManageList)) {
        this.gfn_message("comm.데이터.변경.없음")
        return false;
    }

	//validation 체크
	if(!this.gfn_checkValidation(this.ds_rentReqstManageList, this.ds_validation)) {
		return;
	}
	
	if(this.gfn_message("confirm.저장.여부")) {
        this.saveRow = this.ds_rentReqstManageList.rowposition;
        this.fn_transaction("saveReqstManageList");
    }
}


/*
 * 함수명      : fn_delete
 * 설명        : 삭제 버튼 클릭시 이벤트 발생
 * params       : None
 * return Type  : None
 * 사용법      : this.fn_delete();
 */
this.fn_delete = function()
{
	var dCnt = this.ds_rentReqstManageList.getCaseCount("CHK == '1'");
	if(dCnt < 1) {
		this.gfn_message("info.처리불가","삭제할 건을 선택해주십시오.");
		return false;
	}

	if (this.gfn_message("confirm.삭제여부")) {
		for(var i = (this.ds_rentReqstManageList.rowcount-1); i >= 0; i-- ) {
		var chk = this.ds_rentReqstManageList.getColumn(i, "CHK");

			if(chk == "1") {
				this.ds_rentReqstManageList.deleteRow(i);
			}
		}
	}
}


/**********************************************************************
* call Transaction 영역
***********************************************************************/

/*
 * 함수명      : fn_transaction
 * 설명         : Transaction 요청 처리 함수
 * params          : strSvcId : 서비스요청 ID
 * return Type     : None
 * 사용법        : this.fn_transaction("SELECT");
 */
this.fn_transaction = function(strSvcId)
{
    switch (strSvcId) {
        // 환불신청 목록 조회
        case "selectRentReqstManageList":
            var sController       = "hsco/hpm/ctm/HPM070202/selectRentReqstManageList.do";
            var sInDatasets       = "input1=ds_cond";
            var sOutDatasets      = "ds_rentReqstManageList=output1";
            break;
        // 환불신청 목록 저장
        case "saveReqstManageList":
            var sController       = "hsco/hpm/ctm/HPM070202/saveReqstManageList.do";
            var sInDatasets       = "input1=ds_rentReqstManageList:U input2=ds_decsnNo:U";
            var sOutDatasets      = "";
            break;
        //  사업소 조회
        case "selectBizplcCode":
			var sController   	= "hsco/hpm/usm/HPM010101/bizplcSearchList.do";
			var sInDatasets   	= "input1=ds_cond";
			var sOutDatasets  	= "ds_bizplcList=output1";
			break;
        // 거래처생성
        case "insertBcncZ1":
            var sController       = "hsco/hpm/ctm/HPM070202/insertBcncZ1.do";
            var sInDatasets       = "input1=ds_expDsnDetail";
            var sOutDatasets      = "ds_expDsnDetail2=output1";
            break;
        // 계좌정합성체크 프로시저호출
        case "procedureAcnutStblt":
            var sController       = "hsco/hpm/ctm/HPM070202/procedureAcnutStblt.do";
            var sInDatasets       = "input1=ds_cond";
            var sOutDatasets      = "";
			break;
    }

    Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets);
}


/**********************************************************************
 * Transaction Callback 영역
 ***********************************************************************/
 /*
 * 함수명      : fn_callBack
 * 설명         : Transaction Callback 처리
 * params          : strSvcId    : 서비스요청 ID
 *                nErrorCode  : 오류 메시지 코드 ([예] 0 : Success, 그밖의 경우, error)
 *                strErrorMsg : 오류 메시지([예]  success.insert|정상적으로 등록되었습니다.)
 * return Type     : None
 * 사용법        :
 */
this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg)
{
    if(nErrorCode != '0') {
        this.gfn_callback_message(strSvcId, nErrorCode, strErrorMsg);
    }
    
    if (nErrorCode == '0'){
    switch (strSvcId) {
		// 환불신청 목록 조회
		case "selectRentReqstManageList":
			if(this.saveRow != -1) {
				this.ds_rentReqstManageList.set_rowposition(this.saveRow);
				this.saveRow = -1;
			}
			 break;
			 
        // 환불신청 목록 저장
        case "saveReqstManageList":
			this.fn_search();
			break;
			 
        //  사업소 조회
        case "selectBizplcCode":			
			if(this.ds_bizplcList.rowcount < 1) {
				this.ds_bizplcList.insertRow(0);
				this.ds_bizplcList.setColumn(0, "BIZPLC_CODE", "9999");
				this.ds_bizplcList.setColumn(0, "BIZPLC_NM"  , "해당없음");
			}
			this.div_search.cmb_bizplcList.set_index(0);
			
			this.fn_search();
			break;
        // 거래처생성
        case "insertBcncZ1":
			if(this.ds_expDsnDetail2.getRowCount()>0){
				var today = this.dateUtils.today();
				var refndReqstDe = this.ds_rentReqstManageList.getColumn(currow, "REFND_REQST_DE");
				var currow = this.ds_rentReqstManageList.rowposition;
				
				this.ds_expDsnMastr.addRow();
				this.ds_expDsnMastr.setColumn(0, "DECSN_YEAR"				, today.substr(0,4));								// 회계년월
				this.ds_expDsnMastr.setColumn(0, "ANACT_KND"				, "03");											// 결의서구분
				this.ds_expDsnMastr.setColumn(0, "DEPT_CODE"				, this.gfn_getDeptId());							// 부서코드
				this.ds_expDsnMastr.setColumn(0, "DEPT_NM"					, this.gfn_getDeptName());							// 부서명
				this.ds_expDsnMastr.setColumn(0, "BUDGET_YEAR"				, refndReqstDe.substr(0,4));						// 예산년도
				this.ds_expDsnMastr.setColumn(0, "ITNC_DE"					, today);											// 발의일자
				this.ds_expDsnMastr.setColumn(0, "DET_DCSN_DE"				, refndReqstDe);									// 채무확정일자
				this.ds_expDsnMastr.setColumn(0, "PYMNT_ITNC_DE"			, refndReqstDe);									// 지급발의일자
				this.ds_expDsnMastr.setColumn(0, "PRMPC_JRNLZPR_RGIST_DE"	, refndReqstDe);									// 원장분개장등기
				this.ds_expDsnMastr.setColumn(0, "EXPNDTR_BUDGET_CNRL_DE"	, refndReqstDe);									// 지출예산통제
				this.ds_expDsnMastr.setColumn(0, "CPTAL_EXPNDTR_ACNTBK_DE"	, refndReqstDe);									// 자금지출부등기
				this.ds_expDsnMastr.setColumn(0, "DECSN_AMOUNT"				, this.ds_expDsnDetail.getSum("DECSN_AMOUNT"));		// 결의금액(승인금액)
				this.ds_expDsnMastr.setColumn(0, "PRUF_SE_CODE"				, "07");											// 증빙구분???
				
				if(!this.comUtils.isNull(refndReqstDe)) {
					this.ds_expDsnMastr.setColumn(0, "SUMRY", "환불금 지급 건의("+refndReqstDe.substr(0,4)+"년"+refndReqstDe.substr(4,2)+"월)");	// 적요 
				}
				
				this.ds_expDsnMtrDet.addRow();
				this.ds_expDsnMtrDet.setColumn(0, "TAXXPT_AMOUNT"	, "0");														// 면세금액
				this.ds_expDsnMtrDet.setColumn(0, "VAT_DECSN_AMOUNT", "0");														// 부가세결의금액
				this.ds_expDsnMtrDet.setColumn(0, "SUPLY_AMOUNT"	, this.ds_expDsnDetail.getSum("REFND_AM"));					// 공급가액
				this.ds_expDsnMtrDet.setColumn(0, "VAT_AMOUNT"		, "0");														// 부가세금액
				
				var args = {
					 arg_0      			: this
					,trgFormId				: "HPM070202"												// 팝업을 호출하는 화면의 ID
					,anactKnd				: "03"														// 결의서구분
					,decsnYear				: this.ds_expDsnMastr.getColumn(0, "DECSN_YEAR")			// 결의년도
					,dsExpDsnMastr			: this.ds_expDsnMastr.saveXML()								// 결의마스터 Dataset
					,dsExpDsnMtrDet 		: this.ds_expDsnMtrDet.saveXML()							// 결의마스터상세 Dataset
					,dsExpDsnDetail 		: this.ds_expDsnDetail2.saveXML()							// 세부내용 Dataset
					,dsDecsnNo			    : this.ds_decsnNo.saveXML()									// 키값정보(Dataset)
				};
				this.gfn_popup("expDsnPopup", 902, 745, "결의서", args, "mis_acc::ACC020203_P01.xfdl", "fn_popupCallback", true);
			}
            break;
        // 계좌정합성체크 프로시저호출
        case "procedureAcnutStblt":
			alert("계좌정합성체크를 요청했습니다.");
			this.fn_search();
			break;
		default:
            break;
       	}
    }
}

/**********************************************************************
* Transaction 영역 끝
***********************************************************************/

/**********************************************************************
* non-Transaction 관련 컴포넌트 이벤트 처리 함수
***********************************************************************
*
* 1. Dataset 관련 이벤트 처리
* 2. Button 관련 이벤트 처리
* 3. Grid 관련 이벤트 처리
* 4. 공통함수 처리
* 5. Object 관련 이벤트 처리
*
***********************************************************************/


/**********************************************************************
* Dataset 관련 이벤트 처리
***********************************************************************/
/*
 * 함수명		: ds_cond_oncolumnchanged
 * 설명			: 검색 데이터셋 데이터 변경시 발생
 * params 		: None
 * return Type	: None
 * 사용법   	: this.ds_cond_oncolumnchanged();
 */
this.ds_cond_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	if(e.columnid == "DEPT_CODE") {
		// 사업소 코드 조회
		this.fn_transaction("selectBizplcCode");
	}
}
/**********************************************************************
* Button 관련 이벤트 처리
***********************************************************************/

/**********************************************************************
* Grid 관련 이벤트 처리
***********************************************************************/

/**********************************************************************
* 공통함수 처리
***********************************************************************/

/**********************************************************************
* Tab 관련 이벤트 처리
***********************************************************************/

/**********************************************************************
* Popup 관련 이벤트 처리
***********************************************************************/

/**********************************************************************
* 사용자 정의 함수
***********************************************************************/

/*
 * 함수명  	: fn_get_imgUrl
 * 설명 		: 진행상태 이미지
 * params  		: 
 * return Type 	: 
 * 사용법		: this.fn_get_imgUrl(sanctnSts)
 */
this.fn_get_imgUrl = function(s_reqstSttus)
{	
	var imgTitle = "";
	var reqstSttus = s_reqstSttus.substring(3, 2);
	
	imgTitle= "ico_reqstSttus"+reqstSttus;
	
	return 'theme://images/'+imgTitle+'.png';
}


/*
 * 함수명  	: fn_setSetleTmlmtDe
 * 설명 		: 결제기한일자 셋팅
 * params  		: 
 * return Type 	: 
 * 사용법		: this.fn_setSetleTmlmtDe
 */
this.fn_setSetleTmlmtDe = function(dataset, nRow) {
 	var today        = this.dateUtils.format(this.gfn_today(),"yyyymmdd");
 	var useDe        = dataset.getColumn(nRow, "USE_DE");				//사용일자
 	var reqstDe      = dataset.getColumn(nRow, "REQST_DE");				//신청일자
 	var jdgmnComptDe = dataset.getColumn(nRow, "JDGMN_COMPT_DE");		//심사완료일자
 	
 	var period = 5;	// default
 	
 	// 부서에 따라 결제기한일자를 기간을 다르게 둘수도 있기 때문에
 	var deptCode = this.ds_cond.getColumn(0, "DEPT_CODE");
 	
 	if(deptCode == "050200") {
		period = 5;
 	}

 	var setleTmlmtDe = this.gfn_addDate(jdgmnComptDe, period, "D"); 	
 	
	// 조건 1. 사용일자는 오늘보다 커야하며, 심사완료일자는 오늘보다 같거나 커야함
 	if(useDe > today && jdgmnComptDe <= today) {
		// 조건 2. 사용일자 <= 결제기한일자
		if(useDe <= setleTmlmtDe) {
			setleTmlmtDe = this.gfn_addDate(useDe, -1, "D");
		}
 	}else {
		setleTmlmtDe = "";
 	}
 	
 	return setleTmlmtDe;
}

this.fn_print = function() {
	
	//validation 체크
    if(!this.gfn_checkValidation_NoUpdChk(this.ds_cond, this.ds_validation)) {
        return;
    }
        
    if(!this.ds_rentReqstManageList.getRowCount() > 0) {
		alert("인쇄할 대관신청목록이 없습니다.");
		return;
	}
	this.ds_cond_print.clearData();
	this.ds_cond_print.addRow();
	this.div_print.set_visible(true);
}

/***********************************************************************************
* 설명	: 셀 더블클릭(단건결의)
***********************************************************************************/
this.grd_rentReqstManageList_oncelldblclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	if(e.col > 0){
		var cRow = this.ds_rentReqstManageList.rowposition;
		
		if(!this.comUtils.isNull(this.ds_rentReqstManageList.getColumn(cRow , "DECSN_NO"))) {
			
			var args = {
				  arg_0     : this
				, trgFormId	: "HPM070202"												// 팝업을 호출하는 화면의 ID
				, anactKnd	: "03"
				, decsnYear	: this.ds_rentReqstManageList.getColumn(cRow , "DECSN_YEAR")
				, decsnNo	: this.ds_rentReqstManageList.getColumn(cRow , "DECSN_NO")
			};
			this.gfn_popup("expDsnPopup", 903, 842, "결의서", args, "mis_acc::ACC020203_P01.xfdl", "fn_popupCallback", true);
			
		} else {
			if(this.ds_rentReqstManageList.getColumn(cRow, "SETLE_STTUS") == "007") {
				this.gfn_message("info.처리불가","환불완료된 내역입니다.");
				return;
			}
			
			this.ds_rentReqstManageList.set_updatecontrol(false);
			this.ds_rentReqstManageList.setColumn(e.row, "CHK", 1);
			this.ds_rentReqstManageList.set_updatecontrol(true);
			this.fn_popup_expDsn();
		}
	}
}

/***********************************************************************************
* 설명	: 헤드클릭 정렬
***********************************************************************************/
this.grd_rentReqstManageList_onheadclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	if(e.col == 0) {
		this.ds_rentReqstManageList.set_updatecontrol(false);
		if(obj.getCellText(e.row, e.cell) != '1'){
			for(var i = 0; i < this.ds_rentReqstManageList.getRowCount(); i++){
				if(this.ds_rentReqstManageList.getColumn(i, "CHK") != '1'){
					if(this.comUtils.isNull(this.ds_rentReqstManageList.getColumn(i , "DECSN_NO"))) {
						this.ds_rentReqstManageList.setColumn(i, "CHK", '1');
					}
				}
			}
			obj.setCellProperty("head", e.cell, "text", '1');
		}else{
			this.gfn_setGridCheckAll(obj, e);
		}
		this.ds_rentReqstManageList.set_updatecontrol(true);
	}else {
		LGV_COL_SORT = e.col; 
		this._gridSort(obj, e);	
	}
}


/*
 * 함수명  	: btn_bundleConfirm_onclick
 * 설명 		: 일괄결의등록
 * params  		: 
 * return Type 	: 
 * 사용법		: this.btn_bundleConfirm_onclick
 */
this.btn_bundleConfirm_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(!this.gfn_message("comm.행위여부","지출일괄등록") ){
		return;
	}
	
	this.fn_popup_expDsn();
}


/*
 * 함수명  	: fn_popup_expDsn
 * 설명 		:결의서 팝업
 * params  		: None
 * return Type 	: None
 */
this.fn_popup_expDsn = function(opt)
{
	var currow = this.ds_rentReqstManageList.rowposition;
	
	this.ds_expDsnMastr.clearData();
	this.ds_expDsnMtrDet.clearData();
	this.ds_expDsnDetail.clearData();
	this.ds_expDsnDetail2.clearData();
	this.ds_expDsnDtls.clearData();
	this.ds_decsnNo.clearData();
	
	if(this.ds_rentReqstManageList.getCaseCount("CHK == '1'") == 0) {
		this.gfn_message("info.처리불가","선택된 목록이 없습니다.");
		return false;
	}
	
	for(i = 0; i < this.ds_rentReqstManageList.getRowCount(); i++) {		
		if(this.ds_rentReqstManageList.getColumn(i, "CHK") == "1") {
			currow = i;
			this.addExpDsnDetail(currow);
		}
	}
	
	this.fn_transaction("insertBcncZ1");
}

this.addExpDsnDetail = function(cRow) {
	var nRow = this.ds_expDsnDetail.addRow();
	this.ds_expDsnDetail.setColumn(nRow, "DEPT_CODE"		, this.ds_rentReqstManageList.getColumn(cRow, "DEPT_CODE"));		// 부서코드
	this.ds_expDsnDetail.setColumn(nRow, "DECSN_AMOUNT"		, this.ds_rentReqstManageList.getColumn(cRow, "REFND_AM"));			// 결의금액(승인금액)
	this.ds_expDsnDetail.setColumn(nRow, "TAXXPT_AMOUNT"	, "0");																// 면세금액
	this.ds_expDsnDetail.setColumn(nRow, "VAT_AT"			, "0");																// 부가세여부
	this.ds_expDsnDetail.setColumn(nRow, "VAT_DECSN_AMOUNT" , "0");																// 부가세결의금액
	this.ds_expDsnDetail.setColumn(nRow, "SUPLY_AMOUNT"		, this.ds_rentReqstManageList.getColumn(cRow, "REFND_AM"));			// 공급가액
	this.ds_expDsnDetail.setColumn(nRow, "VAT"				, "0");																// 부가세
	this.ds_expDsnDetail.setColumn(nRow, "RCPT_DE"			, this.ds_rentReqstManageList.getColumn(cRow, "REFND_REQST_DE"));	// 영수일자
	this.ds_expDsnDetail.setColumn(nRow, "FNNC_INSTT_CODE"	, this.ds_rentReqstManageList.getColumn(cRow, "REFND_BANK_CODE"));	// 지급은행
	this.ds_expDsnDetail.setColumn(nRow, "ACNUTNO"			, this.ds_rentReqstManageList.getColumn(cRow, "REFND_ACNUTNO"));	// 계좌번호
	this.ds_expDsnDetail.setColumn(nRow, "BCNC_NM"			, this.ds_rentReqstManageList.getColumn(cRow, "REFND_DPSTR"));		// 거래처(가맹점)
	this.ds_expDsnDetail.setColumn(nRow, "BCNC_CODE"		, this.ds_rentReqstManageList.getColumn(cRow, "BCNC_CODE"));		// 거래처코드
	this.ds_expDsnDetail.setColumn(nRow, "NM"				, this.ds_rentReqstManageList.getColumn(cRow, "REFND_DPSTR"));		// 성명
	this.ds_expDsnDetail.setColumn(nRow, "RCPT_MAN"			, this.ds_rentReqstManageList.getColumn(cRow, "REFND_DPSTR"));		// 영수자
	
	var nRow2 = this.ds_decsnNo.addRow();
	this.ds_decsnNo.setColumn(nRow2, "DEPT_CODE",	 this.ds_rentReqstManageList.getColumn(cRow, "DEPT_CODE"));
	this.ds_decsnNo.setColumn(nRow2, "BIZPLC_CODE",  this.ds_rentReqstManageList.getColumn(cRow, "BIZPLC_CODE"));
	this.ds_decsnNo.setColumn(nRow2, "SN",			 this.ds_rentReqstManageList.getColumn(cRow, "SN"));
};


/*
 * 함수명  	: fn_popupCallback
 * 설명 		: 팝업창 콜백 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_popupCallBack();
 */
this.fn_popupCallback = function(strID, variant)
{

	if(strID == "expDsnPopup") {
		this.fn_search();
	}
} 

 /*
 * 함수명  	: btn_excelUpload_onclick
 * 설명 		: 엑셀 업로드 
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_excelUpload_onclick();
 */
this.btn_excelUpload_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if (this.comUtils.isDatasetUpdated(this.ds_cond)) {
		this.gfn_message("info.처리불가","조회조건이 변경되었습니다. 재조회 후 진행하세요.");
	}else{
		var arg = {
			targetDs : this.ds_import,
			headSet : false,
			callBack : function () {
				
				if(this.ds_import.getRowCount() > 1){
					for(i=1; i< this.ds_import.rowcount; i++) {
						if(this.comUtils.isNull(this.ds_import.getColumn(i , "Column0"))
						 || this.comUtils.isNull(this.ds_import.getColumn(i , "Column1"))
						 || this.comUtils.isNull(this.ds_import.getColumn(i , "Column2"))
						 || this.comUtils.isNull(this.ds_import.getColumn(i , "Column3"))
						 || this.comUtils.isNull(this.ds_import.getColumn(i , "Column4"))
						 || this.comUtils.isNull(this.ds_import.getColumn(i , "Column5"))) {
							this.gfn_message("info.처리불가","업로드한 엑셀파일에 누락된 값이 존재합니다.");
							return false;
						}
					}
					for(i=1; i< this.ds_import.rowcount; i++) {
						var nRow = this.ds_rentReqstManageList.addRow();
						this.ds_rentReqstManageList.setColumn(nRow, "DEPT_CODE"	  		 , this.ds_cond.getColumn(0, "DEPT_CODE"));
						this.ds_rentReqstManageList.setColumn(nRow, "BIZPLC_CODE"	  	 , this.ds_cond.getColumn(0, "BIZPLC_CODE"));
						this.ds_rentReqstManageList.setColumn(nRow, "SANCTN_KND"	  	 , "0");
						this.ds_rentReqstManageList.setColumn(nRow, "REFND_DPSTR"	  	 , this.ds_import.getColumn(i, "Column0"));
						this.ds_rentReqstManageList.setColumn(nRow, "REFND_BANK_CODE"	 , this.ds_import.getColumn(i, "Column1").padLeft(3, "0"));
						this.ds_rentReqstManageList.setColumn(nRow, "REFND_ACNUTNO"	  	 , this.ds_import.getColumn(i, "Column2"));
						this.ds_rentReqstManageList.setColumn(nRow, "REFND_AM"	  		 , this.ds_import.getColumn(i, "Column3"));
						this.ds_rentReqstManageList.setColumn(nRow, "REFND_REQST_DE"	 , this.ds_import.getColumn(i, "Column4"));
						this.ds_rentReqstManageList.setColumn(nRow, "REFND_PRVONSH"		 , this.ds_import.getColumn(i, "Column5"));
					}
					
					this.fn_transaction("saveReqstManageList");
				}
			}
		};
		this.gfn_importExcel(arg);
	}
}

 /*
 * 함수명  	: btn_excelDn_onclick
 * 설명 		: 엑셀 양식다운로드
 * params  		: None
 * return Type 	: None
 * 사용법		: this.btn_excelDn_onclick();
 */
this.btn_excelDn_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var args = [
		 { sheetName: "엑셀업로드양식" , grid: this.grd_excel	}
		,{ sheetName: "은행코드"		 , grid: this.grd_bank	}
	];
	
	this.fn_exportExcel(args, "upload_sample");
}


this.fn_exportExcel = function(arrTarget, sFileName)
{
	this.setWaitCursor(true,true);
	var sExportObjName = "obj_commonExport";
	var exportObj = new ExcelExportObject();
	var dToday = new Date();
	var sSheetName;
	var sSvcUrl = application.services["svcurl"].url+"XExportImport.do";
	var _param = "";
	exportObj.set_name(sExportObjName);
	exportObj.addEventHandler("onsuccess", this._gfn_exportExcelEnd, this);
	exportObj.addEventHandler("onerror", this._gfn_exportExcelEndError, this);
	exportObj.clearExportItems(nexacro.ExportTypes.EXCEL2007);
	
	
	if(!this.comUtils.isNullEmpty(sFileName)){
		sFileName = dToday.getTime() + "_" + sFileName;
	}else{
		sFileName = dToday.getTime();
	}
	
	for(i = 0 ; i < arrTarget.length; i++) {
		exportObj.addExportItem(nexacro.ExportItemTypes.GRID, arrTarget[i].grid, arrTarget[i].sheetName + "!A1","allband","allrecord","suppress","onlyvalue","none","color,background","both");
	}
	
	exportObj.set_exporttype(nexacro.ExportTypes.EXCEL2007);	
	exportObj.set_exportfilename(sFileName);
	exportObj.set_exporturl(sSvcUrl);

	var result = exportObj.exportData("cntn_file=N");
}


 /*
 * 함수명  	: btn_acnutStblt_onclick
 * 설명 		: 계좌정합성 체크
 * params  		: None
 * return Type 	: None
 * 사용법		: 
 */
this.btn_acnutStblt_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if (this.comUtils.isDatasetUpdated(this.ds_cond)) {
		this.gfn_message("info.처리불가","조회조건이 변경되었습니다. 재조회 후 진행하세요.");
	}else{
		if(!this.gfn_message("comm.행위여부","조회된 환불신청목록의 계좌정합성여부 판별을 실행") ){
			return;
		}
		
		this.fn_transaction("procedureAcnutStblt");
	}
}]]></Script>
  </Form>
</FDL>
