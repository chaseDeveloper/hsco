<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\default_typedef.xml"/>
  <Form id="HPM070101" classname="HPM070101" left="0" top="0" width="1059" height="735" titletext="시설신청관리" oninit="HPM070101_oninit" onload="HPM070101_onload">
    <Layouts>
      <Layout>
        <Div id="div_search" taborder="0" left="0" right="28" cssclass="div_WFSA_Box" height="85" top="0">
          <Layouts>
            <Layout width="1031" height="59">
              <Static id="Static06" taborder="37" text="15" visible="false" left="0" top="0" bottom="0" width="15" style="background:#00ffff66;"/>
              <Static id="Static51" taborder="38" text="5" visible="false" left="0" top="0" right="0" height="5" style="background:#dc143c3c;align:center middle;"/>
              <Static id="Static04" taborder="39" text="5" visible="false" left="0" top="107" right="0" height="5" style="background:#dc143c3c;align:center middle;"/>
              <Static id="sta_fcltsCn" taborder="41" text="시설명" cssclass="sta_WFSA_Label" left="535" top="31" width="51" height="21"/>
              <Static id="Static00" taborder="43" text="15" visible="false" left="279" top="0" width="15" style="background:#00ffff66;" bottom="0"/>
              <Static id="Static02" taborder="47" text="5" visible="false" left="0" top="26" right="0" height="5" style="background:#dc143c3c;align:center middle;" onclick="div_search_Static02_onclick"/>
              <Static id="Static05" taborder="54" text="5" visible="false" left="0" right="0" height="5" style="background:#dc143c3c;align:center middle;" bottom="0"/>
              <Static id="sta_searchDe04" taborder="58" text="담당부서" cssclass="sta_WFSA_Label" left="15" top="5" width="64" height="21"/>
              <Combo id="cmb_fcltsCn" taborder="59" left="607" top="31" width="298" height="21" index="-1" codecolumn="FCLTS_SN" datacolumn="FCLTS_NM" innerdataset="@ds_rentFcltsManageList_s"/>
              <Static id="sta_searchCnd" taborder="60" text="조회일자" cssclass="sta_WFSA_Label" left="535" top="5" width="64" height="21"/>
              <Calendar id="cal_bgnDe" taborder="61" dateformat="yyyy-MM-dd" cssclass="cal_WF_Essential" left="686" top="5" width="100" height="21"/>
              <Static id="Static03" taborder="62" text="~" left="790" top="9" width="10" height="16"/>
              <Calendar id="cal_endDe" taborder="63" dateformat="yyyy-MM-dd" cssclass="cal_WF_Essential" left="804" top="5" width="102" height="21"/>
              <Combo id="cmb_searchCnd2" taborder="64" codecolumn="codecolumn" datacolumn="datacolumn" left="608" top="5" width="76" height="21" onitemchanged="div_search_cmb_searchCnd2_onitemchanged">
                <Dataset id="innerdataset">
                  <ColumnInfo>
                    <Column id="codecolumn" size="256"/>
                    <Column id="datacolumn" size="256"/>
                  </ColumnInfo>
                  <Rows>
                    <Row>
                      <Col id="codecolumn">001</Col>
                      <Col id="datacolumn">사용일</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">002</Col>
                      <Col id="datacolumn">신청일</Col>
                    </Row>
                  </Rows>
                </Dataset>
              </Combo>
              <Static id="sta_" taborder="65" text="진행상태" cssclass="sta_WFSA_Label" left="294" top="31" width="64" height="21"/>
              <Combo id="cmb_setleSttusSe" taborder="66" innerdataset="@ds_setleSttusSe_s" codecolumn="CODE" datacolumn="CODE_NM" left="367" top="31" width="103" height="21" onitemchanged="div_search_cmb_setleSttusSe_onitemchanged"/>
              <Static id="sta_searchDe05" taborder="67" text="결제구분" cssclass="sta_WFSA_Label" left="15" top="57" width="64" height="21"/>
              <Combo id="cmb_setleSe" taborder="68" innerdataset="@ds_setleSe_s" codecolumn="CODE" datacolumn="CODE_NM" left="85" top="57" width="103" height="21" onitemchanged="div_search_cmb_setleSe_onitemchanged"/>
              <Static id="sta_searchCnd2" taborder="69" text="검색조건" cssclass="sta_WFSA_Label" left="15" top="31" width="64" height="21"/>
              <Combo id="cmb_searchCnd" taborder="70" codecolumn="codecolumn" datacolumn="datacolumn" left="85" top="31" width="76" height="21">
                <Dataset id="innerdataset">
                  <ColumnInfo>
                    <Column id="codecolumn" size="256"/>
                    <Column id="datacolumn" size="256"/>
                  </ColumnInfo>
                  <Rows>
                    <Row>
                      <Col id="codecolumn"/>
                      <Col id="datacolumn">전체</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">001</Col>
                      <Col id="datacolumn">회원ID</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">002</Col>
                      <Col id="datacolumn">입금자</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">003</Col>
                      <Col id="datacolumn">단체명</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">004</Col>
                      <Col id="datacolumn">회원명</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">005</Col>
                      <Col id="datacolumn">주문번호</Col>
                    </Row>
                  </Rows>
                </Dataset>
              </Combo>
              <Edit id="edt_searchVal" taborder="71" left="163" top="31" width="117" height="21"/>
              <Static id="sta_searchDe06" taborder="73" text="금액구분" cssclass="sta_WFSA_Label" left="295" top="57" width="64" height="21"/>
              <Combo id="cmb_useAmSe" taborder="74" codecolumn="codecolumn" datacolumn="datacolumn" left="367" top="57" width="67" height="21">
                <Dataset id="innerdataset">
                  <ColumnInfo>
                    <Column id="codecolumn" size="256"/>
                    <Column id="datacolumn" size="256"/>
                  </ColumnInfo>
                  <Rows>
                    <Row>
                      <Col id="codecolumn"/>
                      <Col id="datacolumn">전체</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">001</Col>
                      <Col id="datacolumn">유료</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">002</Col>
                      <Col id="datacolumn">무료</Col>
                    </Row>
                  </Rows>
                </Dataset>
              </Combo>
              <Div id="div_dept" taborder="75" url="com::deptCode.xfdl" left="85" top="5" width="195" height="21" enable="false" async="false"/>
              <CheckBox id="CheckBox00" taborder="77" text="대관신청취소 조회" left="535" top="57" width="155" height="21" truevalue="1" value="false" falsevalue="0" onclick="div_search_CheckBox00_onclick"/>
              <CheckBox id="chk_deleteAt" taborder="78" text="대관신청삭제 조회" value="0" truevalue="1" falsevalue="0" left="675" top="57" width="132" height="21" onclick="div_search_chk_deleteAt_onclick"/>
              <Static id="sta_bizplcList" taborder="79" cssclass="sta_WFSA_Label" left="295" top="5" width="51" height="21" text="사업소"/>
              <Combo id="cmb_bizplcList" taborder="80" innerdataset="@ds_bizplcList" codecolumn="BIZPLC_CODE" datacolumn="BIZPLC_NM" left="367" top="5" width="150" height="21" index="-1"/>
              <Static id="Static09" taborder="81" text="5" onclick="div_search_Static02_onclick" visible="false" left="0" top="52" right="0" height="5" style="background:#dc143c3c;align:center middle;"/>
              <Static id="Static08" taborder="82" text="15" visible="false" left="518" top="5" bottom="0" width="17" style="background:#00ffff66;"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static36" taborder="2" text="10" visible="false" left="0" top="85" width="1031" height="10" style="background:#dc143c3c;align:center middle;"/>
        <Static id="sta_gnfdList" taborder="3" text="대관신청목록" cssclass="sta_WF_Title02" top="95" width="120" height="19" style="align:left middle;" left="0"/>
        <Static id="Static02" taborder="4" text="5" visible="false" left="0" top="114" right="28" height="5" style="background:#dc143c3c;align:center middle;"/>
        <Static id="Static00" taborder="5" text="15" visible="false" left="1031" top="0" width="15" height="735" style="background:#1b3cd23c;align:center middle;"/>
        <Static id="Static01" taborder="6" text="스&#13;&#10;크&#13;&#10;롤&#13;&#10;13" visible="false" top="0" right="0" width="13" height="735" style="background:#d07b173c;align:center middle;"/>
        <Grid id="grd_rentReqstManageList" taborder="7" useinputpanel="false" left="0" top="118" right="373" binddataset="ds_rentReqstManageList" cellsizingtype="col" height="480" oncellclick="grd_rentReqstManageList_oncellclick" onheadclick="grd_rentReqstManageList_onheadclick" autofittype="none" autosizingtype="row" autosizebandtype="body" extendsizetype="row">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="30" band="left"/>
                <Column size="30"/>
                <Column size="100"/>
                <Column size="60"/>
                <Column size="100"/>
                <Column size="200"/>
                <Column size="105"/>
                <Column size="30"/>
                <Column size="105"/>
                <Column size="50"/>
                <Column size="30"/>
                <Column size="76"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="200"/>
                <Column size="200"/>
                <Column size="120"/>
                <Column size="120"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="checkbox" edittype="checkbox"/>
                <Cell col="1" rowspan="2" text="순번"/>
                <Cell col="2" rowspan="2" text="회원ID"/>
                <Cell col="3" rowspan="2" text="회원명"/>
                <Cell col="4" rowspan="2" text="단체명"/>
                <Cell col="5" rowspan="2" text="시설명"/>
                <Cell col="6" rowspan="2" colspan="2" text="사용일자"/>
                <Cell col="8" colspan="2" text="사용시간"/>
                <Cell col="10" rowspan="2" text="사용&#13;&#10;인원"/>
                <Cell col="11" rowspan="2" text="입금자"/>
                <Cell col="12" rowspan="2" text="결제구분"/>
                <Cell col="13" rowspan="2" text="결제금액"/>
                <Cell col="14" rowspan="2" text="진행상태"/>
                <Cell col="15" rowspan="2" text="사용목적"/>
                <Cell col="16" rowspan="2" text="비고"/>
                <Cell col="17" rowspan="2" text="주문번호"/>
                <Cell col="18" rowspan="2" text="신청일시"/>
                <Cell col="19" rowspan="2" text="심사완료일"/>
                <Cell col="20" rowspan="2" text="결제기한일"/>
                <Cell col="21" rowspan="2" text="납부완료일" calendardisplaynulltype="none"/>
                <Cell col="22" rowspan="2" text="환불요청일" calendardisplaynulltype="none"/>
                <Cell row="1" col="8" text="사용시간"/>
                <Cell row="1" col="9" text="총 시간"/>
              </Band>
              <Band id="body">
                <Cell displaytype="checkbox" edittype="checkbox" text="bind:CHK"/>
                <Cell col="1" text="expr:currow+1"/>
                <Cell col="2" style="align:left;" text="bind:MBER_ID"/>
                <Cell col="3" text="bind:MBER_NM"/>
                <Cell col="4" style="align:left;" text="bind:GRP_NM"/>
                <Cell col="5" displaytype="combo" edittype="none" style="align:left;" text="bind:FCLTS_SN" editdisplay="expr:PROGRS_STTUS == '01' ? 'display' : 'edit'" combodataset="ds_rentFcltsManageList_s" combocodecol="FCLTS_SN" combodatacol="FCLTS_NM"/>
                <Cell col="6" displaytype="date" edittype="none" text="bind:USE_DE" calendardisplaynulltype="none"/>
                <Cell col="7" text="bind:USE_DAY"/>
                <Cell col="8" displaytype="text" edittype="none" text="bind:USE_TIME_FOM" autosizerow="limitmin"/>
                <Cell col="9" displaytype="number" style="align:right;" text="bind:USE_TIME2" maskchar=" "/>
                <Cell col="10" displaytype="number" style="align:right;" text="bind:USE_NMPR"/>
                <Cell col="11" displaytype="normal" text="bind:RCPMNYER"/>
                <Cell col="12" displaytype="combo" text="bind:SETLE_SE" combodataset="ds_setleSe" combocodecol="CODE" combodatacol="CODE_NM"/>
                <Cell col="13" displaytype="number" style="align:right;" text="bind:SETLE_AM" mask="###,###,###,###,##9"/>
                <Cell col="14" displaytype="image" edittype="none" text="bind:SETLE_STTUS" expr="expr:comp.parent.fn_get_imgUrl(SETLE_STTUS)" combodataset="ds_setleSttusSe_s" combocodecol="CODE" combodatacol="CODE_NM" combodisplay="edit"/>
                <Cell col="15" displaytype="normal" edittype="none" style="align:left;" text="bind:USE_CN" tooltiptext="bind:USE_CN"/>
                <Cell col="16" displaytype="normal" edittype="none" style="align:left;" text="bind:RM" tooltiptext="bind:RM"/>
                <Cell col="17" text="bind:ORDER_NO"/>
                <Cell col="18" displaytype="normal" text="bind:REQST_DT" mask="####-##-## ##:##" calendardisplaynulltype="none"/>
                <Cell col="19" displaytype="date" text="bind:JDGMN_COMPT_DE" calendardisplaynulltype="none"/>
                <Cell col="20" displaytype="date" text="bind:SETLE_TMLMT_DE" calendardisplaynulltype="none"/>
                <Cell col="21" displaytype="date" text="bind:SETLE_COMPT_DE" calendardisplaynulltype="none"/>
                <Cell col="22" displaytype="date" text="bind:REFND_REQST_DE" calendardisplaynulltype="none"/>
              </Band>
              <Band id="summary">
                <Cell/>
                <Cell col="1"/>
                <Cell col="2"/>
                <Cell col="3"/>
                <Cell col="4"/>
                <Cell col="5"/>
                <Cell col="6"/>
                <Cell col="7"/>
                <Cell col="8" text="총 합계"/>
                <Cell col="9" displaytype="number" text="expr:dataset.getSum(&quot;USE_TIME2&quot;)"/>
                <Cell col="10" displaytype="number" style="align:right;" text="expr:dataset.getSum(&quot;USE_NMPR&quot;)"/>
                <Cell col="11"/>
                <Cell col="12"/>
                <Cell col="13" displaytype="number" style="align:right;" text="expr:dataset.getSum(&quot;SETLE_AM&quot;)"/>
                <Cell col="14"/>
                <Cell col="15"/>
                <Cell col="16"/>
                <Cell col="17"/>
                <Cell col="18"/>
                <Cell col="19"/>
                <Cell col="20"/>
                <Cell col="21"/>
                <Cell col="22"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static03" taborder="8" text="10" visible="false" left="0" width="1031" height="10" style="background:#dc143c3c;align:center middle;" top="598"/>
        <Static id="sta_gnfdList00" taborder="9" text="대사관리(입금내역)" cssclass="sta_WF_Title02" left="0" width="140" style="align:left middle;" height="19" top="608"/>
        <Static id="Static04" taborder="10" text="5" visible="false" left="0" right="28" style="background:#dc143c3c;align:center middle;" height="5" top="627"/>
        <Grid id="grd_rcpmnyDtlsList" taborder="11" binddataset="ds_rcpmnyDtlsList" useinputpanel="false" left="0" bottom="0" right="28" top="632">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="100"/>
                <Column size="150"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="250"/>
                <Column size="250"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="순번"/>
                <Cell col="1" text="금융기관명"/>
                <Cell col="2" text="계좌번호"/>
                <Cell col="3" text="거래일시"/>
                <Cell col="4" text="거래금액"/>
                <Cell col="5" text="잔액"/>
                <Cell col="6" text="적요1"/>
                <Cell col="7" text="적요2"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" celltype="none" text="bind:BANK_NM"/>
                <Cell col="2" text="bind:ACCT_NO"/>
                <Cell col="3" displaytype="date" text="bind:ACCT_TXDAY"/>
                <Cell col="4" style="align:right;" text="bind:TX_AMT"/>
                <Cell col="5" style="align:right;" text="bind:TX_CUR_BAL"/>
                <Cell col="6" style="align:left;" text="bind:REMARK1"/>
                <Cell col="7" style="align:left;" text="bind:REMARK2"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_rcpmnyDtlsMapping" taborder="12" text="입금내역매핑" onclick="btn_rcpmnyDtlsMapping_onclick" cssclass="btn_WF_Process" right="28" width="92" height="19" top="608"/>
        <Button id="btn_trnsfer" taborder="14" text="초기데이터 갱신#1" onclick="btn_trnsfer_onclick" top="-23" right="380" width="112" height="21" enable="true" visible="false" tooltiptype="default"/>
        <Static id="sta_gnfdList01" taborder="31" text="상세정보" cssclass="sta_WF_Title02" top="94" width="120" height="19" style="align:left middle;" right="245"/>
        <Static id="Static07" taborder="33" text="10" visible="false" left="686" bottom="130" width="10" style="background:#00ffff66;" height="480"/>
        <Div id="div_tab02" taborder="35" url="hpm_ctm::HPM070101_T02.xfdl" top="93" right="-335" width="335" height="480" visible="false"/>
        <Button id="btn_excelDown" taborder="38" cssclass="btn_WF_Gridexceldn" top="95" width="25" height="19" right="373" onclick="btn_excelDown_onclick"/>
        <Div id="div_tab01" taborder="41" url="hpm_ctm::HPM070101_T01.xfdl" top="118" right="28" width="335" height="480" visible="true"/>
        <Div id="div_print" taborder="36" top="40" right="125" width="189" height="132" style="shadow:outer 5,5 10 gray;" cssclass="div_WF_Calendar" visible="false">
          <Layouts>
            <Layout>
              <Static id="Static05" taborder="66" text="인쇄" cssclass="sta_WF_Calendaryy" left="0" top="-1" width="187" height="27"/>
              <Button id="btn_print" taborder="67" text="인쇄" onclick="div_print_btn_print_onclick" left="43" top="100" width="40" height="21"/>
              <Button id="btn_printCancel" taborder="68" text="취소" onclick="div_print_btn_printCancel_onclick" left="99" top="100" width="40" height="21"/>
              <Radio id="rdo_reportSe" taborder="69" innerdataset="@ds_print" codecolumn="CODE" datacolumn="CODE_NM" left="35" top="39" width="119" height="50" value="001" onitemclick="div_print_rdo_reportSe_onitemclick"/>
            </Layout>
          </Layouts>
        </Div>
        <Button id="btn_bundleConfirm" taborder="42" text="일괄심사승인" onclick="btn_bundleConfirm_onclick" top="94" right="401" width="88" height="21"/>
        <Static id="Static05" taborder="43" text="관리자가 유료건 예약을 선점하는 경우 해당 건의 진행상태가 결제완료로 되어야 합니다. " left="96" top="94" width="481" height="21" style="color:red;"/>
        <Grid id="grd_excelRentReqstManageList" taborder="44" binddataset="ds_excelRentReqstManageList" useinputpanel="false" extendsizetype="row" cellsizingtype="col" autosizingtype="row" oncellclick="grd_rentReqstManageList_oncellclick" onheadclick="grd_rentReqstManageList_onheadclick" left="5" top="792" right="28" height="180" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="60"/>
                <Column size="100"/>
                <Column size="60"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="105"/>
                <Column size="50"/>
                <Column size="60"/>
                <Column size="76"/>
                <Column size="200"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="200"/>
                <Column size="200"/>
                <Column size="110"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" text="순번"/>
                <Cell col="1" rowspan="2" text="회원ID"/>
                <Cell col="2" rowspan="2" text="회원명"/>
                <Cell col="3" rowspan="2" text="단체명"/>
                <Cell col="4" rowspan="2" text="사용일자"/>
                <Cell col="5" colspan="2" text="사용시간"/>
                <Cell col="7" rowspan="2" text="사용인원"/>
                <Cell col="8" rowspan="2" text="입금자"/>
                <Cell col="9" rowspan="2" text="시설명"/>
                <Cell col="10" rowspan="2" text="결제구분"/>
                <Cell col="11" rowspan="2" text="결제금액"/>
                <Cell col="12" rowspan="2" text="진행상태"/>
                <Cell col="13" rowspan="2" text="사용목적"/>
                <Cell col="14" rowspan="2" text="비고"/>
                <Cell col="15" rowspan="2" text="주문번호"/>
                <Cell col="16" rowspan="2" text="신청일"/>
                <Cell col="17" rowspan="2" text="심사완료일"/>
                <Cell col="18" rowspan="2" text="결제기한일"/>
                <Cell col="19" rowspan="2" text="납부완료일" calendardisplaynulltype="none"/>
                <Cell col="20" rowspan="2" text="환불요청일" calendardisplaynulltype="none"/>
                <Cell row="1" col="5" text="사용시간"/>
                <Cell row="1" col="6" text="총 시간"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" style="align:left;" text="bind:MBER_ID"/>
                <Cell col="2" text="bind:MBER_NM"/>
                <Cell col="3" style="align:left;" text="bind:GRP_NM"/>
                <Cell col="4" displaytype="date" edittype="none" text="bind:USE_DE" calendardisplaynulltype="none"/>
                <Cell col="5" displaytype="text" edittype="none" text="bind:USE_TIME_FOM" autosizerow="limitmin"/>
                <Cell col="6" displaytype="number" style="align:right;" text="bind:USE_TIME" maskchar=" "/>
                <Cell col="7" displaytype="number" style="align:right;" text="bind:USE_NMPR"/>
                <Cell col="8" displaytype="normal" text="bind:RCPMNYER"/>
                <Cell col="9" displaytype="combo" edittype="none" style="align:left;" text="bind:FCLTS_SN" editdisplay="expr:PROGRS_STTUS == '01' ? 'display' : 'edit'" combodataset="ds_rentFcltsManageList_s" combocodecol="FCLTS_SN" combodatacol="FCLTS_NM"/>
                <Cell col="10" displaytype="combo" text="bind:SETLE_SE" combodataset="ds_setleSe" combocodecol="CODE" combodatacol="CODE_NM"/>
                <Cell col="11" displaytype="number" style="align:right;" text="bind:SETLE_AM" mask="###,###,###,###,##9"/>
                <Cell col="12" displaytype="combo" edittype="none" text="bind:SETLE_STTUS" combodataset="ds_setleSttusSe_s" combocodecol="CODE" combodatacol="CODE_NM" combodisplay="edit"/>
                <Cell col="13" displaytype="normal" edittype="none" style="align:left;" text="bind:USE_CN" tooltiptext="bind:USE_CN"/>
                <Cell col="14" displaytype="normal" edittype="none" style="align:left;" text="bind:RM" tooltiptext="bind:RM"/>
                <Cell col="15" text="bind:ORDER_NO"/>
                <Cell col="16" displaytype="date" text="bind:REQST_DE" calendardisplaynulltype="none"/>
                <Cell col="17" displaytype="date" text="bind:JDGMN_COMPT_DE" calendardisplaynulltype="none"/>
                <Cell col="18" displaytype="date" text="bind:SETLE_TMLMT_DE" calendardisplaynulltype="none"/>
                <Cell col="19" displaytype="date" text="bind:SETLE_COMPT_DE" calendardisplaynulltype="none"/>
                <Cell col="20" displaytype="date" text="bind:REFND_REQST_DE" calendardisplaynulltype="none"/>
              </Band>
              <Band id="summary">
                <Cell/>
                <Cell col="1"/>
                <Cell col="2"/>
                <Cell col="3"/>
                <Cell col="4"/>
                <Cell col="5" text="총 합계"/>
                <Cell col="6" displaytype="number" text="expr:dataset.getSum(&quot;USE_TIME&quot;)"/>
                <Cell col="7" displaytype="number" style="align:right;" text="expr:dataset.getSum(&quot;USE_NMPR&quot;)"/>
                <Cell col="8"/>
                <Cell col="9"/>
                <Cell col="10"/>
                <Cell col="11" displaytype="number" style="align:right;" text="expr:dataset.getSum(&quot;SETLE_AM&quot;)"/>
                <Cell col="12"/>
                <Cell col="13"/>
                <Cell col="14"/>
                <Cell col="15"/>
                <Cell col="16"/>
                <Cell col="17"/>
                <Cell col="18"/>
                <Cell col="19"/>
                <Cell col="20"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item0" compid="div_search.cal_bgnDe" propid="value" datasetid="ds_cond" columnid="BGNDE"/>
      <BindItem id="item1" compid="div_search.cal_endDe" propid="value" datasetid="ds_cond" columnid="ENDDE"/>
      <BindItem id="item2" compid="div_search.cmb_searchCnd2" propid="value" datasetid="ds_cond" columnid="SEARCH_CND"/>
      <BindItem id="item6" compid="div_search.cmb_setleSttusSe" propid="value" datasetid="ds_cond" columnid="SETLE_STTUS"/>
      <BindItem id="item14" compid="div_search.cmb_setleSe" propid="value" datasetid="ds_cond" columnid="SETLE_SE"/>
      <BindItem id="item16" compid="div_search.cmb_searchCnd" propid="value" datasetid="ds_cond" columnid="SEARCH_CND2"/>
      <BindItem id="item17" compid="div_search.edt_searchVal" propid="value" datasetid="ds_cond" columnid="SEARCH_VAL"/>
      <BindItem id="item18" compid="div_search.cmb_useAmSe" propid="value" datasetid="ds_cond" columnid="AM_SE"/>
      <BindItem id="item3" compid="div_search.cmb_fcltsCn" propid="value" datasetid="ds_cond" columnid="FCLTS_SN"/>
      <BindItem id="item4" compid="div_search.CheckBox00" propid="value" datasetid="ds_cond" columnid="RENT_CANCL_AT"/>
      <BindItem id="item5" compid="div_search.chk_deleteAt" propid="value" datasetid="ds_cond" columnid="DELETE_AT"/>
      <BindItem id="item7" compid="div_print.rdo_reportSe" propid="value" datasetid="ds_cond_print" columnid="PRINT_SE"/>
      <BindItem id="item8" compid="div_search.cmb_bizplcList" propid="value" datasetid="ds_cond" columnid="BIZPLC_CODE"/>
    </Bind>
    <Objects>
      <Dataset id="ds_cond" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_cond_oncolumnchanged">
        <ColumnInfo>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NM" type="STRING" size="256"/>
          <Column id="SETLE_SE" type="STRING" size="256"/>
          <Column id="AM_SE" type="STRING" size="256"/>
          <Column id="SETLE_STTUS" type="STRING" size="256"/>
          <Column id="BGNDE" type="STRING" size="256"/>
          <Column id="ENDDE" type="STRING" size="256"/>
          <Column id="SEARCH_CND" type="STRING" size="256"/>
          <Column id="SEARCH_CND2" type="STRING" size="256"/>
          <Column id="SEARCH_VAL" type="STRING" size="256"/>
          <Column id="FCLTS_SN" type="STRING" size="256"/>
          <Column id="DELETE_AT" type="STRING" size="256"/>
          <Column id="RENT_CANCL_AT" type="STRING" size="256"/>
          <Column id="REPORT_SE" type="STRING" size="256"/>
          <Column id="BIZPLC_CODE" type="STRING" size="256"/>
          <Column id="USE_AT" type="STRING" size="256"/>
          <Column id="AUTH_AT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_rentReqstManageList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_rentReqstManageList_onrowposchanged" oncolumnchanged="ds_rentReqstManageList_oncolumnchanged" cancolumnchange="ds_rentReqstManageList_cancolumnchange" onrowsetchanged="ds_rentReqstManageList_onrowsetchanged">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="MBER_ID" type="STRING" size="256"/>
          <Column id="FCLTS_NM" type="STRING" size="256"/>
          <Column id="FCLTS_SN" type="STRING" size="256"/>
          <Column id="REQST_SN" type="STRING" size="256"/>
          <Column id="RCPMNY_DTLS_SN" type="STRING" size="256"/>
          <Column id="USE_DE" type="STRING" size="256"/>
          <Column id="BEGIN_TIME" type="STRING" size="256"/>
          <Column id="END_TIME" type="STRING" size="256"/>
          <Column id="USE_TIME" type="STRING" size="256"/>
          <Column id="USE_TIME2" type="FLOAT" size="256"/>
          <Column id="USE_PRPOS_SE" type="STRING" size="256"/>
          <Column id="USE_CN" type="STRING" size="256"/>
          <Column id="USE_NMPR" type="INT" size="256"/>
          <Column id="USE_AM" type="INT" size="256"/>
          <Column id="RM" type="STRING" size="256"/>
          <Column id="SETLE_SE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="SETLE_AM" type="INT" size="256"/>
          <Column id="SETLE_STTUS" type="STRING" size="256"/>
          <Column id="REQST_DE" type="STRING" size="256"/>
          <Column id="JDGMN_COMPT_DE" type="STRING" size="256"/>
          <Column id="SETLE_COMPT_DE" type="STRING" size="256"/>
          <Column id="REFND_BANK_CODE" type="STRING" size="256"/>
          <Column id="REFND_BANK_NM" type="STRING" size="256"/>
          <Column id="REFND_ACNUTNO" type="STRING" size="256"/>
          <Column id="REFND_DPSTR" type="STRING" size="256"/>
          <Column id="RCPMNY_BANK_CODE" type="STRING" size="256"/>
          <Column id="RCPMNY_BANK_NM" type="STRING" size="256"/>
          <Column id="RCPMNY_ACNUTNO" type="STRING" size="256"/>
          <Column id="RCPMNYER" type="STRING" size="256"/>
          <Column id="MBER_NM" type="STRING" size="256"/>
          <Column id="GRP_NM" type="STRING" size="256"/>
          <Column id="ADRES" type="STRING" size="256"/>
          <Column id="TELNO" type="STRING" size="256"/>
          <Column id="MBTLNUM" type="STRING" size="256"/>
          <Column id="SETLE_AT" type="STRING" size="256"/>
          <Column id="DELETE_AT" type="STRING" size="256"/>
          <Column id="USE_TIME_FOM" type="STRING" size="256"/>
          <Column id="MNGR_REGIST_AT" type="STRING" size="256"/>
          <Column id="MUMM_RESVE_TIME" type="STRING" size="256"/>
          <Column id="REFND_REQST_DE" type="STRING" size="256"/>
          <Column id="ORDER_NO" type="STRING" size="256"/>
          <Column id="RENT_CANCL_AT" type="STRING" size="256"/>
          <Column id="REFND_AM" type="STRING" size="256"/>
          <Column id="MUMM_RESVE_TIME_SE" type="STRING" size="256"/>
          <Column id="SMS_CHK" type="STRING" size="256"/>
          <Column id="REFND_GRP_CPR_NM" type="STRING" size="256"/>
          <Column id="BIZPLC_CODE" type="STRING" size="256"/>
          <Column id="SETLE_TMLMT_DE" type="STRING" size="256"/>
          <Column id="LGUPLUS_SETLE_AT" type="STRING" size="256"/>
          <Column id="USE_DAY" type="STRING" size="256"/>
          <Column id="RDCXPT_AT" type="STRING" size="256"/>
          <Column id="RDCXPT_RATE" type="STRING" size="256"/>
          <Column id="REFND_BANK_NM_AT" type="STRING" size="256"/>
          <Column id="INDVDL_CPR_SE" type="STRING" size="256"/>
          <Column id="REQST_DT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_setleSe" useclientlayout="true">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_validation" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="compId" type="STRING" size="256"/>
          <Column id="colId" type="STRING" size="256"/>
          <Column id="PK" type="STRING" size="256"/>
          <Column id="notNull" type="STRING" size="256"/>
          <Column id="type" type="STRING" size="256"/>
          <Column id="nlength" type="STRING" size="256"/>
          <Column id="from" type="STRING" size="256"/>
          <Column id="to" type="STRING" size="256"/>
          <Column id="lengthChkGb" type="STRING" size="256"/>
          <Column id="msgId" type="STRING" size="256"/>
          <Column id="expr" type="STRING" size="256"/>
          <Column id="func" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="compId">ds_rentReqstManageList</Col>
            <Col id="colId">FCLTS_SN</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">시설명</Col>
          </Row>
          <Row>
            <Col id="compId">ds_rentReqstManageList</Col>
            <Col id="colId">USE_DE</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">사용일자</Col>
          </Row>
          <Row>
            <Col id="compId">ds_rentReqstManageList</Col>
            <Col id="colId">MBER_NM</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">이름</Col>
          </Row>
          <Row>
            <Col id="compId">ds_rentReqstManageList</Col>
            <Col id="colId">GRP_NM</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">단체명</Col>
          </Row>
          <Row>
            <Col id="compId">ds_rentReqstManageList</Col>
            <Col id="colId">USE_PRPOS_SE</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">사용용도</Col>
          </Row>
          <Row>
            <Col id="compId">ds_rentReqstManageList</Col>
            <Col id="colId">SETLE_AM</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">사용금액</Col>
          </Row>
          <Row>
            <Col id="compId">ds_rentReqstManageList</Col>
            <Col id="colId">SETLE_STTUS</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">진행상태</Col>
          </Row>
          <Row>
            <Col id="compId">ds_rentReqstManageList</Col>
            <Col id="colId">USE_NMPR</Col>
            <Col id="PK"/>
            <Col id="notNull">Y</Col>
            <Col id="type"/>
            <Col id="nlength"/>
            <Col id="from"/>
            <Col id="to"/>
            <Col id="lengthChkGb"/>
            <Col id="msgId">사용인원</Col>
            <Col id="expr"/>
            <Col id="func"/>
          </Row>
          <Row>
            <Col id="compId">ds_rentReqstManageList</Col>
            <Col id="colId">USE_TIME</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">사용시간</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_setleSttusSe" canrowposchange="ds_setleSttusSe_canrowposchange">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="VAL0" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_rentFcltsManageList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_rentFcltsManageList_onrowposchanged" oncolumnchanged="ds_rentFcltsManageList_oncolumnchanged">
        <ColumnInfo>
          <Column id="FCLTS_SN" type="STRING" size="256"/>
          <Column id="FCLTS_NM" type="STRING" size="256"/>
          <Column id="USE_AT" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="MUMM_RESVE_TIME" type="STRING" size="256"/>
          <Column id="MUMM_RESVE_TIME_SE" type="STRING" size="256"/>
          <Column id="BIZPLC_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_rentFcltsManageList_s" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_rentFcltsManageList_onrowposchanged" oncolumnchanged="ds_rentFcltsManageList_oncolumnchanged">
        <ColumnInfo>
          <Column id="FCLTS_SN" type="STRING" size="256"/>
          <Column id="FCLTS_NM" type="STRING" size="256"/>
          <Column id="USE_AT" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="MUMM_RESVE_TIME2" type="STRING" size="256"/>
          <Column id="BIZPLC_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_setleSttusSe_s">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_rcpmnyDtlsList">
        <ColumnInfo>
          <Column id="BANK_CD" type="STRING" size="256"/>
          <Column id="BANK_NM" type="STRING" size="256"/>
          <Column id="ACCT_NO" type="STRING" size="256"/>
          <Column id="CURR_UNIT" type="STRING" size="256"/>
          <Column id="INQNO" type="STRING" size="256"/>
          <Column id="ACCT_TXDAY_SEQ" type="STRING" size="256"/>
          <Column id="ACCT_TXDAY" type="STRING" size="256"/>
          <Column id="INOUT_GUBUN" type="STRING" size="256"/>
          <Column id="TX_AMT" type="STRING" size="256"/>
          <Column id="TX_CUR_BAL" type="STRING" size="256"/>
          <Column id="REMARK1" type="STRING" size="256"/>
          <Column id="REMARK2" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond2" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="SETLE_AM" type="STRING" size="256"/>
          <Column id="REQST_DE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_rcpmnyDtlsManageList">
        <ColumnInfo>
          <Column id="RCPMNY_DTLS_SN" type="STRING" size="256"/>
          <Column id="RCPMNY_DTLS_NO" type="STRING" size="256"/>
          <Column id="STORE_ID" type="STRING" size="256"/>
          <Column id="SELNG_DE" type="STRING" size="256"/>
          <Column id="PYMNT_DE" type="STRING" size="256"/>
          <Column id="SETLE_SE" type="STRING" size="256"/>
          <Column id="PROCESS_STTUS" type="STRING" size="256"/>
          <Column id="SETLE_INSTT" type="STRING" size="256"/>
          <Column id="ORDER_NO" type="STRING" size="256"/>
          <Column id="SETLE_DE" type="STRING" size="256"/>
          <Column id="CONFM_NO" type="STRING" size="256"/>
          <Column id="AMOUNT" type="STRING" size="256"/>
          <Column id="SETLE_NO" type="STRING" size="256"/>
          <Column id="EXCCLC_AM" type="STRING" size="256"/>
          <Column id="PURCHSR" type="STRING" size="256"/>
          <Column id="RETRN_RESN" type="STRING" size="256"/>
          <Column id="PUCHAS_CANCL_REQUST_DE" type="STRING" size="256"/>
          <Column id="GOODS_INFO" type="STRING" size="256"/>
          <Column id="DELNG_NO" type="STRING" size="256"/>
          <Column id="RM" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="BIZPLC_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_rentReqstManage" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_rentReqstManageList_onrowposchanged" canrowposchange="ds_rentReqstManageList_canrowposchange">
        <ColumnInfo>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="MBER_ID" type="STRING" size="256"/>
          <Column id="FCLTS_NM" type="STRING" size="256"/>
          <Column id="FCLTS_SN" type="STRING" size="256"/>
          <Column id="REQST_SN" type="STRING" size="256"/>
          <Column id="RCPMNY_DTLS_SN" type="STRING" size="256"/>
          <Column id="USE_DE" type="STRING" size="256"/>
          <Column id="BEGIN_TIME" type="STRING" size="256"/>
          <Column id="END_TIME" type="STRING" size="256"/>
          <Column id="USE_TIME" type="STRING" size="256"/>
          <Column id="USE_PRPOS_SE" type="STRING" size="256"/>
          <Column id="USE_CN" type="STRING" size="256"/>
          <Column id="USE_NMPR" type="STRING" size="256"/>
          <Column id="USE_AM" type="BIGDECIMAL" size="256"/>
          <Column id="RM" type="STRING" size="256"/>
          <Column id="SETLE_SE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="SETLE_AM" type="BIGDECIMAL" size="256"/>
          <Column id="SETLE_STTUS" type="STRING" size="256"/>
          <Column id="SETLE_STTUS2" type="STRING" size="256"/>
          <Column id="REQST_DE" type="STRING" size="256"/>
          <Column id="JDGMN_COMPT_DE" type="STRING" size="256"/>
          <Column id="SETLE_COMPT_DE" type="STRING" size="256"/>
          <Column id="REFND_BANK_CODE" type="STRING" size="256"/>
          <Column id="REFND_BANK_NM" type="STRING" size="256"/>
          <Column id="REFND_ACNUTNO" type="STRING" size="256"/>
          <Column id="REFND_DPSTR" type="STRING" size="256"/>
          <Column id="RCPMNY_BANK_CODE" type="STRING" size="256"/>
          <Column id="RCPMNY_BANK_NM" type="STRING" size="256"/>
          <Column id="RCPMNY_ACNUTNO" type="STRING" size="256"/>
          <Column id="RCPMNYER" type="STRING" size="256"/>
          <Column id="MBER_NM" type="STRING" size="256"/>
          <Column id="GRP_NM" type="STRING" size="256"/>
          <Column id="ADRES" type="STRING" size="256"/>
          <Column id="TELNO" type="STRING" size="256"/>
          <Column id="MBTLNUM" type="STRING" size="256"/>
          <Column id="SETLE_AT" type="STRING" size="256"/>
          <Column id="DELETE_AT" type="STRING" size="256"/>
          <Column id="ORDER_NO" type="STRING" size="256"/>
          <Column id="REFND_AM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond3" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="FCLTS_SN" type="STRING" size="256"/>
          <Column id="USE_DE" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_resveTimeList" useclientlayout="true">
        <ColumnInfo>
          <Column id="BEGIN_TIME" type="STRING" size="256"/>
          <Column id="USE_TIME_FOM" type="STRING" size="256"/>
          <Column id="USE_CHRGE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_setleSe_s" useclientlayout="true">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_smsList" useclientlayout="true">
        <ColumnInfo>
          <Column id="MMS_MSG" type="STRING" size="256"/>
          <Column id="DEST_INFO" type="STRING" size="256"/>
          <Column id="MBER_ID" type="STRING" size="256"/>
          <Column id="MBTLNUM" type="STRING" size="256"/>
          <Column id="CALLBACK" type="STRING" size="256"/>
          <Column id="USER_ID" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_print">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE_NM">사용허가신청서</Col>
            <Col id="CODE">001</Col>
          </Row>
          <Row>
            <Col id="CODE">002</Col>
            <Col id="CODE_NM">사용허가서</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_report">
        <ColumnInfo>
          <Column id="REPORT_SE" type="STRING" size="256"/>
          <Column id="BGNDE" type="STRING" size="256"/>
          <Column id="ENDDE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_excelRentReqstManageList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="MBER_ID" type="STRING" size="256"/>
          <Column id="FCLTS_NM" type="STRING" size="256"/>
          <Column id="FCLTS_SN" type="STRING" size="256"/>
          <Column id="REQST_SN" type="STRING" size="256"/>
          <Column id="RCPMNY_DTLS_SN" type="STRING" size="256"/>
          <Column id="USE_DE" type="STRING" size="256"/>
          <Column id="BEGIN_TIME" type="STRING" size="256"/>
          <Column id="END_TIME" type="STRING" size="256"/>
          <Column id="USE_TIME" type="FLOAT" size="256"/>
          <Column id="USE_TIME2" type="STRING" size="256"/>
          <Column id="USE_PRPOS_SE" type="STRING" size="256"/>
          <Column id="USE_CN" type="STRING" size="256"/>
          <Column id="USE_NMPR" type="INT" size="256"/>
          <Column id="USE_AM" type="INT" size="256"/>
          <Column id="RM" type="STRING" size="256"/>
          <Column id="SETLE_SE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="SETLE_AM" type="INT" size="256"/>
          <Column id="SETLE_STTUS" type="STRING" size="256"/>
          <Column id="REQST_DE" type="STRING" size="256"/>
          <Column id="JDGMN_COMPT_DE" type="STRING" size="256"/>
          <Column id="SETLE_COMPT_DE" type="STRING" size="256"/>
          <Column id="REFND_BANK_CODE" type="STRING" size="256"/>
          <Column id="REFND_BANK_NM" type="STRING" size="256"/>
          <Column id="REFND_ACNUTNO" type="STRING" size="256"/>
          <Column id="REFND_DPSTR" type="STRING" size="256"/>
          <Column id="RCPMNY_BANK_CODE" type="STRING" size="256"/>
          <Column id="RCPMNY_BANK_NM" type="STRING" size="256"/>
          <Column id="RCPMNY_ACNUTNO" type="STRING" size="256"/>
          <Column id="RCPMNYER" type="STRING" size="256"/>
          <Column id="MBER_NM" type="STRING" size="256"/>
          <Column id="GRP_NM" type="STRING" size="256"/>
          <Column id="ADRES" type="STRING" size="256"/>
          <Column id="TELNO" type="STRING" size="256"/>
          <Column id="MBTLNUM" type="STRING" size="256"/>
          <Column id="SETLE_AT" type="STRING" size="256"/>
          <Column id="DELETE_AT" type="STRING" size="256"/>
          <Column id="USE_TIME_FOM" type="STRING" size="256"/>
          <Column id="MNGR_REGIST_AT" type="STRING" size="256"/>
          <Column id="MUMM_RESVE_TIME" type="STRING" size="256"/>
          <Column id="REFND_REQST_DE" type="STRING" size="256"/>
          <Column id="ORDER_NO" type="STRING" size="256"/>
          <Column id="RENT_CANCL_AT" type="STRING" size="256"/>
          <Column id="SMS_CHK" type="STRING" size="256"/>
          <Column id="SETLE_TMLMT_DE" type="STRING" size="256"/>
          <Column id="REFND_AM" type="STRING" size="256"/>
          <Column id="USE_DAY" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond_print" useclientlayout="true">
        <ColumnInfo>
          <Column id="BUNDLE_AT" type="STRING" size="256"/>
          <Column id="REQST_SN" type="STRING" size="256"/>
          <Column id="PRINT_SE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_test">
        <ColumnInfo>
          <Column id="KEY" type="STRING" size="256"/>
          <Column id="VAL" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="KEY">1</Col>
            <Col id="VAL">일</Col>
          </Row>
          <Row>
            <Col id="KEY">2</Col>
            <Col id="VAL">이</Col>
          </Row>
          <Row>
            <Col id="KEY">3</Col>
            <Col id="VAL">삼</Col>
          </Row>
          <Row>
            <Col id="KEY">4</Col>
            <Col id="VAL">사</Col>
          </Row>
          <Row>
            <Col id="KEY">5</Col>
            <Col id="VAL">오</Col>
          </Row>
          <Row>
            <Col id="KEY">6</Col>
            <Col id="VAL">육</Col>
          </Row>
          <Row>
            <Col id="KEY">7</Col>
            <Col id="VAL">칠</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_bundleConfirm" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_rentReqstManageList_onrowposchanged" oncolumnchanged="ds_rentReqstManageList_oncolumnchanged" cancolumnchange="ds_rentReqstManageList_cancolumnchange" onrowsetchanged="ds_rentReqstManageList_onrowsetchanged">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="MBER_ID" type="STRING" size="256"/>
          <Column id="FCLTS_NM" type="STRING" size="256"/>
          <Column id="FCLTS_SN" type="STRING" size="256"/>
          <Column id="REQST_SN" type="STRING" size="256"/>
          <Column id="RCPMNY_DTLS_SN" type="STRING" size="256"/>
          <Column id="USE_DE" type="STRING" size="256"/>
          <Column id="BEGIN_TIME" type="STRING" size="256"/>
          <Column id="END_TIME" type="STRING" size="256"/>
          <Column id="USE_TIME" type="STRING" size="256"/>
          <Column id="USE_TIME2" type="FLOAT" size="256"/>
          <Column id="USE_PRPOS_SE" type="STRING" size="256"/>
          <Column id="USE_CN" type="STRING" size="256"/>
          <Column id="USE_NMPR" type="INT" size="256"/>
          <Column id="USE_AM" type="INT" size="256"/>
          <Column id="RM" type="STRING" size="256"/>
          <Column id="SETLE_SE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="SETLE_AM" type="INT" size="256"/>
          <Column id="SETLE_STTUS" type="STRING" size="256"/>
          <Column id="REQST_DE" type="STRING" size="256"/>
          <Column id="JDGMN_COMPT_DE" type="STRING" size="256"/>
          <Column id="SETLE_COMPT_DE" type="STRING" size="256"/>
          <Column id="REFND_BANK_CODE" type="STRING" size="256"/>
          <Column id="REFND_BANK_NM" type="STRING" size="256"/>
          <Column id="REFND_ACNUTNO" type="STRING" size="256"/>
          <Column id="REFND_DPSTR" type="STRING" size="256"/>
          <Column id="RCPMNY_BANK_CODE" type="STRING" size="256"/>
          <Column id="RCPMNY_BANK_NM" type="STRING" size="256"/>
          <Column id="RCPMNY_ACNUTNO" type="STRING" size="256"/>
          <Column id="RCPMNYER" type="STRING" size="256"/>
          <Column id="MBER_NM" type="STRING" size="256"/>
          <Column id="GRP_NM" type="STRING" size="256"/>
          <Column id="ADRES" type="STRING" size="256"/>
          <Column id="TELNO" type="STRING" size="256"/>
          <Column id="MBTLNUM" type="STRING" size="256"/>
          <Column id="SETLE_AT" type="STRING" size="256"/>
          <Column id="DELETE_AT" type="STRING" size="256"/>
          <Column id="USE_TIME_FOM" type="STRING" size="256"/>
          <Column id="MNGR_REGIST_AT" type="STRING" size="256"/>
          <Column id="MUMM_RESVE_TIME" type="STRING" size="256"/>
          <Column id="REFND_REQST_DE" type="STRING" size="256"/>
          <Column id="ORDER_NO" type="STRING" size="256"/>
          <Column id="RENT_CANCL_AT" type="STRING" size="256"/>
          <Column id="SETLE_TMLMT_DE" type="STRING" size="256"/>
          <Column id="REFND_AM" type="STRING" size="256"/>
          <Column id="MUMM_RESVE_TIME_SE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_bizplcList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="BIZPLC_CODE" type="STRING" size="256"/>
          <Column id="BIZPLC_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_log">
        <ColumnInfo>
          <Column id="LOG_SN" type="STRING" size="256"/>
          <Column id="OPERT_DT" type="STRING" size="256"/>
          <Column id="MENU_ID" type="STRING" size="256"/>
          <Column id="OPERTOR_IP" type="STRING" size="256"/>
          <Column id="OPERTOR_ID" type="STRING" size="256"/>
          <Column id="OPERT_DTLS" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_com021" useclientlayout="true">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript5.0"><![CDATA[/***********************************************************************
 * 화면ID      : HPM070101
 * 화면명      : 대관신청관리
 * 화면설명   : 대관신청을 관리한다.
 * 작성일      : 2017.08.11
 * 작성자      : 정 민 
 * 수정이력   : 
 ***********************************************************************
 *     수정일     수정자   내용
 ***********************************************************************
 */
 
 
/***********************************************************************
 * Script Include
 ************************************************************************/
// 시스템 공통 라이브러리 Include
include "lib::comInclude.xjs";
include "mis_lib::misUtil.xjs";

/**********************************************************************
* 화면 변수 선언부
***********************************************************************/
this.saveRow = -1;

/***********************************************************************
 * onInit / onLoad 영역
 ***********************************************************************/

this.HPM070101_oninit = function(obj:Form, e:nexacro.InitEventInfo)
{
}

this.HPM070101_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{ 
	this.fn_init_form();
	this.fn_init_dataset();

this.div_search.div_dept.fn_setBind("ds_cond", "DEPT_CODE", "DEPT_NM");
}

/**********************************************************************
* Form/Dataset 오브젝트 초기화
***********************************************************************/

/*
 * 함수명      : initForm
 * 설명         : Form을 초기화한다.
 * params          : None
 * return Type     : None
 * 사용법        : this.initForm();
 */
this.fn_init_form = function()
{
    this.gfn_initForm(this);
    this.fn_misFormInit(this);
	
	var nextMt = this.dateUtils.addMonth(this.dateUtils.today(),1,"s");
	var nLastDay  = this.dateUtils.getLastDay(nextMt).getDate();	//마지막날짜 구하기
	var nextDe = this.dateUtils.format(nextMt,"yyyymm")+nLastDay;

	this.ds_cond.clearData();
	this.ds_cond.addRow();
	this.ds_cond.setColumn(0, "USE_AT"     , "1");
	this.ds_cond.setColumn(0, "SEARCH_CND" , "001");
	this.ds_cond.setColumn(0, "SEARCH_VAL" , "");
	this.ds_cond.setColumn(0, "SEARCH_CND2", "");
	this.ds_cond.setColumn(0, "SETLE_STTUS", "");
	this.ds_cond.setColumn(0, "AM_SE"      , "");
	this.ds_cond.setColumn(0, "SETLE_SE"   , "");
	this.ds_cond.setColumn(0, "FCLTS_SN"   , "");
// 	this.ds_cond.setColumn(0, "DEPT_CODE"  , "000000");
// 	this.ds_cond.setColumn(0, "DEPT_NM"    , "화성도시공사");
 	this.ds_cond.setColumn(0, "DEPT_CODE"  , this.gfn_getDeptId());
 	this.ds_cond.setColumn(0, "DEPT_NM"    , this.gfn_getDeptName());
//  	this.ds_cond.setColumn(0, "DEPT_CODE"  , "050200");
//  	this.ds_cond.setColumn(0, "DEPT_NM"    , "");
	this.ds_cond.setColumn(0, "BGNDE"      , this.dateUtils.format(this.gfn_today(),"yyyymmdd"));
	this.ds_cond.setColumn(0, "ENDDE"      , nextDe);
	this.ds_cond.setColumn(0, "RENT_CANCL_AT", "0");
	this.ds_cond.setColumn(0, "DELETE_AT"    , "0");
	
	// 상세정보 위치에 탭 두개를 위치 시킨다.
	this.div_tab02.set_top(this.div_tab01.top);
	this.div_tab02.set_right(this.div_tab01.right);

    // 공통코드
    var comboParams = [
						  ["ds_setleSttusSe_s", "HPM008", "1", "전체"]      		// 신청상태구분(검색조건)
						 ,["ds_setleSttusSe"  , "HPM008", "1", ""]        			// 신청상태구분
						 ,["ds_setleSe_s"     , "HPM009", "1", "전체"]       		// 결제구분(검색조건)
						 ,["ds_setleSe"       , "HPM009", "1", ""]       	     	// 결제구분
						 ,["ds_com021"        , "COM021", "1", ""]       	     	// 은행코드
                      ];
    var callback = function (svcId, errorCode, errorMsg) {       
       
        // 공통코드와 연계된 초기검색조건 설정
		// 수정가능여부를 판별하기위해 권한그룹 체크
		if(this.gfn_authGrpId("HPM_ADMIN") != -1 || this.gfn_authGrpId("DEV_GRP") != -1) {			// 대관관리자
			this.chargerAt = true;
		}

		// 수정가능한 경우 부서변경 가능
		if(this.chargerAt){
			this.div_search.div_dept.set_enable(true);
			this.div_search.div_dept.div_Search.edt_deptCode.set_cssclass("edt_WF_Essential");
			this.div_search.div_dept.div_Search.edt_deptNm.set_cssclass("edt_WF_Essential");
			this.ds_cond.setColumn(0, "AUTH_AT", "1");
		}else {
			this.div_search.div_dept.set_enable(false);
			this.div_search.div_dept.fn_setReadonly(true);
			this.ds_cond.setColumn(0, "AUTH_AT", "0");
		}
      
		// 사업소 조회
        this.fn_transaction("selectBizplcCode");
    };
    
    this.gfn_comboLoad (comboParams, callback);
}


/*
 * 함수명      : initDataset
 * 설명         : Dataset을 초기화한다
 * params          : None
 * return Type     : None
 * 사용법        : this.initDataset();
 */
this.fn_init_dataset = function()
{
    this.gfn_initCondDs(this, this.div_search);   
}


/**********************************************************************
* Transaction 영역 시작
***********************************************************************
*
* 1. Transaction 관련 이벤트 핸들러
* 2. call Transaction 영역
* 3. callback 영역(Transaction, Popup)
*
***********************************************************************/



/**********************************************************************
* Transaction 관련 이벤트 핸들러
***********************************************************************/

/*
 * 함수명     : fn_search
 * 설명       : 조회 버튼 클릭시 이벤트 발생
 * params        : None
 * return Type    : None
 * 사용법      : this.fn_search();
 */
this.fn_search = function()
{
    if(Ex.util.isUpdated(this.ds_rentReqstManageList)) {
        if(!this.gfn_message("confirm.변경.취소.여부")) {
            return false;
        }
    }
    
   // dataset 초기화
   this.ds_rentReqstManageList.clearData();
   
   //validation 체크
    if(!this.gfn_checkValidation_NoUpdChk(this.ds_cond, this.ds_validation)) {
        return;
    }

   this.fn_transaction("selectRentReqstManageList");
}


/*
 * 함수명     : fn_save
 * 설명       : 저장 버튼 클릭시 이벤트 발생
 * params        : None
 * return Type    : None
 * 사용법      : this.fn_save();
 */
this.fn_save = function()
{
	this.fn_setLogData('[저장] 버튼 클릭');
	
    // 데이터셋 미변경 체크
    if (!this.comUtils.isDatasetUpdated(this.ds_rentReqstManageList)) {
        this.gfn_message("comm.데이터.변경.없음")
        return false;
    }
    
        //validation 체크
    if(!this.gfn_checkValidation_NoUpdChk(this.ds_rentReqstManageList, this.ds_validation)) {
        return;
    }
    
    //SMS 발송
    this.ds_smsList.clearData();
    for(var i = 0; i < this.ds_rentReqstManageList.rowcount; i++) {
		var smsChk = this.ds_rentReqstManageList.getColumn(i, "SMS_CHK");
		var deptCode   = this.ds_rentReqstManageList.getColumn(i, "DEPT_CODE");
		var bizplcCode = this.ds_rentReqstManageList.getColumn(i, "BIZPLC_CODE");
		// 새로 심사완료한 건만 진행한다.
		if(smsChk == "1") {
			var selteAm = !this.comUtils.isNull(this.ds_rentReqstManageList.getColumn(i, "SETLE_AM")) ? this.ds_rentReqstManageList.getColumn(i, "SETLE_AM") : 0;
			
			var callback = "03180127799";
			var userId = "hsuco7765";
			
 			if(deptCode == "050200" && bizplcCode == "C006") {
 				callback = "0313551292";
 				userId = "hssports355";
 			}else if(deptCode == "050200" && bizplcCode == "B001") {
 				callback = "0313519027";
 				userId = "hssports355";
 			}else if(deptCode == "040100") {
				callback = "0313710011";
				userId = "hsstown";
 			}
 			
 			if((deptCode == "050200" && bizplcCode == "C006") || (deptCode == "050200" && bizplcCode == "B001")) {
				 var nRow = this.ds_smsList.addRow();
				 var smsMsgCn = this.fn_setSmsMsgCn(this.ds_rentReqstManageList, i, selteAm);
				 var mberNm = this.ds_rentReqstManageList.getColumn(i, "MBER_NM");
				 var mbtlnum = this.ds_rentReqstManageList.getColumn(i, "MBTLNUM");
				 var mberId = this.ds_rentReqstManageList.getColumn(i, "MBER_ID");
				 var destInfo = mberNm +"^"+mbtlnum;
				 
				 this.ds_smsList.setColumn(nRow, "USER_ID"  , userId);
				 this.ds_smsList.setColumn(nRow, "MMS_MSG"  , smsMsgCn);
				 this.ds_smsList.setColumn(nRow, "DEST_INFO", destInfo);
				 this.ds_smsList.setColumn(nRow, "MBER_ID"  , mberId);
				 this.ds_smsList.setColumn(nRow, "MBTLNUM"  , mbtlnum);
				 this.ds_smsList.setColumn(nRow, "CALLBACK" , callback);
			 }
		}
    }
   
    if(this.gfn_message("confirm.저장.여부")) {
        this.saveRow = this.ds_rentReqstManageList.rowposition;
		this.fn_transaction("saveRentReqstManageList");  
    }
}


/*
 * 함수명     : fn_insert
 * 설명       : 신규 버튼 클릭시 이벤트 발생
 * params        : None
 * return Type    : None
 * 사용법      : this.fn_insert();
 */
this.fn_insert = function() {
	this.fn_setLogData('[신규] 버튼 클릭');
	
	var deptCode = this.ds_cond.getColumn(0, "DEPT_CODE");
	
	var nRow = this.ds_rentReqstManageList.addRow();

	this.ds_rentReqstManageList.setColumn(nRow, "DEPT_CODE"     , deptCode);             // 부서코드
	this.ds_rentReqstManageList.setColumn(nRow, "MBER_ID"       , this.fn_getEmpno());   // 회원ID
	this.ds_rentReqstManageList.setColumn(nRow, "JDGMN_COMPT_DE", this.dateUtils.format(this.gfn_today(),"yyyymmdd"));   // 심사완료일
	this.ds_rentReqstManageList.setColumn(nRow, "MNGR_REGIST_AT", "1");                  // 관리자등록여부
	this.ds_rentReqstManageList.setColumn(nRow, "RENT_CANCL_AT" , "0");                  // 대관취소여부
}


/*
 * 함수명     : fn_delete
 * 설명       : 삭제 버튼 클릭시 이벤트 발생
 * params        : None
 * return Type    : None
 * 사용법      : this.fn_delete();
 */
this.fn_delete = function() {
	var chkId = "";
	for(var fRow = 0; fRow < this.ds_rentReqstManageList.getRowCount(); fRow++) {
		var chk = this.ds_rentReqstManageList.getColumn(fRow, "CHK");
		if(chk == '1') {
			var mberId = this.ds_rentReqstManageList.getColumn(fRow, "MBER_ID");
			chkId += mberId;
		}
		if(fRow < this.ds_rentReqstManageList.getRowCount()-1) {
			chkId += ", ";
		}
	}
	this.fn_setLogData('[삭제] 버튼 클릭 (회원ID : ' + chkId + ')');
	
	this.gfn_delMultiRow(this.ds_rentReqstManageList);
}


/*
 * 함수명     : fn_cancel
 * 설명       : 취소 버튼 클릭시 이벤트 발생
 * params        : None
 * return Type    : None
 * 사용법      : this.fn_cancel();
 */
this.fn_cancel = function() {
	this.fn_setLogData('[취소] 버튼 클릭');
	
     // 데이터셋 변경 체크
    if(Ex.util.isUpdated(this.ds_rentReqstManageList)) {
        if(!this.gfn_message("confirm.변경.취소.여부")) {
            return false;
        }
    }

    if (this.gfn_message("confirm.취소여부")) {
        this.ds_rentReqstManageList.reset();
        this.ds_rentReqstManageList.applyChange();
    }

}

/**********************************************************************
* call Transaction 영역
***********************************************************************/

/*
 * 함수명      : fn_transaction
 * 설명         : Transaction 요청 처리 함수
 * params          : strSvcId : 서비스요청 ID
 * return Type     : None
 * 사용법        : this.fn_transaction("SELECT");
 */
this.fn_transaction = function(strSvcId)
{
    switch (strSvcId) {
        //  사업소 조회
        case "selectBizplcCode":
			var sController   	= "/hsco/hpm/usm/HPM010203/selectBizplcList.do";
			var sInDatasets   	= "input1=ds_cond";
			var sOutDatasets  	= "ds_bizplcList=output1";
			break;
        //  대관시설 목록 조회(콤보리스트)
        case "selectRentFcltsManageList":
            var sController       = "hsco/hpm/ctm/HPM060101/selectRentFcltsManageList.do";
            var sInDatasets       = "input1=ds_cond";
            var sOutDatasets      = "ds_rentFcltsManageList=output1";
            break;
        // 대관신청 목록 조회
        case "selectRentReqstManageList":
            var sController       = "hsco/hpm/ctm/HPM070101/selectRentReqstManageList.do";
            var sInDatasets       = "input1=ds_cond";
            var sOutDatasets      = "ds_rentReqstManageList=output1";
            break;
        //  대관신청 목록 저장
        case "saveRentReqstManageList":
            var sController       = "hsco/hpm/ctm/HPM070101/saveRentReqstManageList.do";
            var sInDatasets       = "input1=ds_rentReqstManageList:U input2=ds_smsList:U";
            var sOutDatasets      = "";
            break;
        //  대관신청 이관
        case "trnsferReqstInfoList":
            var sController       = "hsco/hpm/ctm/HPM070101/trnsferReqstInfoList.do";
            var sInDatasets       = "input1=ds_cond";
            var sOutDatasets      = "";
            break;
        //  대사관리(입금내역) 목록 조회
        case "selectRcpmnyDtlsList":
            var sController       = "hsco/hpm/ctm/HPM070101/selectRcpmnyDtlsList.do";
            var sInDatasets       = "input1=ds_cond2";
            var sOutDatasets      = "ds_rcpmnyDtlsList=output1";
            break;
        //  입금내역매핑처리
        case "rcpmnyDtlsMapping":
            var sController       = "hsco/hpm/ctm/HPM070101/rcpmnyDtlsMapping.do";
            var sInDatasets       = "input1=ds_rcpmnyDtlsManageList:U input2=ds_rentReqstManage:U";
            var sOutDatasets      = "";
            break;
         // 대관신청 목록 조회(엑셀)
        case "selectExcelRentReqstManageList":
            var sController       = "hsco/hpm/ctm/HPM070101/selectExcelRentReqstManageList.do";
            var sInDatasets       = "input1=ds_cond";
            var sOutDatasets      = "ds_excelRentReqstManageList=output1";
            break;
    }

    Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets);
}


/**********************************************************************
 * Transaction Callback 영역
 ***********************************************************************/
 /*
 * 함수명      : fn_callBack
 * 설명         : Transaction Callback 처리
 * params          : strSvcId    : 서비스요청 ID
 *                nErrorCode  : 오류 메시지 코드 ([예] 0 : Success, 그밖의 경우, error)
 *                strErrorMsg : 오류 메시지([예]  success.insert|정상적으로 등록되었습니다.)
 * return Type     : None
 * 사용법        :
 */
this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg)
{
    if(nErrorCode != '0') {
        this.gfn_callback_message(strSvcId, nErrorCode, strErrorMsg);
    }

    if (nErrorCode == '0'){
    switch (strSvcId) {
        //  사업소 조회
        case "selectBizplcCode":
			if(this.ds_bizplcList.rowcount < 1) {
				this.ds_bizplcList.insertRow(0);
				this.ds_bizplcList.setColumn(0, "BIZPLC_CODE", "9999");
				this.ds_bizplcList.setColumn(0, "BIZPLC_NM"  , "해당없음");
				this.fn_transaction("selectRentFcltsManageList");
			}
			this.div_search.cmb_bizplcList.set_index(0);
			break;  
		case "selectRentFcltsManageList":
			//trace("selectRentFcltsManageList 콜백");
			this.ds_rentFcltsManageList_s.copyData(this.ds_rentFcltsManageList);
			this.ds_rentFcltsManageList.set_filterstr("USE_AT == '1'");

			this.ds_rentFcltsManageList_s.insertRow(0);
			this.ds_rentFcltsManageList_s.setColumn(0, "FCLTS_SN", "");
			this.ds_rentFcltsManageList_s.setColumn(0, "FCLTS_NM", "전체");
			this.ds_cond.setColumn(0, "FCLTS_SN", "");
			
			this.fn_search();
			break;
		// 대관신청 목록 조회
		case "selectRentReqstManageList":
			if(this.saveRow != -1) {
				this.ds_rentReqstManageList.set_rowposition(this.saveRow);
				this.saveRow = -1;
			}
			 break;
		//  대관신청 목록 저장
		case "saveRentReqstManageList":
				 this.fn_search();
				 break;
		//  대관신청 이관
		case "trnsferReqstInfoList":
			  this.gfn_message("success.처리.성공"); 
			  this.fn_search();
				 break;
		//  대사관리(입금내역) 목록 조회
		case "selectRcpmnyDtlsList":
			 break;
		//  입금내역매핑처리
		case "rcpmnyDtlsMapping":
			this.gfn_message("success.처리.성공");
			this.fn_search();
			break;
         // 대관신청 목록 조회(엑셀)
        case "selectExcelRentReqstManageList":
			this.gfn_exportExcel(this.grd_excelRentReqstManageList, "grd_excelRentReqstManageList");	
        	break;
       	}
    }
}

/**********************************************************************
* Transaction 영역 끝
***********************************************************************/

/**********************************************************************
* non-Transaction 관련 컴포넌트 이벤트 처리 함수
***********************************************************************
*
* 1. Dataset 관련 이벤트 처리
* 2. Button 관련 이벤트 처리
* 3. Grid 관련 이벤트 처리
* 4. 공통함수 처리
* 5. Object 관련 이벤트 처리
*
***********************************************************************/


/**********************************************************************
* Dataset 관련 이벤트 처리
***********************************************************************/

/*
 * 함수명      : ds_rentReqstManageList_oncolumnchanged
 * 설명         : 신청관리목록 데이터셋 값 변경후 발생
 * params      : None
 * return Type   : None
 * 사용법      : this.ds_rentReqstManageList_oncolumnchanged
 */
this.ds_rentReqstManageList_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
   var cRow = obj.rowposition;   
   // 시설
   if(e.columnid == "FCLTS_SN") {
	  var fcltsRow = this.ds_rentFcltsManageList.findRow("FCLTS_SN", e.newvalue);
	  var fcltsNm = this.ds_rentFcltsManageList.getColumn(fcltsRow, "FCLTS_NM");
	  var mummResveTimeSe = this.ds_rentFcltsManageList.getColumn(fcltsRow, "MUMM_RESVE_TIME_SE");
	  var bizplcCode = this.ds_rentFcltsManageList.getColumn(fcltsRow, "BIZPLC_CODE");
	  var deptCode  = this.ds_rentFcltsManageList.getColumn(fcltsRow, "DEPT_CODE");
	  obj.setColumn(cRow, "FCLTS_NM", fcltsNm);
	  obj.setColumn(cRow, "MUMM_RESVE_TIME_SE", mummResveTimeSe);
	  obj.setColumn(cRow, "SETLE_AM"     , "");
      obj.setColumn(cRow, "USE_TIME"     , "");
      obj.setColumn(cRow, "BEGIN_TIME"   , "");
      obj.setColumn(cRow, "END_TIME"     , "");
      obj.setColumn(cRow, "BIZPLC_CODE"  , bizplcCode);
      obj.setColumn(cRow, "DEPT_CODE"    , deptCode);
      this.div_tab01.tab_detailInfo.tpg_reqstInfo.div_useTime.destroy();
	  var div_useTime = new Div("div_useTime", "absolute", 88, 80, null, 47, 3, null);
	  this.div_tab01.tab_detailInfo.tpg_reqstInfo.addChild("div_useTime", div_useTime);
	  div_useTime.show();
   
   }else if(e.columnid == "USE_DE") {
	  trace("????");
	  obj.setColumn(cRow, "SETLE_AM", "");
      obj.setColumn(cRow, "BEGIN_TIME", "");
      obj.setColumn(cRow, "END_TIME", "");
      obj.setColumn(cRow, "USE_TIME", "");
      obj.setColumn(cRow, "USE_TIME", "");
      this.div_tab01.tab_detailInfo.tpg_reqstInfo.div_useTime.destroy();
	  var div_useTime = new Div("div_useTime", "absolute", 88, 80, null, 47, 3, null);
	  this.div_tab01.tab_detailInfo.tpg_reqstInfo.addChild("div_useTime", div_useTime);
	  div_useTime.show();
	  
	  var setleSttus = obj.getColumn(obj.rowposition, "SETLE_STTUS");
	  if(setleSttus == "003") {
		  var setleTmlmtDe = this.fn_setSetleTmlmtDe(obj, obj.rowposition)	  // 결제기한일자  
		  obj.setColumn(cRow, "SETLE_TMLMT_DE", setleTmlmtDe);
	  }
   
   }else if(e.columnid == "USE_PRPOS_SE") {
	  obj.setColumn(cRow, "SETLE_AM", "");
      obj.setColumn(cRow, "BEGIN_TIME", "");
      obj.setColumn(cRow, "END_TIME", "");
      obj.setColumn(cRow, "USE_TIME", "");
      this.div_tab01.tab_detailInfo.tpg_reqstInfo.div_useTime.destroy();
	  var div_useTime = new Div("div_useTime", "absolute", 88, 80, null, 47, 3, null);
	  this.div_tab01.tab_detailInfo.tpg_reqstInfo.addChild("div_useTime", div_useTime);
	  div_useTime.show();
   
   }else if(e.columnid == "CHK") {
		//obj.set_updatecontrol(true);
   }else if(e.columnid == "MBER_NM" || e.columnid == "GRP_NM" || e.columnid == "MBTLNUM") {
		var workSe = e.columnid == "MBER_NM" ? "이름" : (e.columnid == "GRP_NM" ? "단체명" : (e.columnid == "MBTLNUM" ? "전화번호" : ""));
		var mberId = this.ds_rentReqstManageList.getColumn(e.newrow, "MBER_ID");
		if(!this.comUtils.isNull(mberId)) {
			this.fn_setLogData("회원정보 변경 (항목 : " + workSe + " / 회원ID : " + mberId + ")");
		}
	}else if(e.columnid == "SETLE_AM") {
		var setleSttus = obj.getColumn(obj.rowposition, "SETLE_STTUS");
		if(setleSttus == "003") {
		  if(this.comUtils.isNull(e.newvalue) || e.newvalue == 0)
			  obj.setColumn(cRow, "SETLE_TMLMT_DE", null)
		  else{
			  var setleTmlmtDe = this.fn_setSetleTmlmtDe(obj, obj.rowposition)	  // 결제기한일자  
			  obj.setColumn(cRow, "SETLE_TMLMT_DE", setleTmlmtDe)		  
		  }
		}
	}

 	// 진행상태 변경시 발생되는 작업
	else if(e.columnid == "SETLE_STTUS") {
      switch(e.newvalue) {
          case "001" :    // 심사중
            obj.setColumn(cRow, "JDGMN_COMPT_DE", null);
            obj.setColumn(cRow, "SMS_CHK"       , null);
            obj.setColumn(cRow, "SETLE_TMLMT_DE", null);
			break;
         case "002" :    // 반려
            obj.setColumn(cRow, "JDGMN_COMPT_DE", null);
            obj.setColumn(cRow, "SMS_CHK"       , null);
            obj.setColumn(cRow, "SETLE_TMLMT_DE", null);
			break;
         case "003" :    // 심사완료
            var jdgmnComptDe = obj.getOrgColumn(cRow, "JDGMN_COMPT_DE");
            var de = !this.comUtils.isNull(jdgmnComptDe) ? jdgmnComptDe : this.dateUtils.format(this.gfn_today(),"yyyymmdd");
            obj.setColumn(cRow, "JDGMN_COMPT_DE", de);
            obj.setColumn(cRow, "SETLE_COMPT_DE", null);
            obj.setColumn(cRow, "REFND_REQST_DE", null)
			
			var setleTmlmtDe = this.fn_setSetleTmlmtDe(obj, obj.rowposition)	  // 결제기한일자  
			obj.setColumn(cRow, "SETLE_TMLMT_DE", setleTmlmtDe);
		  
            // 홈페이지에서 회원이 신청했을 때
            obj.setColumn(cRow, "SMS_CHK"       , "1");
            break;
         case "004" :   // 입금대기
			obj.setColumn(cRow, "SETLE_SE"      , "002");	// 결제구분 - 무통장입금
            obj.setColumn(cRow, "SMS_CHK"       , null);
            break;
         case "005" :   // 결제완료
            obj.setColumn(cRow, "SETLE_COMPT_DE", this.dateUtils.format(this.gfn_today(),"yyyymmdd"));
            obj.setColumn(cRow, "REFND_REQST_DE", null);
            obj.setColumn(cRow, "SMS_CHK"       , null);
            break;
         case "006" :   // 환불요청
            obj.setColumn(cRow, "REFND_REQST_DE", this.dateUtils.format(this.gfn_today(),"yyyymmdd"));
            obj.setColumn(cRow, "SMS_CHK"       , null);
			 break;
         case "006" :   // 환불완료
            obj.setColumn(cRow, "SMS_CHK"       , null);
            break;
		}
	}
}


this.ds_rentReqstManageList_cancolumnchange = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{   
	var cRow = obj.rowposition;
   if(e.columnid == "CHK") {
		obj.set_updatecontrol(true);
   }else if(e.columnid == "SETLE_TMLMT_DE") {
		// 심사완료일자보다 커야 함
		var jdgmnComptDe = this.ds_rentReqstManageList.getColumn(cRow, "JDGMN_COMPT_DE");
		if(!this.comUtils.isNull(e.newvalue) && jdgmnComptDe > e.newvalue) {
			this.gfn_message("info.처리불가","결제기한일자는 심사완료일자보다 커야 합니다.");
			return false;
		}
   }
}


/*
 * 함수명      : ds_rentReqstManageList_onrowposchanged
 * 설명         : 신청관리목록 데이터셋 행 변경후 발생
 * params      : None
 * return Type   : None
 * 사용법      : this.ds_rentReqstManageList_onrowposchanged("SELECT");
 */
this.ds_rentReqstManageList_onrowposchanged = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{
	// 진행상태 콤보값을 셋팅시키기 위해서
	// (fn_insert 에서 셋팅 시키기 전에 이 메서드를 먼저 탐)
	// 삭제여부 - SETLE_STTUS 값을 변경했을 떄 유지시키기 위한 값
	if(obj.getRowType(e.newrow) == "2" && this.comUtils.isNull(obj.getColumn(e.newrow, "DELETE_AT"))) {
		obj.setColumn(e.newrow, "SETLE_STTUS"   , "003");                // 진행상태(심사완료)
		obj.setColumn(e.newrow, "DELETE_AT"     , "0");                  // 삭제여부
	}
	
	if(e.newrow > -1) {
		var mberId = this.ds_rentReqstManageList.getColumn(e.newrow, "MBER_ID");
		if(!this.comUtils.isNull(mberId)) {
			this.fn_setLogData('회원정보 확인 (회원ID : ' + mberId + ')');
		}
		
		this.ds_rcpmnyDtlsList.clearData();

		var cRow = obj.rowposition;
		var setleSttus = obj.getOrgColumn(cRow, "SETLE_STTUS");
		var setleComptDe = obj.getOrgColumn(cRow, "SETLE_COMPT_DE");
		var setleSe = obj.getColumn(cRow, "SETLE_SE");
		var setleAm = obj.getColumn(cRow, "SETLE_AM");
		var fcltsSn = obj.getColumn(cRow, "FCLTS_SN");
		var useDe = obj.getColumn(cRow, "USE_DE");
		var setleAt = obj.getColumn(cRow, "SETLE_AT");
		var useTime = obj.getColumn(cRow, "USE_TIME");
		var reqstDe = obj.getColumn(cRow, "REQST_DE");
		var mngrRegistAt = obj.getColumn(cRow, "MNGR_REGIST_AT");
		var deptCode = obj.getColumn(cRow, "DEPT_CODE");
		var rowType = obj.getRowType(cRow);

		// 진행상태가 환불요청, 환불완료, 심사완료(결제완료일자 존재)일 경우 우측 상세정보 탭 변경
		// --> 심사완료(결제완료일자 존재) ? 진행상태 환불요청, 환불완료 일때만 탭 바뀌도록 변경
		this.parent.parent.set_enableevent(false);
		//if((setleSttus == "003" && !this.comUtils.isNull(setleComptDe)) || setleSttus == "006" || setleSttus == "007") {
		if(setleSttus == "006" || setleSttus == "007") {
			this.div_tab01.set_visible(false);
			this.div_tab02.set_visible(true);
		}else {
			this.div_tab01.set_visible(true);
			this.div_tab02.set_visible(false);
		}
		this.parent.parent.set_enableevent(true);

		// 현 진행상태에 따른 콤보 아이템 필터링
		this.ds_setleSttusSe.set_filterstr("String(VAL0).indexOf("+setleSttus+") > -1");
		
		// 탭 오브젝트 셋팅
		var div_testTrget = this.div_tab01.visible == true ? this.div_tab01 : this.div_tab02;
		div_testTrget.fn_changeObjectProperty();
		

		// 조회조건 -  결제구분 : 무통장입금, 매핑여부 : 미매핑, 진행상태 : 입금대기
		// setleAt(RCPMNY_DTLS_NO -> 직접 매핑한 경우 NH_HIS... 테이블 키 값 저장)
		if(setleSe == "002" && setleAt == "0" && setleSttus == "004") { 
			this.btn_rcpmnyDtlsMapping.set_visible(true);
			
			this.ds_cond2.clearData();
			this.ds_cond2.addRow();
			this.ds_cond2.setColumn(0, "DEPT_CODE", deptCode);  // 부서코드
			this.ds_cond2.setColumn(0, "SETLE_AM", setleAm);	// 결제금액
			this.ds_cond2.setColumn(0, "REQST_DE", reqstDe);	// 신청일자

			// 대사관리(입금내역) 조회
			this.fn_transaction("selectRcpmnyDtlsList");
		}else {
			this.btn_rcpmnyDtlsMapping.set_visible(false);
		}
		
	}else {
		// 탭 오브젝트 셋팅
		var div_testTrget = this.div_tab01.visible == true ? this.div_tab01 : this.div_tab02;
/*		div_testTrget.fn_onrowsetchanged();*/
	}
   
}

/*
 * 함수명		: ds_cond_oncolumnchanged
 * 설명			: 검색 데이터셋 데이터 변경시 발생
 * params 		: None
 * return Type	: None
 * 사용법   	: this.ds_cond_oncolumnchanged();
 */
this.ds_cond_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	if(e.columnid == "DEPT_CODE") {
		this.ds_bizplcList.set_filterstr("");
		var deptCode = e.newvalue;
		this.ds_bizplcList.set_filterstr("DEPT_CODE == '"+deptCode+"' || BIZPLC_CODE == '9999'"); // 부서검색조건에 해당하는 사업소 목록 조회
		var bizplcCode = this.ds_bizplcList.getColumn(0, "BIZPLC_CODE");
		this.ds_cond.setColumn(0, "BIZPLC_CODE", bizplcCode);
		//this.div_search.cmb_bizplcList.set_index(0);
		//this.ds_cond.setColumn(0, "BIZPLC_CODE", "9999");
		//this.ds_bizplcList.set_filterstr("DEPT_CODE == '"+deptCode+"'"); // 부서검색조건에 해당하는 사업소 목록 조회
		this.fn_transaction("selectRentFcltsManageList");
	}else if(e.columnid == "BIZPLC_CODE") {
		//trace("BIZPLC_CODE 변경");
		// 시설목록 조회
		this.fn_transaction("selectRentFcltsManageList");
	}
}
/**********************************************************************
* Button 관련 이벤트 처리
***********************************************************************/


/*
 * 함수명      : btn_trnsfer_onclick
 * 설명         : 초기데이터 갱신
 * params      : None
 * return Type   : None
 * 사용법      : this.btn_trnsfer_onclick();
 */
// this.btn_trnsfer_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
// {
// 	var deptCode = this.ds_cond.getColumn(0, "DEPT_CODE");
// 
// 	if(!this.comUtils.isNull(deptCode)) {   
// 		if(application.confirm("기존 인조잔디구장 대관 사이트의 해당 일자 데이터를 초기데이터로 갱신하시겠습니까?\n계속 진행하시면 기존 데이터는 삭제됩니다.")) { 
// 			this.fn_transaction("trnsferReqstInfoList");  
// 		}
// 	}
// }

/*
 * 함수명      : btn_rcpmnyDtlsMapping_onclick
 * 설명         : 입금내역매핑처리
 * params      : None
 * return Type   : None
 * 사용법      : this.btn_rcpmnyDtlsMapping_onclick();
 */
this.btn_rcpmnyDtlsMapping_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{	
   	if(this.ds_rcpmnyDtlsList.rowposition < 0) {
		alert("매핑할 입금내역이 없습니다.");
		return false;
	}

	var cRow = this.ds_rentReqstManageList.rowposition;
   var setleAt = this.ds_rentReqstManageList.getColumn(cRow, "SETLE_AT");
   var setleSttus = this.ds_rentReqstManageList.getOrgColumn(cRow, "SETLE_STTUS");
   
	if(setleAt == "1") {
		alert("해당 신청내역은 이미 매핑처리가 되었습니다.");
		return false;
	}
   
	if(setleSttus == "001" || setleSttus == "002" ||setleSttus == "005") {
		alert("해당 진행상태에서는 입금내역을 매핑처리 할 수 없습니다.");
		return false;
	}

	if(application.confirm("해당 입금내역을 매핑처리 하시겠습니까?")) {
		var rcpmnyDtlsListRow = this.ds_rcpmnyDtlsList.rowposition;
		var csv = "-";
		
		this.ds_rentReqstManageList.setColumn(cRow, "SETLE_SE", "002"); // 무통장입금
 		var bankCd       = !this.comUtils.isNull(this.ds_rcpmnyDtlsList.getColumn(rcpmnyDtlsListRow, "BANK_CD")) ? this.ds_rcpmnyDtlsList.getColumn(rcpmnyDtlsListRow, "BANK_CD") : '';
 		var acctNo       = !this.comUtils.isNull(this.ds_rcpmnyDtlsList.getColumn(rcpmnyDtlsListRow, "ACCT_NO")) ? this.ds_rcpmnyDtlsList.getColumn(rcpmnyDtlsListRow, "ACCT_NO") : '';
 		var cuprUnit     = !this.comUtils.isNull(this.ds_rcpmnyDtlsList.getColumn(rcpmnyDtlsListRow, "CURR_UNIT")) ? this.ds_rcpmnyDtlsList.getColumn(rcpmnyDtlsListRow, "CURR_UNIT") : '';
 		var inqno        = !this.comUtils.isNull(this.ds_rcpmnyDtlsList.getColumn(rcpmnyDtlsListRow, "INQNO")) ? this.ds_rcpmnyDtlsList.getColumn(rcpmnyDtlsListRow, "INQNO") : '';
 		var acctTxday    = !this.comUtils.isNull(this.ds_rcpmnyDtlsList.getColumn(rcpmnyDtlsListRow, "ACCT_TXDAY")) ? this.ds_rcpmnyDtlsList.getColumn(rcpmnyDtlsListRow, "ACCT_TXDAY") : '';
 		var acctTxdaySeq = !this.comUtils.isNull(this.ds_rcpmnyDtlsList.getColumn(rcpmnyDtlsListRow, "ACCT_TXDAY_SEQ")) ? this.ds_rcpmnyDtlsList.getColumn(rcpmnyDtlsListRow, "ACCT_TXDAY_SEQ") : '' ;
 		var orderNo		 = this.ds_rentReqstManageList.getColumn(cRow, "ORDER_NO");
 		var setleSe      = this.ds_rentReqstManageList.getColumn(cRow, "SETLE_SE");
 		var amount       = this.ds_rentReqstManageList.getColumn(cRow, "SETLE_AM");
 		var mberNm 	     = this.ds_rentReqstManageList.getColumn(cRow, "MBER_NM");
 		var fcltsNm      = this.ds_rentReqstManageList.getColumn(cRow, "FCLTS_NM");
 		var useDe        = this.ds_rentReqstManageList.getColumn(cRow, "USE_DE");
		var useTimeFom   = this.ds_rentReqstManageList.getColumn(cRow, "USE_TIME_FOM");
		var deptCode     = this.ds_rentReqstManageList.getColumn(cRow, "DEPT_CODE");
		var bizplcCode   = this.ds_rentReqstManageList.getColumn(cRow, "BIZPLC_CODE");
		this.ds_rentReqstManageList.set_updatecontrol(false);
		
		this.ds_rentReqstManageList.set_updatecontrol(true);
		var goodsInfo = fcltsNm+useDe+" / "+useTimeFom.replace(/[\n]/g, " ");
		
		// 입금내역 
		this.ds_rcpmnyDtlsManageList.clearData();
		this.ds_rcpmnyDtlsManageList.addRow();
		var rcpmnyDtlsNo = bankCd + csv + acctNo + csv + cuprUnit + csv + inqno + csv + acctTxday + csv + acctTxdaySeq;   // PK들을 묶어 RCPMNY_DTLS_NO에 저장
		this.ds_rcpmnyDtlsManageList.setColumn(0, "RCPMNY_DTLS_NO"   , rcpmnyDtlsNo);
		this.ds_rcpmnyDtlsManageList.setColumn(0, "ORDER_NO"         , orderNo);		// 주문번호
		this.ds_rcpmnyDtlsManageList.setColumn(0, "SETLE_SE"         , setleSe);		// 결제수단(무통장입금)
		this.ds_rcpmnyDtlsManageList.setColumn(0, "AMOUNT"           , amount);			// 금액
		this.ds_rcpmnyDtlsManageList.setColumn(0, "SETLE_INSTT"      , bankCd);			// 결제기관
		this.ds_rcpmnyDtlsManageList.setColumn(0, "EXCCLC_AM"        , amount);			// 정산금액
		this.ds_rcpmnyDtlsManageList.setColumn(0, "PURCHSR"          , mberNm);			// 구매자
		this.ds_rcpmnyDtlsManageList.setColumn(0, "GOODS_INFO"       , goodsInfo);		// 상품정보(시설명, 사용일자, 사용시간, (?))
		this.ds_rcpmnyDtlsManageList.setColumn(0, "DEPT_CODE"        , deptCode);		// 부서코드
		this.ds_rcpmnyDtlsManageList.setColumn(0, "SETLE_DE"         , acctTxday);		// 결제일자
		this.ds_rcpmnyDtlsManageList.setColumn(0, "BIZPLC_CODE"      , bizplcCode);		// 사업소
				
		// 신청정보
		this.ds_rentReqstManage.clearData();
		this.ds_rentReqstManage.addRow();
		this.ds_rentReqstManage.copyRow(0, this.ds_rentReqstManageList, cRow);
		
		// 진행상태 변경(결제완료)
		this.ds_rentReqstManage.setColumn(0, "SETLE_COMPT_DE", acctTxday);
		this.ds_rentReqstManage.setColumn(0, "SETLE_STTUS"   , "005");

		this.fn_transaction("rcpmnyDtlsMapping");   
      }
}

/**********************************************************************
* Grid 관련 이벤트 처리
***********************************************************************/

/**********************************************************************
* 공통함수 처리
***********************************************************************/

/**********************************************************************
* Tab 관련 이벤트 처리
***********************************************************************/

/**********************************************************************
* Popup 관련 이벤트 처리
***********************************************************************/

/**********************************************************************
* 사용자 정의 함수
***********************************************************************/

/*
 * 함수명  	: fn_get_imgUrl
 * 설명 		: 진행상태 이미지
 * params  		: 
 * return Type 	: 
 * 사용법		: this.fn_get_imgUrl(sanctnSts)
 */
this.fn_get_imgUrl = function(s_reqstSttus)
{	
	var imgTitle = "";
	var reqstSttus = s_reqstSttus.substring(3, 2);
	
	imgTitle= "ico_reqstSttus"+reqstSttus;
	
	return 'theme://images/'+imgTitle+'.png';
}

/*
 * 함수명  	: ds_rentReqstManageList_onrowsetchanged
 * 설명 		: 
 * params  		: 
 * return Type 	: 
 * 사용법		: this.ds_rentReqstManageList_onrowsetchanged
 */
this.ds_rentReqstManageList_onrowsetchanged = function(obj:Dataset, e:nexacro.DSRowsetChangeEventInfo)
{
	// 탭 오브젝트 셋팅
	var div_testTrget = this.div_tab01.visible == true ? this.div_tab01 : this.div_tab02;
	//div_testTrget.fn_onrowsetchanged();
}

/*
 * 함수명  	: fn_setSetleTmlmtDe
 * 설명 		: 결제기한일자 셋팅
 * params  		: 
 * return Type 	: 
 * 사용법		: this.fn_setSetleTmlmtDe
 */
this.fn_setSetleTmlmtDe = function(dataset, nRow) {
	trace("fn_setSetleTmlmtDe");
 	var today = this.dateUtils.format(this.gfn_today(),"yyyymmdd");
 	var deptCode = this.ds_cond.getColumn(0, "DEPT_CODE");			    // 부서
 	var selteAm = dataset.getColumn(nRow, "SETLE_AM");					//금액
 	selteAm  = !this.comUtils.isNull(selteAm) ? nexacro.toNumber(selteAm) : 0;
 	var useDe = dataset.getColumn(nRow, "USE_DE");						//사용일자
 	var reqstDe = dataset.getColumn(nRow, "REQST_DE");					//신청일자
 	var jdgmnComptDe = dataset.getColumn(nRow, "JDGMN_COMPT_DE");		//심사완료일자
 	var period = 5;	// 기간(default)
 	
 	// 부서에 따라 결제기한일자를 기간을 다르게 둘수도 있기 때문에
 	if(deptCode == "050200") {
		period = 5;
 	}
 	if(deptCode == "040100") {
		period = 5;
 	}
 	
 	var setleTmlmtDe = this.gfn_addDate(jdgmnComptDe, period, "D"); 	
 	
 	if(selteAm > 0) {
		// 조건 1. 사용일자는 오늘보다 커야하며, 심사완료일자는 오늘보다 같거나 커야함
		if(useDe > today && jdgmnComptDe <= today) {
			// 조건 2. 사용일자 <= 결제기한일자
			if(useDe <= setleTmlmtDe) {
				setleTmlmtDe = this.gfn_addDate(useDe, -1, "D");
			}
		}else {
			setleTmlmtDe = "";
		}
 	}
 	
 	return setleTmlmtDe;
}

/*
 * 함수명  	: fn_setSmsMsgCn
 * 설명 		: SMS 셋팅
 * params  		: 
 * return Type 	: 
 * 사용법		: this.fn_setSmsMsgCn
 */
this.fn_setSmsMsgCn = function(dataset, nRow, setlsAm) {
 	var fcltsNm      = dataset.getColumn(nRow, "FCLTS_NM");
 	var useDe        = this.dateUtils.format(dataset.getColumn(nRow, "USE_DE"), 'yyyy-mm-dd');				//사용일자
 	
 	// 무료구장이라도 문자보내줌
 	if(setlsAm == 0) {
		var msg = "[화성도시공사] "+fcltsNm+" "+useDe+" 대관승인";
 	}else {
		var setleTmlmtDe = this.dateUtils.format(dataset.getColumn(nRow, "SETLE_TMLMT_DE"), 'yyyy-mm-dd');		//결제기한일자
		var msg = "[화성도시공사] "+fcltsNm+" "+useDe+" 대관승인, 결제기한 "+setleTmlmtDe+"/ 미결제시 자동취소";
 	}
 	
 	return msg;
}

 
this.fn_print = function() {
	
	//validation 체크
    if(!this.gfn_checkValidation_NoUpdChk(this.ds_cond, this.ds_validation)) {
        return;
    }
        
    if(!this.ds_rentReqstManageList.getRowCount() > 0) {
		alert("인쇄할 대관신청목록이 없습니다.");
		return;
	}
	this.ds_cond_print.clearData();
	this.ds_cond_print.addRow();
	this.div_print.set_visible(true);
}


this.div_print_btn_print_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{	
	var printSe = this.ds_cond_print.getColumn(0, "PRINT_SE");
	
	var bundleAt = "1";	// 일괄출력
	var reqstSn = "";
	for(var i = 0; i < this.ds_rentReqstManageList.rowcount; i++) {
		reqstSn += (i == 0 ? "" : ",");
		reqstSn += this.ds_rentReqstManageList.getColumn(i, "REQST_SN");
	}
	
	this.ds_cond_print.setColumn(0, "REQST_SN"  , reqstSn);
	this.ds_cond_print.setColumn(0, "BUNDLE_AT" , bundleAt);
	
	// 허가신청서
	if(printSe == "001") {
		this.gfn_ReportPopup(this, "HPM/HPM070101_R02.crf", this.ds_cond_print);
	}else {
	// 허가서
		this.gfn_ReportPopup(this, "HPM/HPM070101_R01.crf", this.ds_cond_print);
	}
}

this.div_print_btn_printCancel_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.div_print.set_visible(false);
}


/***********************************************************************************
* 설명	: 헤드클릭 정렬
***********************************************************************************/
this.grd_rentReqstManageList_onheadclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	if(e.col == "0") {
		this.ds_rentReqstManageList.set_updatecontrol(false);
		this.gfn_setGridCheckAll(obj, e);
		this.ds_rentReqstManageList.set_updatecontrol(true);
	}else {
		LGV_COL_SORT = e.col; 
		this._gridSort(obj, e);	
	}
}


/*
 * 함수명  	: btn_excelDown_onclick
 * 설명 		: 엑셀 다운
 * params  		: 
 * return Type 	: 
 * 사용법		: this.btn_excelDown_onclick
 */
this.btn_excelDown_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.fn_transaction("selectExcelRentReqstManageList");
}


/*
 * 함수명  	: btn_bundleConfirm_onclick
 * 설명 		: 일괄심사승인
 * params  		: 
 * return Type 	: 
 * 사용법		: this.btn_bundleConfirm_onclick
 */
this.btn_bundleConfirm_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var chkCount = this.ds_rentReqstManageList.getCaseCount("CHK == '1'");
 	
 	if(chkCount < 1) {
		this.gfn_message("info.처리불가","일괄심사승인 할 데이터가 없습니다.\n검색조건 변경 후 다시 진행해주시기 바랍니다.");
		return false;
 	}
 
	for(var i = 0; i < this.ds_rentReqstManageList.rowcount; i++) {
		var chk   = this.ds_rentReqstManageList.getColumn(i, "CHK");
		var sttus = this.ds_rentReqstManageList.getColumn(i, "SETLE_STTUS");
		if(chk == "1") {
			if((sttus != "001") && (sttus != "003")) {
				this.gfn_message("info.처리불가",(i+1)+"행의 진행상태를 심사완료로 변경할 수 없습니다.\n확인하신 후 다시 진행해주시기 바랍니다.");
				this.ds_rentReqstManageList.set_rowposition(i);
				return false;
			}
		}
	}
 	
 	if(application.confirm("체크된 신청정보의 진행상태를 심사승인으로 변경하시겠습니까?\n최종 저장은 상단 [저장] 버튼 클릭하셔야 저장됩니다.")) {
		for(var i = 0; i < this.ds_rentReqstManageList.rowcount; i++) {
			var chk   = this.ds_rentReqstManageList.getColumn(i, "CHK");
			var sttus = this.ds_rentReqstManageList.getColumn(i, "SETLE_STTUS");
			if(chk == "1") {
				this.ds_rentReqstManageList.setColumn(i, "SETLE_STTUS"    , "003");	// 심사승인
				this.ds_rentReqstManageList.setColumn(i, "JDGMN_COMPT_DE" , this.dateUtils.format(this.gfn_today(),"yyyymmdd"));		// 심사승인...
				this.ds_rentReqstManageList.setColumn(i, "SETLE_TMLMT_DE" ,  this.fn_setSetleTmlmtDe(this.ds_rentReqstManageList, i));	// 결제기한일자
				this.ds_rentReqstManageList.setColumn(i, "SMS_CHK"        , "1");	// SMS발송여부
				this.ds_rentReqstManageList.setColumn(i, "CHK"            , 0);		// 체크해제
			}
		}
 	}
}



// 사용이력에 대한 로그 추가
this.fn_setLogData = function(msg)
{
	this.ds_log.clearData();
	var nRow = this.ds_log.addRow();
	this.ds_log.setColumn(nRow, "MENU_ID",    '2302010000');	// 메뉴ID 고정
	this.ds_log.setColumn(nRow, "OPERT_DTLS", msg);
	
	var sSvcID       = "addLogData"
	var sController  = "hsco/cmm/log/savePageUseLog.do";
	var sInDatasets  = "input1=ds_log";
	var sOutDatasets = "";
	
	Ex.core.tran(this, sSvcID, sController, sInDatasets, sOutDatasets, "", "", true, false);	// 동기방식 전송
}

]]></Script>
  </Form>
</FDL>
