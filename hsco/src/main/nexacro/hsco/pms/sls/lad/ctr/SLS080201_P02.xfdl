<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\..\..\default_typedef.xml"/>
  <Form id="SLS080201_P2" classname="SLS080201" left="0" top="0" width="832" height="498" titletext="납부정보" oninit="SLS080201_P2_oninit" onload="SLS080201_P2_onload">
    <Layouts>
      <Layout>
        <Static id="sta_popTitle" taborder="0" cssclass="sta_WF_PopupTitle" left="4" top="2" width="820" height="34" text="납부등록"/>
        <Static id="Static06" taborder="1" text="15" visible="false" left="4" top="36" width="820" height="15" style="background:#dc143c3c;align:center middle;"/>
        <Static id="sta_title" taborder="2" text="납부등록" cssclass="sta_WF_Title01" left="12" top="53" width="205" height="21"/>
        <Static id="Static12" taborder="3" text="5" visible="false" left="4" top="76" width="820" height="5" style="background:#dc143c3c;align:center middle;"/>
        <Button id="btn_close" taborder="4" text="닫기" onclick="btn_close_onclick" cssclass="btn_WF_CRUD" left="774" top="51" width="50" height="25" userdata="fn_search"/>
        <Div id="div_search" taborder="5" text="Div00" left="4" top="81" width="820" height="33" style="background:#f9fbffff;" cssclass="div_WFSA_Box">
          <Layouts>
            <Layout>
              <Static id="sta_NM" taborder="29" text="토지코드" cssclass="sta_WFSA_Label" left="17" top="5" width="64" height="22"/>
              <Static id="Static17" taborder="31" text="B.L.T" cssclass="sta_WFSA_Label" left="330" top="5" width="64" height="21"/>
              <Edit id="edt_blck" taborder="32" readonly="true" onkeydown="div_search_edt_nm_onkeydown" cssclass="edt_WF_Readonly" left="394" top="5" width="52" height="22"/>
              <Edit id="edt_lot" taborder="33" readonly="true" onkeydown="div_search_edt_nm_onkeydown" cssclass="edt_WF_Readonly" left="448" top="5" width="52" height="22"/>
              <Edit id="edt_lotTy" taborder="34" readonly="true" onkeydown="div_search_edt_nm_onkeydown" cssclass="edt_WF_Readonly" left="502" top="5" width="52" height="22"/>
              <Combo id="cmb_ladCode" taborder="35" innerdataset="@ds_landCode" codecolumn="LAD_CODE" datacolumn="ALL_LAD_NM" onitemchanged="div_search_cmb_ladCodeSh_onitemchanged" left="83" top="5" width="196" height="22" cssclass="cmb_WF_Readonly" readonly="true"/>
            </Layout>
          </Layouts>
        </Div>
        <Button id="btn_xClose" taborder="6" onclick="btn_close_onclick" cssclass="btn_WF_PopupClose" left="798" top="9" width="20" height="20"/>
        <Button id="btn_confirm" taborder="7" text="확인" cssclass="btn_WF_CRUD" left="718" top="51" width="50" height="25" userdata="fn_search" onclick="btn_confirm_onclick"/>
        <Button id="btn_payRate" taborder="8" text="납부비율" cssclass="btn_WF_CRUD" left="634" top="51" width="78" height="25" userdata="fn_search" onclick="btn_payRate_onclick"/>
        <Button id="btn_init" taborder="9" text="초기화" cssclass="btn_WF_CRUD" left="564" top="51" width="64" height="25" onclick="btn_init_onclick"/>
        <Grid id="grd_payCodeList" taborder="10" binddataset="ds_ladPayCodeList" useinputpanel="false" left="4" top="140" width="189" height="350" oncelldblclick="grd_payCodeList_oncelldblclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="136"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="순번"/>
                <Cell col="1" text="납부구분"/>
              </Band>
              <Band id="body">
                <Cell expr="expr:currow + 1"/>
                <Cell col="1" style="align:left;" text="bind:ALL_CODE_NM"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static05" taborder="11" text="10" visible="false" left="193" top="140" width="10" style="background:#1b3cd23c;align:center middle;" height="350"/>
        <Static id="Static07" taborder="12" text="10" visible="false" left="4" top="114" width="820" height="10" style="background:#dc143c3c;align:center middle;"/>
        <Static id="Static08" taborder="13" text="5" visible="false" left="4" top="135" width="820" height="5" style="background:#dc143c3c;align:center middle;"/>
        <Static id="Static31" taborder="14" text="납부구분" cssclass="sta_WF_Title02" left="12" top="121" width="130" height="19"/>
        <Tab id="Tab00" taborder="15" left="203" top="140" width="618" height="350" tabindex="0" scrollbars="autoboth" style="showextrabutton:false;" onchanged="Tab00_onchanged">
          <Tabpages>
            <Tabpage id="tabpage1" text="납부">
              <Layouts>
                <Layout>
                  <Grid id="grd_ladPayStdrList" taborder="10" binddataset="ds_ladPayStdrList" autoenter="select" useinputpanel="false" left="5" top="33" right="1" bottom="1">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="30"/>
                          <Column size="45"/>
                          <Column size="156"/>
                          <Column size="62"/>
                          <Column size="104"/>
                          <Column size="100"/>
                          <Column size="100"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="checkbox" edittype="checkbox"/>
                          <Cell col="1" text="순번"/>
                          <Cell col="2" text="납부코드"/>
                          <Cell col="3" text="차수"/>
                          <Cell col="4" text="납부기한"/>
                          <Cell col="5" text="납부비율"/>
                          <Cell col="6" text="납부금액"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="checkbox" edittype="checkbox" style="backgroundimage: ;" text="bind:CHK"/>
                          <Cell col="1" displaytype="text" style="align: ;" expr="expr:currow + 1"/>
                          <Cell col="2" displaytype="combo" edittype="combo" text="bind:PAY_CODE" combodataset="ds_payCode" combocodecol="CODE" combodatacol="ALL_CODE_NM" combodisplay="display"/>
                          <Cell col="3" displaytype="number" edittype="masknumber" style="align:right;" text="bind:PAY_ODR" editdisplay="display"/>
                          <Cell col="4" displaytype="date" edittype="date" text="bind:PAY_TMLMT" calendardisplay="display" calendardisplaynulltype="none"/>
                          <Cell col="5" displaytype="number" edittype="masknumber" style="align:right;" text="bind:PAY_RATE" mask="##0.0#" editdisplay="display"/>
                          <Cell col="6" displaytype="number" edittype="masknumber" style="align:right;" text="bind:PAYAMT" mask="###,###,###,###,##0" editdisplay="display"/>
                        </Band>
                        <Band id="summary">
                          <Cell/>
                          <Cell col="1"/>
                          <Cell col="2"/>
                          <Cell col="3"/>
                          <Cell col="4" text="합계"/>
                          <Cell col="5" displaytype="number" style="align:right middle;" expr="expr:dataset.getSum('PAY_RATE')"/>
                          <Cell col="6" displaytype="number" style="align:right middle;" expr="expr:dataset.getSum('PAYAMT')"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static08" taborder="11" text="10" visible="false" left="0" top="0" right="-273" height="10" style="background:#dc143c3c;align:center middle;"/>
                  <Static id="Static20" taborder="12" text="5" visible="false" left="0" top="29" right="-273" bottom="286" style="background:#dc143c3c;align:center middle;"/>
                  <Button id="btn_calc" taborder="16" text="계산" onclick="btn_calc_onclick" cssclass="btn_WF_Process" left="162" top="10" width="36" height="19"/>
                  <Static id="Static17" taborder="17" text="납부금액" cssclass="sta_WFSA_Label" left="6" top="10" width="64" height="19"/>
                  <MaskEdit id="mse_bgnnAmount" taborder="18" mask="###,###,###,###,##0" left="70" top="10" width="90" height="19"/>
                  <Button id="btn_rateAdd" taborder="19" text="행추가" onclick="fn_btnOnClickHandler" cssclass="btn_WF_Gridadd" left="490" top="10" width="61" height="19"/>
                  <Button id="btn_rateDelete" taborder="20" text="행삭제" onclick="fn_btnOnClickHandler" cssclass="btn_WF_Griddel" left="555" top="10" width="61" height="19"/>
                  <Calendar id="cal_rentDe01" taborder="21" dateformat="yyyy-MM-dd" top="10" height="19" width="100" left="272" visible="false"/>
                  <Static id="Static25" taborder="22" text="~" top="11" height="19" width="8" right="236" visible="false"/>
                  <Calendar id="cal_rentDe02" taborder="23" dateformat="yyyy-MM-dd" top="10" height="19" width="100" left="386" visible="false"/>
                  <Static id="Static00" taborder="24" text="임대기간" cssclass="sta_WFSA_Label" left="33.01%" top="10" right="56.63%" height="19" visible="false"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage2" text="할부">
              <Layouts>
                <Layout>
                  <Static id="Static08" taborder="4" text="10" visible="false" left="5" top="0" right="1" height="10" style="background:#dc143c3c;align:center middle;"/>
                  <Static id="Static20" taborder="5" text="5" visible="false" left="5" top="29" right="1" bottom="286" style="background:#dc143c3c;align:center middle;"/>
                  <Grid id="grd_ladInstlmtStdrList" taborder="6" binddataset="ds_ladInstlmtStdrList" autoenter="select" useinputpanel="false" left="5" top="34" right="1" bottom="1">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="45"/>
                          <Column size="100"/>
                          <Column size="44"/>
                          <Column size="112"/>
                          <Column size="67"/>
                          <Column size="127"/>
                          <Column size="107"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="순번"/>
                          <Cell col="1" text="납부코드"/>
                          <Cell col="2" text="차수"/>
                          <Cell col="3" text="납부기한"/>
                          <Cell col="4" text="납부비율"/>
                          <Cell col="5" text="공급가액"/>
                          <Cell col="6" text="할부이자"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="normal" style="align: ;" expr="expr:currow + 1"/>
                          <Cell col="1" displaytype="combo" edittype="combo" text="bind:PAY_CODE" combodataset="ds_payCode" combocodecol="CODE" combodatacol="ALL_CODE_NM" combodisplay="display"/>
                          <Cell col="2" displaytype="number" edittype="masknumber" text="bind:PAY_ODR" editdisplay="display"/>
                          <Cell col="3" displaytype="date" edittype="date" text="bind:PAY_TMLMT" calendardisplay="display" calendardisplaynulltype="none"/>
                          <Cell col="4" displaytype="number" edittype="masknumber" style="align:right;" text="bind:PAY_RATE" mask="##0.0#" editdisplay="display"/>
                          <Cell col="5" displaytype="number" edittype="masknumber" style="align:right;" text="bind:PAY_SUPLY_AMOUNT" mask="###,###,###,###,###,##0" editdisplay="display"/>
                          <Cell col="6" displaytype="number" edittype="masknumber" style="align:right;" text="bind:INSTLMT_INTR" mask="###,###,###,###,##0" editdisplay="display"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cond00" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CNTRCTR_NO" type="STRING" size="256"/>
          <Column id="LAD_CODE" type="STRING" size="256"/>
          <Column id="BLCK" type="STRING" size="256"/>
          <Column id="LOT" type="STRING" size="256"/>
          <Column id="LOT_TY" type="STRING" size="256"/>
          <Column id="PRPOS_SE" type="STRING" size="256"/>
          <Column id="SUPLY_SE" type="STRING" size="256"/>
          <Column id="TAB_SE" type="STRING" size="256"/>
          <Column id="GRP_CODE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_validation" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="compId" type="STRING" size="256"/>
          <Column id="colId" type="STRING" size="256"/>
          <Column id="PK" type="STRING" size="256"/>
          <Column id="notNull" type="STRING" size="256"/>
          <Column id="type" type="STRING" size="256"/>
          <Column id="nlength" type="STRING" size="256"/>
          <Column id="from" type="STRING" size="256"/>
          <Column id="to" type="STRING" size="256"/>
          <Column id="lengthChkGb" type="STRING" size="256"/>
          <Column id="msgId" type="STRING" size="256"/>
          <Column id="expr" type="STRING" size="256"/>
          <Column id="func" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="compId">ds_ladPayStdrList</Col>
            <Col id="colId">PAY_CODE</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">납부코드</Col>
          </Row>
          <Row>
            <Col id="compId">ds_ladPayStdrList</Col>
            <Col id="colId">PAY_TMLMT</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">납부기한일</Col>
          </Row>
          <Row>
            <Col id="compId">ds_ladPayStdrList</Col>
            <Col id="colId">PAY_RATE</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">납부비율</Col>
          </Row>
          <Row>
            <Col id="compId">ds_ladPayStdrList</Col>
            <Col id="colId">PAYAMT</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">납부금액</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_ladPayCodeList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="GRP_CODE_SN" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="ALL_CODE_NM" type="STRING" size="256"/>
          <Column id="GRP_CODE" type="STRING" size="256"/>
          <Column id="OLD_GRP_CODE" type="STRING" size="256"/>
          <Column id="CODE_CN" type="STRING" size="256"/>
          <Column id="CODE_ORDR" type="STRING" size="256"/>
          <Column id="CHRCTR_PREPAR_VALUE_0" type="STRING" size="256"/>
          <Column id="CHRCTR_PREPAR_VALUE_1" type="STRING" size="256"/>
          <Column id="CHRCTR_PREPAR_VALUE_2" type="STRING" size="256"/>
          <Column id="CHRCTR_PREPAR_VALUE_3" type="STRING" size="256"/>
          <Column id="CHRCTR_PREPAR_VALUE_4" type="STRING" size="256"/>
          <Column id="INTGR_PREPAR_VALUE" type="STRING" size="256"/>
          <Column id="MSTK_PREPAR_VALUE" type="STRING" size="256"/>
          <Column id="CODE_ETC_1" type="STRING" size="256"/>
          <Column id="CODE_ETC_2" type="STRING" size="256"/>
          <Column id="CODE_ETC_3" type="STRING" size="256"/>
          <Column id="USE_AT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond01" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="GRP_CODE" type="STRING" size="256"/>
          <Column id="CHRCTR_PREPAR_VALUE_1" type="STRING" size="256"/>
          <Column id="USE_AT" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_payCode" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="GRP_CODE" type="STRING" size="256"/>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="ALL_CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_landCode" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="LAD_CODE" type="STRING" size="256"/>
          <Column id="LAD_NM" type="STRING" size="256"/>
          <Column id="ALL_LAD_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_ladPayStdrList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_ladPayStdrList_oncolumnchanged">
        <ColumnInfo>
          <Column id="CNTRCTR_NO" type="STRING" size="256"/>
          <Column id="RQEST_YM" type="STRING" size="256"/>
          <Column id="PAY_CODE" type="STRING" size="256"/>
          <Column id="INSTLMT_SE" type="STRING" size="256"/>
          <Column id="PAY_SE" type="STRING" size="256"/>
          <Column id="PAY_ODR" type="STRING" size="256"/>
          <Column id="PAY_TMLMT" type="STRING" size="256"/>
          <Column id="PAY_RATE" type="FLOAT" size="256"/>
          <Column id="PAYAMT" type="BIGDECIMAL" size="256"/>
          <Column id="PAY_SUPLY_AMOUNT" type="STRING" size="256"/>
          <Column id="INSTLMT_INTR" type="STRING" size="256"/>
          <Column id="LTTOT_RENT_SE" type="STRING" size="256"/>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="RENT_BGNDE" type="STRING" size="256"/>
          <Column id="RENT_ENDDE" type="STRING" size="256"/>
          <Column id="PAY_VAT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ladPayStdrListTmp" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_ladPayStdrList_oncolumnchanged">
        <ColumnInfo>
          <Column id="CNTRCTR_NO" type="STRING" size="256"/>
          <Column id="PAY_CODE" type="STRING" size="256"/>
          <Column id="PAY_TMLMT" type="STRING" size="256"/>
          <Column id="PAY_RATE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_LadDetailInfoForBgnnAmount" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="BGNN_AMOUNT" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_ladInstlmtStdrList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CNTRCTR_NO" type="STRING" size="256"/>
          <Column id="RQEST_YM" type="STRING" size="256"/>
          <Column id="PAY_CODE" type="STRING" size="256"/>
          <Column id="INSTLMT_SE" type="STRING" size="256"/>
          <Column id="PAY_SE" type="STRING" size="256"/>
          <Column id="PAY_ODR" type="STRING" size="256"/>
          <Column id="PAY_TMLMT" type="STRING" size="256"/>
          <Column id="PAY_RATE" type="FLOAT" size="256"/>
          <Column id="PAY_SUPLY_AMOUNT" type="STRING" size="256"/>
          <Column id="INSTLMT_INTR" type="STRING" size="256"/>
          <Column id="LTTOT_RENT_SE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item1" compid="div_search.edt_blck" propid="value" datasetid="ds_cond00" columnid="BLCK"/>
      <BindItem id="item2" compid="div_search.edt_lot" propid="value" datasetid="ds_cond00" columnid="LOT"/>
      <BindItem id="item3" compid="div_search.edt_lotTy" propid="value" datasetid="ds_cond00" columnid="LOT_TY"/>
      <BindItem id="item4" compid="div_search.cmb_ladCode" propid="value" datasetid="ds_cond00" columnid="LAD_CODE"/>
      <BindItem id="item30" compid="Tab00.tabpage1.mse_bgnnAmount" propid="value" datasetid="ds_LadDetailInfoForBgnnAmount" columnid="BGNN_AMOUNT"/>
    </Bind>
    <Script type="xscript5.0"><![CDATA[/***********************************************************************
 * 화면ID   : SLS080201_P02
 * 화면명   : 토지 납부기준 검색 및 등록
 * 화면설명 : 토지 납부기준 검색 및 등록
 * 작성일   : 2015.10.11
 * 작성자   : 최승락
 * 수정이력 : 
 ***********************************************************************
 *     수정일     수정자   내용
 ***********************************************************************
 */
 
/***********************************************************************
 * Script Include 
 ***********************************************************************/
include "pms_lib::pmsUtilInclude.xjs";



/***********************************************************************
 * 부모 Form에서 파라미터로 넘겨야 할 값
 * callback : function()
 ***********************************************************************/
this.callback = null; 	//부모폼에서 정의한 콜백 함수


/***********************************************************************
 * onInit / onLoad 영역
 ***********************************************************************/
this.SLS080201_P2_oninit = function(obj:Form, e:nexacro.InitEventInfo)
{
	this.fn_init();//공통 폼 초기화
	this.fn_init_form();//폼 초기화
	this.fn_init_dataset();//Dataset 초기화
}

this.SLS080201_P2_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{

	// 부모전달 파라미터
	this.callback = this.parent.callback;
			
	this.ds_cond00.setColumn(0, "CNTRCTR_NO", this.parent.cntrctrNo);
	this.ds_cond00.setColumn(0, "LAD_CODE", this.parent.ladCode);
	this.ds_cond00.setColumn(0, "BLCK", this.parent.blck);
	this.ds_cond00.setColumn(0, "LOT", this.parent.lot);
	this.ds_cond00.setColumn(0, "LOT_TY", this.parent.lotTy);
	this.ds_cond00.setColumn(0, "PRPOS_SE", this.parent.prposSe);
	this.ds_cond00.setColumn(0, "SUPLY_SE", this.parent.suplySe);
	this.ds_cond00.setColumn(0, "TAB_SE", this.parent.tabSe);
	
	//부모창의 탭별 납부코드 조회 조건 
	if (this.parent.tabSe == 0) {
		// 분양약정
		this.ds_cond01.setColumn(0, "GRP_CODE", "LAD0A1");
		this.ds_cond01.setColumn(0, "CHRCTR_PREPAR_VALUE_1", "S,R");
		this.ds_cond01.setColumn(0, "USE_AT", "1");		
		
		// 납부코드 조회
		this.fn_transaction("selectLadPayCodeList");
	
		// 당초금액 조회
		this.fn_transaction("selectLadDetailInfoForBgnnAmount");
		
	} else if (this.parent.tabSe == 1) {
		// 임대약정	
		this.ds_cond01.setColumn(0, "GRP_CODE", "LAD0A1");
		this.ds_cond01.setColumn(0, "CHRCTR_PREPAR_VALUE_1", "R");
		this.ds_cond01.setColumn(0, "USE_AT", "1");
		
		this.Tab00.tabpage1.Static00.set_visible(true);
		this.Tab00.tabpage1.Static25.set_visible(true);
		this.Tab00.tabpage1.cal_rentDe01.set_visible(true);
		this.Tab00.tabpage1.cal_rentDe02.set_visible(true);
		this.Tab00.tabpage1.cal_rentDe01.set_value(this.dateUtils.today());
		this.Tab00.tabpage1.cal_rentDe02.set_value(this.dateUtils.today());
		
		// 납부코드 조회
		this.fn_transaction("selectLadPayCodeList");
	}

	
	// 콤보로드
	this.fn_loadCombo();
}

/*
 * 함수명  	    : fn_init_form
 * 설명 		: Form을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initForm();
 */
this.fn_init_form = function(){
	this.gfn_initForm(this);	// 시스템 공통으로 Form을 Initialize 한다.
}

/*
 * 함수명  	    : fn_init_dataset
 * 설명 		: Dataset을 초기화한다.
 *                주로, 조건 Dataset들(ds_cond, ds_cond_00, ds_cond_01, ...) 을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initDataset();
 */
this.fn_init_dataset = function()
{
	this.gfn_initCondDs(this, this.div_search);		
}


/*
 * 함수명  	    : fn_loadCombo
 * 설명 		: 화면의 Combo 에 데이터를 불러온다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_loadCombo();
 */
this.fn_loadCombo = function()
{
	// 공통코드 목록 조회
 	var comCodeParam = [
 		  {OUT_PUT:"ds_payCode", GRP_CODE:"LAD0A1", USE_AT:"1"} // 납부코드
 		
 	];
 	this.pmsUtil.getCommonCode("selectCommonCode", comCodeParam);
 	
	// 토지코드 목록 조회
	var paramMap = {};	
	paramMap["USE_AT"] = "";
	this.pmsUtil.getLadCodeList(paramMap, "ds_landCode");
}


/**********************************************************************
 * CALL TRANSACTION 영역
 **********************************************************************/
/*
 * 함수명  	    : fn_transaction
 * 설명 		: Transaction 요청 처리 함수
 * params  		: strSvcId : 서비스요청 ID
 * return Type 	: None
 * 사용법		: this.fn_transaction("SELECT");
 */
this.fn_transaction = function(strSvcId)
{
	switch (strSvcId) {
		// 납부코드 조회
		case "selectLadPayCodeList" : 
			var sController   	= "hsco/pms/sls/lad/ctr/SLS080201/selectLadPayCodeList.do";
			var sInDatasets   	= "input1=ds_cond01";
			var sOutDatasets  	= "ds_ladPayCodeList=output1";
			break;
			
		// 당초금액 조회
		case "selectLadDetailInfoForBgnnAmount" : 
			var sController   	= "hsco/pms/sls/lad/ctr/SLS080201/selectLadDetailInfoForBgnnAmount.do";
			var sInDatasets   	= "input1=ds_cond00";
			var sOutDatasets  	= "ds_LadDetailInfoForBgnnAmount=output1";
			break;
			
		// 납부비율 조회
		case "selectLadPayStdrList" : 
			var sController   	= "hsco/pms/sls/lad/ctr/SLS080201/selectLadPayStdrList.do";
			var sInDatasets   	= "input1=ds_cond00";
			var sOutDatasets  	= "ds_ladPayStdrListTmp=output1";
			break;
			
		default :
			break;
	}
	
	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets);
}


/**********************************************************************
 * Transaction Callback 영역
 **********************************************************************/
/*
 * 함수명  	    : fn_callBack
 * 설명 		: Transaction Callback 처리
 * params  		: strSvcId    : 서비스요청 ID
 *                nErrorCode  : 오류 메시지 코드 ([예] 0 : Success, 그밖의 경우, error)
 *                strErrorMsg : 오류 메시지([예]  success.insert|정상적으로 등록되었습니다.)
 * return Type 	: None
 * 사용법		:
 */
this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg)
{

	this.fn_callback_message(strSvcId, nErrorCode, strErrorMsg);
	
	var bSuccess = nErrorCode == 0 ? true : false;
	if (bSuccess){

		var comboOption = null;
		var targetCombo = null;
		switch(strSvcId){
			// 납부코드 조회
			case "selectLadPayCodeList" :
				break;

			// 당초금액 조회
			case "selectLadDetailInfoForBgnnAmount" :
				break;

			// 납부비율 조회
			case "selectLadPayStdrList" :
				if (this.ds_ladPayStdrListTmp.rowcount > 0) {
					this.fn_selectLadPayStdrList_callback();
				}else{
				    alert("등록된 납부비율이 없습니다.");
				}
				break;

			default :
				break;
		}
	}
}


/***********************************************************************
 * 기타 이벤트 처리 함수
 ***********************************************************************/ 

// 탭처리( 초기화)
this.Tab00_onchanged = function(obj:Tab, e:nexacro.TabIndexChangeEventInfo)
{
	if(this.Tab00.tabindex == 0 ) {
		var ds = this.ds_ladPayStdrList;
		ds.reset();
		ds.applyChange();
	} else if (this.Tab00.tabindex == 1) {
		var ds = this.ds_ladInstlmtStdrList;
		ds.reset();
		ds.applyChange();	
	}
}
 
// 납부코드 추가
this.grd_payCodeList_oncelldblclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	var nRow = 0;
	var payCode = null;
	var cntrctrNo = null;
	var rqestYm = this.dateUtils.format(this.dateUtils.today(),'yyyymm');
	if (this.Tab00.tabindex == 0) {
	
		// 납부정보 생성
		nRow = this.ds_ladPayStdrList.addRow();		
		cntrctrNo = this.ds_cond00.getColumn(0, "CNTRCTR_NO");
		payCode = this.ds_ladPayCodeList.getColumn(this.ds_ladPayCodeList.rowposition, "CODE");
		
		this.ds_ladPayStdrList.setColumn(nRow, "CNTRCTR_NO", cntrctrNo);			//계약자번호
		this.ds_ladPayStdrList.setColumn(nRow, "RQEST_YM", rqestYm);				//청구년월
		this.ds_ladPayStdrList.setColumn(nRow, "PAY_CODE", payCode);				//납부코드
		this.ds_ladPayStdrList.setColumn(nRow, "PAY_ODR", "0");		  	   		    //납부차수		
		this.ds_ladPayStdrList.setColumn(nRow, "PAY_SE", "0");            			//토지납부구분 (0:정상, 1:선납, 2:분납, 3:할부)
		this.ds_ladPayStdrList.setColumn(nRow, "INSTLMT_SE", "1"); 	      			//할부구분(1.납부,2.할부)
		this.ds_ladPayStdrList.setColumn(nRow, "PAY_TMLMT", this.gfn_today());		//납부기한일
		this.ds_ladPayStdrList.setColumn(nRow, "PAY_RATE", 0);		  				//납부차수		
		this.ds_ladPayStdrList.setColumn(nRow, "PAYAMT", 0);		  				//납부금액
		this.ds_ladPayStdrList.setColumn(nRow, "PAY_SUPLY_AMOUNT",0);				//공급금액
		this.ds_ladPayStdrList.setColumn(nRow, "INSTLMT_INTR", 0);					//할부이자
		if (payCode.substr(0, 1) == "S") {
			this.ds_ladPayStdrList.setColumn(nRow, "LTTOT_RENT_SE", "S"); 			//분양임화성분 (S:분양, R:임대분양, L:임대료)
		} else if (payCode.substr(0, 1) == "R") {
			this.ds_ladPayStdrList.setColumn(nRow, "LTTOT_RENT_SE", "R"); 			//분양임화성분 (S:분양, R:임대분양, L:임대료)
		}

	} else if (this.Tab00.tabindex == 1) {
		// 할부정보 생성
		nRow = this.ds_ladInstlmtStdrList.addRow();
		cntrctrNo = this.ds_cond00.getColumn(0, "CNTRCTR_NO");
		payCode = this.ds_ladPayCodeList.getColumn(this.ds_ladPayCodeList.rowposition, "CODE");
		
		this.ds_ladInstlmtStdrList.setColumn(nRow, "CNTRCTR_NO", cntrctrNo);		//계약자번호
		this.ds_ladInstlmtStdrList.setColumn(nRow, "RQEST_YM", rqestYm);			//청구년월
		this.ds_ladInstlmtStdrList.setColumn(nRow, "PAY_CODE", payCode);			//납부코드
		this.ds_ladInstlmtStdrList.setColumn(nRow, "PAY_ODR", "0");          		//납부차수
		this.ds_ladInstlmtStdrList.setColumn(nRow, "PAY_SE", "3");            		//토지납부구분 (0:정상, 1:선납, 2:분납, 3:할부)
		this.ds_ladInstlmtStdrList.setColumn(nRow, "INSTLMT_SE", "2"); 	      		//할부구분(1.납부,2.할부)		
		this.ds_ladInstlmtStdrList.setColumn(nRow, "PAY_TMLMT", this.gfn_today());	//납부기한일
		this.ds_ladInstlmtStdrList.setColumn(nRow, "PAY_RATE", 0);					//납부비율
		this.ds_ladInstlmtStdrList.setColumn(nRow, "PAYAMT", 0);					//납부금액
		this.ds_ladInstlmtStdrList.setColumn(nRow, "PAY_SUPLY_AMOUNT", 0);			//공급금액
		this.ds_ladInstlmtStdrList.setColumn(nRow, "INSTLMT_INTR", 0);		  		//할부이자
		if (payCode.substr(0, 1) == "S") {
			this.ds_ladInstlmtStdrList.setColumn(nRow, "LTTOT_RENT_SE", "S");		//분양임화성분(S:분양, R:임대분양, L:임대료)
		} else if (payCode.substr(0, 1) == "R") {
			this.ds_ladInstlmtStdrList.setColumn(nRow, "LTTOT_RENT_SE", "R"); 		//분양임화성분(S:분양, R:임대분양, L:임대료)	
		}
	}
	
}

// 초기화
this.btn_init_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if (this.ds_ladPayStdrList.rowcount > 0) {
		if(application.confirm("납부정보가  초기화됩니다")){
			var ds = this.ds_ladPayStdrList;
			ds.reset();
			ds.applyChange();
		}	
	}
	
}


// 납부비율 적용
this.btn_payRate_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	//분양약정 
	if (this.ds_cond00.getColumn(0, "TAB_SE") == 0) {
		// 납부 
		if (this.Tab00.tabindex == 0) {
			this.btn_payRate.set_enable(true);
			// Clear Datasets
			this.pmsUtil.clearDataSet([this.ds_ladPayStdrList]);
				
			this.ds_cond00.setColumn(0, "GRP_CODE", "LAD0A1");
		
			// 납부비율 조회
			this.fn_transaction("selectLadPayStdrList");
		}
		else{
			this.btn_payRate.set_enable(false);
		}
	}
}


// 확인
this.btn_confirm_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if (this.fn_confirm()) {
		this.close();
	}
	
}

//  
this.fn_confirm = function()
{

	// 콜백 호출
	var opener = this.opener; //Runtime 작동시 부모 폼
	
	var instlmtAt = null; //납부, 할부 여부
	var bResult	= false;  //콜백결과
	if (this.Tab00.tabindex ==  0) {
	
		instlmtAt = "1";
		for(var i = 0 ; i < this.ds_ladPayStdrList.rowcount ; i++){
			var payamt = this.ds_ladPayStdrList.getColumn( i , "PAYAMT");
			this.ds_ladPayStdrList.setColumn( i  , "RENT_BGNDE" , this.Tab00.tabpage1.cal_rentDe01.value);
			this.ds_ladPayStdrList.setColumn( i  , "RENT_ENDDE" , this.Tab00.tabpage1.cal_rentDe02.value);
			this.ds_ladPayStdrList.setColumn( i  , "PAY_SUPLY_AMOUNT" , Math.floor((payamt / 1.1) / 10) * 10);			
			this.ds_ladPayStdrList.setColumn( i  , "PAY_VAT" , payamt - Math.floor((payamt / 1.1) / 10) * 10);
		}
		bResult = opener[this.callback](this.ds_ladPayStdrList, instlmtAt);		
	} else if (this.Tab00.tabindex == 1) {
	
		instlmtAt = "2";
		bResult = opener[this.callback](this.ds_ladInstlmtStdrList, instlmtAt);
	}
	
	return bResult;
}


// 닫기
this.btn_close_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{

	this.close();
}


// 납부금액 계산
this.ds_ladPayStdrList_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{	
	if (this.Tab00.tabindex == 0) {
		var bgnnAmount = this.ds_LadDetailInfoForBgnnAmount.getColumn(this.ds_LadDetailInfoForBgnnAmount.rowposition, "BGNN_AMOUNT");
		var payAmt = 0;
			
		if (e.columnid == "PAY_RATE" &&  e.newvalue > 0) {	   
			payAmt =  (bgnnAmount * (e.newvalue * 0.01)) ;	    
			this.ds_ladPayStdrList.setColumn(e.row, "PAYAMT", payAmt);
		}
	}
}


// 납부비율 조회 콜백
this.fn_selectLadPayStdrList_callback = function()
{
	// INSERT상태로 변경하기 
	var nRow = 0;
	
	if (this.Tab00.tabindex == 0) {	
		for (var i=0; i<this.ds_ladPayStdrListTmp.rowcount; i++) {
			nRow = this.ds_ladPayStdrList.addRow();
			
			var cntrctrNo = this.ds_ladPayStdrListTmp.getColumn(i, "CNTRCTR_NO");
			var payCode = this.ds_ladPayStdrListTmp.getColumn(i, "PAY_CODE");
			var payTmlmt = this.ds_ladPayStdrListTmp.getColumn(i, "PAY_TMLMT");
			var payRate = this.ds_ladPayStdrListTmp.getColumn(i, "PAY_RATE");
			var rqestYm = this.dateUtils.format(this.dateUtils.today(),'yyyymm');
			
			this.ds_ladPayStdrList.setColumn(nRow, "CHK", "0");
			this.ds_ladPayStdrList.setColumn(nRow, "CNTRCTR_NO", cntrctrNo);
			this.ds_ladPayStdrList.setColumn(nRow, "RQEST_YM", rqestYm);	//청구년월
			this.ds_ladPayStdrList.setColumn(nRow, "PAY_CODE", payCode);
			this.ds_ladPayStdrList.setColumn(nRow, "PAY_ODR", 0);			//납부차수
			this.ds_ladPayStdrList.setColumn(nRow, "PAY_SE", "0");			//토지납부구분 (0:정상, 1:선납, 2:분납, 3:할부)
			this.ds_ladPayStdrList.setColumn(nRow, "INSTLMT_SE", "1");		//할부구분(1.납부,2.할부)
			this.ds_ladPayStdrList.setColumn(nRow, "PAY_TMLMT", payTmlmt);	//납부기한일
			this.ds_ladPayStdrList.setColumn(nRow, "PAY_RATE", payRate);	//납부비율
			this.ds_ladPayStdrList.setColumn(nRow, "PAYAMT", 0);			//납부금액
			this.ds_ladPayStdrList.setColumn(nRow, "PAY_SUPLY_AMOUNT", 0);	//공급가액
			this.ds_ladPayStdrList.setColumn(nRow, "INSTLMT_INTR", 0);		//할부이자			
			this.ds_ladPayStdrList.setColumn(nRow, "LTTOT_RENT_SE", "S");	//분양임화성분 (S:분양, R:임대분양, L:임대료)
		}
	}
	
}


// 계산
this.btn_calc_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var nRatio = 0;  // 납부비율
	var nAmt = 0;    // 납부금액 * 납부비율
	var nSum = 0;    // 합계
	var nS01Idx = 0; // 계약금 index	
	var nGgnnAmount = this.Tab00.tabpage1.mse_bgnnAmount.value;	// 납부금액
	
	if (this.ds_ladPayStdrList.rowcount > 0) {
		if (this.Tab00.tabpage1.mse_bgnnAmount.value > 0) {
			for (var i=0; i < this.ds_ladPayCodeList.rowcount; i++) {
			
				// 계약금 index
				if (this.ds_ladPayStdrList.getColumn(i, "PAY_CODE") == "S0") {
					nS01Idx = i;
				}
			
				nRatio = this.ds_ladPayStdrList.getColumn(i, "PAY_RATE");
								
				// 비율이 0보가 큰경우에만 계산
				if (Number(nRatio) > 0) {
				
					nAmt = (Number(nGgnnAmount) * (Number(nRatio) * 0.01) * 0.1) * 10;
					nSum = nSum + parseInt(nAmt);
					this.ds_ladPayStdrList.setColumn(i, "PAYAMT", parseInt(nAmt));
					
				}
				
			}
			
			// 2009.07.30 박선영씨 요청으로 남는금액은 계약금에 합산함.
			if (nSum < Number(nGgnnAmount)) {
				var curPayamt = Number(this.ds_ladPayStdrList.getColumn(nS01Idx, "PAYAMT"));
				var rstPayamt = Number(nGgnnAmount) - nSum;
				var sumPayamt = curPayamt + rstPayamt;
				
				this.ds_ladPayStdrList.setColumn(nS01Idx, "PAYAMT", sumPayamt);					
			}
			
		} else {
			this.alert("납부금액을 입력하십시오.");
			return;
		}
	} else {
		this.alert("납부비율 정보가 없습니다.");
		return;
	}
}

this.fn_btnOnClickHandler = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var btnName = obj.name;
	this.debug("btnName = "+ btnName);
	switch(btnName){
	
		// 토지납부비율 행추가
		case "btn_rateAdd" :
			this.fn_addGridRow(this.Tab00.tabpage1.grd_ladPayStdrList, "PAY");
			break;
			
		// 토지납부비율 행삭제
		case "btn_rateDelete" :
			this.fn_deleteGridRow(this.Tab00.tabpage1.grd_ladPayStdrList, "PAY");
			break;
				
		default :
				break;
	}
}


/**
 * 함수명  	: fn_addGridRow
 * 설명 		: 그리드 행 추가
 * params  		: oGrid 대상 그리드
 * 				: String 구분("LAD":토지정보,"PAY":납부금액이율,"UNTPC":급지등록)
 * return Type 	: None
 * 사용법		: this.fn_addGridRow(GRID, String);
 */
this.fn_addGridRow = function(oGrid:Grid, type)
{
	// 대상 데이터셋 추출
	var targetDs = oGrid.binddataset ? oGrid.binddataset : oGrid.getInnerDataset();
	var targetDsObj = typeof(targetDs) == "string" ? this[targetDs] : targetDs;
	
	//var newIndex = targetDsObj.addRow();
	
	//this.debug("newIndex = " + newIndex);
	trace("type = " + type);
	
	switch(type)
	{	
		
		case "PAY" :	// 납부금액이율
		
			trace("2222222222222222222222");
			var nRow = this.ds_ladPayStdrList.addRow();
			var cntrctrNo = this.ds_cond00.getColumn(0, "CNTRCTR_NO");			
			var rqestYm = this.dateUtils.format(this.dateUtils.today(),'yyyymm');
			
			this.ds_ladPayStdrList.setColumn(nRow, "CNTRCTR_NO", cntrctrNo);			//계약자번호
			this.ds_ladPayStdrList.setColumn(nRow, "RQEST_YM", rqestYm);				//청구년월
			this.ds_ladPayStdrList.setColumn(nRow, "PAY_ODR", 0);		  	   		    //납부차수		
			this.ds_ladPayStdrList.setColumn(nRow, "PAY_SE", "0");            			//토지납부구분 (0:정상, 1:선납, 2:분납, 3:할부)
			this.ds_ladPayStdrList.setColumn(nRow, "INSTLMT_SE", "1"); 	      			//할부구분(1.납부,2.할부)
			this.ds_ladPayStdrList.setColumn(nRow, "PAY_TMLMT", this.gfn_today());		//납부기한일
			this.ds_ladPayStdrList.setColumn(nRow, "PAY_RATE", 0);		  				//납부차수		
			this.ds_ladPayStdrList.setColumn(nRow, "PAYAMT", 0);		  				//납부금액
			this.ds_ladPayStdrList.setColumn(nRow, "PAY_SUPLY_AMOUNT",0);				//공급금액
			this.ds_ladPayStdrList.setColumn(nRow, "INSTLMT_INTR", 0);					//할부이자			
			break;
	}
}

/**
 * 함수명  	: fn_deleteGridRow
 * 설명 		: 그리드 행 삭제
 * params  		: oGrid 대상 그리드
 * 				: String 구분("LAD":토지정보,"PAY":납부금액이율,"UNTPC":급지등록)
 * return Type 	: None
 * 사용법		: this.fn_deleteGridRow(GRID, String);
 */
this.fn_deleteGridRow = function(oGrid:Grid, type)
{
	// 대상 데이터셋 추출
	var targetDs = oGrid.binddataset ? oGrid.binddataset : oGrid.getInnerDataset();
	var targetDsObj = typeof(targetDs) == "string" ? this[targetDs] : targetDs;
	
	// 삭제 대상 행 목록 추출
	var option = {};
	option["viewRow"] = "expr:CHK == '1'";
	var checkList = this.pmsUtil.datasetToObject(this.ds_ladPayStdrList, option, true);
	var checkListLeng = checkList == null ? 0 : checkList.length;

	// 선택자료 여부 체크
	if(checkListLeng == 0)
	{
		var altMsg = "삭제할 납부금액이율 항목";
		this.alert("comm.항목.선택.요청", altMsg);
		return;
	}
	
	// 선택 데이터 삭제 - 삭제 하시겠습니까? 메시지 출력됨
	this.gfn_delMultiRow(targetDsObj);
}

/*
 * 함수명  	: fn_setNewLandInfo
 * 설명 		: 신규 토지 기타 정보(납부금액이율/급지등록) 설정
 * params  		: Non
 * return Type 	: None
 * 사용법		: this.fn_setNewLandInfo();
 */
this.fn_setNewEtcInfo = function(oDs:Dataset, setIndex)
{
	var setLadCode = this.pmsUtil.getGridSelectedItem(this.grd_landList, "LAD_CODE");
	
	// 토지코드 입력여부 확인
	var isNullLadCode = this.comUtils.isNullEmpty(setLadCode);
	if(isNullLadCode)
	{
		// 생성 ROw 삭제
		oDs.deleteRow(setIndex);
	
		this.alert("comm.입력.요청.를", "토지코드");	// {0} 항목을 입력하십시오.
		
		// 입력 포커스 처리
		var landSelPos = this.ds_landList.rowposition;
		this.pmsUtil.setFocusGridBindComp(this.grd_landList, landSelPos, "LAD_CODE");
	}else{
		// 기초 데이터 설정
		oDs.setColumn(setIndex, "CHK", "0");
		oDs.setColumn(setIndex, "LAD_CODE", setLadCode);
	}
}
]]></Script>
  </Form>
</FDL>
