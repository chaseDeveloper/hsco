<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="frm_CMP030100" classname="CMP030100" left="0" top="0" width="1059" height="735" titletext="보상액사정" onload="frm_CMP030100_onload" style="background:#ffffffff;font:9 Dotum;" oninit="frm_CMP030100_oninit">
    <Layouts>
      <Layout>
        <Div id="div_search" taborder="0" text="Div00" left="0" top="0" height="109" style="background:#f9fbffff;" cssclass="div_WFSA_Box" scrollbars="none" right="28">
          <Layouts>
            <Layout width="1019" height="196">
              <Static id="sta_BSNS_AREA_CODE" taborder="13" text="사업지구" cssclass="sta_WFSA_Label" left="15" top="5" height="21" width="64"/>
              <Static id="sta_ADRES" taborder="15" text="소재지" cssclass="sta_WFSA_Label" left="15" top="31" height="21" width="51"/>
              <Static id="sta_REWARD_ODR" taborder="17" text="보상차수" cssclass="sta_WFSA_Label" left="15" top="56" height="21" width="64"/>
              <Static id="sta_LNM" taborder="19" text="지번" cssclass="sta_WFSA_Label" left="15" top="81" height="21" width="38"/>
              <Edit id="edt_LNM" taborder="3" left="80" top="81" height="22" width="36"/>
              <Edit id="edt_SLNO" taborder="4" left="118" top="81" height="22" width="34"/>
              <Static id="sta_NM" taborder="22" text="소유자" cssclass="sta_WFSA_Label" left="229" top="81" height="21" width="51"/>
              <Edit id="edt_NM" taborder="6" left="280" top="81" height="22" width="63"/>
              <Radio id="rdo_OPTION0" taborder="5" left="229" top="29" height="51" innerdataset="@DS_OPTION0" datacolumn="CODE_NM" codecolumn="CODE" width="84" index="0" onitemchanged="div_search_rdo_OPTION0_onitemchanged" value="%"/>
              <Static id="Static05" taborder="32" text="감평여부" left="229" top="5" height="21" width="64" cssclass="sta_WFSA_Label"/>
              <Static id="Static06" taborder="33" text="물건분류" left="308" top="5" height="21" width="67" cssclass="sta_WFSA_Label"/>
              <CheckBox id="chk_SELECT" taborder="7" text="전체" left="323" top="30" height="18" width="47" onclick="div_search_chk_SELECT_onclick"/>
              <Div id="div_THING_CL" taborder="8" left="372" top="5" style="border:1 solid #a8c2e2ff ;font:9 Dotum;" url="pms_cmp_formLib::CmpMultiCheckBar.xfdl" scrollbars="autoboth" dragscrolltype="vert" bottom="5" width="642"/>
              <Combo id="cmb_BSNS_AREA_CODE" taborder="0" innerdataset="DS_BSNS_AREA_CODE" codecolumn="CODE" datacolumn="FULL_CODE_NM" onitemchanged="div_search_cmb_BSNS_AREA_CODE_onitemchanged" left="80" top="5" width="134" height="22" cssclass="cmb_WF_Essential"/>
              <Combo id="cmb_LOCPLC_CODE" taborder="1" innerdataset="@DS_LOCPLC_CODE" codecolumn="CODE" datacolumn="CODE_NM" onitemchanged="div_search_cmb_LOCPLC_CODE_onitemchanged" left="80" top="31" width="134" height="22"/>
              <Combo id="cmb_REWARD_ODR" taborder="2" innerdataset="@ds_rewardOdr" codecolumn="CODE" datacolumn="CODE_NM" left="80" top="56" width="80" height="22"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="div_WORK" taborder="2" text="Div00" left="0" top="109" style="background:#ffffffff;" right="28" bottom="0">
          <Layouts>
            <Layout>
              <Grid id="grd_DS_TBCMP_THING_WTNNC" taborder="2" useinputpanel="false" left="0" top="35" right="0" height="410" cssclass="grd02_WF_blue" binddataset="DS_TBCMP_THING_WTNNC" selectscrollmode="scroll" onselectchanged="div_WORK_grd_DS_TBCMP_THING_WTNNC_onselectchanged" onheadclick="div_WORK_grd_DS_TBCMP_THING_WTNNC_onheadclick">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="40" band="left"/>
                      <Column size="40" band="left"/>
                      <Column size="110" band="left"/>
                      <Column size="58" band="left"/>
                      <Column size="41" band="left"/>
                      <Column size="98"/>
                      <Column size="150"/>
                      <Column size="70"/>
                      <Column size="70"/>
                      <Column size="180"/>
                      <Column size="71"/>
                      <Column size="40"/>
                      <Column size="65"/>
                      <Column size="38"/>
                      <Column size="121"/>
                      <Column size="110"/>
                      <Column size="120"/>
                      <Column size="110"/>
                      <Column size="120"/>
                      <Column size="110"/>
                      <Column size="120"/>
                      <Column size="100"/>
                      <Column size="130"/>
                      <Column size="100"/>
                    </Columns>
                    <Rows>
                      <Row size="24" band="head"/>
                      <Row size="24" band="head"/>
                      <Row size="24"/>
                      <Row size="24" band="summ"/>
                    </Rows>
                    <Band id="head">
                      <Cell rowspan="2" displaytype="checkbox"/>
                      <Cell col="1" rowspan="2" text="순번"/>
                      <Cell col="2" rowspan="2" text="소재지"/>
                      <Cell col="3" rowspan="2" text="지번"/>
                      <Cell col="4" rowspan="2" text="물건&#13;&#10;번호"/>
                      <Cell col="5" rowspan="2" text="물건분류"/>
                      <Cell col="6" rowspan="2" text="물건&#13;&#10;종류"/>
                      <Cell col="7" colspan="2" text="지목"/>
                      <Cell col="9" rowspan="2" text="구조&#13;&#10;및 규격"/>
                      <Cell col="10" rowspan="2" text="편입&#13;&#10;수량/면적"/>
                      <Cell col="11" rowspan="2" text="단위"/>
                      <Cell col="12" rowspan="2" text="보상형태"/>
                      <Cell col="13" rowspan="2" text="그룹ID"/>
                      <Cell col="14" rowspan="2" text="비고"/>
                      <Cell col="15" colspan="2" celltype="head" text="평가사1"/>
                      <Cell col="17" colspan="2" text="평가사2"/>
                      <Cell col="19" colspan="2" text="평가사3"/>
                      <Cell col="21" rowspan="2" text="결정단가"/>
                      <Cell col="22" rowspan="2" text="결정금액"/>
                      <Cell col="23" rowspan="2" text="차액"/>
                      <Cell row="1" col="7" text="공부"/>
                      <Cell row="1" col="8" text="편입"/>
                      <Cell row="1" col="15" text="단가"/>
                      <Cell row="1" col="16" text="금액"/>
                      <Cell row="1" col="17" text="단가"/>
                      <Cell row="1" col="18" text="금액"/>
                      <Cell row="1" col="19" text="단가"/>
                      <Cell row="1" col="20" text="금액"/>
                    </Band>
                    <Band id="body">
                      <Cell displaytype="expr:(SERVC_ENTRPS_CNT==0)?'none':'checkbox'" edittype="expr:(SERVC_ENTRPS_CNT==0)?'none':'checkbox'" text="bind:CHK"/>
                      <Cell col="1" style="color:EXPR(MARGIN == 0 ? 'black' : 'red');color2:EXPR(MARGIN == 0 ? 'black' : 'red');" expr="expr:currow + 1"/>
                      <Cell col="2" displaytype="normal" edittype="none" style="align:left;color:EXPR(MARGIN == 0 ? 'black' : 'red');color2:EXPR(MARGIN == 0 ? 'black' : 'red');" text="bind:LOCPLC_CODE_NM"/>
                      <Cell col="3" displaytype="normal" style="align:left;color:EXPR(MARGIN == 0 ? 'black' : 'red');color2:EXPR(MARGIN == 0 ? 'black' : 'red');" text="bind:LNM_SLNO"/>
                      <Cell col="4" style="align:right;color:EXPR(MARGIN == 0 ? 'black' : 'red');color2:EXPR(MARGIN == 0 ? 'black' : 'red');" text="bind:THING_SN"/>
                      <Cell col="5" displaytype="combo" style="align:left;color:EXPR(MARGIN == 0 ? 'black' : 'red');color2:EXPR(MARGIN == 0 ? 'black' : 'red');" text="bind:THING_CL" combodataset="DS_THING_CL2" combocodecol="CODE" combodatacol="CODE_NM"/>
                      <Cell col="6" style="align:left;color:EXPR(MARGIN == 0 ? 'black' : 'red');color2:EXPR(MARGIN == 0 ? 'black' : 'red');" text="bind:THING_NM"/>
                      <Cell col="7" displaytype="combo" edittype="none" style="align:left;color:EXPR(MARGIN == 0 ? 'black' : 'red');color2:EXPR(MARGIN == 0 ? 'black' : 'red');" text="bind:LNDCGR_LGSTR" combodataset="DS_TBCMP_LNDCGR_CODE" combocodecol="CODE" combodatacol="CODE_NM"/>
                      <Cell col="8" displaytype="combo" edittype="none" style="align:left;color:EXPR(MARGIN == 0 ? 'black' : 'red');color2:EXPR(MARGIN == 0 ? 'black' : 'red');" text="bind:LNDCGR_INCRPR" combodataset="DS_TBCMP_LNDCGR_CODE" combocodecol="CODE" combodatacol="CODE_NM"/>
                      <Cell col="9" style="align:left;color:EXPR(MARGIN == 0 ? 'black' : 'red');color2:EXPR(MARGIN == 0 ? 'black' : 'red');" text="bind:STRCT_STNDRD"/>
                      <Cell col="10" displaytype="number" style="align:right;color:EXPR(MARGIN == 0 ? 'black' : 'red');color2:EXPR(MARGIN == 0 ? 'black' : 'red');" text="bind:AR_INCRPR" mask="9,999.999"/>
                      <Cell col="11" displaytype="combo" style="align:center;color:EXPR(MARGIN == 0 ? 'black' : 'red');color2:EXPR(MARGIN == 0 ? 'black' : 'red');" text="bind:UNIT" combodataset="DS_UNIT" combocodecol="CODE" combodatacol="CODE_NM"/>
                      <Cell col="12" displaytype="combo" style="align:left;color:EXPR(MARGIN == 0 ? 'black' : 'red');color2:EXPR(MARGIN == 0 ? 'black' : 'red');" text="bind:REWARD_STLE" combodataset="DS_REWARD_STLE" combocodecol="CODE" combodatacol="CODE_NM"/>
                      <Cell col="13" style="align:left;color:EXPR(MARGIN == 0 ? 'black' : 'red');color2:EXPR(MARGIN == 0 ? 'black' : 'red');" text="bind:BNDE_APPLC_GROUP"/>
                      <Cell col="14" style="align:left;color:EXPR(MARGIN == 0 ? 'black' : 'red');color2:EXPR(MARGIN == 0 ? 'black' : 'red');" text="bind:RM_1"/>
                      <Cell col="15" displaytype="number" edittype="expr:SERVC_ENTRPS_CNT == 0 ? 'none': 'masknumber'" style="align:right;color:EXPR(MARGIN == 0 ? 'black' : 'red');color2:EXPR(MARGIN == 0 ? 'black' : 'red');" text="bind:UNTPC1" mask="9,999"/>
                      <Cell col="16" displaytype="number" edittype="none" style="align:right;color:EXPR(MARGIN == 0 ? 'black' : 'red');color2:EXPR(MARGIN == 0 ? 'black' : 'red');" text="bind:EVL_AMOUNT1" mask="9,999.9"/>
                      <Cell col="17" displaytype="number" edittype="expr:SERVC_ENTRPS_CNT &lt;= 1 ?  'none' : 'masknumber'" style="align:right;color:EXPR(MARGIN == 0 ? 'black' : 'red');color2:EXPR(MARGIN == 0 ? 'black' : 'red');" text="bind:UNTPC2" mask="9,999"/>
                      <Cell col="18" displaytype="number" edittype="none" style="align:right;color:EXPR(MARGIN == 0 ? 'black' : 'red');color2:EXPR(MARGIN == 0 ? 'black' : 'red');" text="bind:EVL_AMOUNT2" mask="9,999.9"/>
                      <Cell col="19" displaytype="number" edittype="expr:SERVC_ENTRPS_CNT &lt;= 2 ? 'none' : 'masknumber'" style="align:right;color:EXPR(MARGIN == 0 ? 'black' : 'red');color2:EXPR(MARGIN == 0 ? 'black' : 'red');" text="bind:UNTPC3" mask="9,999"/>
                      <Cell col="20" displaytype="number" edittype="none" style="align:right;color:EXPR(MARGIN == 0 ? 'black' : 'red');color2:EXPR(MARGIN == 0 ? 'black' : 'red');" text="bind:EVL_AMOUNT3" mask="9,999.9"/>
                      <Cell col="21" displaytype="number" edittype="expr:SERVC_ENTRPS_CNT == 0 ? 'none': 'masknumber'" style="align:right;color:EXPR(MARGIN == 0 ? 'black' : 'red');color2:EXPR(MARGIN == 0 ? 'black' : 'red');" text="bind:UNTPC" mask="9,999"/>
                      <Cell col="22" displaytype="number" edittype="expr:SERVC_ENTRPS_CNT == 0 ? 'none': 'masknumber'" style="align:right;color:EXPR(MARGIN == 0 ? 'black' : 'red');color2:EXPR(MARGIN == 0 ? 'black' : 'red');" text="bind:RWMNY" mask="9,999"/>
                      <Cell col="23" style="align:right;color:EXPR(MARGIN == 0 ? 'black' : 'red');color2:EXPR(MARGIN == 0 ? 'black' : 'red');" text="bind:MARGIN"/>
                    </Band>
                    <Band id="summary">
                      <Cell/>
                      <Cell col="1"/>
                      <Cell col="2" displaytype="number" style="align:center;" text="expr:dataset.rowcount"/>
                      <Cell col="3"/>
                      <Cell col="4"/>
                      <Cell col="5"/>
                      <Cell col="6"/>
                      <Cell col="7"/>
                      <Cell col="8"/>
                      <Cell col="9"/>
                      <Cell col="10"/>
                      <Cell col="11"/>
                      <Cell col="12"/>
                      <Cell col="13"/>
                      <Cell col="14"/>
                      <Cell col="15" displaytype="number" style="align:right;"/>
                      <Cell col="16" displaytype="number" style="align:right;" text="expr:dataset.getSum('EVL_AMOUNT1')"/>
                      <Cell col="17" displaytype="number" style="align:right;"/>
                      <Cell col="18" displaytype="number" style="align:right;" text="expr:dataset.getSum('EVL_AMOUNT2')"/>
                      <Cell col="19" displaytype="number" style="align:right;"/>
                      <Cell col="20" displaytype="number" style="align:right;" text="expr:dataset.getSum('EVL_AMOUNT3')"/>
                      <Cell col="21" displaytype="number" edittype="none" style="align:right;"/>
                      <Cell col="22" displaytype="number" edittype="none" style="align:right;" text="expr:dataset.getSum('RWMNY')"/>
                      <Cell col="23" displaytype="number" style="align:right;" text="expr:dataset.getSum('MARGIN')"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Grid id="grd_DS_TBCMP_THING_OWNER" taborder="4" useinputpanel="false" left="0" top="481" right="0" cssclass="grd02_WF_blue" binddataset="DS_TBCMP_THING_OWNER" selectscrollmode="scroll" autofittype="col" bottom="0">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="52"/>
                      <Column size="79"/>
                      <Column size="80"/>
                      <Column size="256"/>
                      <Column size="133"/>
                      <Column size="119"/>
                      <Column size="129"/>
                      <Column size="147"/>
                      <Column size="59"/>
                      <Column size="66"/>
                    </Columns>
                    <Rows>
                      <Row size="24" band="head"/>
                      <Row size="24"/>
                      <Row size="24" band="summ"/>
                    </Rows>
                    <Band id="head">
                      <Cell text="순번"/>
                      <Cell col="1" text="물건번호"/>
                      <Cell col="2" text="소유자명"/>
                      <Cell col="3" text="주소"/>
                      <Cell col="4" text="소유지분"/>
                      <Cell col="5" text="면적/수량"/>
                      <Cell col="6" text="금액"/>
                      <Cell col="7" text="비고"/>
                      <Cell col="8" text="입력회차"/>
                      <Cell col="9" text="청구구분"/>
                    </Band>
                    <Band id="body">
                      <Cell expr="expr:currow + 1"/>
                      <Cell col="1" style="align:right;" text="bind:THING_SN"/>
                      <Cell col="2" style="align:left;" text="bind:NM"/>
                      <Cell col="3" style="align:left;" text="bind:ADRES"/>
                      <Cell col="4" displaytype="number" edittype="expr:RQEST_SE != 0 ? 'none': 'text'" text="bind:POSESN_QOTA"/>
                      <Cell col="5" displaytype="number" edittype="expr:RQEST_SE != 0 ? 'none': 'masknumber'" style="align:right;" text="bind:AR" mask="9,999.999"/>
                      <Cell col="6" displaytype="number" edittype="expr:RQEST_SE != 0 ? 'none': 'masknumber'" style="align:right;" text="bind:RWMNY" mask="9,999"/>
                      <Cell col="7" style="align:left;" text="bind:RM"/>
                      <Cell col="8" style="align:right;" text="bind:INPUT_TME"/>
                      <Cell col="9" displaytype="combo" text="bind:RQEST_SE" combodataset="ds_rqestAt" combocodecol="CODE" combodatacol="CODE_NM"/>
                    </Band>
                    <Band id="summary">
                      <Cell/>
                      <Cell col="1" displaytype="number" style="align:center;" text="expr:dataset.rowcount"/>
                      <Cell col="2"/>
                      <Cell col="3"/>
                      <Cell col="4"/>
                      <Cell col="5" expr="expr:dataset.getSum('AR')"/>
                      <Cell col="6" displaytype="number" style="align:right;" expr="expr:dataset.getSum('RWMNY')"/>
                      <Cell col="7"/>
                      <Cell col="8"/>
                      <Cell col="9"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Static id="sta_01" taborder="8" text="소유자별 보상 결정 정보" left="0" top="457" width="186" height="19" cssclass="sta_WF_Title02"/>
              <Static id="Static04" taborder="9" text="5" onclick="Tab00_tabpage5_Static02_onclick" visible="false" left="0" top="31" right="0" height="5" style="background:#dc143c3c;align:center middle;"/>
              <Static id="Static00" taborder="10" text="기본조서현황" cssclass="sta_WF_Title02" left="0" top="10" width="119" height="21"/>
              <Static id="Static08" taborder="11" text="10" visible="false" left="0" top="0" width="1031" height="10" style="background:#dc143c3c;align:center middle;"/>
              <Static id="Static02" taborder="13" text="10" visible="false" left="0" top="446" width="1031" height="10" style="background:#dc143c3c;align:center middle;"/>
              <Static id="Static03" taborder="14" text="5" onclick="Tab00_tabpage5_Static02_onclick" visible="false" left="0" top="476" right="-8" height="5" style="background:#dc143c3c;align:center middle;"/>
              <Button id="btn_excute" taborder="15" text="보상액산정" cssclass="btn_WF_Grid" top="10" width="92" height="21" onclick="div_WORK_btn_excute_onclick" right="0" style="font:9 굴림;"/>
              <Button id="btn_save" taborder="17" text="저장" cssclass="btn_WF_Process" visible="true" top="457" width="38" height="19" right="0" onclick="div_WORK_btn_save_onclick"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static02" taborder="3" text="스&#13;&#10;크&#13;&#10;롤&#13;&#10;13" visible="false" top="0" right="0" width="13" height="735" style="background:#d07b173c;align:center middle;"/>
        <Static id="Static01" taborder="4" text="15" visible="false" top="0" right="13" width="15" height="735" style="background:#1b3cd23c;align:center middle;"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="DS_OPTION0" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">%</Col>
            <Col id="CODE_NM">전체</Col>
          </Row>
          <Row>
            <Col id="CODE">Y</Col>
            <Col id="CODE_NM">감평</Col>
          </Row>
          <Row>
            <Col id="CODE">N</Col>
            <Col id="CODE_NM">비감평</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="DS_TBCMP_THING_WTNNC_CHK" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="DS_TBCMP_THING_WTNNC_oncolumnchanged">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="BSNS_AREA_CODE" type="STRING" size="256"/>
          <Column id="THING_SN" type="STRING" size="256"/>
          <Column id="LOCPLC_CODE_NM" type="STRING" size="256"/>
          <Column id="LOCPLC_CODE" type="STRING" size="256"/>
          <Column id="LNM_SLNO" type="STRING" size="256"/>
          <Column id="THING_CL" type="STRING" size="256"/>
          <Column id="THING_NM" type="STRING" size="256"/>
          <Column id="STRCT_STNDRD" type="STRING" size="256"/>
          <Column id="AR_INCRPR" type="STRING" size="256"/>
          <Column id="UNIT" type="STRING" size="256"/>
          <Column id="UNTPC" type="BIGDECIMAL" size="256"/>
          <Column id="EVL_AMOUNT" type="BIGDECIMAL" size="256"/>
          <Column id="RWMNY" type="STRING" size="256"/>
          <Column id="RM_1" type="STRING" size="256"/>
          <Column id="REWARD_ODR" type="STRING" size="256"/>
          <Column id="PRPRAPR_CODE" type="STRING" size="256"/>
          <Column id="REWARD_STLE" type="STRING" size="256"/>
          <Column id="BNDE_APPLC_GROUP" type="STRING" size="256"/>
          <Column id="SERVC_ENTRPS_CNT" type="STRING" size="256"/>
          <Column id="BCNC_CODE1" type="STRING" size="256"/>
          <Column id="UNTPC1" type="BIGDECIMAL" size="256"/>
          <Column id="EVL_AMOUNT1" type="BIGDECIMAL" size="256"/>
          <Column id="BCNC_NM1" type="STRING" size="256"/>
          <Column id="BCNC_CODE2" type="STRING" size="256"/>
          <Column id="UNTPC2" type="BIGDECIMAL" size="256"/>
          <Column id="EVL_AMOUNT2" type="BIGDECIMAL" size="256"/>
          <Column id="BCNC_NM2" type="STRING" size="256"/>
          <Column id="BCNC_CODE3" type="STRING" size="256"/>
          <Column id="UNTPC3" type="BIGDECIMAL" size="256"/>
          <Column id="EVL_AMOUNT3" type="BIGDECIMAL" size="256"/>
          <Column id="BCNC_NM3" type="STRING" size="256"/>
          <Column id="MARGIN" type="BIGDECIMAL" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_TBCMP_THING_WTNNC" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="DS_TBCMP_THING_WTNNC_oncolumnchanged" cancolumnchange="DS_TBCMP_THING_WTNNC_cancolumnchange" onvaluechanged="DS_TBCMP_THING_WTNNC_onvaluechanged">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="BSNS_AREA_CODE" type="STRING" size="256"/>
          <Column id="THING_SN" type="STRING" size="256"/>
          <Column id="LOCPLC_CODE_NM" type="STRING" size="256"/>
          <Column id="LOCPLC_CODE" type="STRING" size="256"/>
          <Column id="LNM_SLNO" type="STRING" size="256"/>
          <Column id="THING_CL" type="STRING" size="256"/>
          <Column id="THING_NM" type="STRING" size="256"/>
          <Column id="STRCT_STNDRD" type="STRING" size="256"/>
          <Column id="AR_INCRPR" type="STRING" size="256"/>
          <Column id="UNIT" type="STRING" size="256"/>
          <Column id="UNTPC" type="BIGDECIMAL" size="256"/>
          <Column id="EVL_AMOUNT" type="BIGDECIMAL" size="256"/>
          <Column id="RWMNY" type="BIGDECIMAL" size="256"/>
          <Column id="RM_1" type="STRING" size="256"/>
          <Column id="REWARD_ODR" type="STRING" size="256"/>
          <Column id="PRPRAPR_CODE" type="STRING" size="256"/>
          <Column id="REWARD_STLE" type="STRING" size="256"/>
          <Column id="BNDE_APPLC_GROUP" type="STRING" size="256"/>
          <Column id="SERVC_ENTRPS_CNT" type="INT" size="256"/>
          <Column id="BCNC_CODE1" type="STRING" size="256"/>
          <Column id="UNTPC1" type="BIGDECIMAL" size="256"/>
          <Column id="EVL_AMOUNT1" type="BIGDECIMAL" size="256"/>
          <Column id="BCNC_NM1" type="STRING" size="256"/>
          <Column id="BCNC_CODE2" type="STRING" size="256"/>
          <Column id="UNTPC2" type="BIGDECIMAL" size="256"/>
          <Column id="EVL_AMOUNT2" type="BIGDECIMAL" size="256"/>
          <Column id="BCNC_NM2" type="STRING" size="256"/>
          <Column id="BCNC_CODE3" type="STRING" size="256"/>
          <Column id="UNTPC3" type="BIGDECIMAL" size="256"/>
          <Column id="EVL_AMOUNT3" type="BIGDECIMAL" size="256"/>
          <Column id="BCNC_NM3" type="STRING" size="256"/>
          <Column id="MARGIN" type="BIGDECIMAL" size="256"/>
          <Column id="LNDCGR_LGSTR" type="STRING" size="10"/>
          <Column id="LNDCGR_INCRPR" type="STRING" size="10"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_LOCPLC_CODE" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_THING_CL" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_UNIT" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_REWARD_STLE" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_TBCMP_THING_OWNER" useclientlayout="true">
        <ColumnInfo>
          <Column id="BSNS_AREA_CODE" type="STRING" size="255"/>
          <Column id="THING_SN" type="STRING" size="255"/>
          <Column id="OWNER_NO" type="STRING" size="255"/>
          <Column id="POSESN_QOTA" type="STRING" size="255"/>
          <Column id="AR" type="BIGDECIMAL" size="255"/>
          <Column id="RWMNY" type="BIGDECIMAL" size="255"/>
          <Column id="ACEPTNC_CNFIRM" type="STRING" size="255"/>
          <Column id="RQEST_SE" type="STRING" size="255"/>
          <Column id="INPUT_TME" type="STRING" size="255"/>
          <Column id="ACEPTNC_AT" type="STRING" size="255"/>
          <Column id="RQEST_SN" type="STRING" size="255"/>
          <Column id="ACEPTNC_ADJDC_ODR" type="STRING" size="255"/>
          <Column id="ACEPTNC_ADJDC_DE" type="STRING" size="255"/>
          <Column id="RM" type="STRING" size="255"/>
          <Column id="REGISTER_ID" type="STRING" size="255"/>
          <Column id="REGIST_DT" type="STRING" size="255"/>
          <Column id="UPDUSR_ID" type="STRING" size="255"/>
          <Column id="UPDT_DT" type="STRING" size="255"/>
          <Column id="OWNER_SN" type="STRING" size="255"/>
          <Column id="NM" type="STRING" size="255"/>
          <Column id="ADRES" type="STRING" size="255"/>
          <Column id="ADRES_DETAIL" type="STRING" size="255"/>
          <Column id="TELNO_1" type="STRING" size="255"/>
          <Column id="TLPHON_2" type="STRING" size="255"/>
          <Column id="CAL_QOTA" type="BIGDECIMAL" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_validation" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="compId" type="STRING" size="256"/>
          <Column id="colId" type="STRING" size="256"/>
          <Column id="PK" type="STRING" size="256"/>
          <Column id="notNull" type="STRING" size="256"/>
          <Column id="type" type="STRING" size="256"/>
          <Column id="nlength" type="STRING" size="256"/>
          <Column id="from" type="STRING" size="256"/>
          <Column id="to" type="STRING" size="256"/>
          <Column id="lengthChkGb" type="STRING" size="256"/>
          <Column id="msgId" type="STRING" size="256"/>
          <Column id="expr" type="STRING" size="256"/>
          <Column id="func" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="compId">div_search</Col>
            <Col id="colId">cmb_BSNS_AREA_CODE</Col>
            <Col id="notNull">Y</Col>
            <Col id="to"/>
            <Col id="msgId">사업지구</Col>
          </Row>
          <Row>
            <Col id="compId">DS_TBCMP_THING_WTNNC</Col>
            <Col id="colId">UNTPC</Col>
            <Col id="notNull">Y</Col>
            <Col id="to"/>
            <Col id="msgId">결정단가</Col>
          </Row>
          <Row>
            <Col id="compId">DS_TBCMP_THING_WTNNC</Col>
            <Col id="colId">RWMNY</Col>
            <Col id="notNull">Y</Col>
            <Col id="to"/>
            <Col id="msgId">결정금액</Col>
          </Row>
          <Row>
            <Col id="compId">DS_TBCMP_THING_OWNER</Col>
            <Col id="colId">RWMNY</Col>
            <Col id="notNull">Y</Col>
            <Col id="to"/>
            <Col id="msgId">금액</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_cond01" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="ETC1" type="STRING" size="256"/>
          <Column id="GRP_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond00" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="BSNS_AREA_CODE" type="STRING" size="256"/>
          <Column id="LOCPLC_CODE" type="STRING" size="256"/>
          <Column id="REWARD_ODR" type="STRING" size="256"/>
          <Column id="LNM" type="STRING" size="256"/>
          <Column id="SLNO" type="STRING" size="256"/>
          <Column id="NM" type="STRING" size="256"/>
          <Column id="THING_CL" type="STRING" size="256"/>
          <Column id="OPTION0" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_BSNS_AREA_CODE" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="FULL_CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond02" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="BSNS_AREA_CODE" type="STRING" size="256"/>
          <Column id="THING_SN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_THING_CL2" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_rqestAt" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">0</Col>
            <Col id="CODE_NM">미청구</Col>
          </Row>
          <Row>
            <Col id="CODE">1</Col>
            <Col id="CODE_NM">청구</Col>
          </Row>
          <Row>
            <Col id="CODE_NM">미청구</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_rewardOdr" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="MAX_VALUE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_TBCMP_LNDCGR_CODE" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_TBCMP_BSNSBY_PRPRAPR">
        <ColumnInfo>
          <Column id="Column0" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript5.0"><![CDATA[/***********************************************************************
 * 화면ID   : CMP030100
 * 화면명   : 보상액사정
 * 화면설명 : 보상액사정.
 * 작성일   : 2015.07.21
 * 작성자   : 지효정
 * 수정이력 : 
 ***********************************************************************
 *     수정일     수정자   내용
 ***********************************************************************
 */
 
/***********************************************************************
 * Script Include 
 ***********************************************************************/
include "pms_lib::cmpUtilInclude.xjs";

this.arrDS = null;

/***********************************************************************
 * onInit / onLoad 영역
 ***********************************************************************/
this.frm_CMP030100_oninit = function(obj:Form, e:nexacro.InitEventInfo)
{
	this.fn_init();//공통 폼 초기화
	this.fn_init_form();//폼 초기화.
	this.fn_init_dataset();//Dataset 초기화
}

this.frm_CMP030100_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{
	this.fn_load_combo();
}

/*
 * 함수명  	: fn_init_form
 * 설명 		: Form을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initForm();
 */
this.fn_init_form = function(){
	/*******************************************************************************
	**검색 영역 물건분류 멀티 체크박스 초기화
	********************************************************************************/
	var div_THING_CL = this.div_search.div_THING_CL;
	div_THING_CL.fn_init(3);
	div_THING_CL.fn_set_DSColumn("CODE", "CODE_NM");
	div_THING_CL.fn_set_checkAll(this.div_search.chk_SELECT);
	
	/*******************************************************************************
	*프로세스에 맞게 데이이터셋을 순서대로 배열에 삽입
	********************************************************************************/
	this.fn_setAll_ds();
}

/*
 * 함수명  	: fn_init_dataset
 * 설명 		: Dataset을 초기화한다.
 *                주로, 조건 Dataset들(ds_cond, ds_cond_00, ds_cond_01, ...) 을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initDataset();
 */
this.fn_init_dataset = function()
{
	//조회, 종료시에 수정여부 체크할 데이터셋
	this.checkDs.push(this.DS_TBCMP_THING_WTNNC);
	this.checkDs.push(this.DS_TBCMP_THING_OWNER);
	
	this.gfn_initCondDs(this, this.div_search);
}

/*
 * 함수명  	: fn_load_combo
 * 설명 		: 모든 코드 리스트 검색
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_get_codeList();
 */
this.fn_load_combo = function(){
	this.fn_add_comboHeader(this, this.div_search.cmb_BSNS_AREA_CODE, "선택");
	this.fn_add_comboHeader(this, this.div_search.cmb_LOCPLC_CODE, "전체");
	this.fn_add_comboHeader(this, this.div_search.cmb_REWARD_ODR, "전체");
	
	this.fn_get_userBsnsArea(this.DS_BSNS_AREA_CODE, "선택");				//사업지구
	this.fn_get_cmmCode(this.DS_THING_CL, "", {grpCode:"CMP001"} ); 	//물건분류
	this.fn_get_cmmCode(this.DS_UNIT, "", {grpCode:"CMP002"} ); 		//단위
	this.fn_get_cmmCode(this.DS_REWARD_STLE, "", {grpCode:"CMP007"} ); 	//보상형태
	this.fn_get_lndcgrCode(this.DS_TBCMP_LNDCGR_CODE);					//지목 코드 	

	this.fn_get_thingClChkBox(this.DS_THING_CL2, this.div_search.div_THING_CL, {grpCode:"CMP001"}, true);	//물건분류 (멀티 체크박스)
}

/*
 * 함수명  	: div_search_cmb_BSNS_AREA_CODE_onitemchanged
 * 설명 		: 사업지구의 내용 변경시 소재지 콤보 업데이트
 * params  		: None
 * return Type 	: None
 * 사용법		: 
 */
this.div_search_cmb_BSNS_AREA_CODE_onitemchanged = function(obj:Combo, e:nexacro.ItemChangeEventInfo)
{
	var bsnsAreaCode = this.div_search.cmb_BSNS_AREA_CODE.value;
	this.fn_get_locplcCode(this.DS_LOCPLC_CODE, "전체", {bsnsAreaCode:bsnsAreaCode});	//소재지
	this.fn_get_rewardOdr(this.ds_rewardOdr, "전체", {bsnsAreaCode:bsnsAreaCode});//최종 차수
}

/*
 * 함수명  	: div_search_rdo_OPTION0_onitemchanged
 * 설명 		: 물건분류 감평, 비감평 선택시 해당하는 항목만 물건이 나오도록
 * params  		: None
 * return Type 	: None
 * 사용법		: 
 */
this.div_search_rdo_OPTION0_onitemchanged = function(obj:Radio, e:nexacro.ItemChangeEventInfo)
{
	//물건분류 (멀티 체크박스)
	this.fn_get_thingClChkBox(this.DS_THING_CL2, this.div_search.div_THING_CL, {grpCode:"CMP001", option0:this.div_search.rdo_OPTION0.value}, true);
}

/*
 * 함수명  	: fn_search
 * 설명 		: 기본 조서 검색
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_search();
 */
this.fn_search = function(){
	if(!this.gfn_checkValidation(this.div_search, this.ds_validation)) {
		return;
	}
	
	this.fn_clearAll_ds();
	this.fn_divToDS(this.ds_cond00, this.div_search);
	//this.fn_transaction("thingWtnncList");
	this.fn_transaction("bsnsbyPrpraprList");
}

/*
 * 함수명  	: fn_save
 * 설명 		: 보상액 저장
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_save();
 */
this.fn_save = function(startIdx){
	
	if(!this.fn_checkUpdate(this.DS_TBCMP_THING_WTNNC)) {
		this.alert("comm.데이터.변경.없음");
		return false;
	}

	if(this.confirm("S")){
		this.fn_transaction("apasmtU");	
	}
}

/*
 * 함수명  	: fn_cancel
 * 설명 		: 취소버튼
 * params  		: None
 * return Type 	: None
 * 사용법		: 
 */
this.fn_cancel = function(){
	if(this.confirm("C")){
		this.DS_TBCMP_THING_WTNNC.reset();
		this.DS_TBCMP_THING_OWNER.reset();
		this.DS_TBCMP_THING_WTNNC_CHK.reset();
	}
}

/*
 * 함수명  	: fn_close
 * 설명 		: 종료버튼
 * params  		: None
 * return Type 	: None
 * 사용법		: 
 */
this.fn_close = function(){
	this.close();
}

/*
 * 함수명  	: div_WORK_btn_excute_onclick
 * 설명 		: 실행버튼
 * params  		: None
 * return Type 	: None
 * 사용법		: 
 */
this.div_WORK_btn_excute_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.confirm("결정금액과 보상금액을 자동 계산하시겠습니까?") == true){

		var nRow = 0;
		var nCnt = 0;
		var rowcount = this.DS_TBCMP_THING_WTNNC.rowcount;
		
		for(var i=0; i<rowcount; i++){
			var chk = this.DS_TBCMP_THING_WTNNC.getColumn(i, "CHK");
			//체크된 항목만 계산한다.
			if(chk == '1'){
				if(0 == this.DS_TBCMP_THING_WTNNC.getColumn(i, "SERVC_ENTRPS_CNT")) {
					this.alert("청구된 내역이 있습니다.");
					return false;
				}
			
				nRow = this.DS_TBCMP_THING_WTNNC_CHK.addRow()
				this.DS_TBCMP_THING_WTNNC_CHK.copyRow(nRow, this.DS_TBCMP_THING_WTNNC, i);
				nCnt++;
			}
		}
		
		if(nCnt == 0) {
			this.alert("보상액산정 할 물건조서를 선택해주시기 바랍니다.");
			return;
		}
		
		this.fn_transaction("calcRwmny");
	}
}

/*
 * 함수명  	: div_WORK_grd_DS_TBCMP_THING_WTNNC_onselectchanged
 * 설명 		: 그리드 셀렉트 체인지 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: 
 */
this.div_WORK_grd_DS_TBCMP_THING_WTNNC_onselectchanged = function(obj:Grid, e:nexacro.GridSelectEventInfo)
{
	this.fn_clearAll_ds(1);
	var bsnsAreaCode = this.DS_TBCMP_THING_WTNNC.getColumn(e.row, "BSNS_AREA_CODE");
	var thingSn = this.DS_TBCMP_THING_WTNNC.getColumn(e.row, "THING_SN");
	this.ds_cond02.setColumn(0, "BSNS_AREA_CODE", bsnsAreaCode);
	this.ds_cond02.setColumn(0, "THING_SN", thingSn);
	this.fn_transaction("thingOwnerList");
}

/*
 * 함수명  	: fn_excute
 * 설명 		: 실행버튼, 실행, 소유자 컬럽 값 체인지, 금액 자동 계산
 * params  		: None
 * return Type 	: None
 * 사용법		: 
 */
this.fn_excute = function(rowposition){
	var untpc = 0;
	var untpc1 = 0;
	var	untpc2 = 0;
	var	untpc3 = 0;
	var untpcTot = 0;
	var	servcEntrpsCnt = 0;
	var thingSn = this.DS_TBCMP_THING_WTNNC.getColumn(rowposition, "THING_SN");
	//this.debug("보상금 계산 시작", true);
	
	//단가계산 [[
	untpc1 = Number(this.DS_TBCMP_THING_WTNNC.getColumn(rowposition, "UNTPC1"));
	untpc2 = Number(this.DS_TBCMP_THING_WTNNC.getColumn(rowposition, "UNTPC2"));
	untpc3 = Number(this.DS_TBCMP_THING_WTNNC.getColumn(rowposition, "UNTPC3"));
	untpc1 = isNaN(untpc1)?0:untpc1;
	untpc2 = isNaN(untpc2)?0:untpc2;
	untpc3 = isNaN(untpc3)?0:untpc3;
	servcEntrpsCnt = Number(this.DS_TBCMP_THING_WTNNC.getColumn(rowposition, "SERVC_ENTRPS_CNT"));
	//결정단가 = (평가단가1 + 평가단가2 + 평가단가3) /3   소수점 3자리 표시
	untpcTot = untpc1 + untpc2 + untpc3;
	untpc = (untpcTot / servcEntrpsCnt).toFixed(3);
	this.DS_TBCMP_THING_WTNNC.setColumn(rowposition, "UNTPC", untpc);
	//this.debug("총 평가단가:" + untpcTot);
	//this.debug("총 감정평가기관 수:" + servcEntrpsCnt);
	//this.debug("결정단가:" + untpc);
	//단가계산 ]]
	
	//보상금계산 [[
	var evlAmount = 0;
	var evlAmount1 = 0;
	var	evlAmount2 = 0;
	var	evlAmount3 = 0;
	var evlAmountTot = 0;
	var	servcEntrpsCnt = 0;
	evlAmount1 = Number(this.DS_TBCMP_THING_WTNNC.getColumn(rowposition, "EVL_AMOUNT1"));
	evlAmount2 = Number(this.DS_TBCMP_THING_WTNNC.getColumn(rowposition, "EVL_AMOUNT2"));
	evlAmount3 = Number(this.DS_TBCMP_THING_WTNNC.getColumn(rowposition, "EVL_AMOUNT3"));
	evlAmount1 = isNaN(evlAmount1)?0:evlAmount1;
	evlAmount2 = isNaN(evlAmount2)?0:evlAmount2;
	evlAmount3 = isNaN(evlAmount3)?0:evlAmount3;
	servcEntrpsCnt = Number(this.DS_TBCMP_THING_WTNNC.getColumn(rowposition, "SERVC_ENTRPS_CNT"));
	//결정금액 = (평가금액1 + 평가금액2 + 평가금액3) /3   원단위 절사(10원단위로 표시)
	evlAmountTot = evlAmount1 + evlAmount2 + evlAmount3;
	evlAmount = (evlAmountTot / servcEntrpsCnt).toFixed(0);
	//this.debug("총 평가금액:" + evlAmountTot);
	//this.debug("결정금액 절사전:" + evlAmount);
	evlAmount = (evlAmount - evlAmount%10);
	//this.debug("결정금액 절사후:" + evlAmount);
	this.DS_TBCMP_THING_WTNNC.setColumn(rowposition, "RWMNY", evlAmount);
	//보상금계산 [[
		
	var rwmny = evlAmount;	//물건 보상금

	/***********************************************************************
	 *소유자별 보상금액 : 지분 또는 면적 둘 중 하나는 반드시 등록되어 있어야 함. 
	 *원단위 절사(10원단위로 표시).
	 *지분이 존재하는 경우 : 보상금액 = 물건의 결정금액 * 지분
	 *면적이 존재하는 경우 : 보상금액 = 물건의 결정금액 * 소유자면적 / 물건의 편입면적
	 *지분과 면적이 동시에 존재하는 경우 지분을 우선하여 계산하는게 컨셉이지만...
	 *차세대 시스템에서는 두개다 입력해야 하므로 더 정확한 계산을 위해 면적으로 계산한다.
	 ***********************************************************************/
	var rowcount = this.DS_TBCMP_THING_OWNER.rowcount;
	var ownerRwnmyTotal = 0;	//소유자별 보상금 총액
	var ownerRwnmy = 0;			//소유자별 보상금
	var namujiTotal = 0;				//소유자별 보상금중에 1원 이하의 금액의 총액
	
	//this.debug(this.DS_TBCMP_THING_OWNER);

	//소유자의 지분만큼 보상액 사정.
	var totAr = this.DS_TBCMP_THING_OWNER.getColumn(i, "AR_INCRPR");
	for(var i=rowcount-1; i>=0; i--){
		if(this.DS_TBCMP_THING_OWNER.getColumn(i, "THING_SN") == thingSn){
			var posesnQota = this.DS_TBCMP_THING_OWNER.getColumn(i, "POSESN_QOTA");
			var namuji = 0;
			//지분이 없을경우 수량을 이용하여 지분을 만든다.
			if(posesnQota == null || posesnQota.indexOf("/") == -1){
				posesnQota = this.DS_TBCMP_THING_OWNER.getColumn(i, "AR") + "/" + totAr;
			}
			
			ownerRwnmy = rwmny * this.fn_fractionalToPer(posesnQota) * 0.01;
			namuji = (ownerRwnmy % 1);					//소유자별 보상금액중 1원이하의 금액을 합산.
			ownerRwnmy -= namuji;			//소유자별 보상금액에서 1원이하의 금액을 뺀다.
			namujiTotal += namuji;
			//소유자중 첫번째 사람에게 1원 이하의 금액을 몰아준다.
			if(i == 0){
				//this.debug("첫번째 소유자별  보상금 :" + ownerRwnmy);
				//this.debug("첫번째 소유자별 0원이하 :" + namujiTotal);
				ownerRwnmy += namujiTotal;
			} 
			ownerRwnmy = ownerRwnmy - ownerRwnmy % 1;
			ownerRwnmyTotal += ownerRwnmy;				//소유자별 보상금액의 총액을 합산
			this.DS_TBCMP_THING_OWNER.setColumn(i, "RWMNY", ownerRwnmy);
			//this.debug("소유자별 지분 :" + posesnQota);
			//this.debug("소유자별 보상 금액 :" + ownerRwnmy);
			//this.debug("소유자별 1원미만 금액 :" + namuji);
		}
	}
	
	//this.debug("소유자 보상금액 총 합계 :" + ownerRwnmyTotal);
	
	//물건별 소유자 금액의 합계는 결정금액보다 클 수 없다
	if(rwmny < ownerRwnmyTotal){
		this.alert("물건별 소유자 금액의 합계는 결정금액보다 클 수 없습니다.");
		this.DS_TBCMP_THING_WTNNC.cancel();
		this.DS_TBCMP_THING_OWNER.cancel();
		return false;
	}
	
	this.DS_TBCMP_THING_WTNNC.setColumn(rowposition, "MARGIN", rwmny - ownerRwnmyTotal);
	
	//this.debug(rwmny + "-" + ownerRwnmyTotal + " = " + (rwmny - ownerRwnmyTotal));
	//this.debug("보상금 계산 종료", true);
	return true;
}

/*
 * 함수명  	: DS_TBCMP_THING_WTNNC_oncolumnchanged
 * 설명 		: 조서 컬럼 체인지 이벤트
 * params  		: None
 * return Type 	: None
 * 사용법		: 
 */
this.DS_TBCMP_THING_WTNNC_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	if("UNTPC" ==  e.columnid) {
		var ar   = Number(this.DS_TBCMP_THING_WTNNC.getColumn(e.row, "AR_INCRPR"));
		var uSum = Number(e.newvalue);
		
		var evlAmount = (uSum * ar).toFixed(0);
		evlAmount = (evlAmount - evlAmount%10);
		
		this.DS_TBCMP_THING_WTNNC.setColumn(e.row, "RWMNY", evlAmount);
	}
	else if("RWMNY" == e.columnid) {
		var ar   = Number(this.DS_TBCMP_THING_WTNNC.getColumn(e.row, "AR_INCRPR"));
		var dSum = Number(e.newvalue);
		
		var untpc = (dSum / ar).toFixed(3);
		this.DS_TBCMP_THING_WTNNC.setColumn(e.row, "UNTPC", untpc);
	}
	else if("CHK" ==  e.columnid) {
	
	}
	else {
		if(e.columnid.indexOf("UNTPC") != -1 && e.columnid.length == 6){ 
			var ar = Number(obj.getColumn(e.row, "AR_INCRPR"));
			var untpc = Number(e.newvalue);
			var num = e.columnid.substring(e.columnid.length-1,e.columnid.length);
			obj.setColumn(e.row, "EVL_AMOUNT" + num, ar * untpc);
		}
		else if(e.columnid.indexOf("EVL_AMOUNT") != -1){
			var ar = Number(obj.getColumn(e.row, "AR_INCRPR"));
			var rwmny = Number(e.newvalue);
			var num = e.columnid.substring(e.columnid.length-1,e.columnid.length);
			obj.setColumn(e.row, "UNTPC" + num, rwmny / ar);
		}
		
		var eCnt = Number(this.DS_TBCMP_THING_WTNNC.getColumn(e.row, "SERVC_ENTRPS_CNT"));
		var uSum = Number(this.DS_TBCMP_THING_WTNNC.getColumn(e.row, "UNTPC1")) +
				   Number(this.DS_TBCMP_THING_WTNNC.getColumn(e.row, "UNTPC2")) +
				   Number(this.DS_TBCMP_THING_WTNNC.getColumn(e.row, "UNTPC3"));
		var dSum = Number(this.DS_TBCMP_THING_WTNNC.getColumn(e.row, "EVL_AMOUNT1")) +
				   Number(this.DS_TBCMP_THING_WTNNC.getColumn(e.row, "EVL_AMOUNT2")) +
				   Number(this.DS_TBCMP_THING_WTNNC.getColumn(e.row, "EVL_AMOUNT3"));
		
		var untpc = (uSum / eCnt).toFixed(3);
		this.DS_TBCMP_THING_WTNNC.setColumn(e.row, "UNTPC", untpc);
		
		var evlAmount = (dSum / eCnt).toFixed(0);
		evlAmount = (evlAmount - evlAmount%10);
		this.DS_TBCMP_THING_WTNNC.setColumn(e.row, "RWMNY", evlAmount);

		//this.debug("eCnt : " + eCnt + ", uSum : " + uSum + ", dSum : " + dSum);
	}
}

/*
 * 함수명  	: fn_setAll_ds
 * 설명 		: 프로세스에 맞게 데이이터셋을 순서대로 배열에 삽입
 * params  		: None
 * return Type 	: None
 * 사용법		: 
 */
this.fn_setAll_ds = function(){
	this.arrDS = [];
	this.arrDS.push(this.DS_TBCMP_THING_WTNNC);
	this.arrDS.push(this.DS_TBCMP_THING_OWNER);
}

/*
 * 함수명  	: fn_clearAll_ds
 * 설명 		: 데이터셋의 데이터 삭제
 * params  		: None
 * return Type 	: None
 * 사용법		: 
 */
this.fn_clearAll_ds = function(startIdx){
	if(startIdx == null){
		startIdx = 0;
	}
	var cnt = this.arrDS.length;
	for(var i=startIdx; i<cnt; i++){
		this.arrDS[i].clearData();
	}
}

/**********************************************************************
 * CALL TRANSACTION 영역
 **********************************************************************/
 /*
 * 함수명  	: fn_transaction
 * 설명 		: Transaction 요청 처리 함수
 * params  		: strSvcId : 서비스요청 ID
 * return Type 	: None
 * 사용법		: this.fn_transaction("SELECT");
 */
this.fn_transaction = function(strSvcId)
{
	var bSync = true;
	
	switch (strSvcId) {
		case "thingWtnncList": //기본 조서 리스트 조회
			var sController   	= "hsco/pms/cmp/rad/CMP030100/thingWtnncList.do";
			var sInDatasets   	= "input1=ds_cond00";
			var sOutDatasets  	= "DS_TBCMP_THING_WTNNC=output1";
			break;
			
		case "bsnsbyPrpraprList": //평가자 리스트 조회
			var sController   	= "hsco/pms/cmp/rad/CMP030100/bsnsbyPrpraprList.do";
			var sInDatasets   	= "input1=ds_cond00";
			var sOutDatasets  	= "DS_TBCMP_BSNSBY_PRPRAPR=output1";
			break;
			
		case "thingOwnerList": //소유자 리스트 조회
			var sController   	= "hsco/pms/cmp/rad/CMP030100/thingOwnerList.do";
			var sInDatasets   	= "input1=ds_cond02";
			var sOutDatasets  	= "DS_TBCMP_THING_OWNER=output1";
			break;
			
		case "apasmtU":			//감정 평가 등록
			var sController   	= "hsco/pms/cmp/rad/CMP030100/apasmtU.do";
			var sInDatasets  	= "input1=DS_TBCMP_THING_WTNNC:U"
							    + " input2=DS_TBCMP_THING_OWNER:U";
			var sOutDatasets  	= "";
			break;
		case "calcRwmny":		//보상액산정
			var sController   	= "hsco/pms/cmp/rad/CMP030100/calcRwmny.do";
			var sInDatasets  	= "input1=DS_TBCMP_THING_WTNNC_CHK:U";
			var sOutDatasets  	= "";
			break;
		case "thingOwnerU":			//보상결정정보 변경
			var sController   	= "hsco/pms/cmp/rad/CMP030100/thingOwnerU.do";
			var sInDatasets  	= "input1=DS_TBCMP_THING_OWNER:U";
			var sOutDatasets  	= "";
			break;
	}

	if(this.fn_validate_tranasaction(strSvcId, sController, sInDatasets, sOutDatasets) == false){
		return;
	}
	
	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets, "", null, null, bSync); 
}

/**********************************************************************
 * Transaction Callback 영역
 ***********************************************************************/
 /*
 * 함수명  	: fn_callBack
 * 설명 		: Transaction Callback 처리
 * params  		: strSvcId    : 서비스요청 ID
 *                nErrorCode  : 오류 메시지 코드 ([예] 0 : Success, 그밖의 경우, error)
 *                strErrorMsg : 오류 메시지([예]  success.insert|정상적으로 등록되었습니다.)
 * return Type 	: None
 * 사용법		: 
 */
this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg)
{
	//this.fn_callback_message(strSvcId, nErrorCode, strErrorMsg);
	
	//this.debug("strSvcId : " + strSvcId + ", nErrorCode : " + nErrorCode + ", strErrorMsg : " + strErrorMsg);
	
	var bSuccess = nErrorCode == 0?true:false;

	//this.debug( (bSuccess==true?"Success : ":"Fail : ") + strSvcId);
	if (bSuccess == true){
		switch(strSvcId){
			case "bsnsbyPrpraprList":
				if(this.DS_TBCMP_BSNSBY_PRPRAPR.rowcount > 0 ){
					var tempNm = "";
					tempNm = this.DS_TBCMP_BSNSBY_PRPRAPR.getColumn(0, "BCNC_NM1");
					if(tempNm != null){
						this.div_WORK.grd_DS_TBCMP_THING_WTNNC.setCellProperty("head",14,"text",tempNm);
					}
					else {
						this.div_WORK.grd_DS_TBCMP_THING_WTNNC.setCellProperty("head",14,"text","평가사1");
					}

					tempNm = this.DS_TBCMP_BSNSBY_PRPRAPR.getColumn(0, "BCNC_NM2");
					if(tempNm != null){
						this.div_WORK.grd_DS_TBCMP_THING_WTNNC.setCellProperty("head",15,"text",tempNm);
					}
					else {
						this.div_WORK.grd_DS_TBCMP_THING_WTNNC.setCellProperty("head",15,"text","평가사2");
					}

					tempNm = this.DS_TBCMP_BSNSBY_PRPRAPR.getColumn(0, "BCNC_NM3");
					if(tempNm != null){
						this.div_WORK.grd_DS_TBCMP_THING_WTNNC.setCellProperty("head",16,"text",tempNm);						
					}
					else {
						this.div_WORK.grd_DS_TBCMP_THING_WTNNC.setCellProperty("head",16,"text","평가사3");
					}
				}
				else {
					this.div_WORK.grd_DS_TBCMP_THING_WTNNC.setCellProperty("head",14,"text","평가사1");
					this.div_WORK.grd_DS_TBCMP_THING_WTNNC.setCellProperty("head",15,"text","평가사2");
					this.div_WORK.grd_DS_TBCMP_THING_WTNNC.setCellProperty("head",16,"text","평가사3");
				}
				this.fn_transaction("thingWtnncList");
				break;
			case "thingWtnncList":
			case "thingOwnerList":
				break;
			case "apasmtU":			//감정 평가 등록
			case "calcRwmny":		//보상액산정
				this.fn_transaction("thingWtnncList");
				this.DS_TBCMP_THING_WTNNC_CHK.clearData();
				this.fn_callback_message(strSvcId, nErrorCode, strErrorMsg);
				break;
			case "thingOwnerU":
				this.fn_transaction("thingOwnerList");
				this.fn_callback_message(strSvcId, nErrorCode, strErrorMsg);
				break;
		}
	}
}

this.div_WORK_btn_save_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.confirm("S")){
		this.fn_transaction("thingOwnerU");
	}
}

this.div_WORK_grd_DS_TBCMP_THING_WTNNC_onheadclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	this.DS_TBCMP_THING_WTNNC.set_updatecontrol(false);
}

this.DS_TBCMP_THING_WTNNC_cancolumnchange = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	if("CHK" == e.columnid) {
		if(Dataset.ROWTYPE_NORMAL == obj.getRowType(e.row)) {
			obj.set_updatecontrol(false);
		}
	}
}

this.DS_TBCMP_THING_WTNNC_onvaluechanged = function(obj:Dataset,  e:nexacro.DSColChangeEventInfo)
{
	if(-1 == e.col) {
		if(0 == e.row ) {
			obj.set_updatecontrol(true);
		}
	}
	else {
		if("CHK" == e.columnid) {
			obj.set_updatecontrol(true);
		}	
	}
}]]></Script>
  </Form>
</FDL>
