<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="COM010700_P01" classname="SAL010108_P01" left="0" top="0" width="1050" height="600" titletext="SMS발신관리" oninit="COM010700_P01_oninit" onload="COM010700_P01_onload">
    <Layouts>
      <Layout>
        <Grid id="grd_smsLog" taborder="2" binddataset="ds_smsLog" useinputpanel="false" autofittype="none" left="15" top="356" cellsizingtype="col" autosizingtype="row" scrollbars="autoboth" bottom="16" right="15">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="35"/>
                <Column size="130"/>
                <Column size="65"/>
                <Column size="105"/>
                <Column size="632"/>
                <Column size="130"/>
                <Column size="74"/>
                <Column size="88"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="번호"/>
                <Cell col="1" text="발송일시"/>
                <Cell col="2" text="발송상태"/>
                <Cell col="3" text="수신자번호"/>
                <Cell col="4" text="메시지내용"/>
                <Cell col="5" text="수신일시"/>
                <Cell col="6" text="수신자"/>
                <Cell col="7" text="수신결과"/>
                <Cell col="8" text="문자종류"/>
                <Cell col="9" text="비고1"/>
                <Cell col="10" text="비고2"/>
                <Cell col="11" text="비고3"/>
                <Cell col="12" text="비고4"/>
                <Cell col="13" text="비고5"/>
              </Band>
              <Band id="body">
                <Cell celltype="head" displaytype="number" text="expr:currow+1"/>
                <Cell col="1" text="bind:SNDNG_RESVE_DT" mask="####-##-## ##:##:##"/>
                <Cell col="2" displaytype="normal" edittype="none" style="align:left middle;" text="bind:RLST_CD"/>
                <Cell col="3" text="bind:RECPTN_TELNO"/>
                <Cell col="4" style="align:left middle;" text="bind:SNDNG_CN" wordwrap="char"/>
                <Cell col="5" text="bind:SEND_DATE" mask="####-##-## ##:##:##"/>
                <Cell col="6" style="align:left middle;" text="bind:RCVER_NM"/>
                <Cell col="7" style="align:left middle;" text="bind:STS"/>
                <Cell col="8" displaytype="normal" edittype="none" text="bind:SNDNG_SVC_TY"/>
                <Cell col="9" style="align:left middle;" text="bind:CHRCTR_PREPAR_VALUE_0"/>
                <Cell col="10" style="align:left middle;" text="bind:CHRCTR_PREPAR_VALUE_1"/>
                <Cell col="11" style="align:left middle;" text="bind:CHRCTR_PREPAR_VALUE_2"/>
                <Cell col="12" style="align:left middle;" text="bind:CHRCTR_PREPAR_VALUE_3"/>
                <Cell col="13" style="align:left middle;" text="bind:CHRCTR_PREPAR_VALUE_4"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static05" taborder="4" text="15" visible="false" left="0" top="0" style="background:#1b3cd23c;align:center middle;" width="15" bottom="0"/>
        <Static id="Static02" taborder="5" text="15" visible="false" top="0" style="background:#1b3cd23c;align:center middle;" width="15" right="0" bottom="0"/>
        <Div id="div_search" taborder="8" left="15" top="298" right="15" height="33" cssclass="div_WFSA_Box" scrollbars="none">
          <Layouts>
            <Layout>
              <Static id="Static17" taborder="4" text="발송일자" cssclass="sta_WFSA_Label" left="6" top="5" height="21" width="67"/>
              <Static id="Static01" taborder="5" text="조회조건" cssclass="sta_WFSA_Label" left="325" top="6" height="21" width="70"/>
              <Combo id="cmb_dept_se" taborder="0" left="387" top="5" height="21" style="font:10 Gulim;" width="100" displayrowcount="-1" codecolumn="CODE" datacolumn="NAME" innerdataset="@ds_schCode" autoselect="false" readonly="false" index="0" value="1" text="내용"/>
              <Calendar id="cal_date1" taborder="6" dateformat="yyyy-MM-dd" left="70" top="5" width="110" height="21"/>
              <Static id="Static04" taborder="7" text="~" left="180" top="5" width="19" height="21" style="align:center middle;"/>
              <Calendar id="cal_date2" taborder="8" dateformat="yyyy-MM-dd" left="198" top="5" width="110" height="21"/>
              <Edit id="sch_txt" taborder="9" left="48.43%" top="5" right="31.24%" height="21"/>
              <Div id="div_search" taborder="10" left="23" top="303" right="8" height="33" cssclass="div_WFSA_Box">
                <Layouts>
                  <Layout>
                    <Static id="Static17" taborder="10" text="발송일자" cssclass="sta_WFSA_Label" left="6" top="5" width="67" height="21"/>
                    <Static id="Static01" taborder="11" text="조회조건" cssclass="sta_WFSA_Label" left="320" top="5" width="70" height="21"/>
                    <Combo id="cmb_dept_se" taborder="12" value="1" text="내용" innerdataset="@ds_schCode" codecolumn="CODE" datacolumn="NAME" index="0" left="382" top="5" width="100" height="21" style="font:10 Gulim;"/>
                    <Calendar id="cal_date1" taborder="13" dateformat="yyyy-MM-dd" left="70" top="5" width="110" height="21"/>
                    <Static id="Static04" taborder="14" text="~" left="182" top="5" width="19" height="21" style="align:center middle;"/>
                    <Calendar id="cal_date2" taborder="15" dateformat="yyyy-MM-dd" left="201" top="5" width="110" height="21"/>
                    <Edit id="sch_txt" taborder="16" left="49.95%" top="5" right="29.58%" height="21"/>
                  </Layout>
                </Layouts>
              </Div>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static08" taborder="9" text="15" visible="false" left="1" top="585" right="1" style="background:#dc143c3c;align:center middle;" height="15"/>
        <Static id="Static12" taborder="10" text="5" visible="false" top="40" right="15" height="5" style="background:#dc143c3c;align:center middle;" onclick="Static12_onclick" left="15"/>
        <Static id="Static11" taborder="28" cssclass="sta_WF_Labelbg" left="15" top="70" width="178" height="204"/>
        <Static id="sta_chk_size" taborder="26" text="0" left="114" top="73" width="42" height="21" style="align:right middle;"/>
        <TextArea id="txarea_con" taborder="29" left="22" top="96" width="164" height="149" scrollbars="autovert" imemode="hangul" lengthunit="ascii" maxlength="2000" style="bordertype:round 5 5 ;" onkeyup="txarea_con_onkeyup" wordwrap="char" enable="false" readonly="true" cssclass="txt_WF_Readonly"/>
        <Static id="Static13" taborder="31" text="발신번호" left="24" top="248" width="54" height="23"/>
        <Edit id="edt_telno" taborder="32" readonly="true" left="79" top="248" width="107" height="21" value="" cssclass="edt_WF_Readonly" enable="true"/>
        <Static id="sta_title00" taborder="33" text="수신자 목록" cssclass="sta_WF_Title01" left="200" top="45" width="95" height="21"/>
        <Static id="sta_title01" taborder="34" text="발송 목록" cssclass="sta_WF_Title02" left="15" top="334" width="179" height="21" style="font:bold 10 Gulim;"/>
        <Grid id="grd_smsClient" taborder="35" binddataset="ds_ums_sndng_dtls" useinputpanel="false" autofittype="col" left="200" top="70" height="180" autoenter="select" onexpandup="grd_smsClient_onexpandup" right="15" autosizingtype="row" cellsizingtype="none" onselectchanged="grd_smsClient_onselectchanged" onheadclick="grd_smsClient_onheadclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="56"/>
                <Column size="115"/>
                <Column size="80"/>
                <Column size="570"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="checkbox" edittype="checkbox" text="bind:CHK"/>
                <Cell col="1" text="순번"/>
                <Cell col="2" text="수신자번호"/>
                <Cell col="3" text="수신자"/>
                <Cell col="4" text="메시지내용"/>
              </Band>
              <Band id="body">
                <Cell celltype="head" displaytype="checkbox" edittype="checkbox" text="bind:CHK"/>
                <Cell col="1" celltype="head" edittype="none" editfilter="number" text="expr:currow+1" editlimit="11" editdisplay="edit" editlimitbymask="both" editlengthunit="utf8" expandshow="hide"/>
                <Cell col="2" edittype="normal" editfilter="number" text="bind:RECPTN_TELNO" editlimit="12" editdisplay="display" editlengthunit="utf8" expandshow="show"/>
                <Cell col="3" edittype="normal" text="bind:RCVER_NM" editlimit="20" editdisplay="display"/>
                <Cell col="4" celltype="none" style="align:left;" text="bind:SNDNG_CN" wordwrap="char" editdisplay="edit" autosizerow="limitmin"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="Button25" taborder="36" onclick="Button25_onclick" cssclass="btn_WF_Gridexcelup" top="46" width="25" height="19" left="1010" visible="false"/>
        <Button id="btn_add2" taborder="37" text="행추가" onclick="btn_add2_onclick" cssclass="btn_WF_Gridadd" top="46" width="64" height="19" left="876" visible="false"/>
        <Button id="btn_del2" taborder="38" text="행삭제" onclick="btn_del2_onclick" cssclass="btn_WF_Griddel" top="46" width="64" height="19" left="943" visible="false"/>
        <Button id="btn_init" taborder="40" text="초기화" cssclass="btn_WF_Process" top="45" right="930" width="53" height="21" onclick="btn_init_onclick" visible="false"/>
        <Button id="btn_Cre" taborder="41" text="문자발송" onclick="div_cont_btn_Cre_onclick" cssclass="btn_WF_Process" top="45" width="66" height="21" enable="false" left="126"/>
        <Static id="Static15" taborder="50" text="5" visible="false" top="351" right="15" height="5" style="background:#dc143c3c;align:center middle;" left="15"/>
        <Static id="Static17" taborder="51" text="5" visible="false" top="331" right="15" height="5" style="background:#dc143c3c;align:center middle;" left="15"/>
        <Static id="Static18" taborder="52" text="5" visible="false" top="293" right="15" height="5" style="background:#dc143c3c;align:center middle;" left="15"/>
        <Static id="sta_title02" taborder="53" text="문자 발송 조회" cssclass="sta_WF_Title01" left="15" top="277" width="179" height="21"/>
        <Static id="sta_con_size" taborder="54" text="Byte" left="162" top="73" width="27" height="21" style="align:left middle;"/>
        <Static id="Static19" taborder="56" text="5" visible="false" top="65" right="15" height="5" style="background:#dc143c3c;align:center middle;" left="15"/>
        <Button id="btn_Search" taborder="57" text="조회" onclick="btn_Search_onclick" cssclass="btn_WF_Process" top="304" right="288" width="40" height="21"/>
        <Static id="Static03" taborder="59" text="5" visible="false" top="274" right="15" height="5" style="background:#dc143c3c;align:center middle;" left="15"/>
        <Static id="Static06" taborder="62" text="15" visible="false" left="15" top="0" right="15" height="15" style="background:#dc143c3c;align:center middle;"/>
        <Button id="btn_Close" taborder="63" text="종료" onclick="btn_Close_onclick" cssclass="btn_WF_CRUD" top="15" right="15" width="50" height="25"/>
        <Static id="Static00" taborder="64" text="맞춤문자의 경우 화면마다 메시지 형식이 정해져 있습니다. 맞춤문자 등록, 수정은 운영팀에 문의하여 주시기 바랍니다." left="206" top="251" right="15" height="23" enable="false" style=":disabled {color:#333333ff;}"/>
        <Static id="sta_title03" taborder="65" text="SMS 발송" cssclass="sta_WF_Title01" left="15" top="18" width="95" height="21"/>
        <Static id="sta_title04" taborder="66" text="※ 체크박스를 선택한 대상만 전송합니다." cssclass="sta_WF_Title01" left="300" top="45" width="300" height="21" style="background:left middle;padding:0 0 0 0;font:9 Gulim;"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cond" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_mssageManage" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="SYS_SE_CODE" type="STRING" size="256"/>
          <Column id="MSSAGE_ID" type="STRING" size="256"/>
          <Column id="MSSAGE_SE" type="STRING" size="256"/>
          <Column id="MSSAGE_CN" type="STRING" size="256"/>
          <Column id="MXTR_WRD0" type="STRING" size="256"/>
          <Column id="MXTR_WRD1" type="STRING" size="256"/>
          <Column id="MXTR_WRD2" type="STRING" size="256"/>
          <Column id="MXTR_WRD3" type="STRING" size="256"/>
          <Column id="MXTR_WRD4" type="STRING" size="256"/>
          <Column id="RESVE_AT" type="STRING" size="256"/>
          <Column id="RESVE_HM" type="STRING" size="256"/>
          <Column id="SNDNG_CLOS_HM" type="STRING" size="256"/>
          <Column id="RM" type="STRING" size="256"/>
          <Column id="USE_AT" type="STRING" size="256"/>
          <Column id="REGIST_DT" type="STRING" size="256"/>
          <Column id="REGISTER_ID" type="STRING" size="256"/>
          <Column id="TYPE" type="STRING" size="1"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond00" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="APPLC_DE" type="STRING" size="256"/>
          <Column id="APPLC_DE2" type="STRING" size="256"/>
          <Column id="EMPNO" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="SCH_TYPE" type="STRING" size="256"/>
          <Column id="REGISTER_ID" type="STRING" size="256"/>
          <Column id="RECPTN_TELNO" type="STRING" size="256"/>
          <Column id="RCVER_NM" type="STRING" size="256"/>
          <Column id="SNDNG_SVC_TY" type="STRING" size="256"/>
          <Column id="SNDNG_CN" type="STRING" size="256"/>
          <Column id="RSLT_CD" type="STRING" size="256"/>
          <Column id="STS" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_validation" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="compId" type="STRING" size="256"/>
          <Column id="colId" type="STRING" size="256"/>
          <Column id="PK" type="STRING" size="256"/>
          <Column id="notNull" type="STRING" size="256"/>
          <Column id="type" type="STRING" size="256"/>
          <Column id="nlength" type="STRING" size="256"/>
          <Column id="from" type="STRING" size="256"/>
          <Column id="to" type="STRING" size="256"/>
          <Column id="lengthChkGb" type="STRING" size="256"/>
          <Column id="msgId" type="STRING" size="256"/>
          <Column id="expr" type="STRING" size="256"/>
          <Column id="func" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="compId">ds_smsClient</Col>
            <Col id="PK">Y</Col>
            <Col id="colId">RECIPIENT_NUM</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">수신번호</Col>
          </Row>
          <Row>
            <Col id="compId">ds_smsTran</Col>
            <Col id="colId">CONTENT</Col>
            <Col id="msgId">전송 메시지</Col>
            <Col id="notNull">Y</Col>
          </Row>
          <Row>
            <Col id="compId">ds_smsTran</Col>
            <Col id="colId">CALLBACK</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">발신번호</Col>
          </Row>
          <Row>
            <Col id="compId">ds_cond00</Col>
            <Col id="colId">APPLC_DE</Col>
            <Col id="to">APPLC_DE2</Col>
            <Col id="msgId">발송일자</Col>
          </Row>
          <Row>
            <Col id="compId">ds_cond00</Col>
            <Col id="colId">DEPT_CODE</Col>
            <Col id="msgId">부서명</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_smsLog" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="SNDNG_SVC_TY" type="STRING" size="256"/>
          <Column id="RECPTN_TELNO" type="STRING" size="256"/>
          <Column id="SNDNG_RESVE_DT" type="STRING" size="256"/>
          <Column id="MSSAGE_TY" type="STRING" size="256"/>
          <Column id="SNDNG_CN" type="STRING" size="256"/>
          <Column id="RCVER_NM" type="STRING" size="256"/>
          <Column id="CHRCTR_PREPAR_VALUE_0" type="STRING" size="256"/>
          <Column id="CHRCTR_PREPAR_VALUE_1" type="STRING" size="256"/>
          <Column id="CHRCTR_PREPAR_VALUE_2" type="STRING" size="256"/>
          <Column id="CHRCTR_PREPAR_VALUE_3" type="STRING" size="256"/>
          <Column id="CHRCTR_PREPAR_VALUE_4" type="STRING" size="256"/>
          <Column id="SEND_DATE" type="STRING" size="256"/>
          <Column id="STS" type="STRING" size="256"/>
          <Column id="REGIST_DT" type="STRING" size="256"/>
          <Column id="RLST_CD" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_import" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="Column0" type="STRING" size="256"/>
          <Column id="Column1" type="STRING" size="256"/>
          <Column id="Column2" type="STRING" size="256"/>
          <Column id="Column3" type="STRING" size="256"/>
          <Column id="Column4" type="STRING" size="256"/>
          <Column id="Column5" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_schCode" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="NAME" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">1</Col>
            <Col id="NAME">내용</Col>
          </Row>
          <Row>
            <Col id="CODE">3</Col>
            <Col id="NAME">수신번호</Col>
          </Row>
          <Row>
            <Col id="CODE">5</Col>
            <Col id="NAME">수신자</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_smsStatus" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="name" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="code">1</Col>
            <Col id="name">전송대기</Col>
          </Row>
          <Row>
            <Col id="code">2</Col>
            <Col id="name">결과대기</Col>
          </Row>
          <Row>
            <Col id="code">3</Col>
            <Col id="name">완료</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_rentHouseSmsSendList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="JOB_SE" type="STRING" size="256"/>
          <Column id="HOUSE_CODE" type="STRING" size="256"/>
          <Column id="HOUSE_NM" type="STRING" size="256"/>
          <Column id="DONG" type="STRING" size="256"/>
          <Column id="HO" type="STRING" size="256"/>
          <Column id="LOT_TY" type="STRING" size="256"/>
          <Column id="CNTRCTR_NO" type="STRING" size="256"/>
          <Column id="NM" type="STRING" size="256"/>
          <Column id="MBTLNO" type="STRING" size="256"/>
          <Column id="GUIDANCE_TY" type="STRING" size="256"/>
          <Column id="SNDNG_DT" type="STRING" size="256"/>
          <Column id="SNDNG_DTLS" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_smsMsgMng">
        <ColumnInfo>
          <Column id="CHANGE_WORD0" type="STRING" size="256"/>
          <Column id="CHANGE_WORD1" type="STRING" size="256"/>
          <Column id="CHANGE_WORD2" type="STRING" size="256"/>
          <Column id="CHANGE_WORD3" type="STRING" size="256"/>
          <Column id="CHANGE_WORD4" type="STRING" size="256"/>
          <Column id="CHANGE_CNT" type="STRING" size="256" description="설정된 맞춤문자 갯수"/>
          <Column id="CONTENT_TRANS" type="STRING" size="256"/>
          <Column id="CONTENT_ORIGIN" type="STRING" size="256"/>
          <Column id="BROAD_MSSAGE_ID" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CHANGE_WORD0">① 조합단어</Col>
            <Col id="CHANGE_WORD1">② 조합단어</Col>
            <Col id="CHANGE_WORD2">③ 조합단어</Col>
            <Col id="CHANGE_WORD3">④ 조합단어</Col>
            <Col id="CHANGE_WORD4">⑤ 조합단어</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_ums_sndng_dtls" oncolumnchanged="ds_ums_sndng_dtls_oncolumnchanged">
        <ColumnInfo>
          <Column id="SNDNG_ID" type="STRING" size="11" description="발송ID"/>
          <Column id="SNDNG_SVC_TY" type="STRING" size="1" description="발송서비스타입"/>
          <Column id="DEPT_CODE" type="STRING" size="6" description="부서코드"/>
          <Column id="RECPTN_TELNO" type="STRING" size="12" description="수신전화번호"/>
          <Column id="SNDNG_TELNO" type="STRING" size="12" description="발송전화번호"/>
          <Column id="SNDNG_RESVE_DT" type="STRING" size="16" description="발송예약일시"/>
          <Column id="MSSAGE_TY" type="STRING" size="2" description="메시지타입"/>
          <Column id="MMS_SJ" type="STRING" size="120" description="MMS제목"/>
          <Column id="SNDNG_CN" type="STRING" size="4000" description="발송내용"/>
          <Column id="SNDNG_SESION_ID" type="STRING" size="20" description="발송세션ID"/>
          <Column id="UMS_SENDER_ID" type="STRING" size="12" description="수신자명"/>
          <Column id="RCVER_NM" type="STRING" size="30" description="수신자명"/>
          <Column id="CHANGE_WRD1" type="STRING" size="30" description="변경단어1"/>
          <Column id="CHANGE_WRD2" type="STRING" size="30" description="변경단어2"/>
          <Column id="CHANGE_WRD3" type="STRING" size="30" description="변경단어3"/>
          <Column id="CHANGE_WRD4" type="STRING" size="30" description="변경단어4"/>
          <Column id="CHANGE_WRD5" type="STRING" size="30" description="변경단어5"/>
          <Column id="FILE_SN" type="STRING" size="20" description="파일일련번호"/>
          <Column id="REGISTER_ID" type="STRING" size="12" description="등록자ID"/>
          <Column id="REGIST_DT" type="STRING" size="16" description="등록일시"/>
          <Column id="UPDUSR_ID" type="STRING" size="12" description="수정자ID"/>
          <Column id="UPDT_DT" type="STRING" size="16" description="수정일시"/>
          <Column id="RESERVE_SNDNG_AT" type="STRING" size="1" description="예약발송여부"/>
          <Column id="CHRCTR_PREPAR_VALUE_0" type="STRING" size="100" description="문자예비값0"/>
          <Column id="CHRCTR_PREPAR_VALUE_1" type="STRING" size="100" description="문자예비값1"/>
          <Column id="CHRCTR_PREPAR_VALUE_2" type="STRING" size="100" description="문자예비값2"/>
          <Column id="CHRCTR_PREPAR_VALUE_3" type="STRING" size="100" description="문자예비값3"/>
          <Column id="CHRCTR_PREPAR_VALUE_4" type="STRING" size="100" description="문자예비값4"/>
          <Column id="BROAD_MSSAGE_ID" type="STRING" size="10" description="동보메시지ID"/>
          <Column id="CHK" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ums_sndng_dtls_target">
        <ColumnInfo>
          <Column id="SNDNG_ID" type="STRING" size="11" description="발송ID"/>
          <Column id="SNDNG_SVC_TY" type="STRING" size="1" description="발송서비스타입"/>
          <Column id="DEPT_CODE" type="STRING" size="6" description="부서코드"/>
          <Column id="RECPTN_TELNO" type="STRING" size="12" description="수신전화번호"/>
          <Column id="SNDNG_TELNO" type="STRING" size="12" description="발송전화번호"/>
          <Column id="SNDNG_RESVE_DT" type="STRING" size="16" description="발송예약일시"/>
          <Column id="MSSAGE_TY" type="STRING" size="2" description="메시지타입"/>
          <Column id="MMS_SJ" type="STRING" size="120" description="MMS제목"/>
          <Column id="SNDNG_CN" type="STRING" size="4000" description="발송내용"/>
          <Column id="SNDNG_SESION_ID" type="STRING" size="20" description="발송세션ID"/>
          <Column id="UMS_SENDER_ID" type="STRING" size="12" description="수신자명"/>
          <Column id="RCVER_NM" type="STRING" size="30" description="수신자명"/>
          <Column id="CHANGE_WRD1" type="STRING" size="30" description="변경단어1"/>
          <Column id="CHANGE_WRD2" type="STRING" size="30" description="변경단어2"/>
          <Column id="CHANGE_WRD3" type="STRING" size="30" description="변경단어3"/>
          <Column id="CHANGE_WRD4" type="STRING" size="30" description="변경단어4"/>
          <Column id="CHANGE_WRD5" type="STRING" size="30" description="변경단어5"/>
          <Column id="FILE_SN" type="STRING" size="20" description="파일일련번호"/>
          <Column id="REGISTER_ID" type="STRING" size="12" description="등록자ID"/>
          <Column id="REGIST_DT" type="STRING" size="16" description="등록일시"/>
          <Column id="UPDUSR_ID" type="STRING" size="12" description="수정자ID"/>
          <Column id="UPDT_DT" type="STRING" size="16" description="수정일시"/>
          <Column id="RESERVE_SNDNG_AT" type="STRING" size="1" description="예약발송여부"/>
          <Column id="CHRCTR_PREPAR_VALUE_0" type="STRING" size="100" description="문자예비값0"/>
          <Column id="CHRCTR_PREPAR_VALUE_1" type="STRING" size="100" description="문자예비값1"/>
          <Column id="CHRCTR_PREPAR_VALUE_2" type="STRING" size="100" description="문자예비값2"/>
          <Column id="CHRCTR_PREPAR_VALUE_3" type="STRING" size="100" description="문자예비값3"/>
          <Column id="CHRCTR_PREPAR_VALUE_4" type="STRING" size="100" description="문자예비값4"/>
          <Column id="BROAD_MSSAGE_ID" type="STRING" size="10" description="동보메시지ID"/>
          <Column id="CHK" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <!--Bind>
      <BindItem id="item1" compid="txarea_con" propid="value" datasetid="ds_ums_sndng_dtls" columnid="SNDNG_CN"/>
    </Bind-->
    <Script type="xscript5.0"><![CDATA[/***********************************************************************
 * 01. 업무구분 : SMS발신관리
 * 02. 화면명   : COM010700_P01.xfdl
 * 03. 화면설명 : SMS발신을 관리한다.
 * 04. 작성일   : 2016.03.14
 * 05. 작성자   : 이동석
 * 06. 수정이력 : 2016.03.14 최초생성
 ***********************************************************************
 *     수정일     작성자   내용
 ***********************************************************************
 *    2016.03.11   이동석   최초
 ***********************************************************************
 */

/***********************************************************************
 * Script Include 
 ************************************************************************/
include "lib::comInclude.xjs";

var deptcd = this.gfn_getDeptId();
var bFixedSMS = true;
 
/***********************************************************************
 * Form oninit and onload
 ***********************************************************************/
this.COM010700_P01_oninit = function(obj:Form, e:nexacro.InitEventInfo){
	this.gfn_initForm();						//Form 오브젝트 초기화
	this.gfn_initCondDs(this, this.div_search);	//Dataset 오브젝트 초기화
} 
    
this.COM010700_P01_onload = function(obj:Form, e:nexacro.LoadEventInfo){
	this.div_search.cal_date1.set_value(this.dateUtils.format(this.gfn_today(),"yyyymmdd"));
	this.div_search.cal_date2.set_value(this.dateUtils.format(this.gfn_today(),"yyyymmdd"));
	
	// 부서리스트 조회 
	this.edt_telno.set_value("0533500301");
	this.txarea_con.set_enable(true);
	this.btn_Cre.set_enable(true);
	
	if(this.parent.JOB_SE!=undefined
		&& this.parent.JOB_SE!=""
		&& this.parent.JOB_SE.length==6){
		//맞춤문자인경우
		this.fn_transaction("selMssageManage");
	}else{
		//맞춤문자가 아닌경우
		this.txarea_con.set_readonly(false);
		this.txarea_con.set_cssclass("");
		this.btn_init.set_visible(true);
		this.btn_add2.set_visible(true);
		this.btn_del2.set_visible(true);
		this.Button25.set_visible(true);
		bFixedSMS = false;
		
		//수신자리스트 
		this.ds_ums_sndng_dtls.clearData();
		this.grd_smsClient.set_enableevent(false);
		this.ds_ums_sndng_dtls.set_enableevent(false);
		
		this.grd_smsClient.setCellProperty("head", 0, "text", '1');
		for(var i=0,j=this.parent.ds.rowcount; i<j; i++){
			this.ds_ums_sndng_dtls.addRow();
			var telNo = this.parent.ds.getColumn(i,"MBTLNO");
			if(telNo!=undefined){
				telNo = telNo.replace(/\-/gi,"");
			}
			this.ds_ums_sndng_dtls.setColumn(i,"CHK", 1);
			
			this.ds_ums_sndng_dtls.setColumn(i,"RECPTN_TELNO",telNo);							//수신번호
			this.ds_ums_sndng_dtls.setColumn(i,"RCVER_NM",this.parent.ds.getColumn(i,"NM"));	//수신자명
		}
		this.ds_ums_sndng_dtls.set_enableevent(true);
		this.grd_smsClient.set_enableevent(true);
		if(this.parent.ds.rowcount>0) this.grd_smsClient.selectRow(0);
	}
}

/**********************************************************************
 * TRANSACTION
 **********************************************************************/ 
this.fn_transaction = function(strSvcId){
	var sController   	= "";
	var sInDatasets   	= ""
	var sOutDatasets  	= "";
	var bSync  = true;
			
	switch (strSvcId) {
	    case "selectSmstranList": 
			sController   	= "hsco/cmm/ums/selectSmstranList.do";
			sInDatasets   	= "input1=ds_cond00"
			sOutDatasets  	= "ds_smsLog=output1";
			break;		
		case "saveSmstranList":	
			sController   	= "hsco/cmm/ums/sendUms.do";	
			sInDatasets   	= "input1=ds_ums_sndng_dtls_target";
			sOutDatasets  	= "";
			break;	
		case "delSmsclientList":	 
			sController   	= "hsco/cmm/ums/SmstranC_D.do";	
			sInDatasets   	= "input1=ds_smsLog:U";
			sOutDatasets  	= "";
			break;
		case "selMssageManage":		//맞춤문자조회
			this.ds_cond.clearData();
			if(this.ds_cond.rowcount==0) this.ds_cond.addRow();
			this.ds_cond.setColumn(0,"CODE",this.parent.JOB_SE);
			this.ds_mssageManage.clearData();
			sController   	= "hsco/cmm/ums/mssageManageList.do";
			sInDatasets   	= "input1=ds_cond";
			sOutDatasets  	= "ds_mssageManage=output1";
			bSync = false;
			break;
	}  

	//Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets); 
	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets, "", "fn_callBack", null, bSync);
}

this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg){ 
	// 오류 및 성공 메시지를 화면에 보여준다.
	if (nErrorCode != 0){
		this.gfn_callback_message(strSvcId, nErrorCode, strErrorMsg);	
	} else {		
	    
		switch (strSvcId) {
		    case "selectSmstranList": 		    	 
				break;
			case "saveSmstranList": 
			    this.gfn_message("info.처리불가","문자가 발송되었습니다.");
			    
			    this.ds_ums_sndng_dtls.clearData();
				this.btn_Search_onclick();
				break;				
			case "delSmsclientList":			    
				break;
			case "selMssageManage":
				// 맞춤문자형식이 복수인경우 알림 후 종료
				// 맞춤문자형식이 없는경우 알림 후 종료
				if(this.ds_mssageManage.rowcount>1){
					this.gfn_message("info.처리불가","맞춤문자 형식이 복수개로 처리가 불가능합니다.\n운영팀에 문의하여 주시기 바랍니다.","","",function(){this.close();});
				}
				if(this.ds_mssageManage.rowcount==0){
					this.gfn_message("info.처리불가","맞춤문자 형식이 존재하지 않아 처리가 불가능합니다.\n운영팀에 문의하여 주시기 바랍니다.","","",function(){this.close();});
				}
				
				//수신자리스트 
				this.ds_ums_sndng_dtls.clearData();
				
				this.grd_smsClient.set_enableevent(false);
				this.ds_ums_sndng_dtls.set_enableevent(false);
				this.grd_smsClient.setCellProperty("head", 0, "text", '1');
				for(var i=0,j=this.parent.ds.rowcount; i<j; i++){
					this.ds_ums_sndng_dtls.addRow();
					var content = this.ds_mssageManage.getColumn(0,"MSSAGE_CN");
					var telNo = this.parent.ds.getColumn(i,"MBTLNO");
					if(telNo!=undefined){
						telNo = telNo.replace(/\-/gi,"");
					}
					
					this.ds_ums_sndng_dtls.setColumn(i,"CHK", 1);
					this.ds_ums_sndng_dtls.setColumn(i,"RECPTN_TELNO",telNo);															//수신번호
					this.ds_ums_sndng_dtls.setColumn(i,"RCVER_NM",this.parent.ds.getColumn(i,"NM"));									//수신자명
					this.ds_ums_sndng_dtls.setColumn(i,"CHANGE_WRD1",this.parent.ds.getColumn(i,"CHANGE_WORD0"));						//맞춤단어1 값
					this.ds_ums_sndng_dtls.setColumn(i,"CHANGE_WRD2",this.parent.ds.getColumn(i,"CHANGE_WORD1"));						//맞춤단어2 값
					this.ds_ums_sndng_dtls.setColumn(i,"CHANGE_WRD3",this.parent.ds.getColumn(i,"CHANGE_WORD2"));						//맞춤단어3 값
					this.ds_ums_sndng_dtls.setColumn(i,"CHANGE_WRD4",this.parent.ds.getColumn(i,"CHANGE_WORD3"));						//맞춤단어4 값
					this.ds_ums_sndng_dtls.setColumn(i,"CHANGE_WRD5",this.parent.ds.getColumn(i,"CHANGE_WORD4"));						//맞춤단어5 값
					this.ds_ums_sndng_dtls.setColumn(i,"CHRCTR_PREPAR_VALUE_0",this.parent.ds.getColumn(i,"CHRCTR_PREPAR_VALUE_0"));	//문자예비값0
					this.ds_ums_sndng_dtls.setColumn(i,"CHRCTR_PREPAR_VALUE_1",this.parent.ds.getColumn(i,"CHRCTR_PREPAR_VALUE_1"));	//문자예비값1
					this.ds_ums_sndng_dtls.setColumn(i,"CHRCTR_PREPAR_VALUE_2",this.parent.ds.getColumn(i,"CHRCTR_PREPAR_VALUE_2"));	//문자예비값2
					this.ds_ums_sndng_dtls.setColumn(i,"CHRCTR_PREPAR_VALUE_3",this.parent.ds.getColumn(i,"CHRCTR_PREPAR_VALUE_3"));	//문자예비값3
					this.ds_ums_sndng_dtls.setColumn(i,"CHRCTR_PREPAR_VALUE_4",this.parent.ds.getColumn(i,"CHRCTR_PREPAR_VALUE_4"));	//문자예비값4
					
					if(this.ds_ums_sndng_dtls.getColumn(i,"CHANGE_WRD1") != undefined
						&& this.ds_ums_sndng_dtls.getColumn(i,"CHANGE_WRD1").indexOf("undefined")==-1
						&& this.ds_ums_sndng_dtls.getColumn(i,"CHANGE_WRD1") != ""){
						content = content.split("%CHANGEWORD1%").join(this.ds_ums_sndng_dtls.getColumn(i,"CHANGE_WRD1"));
					}
					if(this.ds_ums_sndng_dtls.getColumn(i,"CHANGE_WRD2") != undefined
						&& this.ds_ums_sndng_dtls.getColumn(i,"CHANGE_WRD2").indexOf("undefined")==-1
						&& this.ds_ums_sndng_dtls.getColumn(i,"CHANGE_WRD2") != ""){ 
						content = content.split("%CHANGEWORD2%").join(this.ds_ums_sndng_dtls.getColumn(i,"CHANGE_WRD2"));
					}
					if(this.ds_ums_sndng_dtls.getColumn(i,"CHANGE_WRD3") != undefined
						&& this.ds_ums_sndng_dtls.getColumn(i,"CHANGE_WRD3").indexOf("undefined")==-1
						&& this.ds_ums_sndng_dtls.getColumn(i,"CHANGE_WRD3") != ""){ 
						content = content.split("%CHANGEWORD3%").join(this.ds_ums_sndng_dtls.getColumn(i,"CHANGE_WRD3"));
					}
					if(this.ds_ums_sndng_dtls.getColumn(i,"CHANGE_WRD4") != undefined 
						&& this.ds_ums_sndng_dtls.getColumn(i,"CHANGE_WRD4").indexOf("undefined")==-1
						&& this.ds_ums_sndng_dtls.getColumn(i,"CHANGE_WRD4") != ""){ 
						content = content.split("%CHANGEWORD4%").join(this.ds_ums_sndng_dtls.getColumn(i,"CHANGE_WRD4"));
					}
					if(this.ds_ums_sndng_dtls.getColumn(i,"CHANGE_WRD5") != undefined
						&& this.ds_ums_sndng_dtls.getColumn(i,"CHANGE_WRD5").indexOf("undefined")==-1
						&& this.ds_ums_sndng_dtls.getColumn(i,"CHANGE_WRD5") != ""){ 
						content = content.split("%CHANGEWORD5%").join(this.ds_ums_sndng_dtls.getColumn(i,"CHANGE_WRD5"));
					}
					
					this.ds_ums_sndng_dtls.setColumn(i, "SNDNG_CN", content);							//발송내용
				}
				this.ds_ums_sndng_dtls.set_enableevent(true);
				this.grd_smsClient.set_enableevent(true);
				this.grd_smsClient.selectRow(0);
				this.grd_smsClient_onselectchanged();
				break;
		}
	}
}

// 문자발송
this.div_cont_btn_Cre_onclick = function(obj:Button,  e:nexacro.ClickEventInfo){
    for(var i=0,j=this.ds_ums_sndng_dtls.rowcount; i<j; i++){
		var content = this.ds_ums_sndng_dtls.getColumn(i, "SNDNG_CN");
		if(content.indexOf("CHANGEWORD")>-1){
			for(var k=0; k<5; k++){
				if(content.indexOf("CHANGEWORD"+(k+1))>-1){
					var mxtrWrd = this.ds_mssageManage.getColumn(0,"MXTR_WRD"+k);
					this.gfn_message("info.처리불가", (i+1)+"행의 ("+mxtrWrd+") 항목이 누락되어\n메시지 전송이 불가능합니다.\n운영팀에 문의하여 주시기 바랍니다."); 
					return;
				}
			}
		}
		
		var RECPTN_TELNO = this.ds_ums_sndng_dtls.getColumn(i, "RECPTN_TELNO");	//수신번호 검증
		/*if(RECPTN_TELNO==undefined
			|| RECPTN_TELNO=="undefined"
			|| RECPTN_TELNO==""){
			this.gfn_message("info.처리불가", (i+1)+"행의 수신자번호 항목이 누락되어\n메시지 전송이 불가능합니다."); 
			return;
		}*/
		
		//추가 필수입력값 설정
		var nMsgSize = this.comUtils.getBytes(content, "EUC-KR");
 		var sndng_svc_ty = "S";//문자전송 구분값 : 0(SMS), 2(MMS) 
		if (nMsgSize > 80) sndng_svc_ty = "M";//80byte 이상일 경우 MMS
		this.ds_ums_sndng_dtls.setColumn(i, "SNDNG_SVC_TY",	sndng_svc_ty);					//발송서비스타입
		this.ds_ums_sndng_dtls.setColumn(i, "RESERVE_SNDNG_AT", "N");						//예약발송여부
		this.ds_ums_sndng_dtls.setColumn(i, "DEPT_CODE",deptcd);							//부서코드
		this.ds_ums_sndng_dtls.setColumn(i, "SNDNG_TELNO",this.edt_telno.value);			//발송전화번호
		this.ds_ums_sndng_dtls.setColumn(i, "MSSAGE_TY", "0");								//메시지타입 
		this.ds_ums_sndng_dtls.setColumn(i, "SNDNG_SENDER_ID", application.gv_userId);		//UMS발송자ID
		this.ds_ums_sndng_dtls.setColumn(i, "BROAD_MSSAGE_ID", this.ds_mssageManage.getColumn(0,"MSSAGE_ID"));	//동보메시지ID
		this.ds_ums_sndng_dtls.setColumn(i, "REGISTER_ID", application.gv_userId);			//등록자ID
		this.ds_ums_sndng_dtls.setColumn(i, "UPDUSR_ID", application.gv_userId);			//수정자ID
		
		var subject = ""; 
		if( sndng_svc_ty == "M" ){//MMS의 경우
			 subject = content.substr(0,20);			 
		}
		this.ds_ums_sndng_dtls.setColumn(i, "MMS_SJ",subject);//MMS제목		
    }
    
    this.ds_ums_sndng_dtls_target.clearData();
	for(var i = 0 ; i < this.ds_ums_sndng_dtls.rowcount ; i++){
		if( this.ds_ums_sndng_dtls.getColumn(i,"CHK") == 1 ){
			var nRow = this.ds_ums_sndng_dtls_target.addRow();
			this.ds_ums_sndng_dtls_target.copyRow(nRow, this.ds_ums_sndng_dtls, i);
		}
	}
	
	if(this.ds_ums_sndng_dtls_target.rowcount == 0){
		this.gfn_message("comm.err","문자발송 대상을 선택해 주시기 바랍니다.");
		return;
	}
	
    if(this.gfn_message("comm.행위여부","문자를 발송")){
	    this.fn_transaction("saveSmstranList");
    }
}

/***********************************************************************
 * SMS Display event Handler
 ***********************************************************************/ 
// keyup event
this.txarea_con_onkeyup = function(obj:TextArea, e:nexacro.KeyEventInfo){
	this.sta_chk_size.set_text(this.txarea_con.getLength("ascii"));
	
	//맞춤문자가 아닌경우에만 이벤트 처리
	if(!bFixedSMS){
		var content = this.txarea_con.text;
		this.grd_smsClient.set_enableevent(false);
		if(this.txarea_con.text.length==0
			|| (e!=undefined && e.ctrlKey && e.keycode==86) ) this.ds_ums_sndng_dtls.set_enableevent(false);
		for(var i=0,j=this.ds_ums_sndng_dtls.rowcount; i<j; i++){
			if( this.ds_ums_sndng_dtls.getColumn(i,"CHK") == 1 ){
				this.ds_ums_sndng_dtls.setColumn(i,"SNDNG_CN", content);
			}
		}
		if(this.txarea_con.text.length==0
			|| (e!=undefined && e.ctrlKey && e.keycode==86) ) this.ds_ums_sndng_dtls.set_enableevent(true);
		this.grd_smsClient.set_enableevent(true);
		
		if(this.txarea_con.text.length==0) this.txarea_con.setCaretPos(0);
	}
}

// 초기화 event
this.btn_init_onclick = function(obj:Button,  e:nexacro.ClickEventInfo){
	this.txarea_con.set_value("");
	this.txarea_con_onkeyup();
}

/***********************************************************************
 * 수신자목록 Grid & Dataset event Handler
 ***********************************************************************/
//Grid onselectchanged Event
this.grd_smsClient_onselectchanged = function(obj:Grid, e:nexacro.GridSelectEventInfo){
	if(bFixedSMS){ //맞춤문자인경우만 메시지내용을 화면에 보여줌
		this.txarea_con.set_value(this.ds_ums_sndng_dtls.getColumn(this.ds_ums_sndng_dtls.rowposition, "SNDNG_CN"));
		this.txarea_con_onkeyup();
	}
}

//수신자정보 찾기
this.grd_smsClient_onexpandup = function(obj:Grid, e:nexacro.GridMouseEventInfo){
	if(e.col == '1') {
		var parm = {
		arg_0 : this
		};
		 
		var fn_callback = function(sPopupId, sReturn) {
			var dataset = new Dataset();
			nRowCnt = dataset.loadXML(sReturn);
			if(nRowCnt){
				var nRow = this.ds_ums_sndng_dtls.rowposition;
				var telNo = dataset.getColumn(0, "TELNO_2");
				var regExp = /\-/g;
				telNo = telNo.replace(regExp, '');
				regExp = /\s/g;
				telNo = telNo.replace(regExp, '');
				this.ds_ums_sndng_dtls.setColumn(nRow, "RCVER_NM", dataset.getColumn(0, "EMPNM"));
				this.ds_ums_sndng_dtls.setColumn(nRow, "RECPTN_TELNO", telNo);
			}
		};
		
		this.gfn_popup("empPop", 400, 400, "사원조회팝업", parm, "com::empno_P01.xfdl", fn_callback, true);
	} 
}

//행추가
this.btn_add2_onclick = function(obj:Button,  e:nexacro.ClickEventInfo){
	var rowpos = this.ds_ums_sndng_dtls.addRow();
	this.grd_smsClient.setFocus();
	this.grd_smsClient.setCellPos(2);
	this.ds_ums_sndng_dtls.setColumn(rowpos, "CHK", 1);
	this.ds_ums_sndng_dtls.setColumn(rowpos, "SNDNG_CN", this.txarea_con.text);
}
 
//행삭제
this.btn_del2_onclick = function(obj:Button,  e:nexacro.ClickEventInfo){
	if(this.ds_ums_sndng_dtls.getRowCount() > 0) {
		if ( this.gfn_message("confirm.삭제여부")) {
			var nRow = this.ds_ums_sndng_dtls.rowposition;
			this.ds_ums_sndng_dtls.deleteRow(nRow);
		}
	}
}
 
//엑셀파일 업로드
this.Button25_onclick = function(obj:Button,  e:nexacro.ClickEventInfo){
	this.ds_ums_sndng_dtls.clearData();
	var arg = {
		targetDs : this.ds_import,
		headSet : false,
		callBack : this.excelImport_callBack
	};	
	this.gfn_importExcel(arg);
}

//엑셀파일 업로드 콜백
this.excelImport_callBack = function(){
	var startRow = 1;
	if(this.ds_import.rowcount >= 1){
		var nRow;
			
		// 첫행이 타이틀이아닌경우 (전화번호인경우)
		if( this.ds_import.getColumn(i, "Column0")!=undefined
			&& this.comUtils.isPhone("HP_NO",(this.ds_import.getColumn(0, "Column0")).replace(/\-/g, "")) ){
			startRow = 0;
		}
		
		//this.ds_ums_sndng_dtls.set_updatecontrol(false);
		this.grd_smsClient.set_enableevent(false);
		this.ds_ums_sndng_dtls.set_enableevent(false);
		var content = this.txarea_con.text;
		for(var i=startRow; i< this.ds_import.rowcount; i++) {
			// 전화번호확인
			var telno = this.ds_import.getColumn(i, "Column0");
			if(telno==undefined || telno=="") break;
			var telno2 = telno.replace(/\-/g, "");
			
			nRow = this.ds_ums_sndng_dtls.addRow();
			this.ds_ums_sndng_dtls.setColumn(nRow, "RECPTN_TELNO", telno2);	
			this.ds_ums_sndng_dtls.setColumn(nRow, "RCVER_NM", this.ds_import.getColumn(i, "Column1"));	
			this.ds_ums_sndng_dtls.setColumn(nRow, "SNDNG_CN", content);	
			//this.ds_ums_sndng_dtls.setRowType(nRow,"I");
		}
		this.ds_ums_sndng_dtls.set_enableevent(true);
		this.grd_smsClient.set_enableevent(true);
		//this.ds_ums_sndng_dtls.set_updatecontrol(true);
	}
}

/***********************************************************************
 * 발송내역조회
 ***********************************************************************/ 
this.btn_Search_onclick = function(obj:Button,  e:nexacro.ClickEventInfo){
	this.fn_sendList();
}

this.fn_sendList = function(){	
	// 초기화
	this.ds_smsLog.clearData();
	
	// 조회조건 	 
	this.ds_cond00.clearData();              
	var nRow = this.ds_cond00.addRow();      
	this.ds_cond00.setColumn(nRow,"APPLC_DE",this.div_search.cal_date1.value);         
	this.ds_cond00.setColumn(nRow,"APPLC_DE2",this.div_search.cal_date2.value);    
	//this.ds_cond00.setColumn(nRow,"DEPT_CODE",this.div_search.cmb_dept_se.value);
	this.ds_cond00.setColumn(nRow,"SCH_TYPE",this.div_search.cmb_dept_se.value);
	this.ds_cond00.setColumn(nRow,"REGISTER_ID",application.gv_userId);	
	
	if(this.div_search.cmb_dept_se.value == "1"){	
	    this.ds_cond00.setColumn(nRow,"SNDNG_CN",this.div_search.sch_txt.value);
	}else if(this.div_search.cmb_dept_se.value == "2"){
	    this.ds_cond00.setColumn(nRow,"STS",this.div_search.sch_txt.value);
	}else if(this.div_search.cmb_dept_se.value == "3"){
	    this.ds_cond00.setColumn(nRow,"RECPTN_TELNO",this.div_search.sch_txt.value);
	}else if(this.div_search.cmb_dept_se.value == "4"){
	    this.ds_cond00.setColumn(nRow,"SNDNG_SVC_TY",this.div_search.sch_txt.value);
	}else if(this.div_search.cmb_dept_se.value == "5"){
	    this.ds_cond00.setColumn(nRow,"RCVER_NM",this.div_search.sch_txt.value);
	} 
		 
	// Validation 체크
	if(!this.gfn_checkValidation(this.ds_cond00, this.ds_validation)) {
		return;
	}	 
	             
    this.fn_transaction("selectSmstranList");
}

// 종료
this.btn_Close_onclick = function(obj:Button,  e:nexacro.ClickEventInfo){ 
	this.close();
}
this.grd_smsClient_onheadclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	if(e.col == 0) {
		var content = this.txarea_con.text;
		if(obj.getCellProperty("head", e.cell, "text") == 0){
			if(content != null && content != ""){
				for(var i=0,j=this.ds_ums_sndng_dtls.rowcount; i<j; i++){
					this.ds_ums_sndng_dtls.setColumn(i,"SNDNG_CN", content);
				}
			}
		}else{
			for(var i=0,j=this.ds_ums_sndng_dtls.rowcount; i<j; i++){
				this.ds_ums_sndng_dtls.setColumn(i,"SNDNG_CN", "");
			}
		}
		this.gfn_setGridCheckAll(obj, e);
	}else{
		this.gfn_gridSort(obj, e); // Grid 데이터 정렬
	}
}

this.ds_ums_sndng_dtls_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	if(e.columnid == "CHK"){
		if(e.newvalue == "0"){
			this.ds_ums_sndng_dtls.setColumn(e.row,"SNDNG_CN", "");
		}else{
			var content = this.txarea_con.text;
			this.ds_ums_sndng_dtls.setColumn(e.row,"SNDNG_CN", content);
		}
	}
}
]]></Script>
  </Form>
</FDL>
