<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="SYM060400" classname="Pattern_03" left="0" top="0" width="1059" height="735" titletext="개선요청" onload="SYM060400_onload">
    <Layouts>
      <Layout>
        <Static id="Static08" taborder="99" cssclass="sta_WF_Labelbg" left="595" top="119" height="27" width="437"/>
        <Static id="Static09" taborder="102" cssclass="sta_WF_Labelbg" left="595" top="93" height="27" width="437"/>
        <Div id="div_search" taborder="3" left="0" top="0" height="33" cssclass="div_WFSA_Box" right="28">
          <Layouts>
            <Layout>
              <Static id="Static02" taborder="5" text="15" visible="false" left="337" top="0" width="15" height="31" style="background:#00ffff66;"/>
              <Static id="Static05" taborder="8" text="5" visible="false" left="390" top="0" right="631" height="31" style="background:#00ffff66;"/>
              <Static id="Static08" taborder="11" text="15" visible="false" left="168" top="0" width="15" height="31" style="background:#00ffff66;"/>
              <Static id="Static00" taborder="12" text="5" visible="false" left="221" top="0" right="800" height="31" style="background:#00ffff66;"/>
              <Static id="Static04" taborder="13" text="내용" cssclass="sta_WFSA_Label" left="352" top="5" width="38" height="21" onclick="div_search_Static04_onclick" visible="true"/>
              <Edit id="edt_qnaSj" taborder="20" readonly="false" left="229" top="5" height="21" width="108" onkeyup="div_search_edt_onkeyup" autoselect="true"/>
              <Static id="Static03" taborder="21" text="15" visible="false" left="506" top="0" height="31" style="background:#00ffff66;" width="15"/>
              <Static id="Static06" taborder="22" text="작성자" cssclass="sta_WFSA_Label" left="521" top="5" height="21" width="50"/>
              <Static id="Static07" taborder="23" text="5" visible="false" left="571" top="0" right="449" height="31" style="background:#00ffff66;"/>
              <Edit id="edt_qnaCn" taborder="26" readonly="false" left="398" top="5" height="21" width="108" onkeyup="div_search_edt_onkeyup" autoselect="true"/>
              <Edit id="edt_qnaRegister" taborder="31" readonly="false" left="580" top="5" height="21" width="108" onkeyup="div_search_edt_onkeyup" autoselect="true"/>
              <Static id="Static16" taborder="32" text="제목" cssclass="sta_WFSA_Label" left="182" top="5" height="21" visible="true" width="38"/>
              <Combo id="cbo_ansSeCd" taborder="33" innerdataset="@ds_cond_com055" codecolumn="CODE" datacolumn="CODE_NM" visible="true" left="778" top="5" width="80" height="21"/>
              <Static id="Static01" taborder="34" text="15" visible="false" left="688" top="0" width="15" height="31" style="background:#00ffff66;"/>
              <Static id="Static09" taborder="35" text="5" visible="false" left="769" top="0" right="251" height="31" style="background:#00ffff66;"/>
              <Static id="Static10" taborder="36" text="진행상황" cssclass="sta_WFSA_Label" left="703" top="5" width="66" height="21"/>
              <Static id="Static11" taborder="37" text="15" visible="false" left="0" top="0" bottom="0" width="15" style="background:#00ffff66;"/>
              <Div id="div_monCal" taborder="38" url="common::frmMonCal.xfdl" left="84" top="5" width="84" height="21" async="false"/>
              <Static id="sta_YEAR" taborder="39" text="요청년월" wordwrap="char" cssclass="sta_WFSA_Label" left="15" top="5" width="64" height="21"/>
              <Static id="Static12" taborder="40" text="15" visible="false" left="858" top="0" width="15" height="31" style="background:#00ffff66;"/>
              <Static id="Static13" taborder="41" text="작업구분" cssclass="sta_WFSA_Label" left="873" top="5" width="66" height="21"/>
              <Combo id="cmb_opertSe" taborder="43" innerdataset="@ds_cond_com058" codecolumn="CODE" datacolumn="CODE_NM" left="940" top="5" width="80" height="21"/>
              <Static id="Static14" taborder="44" text="5" visible="false" left="931" top="0" right="89" height="31" style="background:#00ffff66;"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static01" taborder="56" text="15" visible="false" top="0" width="15" height="735" style="background:#1b3cd23c;align:center middle;" right="13"/>
        <Static id="Static13" taborder="57" text="스&#13;&#10;크&#13;&#10;롤&#13;&#10;13" visible="false" top="0" width="13" height="735" style="background:#d07b173c;align:center middle;" right="0"/>
        <Edit id="edt_verSn" taborder="58" readonly="true" left="974" top="176" width="50" height="21"/>
        <Static id="Static04" taborder="59" text="요청 QNA 목록" cssclass="sta_WF_Title01" left="0%" top="42" right="87.63%" height="21"/>
        <Static id="Static10" taborder="60" text="5" visible="false" left="0%" top="62" right="2.64%" height="5" style="background:#dc143c3c;align:center middle;"/>
        <Static id="Static46" taborder="61" text="10" visible="false" left="55.15%" top="67" right="43.91%" height="644" style="background:#1b3cd23c;align:center middle;"/>
        <Static id="Static22" taborder="62" text="상세내역" cssclass="sta_WF_Title02" left="594" top="42" width="159" height="21"/>
        <Static id="Static02" taborder="63" cssclass="sta_WF_Labelbg" left="668" top="171" height="27" width="364"/>
        <Static id="sta_qnaSj" taborder="66" text="제목" cssclass="sta_WF_Label" left="593" top="171" width="101" height="27"/>
        <Edit id="edt_qnaSj" taborder="67" left="697" top="174" width="327" height="21" maxlength="150" lengthunit="utf8"/>
        <Static id="Static07" taborder="68" cssclass="sta_WF_Labelbg" left="668" top="197" height="315" width="364"/>
        <Static id="sta_qnaCn" taborder="69" text="내용" cssclass="sta_WF_Label" left="593" top="197" width="101" height="315"/>
        <Static id="Static12" taborder="71" cssclass="sta_WF_Labelbg" left="596" top="511" height="27" width="436"/>
        <TextArea id="txa_qnaCn" taborder="72" scrollbars="autovert" wordwrap="char" left="696" top="200" width="332" height="309" lengthunit="utf8" maxlength="4000"/>
        <Edit id="edt_qnaRegister" taborder="74" readonly="true" left="697" top="514" width="110" height="21" cssclass="edt_WF_Readonly"/>
        <Calendar id="cal_qnaRegistDt" taborder="76" readonly="true" dateformat="yyyy-MM-dd" left="916" top="514" width="110" height="21" cssclass="cal_WF_Readonly"/>
        <Grid id="grd_qnaList" taborder="77" binddataset="ds_hpcmQna" useinputpanel="false" autofittype="col" treeusecheckbox="false" treeuseimage="false" treeinitstatus="expand,all" treeuseexpandkey="true" left="0" top="67" width="584" height="668">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="223"/>
                <Column size="75"/>
                <Column size="63"/>
                <Column size="63"/>
                <Column size="63"/>
                <Column size="60"/>
                <Column size="109"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="개선요청사항"/>
                <Cell col="1" text="QNA구분"/>
                <Cell col="2" text="메뉴구분"/>
                <Cell col="3" displaytype="normal" text="진행상태"/>
                <Cell col="4" displaytype="normal" text="작업구분"/>
                <Cell col="5" text="요청자"/>
                <Cell col="6" text="요청일시"/>
              </Band>
              <Band id="body">
                <Cell displaytype="tree" edittype="tree" text="bind:QNA_SJ2" treestartlevel="0" treelevel="bind:QNA_LEVEL"/>
                <Cell col="1" displaytype="combo" text="bind:QNA_SE_CODE" combodataset="ds_com054" combocodecol="CODE" combodatacol="CODE_NM"/>
                <Cell col="2" displaytype="combo" text="bind:JOB_SE" combodataset="ds_com056" combocodecol="CODE" combodatacol="CODE_NM"/>
                <Cell col="3" displaytype="combo" text="bind:QNA_STTUS" combodataset="ds_com055" combocodecol="CODE" combodatacol="CODE_NM"/>
                <Cell col="4" displaytype="combo" text="bind:OPERT_SE" combodataset="ds_com058" combocodecol="CODE" combodatacol="CODE_NM"/>
                <Cell col="5" displaytype="normal" text="bind:REGISTER_NM"/>
                <Cell col="6" displaytype="normal" edittype="none" text="bind:REGIST_DT" treecheck="bind:INTRCP_AT" calendardisplaynulltype="none"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static00" taborder="78" cssclass="sta_WF_Labelbg" left="595" top="67" height="27" width="437"/>
        <Static id="sta_qnaSeCd" taborder="79" text="QNA구분" cssclass="sta_WF_Label" left="593" top="67" width="101" height="27"/>
        <Combo id="cbo_qnaSeCd" taborder="80" innerdataset="@ds_com054" codecolumn="CODE" datacolumn="CODE_NM" left="697" top="70" width="110" height="21" cssclass="cmb_WF_Essential"/>
        <Button id="btn_insert" taborder="81" text="응답추가" onclick="btn_insert_onclick" top="43" width="66" height="19" domainId="nexa.add" left="966" visible="false"/>
        <Button id="btn_newInsert" taborder="82" text="신규질문" onclick="btn_newInsert_onclick" top="43" width="66" height="19" domainId="nexa.add" style="background:#ff9999ff;border:1 solid #ff4d4dff ;" left="517"/>
        <Static id="Static05" taborder="89" text="10" visible="false" left="0%" top="33" right="2.64%" height="10" style="background:#dc143c3c;align:center middle;"/>
        <Static id="sta_qnaSeCd00" taborder="91" text="진행상태" cssclass="sta_WF_Label" left="593" top="93" width="101" height="27"/>
        <Static id="sta_qnaRegister" taborder="73" text="작성자" cssclass="sta_WF_Label" left="593" top="511" width="101" height="27"/>
        <Static id="sta_qnaRegistDt" taborder="75" text="등록일자" cssclass="sta_WF_Label" left="812" top="511" width="101" height="27"/>
        <Static id="Static03" taborder="84" cssclass="sta_WF_Labelbg" left="596" top="537" height="198" width="436"/>
        <Static id="sta_qnaRegister00" taborder="83" text="첨부파일" cssclass="sta_WF_Label" left="593" top="537" width="101" height="198"/>
        <Button id="btn_fileUpload" taborder="87" text="붙임선택" onclick="btn_fileUpload_onclick" top="541" width="61" height="21" left="845"/>
        <Grid id="grd_fileList" taborder="88" binddataset="ds_fileList" useinputpanel="false" onheadclick="grd_fileList_onheadclick" left="696" top="564" width="332" height="168">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="31"/>
                <Column size="297"/>
                <Column size="85"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="checkbox"/>
                <Cell col="1" text="파일명"/>
                <Cell col="2" text="용량"/>
              </Band>
              <Band id="body">
                <Cell displaytype="checkbox" edittype="checkbox" text="bind:CHK"/>
                <Cell col="1" text="bind:ORGINL_FILE_NM"/>
                <Cell col="2" text="bind:FILE_MG"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_fileDownload" taborder="85" text="다운로드" onclick="btn_fileDownload_onclick" cssclass="btn_WF_Process" top="541" width="57" height="21" left="971"/>
        <Button id="btn_fileDelete" taborder="86" text="붙임삭제" onclick="btn_fileDelete_onclick" cssclass="btn_WF_Process" top="541" width="59" height="21" left="909"/>
        <Edit id="edt_verSn00" taborder="92" readonly="true" left="974" top="150" width="50" height="21"/>
        <Static id="Static06" taborder="93" cssclass="sta_WF_Labelbg" left="668" top="145" height="27" width="364"/>
        <Static id="sta_qnaSj00" taborder="95" text="비밀글 여부" cssclass="sta_WF_Label" left="593" top="145" width="101" height="27"/>
        <CheckBox id="chk_secretAt" taborder="96" left="705" top="147" width="38" height="23" falsevalue="0" truevalue="1"/>
        <Combo id="cbo_ansSeCd" taborder="90" innerdataset="@ds_com055" codecolumn="CODE" datacolumn="CODE_NM" left="697" top="96" width="110" height="21"/>
        <Static id="sta_helpAdmin" taborder="97" text="담당자" cssclass="sta_WF_Label" left="812" top="145" width="101" height="27"/>
        <Combo id="cbo_helpAdmin" taborder="98" innerdataset="ds_helpAdmin" codecolumn="USER_ID" datacolumn="USER_NM" left="916" top="148" width="110" height="21"/>
        <Static id="sta_helpAdmin01" taborder="103" text="요청메뉴 구분" cssclass="sta_WF_Label" left="812" top="67" width="101" height="27"/>
        <Combo id="cbo_jobSe" taborder="104" innerdataset="@ds_com056" codecolumn="CODE" datacolumn="CODE_NM" cssclass="cmb_WF_Essential" left="916" top="70" width="110" height="21"/>
        <Static id="sta_helpAdmin00" taborder="105" text="완료요청일" cssclass="sta_WF_Label" left="593" top="119" width="101" height="27"/>
        <Calendar id="cal_comptRqestde" taborder="106" dateformat="yyyy-MM-dd" left="697" top="122" width="110" height="21"/>
        <Static id="sta_helpAdmin02" taborder="107" text="계획일자" cssclass="sta_WF_Label" left="812" top="119" width="101" height="27"/>
        <Calendar id="cal_planDe" taborder="108" dateformat="yyyy-MM-dd" left="916" top="122" width="110" height="21"/>
        <Static id="sta_helpAdmin03" taborder="109" text="작업구분" cssclass="sta_WF_Label" left="812" top="93" width="101" height="27"/>
        <Combo id="cmb_opertSe" taborder="110" innerdataset="@ds_com058" codecolumn="CODE" datacolumn="CODE_NM" cssclass="cmb_WF_Essential" left="916" top="96" width="110" height="21"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_validation" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="compId" type="STRING" size="256"/>
          <Column id="colId" type="STRING" size="256"/>
          <Column id="PK" type="STRING" size="256"/>
          <Column id="notNull" type="STRING" size="256"/>
          <Column id="type" type="STRING" size="256"/>
          <Column id="nlength" type="STRING" size="256"/>
          <Column id="from" type="STRING" size="256"/>
          <Column id="to" type="STRING" size="256"/>
          <Column id="lengthChkGb" type="STRING" size="256"/>
          <Column id="msgId" type="STRING" size="256"/>
          <Column id="expr" type="STRING" size="256"/>
          <Column id="func" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="compId">ds_hpcmQna</Col>
            <Col id="colId">QNA_SJ</Col>
            <Col id="PK">[Undefined]</Col>
            <Col id="notNull">Y</Col>
            <Col id="type">[Undefined]</Col>
            <Col id="nlength">[Undefined]</Col>
            <Col id="from">[Undefined]</Col>
            <Col id="to">[Undefined]</Col>
            <Col id="lengthChkGb">[Undefined]</Col>
            <Col id="msgId">[QNA]제목</Col>
            <Col id="expr">[Undefined]</Col>
            <Col id="func">[Undefined]</Col>
          </Row>
          <Row>
            <Col id="compId">ds_hpcmQna</Col>
            <Col id="colId">QNA_CN</Col>
            <Col id="PK">[Undefined]</Col>
            <Col id="notNull">Y</Col>
            <Col id="type">[Undefined]</Col>
            <Col id="nlength">[Undefined]</Col>
            <Col id="from">[Undefined]</Col>
            <Col id="to">[Undefined]</Col>
            <Col id="lengthChkGb">[Undefined]</Col>
            <Col id="msgId">[QNA]내용</Col>
            <Col id="expr">[Undefined]</Col>
            <Col id="func">[Undefined]</Col>
          </Row>
          <Row>
            <Col id="compId">ds_hpcmQna</Col>
            <Col id="colId">QNA_SE_CODE</Col>
            <Col id="PK">[Undefined]</Col>
            <Col id="notNull">Y</Col>
            <Col id="type">[Undefined]</Col>
            <Col id="nlength">[Undefined]</Col>
            <Col id="from">[Undefined]</Col>
            <Col id="to">[Undefined]</Col>
            <Col id="lengthChkGb">[Undefined]</Col>
            <Col id="msgId">[QNA]QNA구분</Col>
            <Col id="expr">[Undefined]</Col>
            <Col id="func">[Undefined]</Col>
          </Row>
          <Row>
            <Col id="compId">ds_hpcmQna</Col>
            <Col id="colId">JOB_SE</Col>
            <Col id="notNull">Y</Col>
            <Col id="msgId">[QNA]메뉴구분</Col>
          </Row>
          <Row>
            <Col id="compId">ds_hpcmQna</Col>
            <Col id="colId">OPERT_SE</Col>
            <Col id="PK"/>
            <Col id="notNull">Y</Col>
            <Col id="type"/>
            <Col id="nlength"/>
            <Col id="from"/>
            <Col id="to"/>
            <Col id="lengthChkGb"/>
            <Col id="msgId">[QNA]작업구분</Col>
            <Col id="expr"/>
            <Col id="func"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_hpcmQna" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_hpcmQna_onrowposchanged" canrowposchange="ds_hpcmQna_canrowposchange" oncolumnchanged="ds_hpcmQna_oncolumnchanged">
        <ColumnInfo>
          <Column id="QNA_SN" type="BIGDECIMAL" size="18"/>
          <Column id="REFRN_QNA_SN" type="BIGDECIMAL" size="18"/>
          <Column id="VER_SN" type="STRING" size="7"/>
          <Column id="QNA_SJ" type="STRING" size="100"/>
          <Column id="QNA_SJ2" type="STRING" size="256"/>
          <Column id="QNA_CN" type="STRING" size="4000"/>
          <Column id="OPERT_SE" type="STRING" size="256"/>
          <Column id="QNA_SE_CODE" type="STRING" size="2"/>
          <Column id="USE_AT" type="STRING" size="1"/>
          <Column id="REGISTER_ID" type="STRING" size="12"/>
          <Column id="REGIST_DT" type="STRING" size="255"/>
          <Column id="UPDUSR_ID" type="STRING" size="12"/>
          <Column id="UPDT_DT" type="STRING" size="255"/>
          <Column id="QNA_LEVEL" type="INT" size="3"/>
          <Column id="FILE_SN" type="BIGDECIMAL" size="256"/>
          <Column id="REGISTER_NM" type="STRING" size="256"/>
          <Column id="QNA_STTUS" type="STRING" size="256"/>
          <Column id="SECRET_AT" type="STRING" size="256"/>
          <Column id="CHARGER" type="STRING" size="256"/>
          <Column id="COMPT_RQESTDE" type="STRING" size="256"/>
          <Column id="JOB_SE" type="STRING" size="256"/>
          <Column id="PLAN_DE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows/>
      </Dataset>
      <Dataset id="ds_cond" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="QNA_SJ" type="STRING" size="256"/>
          <Column id="QNA_CN" type="STRING" size="256"/>
          <Column id="REGISTER_NM" type="STRING" size="256"/>
          <Column id="QNA_STTUS" type="STRING" size="256"/>
          <Column id="OPERT_SE" type="STRING" size="256"/>
          <Column id="YYYYMM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows/>
      </Dataset>
      <Dataset id="ds_fileList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="FILE_SN" type="BIGDECIMAL" size="20"/>
          <Column id="FILE_ORDR" type="INT" size="3"/>
          <Column id="FILE_STRE_COURS" type="STRING" size="2000"/>
          <Column id="STRE_FILE_NM" type="STRING" size="255"/>
          <Column id="ORGINL_FILE_NM" type="STRING" size="255"/>
          <Column id="FILE_EXTSN" type="STRING" size="20"/>
          <Column id="FILE_CN" type="STRING" size="4000"/>
          <Column id="FILE_MG" type="INT" size="8"/>
          <Column id="USE_AT" type="STRING" size="1"/>
          <Column id="FILE_ID" type="STRING" size="256"/>
          <Column id="SN" type="INT" size="5"/>
          <Column id="SYS_SE_CODE" type="STRING" size="6"/>
          <Column id="JOB_SE" type="STRING" size="3"/>
          <Column id="FILE_TY" type="STRING" size="256"/>
          <Column id="FILE_IMAGE" type="STRING" size="256"/>
          <Column id="PROGRS" type="INT" size="5"/>
          <Column id="TRNSMIS_FILE_SIZE" type="INT" size="256"/>
          <Column id="DELETE_IMAGE" type="STRING" size="256"/>
          <Column id="STTUS" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_fileSn" firefirstcount="0" firenextcount="0" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" useclientlayout="true">
        <ColumnInfo>
          <Column id="FILE_SN" type="BIGDECIMAL" size="20"/>
          <Column id="SYS_SE_CODE" type="STRING" size="6"/>
          <Column id="JOB_SE" type="STRING" size="3"/>
          <Column id="FILE_SN2" type="BIGDECIMAL" size="20"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_fileSn2" firefirstcount="0" firenextcount="0" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" useclientlayout="true">
        <ColumnInfo>
          <Column id="FILE_SN" type="BIGDECIMAL" size="20"/>
          <Column id="SYS_SE_CODE" type="STRING" size="6"/>
          <Column id="JOB_SE" type="STRING" size="3"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_com054" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="CODE_CN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_com055" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="CODE_CN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond_com055" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="CODE_CN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_helpAdmin">
        <ColumnInfo>
          <Column id="USER_ID" type="STRING" size="256"/>
          <Column id="USER_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_com056" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="CODE_CN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_com058" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="CODE_CN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond_com058" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
          <Column id="CODE_CN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item6" compid="div_search.edt_qnaSj" propid="value" datasetid="ds_cond" columnid="QNA_SJ"/>
      <BindItem id="item11" compid="div_search.edt_qnaCn" propid="value" datasetid="ds_cond" columnid="QNA_CN"/>
      <BindItem id="item12" compid="div_search.edt_qnaRegister" propid="value" datasetid="ds_cond" columnid="REGISTER_NM"/>
      <BindItem id="item3" compid="edt_verSn" propid="value" datasetid="ds_hpcmQna" columnid="VER_SN"/>
      <BindItem id="item15" compid="edt_qnaSj" propid="value" datasetid="ds_hpcmQna" columnid="QNA_SJ"/>
      <BindItem id="item18" compid="txa_qnaCn" propid="value" datasetid="ds_hpcmQna" columnid="QNA_CN"/>
      <BindItem id="item22" compid="edt_qnaRegister" propid="value" datasetid="ds_hpcmQna" columnid="REGISTER_NM"/>
      <BindItem id="item23" compid="cal_qnaRegistDt" propid="value" datasetid="ds_hpcmQna" columnid="REGIST_DT"/>
      <BindItem id="item4" compid="cbo_qnaSeCd" propid="value" datasetid="ds_hpcmQna" columnid="QNA_SE_CODE"/>
      <BindItem id="item1" compid="cbo_ansSeCd" propid="value" datasetid="ds_hpcmQna" columnid="QNA_STTUS"/>
      <BindItem id="item2" compid="div_search.cbo_ansSeCd" propid="value" datasetid="ds_cond" columnid="QNA_STTUS"/>
      <BindItem id="item0" compid="edt_verSn00" propid="value" datasetid="ds_hpcmQna" columnid="VER_SN"/>
      <BindItem id="item5" compid="chk_secretAt" propid="value" datasetid="ds_hpcmQna" columnid="SECRET_AT"/>
      <BindItem id="item7" compid="cbo_helpAdmin" propid="value" datasetid="ds_hpcmQna" columnid="CHARGER"/>
      <BindItem id="item9" compid="cbo_jobSe" propid="value" datasetid="ds_hpcmQna" columnid="JOB_SE"/>
      <BindItem id="item8" compid="cal_comptRqestde" propid="value" datasetid="ds_hpcmQna" columnid="COMPT_RQESTDE"/>
      <BindItem id="item10" compid="cal_planDe" propid="value" datasetid="ds_hpcmQna" columnid="PLAN_DE"/>
      <BindItem id="item13" compid="cmb_opertSe" propid="value" datasetid="ds_hpcmQna" columnid="OPERT_SE"/>
      <BindItem id="item14" compid="div_search.cmb_opertSe" propid="value" datasetid="ds_cond" columnid="OPERT_SE"/>
    </Bind>
    <Script type="xscript5.0"><![CDATA[/***********************************************************************
 * 화면ID   : SYM060400
 * 화면명   : QnA 관리
 * 화면설명 : QnA를 관리한다.
 * 작성일   : 2016. 1. 04.
 * 작성자   : 고진호
 * 수정이력 :
 ***********************************************************************
 *     수정일     수정자   내용
 ***********************************************************************
 * 2018. 03. 06.	이수지
 ***********************************************************************
 */
 
/***********************************************************************
 * Script Include
 ***********************************************************************/
include "lib::comInclude.xjs";
include "lib::comUpDownUtils.xjs";	// 메인화면 파일 업로드/다운로드 라이브러리
include "mis_lib::misUtil.xjs";

/***********************************************************************
 * 화면 변수 선언부
 ***********************************************************************/
this.lastRow = -1;
this.File_UpDownManager = null;
this.isAuth = false; //개선요청담당자 권한
this.isAuthAcc = false; //회계(지출)권한
 /***********************************************************************
 * onInit / onLoad 영역
 ***********************************************************************/
this.SYM060400_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{
	// Form 초기화
	this.fn_init_form();

	// DataSet 초기화
	this.fn_init_dataset();
	
	// 데이터셋 동적 바인딩
	this.div_search.div_monCal.fn_setBind("ds_cond","YYYYMM");
	this.div_search.div_monCal.msk_mon.set_cssclass("msk_WF_Essential");
	
	var today = this.dateUtils.today();
	this.ds_cond.clearData();
	this.ds_cond.addRow();
	this.ds_cond.setColumn(0, "YYYYMM", today.substr(0,6));

	if(this.gfn_authGrpId("HELP_ADMIN") != -1) { //개선요청담당자
		this.isAuth = true;
	}else if(this.gfn_authGrpId("ACC_ADMIN") != -1 || this.gfn_authGrpId("ACC_USER") != -1) { //지출결재자, 지출담당자
		this.isAuthAcc = true;
	}
	
	if(this.isAuth){
		this.btn_insert.set_visible(true);
	}
	this.fn_loadCombo();
	
	// 파일 메니저 설정
	var fileConfig = {
		useMultiUpload : true,
		onChange: this.fn_onFileSelected,	// 파일 선택 이벤트 핸들러
		onSuccess : this.fn_onFileSuccess	// 전송 성공 이벤트 핸들러
	};
	this.File_UpDownManager = new this.fileUpDownManager(this, "SYS", "COM");
	this.File_UpDownManager.init(fileConfig);
	// 파일 업로드 초기화
	this.File_UpDownManager.cancelAllFile();
	//첨부파일 버튼 설정
	
	// 담당자 조회
	this.fn_transaction("helpAdmin");
}


/***********************************************************************
 * Form/Dataset 오브젝트 초기화
 ***********************************************************************/
/*
 * 함수명  	: initForm
 * 설명 		: Form을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.initForm();
 */
this.fn_init_form = function()
{
	// 시스템 공통으로 Form을 Initialize 한다.
	this.gfn_initForm(this);
}

/*
 * 함수명  	: fn_init_dataset
 * 설명 		: Dataset을 초기화한다.
 *                주로, 조건 Dataset들(ds_cond, ds_cond_00, ds_cond_01, ...) 을 초기화한다.
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_init_dataset();
 */
this.fn_init_dataset = function()
{
	// 조건에 사용되는 Dataset 초기화
	this.gfn_initCondDs(this, this.div_search);
}

this.fn_loadCombo = function()
{
      /*
      params  		: 1. param_1    : 반환받을 DATASET 명 			(예: ds_comCode00)
                        2. param_2	: 그룹코드						(예 : COM007)
                        3. param_3	: 사용여부		    			(예 : 1(사용), ""(사용안함))
                        4. param_4	: 콤보박스INDEX(0) 표시		(예 : "전체", "선택", " "(공백), ""(첫번째데이터부터시작) )
      */
	var comboParams = [
			 ["ds_com054","COM054", "Y", "D", "B"]
			,["ds_com055","COM055", "Y", "D", "B"]
			,["ds_cond_com055","COM055", "Y", "전체", "B"]
			,["ds_com056","COM056", "Y", "S", "B"]
			,["ds_com058","COM058", "Y", "S", "B"]        //작업구분
			,["ds_cond_com058","COM058", "Y", "A", "B"]   //작업구분 (검색조건)
		];

	this.gfn_comboLoad(comboParams, this.fn_callbackAfter);
}

this.fn_callbackAfter = function ()
{
}


/***********************************************************************
* Transaction 영역 시작
************************************************************************/

/***********************************************************************
 * Transaction 관련 이벤트 핸들러
 **********************************************************************/
/*
 * 함수명  		: fn_search
 * 설명 		: QnA 목록 조회
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_search();
 */
this.fn_search = function()
{
	this.fn_fileClear();
	this.ds_hpcmQna.clearData();
	//화면ID값을 기준으로 검색

	if (this.ds_cond.rowcount < 1) {
		this.ds_cond.addRow();
	}
	
	this.fn_transaction("SYM060400List");
}

this.fn_saveQnaFile = function()
{
	//FileSN 생성
	this.fn_getFileSn();
	//첨부파일 업로드
	this.fn_uploadFiles();
}

/**********************************************************************
 * CALL TRANSACTION 영역
 **********************************************************************/


/*
 * 함수명  	: fn_transaction
 * 설명 		: Transaction 요청 처리 함수
 * params  		: strSvcId : 서비스요청 ID
 * return Type 	: None
 * 사용법		: this.fn_transaction("SELECT");
 */
this.fn_transaction = function(strSvcId)
{
	var argument     = "";
	var callbackFunc = "fn_callBack";
	var showProgress = true;
	var bAsync       = true;
	 
	switch (strSvcId) { 
		case "helpAdmin":	// 담당자조회
			var sController   	= "hsco/com/sym/aum/SYM060400/getListGrpUser.do";
			var sInDatasets   	= "";
			var sOutDatasets  	= "ds_helpAdmin=output1";
			break;
		case "SYM060400List": 	// QnA 목록 조회
			var sController   	= "hsco/com/sym/ohm/SYM060400/SYM060400List.do";
			var sInDatasets   	= "input1=ds_cond";
			var sOutDatasets  	= "ds_hpcmQna=output1";
			break; 
		case "SYM060400CUD":	// QnA 저장		
			var sController   	= "hsco/com/sym/ohm/SYM060400/SYM060400CUD.do";
			var sInDatasets   	= "input1=ds_hpcmQna:U";
			var sOutDatasets  	= "";
			break;
		//첨부파일 관련 Transaction
		case "GetFileSn": // 파일일련번호 조회
			var sController   	= "hsco/cmm/file/getFileSn.do";
			var sInDatasets   	= "";
			var sOutDatasets  	= "ds_fileSn2=output_fsn";
			bAsync = false;  
			break; 
		case "deleteFiles" :  // 다건 선택 파일 삭제
		    var sController   	= "hsco/cmm/file/deleteFile.do";	
			var sInDatasets   	= "input1=ds_fileList:U";
			var sOutDatasets  	= "ds_fileList=output1";
		    break;
		case "selectAtchmnFileList" :	// 다건 첨부파일 목록 조회
			var sController = "hsco/cmm/file/selectAtchmnFileList.do";
			var sInDatasets  = "input1=ds_fileSn";
			var sOutDatasets = "ds_fileList=output1";
			break; 
	} 	
	Ex.core.tran(this, strSvcId, sController, sInDatasets, sOutDatasets, argument, callbackFunc, showProgress, bAsync);
} 
    
    
 /**********************************************************************
 * Transaction Callback 영역
 ***********************************************************************/
 /*
 * 함수명  	: fn_callBack 
 * 설명 		: Transaction Callback 처리
 * params  		: strSvcId    : 서비스요청 ID
 *                nErrorCode  : 오류 메시지 코드 ([예] 0 : Success, 그밖의 경우, error)
 *                strErrorMsg : 오류 메시지([예]  success.insert|정상적으로 등록되었습니다.)
 * return Type 	: None
 * 사용법		:
 */    
this.fn_callBack = function (strSvcId, nErrorCode, strErrorMsg)
{      
	// 오류 및 성공 메시지를 화면에 보여준다.
	//this.gfn_callback_message(strSvcId, nErrorCode, strErrorMsg);
	//this.gfn_callBackMsg(strSvcId, nErrorCode, strErrorMsg);
            
	if (nErrorCode != 0){
		// 오류 메시지를 보여주는 동작 외에 처리할 내용이 있으면 아래에 기술.
		// 처리할 내용이 없다면, switch 문은 생략합니다.
		switch (strSvcId) {
			case "SYM060400List": 	// QnA 목록 조회
			    break;
		    case "SYM060400CUD":	// QnA 정보 목록 저장
                this.gfn_message("info.처리불가.실패",strErrorMsg);		    
			    break;
		}	
	} else {
		// 성공 메시지를 보여주는 동작 외에 처리할 내용이 있으면 아래에 기술.
		// 처리할 내용이 없다면, switch 문은 생략합니다.

		switch (strSvcId) {
			case "helpAdmin":	// 담당자조회
				if(!this.isAuth){
					this.cbo_helpAdmin.set_readonly(true);
					this.cbo_helpAdmin.set_cssclass("cmb_WF_Readonly");
				}
			    this.fn_search();
				break;
			case "SYM060400List": 	// QnA 목록 조회
				break;
			case "SYM060400CUD":	// QnA 저장
				this.gfn_message("success.처리.성공");
			    this.fn_search();
			    break;
		}		
	} 
}

/***********************************************************************
* Transaction 영역 끝
************************************************************************/
/***********************************************************************
 * non-Transaction 관련 컴포넌트 이벤트 처리 함수
 ***********************************************************************/

//취소 버튼 이벤트

// 메뉴 취소 버튼 클릭시 이벤트 처리
this.btn_Cancel_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.fn_resetQna();
	
}


// 현재 트리에 답변을 추가
this.btn_insert_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if (!this.fn_checkFileAction()) return false;
	var nCurRow = this.ds_hpcmQna.rowposition;
	this.lastRow = nCurRow;
	var nLastRow = this.fn_getTreeLastRow(nCurRow, this.grd_qnaList);
	var userId = application.gv_userId;
	if (nLastRow == -1) nLastRow = 0;

	var nRow;
	
	var qna_lvl = this.ds_hpcmQna.getColumn(nCurRow, "QNA_LEVEL");
	if( qna_lvl == null || qna_lvl == "undefined") {
		qna_lvl = 0;
	}

	//기본값 설정
	if (nCurRow != -1) {
		//선택한것이 있으면 기본값 설정
		if (this.comUtils.isNullEmpty(this.ds_hpcmQna.getColumn(nCurRow, "QNA_SN"))) {
			this.gfn_message("comm.정보.저장.요청", "상위 QnA");	//{0} 정보를 저장하시기 바랍니다.
			return;
		}
		nRow = this.ds_hpcmQna.insertRow(nLastRow + 1);
		this.ds_hpcmQna.setColumn(nRow, "QNA_LEVEL", qna_lvl + 1);
		var nQnaSn  = this.ds_hpcmQna.getColumn(nCurRow, "QNA_SN");
		var nVerSn  = this.ds_hpcmQna.getColumn(nCurRow, "VER_SN");
		var nQnaSe  = this.ds_hpcmQna.getColumn(nCurRow, "QNA_SE_CODE");
		var nQnaSttus = this.ds_hpcmQna.getColumn(nCurRow, "QNA_STTUS");
		var nSecretAt = this.ds_hpcmQna.getColumn(nCurRow, "SECRET_AT");
		var nComptRqestde = this.ds_hpcmQna.getColumn(nCurRow, "COMPT_RQESTDE");
		var nPlanDe = this.ds_hpcmQna.getColumn(nCurRow, "PLAN_DE");
		var nJobSe = this.ds_hpcmQna.getColumn(nCurRow, "JOB_SE");
		var nOpertSe = this.ds_hpcmQna.getColumn(nCurRow, "OPERT_SE");

		
		
		this.ds_hpcmQna.setColumn(nRow, "REFRN_QNA_SN" 	, nQnaSn);
		this.ds_hpcmQna.setColumn(nRow, "VER_SN" 		, nVerSn);
		this.ds_hpcmQna.setColumn(nRow, "QNA_SE_CODE",    nQnaSe);
		this.ds_hpcmQna.setColumn(nRow, "SECRET_AT",      nSecretAt);
		this.ds_hpcmQna.setColumn(nRow, "COMPT_RQESTDE",  nComptRqestde);
		this.ds_hpcmQna.setColumn(nRow, "PLAN_DE",  nPlanDe);
		this.ds_hpcmQna.setColumn(nRow, "JOB_SE", 		  nJobSe);
		this.ds_hpcmQna.setColumn(nRow, "OPERT_SE", 		  nOpertSe);
		this.ds_hpcmQna.setColumn(nRow, "QNA_STTUS", 	  2);
		
	} else {
		nRow = this.ds_hpcmQna.insertRow(nLastRow + 1);
		this.ds_hpcmQna.setColumn(nRow, "QNA_LEVEL", 0);
	} 
	this.ds_hpcmQna.setColumn(nRow, "QNA_SJ"		, "");
	this.ds_hpcmQna.setColumn(nRow, "REGISTER_ID"	, userId);
	this.ds_hpcmQna.setColumn(nRow, "REGISTER_NM",	this.gfn_getUserName());
	this.ds_hpcmQna.setColumn(nRow, "REGIST_DT", 	this.gfn_dateInfo("NOW_DATE_TIME"));
	
	//this.fn_getFileList();
	
	this.cbo_ansSeCd.set_cssclass("cmb_WF_Essential");
	this.cbo_ansSeCd.set_readonly(false);
	this.cbo_qnaSeCd.set_cssclass("cmb_WF_Readonly");
	this.cbo_qnaSeCd.set_readonly(true);
	this.cbo_jobSe.set_cssclass("cmb_WF_Readonly");
	this.cbo_jobSe.set_readonly(true);
	this.cmb_opertSe.set_cssclass("cmb_WF_Readonly");
	this.cmb_opertSe.set_readonly(true);
	this.edt_qnaSj.set_cssclass("");
	this.edt_qnaSj.set_readonly(false);
	this.txa_qnaCn.set_cssclass("");
	this.txa_qnaCn.set_readonly(false);
	
	if(nSecretAt == '1'){
		//비밀글에 체크되있으면 답변에 무조건 비밀
		this.chk_secretAt.set_cssclass("chk_WF_Readonly");
		this.chk_secretAt.set_readonly(true);
	}else{
		this.chk_secretAt.set_cssclass("");
		this.chk_secretAt.set_readonly(false);
	}
	
	
	this.btn_fileUpload.set_visible(true);
	this.btn_fileDelete.set_visible(true);
}

//신규 버튼 이벤트
this.btn_newInsert_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if (!this.fn_checkFileAction()) return false;
	
	var nCnt = this.ds_hpcmQna.rowcount;
	var nRow = this.ds_hpcmQna.addRow();
	this.lastRow = nRow;
	var userId = application.gv_userId;
	
	var today = this.dateUtils.today();
	
	this.ds_hpcmQna.setColumn(nRow, "QNA_SJ"		, "");
	this.ds_hpcmQna.setColumn(nRow, "QNA_LEVEL", 0);
	this.ds_hpcmQna.setColumn(nRow, "REGISTER_ID"	, userId);
	this.ds_hpcmQna.setColumn(nRow, "REGISTER_NM",	  this.gfn_getUserName());
	this.ds_hpcmQna.setColumn(nRow, "REGIST_DT", 	  this.gfn_dateInfo("NOW_DATE_TIME"));
	this.ds_hpcmQna.setColumn(nRow, "QNA_SE_CODE", 	  1);
	this.ds_hpcmQna.setColumn(nRow, "QNA_STTUS", 	  1);
	this.ds_hpcmQna.setColumn(nRow, "COMPT_RQESTDE",  this.gfn_addDate(today, 14, "D"));
	this.ds_hpcmQna.setColumn(nRow, "PLAN_DE",  this.gfn_addDate(today, 14, "D"));
	this.ds_hpcmQna.setColumn(nRow, "JOB_SE", 	      "");
	this.ds_hpcmQna.setColumn(nRow, "OPERT_SE", 	  "");


	// 신규등록은 QNA 구분 수정가능, 진행상태 수정불가
	this.cbo_qnaSeCd.set_cssclass("cmb_WF_Essential");
	this.cbo_qnaSeCd.set_readonly(false);
	this.cbo_jobSe.set_cssclass("cmb_WF_Essential");
	this.cbo_jobSe.set_readonly(false);
	this.cmb_opertSe.set_cssclass("cmb_WF_Essential");
	this.cmb_opertSe.set_readonly(false);
	this.chk_secretAt.set_cssclass("");
	this.chk_secretAt.set_readonly(false);
	this.cbo_ansSeCd.set_cssclass("cmb_WF_Readonly");
	this.cbo_ansSeCd.set_readonly(true);
	this.cal_comptRqestde.set_cssclass("");
	this.cal_comptRqestde.set_readonly(false);
	this.cal_planDe.set_cssclass("");
	this.cal_planDe.set_readonly(false);
	this.edt_qnaSj.set_cssclass("");
	this.edt_qnaSj.set_readonly(false);
	this.txa_qnaCn.set_cssclass("");
	this.txa_qnaCn.set_readonly(false);
	
	this.btn_fileUpload.set_visible(true);
	this.btn_fileDelete.set_visible(true);
	this.sta_helpAdmin.set_visible(false);
	this.cbo_helpAdmin.set_visible(false);
	
}

//QnA 데이터셋 리셋
this.fn_resetQna = function()
{
	var hasAttFile = this.File_UpDownManager.hasFile();
	if(this.comUtils.isDatasetUpdated(this.ds_hpcmQna) || hasAttFile) {
		if (this.gfn_message("confirm.취소여부")) {
			this.ds_hpcmQna.reset();
			this.fn_fileClear();
		}
	}
}


//삭제버튼 이벤트

this.btn_Delete_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.fn_deleteRow();
}


//현재 선택 로우를 삭제
this.fn_deleteRow = function()
{
	var nRow = this.ds_hpcmQna.rowposition;
	if (nRow < 0 ) return;
	var nQnaSn = this.ds_hpcmQna.getColumn(nRow, "QNA_SN");
	
	if (this.fn_canDelCheck()) {
		if (this.fn_authCheck()) {
			if(this.gfn_message("confirm.삭제여부")) {
				this.ds_hpcmQna.deleteRow(nRow);
				this.fn_fileClear();
				
				if(this.ds_hpcmQna.getRowCount()>0){
					this.ds_hpcmQna.set_rowposition(-1);
					this.ds_hpcmQna.set_rowposition(nRow);
				}
			}
		} else {
			this.gfn_message("fail.삭제.불가", "다른 사용자가 등록한 QnA는")
		}
	} else {
		this.gfn_message("fail.삭제.불가", "답변이 등록된 QnA는");
	}
}

this.fn_fileClear = function()
{
	this.ds_fileList.clearData();
	this.File_UpDownManager.cancelAllFile();
	this.ds_fileSn.clearData();
	this.ds_fileSn2.clearData();
}


//추가시 현재 선택 트리의 마지막 부분에 추가
this.fn_getTreeLastRow = function(nRow, grdList)
{
	var nLastRow = grdList.getTreeChildRow(nRow, -1);
	if (nLastRow != -1) {
		nLastRow = this.fn_getTreeLastRow(nLastRow, grdList);
	} else {
		return nRow;
	}
	return nLastRow;
}


/***********************************************************************
* 사용자 정의 함수
************************************************************************/
//수정가능한지 체크
this.fn_canModifyCheck = function() {
	return this.fn_authCheck();
}

//기본적으로 삭제가 가능한지
this.fn_canDelCheck = function() {
	var curRow = this.ds_hpcmQna.rowposition;
	var nChildCount = this.grd_qnaList.getTreeChildCount(curRow);
	
	return  (nChildCount == 0)
}

//권한이 있는지 체크
this.fn_authCheck = function() {
	var userId = application.gv_userId;
	var userGrp = application.gv_userAuth;
	var curRow = this.ds_hpcmQna.rowposition;
	var curUserId = this.ds_hpcmQna.getColumn(curRow, "REGISTER_ID");
	
	return ((userId == curUserId) || (userGrp == "HELP_ADMIN"))
}

//데이터셋 행변경
this.ds_hpcmQna_onrowposchanged = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{
    this.lastRow = e.oldrow;
	var fRow = obj.findRow("QNA_SN", obj.getColumn(e.newrow, "REFRN_QNA_SN"));
	
	if(!this.fn_canDelCheck()
		|| (obj.getColumn(e.newrow, "REGISTER_ID") != application.gv_userId && obj.getColumn(e.newrow, "QNA_LEVEL") < 1)
		|| (!this.isAuth &&  obj.getColumn(e.newrow, "QNA_LEVEL") > 0)){
		// 답변이 없는 상태이면서
		// 본인글이 아니면 수정불가(질문)
		// 권한자가 아니면 수정불가(답변)
		this.cbo_qnaSeCd.set_cssclass("cmb_WF_Readonly");
		this.cbo_qnaSeCd.set_readonly(true);
		this.cbo_jobSe.set_cssclass("cmb_WF_Readonly");
		this.cbo_jobSe.set_readonly(true);
		this.cmb_opertSe.set_cssclass("cmb_WF_Readonly");
		this.cmb_opertSe.set_readonly(true);
		this.chk_secretAt.set_cssclass("chk_WF_Readonly");
		this.chk_secretAt.set_readonly(true);
		this.cal_comptRqestde.set_cssclass("cal_WF_Readonly");
		this.cal_comptRqestde.set_readonly(true);
		this.cal_planDe.set_cssclass("cal_WF_Readonly");
		this.cal_planDe.set_readonly(true);
		this.cbo_ansSeCd.set_cssclass("cmb_WF_Readonly");
		this.cbo_ansSeCd.set_readonly(true);
		this.edt_qnaSj.set_cssclass("edt_WF_Readonly");
		this.edt_qnaSj.set_readonly(true);
		this.txa_qnaCn.set_cssclass("txt_WF_Readonly");
		this.txa_qnaCn.set_readonly(true);
		this.cbo_helpAdmin.set_cssclass("cmb_WF_Readonly");
		this.cbo_helpAdmin.set_readonly(true);
		
		this.btn_fileUpload.set_visible(false);
		this.btn_fileDelete.set_visible(false);
		
    }else{
		// 본인의 질문글
		if(obj.getColumn(e.newrow, "REGISTER_ID") == application.gv_userId && obj.getColumn(e.newrow, "QNA_LEVEL") < 1){
			// 질문
			this.cbo_ansSeCd.set_cssclass("cmb_WF_Readonly");
			this.cbo_ansSeCd.set_readonly(true);
			this.cbo_helpAdmin.set_cssclass("cmb_WF_Readonly");
			this.cbo_helpAdmin.set_readonly(true);

			if(e.newrow+1 == obj.getRowCount() || obj.findRowExpr("REFRN_QNA_SN == " + obj.getColumn(e.newrow, "QNA_SN") + " < 0 && QNA_LEVEL > 0")){
				// 답변없으면 수정
				this.cbo_qnaSeCd.set_cssclass("cmb_WF_Essential");
				this.cbo_qnaSeCd.set_readonly(false);
				this.cbo_jobSe.set_cssclass("cmb_WF_Essential");
				this.cbo_jobSe.set_readonly(false);
				this.cmb_opertSe.set_cssclass("cmb_WF_Essential");
				this.cmb_opertSe.set_readonly(false);
				this.chk_secretAt.set_cssclass("");
				this.chk_secretAt.set_readonly(false);
				this.cal_comptRqestde.set_cssclass("");
				this.cal_comptRqestde.set_readonly(false);
				this.cal_planDe.set_cssclass("");
				this.cal_planDe.set_readonly(false);
				this.edt_qnaSj.set_cssclass("");
				this.edt_qnaSj.set_readonly(false);
				this.txa_qnaCn.set_cssclass("");
				this.txa_qnaCn.set_readonly(false);
				
				this.btn_fileUpload.set_visible(true);
				this.btn_fileDelete.set_visible(true);
			}else{
				this.btn_fileUpload.set_visible(false);
				this.btn_fileDelete.set_visible(false);
			}
		}else{
			// 답변
			if(this.isAuth){
				// 답변권한자
				this.cbo_ansSeCd.set_cssclass("cmb_WF_Essential");
				this.cbo_ansSeCd.set_readonly(false);
				this.cbo_qnaSeCd.set_cssclass("cmb_WF_Readonly");
				this.cbo_qnaSeCd.set_readonly(true);
				this.cbo_jobSe.set_cssclass("cmb_WF_Readonly");
				this.cbo_jobSe.set_readonly(true);
				this.edt_qnaSj.set_cssclass("");
				this.edt_qnaSj.set_readonly(false);
				this.txa_qnaCn.set_cssclass("");
				this.txa_qnaCn.set_readonly(false);
				if(obj.getColumn(e.newrow, "QNA_LEVEL") < 1){
					// 질문글
					this.cbo_helpAdmin.set_cssclass("cmb_WF_Readonly");
					this.cbo_helpAdmin.set_readonly(true);
				}else{
					this.cbo_helpAdmin.set_cssclass("");
					this.cbo_helpAdmin.set_readonly(false);
				}
				
				var nSecretAt = this.ds_hpcmQna.getColumn(fRow, "SECRET_AT");
				if(nSecretAt == '1'){
					//질문글이 비밀글에 체크되있으면 답변에 무조건 비밀
					this.chk_secretAt.set_cssclass("chk_WF_Readonly");
					this.chk_secretAt.set_readonly(true);
				}else{
					this.chk_secretAt.set_cssclass("");
					this.chk_secretAt.set_readonly(false);
				}
				
				this.btn_fileUpload.set_visible(true);
				this.btn_fileDelete.set_visible(true);
			}else{
				this.btn_fileUpload.set_visible(false);
				this.btn_fileDelete.set_visible(false);
			}
		}
	}
    
	
	// 진행상태에 따라 담당자컬럼 노출
	if(obj.getColumn(e.newrow, "QNA_STTUS") == '1'){
		this.sta_helpAdmin.set_visible(false);
		this.cbo_helpAdmin.set_visible(false);
	}else{
		this.sta_helpAdmin.set_visible(true);
		this.cbo_helpAdmin.set_visible(true);
	}
	
	if(obj.getColumn(e.newrow, "SECRET_AT") == '1' && !this.isAuth){ //비밀글 && 개선요청담당권한아닐경우
		var jobSe = this.ds_hpcmQna.getColumn(this.ds_hpcmQna.rowposition, "JOB_SE");
		if(obj.getColumn(e.newrow, "QNA_LEVEL") > 0){
			if(this.isAuthAcc && jobSe == "ACC"){// 답변글일때 회계권한 
				this.fn_getFileList();
			}else if(obj.getColumn(fRow, "REGISTER_ID") != application.gv_userId){ // 답변글일때 본인글 답변글만 조회
				this.ds_hpcmQna.set_updatecontrol(false);
				this.ds_hpcmQna.setColumn(e.newrow, "QNA_SJ", "비밀글입니다.");
				this.ds_hpcmQna.setColumn(e.newrow, "QNA_CN", "비밀글입니다.");
				this.ds_hpcmQna.set_updatecontrol(true);
			}else{
				this.fn_getFileList();
			}
		}else{
			if(this.isAuthAcc && jobSe == "ACC"){// 질문글일때 회계권한
				this.fn_getFileList();
			}else if(obj.getColumn(e.newrow, "REGISTER_ID") != application.gv_userId){ // 질문글일 때 본인만
				this.ds_hpcmQna.set_updatecontrol(false);
				this.ds_hpcmQna.setColumn(e.newrow, "QNA_SJ", "비밀글입니다.");
				this.ds_hpcmQna.setColumn(e.newrow, "QNA_CN", "비밀글입니다.");
				this.ds_hpcmQna.set_updatecontrol(true);
			}else{
				this.fn_getFileList();
			}
		}
	}
	else{
		this.fn_getFileList();
	}
	
}


/***********************************************************************
 * 설명: 취소처리
 ************************************************************************/
this.fn_cancel= function()
{
	this.fn_resetQna();
}

/***********************************************************************
 * 설명: 종료처리
 ************************************************************************/
this.fn_close = function(){
	this.close();
}


/***********************************************************************
 * 설명: 저장처리
 ************************************************************************/
this.fn_save = function(){

	var hasAttFile = this.File_UpDownManager.hasFile();
	if(!this.comUtils.isDatasetUpdated(this.ds_hpcmQna) && !hasAttFile) {
        this.gfn_message("comm.데이터.변경.없음");
        return false;
    }
	
	if(this.gfn_message("comm.행위여부", "저장")){
		if (hasAttFile) {
		    if(!this.gfn_checkValidation(this.ds_hpcmQna, this.ds_validation)) {
				return false;
			} else {
				this.fn_saveQnaFile();
				this.fn_transaction("SYM060400CUD");
				return true;
			}
		    return true;
		}
		
	    if(!this.gfn_checkValidation(this.ds_hpcmQna, this.ds_validation)) {
			return false;
		} else {
		    this.fn_transaction("SYM060400CUD");
		    return true;
		}
	} 
}

/***********************************************************************
 * 설명: 삭제처리
 ************************************************************************/
this.fn_delete =  function()
{
	this.fn_deleteRow();
}


//검색창의 엔터키 이벤트
this.div_search_edt_onkeyup = function(obj:Edit, e:nexacro.KeyEventInfo)
{
	if (e.keycode == 13) {
	// 엔터키 이벤트 : 자동 조회
		this.fn_search();
	}
}



/**
 * 함수명  		: fn_onFileSuccess 파일 업로드 성공 이벤트 핸들러
 * 설명 		: 파일 업로드 성공
 * params  		: type 실행구분(ExtFileUpload/ExtFileDownload), e 발생이벤트
 * return Type 	: None
 * 사용법		: this.fn_onFileSuccess();
 */
this.fn_onFileSuccess = function(type, e){
	if(type == this.File_UpDownManager.TYPE_DOWNLOADER){
		this.gfn_message("success.파일.다운로드.성공");
	} else if (type == this.File_UpDownManager.TYPE_UPLOADER){

	}
}

/**
 * 파일업로드 파일 선택 이벤트 핸들러
 * @param fileFullName 선택 전체 파일명
 * @param type 실행구분(ExtFileUpload/ExtFileDownload)
 * @param fileFullName 선택 파일명
 * @return void
 */
this.fn_onFileSelected = function(type, fileFullName){

	if(type == this.File_UpDownManager.TYPE_UPLOADER){
		var isNmArray = this.comUtils.isArray(fileFullName);
		if(isNmArray){
			// 다건처리
			//trace("다건처리");
			var selFileLeng = fileFullName.length;
			for(var i = 0; i < selFileLeng; i++){
				var newRowIdx = this.ds_fileList.addRow();
				this.ds_fileList.setColumn(newRowIdx, "ORGINL_FILE_NM", fileFullName[i]);	// 실제파일명
			}
		}else{
			var rowPos = this.ds_fileList.addRow();
			this.ds_fileList.setColumn(rowPos, "ORGINL_FILE_NM", fileFullName);	// 첨부된 파일 데이터 셋 입력 처리
		}
	}
}

//FILE_SN 생성
this.fn_getFileSn = function() {
	var nCurRow = this.ds_hpcmQna.rowposition;
	if (this.ds_hpcmQna.rowcount > 0) {

		var nCurFileSn = this.ds_hpcmQna.getColumn(nCurRow, "FILE_SN");
		// 파일 첨부여부 확인
		var hasAttFile = this.File_UpDownManager.hasFile();
		if(hasAttFile){
			if (this.comUtils.isNullEmpty(nCurFileSn)) {
				this.fn_transaction("GetFileSn");
				this.ds_hpcmQna.setColumn(nCurRow, "FILE_SN", this.ds_fileSn2.getColumn(0, "FILE_SN"));
			}
		}
	}
}


this.fn_getFileList = function()
{ 
	this.fn_fileClear();
	if (this.ds_hpcmQna.rowcount > 0) {
		var nCurRow = this.ds_hpcmQna.rowposition;
		var nCurFileSn = this.ds_hpcmQna.getColumn(nCurRow, "FILE_SN");
		if (!this.comUtils.isNullEmpty(nCurFileSn)) {
			if (this.ds_fileSn.rowcount == 0) this.ds_fileSn.addRow();
			this.ds_fileSn.setColumn(0, "FILE_SN", nCurFileSn);
			this.fn_transaction("selectAtchmnFileList");
		}
	}
}


/*
 * 함수명  	: fn_uploadFiles
 * 설명 		: 파일업로드 처리
 * params  		: None
 * return Type 	: None
 * 사용법		: this.fn_uploadFiles();
 */
this.fn_uploadFiles = function()
{
	// 파일 업로드 처리
	// 파일 첨부여부 확인
	var hasAttFile = this.File_UpDownManager.hasFile();
	if(hasAttFile){
	    var fileSn;
	    if (this.ds_hpcmQna.rowcount > 0) {
			var nCurRow = this.ds_hpcmQna.rowposition;
			fileSn = this.ds_hpcmQna.getColumn(nCurRow, "FILE_SN");
			if(fileSn != null && fileSn != undefined && fileSn > 0){
				this.File_UpDownManager.setFileSn(fileSn);
			} 
			
			var sController = "hsco/com/sym/ohm/SYM060400/fileUpload.do";
			var oInDatasets = "";
			var sOutDatasets = "ds_fileList=fileList";
						
						
			this.File_UpDownManager.upload(sController, oInDatasets, sOutDatasets);
		}
	}
}


/*
 * 함수명  	: fn_addAtchFile
 * 설명 		: 업로드 파일선택
 * params  		: isMulti   true(다건), false(단건)
 * return Type 	: None
 * 사용법		: this.fn_addAtchFile();
 */
this.fn_addAtchFile = function(isMulti){
	var allowFile = null;//["txt"];	// 선택 허용 파일유형 - Confilg에서 설정이 가능하나 선택시에도 처리가능하게
	var useMultiSelect = isMulti;
	this.File_UpDownManager.addFiles(allowFile, useMultiSelect);
}


// 첨부파일 선택
this.btn_fileUpload_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	//파일첨부, 삭제 가능한 상태인지 확인 필요(상신전에만 가능)
	this.fn_addAtchFile(true);
}
 
//첨부파일 삭제
this.btn_fileDelete_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	//파일첨부, 삭제 가능한 상태인지 확인 필요(상신전에만 가능)
	this.fn_fileDelete();
}


//첨부파일 다운로드
this.btn_fileDownload_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var option = {};
	option["viewRow"] = "expr:CHK == '1'";
	var checkDownList = this.gfn_datasetToObject(this.ds_fileList, option, true);
	var isArray = this.comUtils.isArray(checkDownList);
	
	if(isArray){
		var checkDownLeng = checkDownList == null ? 0 : checkDownList.length;
		
		// 선택자료 여부 체크
		if ( checkDownLeng == 0 ) {
			this.gfn_message("comm.데이터.선택.없음");
			return;
		}
		
		for(var i = 0; i < checkDownLeng; i++){
			var fileSn = checkDownList[i].FILE_SN;
			var fileOrder = checkDownList[i].FILE_ORDR;
			var fileName = checkDownList[i].ORGINL_FILE_NM;
			
			this.File_UpDownManager.download(fileSn, fileOrder, fileName);
		}
	}else{
		var fileSn = checkDownList.FILE_SN;
		var fileOrder = checkDownList.FILE_ORDR;
		var fileName = checkDownList.ORGINL_FILE_NM;
		
		this.File_UpDownManager.download(fileSn, fileOrder, fileName);
	}
}

//첨부파일 삭제
this.fn_fileDelete = function()
{
	// 선택 삭제
	var exprStr = "CHK==1";
	var fRow = this.ds_fileList.findRowExpr(exprStr);
	
	// 선택자료 여부 체크
	if ( fRow == -1 ) {
		this.gfn_message("comm.데이터.선택.없음");
		return;
	}
	
	if(this.gfn_message("confirm.선택파일.삭제여부", "들")){
		this.gfn_delMultiDsRow(this.ds_fileList);
		this.fn_transaction("deleteFiles");
	}
}

//파일이 첨부 및 삭제 가능한 상태인지 체크
this.fn_isFileControl = function()
{
	return true;
}


this.ds_hpcmQna_canrowposchange = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{
	return this.fn_checkFileAction();
}


this.fn_checkFileAction = function()
{
	//첨부파일이 있을경우에는 저장하도록 유도
	var hasAttFile = this.File_UpDownManager.hasFile();
	if(hasAttFile) 
	{
		if(this.gfn_message("comm.행위여부", "첨부파일을 취소")){
			return true;
		} else {
			return false;
		}
	}
	return true;
}

this.ds_hpcmQna_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	if(obj.getColumn(e.row, "QNA_LEVEL") > 0){
		var fRow = obj.findRow("QNA_SN", obj.getColumn(e.row, "REFRN_QNA_SN"));
		if(e.columnid == "QNA_STTUS" ){
			obj.setColumn(fRow, "QNA_STTUS", e.newvalue);
			if(e.newvalue == '1'){
				obj.setColumn(e.row, "CHARGER", "");
				obj.setColumn(fRow,  "CHARGER", "");
				
				this.sta_helpAdmin.set_visible(false);
				this.cbo_helpAdmin.set_visible(false);
			}else{
				this.sta_helpAdmin.set_visible(true);
				this.cbo_helpAdmin.set_visible(true);
			}
		}else if(e.columnid == "CHARGER" ){
			obj.setColumn(fRow, "CHARGER", e.newvalue);
		}
	}
}

this.grd_fileList_onheadclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	if(e.col == 0) {
		this.gfn_setGridCheckAll(obj, e);
	}
}
]]></Script>
  </Form>
</FDL>
