<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="HPM070105_SQL">

	<!-- 시설 목록 조회 -->
	<select id="HPM070105DAO.selectFctlsList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		WITH TNNCRT_LIST AS (
	        SELECT 'TNNCRT01' AS FCLTS_SN, '센트럴파크테니스장' AS FCLTS_NM, '050200' AS DEPT_CODE FROM DUAL
	        UNION ALL
	        SELECT 'TNNCRT02' AS FCLTS_SN, '돌모루테니스장' AS FCLTS_NM , '050200' AS DEPT_CODE FROM DUAL
	        UNION ALL
	        SELECT 'TNNCRT03' AS FCLTS_SN, '동탄배드민턴장' AS FCLTS_NM , '050200' AS DEPT_CODE FROM DUAL
	        UNION ALL
	        SELECT 'TNNCRT04' AS FCLTS_SN, '동탄파크골프장' AS FCLTS_NM , '050200' AS DEPT_CODE FROM DUAL
	        UNION ALL
	        SELECT 'TNNCRT05' AS FCLTS_SN, '향남파크골프장' AS FCLTS_NM , '050200' AS DEPT_CODE FROM DUAL
	        UNION ALL
	        SELECT 'TNNCRT06' AS FCLTS_SN, '화성정궁도장'   AS FCLTS_NM , '050200' AS DEPT_CODE FROM DUAL
		) 
		SELECT 
		     TO_CHAR(FCLTS_SN) AS FCLTS_SN
		    ,FCLTS_NM
		FROM TBHPM_RENT_FCLTS_MANAGE
		WHERE DEPT_CODE = #DEPT_CODE#
		UNION ALL
		SELECT 
		     FCLTS_SN
		    ,FCLTS_NM
		FROM TNNCRT_LIST
		WHERE DEPT_CODE = #DEPT_CODE#
	</select>
	
	<!-- 실적 조회 -->
	<select id="HPM070105DAO.selectAcmsltList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		WITH TB_BASE AS (
			 SELECT 
			       s1.FCLTS_SN
			      ,s1.USE_DE
			      ,s1.USE_NMPR
			      ,CASE
			            WHEN SUBSTR(s1.USE_TIME, 0, 4) >= 1800
			            THEN '1'
			            ELSE '0'
			        END AS TM   /* 0 : 주간, 1 : 야간*/
			      ,CASE
			        WHEN TO_CHAR(TO_DATE(USE_DE, 'yyyymmdd'), 'd') IN (1, 7)
			        THEN '1'
			        ELSE NVL2(s2.HVOF_AT, '1', '0') 
			         END AS DAY  /* 0 : 평일, 1 : 주말*/
			      ,s1.SETLE_AM - NVL(s1.REFND_AM, 0) AS SETLE_AM
			FROM TBHPM_RENT_FCLTS_REQST_MANAGE s1 
			    LEFT OUTER JOIN TBHPM_FCLTS_HVOF_INFO s2
			      ON s1.DEPT_CODE = s2.DEPT_CODE
			     AND s1.USE_DE = s2.HVOF_DE
			WHERE 1                   = 1
			AND s1.SETLE_STTUS       IN ('005', '006', '007')
			    /*결제완료, 환불요청, 환불완료*/
			AND NVL(DELETE_AT, 0)     <![CDATA[ <> ]]>'1'
			AND NVL(RENT_CANCL_AT, 0) <![CDATA[ <> ]]>'1'
			)
			, TMP_T AS (
			SELECT
			     t1.FCLTS_SN
			    ,MAX(t1.FCLTS_NM) AS FCLTS_NM
			    ,t2.DAY
			    ,t2.TM
			    ,COUNT(CASE WHEN SUBSTR(t2.USE_DE, 0, 6) = #YM# THEN 1 END)                   AS N_CO
			    ,SUM(CASE WHEN   SUBSTR(t2.USE_DE, 0, 6) = #YM# THEN t2.SETLE_AM ELSE 0 END)  AS N_AM
			    ,COUNT(CASE WHEN SUBSTR(t2.USE_DE, 0, 6) BETWEEN SUBSTR(#YM#, 0, 4) || '01' AND #PRE_YM# THEN 1 END)				   AS P_CO
			    ,SUM(CASE WHEN   SUBSTR(t2.USE_DE, 0, 6) BETWEEN SUBSTR(#YM#, 0, 4) || '01' AND #PRE_YM# THEN t2.SETLE_AM ELSE 0 END)  AS P_AM
			    ,COUNT(CASE WHEN SUBSTR(t2.USE_DE, 0, 6) BETWEEN SUBSTR(#YM#, 0, 4) || '01' AND #YM# THEN 1 END)				  	 AS T_CO
			    ,SUM(CASE WHEN   SUBSTR(t2.USE_DE, 0, 6) BETWEEN SUBSTR(#YM#, 0, 4) || '01' AND #YM# THEN t2.SETLE_AM ELSE 0 END)  AS T_AM
			FROM TBHPM_RENT_FCLTS_MANAGE  t1
			    LEFT OUTER JOIN TB_BASE t2
			      ON t1.FCLTS_SN = t2.FCLTS_SN
			  AND t1.FCLTS_SN = #FCLTS_SN#
			GROUP BY t1.FCLTS_SN, t2.DAY, t2.TM
			)
			
			SELECT 
			    '평일' AS DAY
			    ,'주간' AS TM
			    ,SUM(CASE WHEN DAY = '0' AND TM = '0' THEN N_CO ELSE 0 END)  AS N_CO
			    ,SUM(CASE WHEN DAY = '0' AND TM = '0' THEN N_AM ELSE 0 END)  AS N_AM
			    ,SUM(CASE WHEN DAY = '0' AND TM = '0' THEN P_CO ELSE 0 END)  AS P_CO
			    ,SUM(CASE WHEN DAY = '0' AND TM = '0' THEN P_AM ELSE 0 END)  AS P_AM
			    ,SUM(CASE WHEN DAY = '0' AND TM = '0' THEN T_CO ELSE 0 END)  AS T_CO
			    ,SUM(CASE WHEN DAY = '0' AND TM = '0' THEN T_AM ELSE 0 END)  AS T_AM
			FROM TMP_T
			UNION ALL
			SELECT 
			     '평일' AS DAY
			    ,'야간' AS TM
			    ,SUM(CASE WHEN DAY = '0' AND TM = '1' THEN N_CO ELSE 0 END)  AS N_CO
			    ,SUM(CASE WHEN DAY = '0' AND TM = '1' THEN N_AM ELSE 0 END)  AS N_AM
			    ,SUM(CASE WHEN DAY = '0' AND TM = '1' THEN P_CO ELSE 0 END)  AS P_CO
			    ,SUM(CASE WHEN DAY = '0' AND TM = '1' THEN P_AM ELSE 0 END)  AS P_AM
			    ,SUM(CASE WHEN DAY = '0' AND TM = '1' THEN T_CO ELSE 0 END)  AS T_CO
			    ,SUM(CASE WHEN DAY = '0' AND TM = '1' THEN T_AM ELSE 0 END)  AS T_AM
			FROM TMP_T
			UNION ALL
			SELECT 
			     '주말' AS DAY
			    ,'주간' AS TM
			    ,SUM(CASE WHEN DAY = '1' AND TM = '0' THEN N_CO ELSE 0 END)  AS N_CO
			    ,SUM(CASE WHEN DAY = '1' AND TM = '0' THEN N_AM ELSE 0 END)  AS N_AM
			    ,SUM(CASE WHEN DAY = '1' AND TM = '0' THEN P_CO ELSE 0 END)  AS P_CO
			    ,SUM(CASE WHEN DAY = '1' AND TM = '0' THEN P_AM ELSE 0 END)  AS P_AM
			    ,SUM(CASE WHEN DAY = '1' AND TM = '0' THEN T_CO ELSE 0 END)  AS T_CO
			    ,SUM(CASE WHEN DAY = '1' AND TM = '0' THEN T_AM ELSE 0 END)  AS T_AM
			FROM TMP_T
			UNION ALL
			SELECT 
			     '주말' AS DAY
			    ,'야간' AS TM
			    ,SUM(CASE WHEN DAY = '1' AND TM = '1' THEN N_CO ELSE 0 END)  AS N_CO
			    ,SUM(CASE WHEN DAY = '1' AND TM = '1' THEN N_AM ELSE 0 END)  AS N_AM
			    ,SUM(CASE WHEN DAY = '1' AND TM = '1' THEN P_CO ELSE 0 END)  AS P_CO
			    ,SUM(CASE WHEN DAY = '1' AND TM = '1' THEN P_AM ELSE 0 END)  AS P_AM
			    ,SUM(CASE WHEN DAY = '1' AND TM = '1' THEN T_CO ELSE 0 END)  AS T_CO
			    ,SUM(CASE WHEN DAY = '1' AND TM = '1' THEN T_AM ELSE 0 END)  AS T_AM
			FROM TMP_T
	</select>

	<select id="HPM070105DAO.selectCentralparkTnncrtList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT 
		     '평일' 	AS	DAY
		    ,'일반권'	AS	TM
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_WKDAY_GNRL_CO, 0) + NVL(GNRL_WKDAY_NIGHT_CO, 0) ELSE 0 END)                                           		AS N_CO	/*평일일반권_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_WKDAY_GNRL_AM, 0) + NVL(GNRL_WKDAY_NIGHT_AM, 0) ELSE 0 END)                                           		AS N_AM /*평일일반권_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_WKDAY_GNRL_CO, 0) + NVL(GNRL_WKDAY_NIGHT_CO, 0) ELSE 0 END)	AS P_CO	/*평일일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_WKDAY_GNRL_AM, 0) + NVL(GNRL_WKDAY_NIGHT_AM, 0) ELSE 0 END)	AS P_AM /*평일일반권_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_WKDAY_GNRL_CO, 0) + NVL(GNRL_WKDAY_NIGHT_CO, 0) ELSE 0 END)	AS T_CO	/*평일일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_WKDAY_GNRL_AM, 0) + NVL(GNRL_WKDAY_NIGHT_AM, 0) ELSE 0 END)	AS T_AM /*평일일반권_금액*/
		FROM TBHPM_CENTRALPARK_TNNCRT
		UNION ALL
		SELECT
		     '평일' 	AS	DAY
		    ,'50%'	AS	TM
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_50_PT_WKDAY_GNRL_CO, 0) + NVL(DSCNT_50_PT_WKDAY_NIGHT_CO, 0) ELSE 0 END) 										  	AS N_DSCNT_50_PT_WKDAY_CO	/*평일50%_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_50_PT_WKDAY_GNRL_AM, 0) + NVL(DSCNT_50_PT_WKDAY_NIGHT_AM, 0) ELSE 0 END) 										  	AS N_DSCNT_50_PT_WKDAY_AM	/*평일50%_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_50_PT_WKDAY_GNRL_CO, 0) + NVL(DSCNT_50_PT_WKDAY_NIGHT_CO, 0) ELSE 0 END)	AS N_DSCNT_50_PT_WKDAY_CO	/*평일50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_50_PT_WKDAY_GNRL_AM, 0) + NVL(DSCNT_50_PT_WKDAY_NIGHT_AM, 0) ELSE 0 END)  AS N_DSCNT_50_PT_WKDAY_AM	/*평일50%_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_50_PT_WKDAY_GNRL_CO, 0) + NVL(DSCNT_50_PT_WKDAY_NIGHT_CO, 0) ELSE 0 END)	AS N_DSCNT_50_PT_WKDAY_CO	/*평일50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_50_PT_WKDAY_GNRL_AM, 0) + NVL(DSCNT_50_PT_WKDAY_NIGHT_AM, 0) ELSE 0 END)  AS N_DSCNT_50_PT_WKDAY_AM	/*평일50%_금액*/
		FROM TBHPM_CENTRALPARK_TNNCRT
		UNION ALL
		SELECT
		     '주말' 	AS	DAY
		    ,'일반권'	AS	TM
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_WKEND_GNRL_CO, 0) + NVL(GNRL_WKEND_NIGHT_CO, 0) ELSE 0 END) 											 AS N_GNRL_WKEND_CO	/*주말일반권_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_WKEND_GNRL_AM, 0) + NVL(GNRL_WKEND_NIGHT_AM, 0) ELSE 0 END) 											 AS N_GNRL_WKEND_AM	/*주말일반권_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_WKEND_GNRL_CO, 0) + NVL(GNRL_WKEND_NIGHT_CO, 0) ELSE 0 END) AS N_GNRL_WKEND_CO	/*주말일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_WKEND_GNRL_AM, 0) + NVL(GNRL_WKEND_NIGHT_AM, 0) ELSE 0 END) AS N_GNRL_WKEND_AM	/*주말일반권_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_WKEND_GNRL_CO, 0) + NVL(GNRL_WKEND_NIGHT_CO, 0) ELSE 0 END) AS N_GNRL_WKEND_CO	/*주말일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_WKEND_GNRL_AM, 0) + NVL(GNRL_WKEND_NIGHT_AM, 0) ELSE 0 END) AS N_GNRL_WKEND_AM	/*주말일반권_금액*/
		FROM TBHPM_CENTRALPARK_TNNCRT
		UNION ALL
		SELECT
		     '주말' 	AS	DAY
		    ,'50%'	AS	TM
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_50_PT_WKEND_GNRL_CO, 0) + NVL(DSCNT_50_PT_WKEND_NIGHT_CO, 0) ELSE 0 END)										   AS N_DSCNT_50_PT_WKEND_CO	/*주말50%_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_50_PT_WKEND_GNRL_AM, 0) + NVL(DSCNT_50_PT_WKEND_NIGHT_AM, 0) ELSE 0 END)										   AS N_DSCNT_50_PT_WKEND_AM	/*주말50%_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_50_PT_WKEND_GNRL_CO, 0) + NVL(DSCNT_50_PT_WKEND_NIGHT_CO, 0) ELSE 0 END) AS N_DSCNT_50_PT_WKEND_CO	/*주말50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_50_PT_WKEND_GNRL_AM, 0) + NVL(DSCNT_50_PT_WKEND_NIGHT_AM, 0) ELSE 0 END) AS N_DSCNT_50_PT_WKEND_AM	/*주말50%_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_50_PT_WKEND_GNRL_CO, 0) + NVL(DSCNT_50_PT_WKEND_NIGHT_CO, 0) ELSE 0 END) AS N_DSCNT_50_PT_WKEND_CO	/*주말50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_50_PT_WKEND_GNRL_AM, 0) + NVL(DSCNT_50_PT_WKEND_NIGHT_AM, 0) ELSE 0 END) AS N_DSCNT_50_PT_WKEND_AM	/*주말50%_금액*/
		FROM TBHPM_CENTRALPARK_TNNCRT
		UNION ALL
		SELECT
		     '정기권' 	AS	DAY
		    ,'일반권'	AS	TM
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_MT_CMMTKT_CO, 0) ELSE 0 END)												AS N_GNRL_MT_CMMTKT_CO			/*정기권일반_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_MT_CMMTKT_AM, 0) ELSE 0 END)												AS N_GNRL_MT_CMMTKT_AM			/*정기권일반_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_MT_CMMTKT_CO, 0) ELSE 0 END)   AS N_GNRL_MT_CMMTKT_CO			/*정기권일반_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_MT_CMMTKT_AM, 0) ELSE 0 END)   AS N_GNRL_MT_CMMTKT_AM			/*정기권일반_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_MT_CMMTKT_CO, 0) ELSE 0 END)   AS N_GNRL_MT_CMMTKT_CO			/*정기권일반_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_MT_CMMTKT_AM, 0) ELSE 0 END)   AS N_GNRL_MT_CMMTKT_AM			/*정기권일반_금액*/
		FROM TBHPM_CENTRALPARK_TNNCRT
		UNION ALL
		SELECT
		     '정기권' 	AS	DAY
		    ,'50%'	AS	TM
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_50_PT_MT_CMMTKT_CO, 0) ELSE 0 END)   											AS N_DSCNT_50_PT_MT_CMMTKT_CO	/*정기권50%_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_50_PT_MT_CMMTKT_AM, 0)  ELSE 0 END) 											AS N_DSCNT_50_PT_MT_CMMTKT_AM	/*정기권50%_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_50_PT_MT_CMMTKT_CO, 0) ELSE 0 END)	AS N_DSCNT_50_PT_MT_CMMTKT_CO	/*정기권50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_50_PT_MT_CMMTKT_AM, 0)  ELSE 0 END)	AS N_DSCNT_50_PT_MT_CMMTKT_AM	/*정기권50%_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_50_PT_MT_CMMTKT_CO, 0) ELSE 0 END)	AS N_DSCNT_50_PT_MT_CMMTKT_CO	/*정기권50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_50_PT_MT_CMMTKT_AM, 0)  ELSE 0 END)	AS N_DSCNT_50_PT_MT_CMMTKT_AM	/*정기권50%_금액*/
		FROM TBHPM_CENTRALPARK_TNNCRT
	</select>
	
	<select id="HPM070105DAO.selectDolmoruTnncrtList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		/*돌모루테니스장*/
		SELECT 
		     '평일'		AS DAY
		    ,'일반권'	AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_WKDAY_GNRL_CO, 0) + NVL(GNRL_WKDAY_NIGHT_CO, 0) ELSE 0 END) 											 AS N_CO	    /*평일일반권_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_WKDAY_GNRL_AM, 0) + NVL(GNRL_WKDAY_NIGHT_AM, 0) ELSE 0 END) 											 AS N_AM        /*평일일반권_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_WKDAY_GNRL_CO, 0) + NVL(GNRL_WKDAY_NIGHT_CO, 0) ELSE 0 END) AS P_CO	    /*평일일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_WKDAY_GNRL_AM, 0) + NVL(GNRL_WKDAY_NIGHT_AM, 0) ELSE 0 END) AS P_AM        /*평일일반권_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_WKDAY_GNRL_CO, 0) + NVL(GNRL_WKDAY_NIGHT_CO, 0) ELSE 0 END) AS T_CO	    /*평일일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_WKDAY_GNRL_AM, 0) + NVL(GNRL_WKDAY_NIGHT_AM, 0) ELSE 0 END) AS T_AM        /*평일일반권_금액*/
		FROM TBHPM_DOLMORU_TNNCRT_MANAGE
		UNION ALL    
		SELECT 		    
		     '평일'		AS DAY
		    ,'청소년'	AS TM 		    
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_WKDAY_GNRL_CO, 0) + NVL(DSCNT_YNGBGS_WKDAY_NIGHT_CO, 0) ELSE 0 END) 											 AS N_DSCNT_YNGBGS_WKDAY_CO  /*평일청소년_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_WKDAY_GNRL_AM, 0) + NVL(DSCNT_YNGBGS_WKDAY_NIGHT_AM, 0) ELSE 0 END)											 AS N_DSCNT_YNGBGS_WKDAY_CO  /*평일청소년_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_WKDAY_GNRL_CO, 0) + NVL(DSCNT_YNGBGS_WKDAY_NIGHT_CO, 0) ELSE 0 END) AS N_DSCNT_YNGBGS_WKDAY_CO  /*평일청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_WKDAY_GNRL_AM, 0) + NVL(DSCNT_YNGBGS_WKDAY_NIGHT_AM, 0) ELSE 0 END) AS N_DSCNT_YNGBGS_WKDAY_CO  /*평일청소년_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_WKDAY_GNRL_CO, 0) + NVL(DSCNT_YNGBGS_WKDAY_NIGHT_CO, 0) ELSE 0 END) AS N_DSCNT_YNGBGS_WKDAY_CO  /*평일청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_WKDAY_GNRL_AM, 0) + NVL(DSCNT_YNGBGS_WKDAY_NIGHT_AM, 0) ELSE 0 END) AS N_DSCNT_YNGBGS_WKDAY_CO  /*평일청소년_금액*/
		FROM TBHPM_DOLMORU_TNNCRT_MANAGE
		UNION ALL    
		SELECT 		    
		     '평일'		AS DAY
		    ,'50%'	AS TM 		
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_WKDAY_GNRL_CO, 0) + NVL(DSCNT_ETC_WKDAY_NIGHT_CO, 0) ELSE 0 END)											 AS N_DSCNT_ETC_WKDAY_CO     /*평일50%_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_WKDAY_GNRL_AM, 0) + NVL(DSCNT_ETC_WKDAY_NIGHT_AM, 0) ELSE 0 END)											 AS N_DSCNT_ETC_WKDAY_CO     /*평일50%_금액*/   
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_WKDAY_GNRL_CO, 0) + NVL(DSCNT_ETC_WKDAY_NIGHT_CO, 0)   ELSE 0 END) AS N_DSCNT_ETC_WKDAY_CO     /*평일50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_WKDAY_GNRL_AM, 0) + NVL(DSCNT_ETC_WKDAY_NIGHT_AM, 0)   ELSE 0 END) AS N_DSCNT_ETC_WKDAY_CO     /*평일50%_금액*/   
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_WKDAY_GNRL_CO, 0) + NVL(DSCNT_ETC_WKDAY_NIGHT_CO, 0)   ELSE 0 END) AS N_DSCNT_ETC_WKDAY_CO     /*평일50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_WKDAY_GNRL_AM, 0) + NVL(DSCNT_ETC_WKDAY_NIGHT_AM, 0)   ELSE 0 END) AS N_DSCNT_ETC_WKDAY_CO     /*평일50%_금액*/ 
		FROM TBHPM_DOLMORU_TNNCRT_MANAGE
		UNION ALL    
		SELECT 		    
		     '주말'		AS DAY
		    ,'일반권'	AS TM 			      		                                                                                                            
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_WKEND_GNRL_CO, 0) + NVL(GNRL_WKEND_NIGHT_CO, 0)         ELSE 0 END)											 AS N_GNRL_WKEND_CO          /*주말일반권_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_WKEND_GNRL_AM, 0) + NVL(GNRL_WKEND_NIGHT_AM, 0)         ELSE 0 END)											 AS N_GNRL_WKEND_AM          /*주말일반권_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_WKEND_GNRL_CO, 0) + NVL(GNRL_WKEND_NIGHT_CO, 0)         ELSE 0 END) AS N_GNRL_WKEND_CO          /*주말일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_WKEND_GNRL_AM, 0) + NVL(GNRL_WKEND_NIGHT_AM, 0)         ELSE 0 END) AS N_GNRL_WKEND_AM          /*주말일반권_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_WKEND_GNRL_CO, 0) + NVL(GNRL_WKEND_NIGHT_CO, 0)         ELSE 0 END) AS N_GNRL_WKEND_CO          /*주말일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_WKEND_GNRL_AM, 0) + NVL(GNRL_WKEND_NIGHT_AM, 0)         ELSE 0 END) AS N_GNRL_WKEND_AM          /*주말일반권_금액*/
		FROM TBHPM_DOLMORU_TNNCRT_MANAGE
		UNION ALL    
		SELECT
			 '주말'		AS DAY
			,'청소년'	AS TM  	
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_WKEND_GNRL_CO, 0) + NVL(DSCNT_YNGBGS_WKEND_NIGHT_CO, 0) ELSE 0 END)											 AS N_DSCNT_YNGBGS_WKEND_CO  /*주말청소년_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_WKEND_GNRL_AM, 0) + NVL(DSCNT_YNGBGS_WKEND_NIGHT_AM, 0) ELSE 0 END)											 AS N_DSCNT_YNGBGS_WKEND_CO  /*주말청소년_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_WKEND_GNRL_CO, 0) + NVL(DSCNT_YNGBGS_WKEND_NIGHT_CO, 0) ELSE 0 END) AS N_DSCNT_YNGBGS_WKEND_CO  /*주말청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_WKEND_GNRL_AM, 0) + NVL(DSCNT_YNGBGS_WKEND_NIGHT_AM, 0) ELSE 0 END) AS N_DSCNT_YNGBGS_WKEND_CO  /*주말청소년_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_WKEND_GNRL_CO, 0) + NVL(DSCNT_YNGBGS_WKEND_NIGHT_CO, 0) ELSE 0 END) AS N_DSCNT_YNGBGS_WKEND_CO  /*주말청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_WKEND_GNRL_AM, 0) + NVL(DSCNT_YNGBGS_WKEND_NIGHT_AM, 0) ELSE 0 END) AS N_DSCNT_YNGBGS_WKEND_CO  /*주말청소년_금액*/
		FROM TBHPM_DOLMORU_TNNCRT_MANAGE
		UNION ALL    
		SELECT	
			 '주말'		AS DAY
			,'50%'	AS TM  	    
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_WKEND_GNRL_CO, 0) + NVL(DSCNT_ETC_WKEND_NIGHT_CO, 0)    ELSE 0 END)											 AS N_DSCNT_ETC_WKEND_CO     /*주말50%_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_WKEND_GNRL_AM, 0) + NVL(DSCNT_ETC_WKEND_NIGHT_AM, 0)    ELSE 0 END)											 AS N_DSCNT_ETC_WKEND_CO     /*주말50%_금액*/   
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_WKEND_GNRL_CO, 0) + NVL(DSCNT_ETC_WKEND_NIGHT_CO, 0)    ELSE 0 END) AS N_DSCNT_ETC_WKEND_CO     /*주말50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_WKEND_GNRL_AM, 0) + NVL(DSCNT_ETC_WKEND_NIGHT_AM, 0)    ELSE 0 END) AS N_DSCNT_ETC_WKEND_CO     /*주말50%_금액*/ 
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_WKEND_GNRL_CO, 0) + NVL(DSCNT_ETC_WKEND_NIGHT_CO, 0)    ELSE 0 END) AS N_DSCNT_ETC_WKEND_CO     /*주말50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_WKEND_GNRL_AM, 0) + NVL(DSCNT_ETC_WKEND_NIGHT_AM, 0)    ELSE 0 END) AS N_DSCNT_ETC_WKEND_CO     /*주말50%_금액*/ 	    		    
		FROM TBHPM_DOLMORU_TNNCRT_MANAGE
		UNION ALL    
		SELECT	
			 '정기권'		AS DAY
			,'일반권'		AS TM  
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_MT_CMMTKT_CO, 0) ELSE 0 END)											  AS N_GNRL_MT_CMMTKT_CO             /*정기권일반권_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_MT_CMMTKT_AM, 0) ELSE 0 END)											  AS N_GNRL_MT_CMMTKT_AM    		   /*정기권일반권_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_MT_CMMTKT_CO, 0) ELSE 0 END) AS N_GNRL_MT_CMMTKT_CO             /*정기권일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_MT_CMMTKT_AM, 0) ELSE 0 END) AS N_GNRL_MT_CMMTKT_AM    		   /*정기권일반권_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_MT_CMMTKT_CO, 0) ELSE 0 END) AS N_GNRL_MT_CMMTKT_CO             /*정기권일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_MT_CMMTKT_AM, 0) ELSE 0 END) AS N_GNRL_MT_CMMTKT_AM    		   /*정기권일반권_금액*/
		FROM TBHPM_DOLMORU_TNNCRT_MANAGE
		UNION ALL    
		SELECT	
			 '정기권'		AS DAY
			,'청소년'			AS TM		    
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_MT_CMMTKT_AM, 0) ELSE 0 END)											  AS N_DSCNT_YNGBGS_MT_CMMTKT_AM     /*정기권청소년_금액*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_MT_CMMTKT_CO, 0) ELSE 0 END)											  AS N_DSCNT_YNGBGS_MT_CMMTKT_CO     /*정기권청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_MT_CMMTKT_AM, 0) ELSE 0 END) AS N_DSCNT_YNGBGS_MT_CMMTKT_AM     /*정기권청소년_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_MT_CMMTKT_CO, 0) ELSE 0 END) AS N_DSCNT_YNGBGS_MT_CMMTKT_CO     /*정기권청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_MT_CMMTKT_AM, 0) ELSE 0 END) AS N_DSCNT_YNGBGS_MT_CMMTKT_AM     /*정기권청소년_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_MT_CMMTKT_CO, 0) ELSE 0 END) AS N_DSCNT_YNGBGS_MT_CMMTKT_CO     /*정기권청소년_건수*/
		FROM TBHPM_DOLMORU_TNNCRT_MANAGE
		UNION ALL    
		SELECT	
			 '정기권'		AS DAY
			,'50%'			AS TM		    		    
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_MT_CMMTKT_CO, 0)    ELSE 0 END)										       AS N_DSCNT_ETC_MT_CMMTKT_CO        /*정기권50%_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_MT_CMMTKT_AM, 0)    ELSE 0 END)											   AS N_DSCNT_ETC_MT_CMMTKT_AM        /*정기권50%_금액*/ 
		    ,SUM(CASE WHEN  YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_MT_CMMTKT_CO, 0)    ELSE 0 END) AS N_DSCNT_ETC_MT_CMMTKT_CO        /*정기권50%_건수*/
		    ,SUM(CASE WHEN  YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_MT_CMMTKT_AM, 0)    ELSE 0 END) AS N_DSCNT_ETC_MT_CMMTKT_AM        /*정기권50%_금액*/ 
		    ,SUM(CASE WHEN  YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_MT_CMMTKT_CO, 0)    ELSE 0 END) AS N_DSCNT_ETC_MT_CMMTKT_CO        /*정기권50%_건수*/
		    ,SUM(CASE WHEN  YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_MT_CMMTKT_AM, 0)    ELSE 0 END) AS N_DSCNT_ETC_MT_CMMTKT_AM        /*정기권50%_금액*/ 
		FROM TBHPM_DOLMORU_TNNCRT_MANAGE
	</select>
	
	<select id="HPM070105DAO.selectDongtanBadmcrtList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		/*동탄배드민턴장*/
		SELECT 
		     '평일'		AS DAY
		    ,'일반권'	AS TM 
			    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_GNRL_CO, 0)         ELSE 0 END)                                       AS N_CO	
			    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_GNRL_AM, 0)         ELSE 0 END)                                       AS N_AM 
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_GNRL_CO, 0)         ELSE 0 END) AS P_CO	
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_GNRL_AM, 0)         ELSE 0 END) AS P_AM 
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_GNRL_CO, 0)         ELSE 0 END) AS T_CO	
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_GNRL_AM, 0)         ELSE 0 END) AS T_AM 
		FROM TBHPM_DONGTAN_BADMCRT_MANAGE
		UNION ALL
		SELECT
		     '평일'		AS DAY
		    ,'청소년'	AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_GNRL_CO, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_GNRL_CO	/*평일청소년_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_GNRL_AM, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_GNRL_AM	/*평일청소년_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_GNRL_CO, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_GNRL_CO	/*평일청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_GNRL_AM, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_GNRL_AM	/*평일청소년_금액*/		    
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_GNRL_CO, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_GNRL_CO	/*평일청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_GNRL_AM, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_GNRL_AM	/*평일청소년_금액*/		    
		FROM TBHPM_DONGTAN_BADMCRT_MANAGE
		UNION ALL
		SELECT		 
		     '평일'		AS DAY
		    ,'50%'	AS TM		    
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_GNRL_CO, 0)    ELSE 0 END) AS P_DSCNT_ETC_GNRL_CO		/*평일50%_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_GNRL_AM, 0)    ELSE 0 END) AS P_DSCNT_ETC_GNRL_AM		/*평일50%_금액*/ 
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_GNRL_CO, 0)  ELSE 0 END) AS P_DSCNT_ETC_GNRL_CO		/*평일50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_GNRL_AM, 0)  ELSE 0 END) AS P_DSCNT_ETC_GNRL_AM		/*평일50%_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_GNRL_CO, 0)  ELSE 0 END) AS P_DSCNT_ETC_GNRL_CO		/*평일50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_GNRL_AM, 0)  ELSE 0 END) AS P_DSCNT_ETC_GNRL_AM		/*평일50%_금액*/ 
		FROM TBHPM_DONGTAN_BADMCRT_MANAGE
		UNION ALL
		SELECT		 
		     '주말'		AS DAY
		    ,'일반권'	AS TM	
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_WKEND_CO, 0)         ELSE 0 END) AS P_GNRL_WKEND_CO		     /*주말일반권_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_WKEND_AM, 0)         ELSE 0 END) AS P_GNRL_WKEND_AM		     /*주말일반권_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_WKEND_CO, 0)         ELSE 0 END) AS P_GNRL_WKEND_CO		     /*주말일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_WKEND_AM, 0)         ELSE 0 END) AS P_GNRL_WKEND_AM		     /*주말일반권_금액*/		    
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_WKEND_CO, 0)         ELSE 0 END) AS P_GNRL_WKEND_CO		     /*주말일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_WKEND_AM, 0)         ELSE 0 END) AS P_GNRL_WKEND_AM		     /*주말일반권_금액*/
		FROM TBHPM_DONGTAN_BADMCRT_MANAGE
		UNION ALL
		SELECT		 
		     '주말'		AS DAY
		    ,'청소년'	AS TM			    		    
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_WKEND_CO, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKEND_CO   /*주말청소년_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_WKEND_AM, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKEND_AM   /*주말청소년_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_WKEND_CO, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKEND_CO   /*주말청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_WKEND_AM, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKEND_AM   /*주말청소년_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_WKEND_CO, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKEND_CO   /*주말청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_WKEND_AM, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKEND_AM   /*주말청소년_금액*/		    
		FROM TBHPM_DONGTAN_BADMCRT_MANAGE
		UNION ALL
		SELECT		 
		     '주말'		AS DAY
		    ,'50%'		AS TM			    
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_WKEND_CO, 0)    ELSE 0 END) AS P_DSCNT_ETC_WKEND_CO	     /*주말50%_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_WKEND_AM, 0)    ELSE 0 END) AS P_DSCNT_ETC_WKEND_AM	     /*주말50%_금액*/   
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_WKEND_CO, 0)    ELSE 0 END) AS P_DSCNT_ETC_WKEND_CO	     /*주말50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_WKEND_AM, 0)    ELSE 0 END) AS P_DSCNT_ETC_WKEND_AM	     /*주말50%_금액*/   
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_WKEND_CO, 0)    ELSE 0 END) AS P_DSCNT_ETC_WKEND_CO	     /*주말50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_WKEND_AM, 0)    ELSE 0 END) AS P_DSCNT_ETC_WKEND_AM	     /*주말50%_금액*/   
		FROM TBHPM_DONGTAN_BADMCRT_MANAGE
		UNION ALL
		SELECT		 
		     '정기권'	AS DAY
		    ,'일반권'	AS TM	
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_MT_CMMTKT_CO, 0)         ELSE 0 END) AS P_GNRL_MT_CMMTKT_CO			/*정기권일반권_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_MT_CMMTKT_AM, 0)         ELSE 0 END) AS P_GNRL_MT_CMMTKT_AM			/*정기권일반권_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_MT_CMMTKT_CO, 0)         ELSE 0 END) AS P_GNRL_MT_CMMTKT_CO			/*정기권일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_MT_CMMTKT_AM, 0)         ELSE 0 END) AS P_GNRL_MT_CMMTKT_AM			/*정기권일반권_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_MT_CMMTKT_CO, 0)         ELSE 0 END) AS P_GNRL_MT_CMMTKT_CO			/*정기권일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_MT_CMMTKT_AM, 0)         ELSE 0 END) AS P_GNRL_MT_CMMTKT_AM			/*정기권일반권_금액*/
		FROM TBHPM_DONGTAN_BADMCRT_MANAGE	
		UNION ALL
		SELECT		 
		     '정기권'	AS DAY
		    ,'청소년'	AS TM	    
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_MT_CMMTKT_CO, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_MT_CMMTKT_CO  /*정기권청소년_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_MT_CMMTKT_AM, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_MT_CMMTKT_AM  /*정기권청소년_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_MT_CMMTKT_CO, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_MT_CMMTKT_CO  /*정기권청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_MT_CMMTKT_AM, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_MT_CMMTKT_AM  /*정기권청소년_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_MT_CMMTKT_CO, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_MT_CMMTKT_CO  /*정기권청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_MT_CMMTKT_AM, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_MT_CMMTKT_AM  /*정기권청소년_금액*/
		FROM TBHPM_DONGTAN_BADMCRT_MANAGE
		UNION ALL
		SELECT		 
		     '정기권'	AS DAY
		    ,'50%'		AS TM    		    
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_MT_CMMTKT_CO, 0)    ELSE 0 END) AS P_DSCNT_ETC_MT_CMMTKT_CO	 	/*정기권50%_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_MT_CMMTKT_AM, 0)    ELSE 0 END) AS P_DSCNT_ETC_MT_CMMTKT_AM	 	/*정기권50%_금액*/  
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_MT_CMMTKT_CO, 0)    ELSE 0 END) AS P_DSCNT_ETC_MT_CMMTKT_CO	 	/*정기권50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_MT_CMMTKT_AM, 0)    ELSE 0 END) AS P_DSCNT_ETC_MT_CMMTKT_AM	 	/*정기권50%_금액*/  
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_MT_CMMTKT_CO, 0)    ELSE 0 END) AS P_DSCNT_ETC_MT_CMMTKT_CO	 	/*정기권50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_MT_CMMTKT_AM, 0)    ELSE 0 END) AS P_DSCNT_ETC_MT_CMMTKT_AM	 	/*정기권50%_금액*/  		    
		FROM TBHPM_DONGTAN_BADMCRT_MANAGE
	</select>
	
	<select id="HPM070105DAO.selectParkGlcrsList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		/*파크골프장*/
		SELECT 
		     '평일'		AS DAY
		    ,'일반권'	AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_WKDAY_GNRL_CO, 0)         ELSE 0 END)									 	AS N_CO			/*평일일반권_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_WKDAY_GNRL_AM, 0)         ELSE 0 END)										AS N_AM 		/*평일일반권_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_WKDAY_GNRL_CO, 0)     ELSE 0 END)	AS P_CO			/*평일일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_WKDAY_GNRL_AM, 0)     ELSE 0 END)	AS P_AM 		/*평일일반권_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_WKDAY_GNRL_CO, 0)     ELSE 0 END)	AS T_CO			/*평일일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_WKDAY_GNRL_AM, 0)     ELSE 0 END)	AS T_AM 		/*평일일반권_금액*/
		FROM TBHPM_PARK_GLCRS_MANAGE
		UNION ALL
		SELECT 
		     '평일'		AS DAY
		    ,'청소년'	AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_WKDAY_GNRL_AM, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKDAY_GNRL_AM	/*평일청소년_금액*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_WKDAY_GNRL_CO, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKDAY_GNRL_CO	/*평일청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_WKDAY_GNRL_AM, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKDAY_GNRL_AM	/*평일청소년_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_WKDAY_GNRL_CO, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKDAY_GNRL_CO	/*평일청소년_건수*/
			,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_WKDAY_GNRL_AM, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKDAY_GNRL_AM	/*평일청소년_금액*/
			,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_WKDAY_GNRL_CO, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKDAY_GNRL_CO	/*평일청소년_건수*/
		FROM TBHPM_PARK_GLCRS_MANAGE
		UNION ALL
		SELECT 
		     '평일'		AS DAY
		    ,'50%'		AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_WKDAY_GNRL_CO, 0)    ELSE 0 END) AS P_DSCNT_ETC_WKDAY_GNRL_CO		/*평일50%_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_WKDAY_GNRL_AM, 0)    ELSE 0 END) AS P_DSCNT_ETC_WKDAY_GNRL_AM       /*평일50%_금액*/  
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_WKDAY_GNRL_CO, 0) ELSE 0 END) AS P_DSCNT_ETC_WKDAY_GNRL_CO		/*평일50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_WKDAY_GNRL_AM, 0) ELSE 0 END) AS P_DSCNT_ETC_WKDAY_GNRL_AM       /*평일50%_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_WKDAY_GNRL_CO, 0) ELSE 0 END) AS P_DSCNT_ETC_WKDAY_GNRL_CO		/*평일50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_WKDAY_GNRL_AM, 0) ELSE 0 END) AS P_DSCNT_ETC_WKDAY_GNRL_AM       /*평일50%_금액*/ 		     
		FROM TBHPM_PARK_GLCRS_MANAGE
		UNION ALL
		SELECT 
		     '주말'		AS DAY
		    ,'일반권'	AS TM 		                                                                             
		    /*주말*/                                                                   
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_WKEND_GNRL_CO, 0)         ELSE 0 END) AS P_GNRL_WKEND_GNRL_CO     		/*주말일반권_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_WKEND_GNRL_AM, 0)         ELSE 0 END) AS P_GNRL_WKEND_GNRL_AM     		/*주말일반권_금액*/
			,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_WKEND_GNRL_CO, 0)         ELSE 0 END) AS P_GNRL_WKEND_GNRL_CO     		/*주말일반권_건수*/
			,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_WKEND_GNRL_AM, 0)         ELSE 0 END) AS P_GNRL_WKEND_GNRL_AM     		/*주말일반권_금액*/
			,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_WKEND_GNRL_CO, 0)         ELSE 0 END) AS P_GNRL_WKEND_GNRL_CO     		/*주말일반권_건수*/
			,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_WKEND_GNRL_AM, 0)         ELSE 0 END) AS P_GNRL_WKEND_GNRL_AM     		/*주말일반권_금액*/
		FROM TBHPM_PARK_GLCRS_MANAGE
		UNION ALL
		SELECT 
		     '주말'		AS DAY
		    ,'청소년'	AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_WKEND_GNRL_CO, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKEND_GNRL_CO	/*주말청소년_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_WKEND_GNRL_AM, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKEND_GNRL_AM	/*주말청소년_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_WKEND_GNRL_CO, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKEND_GNRL_CO	/*주말청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_WKEND_GNRL_AM, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKEND_GNRL_AM	/*주말청소년_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_WKEND_GNRL_CO, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKEND_GNRL_CO	/*주말청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_WKEND_GNRL_AM, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKEND_GNRL_AM	/*주말청소년_금액*/
		FROM TBHPM_PARK_GLCRS_MANAGE
		UNION ALL
		SELECT 
		     '주말'		AS DAY
		    ,'50%'	AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_WKEND_GNRL_CO, 0)    ELSE 0 END) AS P_DSCNT_ETC_WKEND_GNRL_CO		/*주말50%_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_WKEND_GNRL_AM, 0)    ELSE 0 END) AS P_DSCNT_ETC_WKEND_GNRL_AM		/*주말50%_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_WKEND_GNRL_CO, 0) ELSE 0 END) AS P_DSCNT_ETC_WKEND_GNRL_CO		/*주말50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_WKEND_GNRL_AM, 0) ELSE 0 END) AS P_DSCNT_ETC_WKEND_GNRL_AM		/*주말50%_금액*/  
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_WKEND_GNRL_CO, 0) ELSE 0 END) AS P_DSCNT_ETC_WKEND_GNRL_CO		/*주말50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_WKEND_GNRL_AM, 0) ELSE 0 END) AS P_DSCNT_ETC_WKEND_GNRL_AM		/*주말50%_금액*/     
			FROM TBHPM_PARK_GLCRS_MANAGE
		UNION ALL
		SELECT 
		     '정기권'		AS DAY
		    ,'일반권'	AS TM 	    
		    /*정기권*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_1MONTH_CMMTKT_CO, 0) + NVL(GNRL_3MONTH_CMMTKT_CO, 0) + NVL(GNRL_6MONTH_CMMTKT_CO, 0) + NVL(GNRL_12MONTH_CMMTKT_CO, 0) ELSE 0 END) AS P_GNRL_CMMTKT_CO			/*정기권일반권_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_1MONTH_CMMTKT_AM, 0) + NVL(GNRL_3MONTH_CMMTKT_AM, 0) + NVL(GNRL_6MONTH_CMMTKT_AM, 0) + NVL(GNRL_12MONTH_CMMTKT_AM, 0) ELSE 0 END) AS P_GNRL_CMMTKT_CO			/*정기권일반권_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_1MONTH_CMMTKT_CO, 0) + NVL(GNRL_3MONTH_CMMTKT_CO, 0) + NVL(GNRL_6MONTH_CMMTKT_CO, 0) + NVL(GNRL_12MONTH_CMMTKT_CO, 0)   ELSE 0 END) AS P_GNRL_CMMTKT_CO			/*정기권일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_1MONTH_CMMTKT_AM, 0) + NVL(GNRL_3MONTH_CMMTKT_AM, 0) + NVL(GNRL_6MONTH_CMMTKT_AM, 0) + NVL(GNRL_12MONTH_CMMTKT_AM, 0)   ELSE 0 END) AS P_GNRL_CMMTKT_CO			/*정기권일반권_금액*/
			,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_1MONTH_CMMTKT_CO, 0) + NVL(GNRL_3MONTH_CMMTKT_CO, 0) + NVL(GNRL_6MONTH_CMMTKT_CO, 0) + NVL(GNRL_12MONTH_CMMTKT_CO, 0)   ELSE 0 END) AS P_GNRL_CMMTKT_CO			/*정기권일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_1MONTH_CMMTKT_AM, 0) + NVL(GNRL_3MONTH_CMMTKT_AM, 0) + NVL(GNRL_6MONTH_CMMTKT_AM, 0) + NVL(GNRL_12MONTH_CMMTKT_AM, 0)   ELSE 0 END) AS P_GNRL_CMMTKT_CO			/*정기권일반권_금액*/
		FROM TBHPM_PARK_GLCRS_MANAGE
		UNION ALL
		SELECT 
		     '정기권'		AS DAY
		    ,'청소년'		AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_1MONTH_CMMTKT_AM, 0) + NVL(DSCNT_YNGBGS_3MONTH_CMMTKT_AM, 0) + NVL(DSCNT_YNGBGS_6MONTH_CMMTKT_AM, 0) + NVL(DSCNT_YNGBGS_12MONTH_CMMTKT_AM, 0)   ELSE 0 END) AS P_DSCNT_YNGBGS_CMMTKT_CO	/*정기권청소년_금액*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_1MONTH_CMMTKT_CO, 0) + NVL(DSCNT_YNGBGS_3MONTH_CMMTKT_CO, 0) + NVL(DSCNT_YNGBGS_6MONTH_CMMTKT_CO, 0) + NVL(DSCNT_YNGBGS_12MONTH_CMMTKT_CO, 0)   ELSE 0 END) AS P_DSCNT_YNGBGS_CMMTKT_CO	/*정기권청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_1MONTH_CMMTKT_AM, 0) + NVL(DSCNT_YNGBGS_3MONTH_CMMTKT_AM, 0) + NVL(DSCNT_YNGBGS_6MONTH_CMMTKT_AM, 0) + NVL(DSCNT_YNGBGS_12MONTH_CMMTKT_AM, 0)   ELSE 0 END) AS P_DSCNT_YNGBGS_CMMTKT_CO	/*정기권청소년_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_1MONTH_CMMTKT_CO, 0) + NVL(DSCNT_YNGBGS_3MONTH_CMMTKT_CO, 0) + NVL(DSCNT_YNGBGS_6MONTH_CMMTKT_CO, 0) + NVL(DSCNT_YNGBGS_12MONTH_CMMTKT_CO, 0)   ELSE 0 END) AS P_DSCNT_YNGBGS_CMMTKT_CO	/*정기권청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_1MONTH_CMMTKT_AM, 0) + NVL(DSCNT_YNGBGS_3MONTH_CMMTKT_AM, 0) + NVL(DSCNT_YNGBGS_6MONTH_CMMTKT_AM, 0) + NVL(DSCNT_YNGBGS_12MONTH_CMMTKT_AM, 0)   ELSE 0 END) AS P_DSCNT_YNGBGS_CMMTKT_CO	/*정기권청소년_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_1MONTH_CMMTKT_CO, 0) + NVL(DSCNT_YNGBGS_3MONTH_CMMTKT_CO, 0) + NVL(DSCNT_YNGBGS_6MONTH_CMMTKT_CO, 0) + NVL(DSCNT_YNGBGS_12MONTH_CMMTKT_CO, 0)   ELSE 0 END) AS P_DSCNT_YNGBGS_CMMTKT_CO	/*정기권청소년_건수*/		    
		FROM TBHPM_PARK_GLCRS_MANAGE
		UNION ALL
		SELECT 
		     '정기권'		AS DAY
		    ,'50%'			AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_1MONTH_CMMTKT_CO, 0) + NVL(DSCNT_ETC_3MONTH_CMMTKT_CO, 0) + NVL(DSCNT_ETC_6MONTH_CMMTKT_CO, 0) + NVL(DSCNT_ETC_12MONTH_CMMTKT_CO, 0) ELSE 0 END) AS P_DSCNT_ETC_CMMTKT_CO		/*정기권50%_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_1MONTH_CMMTKT_AM, 0) + NVL(DSCNT_ETC_3MONTH_CMMTKT_AM, 0) + NVL(DSCNT_ETC_6MONTH_CMMTKT_AM, 0) + NVL(DSCNT_ETC_12MONTH_CMMTKT_AM, 0) ELSE 0 END) AS P_DSCNT_ETC_CMMTKT_CO		/*정기권50%_금액*/  
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_1MONTH_CMMTKT_CO, 0) + NVL(DSCNT_ETC_3MONTH_CMMTKT_CO, 0) + NVL(DSCNT_ETC_6MONTH_CMMTKT_CO, 0) + NVL(DSCNT_ETC_12MONTH_CMMTKT_CO, 0)  ELSE 0 END) AS P_DSCNT_ETC_CMMTKT_CO		/*정기권50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_1MONTH_CMMTKT_AM, 0) + NVL(DSCNT_ETC_3MONTH_CMMTKT_AM, 0) + NVL(DSCNT_ETC_6MONTH_CMMTKT_AM, 0) + NVL(DSCNT_ETC_12MONTH_CMMTKT_AM, 0)  ELSE 0 END) AS P_DSCNT_ETC_CMMTKT_CO		/*정기권50%_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_1MONTH_CMMTKT_CO, 0) + NVL(DSCNT_ETC_3MONTH_CMMTKT_CO, 0) + NVL(DSCNT_ETC_6MONTH_CMMTKT_CO, 0) + NVL(DSCNT_ETC_12MONTH_CMMTKT_CO, 0)  ELSE 0 END) AS P_DSCNT_ETC_CMMTKT_CO		/*정기권50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_1MONTH_CMMTKT_AM, 0) + NVL(DSCNT_ETC_3MONTH_CMMTKT_AM, 0) + NVL(DSCNT_ETC_6MONTH_CMMTKT_AM, 0) + NVL(DSCNT_ETC_12MONTH_CMMTKT_AM, 0)  ELSE 0 END) AS P_DSCNT_ETC_CMMTKT_CO		/*정기권50%_금액*/		    
		FROM TBHPM_PARK_GLCRS_MANAGE
	</select>
	
	<select id="HPM070105DAO.selectHyangnamParkGlcrsList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		/*파크골프장*/
		SELECT 
		     '평일'		AS DAY
		    ,'일반권'	AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_WKDAY_GNRL_CO, 0)  ELSE 0 END)									 	AS N_CO	   		/*평일일반권_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_WKDAY_GNRL_AM, 0)  ELSE 0 END)										AS N_AM    		/*평일일반권_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_WKDAY_GNRL_CO, 0)     ELSE 0 END)	AS P_CO	   		/*평일일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_WKDAY_GNRL_AM, 0)     ELSE 0 END)	AS P_AM    		/*평일일반권_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_WKDAY_GNRL_CO, 0)     ELSE 0 END)	AS T_CO			/*평일일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_WKDAY_GNRL_AM, 0)     ELSE 0 END)	AS T_AM    		/*평일일반권_금액*/
		FROM TBHPM_HYANGNAM_PARK_GLCRS
		UNION ALL
		SELECT 
		     '평일'		AS DAY
		    ,'청소년'	AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_WKDAY_GNRL_AM, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKDAY_GNRL_AM	/*평일청소년_금액*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_WKDAY_GNRL_CO, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKDAY_GNRL_CO	/*평일청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_WKDAY_GNRL_AM, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKDAY_GNRL_AM	/*평일청소년_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_WKDAY_GNRL_CO, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKDAY_GNRL_CO	/*평일청소년_건수*/
			,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_WKDAY_GNRL_AM, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKDAY_GNRL_AM	/*평일청소년_금액*/
			,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_WKDAY_GNRL_CO, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKDAY_GNRL_CO	/*평일청소년_건수*/
		FROM TBHPM_HYANGNAM_PARK_GLCRS
		UNION ALL
		SELECT 
		     '평일'		AS DAY
		    ,'50%'		AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_WKDAY_GNRL_CO, 0)    ELSE 0 END) AS P_DSCNT_ETC_WKDAY_GNRL_CO		/*평일50%_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_WKDAY_GNRL_AM, 0)    ELSE 0 END) AS P_DSCNT_ETC_WKDAY_GNRL_AM       /*평일50%_금액*/  
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_WKDAY_GNRL_CO, 0)    ELSE 0 END) AS P_DSCNT_ETC_WKDAY_GNRL_CO		/*평일50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_WKDAY_GNRL_AM, 0)    ELSE 0 END) AS P_DSCNT_ETC_WKDAY_GNRL_AM       /*평일50%_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_WKDAY_GNRL_CO, 0)    ELSE 0 END) AS P_DSCNT_ETC_WKDAY_GNRL_CO		/*평일50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_WKDAY_GNRL_AM, 0)    ELSE 0 END) AS P_DSCNT_ETC_WKDAY_GNRL_AM       /*평일50%_금액*/ 		     
		FROM TBHPM_HYANGNAM_PARK_GLCRS
		UNION ALL
		SELECT 
		     '주말'		AS DAY
		    ,'일반권'	AS TM 		                                                                             
		    /*주말*/                                                                   
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_WKEND_GNRL_CO, 0)         ELSE 0 END) AS P_GNRL_WKEND_GNRL_CO     		/*주말일반권_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_WKEND_GNRL_AM, 0)         ELSE 0 END) AS P_GNRL_WKEND_GNRL_AM     		/*주말일반권_금액*/
			,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_WKEND_GNRL_CO, 0)  ELSE 0 END) AS P_GNRL_WKEND_GNRL_CO     		/*주말일반권_건수*/
			,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_WKEND_GNRL_AM, 0)  ELSE 0 END) AS P_GNRL_WKEND_GNRL_AM     		/*주말일반권_금액*/
			,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_WKEND_GNRL_CO, 0)  ELSE 0 END) AS P_GNRL_WKEND_GNRL_CO     		/*주말일반권_건수*/
			,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_WKEND_GNRL_AM, 0)  ELSE 0 END) AS P_GNRL_WKEND_GNRL_AM     		/*주말일반권_금액*/
		FROM TBHPM_HYANGNAM_PARK_GLCRS
		UNION ALL
		SELECT 
		     '주말'		AS DAY
		    ,'청소년'	AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_WKEND_GNRL_CO, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKEND_GNRL_CO	/*주말청소년_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_WKEND_GNRL_AM, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKEND_GNRL_AM	/*주말청소년_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_WKEND_GNRL_CO, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKEND_GNRL_CO	/*주말청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_WKEND_GNRL_AM, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKEND_GNRL_AM	/*주말청소년_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_WKEND_GNRL_CO, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKEND_GNRL_CO	/*주말청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_WKEND_GNRL_AM, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_WKEND_GNRL_AM	/*주말청소년_금액*/
		FROM TBHPM_HYANGNAM_PARK_GLCRS
		UNION ALL
		SELECT 
		     '주말'		AS DAY
		    ,'50%'	AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_WKEND_GNRL_CO, 0)    ELSE 0 END) AS P_DSCNT_ETC_WKEND_GNRL_CO		/*주말50%_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_WKEND_GNRL_AM, 0)    ELSE 0 END) AS P_DSCNT_ETC_WKEND_GNRL_AM		/*주말50%_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_WKEND_GNRL_CO, 0)  ELSE 0 END) AS P_DSCNT_ETC_WKEND_GNRL_CO		/*주말50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_WKEND_GNRL_AM, 0)  ELSE 0 END) AS P_DSCNT_ETC_WKEND_GNRL_AM		/*주말50%_금액*/  
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_WKEND_GNRL_CO, 0)  ELSE 0 END) AS P_DSCNT_ETC_WKEND_GNRL_CO		/*주말50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_WKEND_GNRL_AM, 0)  ELSE 0 END) AS P_DSCNT_ETC_WKEND_GNRL_AM		/*주말50%_금액*/     
			FROM TBHPM_HYANGNAM_PARK_GLCRS
		UNION ALL
		SELECT 
		     '정기권'		AS DAY
		    ,'일반권'	AS TM 	    
		    /*정기권*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_1MONTH_CMMTKT_CO, 0) + NVL(GNRL_3MONTH_CMMTKT_CO, 0) + NVL(GNRL_6MONTH_CMMTKT_CO, 0) + NVL(GNRL_12MONTH_CMMTKT_CO, 0)      ELSE 0 END) AS P_GNRL_CMMTKT_CO			/*정기권일반권_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_1MONTH_CMMTKT_AM, 0) + NVL(GNRL_3MONTH_CMMTKT_AM, 0) + NVL(GNRL_6MONTH_CMMTKT_AM, 0) + NVL(GNRL_12MONTH_CMMTKT_AM, 0)      ELSE 0 END) AS P_GNRL_CMMTKT_CO			/*정기권일반권_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_1MONTH_CMMTKT_CO, 0) + NVL(GNRL_3MONTH_CMMTKT_CO, 0) + NVL(GNRL_6MONTH_CMMTKT_CO, 0) + NVL(GNRL_12MONTH_CMMTKT_CO, 0)  ELSE 0 END) AS P_GNRL_CMMTKT_CO			/*정기권일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_1MONTH_CMMTKT_AM, 0) + NVL(GNRL_3MONTH_CMMTKT_AM, 0) + NVL(GNRL_6MONTH_CMMTKT_AM, 0) + NVL(GNRL_12MONTH_CMMTKT_AM, 0)  ELSE 0 END) AS P_GNRL_CMMTKT_CO			/*정기권일반권_금액*/
			,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_1MONTH_CMMTKT_CO, 0) + NVL(GNRL_3MONTH_CMMTKT_CO, 0) + NVL(GNRL_6MONTH_CMMTKT_CO, 0) + NVL(GNRL_12MONTH_CMMTKT_CO, 0)  ELSE 0 END) AS P_GNRL_CMMTKT_CO			/*정기권일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_1MONTH_CMMTKT_AM, 0) + NVL(GNRL_3MONTH_CMMTKT_AM, 0) + NVL(GNRL_6MONTH_CMMTKT_AM, 0) + NVL(GNRL_12MONTH_CMMTKT_AM, 0)  ELSE 0 END) AS P_GNRL_CMMTKT_CO			/*정기권일반권_금액*/
		FROM TBHPM_HYANGNAM_PARK_GLCRS
		UNION ALL
		SELECT 
		     '정기권'		AS DAY
		    ,'청소년'		AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_1MONTH_CMMTKT_AM, 0) + NVL(DSCNT_YNGBGS_3MONTH_CMMTKT_AM, 0) + NVL(DSCNT_YNGBGS_6MONTH_CMMTKT_AM, 0) + NVL(DSCNT_YNGBGS_12MONTH_CMMTKT_AM, 0)   ELSE 0 END) AS P_DSCNT_YNGBGS_CMMTKT_CO	/*정기권청소년_금액*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_1MONTH_CMMTKT_CO, 0) + NVL(DSCNT_YNGBGS_3MONTH_CMMTKT_CO, 0) + NVL(DSCNT_YNGBGS_6MONTH_CMMTKT_CO, 0) + NVL(DSCNT_YNGBGS_12MONTH_CMMTKT_CO, 0)   ELSE 0 END) AS P_DSCNT_YNGBGS_CMMTKT_CO	/*정기권청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_1MONTH_CMMTKT_AM, 0) + NVL(DSCNT_YNGBGS_3MONTH_CMMTKT_AM, 0) + NVL(DSCNT_YNGBGS_6MONTH_CMMTKT_AM, 0) + NVL(DSCNT_YNGBGS_12MONTH_CMMTKT_AM, 0)   ELSE 0 END) AS P_DSCNT_YNGBGS_CMMTKT_CO	/*정기권청소년_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_1MONTH_CMMTKT_CO, 0) + NVL(DSCNT_YNGBGS_3MONTH_CMMTKT_CO, 0) + NVL(DSCNT_YNGBGS_6MONTH_CMMTKT_CO, 0) + NVL(DSCNT_YNGBGS_12MONTH_CMMTKT_CO, 0)   ELSE 0 END) AS P_DSCNT_YNGBGS_CMMTKT_CO	/*정기권청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_1MONTH_CMMTKT_AM, 0) + NVL(DSCNT_YNGBGS_3MONTH_CMMTKT_AM, 0) + NVL(DSCNT_YNGBGS_6MONTH_CMMTKT_AM, 0) + NVL(DSCNT_YNGBGS_12MONTH_CMMTKT_AM, 0)   ELSE 0 END) AS P_DSCNT_YNGBGS_CMMTKT_CO	/*정기권청소년_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_1MONTH_CMMTKT_CO, 0) + NVL(DSCNT_YNGBGS_3MONTH_CMMTKT_CO, 0) + NVL(DSCNT_YNGBGS_6MONTH_CMMTKT_CO, 0) + NVL(DSCNT_YNGBGS_12MONTH_CMMTKT_CO, 0)   ELSE 0 END) AS P_DSCNT_YNGBGS_CMMTKT_CO	/*정기권청소년_건수*/		    
		FROM TBHPM_HYANGNAM_PARK_GLCRS
		UNION ALL
		SELECT 
		     '정기권'		AS DAY
		    ,'50%'			AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_1MONTH_CMMTKT_CO, 0) + NVL(DSCNT_ETC_3MONTH_CMMTKT_CO, 0) + NVL(DSCNT_ETC_6MONTH_CMMTKT_CO, 0) + NVL(DSCNT_ETC_12MONTH_CMMTKT_CO, 0) ELSE 0 END) AS P_DSCNT_ETC_CMMTKT_CO		/*정기권50%_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_1MONTH_CMMTKT_AM, 0) + NVL(DSCNT_ETC_3MONTH_CMMTKT_AM, 0) + NVL(DSCNT_ETC_6MONTH_CMMTKT_AM, 0) + NVL(DSCNT_ETC_12MONTH_CMMTKT_AM, 0) ELSE 0 END) AS P_DSCNT_ETC_CMMTKT_CO		/*정기권50%_금액*/  
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_1MONTH_CMMTKT_CO, 0) + NVL(DSCNT_ETC_3MONTH_CMMTKT_CO, 0) + NVL(DSCNT_ETC_6MONTH_CMMTKT_CO, 0) + NVL(DSCNT_ETC_12MONTH_CMMTKT_CO, 0)  ELSE 0 END) AS P_DSCNT_ETC_CMMTKT_CO		/*정기권50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_1MONTH_CMMTKT_AM, 0) + NVL(DSCNT_ETC_3MONTH_CMMTKT_AM, 0) + NVL(DSCNT_ETC_6MONTH_CMMTKT_AM, 0) + NVL(DSCNT_ETC_12MONTH_CMMTKT_AM, 0)  ELSE 0 END) AS P_DSCNT_ETC_CMMTKT_CO		/*정기권50%_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_1MONTH_CMMTKT_CO, 0) + NVL(DSCNT_ETC_3MONTH_CMMTKT_CO, 0) + NVL(DSCNT_ETC_6MONTH_CMMTKT_CO, 0) + NVL(DSCNT_ETC_12MONTH_CMMTKT_CO, 0)  ELSE 0 END) AS P_DSCNT_ETC_CMMTKT_CO		/*정기권50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_1MONTH_CMMTKT_AM, 0) + NVL(DSCNT_ETC_3MONTH_CMMTKT_AM, 0) + NVL(DSCNT_ETC_6MONTH_CMMTKT_AM, 0) + NVL(DSCNT_ETC_12MONTH_CMMTKT_AM, 0)  ELSE 0 END) AS P_DSCNT_ETC_CMMTKT_CO		/*정기권50%_금액*/		    
		FROM TBHPM_HYANGNAM_PARK_GLCRS
	</select>
	
	<select id="HPM070105DAO.selectAchsteList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
			 '주간'		AS DAY
		    ,'일반권'	AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_DAYTM_CO, 0)         ELSE 0 END) 									AS N_CO			/*주간일반권(월)_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_DAYTM_AM, 0)         ELSE 0 END) 									AS N_AM 		/*주간일반권(월)_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_DAYTM_CO, 0)  ELSE 0 END)	AS P_CO			/*주간일반권(전월)_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_DAYTM_AM, 0)  ELSE 0 END)	AS P_AM 		/*주간일반권(전월)_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_DAYTM_CO, 0)  ELSE 0 END)	AS T_CO			/*주간일반권(총계)_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_DAYTM_AM, 0)  ELSE 0 END)	AS T_AM 		/*주간일반권(총계)_금액*/
		FROM TBHPM_ACHSTE_MANAGE   		   
		UNION ALL
		SELECT	
			 '주간'		AS DAY
		    ,'청소년'	AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_DAYTM_CO, 0) ELSE 0 END)												AS N_DSCNT_YNGBGS_DAYTM_CO	/*주간청소년(월)_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_DAYTM_AM, 0) ELSE 0 END)												AS N_DSCNT_YNGBGS_DAYTM_AM	/*주간청소년(월)_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM#	THEN NVL(DSCNT_YNGBGS_DAYTM_CO, 0) ELSE 0 END)	AS P_DSCNT_YNGBGS_DAYTM_CO	/*주간청소년(전월)_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM#	THEN NVL(DSCNT_YNGBGS_DAYTM_AM, 0) ELSE 0 END)	AS P_DSCNT_YNGBGS_DAYTM_AM	/*주간청소년(전월)_금액*/
		   	,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM# 		THEN NVL(DSCNT_YNGBGS_DAYTM_CO, 0) ELSE 0 END)	AS T_DSCNT_YNGBGS_DAYTM_CO	/*주간청소년(총계)_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM# 		THEN NVL(DSCNT_YNGBGS_DAYTM_AM, 0) ELSE 0 END)	AS T_DSCNT_YNGBGS_DAYTM_AM	/*주간청소년(총계)_금액*/		    
		FROM TBHPM_ACHSTE_MANAGE   		   
		UNION ALL
		SELECT	
			 '주간'		AS DAY
		    ,'50%'		AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_DAYTM_CO, 0)    ELSE 0 END)												AS N_DSCNT_ETC_DAYTM_CO		/*주간50%(월)_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_DAYTM_AM, 0)    ELSE 0 END)												AS N_DSCNT_ETC_DAYTM_AM		/*주간50%(월)_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_DAYTM_CO, 0)    ELSE 0 END)	AS P_DSCNT_ETC_DAYTM_CO		/*주간50%(전월)_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_DAYTM_AM, 0)    ELSE 0 END)	AS P_DSCNT_ETC_DAYTM_AM		/*주간50%(전월)_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_DAYTM_CO, 0)    ELSE 0 END)	AS T_DSCNT_ETC_DAYTM_CO		/*주간50%(총계)_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_DAYTM_AM, 0)    ELSE 0 END)	AS T_DSCNT_ETC_DAYTM_AM		/*주간50%(총계)_금액*/
		FROM TBHPM_ACHSTE_MANAGE   		   
		UNION ALL
		SELECT	
			 '조/야간'		AS DAY
		    ,'일반권'		AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_MORN_NIGHT_CO, 0)         ELSE 0 END) 										AS N_GNRL_MORN_NIGHT_CO		/*조야간일반권(월)_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_MORN_NIGHT_AM, 0)         ELSE 0 END) 										AS N_GNRL_MORN_NIGHT_AM		/*조야간일반권(월)_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_MORN_NIGHT_CO, 0)     ELSE 0 END)	AS P_GNRL_MORN_NIGHT_CO		/*조야간일반권(전월)_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_MORN_NIGHT_AM, 0)     ELSE 0 END)	AS P_GNRL_MORN_NIGHT_AM		/*조야간일반권(전월)_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_MORN_NIGHT_CO, 0)     ELSE 0 END)	AS T_GNRL_MORN_NIGHT_CO		/*조야간일반권(총계)_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_MORN_NIGHT_AM, 0)     ELSE 0 END)	AS T_GNRL_MORN_NIGHT_AM		/*조야간일반권(총계)_금액*/
		FROM TBHPM_ACHSTE_MANAGE   		   
		UNION ALL
		SELECT	
			 '조/야간'		AS DAY
		    ,'청소년'		AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_MORN_NIGHT_CO, 0) ELSE 0 END)											AS N_DSCNT_YNGBGS_MORN_NIGHT_CO		/*조야간청소년(월)_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_MORN_NIGHT_AM, 0) ELSE 0 END)											AS N_DSCNT_YNGBGS_MORN_NIGHT_AM		/*조야간청소년(월)_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_MORN_NIGHT_CO, 0) ELSE 0 END)	AS P_DSCNT_YNGBGS_MORN_NIGHT_CO		/*조야간청소년(전월)_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_MORN_NIGHT_AM, 0) ELSE 0 END)	AS P_DSCNT_YNGBGS_MORN_NIGHT_AM		/*조야간청소년(전월)_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_MORN_NIGHT_CO, 0) ELSE 0 END)	AS T_DSCNT_YNGBGS_MORN_NIGHT_CO		/*조야간청소년(총계)_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_MORN_NIGHT_AM, 0) ELSE 0 END)	AS T_DSCNT_YNGBGS_MORN_NIGHT_AM		/*조야간청소년(총계)_금액*/
		FROM TBHPM_ACHSTE_MANAGE   		   
		UNION ALL
		SELECT	
			 '조/야간'		AS DAY
		    ,'50%'			AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_MORN_NIGHT_CO, 0)    ELSE 0 END) 											AS N_DSCNT_ETC_MORN_NIGHT_CO		/*조야간50%(월)_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_MORN_NIGHT_AM, 0)    ELSE 0 END)											AS N_DSCNT_ETC_MORN_NIGHT_AM		/*조야간50%(월)_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_MORN_NIGHT_CO, 0)    ELSE 0 END)	AS P_DSCNT_ETC_MORN_NIGHT_CO		/*조야간50%(전월)_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_MORN_NIGHT_AM, 0)    ELSE 0 END)	AS P_DSCNT_ETC_MORN_NIGHT_AM		/*조야간50%(전월)_금액*/		    
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_MORN_NIGHT_CO, 0)    ELSE 0 END)	AS T_DSCNT_ETC_MORN_NIGHT_CO		/*조야간50%(총계)_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_MORN_NIGHT_AM, 0)    ELSE 0 END)	AS T_DSCNT_ETC_MORN_NIGHT_AM		/*조야간50%(총계)_금액*/
		FROM TBHPM_ACHSTE_MANAGE   		   
		UNION ALL
		SELECT	
			 '정기권'		AS DAY
		    ,'일반권'		AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_MT_CMMTKT_CO, 0)      ELSE 0 END) 											AS N_GNRL_MT_CMMTKT_CO		/*정기권일반권_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(GNRL_MT_CMMTKT_AM, 0)      ELSE 0 END) 											AS N_GNRL_MT_CMMTKT_AM		/*정기권일반권_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_MT_CMMTKT_CO, 0)      ELSE 0 END)	AS P_GNRL_MT_CMMTKT_CO		/*정기권일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(GNRL_MT_CMMTKT_AM, 0)      ELSE 0 END)	AS P_GNRL_MT_CMMTKT_AM		/*정기권일반권_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_MT_CMMTKT_CO, 0)      ELSE 0 END)	AS T_GNRL_MT_CMMTKT_CO		/*정기권일반권_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(GNRL_MT_CMMTKT_AM, 0)      ELSE 0 END)	AS T_GNRL_MT_CMMTKT_AM		/*정기권일반권_금액*/
		FROM TBHPM_ACHSTE_MANAGE   		   
		UNION ALL
		SELECT	
			 '정기권'		AS DAY
		    ,'청소년'		AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_CMMTKT_CO, 0) ELSE 0 END) 										AS N_DSCNT_YNGBGS_CMMTKT_CO		/*정기권청소년_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_YNGBGS_CMMTKT_AM, 0) ELSE 0 END) 										AS N_DSCNT_YNGBGS_CMMTKT_AM		/*정기권청소년_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_CMMTKT_CO, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_CMMTKT_CO	/*정기권청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_YNGBGS_CMMTKT_AM, 0) ELSE 0 END) AS P_DSCNT_YNGBGS_CMMTKT_AM	/*정기권청소년_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_CMMTKT_CO, 0) ELSE 0 END) AS T_DSCNT_YNGBGS_CMMTKT_CO	/*정기권청소년_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_YNGBGS_CMMTKT_AM, 0) ELSE 0 END) AS T_DSCNT_YNGBGS_CMMTKT_AM	/*정기권청소년_금액*/
		FROM TBHPM_ACHSTE_MANAGE   		   
		UNION ALL
		SELECT	
			 '정기권'		AS DAY
		    ,'50%'			AS TM 
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_CMMTKT_CO, 0)    ELSE 0 END) 										AS N_DSCNT_ETC_CMMTKT_CO		/*정기권50%_건수*/
		    ,SUM(CASE WHEN YM = #YM# THEN NVL(DSCNT_ETC_CMMTKT_AM, 0)    ELSE 0 END) 										AS N_DSCNT_ETC_CMMTKT_AM		/*정기권50%_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_CMMTKT_CO, 0)    ELSE 0 END) AS P_DSCNT_ETC_CMMTKT_CO		/*정기권50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #PRE_YM# THEN NVL(DSCNT_ETC_CMMTKT_AM, 0)    ELSE 0 END) AS P_DSCNT_ETC_CMMTKT_AM		/*정기권50%_금액*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_CMMTKT_CO, 0)    ELSE 0 END) AS T_DSCNT_ETC_CMMTKT_CO		/*정기권50%_건수*/
		    ,SUM(CASE WHEN YM BETWEEN SUBSTR(#YM#, 0, 4) || '01'  AND #YM#     THEN NVL(DSCNT_ETC_CMMTKT_AM, 0)    ELSE 0 END) AS T_DSCNT_ETC_CMMTKT_AM		/*정기권50%_금액*/
		  
		FROM TBHPM_ACHSTE_MANAGE
	</select>
		
</sqlMap>