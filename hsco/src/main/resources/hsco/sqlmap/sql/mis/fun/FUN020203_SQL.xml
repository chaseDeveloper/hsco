<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="FUN020203_SQL">	
	<typeAlias alias="egovMap"          type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	
	<!-- 사업별명세 조회 -->
	<select id="FUN020203DAO.selectPbncdList01" resultClass="java.util.HashMap">
		<![CDATA[	
			SELECT '1' AS DV1
			     , '공사채(A=B+C)' AS DV2
			     , '' AS BSNS_CODE
			     , '' AS BSNS_NM
			     , 'A00' AS CPTAL_KND
			     , '합계' AS CPTAL_KND_NM
			     , MIN(AA.BRRW_DE) AS BRRW_DE
			     , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
			     , NVL(TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00'), '0.00') AS INTRT
			     , NVL(TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#), 0) AS BRRW_AMOUNT
			     , NVL(TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS PRNCPAL_RPAY_AMOUNT
			     , NVL(TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS INTR_RPAY_AMOUNT
			     , NVL(TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#), 0) AS BRRW_BALANCE
			FROM
			(
			      SELECT '' AS DV1
			           , '' AS DV2
			           , AA.BSNS_CODE AS BSNS_CODE
			           , AA.BSNS_NM AS BSNS_NM
			           , AA.CPTAL_KND AS CPTAL_KND
			           , AA.CPTAL_KND_NM AS CPTAL_KND_NM
			           , MIN(AA.BRRW_DE) AS BRRW_DE
			           , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
			           , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
			           , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
			           , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
			           , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
			           , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
			      FROM 
			      (
			              select A.BSNS_CODE
			                   , B.BSNS_NM
			                   , A.CPTAL_KND
			                   , C.CODE_NM AS CPTAL_KND_NM
			                   , A.BRRW_DE
			                   , A.EXPRTN_DE
			                   , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
			                   , A.INTRT     
			                   , A.BRRW_AMOUNT
			                   , CASE WHEN A.LEASE_YM IS NOT NULL OR A.LEASE_YM <= #SEARCH_DE#
                                      THEN 'Y'
                                      ELSE 'N'
                           		 END AS LEASE_YN   
			                   ,NVL((
			                      SELECT SUM(AA.RPAY_AMOUNT)
			                      FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
			                      WHERE AA.PBNCD_NO = A.PBNCD_NO
			                      AND   AA.RPAY_DE <= #SEARCH_DE#
			                    ) ,0) AS PRNCPAL_RPAY_AMOUNT
			                   ,NVL((
			                      SELECT SUM(AA.RPAY_AMOUNT)
			                      FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
			                      WHERE AA.PBNCD_NO = A.PBNCD_NO
			                      AND   AA.RPAY_DE <= #SEARCH_DE#
			                    ) ,0) AS INTR_RPAY_AMOUNT        
			                   , NVL(A.BRRW_AMOUNT ,0) - NVL((
			                        SELECT SUM(AA.RPAY_AMOUNT)
			                        FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
			                        WHERE AA.PBNCD_NO = A.PBNCD_NO
			                        AND   AA.RPAY_DE <= #SEARCH_DE#
			                    ) ,0) AS BRRW_BALANCE         
			              from TBFUN_PBNCD A
			              LEFT OUTER JOIN TBPRJ_BSNS_CODE B
			              ON A.BSNS_CODE = B.BSNS_CODE
			              LEFT OUTER JOIN
			                (
			                  SELECT DETAIL_CODE AS CODE ,
			                    DETAIL_CODE_NM   AS CODE_NM
			                  FROM TBFUN_CPTAL_DETAIL_CODE
			                  WHERE CODE_SE = '000'
			                )
			                C
			              ON A.CPTAL_KND = C.CODE
			              WHERE A.BRRW_DE <= #SEARCH_DE#
			      ) AA
			      GROUP BY AA.LEASE_YN, AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
			) AA
			WHERE AA.BRRW_BALANCE > 0
			
			UNION ALL
			
			SELECT *
			FROM 
			(
			      SELECT '2' AS DV1
			           , '' AS DV2
			           , '' AS BSNS_CODE
			           , '' AS BSNS_NM
			           , '' AS CPTAL_KND
			           , AA.CPTAL_KND_NM
			           , MIN(AA.BRRW_DE) AS BRRW_DE
			           , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
			           , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
			           , TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#) AS BRRW_AMOUNT
			           , TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#) AS PRNCPAL_RPAY_AMOUNT
			           , TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#) AS INTR_RPAY_AMOUNT
			           , TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#) AS BRRW_BALANCE
			      FROM
			      (
						  SELECT '' AS DV1
		                       , '' AS DV2
		                       , AA.BSNS_CODE AS BSNS_CODE
		                       , AA.BSNS_NM AS BSNS_NM
		                       , AA.CPTAL_KND AS CPTAL_KND
		                       , AA.CPTAL_KND_NM AS CPTAL_KND_NM
		                       , AA.LEASE_YN AS LEASE_YN
		                       , MIN(AA.BRRW_DE) AS BRRW_DE
		                       , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
		                       , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
		                       , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
		                       , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
		                       , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
		                       , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
		                  FROM 
		                  (
		                          select A.BSNS_CODE
		                               , B.BSNS_NM
		                               , A.CPTAL_KND
		                               , C.CODE_NM AS CPTAL_KND_NM
		                               , A.BRRW_DE
		                               , A.EXPRTN_DE
		                               , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
		                               , A.INTRT     
		                               , A.BRRW_AMOUNT
		                               , A.LEASE_YM
		                               , CASE WHEN A.LEASE_YM IS NOT NULL OR A.LEASE_YM <= #SEARCH_DE#
		                                      THEN 'Y'
		                                      ELSE 'N'
		                                 END AS LEASE_YN                               
		                               ,NVL((
		                                  SELECT SUM(AA.RPAY_AMOUNT)
		                                  FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
		                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
		                                  AND   AA.RPAY_DE <= #SEARCH_DE#
		                                ) ,0) AS PRNCPAL_RPAY_AMOUNT
		                               ,NVL((
		                                  SELECT SUM(AA.RPAY_AMOUNT)
		                                  FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
		                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
		                                  AND   AA.RPAY_DE <= #SEARCH_DE#
		                                ) ,0) AS INTR_RPAY_AMOUNT        
		                               , NVL(A.BRRW_AMOUNT ,0) - NVL((
		                                    SELECT SUM(AA.RPAY_AMOUNT)
		                                    FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
		                                    WHERE AA.PBNCD_NO = A.PBNCD_NO
		                                    AND   AA.RPAY_DE <= #SEARCH_DE#
		                                ) ,0) AS BRRW_BALANCE         
		                          from TBFUN_PBNCD A
		                          LEFT OUTER JOIN TBPRJ_BSNS_CODE B
		                          ON A.BSNS_CODE = B.BSNS_CODE
		                          LEFT OUTER JOIN
		                            (
		                              SELECT DETAIL_CODE AS CODE ,
		                                DETAIL_CODE_NM   AS CODE_NM
		                              FROM TBFUN_CPTAL_DETAIL_CODE
		                              WHERE CODE_SE = '000'
		                            )
		                            C
		                          ON A.CPTAL_KND = C.CODE
		                          WHERE A.BRRW_DE <= #SEARCH_DE#
		                  ) AA
		                  GROUP BY AA.LEASE_YN, AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
			      ) AA
			      WHERE AA.BRRW_BALANCE > 0
			      GROUP BY AA.CPTAL_KND_NM
			      ORDER BY AA.CPTAL_KND_NM
			)
			
			UNION ALL
			
			SELECT '3' AS DV1
			     , '금융부채(B=B1+B2)' AS DV2
			     , '' AS BSNS_CODE
			     , '' AS BSNS_NM
			     , '' AS CPTAL_KND
			     , '합계' AS CPTAL_KND_NM
			     , MIN(AA.BRRW_DE) AS BRRW_DE
			     , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
			     , NVL(TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00'), '0.00') AS INTRT
			     , NVL(TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#), 0) AS BRRW_AMOUNT
			     , NVL(TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS PRNCPAL_RPAY_AMOUNT
			     , NVL(TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS INTR_RPAY_AMOUNT
			     , NVL(TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#), 0) AS BRRW_BALANCE
			FROM
			(
				      SELECT '' AS DV1
	                       , '' AS DV2
	                       , AA.BSNS_CODE AS BSNS_CODE
	                       , AA.BSNS_NM AS BSNS_NM
	                       , AA.CPTAL_KND AS CPTAL_KND
	                       , AA.CPTAL_KND_NM AS CPTAL_KND_NM
	                       , MIN(AA.BRRW_DE) AS BRRW_DE
	                       , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
	                       , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
	                       , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
	                       , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
	                       , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
	                       , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
	                  FROM 
	                  (
	                          select A.BSNS_CODE
	                               , B.BSNS_NM
	                               , A.CPTAL_KND
	                               , C.CODE_NM AS CPTAL_KND_NM
	                               , A.BRRW_DE
	                               , A.EXPRTN_DE
	                               , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
	                               , A.INTRT     
	                               , A.BRRW_AMOUNT
	                               , A.LEASE_YM
	                               ,NVL((
	                                  SELECT SUM(AA.RPAY_AMOUNT)
	                                  FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
	                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
	                                  AND   AA.RPAY_DE <= #SEARCH_DE#
	                                ) ,0) AS PRNCPAL_RPAY_AMOUNT
	                               ,NVL((
	                                  SELECT SUM(AA.RPAY_AMOUNT)
	                                  FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
	                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
	                                  AND   AA.RPAY_DE <= #SEARCH_DE#
	                                ) ,0) AS INTR_RPAY_AMOUNT        
	                               , NVL(A.BRRW_AMOUNT ,0) - NVL((
	                                    SELECT SUM(AA.RPAY_AMOUNT)
	                                    FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
	                                    WHERE AA.PBNCD_NO = A.PBNCD_NO
	                                    AND   AA.RPAY_DE <= #SEARCH_DE#
	                                ) ,0) AS BRRW_BALANCE         
	                          from TBFUN_PBNCD A
	                          LEFT OUTER JOIN TBPRJ_BSNS_CODE B
	                          ON A.BSNS_CODE = B.BSNS_CODE
	                          LEFT OUTER JOIN
	                            (
	                              SELECT DETAIL_CODE AS CODE ,
	                                DETAIL_CODE_NM   AS CODE_NM
	                              FROM TBFUN_CPTAL_DETAIL_CODE
	                              WHERE CODE_SE = '000'
	                            )
	                            C
	                          ON A.CPTAL_KND = C.CODE
	                          WHERE A.BRRW_DE <= #SEARCH_DE#
	                          AND (A.LEASE_YM IS NULL OR A.LEASE_YM > #SEARCH_DE#)
	                  ) AA
	                  GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
			) AA
			WHERE AA.BRRW_BALANCE > 0 
			
			UNION ALL
			
			SELECT *
			FROM
			(
			      SELECT '4' AS DV1
			           , '' AS DV2
			           , '' AS BSNS_CODE
			           , '' AS BSNS_NM
			           , '' AS CPTAL_KND
			           , AA.CPTAL_KND_NM
			           , MIN(AA.BRRW_DE) AS BRRW_DE
			           , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
			           , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
			           , TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#) AS BRRW_AMOUNT
			           , TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#) AS PRNCPAL_RPAY_AMOUNT
			           , TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#) AS INTR_RPAY_AMOUNT
			           , TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#) AS BRRW_BALANCE
			      FROM
			      (
			            	  SELECT '' AS DV1
			                       , '' AS DV2
			                       , AA.BSNS_CODE AS BSNS_CODE
			                       , AA.BSNS_NM AS BSNS_NM
			                       , AA.CPTAL_KND AS CPTAL_KND
			                       , AA.CPTAL_KND_NM AS CPTAL_KND_NM
			                       , MIN(AA.BRRW_DE) AS BRRW_DE
			                       , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
			                       , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
			                       , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
			                       , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
			                       , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
			                       , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
			                  FROM 
			                  (
			                          select A.BSNS_CODE
			                               , B.BSNS_NM
			                               , A.CPTAL_KND
			                               , C.CODE_NM AS CPTAL_KND_NM
			                               , A.BRRW_DE
			                               , A.EXPRTN_DE
			                               , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
			                               , A.INTRT     
			                               , A.BRRW_AMOUNT
			                               , A.LEASE_YM
			                               ,NVL((
			                                  SELECT SUM(AA.RPAY_AMOUNT)
			                                  FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
			                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
			                                  AND   AA.RPAY_DE <= #SEARCH_DE#
			                                ) ,0) AS PRNCPAL_RPAY_AMOUNT
			                               ,NVL((
			                                  SELECT SUM(AA.RPAY_AMOUNT)
			                                  FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
			                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
			                                  AND   AA.RPAY_DE <= #SEARCH_DE#
			                                ) ,0) AS INTR_RPAY_AMOUNT        
			                               , NVL(A.BRRW_AMOUNT ,0) - NVL((
			                                    SELECT SUM(AA.RPAY_AMOUNT)
			                                    FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
			                                    WHERE AA.PBNCD_NO = A.PBNCD_NO
			                                    AND   AA.RPAY_DE <= #SEARCH_DE#
			                                ) ,0) AS BRRW_BALANCE         
			                          from TBFUN_PBNCD A
			                          LEFT OUTER JOIN TBPRJ_BSNS_CODE B
			                          ON A.BSNS_CODE = B.BSNS_CODE
			                          LEFT OUTER JOIN
			                            (
			                              SELECT DETAIL_CODE AS CODE ,
			                                DETAIL_CODE_NM   AS CODE_NM
			                              FROM TBFUN_CPTAL_DETAIL_CODE
			                              WHERE CODE_SE = '000'
			                            )
			                            C
			                          ON A.CPTAL_KND = C.CODE
			                          WHERE A.BRRW_DE <= #SEARCH_DE#
	                          		  AND (A.LEASE_YM IS NULL OR A.LEASE_YM > #SEARCH_DE#)
			                  ) AA
			                  GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
			      ) AA
			      WHERE AA.BRRW_BALANCE > 0       
			      GROUP BY AA.CPTAL_KND_NM
			      ORDER BY AA.CPTAL_KND_NM
			) 
			
			UNION ALL 
			
			SELECT '5' AS DV1
			     , '장기채(B1)' AS DV2
			     , '' AS BSNS_CODE
			     , '' AS BSNS_NM
			     , '' AS CPTAL_KND
			     , '합계' AS CPTAL_KND_NM
			     , MIN(AA.BRRW_DE) AS BRRW_DE
			     , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
			     , NVL(TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00'), '0.00') AS INTRT
			     , NVL(TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#), 0) AS BRRW_AMOUNT
			     , NVL(TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS PRNCPAL_RPAY_AMOUNT
			     , NVL(TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS INTR_RPAY_AMOUNT
			     , NVL(TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#), 0) AS BRRW_BALANCE
			FROM
			(
			      SELECT '' AS DV1
                       , '' AS DV2
                       , AA.BSNS_CODE AS BSNS_CODE
                       , AA.BSNS_NM AS BSNS_NM
                       , AA.CPTAL_KND AS CPTAL_KND
                       , AA.CPTAL_KND_NM AS CPTAL_KND_NM
                       , MIN(AA.BRRW_DE) AS BRRW_DE
                       , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
                       , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
                       , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
                       , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
                       , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
                       , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
                  FROM 
                  (
                          select A.BSNS_CODE
                               , B.BSNS_NM
                               , A.CPTAL_KND
                               , C.CODE_NM AS CPTAL_KND_NM
                               , A.BRRW_DE
                               , A.EXPRTN_DE
                               , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
                               , A.INTRT     
                               , A.BRRW_AMOUNT
                               , A.LEASE_YM
                               ,NVL((
                                  SELECT SUM(AA.RPAY_AMOUNT)
                                  FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
                                  AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS PRNCPAL_RPAY_AMOUNT
                               ,NVL((
                                  SELECT SUM(AA.RPAY_AMOUNT)
                                  FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
                                  AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS INTR_RPAY_AMOUNT        
                               , NVL(A.BRRW_AMOUNT ,0) - NVL((
                                    SELECT SUM(AA.RPAY_AMOUNT)
                                    FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                                    WHERE AA.PBNCD_NO = A.PBNCD_NO
                                    AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS BRRW_BALANCE         
                          from TBFUN_PBNCD A
                          LEFT OUTER JOIN TBPRJ_BSNS_CODE B
                          ON A.BSNS_CODE = B.BSNS_CODE
                          LEFT OUTER JOIN
                            (
                              SELECT DETAIL_CODE AS CODE ,
                                DETAIL_CODE_NM   AS CODE_NM
                              FROM TBFUN_CPTAL_DETAIL_CODE
                              WHERE CODE_SE = '000'
                            )
                            C
                          ON A.CPTAL_KND = C.CODE
                          WHERE A.BRRW_DE <= #SEARCH_DE#
	                      AND (A.LEASE_YM IS NULL OR A.LEASE_YM > #SEARCH_DE#)
                          AND   A.CPTAL_KND LIKE 'A%'
                  ) AA
                  GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
			) AA
			WHERE AA.BRRW_BALANCE > 0 
			
			UNION ALL 
			
			SELECT *
			FROM 
			(
			    SELECT '6' AS DV1
			         , '' AS DV2			         
			         , DECODE(GROUPING_ID(AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM), '0', '', AA.BSNS_CODE) AS BSNS_CODE
			         , DECODE(GROUPING_ID(AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM), '0', '', AA.BSNS_NM) AS BSNS_NM
			         , AA.CPTAL_KND AS CPTAL_KND
			         , DECODE(GROUPING_ID(AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM), '0', AA.CPTAL_KND_NM, '소계') AS CPTAL_KND_NM 
			         , MIN(AA.BRRW_DE) AS BRRW_DE
			         , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
			         , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
			         , TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#) AS BRRW_AMOUNT
			         , TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#) AS PRNCPAL_RPAY_AMOUNT
			         , TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#) AS INTR_RPAY_AMOUNT
			         , TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#) AS BRRW_BALANCE
			    FROM
			    (
			          		  SELECT '' AS DV1
			                       , '' AS DV2
			                       , AA.BSNS_CODE AS BSNS_CODE
			                       , AA.BSNS_NM AS BSNS_NM
			                       , AA.CPTAL_KND AS CPTAL_KND
			                       , AA.CPTAL_KND_NM AS CPTAL_KND_NM
			                       , MIN(AA.BRRW_DE) AS BRRW_DE
			                       , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
			                       , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
			                       , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
			                       , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
			                       , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
			                       , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
			                  FROM 
			                  (
			                          select A.BSNS_CODE
			                               , B.BSNS_NM
			                               , A.CPTAL_KND
			                               , C.CODE_NM AS CPTAL_KND_NM
			                               , A.BRRW_DE
			                               , A.EXPRTN_DE
			                               , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
			                               , A.INTRT     
			                               , A.BRRW_AMOUNT
			                               , A.LEASE_YM
			                               ,NVL((
			                                  SELECT SUM(AA.RPAY_AMOUNT)
			                                  FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
			                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
			                                  AND   AA.RPAY_DE <= #SEARCH_DE#
			                                ) ,0) AS PRNCPAL_RPAY_AMOUNT
			                               ,NVL((
			                                  SELECT SUM(AA.RPAY_AMOUNT)
			                                  FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
			                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
			                                  AND   AA.RPAY_DE <= #SEARCH_DE#
			                                ) ,0) AS INTR_RPAY_AMOUNT        
			                               , NVL(A.BRRW_AMOUNT ,0) - NVL((
			                                    SELECT SUM(AA.RPAY_AMOUNT)
			                                    FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
			                                    WHERE AA.PBNCD_NO = A.PBNCD_NO
			                                    AND   AA.RPAY_DE <= #SEARCH_DE#
			                                ) ,0) AS BRRW_BALANCE         
			                          from TBFUN_PBNCD A
			                          LEFT OUTER JOIN TBPRJ_BSNS_CODE B
			                          ON A.BSNS_CODE = B.BSNS_CODE
			                          LEFT OUTER JOIN
			                            (
			                              SELECT DETAIL_CODE AS CODE ,
			                                DETAIL_CODE_NM   AS CODE_NM
			                              FROM TBFUN_CPTAL_DETAIL_CODE
			                              WHERE CODE_SE = '000'
			                            )
			                            C
			                          ON A.CPTAL_KND = C.CODE
			                          WHERE A.BRRW_DE <= #SEARCH_DE#
	                          		  AND   (A.LEASE_YM IS NULL OR A.LEASE_YM > #SEARCH_DE#)
			                          AND   A.CPTAL_KND LIKE 'A%'
			                  ) AA
			                  GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
			    ) AA
			    WHERE BRRW_BALANCE > 0
			    GROUP BY ROLLUP(AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM) 
			    HAVING GROUPING_ID(AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM) IN (0,3) 
			    order by grouping(AA.BSNS_NM) desc, AA.BSNS_NM
			           , grouping(AA.CPTAL_KND_NM) desc, AA.CPTAL_KND_NM
			)
			
			
			UNION ALL 
			
			SELECT '7' AS DV1
			     , '단기채(B2)' AS DV2
			     , '' AS BSNS_CODE
			     , '' AS BSNS_NM
			     , '' AS CPTAL_KND
			     , '합계' AS CPTAL_KND_NM
			     , MIN(AA.BRRW_DE) AS BRRW_DE
			     , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
			     , NVL(TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00'), '0.00') AS INTRT
			     , NVL(TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#), 0) AS BRRW_AMOUNT
			     , NVL(TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS PRNCPAL_RPAY_AMOUNT
			     , NVL(TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS INTR_RPAY_AMOUNT
			     , NVL(TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#), 0) AS BRRW_BALANCE
			FROM
			(
			      SELECT '' AS DV1
                       , '' AS DV2
                       , AA.BSNS_CODE AS BSNS_CODE
                       , AA.BSNS_NM AS BSNS_NM
                       , AA.CPTAL_KND AS CPTAL_KND
                       , AA.CPTAL_KND_NM AS CPTAL_KND_NM
                       , MIN(AA.BRRW_DE) AS BRRW_DE
                       , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
                       , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
                       , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
                       , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
                       , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
                       , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
                  FROM 
                  (
                          select A.BSNS_CODE
                               , B.BSNS_NM
                               , A.CPTAL_KND
                               , C.CODE_NM AS CPTAL_KND_NM
                               , A.BRRW_DE
                               , A.EXPRTN_DE
                               , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
                               , A.INTRT     
                               , A.BRRW_AMOUNT
                               , A.LEASE_YM
                               ,NVL((
                                  SELECT SUM(AA.RPAY_AMOUNT)
                                  FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
                                  AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS PRNCPAL_RPAY_AMOUNT
                               ,NVL((
                                  SELECT SUM(AA.RPAY_AMOUNT)
                                  FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
                                  AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS INTR_RPAY_AMOUNT        
                               , NVL(A.BRRW_AMOUNT ,0) - NVL((
                                    SELECT SUM(AA.RPAY_AMOUNT)
                                    FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                                    WHERE AA.PBNCD_NO = A.PBNCD_NO
                                    AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS BRRW_BALANCE         
                          from TBFUN_PBNCD A
                          LEFT OUTER JOIN TBPRJ_BSNS_CODE B
                          ON A.BSNS_CODE = B.BSNS_CODE
                          LEFT OUTER JOIN
                            (
                              SELECT DETAIL_CODE AS CODE ,
                                DETAIL_CODE_NM   AS CODE_NM
                              FROM TBFUN_CPTAL_DETAIL_CODE
                              WHERE CODE_SE = '000'
                            )
                            C
                          ON A.CPTAL_KND = C.CODE
                          WHERE A.BRRW_DE <= #SEARCH_DE#
	                      AND   (A.LEASE_YM IS NULL OR A.LEASE_YM > #SEARCH_DE#)
                          AND   A.CPTAL_KND LIKE 'B%'
                  ) AA
                  GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
			) AA
			WHERE AA.BRRW_BALANCE > 0 
			
			UNION ALL 
			
			SELECT *
			FROM 
			(
			      SELECT '8' AS DV1
			           , '' AS DV2
  			           , DECODE(GROUPING_ID(AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM), '0', '', AA.BSNS_CODE) AS BSNS_CODE
			           , DECODE(GROUPING_ID(AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM), '0', '', AA.BSNS_NM) AS BSNS_NM
			           , AA.CPTAL_KND AS CPTAL_KND
			           , DECODE(GROUPING_ID(AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM), '0', AA.CPTAL_KND_NM, '소계') AS CPTAL_KND_NM 
			           , MIN(AA.BRRW_DE) AS BRRW_DE
			           , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
			           , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
			           , TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#) AS BRRW_AMOUNT
			           , TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#) AS PRNCPAL_RPAY_AMOUNT
			           , TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#) AS INTR_RPAY_AMOUNT
			           , TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#) AS BRRW_BALANCE
			      FROM
			      (
			            	  SELECT '' AS DV1
			                       , '' AS DV2
			                       , AA.BSNS_CODE AS BSNS_CODE
			                       , AA.BSNS_NM AS BSNS_NM
			                       , AA.CPTAL_KND AS CPTAL_KND
			                       , AA.CPTAL_KND_NM AS CPTAL_KND_NM
			                       , MIN(AA.BRRW_DE) AS BRRW_DE
			                       , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
			                       , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
			                       , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
			                       , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
			                       , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
			                       , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
			                  FROM 
			                  (
			                          select A.BSNS_CODE
			                               , B.BSNS_NM
			                               , A.CPTAL_KND
			                               , C.CODE_NM AS CPTAL_KND_NM
			                               , A.BRRW_DE
			                               , A.EXPRTN_DE
			                               , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
			                               , A.INTRT     
			                               , A.BRRW_AMOUNT
			                               , A.LEASE_YM
			                               ,NVL((
			                                  SELECT SUM(AA.RPAY_AMOUNT)
			                                  FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
			                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
			                                  AND   AA.RPAY_DE <= #SEARCH_DE#
			                                ) ,0) AS PRNCPAL_RPAY_AMOUNT
			                               ,NVL((
			                                  SELECT SUM(AA.RPAY_AMOUNT)
			                                  FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
			                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
			                                  AND   AA.RPAY_DE <= #SEARCH_DE#
			                                ) ,0) AS INTR_RPAY_AMOUNT        
			                               , NVL(A.BRRW_AMOUNT ,0) - NVL((
			                                    SELECT SUM(AA.RPAY_AMOUNT)
			                                    FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
			                                    WHERE AA.PBNCD_NO = A.PBNCD_NO
			                                    AND   AA.RPAY_DE <= #SEARCH_DE#
			                                ) ,0) AS BRRW_BALANCE         
			                          from TBFUN_PBNCD A
			                          LEFT OUTER JOIN TBPRJ_BSNS_CODE B
			                          ON A.BSNS_CODE = B.BSNS_CODE
			                          LEFT OUTER JOIN
			                            (
			                              SELECT DETAIL_CODE AS CODE ,
			                                DETAIL_CODE_NM   AS CODE_NM
			                              FROM TBFUN_CPTAL_DETAIL_CODE
			                              WHERE CODE_SE = '000'
			                            )
			                            C
			                          ON A.CPTAL_KND = C.CODE
			                          WHERE A.BRRW_DE <= #SEARCH_DE#
	                          		  AND   (A.LEASE_YM IS NULL OR A.LEASE_YM > #SEARCH_DE#)
			                          AND   A.CPTAL_KND LIKE 'B%'
			                  ) AA
			                  GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
			      ) AA
			      WHERE BRRW_BALANCE > 0
			      GROUP BY ROLLUP(AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM) 
			      HAVING GROUPING_ID(AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM) IN (0,3) 
			      order by grouping(AA.BSNS_NM) desc, AA.BSNS_NM
			             , grouping(AA.CPTAL_KND_NM) desc, AA.CPTAL_KND_NM
			)
			
			UNION ALL 
			
			SELECT '9' AS DV1
			     , '금융리스처리(C=C1+C2)' AS DV2
			     , '' AS BSNS_CODE
			     , '' AS BSNS_NM
			     , '' AS CPTAL_KND
			     , '합계' AS CPTAL_KND_NM
			     , MIN(AA.BRRW_DE) AS BRRW_DE
			     , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
			     , NVL(TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00'), '0.00') AS INTRT
			     , NVL(TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#), 0) AS BRRW_AMOUNT
			     , NVL(TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS PRNCPAL_RPAY_AMOUNT
			     , NVL(TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS INTR_RPAY_AMOUNT
			     , NVL(TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#), 0) AS BRRW_BALANCE
			FROM
			(
			      SELECT '' AS DV1
                       , '' AS DV2
                       , AA.BSNS_CODE AS BSNS_CODE
                       , AA.BSNS_NM AS BSNS_NM
                       , AA.CPTAL_KND AS CPTAL_KND
                       , AA.CPTAL_KND_NM AS CPTAL_KND_NM
                       , MIN(AA.BRRW_DE) AS BRRW_DE
                       , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
                       , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
                       , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
                       , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
                       , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
                       , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
                  FROM 
                  (
                          select A.BSNS_CODE
                               , B.BSNS_NM
                               , A.CPTAL_KND
                               , C.CODE_NM AS CPTAL_KND_NM
                               , A.BRRW_DE
                               , A.EXPRTN_DE
                               , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
                               , A.INTRT     
                               , A.BRRW_AMOUNT
                               , A.LEASE_YM
                               ,NVL((
                                  SELECT SUM(AA.RPAY_AMOUNT)
                                  FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
                                  AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS PRNCPAL_RPAY_AMOUNT
                               ,NVL((
                                  SELECT SUM(AA.RPAY_AMOUNT)
                                  FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
                                  AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS INTR_RPAY_AMOUNT        
                               , NVL(A.BRRW_AMOUNT ,0) - NVL((
                                    SELECT SUM(AA.RPAY_AMOUNT)
                                    FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                                    WHERE AA.PBNCD_NO = A.PBNCD_NO
                                    AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS BRRW_BALANCE         
                          from TBFUN_PBNCD A
                          LEFT OUTER JOIN TBPRJ_BSNS_CODE B
                          ON A.BSNS_CODE = B.BSNS_CODE
                          LEFT OUTER JOIN
                            (
                              SELECT DETAIL_CODE AS CODE ,
                                DETAIL_CODE_NM   AS CODE_NM
                              FROM TBFUN_CPTAL_DETAIL_CODE
                              WHERE CODE_SE = '000'
                            )
                            C
                          ON A.CPTAL_KND = C.CODE
                          WHERE A.BRRW_DE <= #SEARCH_DE#
	                      AND   (A.LEASE_YM IS NOT NULL OR A.LEASE_YM <= #SEARCH_DE#)
                  ) AA
                  GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
			) AA
			WHERE AA.BRRW_BALANCE > 0 
			
			UNION ALL 
			
			SELECT *
			FROM
			(
			      SELECT '10' AS DV1
			           , '' AS DV2
			           , '' AS BSNS_CODE
			           , '' AS BSNS_NM
			           , '' AS CPTAL_KND
			           , AA.CPTAL_KND_NM
			           , MIN(AA.BRRW_DE) AS BRRW_DE
			           , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
			           , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
			           , TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#) AS BRRW_AMOUNT
			           , TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#) AS PRNCPAL_RPAY_AMOUNT
			           , TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#) AS INTR_RPAY_AMOUNT
			           , TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#) AS BRRW_BALANCE
			      FROM
			      (
				              SELECT '' AS DV1
			                       , '' AS DV2
			                       , AA.BSNS_CODE AS BSNS_CODE
			                       , AA.BSNS_NM AS BSNS_NM
			                       , AA.CPTAL_KND AS CPTAL_KND
			                       , AA.CPTAL_KND_NM AS CPTAL_KND_NM
			                       , MIN(AA.BRRW_DE) AS BRRW_DE
			                       , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
			                       , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
			                       , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
			                       , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
			                       , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
			                       , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
			                  FROM 
			                  (
			                          select A.BSNS_CODE
			                               , B.BSNS_NM
			                               , A.CPTAL_KND
			                               , C.CODE_NM AS CPTAL_KND_NM
			                               , A.BRRW_DE
			                               , A.EXPRTN_DE
			                               , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
			                               , A.INTRT     
			                               , A.BRRW_AMOUNT
			                               , A.LEASE_YM
			                               ,NVL((
			                                  SELECT SUM(AA.RPAY_AMOUNT)
			                                  FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
			                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
			                                  AND   AA.RPAY_DE <= #SEARCH_DE#
			                                ) ,0) AS PRNCPAL_RPAY_AMOUNT
			                               ,NVL((
			                                  SELECT SUM(AA.RPAY_AMOUNT)
			                                  FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
			                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
			                                  AND   AA.RPAY_DE <= #SEARCH_DE#
			                                ) ,0) AS INTR_RPAY_AMOUNT        
			                               , NVL(A.BRRW_AMOUNT ,0) - NVL((
			                                    SELECT SUM(AA.RPAY_AMOUNT)
			                                    FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
			                                    WHERE AA.PBNCD_NO = A.PBNCD_NO
			                                    AND   AA.RPAY_DE <= #SEARCH_DE#
			                                ) ,0) AS BRRW_BALANCE         
			                          from TBFUN_PBNCD A
			                          LEFT OUTER JOIN TBPRJ_BSNS_CODE B
			                          ON A.BSNS_CODE = B.BSNS_CODE
			                          LEFT OUTER JOIN
			                            (
			                              SELECT DETAIL_CODE AS CODE ,
			                                DETAIL_CODE_NM   AS CODE_NM
			                              FROM TBFUN_CPTAL_DETAIL_CODE
			                              WHERE CODE_SE = '000'
			                            )
			                            C
			                          ON A.CPTAL_KND = C.CODE
			                          WHERE A.BRRW_DE <= #SEARCH_DE#
	                          		  AND   (A.LEASE_YM IS NOT NULL OR A.LEASE_YM <= #SEARCH_DE#)
			                  ) AA
			                  GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
			      ) AA
			      WHERE AA.BRRW_BALANCE > 0 
			      GROUP BY AA.CPTAL_KND_NM
			      ORDER BY AA.CPTAL_KND_NM
			)

			
			UNION ALL 
			
			SELECT '11' AS DV1
			     , '장기채(C1)' AS DV2
			     , '' AS BSNS_CODE
			     , '' AS BSNS_NM
			     , '' AS CPTAL_KND
			     , '합계' AS CPTAL_KND_NM
			     , MIN(AA.BRRW_DE) AS BRRW_DE
			     , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
			     , NVL(TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00'), '0.00') AS INTRT
			     , NVL(TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#), 0) AS BRRW_AMOUNT
			     , NVL(TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS PRNCPAL_RPAY_AMOUNT
			     , NVL(TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS INTR_RPAY_AMOUNT
			     , NVL(TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#), 0) AS BRRW_BALANCE
			FROM
			(
			      SELECT '' AS DV1
                       , '' AS DV2
                       , AA.BSNS_CODE AS BSNS_CODE
                       , AA.BSNS_NM AS BSNS_NM
                       , AA.CPTAL_KND AS CPTAL_KND
                       , AA.CPTAL_KND_NM AS CPTAL_KND_NM
                       , MIN(AA.BRRW_DE) AS BRRW_DE
                       , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
                       , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
                       , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
                       , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
                       , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
                       , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
                  FROM 
                  (
                          select A.BSNS_CODE
                               , B.BSNS_NM
                               , A.CPTAL_KND
                               , C.CODE_NM AS CPTAL_KND_NM
                               , A.BRRW_DE
                               , A.EXPRTN_DE
                               , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
                               , A.INTRT     
                               , A.BRRW_AMOUNT
                               , A.LEASE_YM
                               ,NVL((
                                  SELECT SUM(AA.RPAY_AMOUNT)
                                  FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
                                  AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS PRNCPAL_RPAY_AMOUNT
                               ,NVL((
                                  SELECT SUM(AA.RPAY_AMOUNT)
                                  FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
                                  AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS INTR_RPAY_AMOUNT        
                               , NVL(A.BRRW_AMOUNT ,0) - NVL((
                                    SELECT SUM(AA.RPAY_AMOUNT)
                                    FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                                    WHERE AA.PBNCD_NO = A.PBNCD_NO
                                    AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS BRRW_BALANCE         
                          from TBFUN_PBNCD A
                          LEFT OUTER JOIN TBPRJ_BSNS_CODE B
                          ON A.BSNS_CODE = B.BSNS_CODE
                          LEFT OUTER JOIN
                            (
                              SELECT DETAIL_CODE AS CODE ,
                                DETAIL_CODE_NM   AS CODE_NM
                              FROM TBFUN_CPTAL_DETAIL_CODE
                              WHERE CODE_SE = '000'
                            )
                            C
                          ON A.CPTAL_KND = C.CODE
                          WHERE A.BRRW_DE <= #SEARCH_DE#
	                      AND   (A.LEASE_YM IS NOT NULL OR A.LEASE_YM <= #SEARCH_DE#)
                          AND A.CPTAL_KND LIKE 'A%'
                  ) AA
                  GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
			) AA
			WHERE AA.BRRW_BALANCE > 0 
			
			UNION ALL 
			
			SELECT *
			FROM 
			(
			      SELECT '12' AS DV1
			           , '' AS DV2
  			           , DECODE(GROUPING_ID(AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM), '0', '', AA.BSNS_CODE) AS BSNS_CODE
			           , DECODE(GROUPING_ID(AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM), '0', '', AA.BSNS_NM) AS BSNS_NM
			           , AA.CPTAL_KND AS CPTAL_KND
			           , DECODE(GROUPING_ID(AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM), '0', AA.CPTAL_KND_NM, '소계') AS CPTAL_KND_NM
			           , MIN(AA.BRRW_DE) AS BRRW_DE
			           , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
			           , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
			           , TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#) AS BRRW_AMOUNT
			           , TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#) AS PRNCPAL_RPAY_AMOUNT
			           , TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#) AS INTR_RPAY_AMOUNT
			           , TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#) AS BRRW_BALANCE
			      FROM
			      (
			              	  SELECT '' AS DV1
			                       , '' AS DV2
			                       , AA.BSNS_CODE AS BSNS_CODE
			                       , AA.BSNS_NM AS BSNS_NM
			                       , AA.CPTAL_KND AS CPTAL_KND
			                       , AA.CPTAL_KND_NM AS CPTAL_KND_NM
			                       , MIN(AA.BRRW_DE) AS BRRW_DE
			                       , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
			                       , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
			                       , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
			                       , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
			                       , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
			                       , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
			                  FROM 
			                  (
			                          select A.BSNS_CODE
			                               , B.BSNS_NM
			                               , A.CPTAL_KND
			                               , C.CODE_NM AS CPTAL_KND_NM
			                               , A.BRRW_DE
			                               , A.EXPRTN_DE
			                               , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
			                               , A.INTRT     
			                               , A.BRRW_AMOUNT
			                               , A.LEASE_YM
			                               ,NVL((
			                                  SELECT SUM(AA.RPAY_AMOUNT)
			                                  FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
			                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
			                                  AND   AA.RPAY_DE <= #SEARCH_DE#
			                                ) ,0) AS PRNCPAL_RPAY_AMOUNT
			                               ,NVL((
			                                  SELECT SUM(AA.RPAY_AMOUNT)
			                                  FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
			                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
			                                  AND   AA.RPAY_DE <= #SEARCH_DE#
			                                ) ,0) AS INTR_RPAY_AMOUNT        
			                               , NVL(A.BRRW_AMOUNT ,0) - NVL((
			                                    SELECT SUM(AA.RPAY_AMOUNT)
			                                    FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
			                                    WHERE AA.PBNCD_NO = A.PBNCD_NO
			                                    AND   AA.RPAY_DE <= #SEARCH_DE#
			                                ) ,0) AS BRRW_BALANCE         
			                          from TBFUN_PBNCD A
			                          LEFT OUTER JOIN TBPRJ_BSNS_CODE B
			                          ON A.BSNS_CODE = B.BSNS_CODE
			                          LEFT OUTER JOIN
			                            (
			                              SELECT DETAIL_CODE AS CODE ,
			                                DETAIL_CODE_NM   AS CODE_NM
			                              FROM TBFUN_CPTAL_DETAIL_CODE
			                              WHERE CODE_SE = '000'
			                            )
			                            C
			                          ON A.CPTAL_KND = C.CODE
			                          WHERE A.BRRW_DE <= #SEARCH_DE#
	                          		  AND   (A.LEASE_YM IS NOT NULL OR A.LEASE_YM <= #SEARCH_DE#)
			                          AND A.CPTAL_KND LIKE 'A%'
			                  ) AA
			                  GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
			      ) AA
			      WHERE BRRW_BALANCE > 0 
			      GROUP BY ROLLUP(AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM) 
			      HAVING GROUPING_ID(AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM) IN (0,3) 
			      order by grouping(AA.BSNS_NM) desc, AA.BSNS_NM
			             , grouping(AA.CPTAL_KND_NM) desc, AA.CPTAL_KND_NM
			)
			
			UNION ALL 
			
			SELECT '13' AS DV1
			     , '단기채(C2)' AS DV2
			     , '' AS BSNS_CODE
			     , '' AS BSNS_NM
			     , '' AS CPTAL_KND
			     , '합계' AS CPTAL_KND_NM
			     , MIN(AA.BRRW_DE) AS BRRW_DE
			     , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
			     , NVL(TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00'), '0.00') AS INTRT
			     , NVL(TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#), 0) AS BRRW_AMOUNT
			     , NVL(TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS PRNCPAL_RPAY_AMOUNT
			     , NVL(TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS INTR_RPAY_AMOUNT
			     , NVL(TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#), 0) AS BRRW_BALANCE
			FROM
			(
			      SELECT '' AS DV1
                       , '' AS DV2
                       , AA.BSNS_CODE AS BSNS_CODE
                       , AA.BSNS_NM AS BSNS_NM
                       , AA.CPTAL_KND AS CPTAL_KND
                       , AA.CPTAL_KND_NM AS CPTAL_KND_NM
                       , MIN(AA.BRRW_DE) AS BRRW_DE
                       , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
                       , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
                       , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
                       , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
                       , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
                       , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
                  FROM 
                  (
                          select A.BSNS_CODE
                               , B.BSNS_NM
                               , A.CPTAL_KND
                               , C.CODE_NM AS CPTAL_KND_NM
                               , A.BRRW_DE
                               , A.EXPRTN_DE
                               , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
                               , A.INTRT     
                               , A.BRRW_AMOUNT
                               , A.LEASE_YM
                               ,NVL((
                                  SELECT SUM(AA.RPAY_AMOUNT)
                                  FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
                                  AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS PRNCPAL_RPAY_AMOUNT
                               ,NVL((
                                  SELECT SUM(AA.RPAY_AMOUNT)
                                  FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
                                  AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS INTR_RPAY_AMOUNT        
                               , NVL(A.BRRW_AMOUNT ,0) - NVL((
                                    SELECT SUM(AA.RPAY_AMOUNT)
                                    FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                                    WHERE AA.PBNCD_NO = A.PBNCD_NO
                                    AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS BRRW_BALANCE         
                          from TBFUN_PBNCD A
                          LEFT OUTER JOIN TBPRJ_BSNS_CODE B
                          ON A.BSNS_CODE = B.BSNS_CODE
                          LEFT OUTER JOIN
                            (
                              SELECT DETAIL_CODE AS CODE ,
                                DETAIL_CODE_NM   AS CODE_NM
                              FROM TBFUN_CPTAL_DETAIL_CODE
                              WHERE CODE_SE = '000'
                            )
                            C
                          ON A.CPTAL_KND = C.CODE
                          WHERE A.BRRW_DE <= #SEARCH_DE#
	                      AND   (A.LEASE_YM IS NOT NULL OR A.LEASE_YM <= #SEARCH_DE#)
                          AND A.CPTAL_KND LIKE 'B%'
                  ) AA
                  GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
			) AA
			WHERE AA.BRRW_BALANCE > 0 
			
			UNION ALL 
			
			SELECT *
			FROM 
			(
			      SELECT '14' AS DV1
			           , '' AS DV2
  			           , DECODE(GROUPING_ID(AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM), '0', '', AA.BSNS_CODE) AS BSNS_CODE
			           , DECODE(GROUPING_ID(AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM), '0', '', AA.BSNS_NM) AS BSNS_NM
			           , AA.CPTAL_KND AS CPTAL_KND
			           , DECODE(GROUPING_ID(AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM), '0', AA.CPTAL_KND_NM, '소계') AS CPTAL_KND_NM
			           , MIN(AA.BRRW_DE) AS BRRW_DE
			           , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
			           , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
			           , TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#) AS BRRW_AMOUNT
			           , TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#) AS PRNCPAL_RPAY_AMOUNT
			           , TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#) AS INTR_RPAY_AMOUNT
			           , TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#) AS BRRW_BALANCE
			      FROM
			      (
			              SELECT '' AS DV1
		                       , '' AS DV2
		                       , AA.BSNS_CODE AS BSNS_CODE
		                       , AA.BSNS_NM AS BSNS_NM
		                       , AA.CPTAL_KND AS CPTAL_KND
		                       , AA.CPTAL_KND_NM AS CPTAL_KND_NM
		                       , MIN(AA.BRRW_DE) AS BRRW_DE
		                       , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
		                       , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
		                       , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
		                       , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
		                       , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
		                       , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
		                  FROM 
		                  (
		                          select A.BSNS_CODE
		                               , B.BSNS_NM
		                               , A.CPTAL_KND
		                               , C.CODE_NM AS CPTAL_KND_NM
		                               , A.BRRW_DE
		                               , A.EXPRTN_DE
		                               , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
		                               , A.INTRT     
		                               , A.BRRW_AMOUNT
		                               , A.LEASE_YM
		                               ,NVL((
		                                  SELECT SUM(AA.RPAY_AMOUNT)
		                                  FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
		                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
		                                  AND   AA.RPAY_DE <= #SEARCH_DE#
		                                ) ,0) AS PRNCPAL_RPAY_AMOUNT
		                               ,NVL((
		                                  SELECT SUM(AA.RPAY_AMOUNT)
		                                  FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
		                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
		                                  AND   AA.RPAY_DE <= #SEARCH_DE#
		                                ) ,0) AS INTR_RPAY_AMOUNT        
		                               , NVL(A.BRRW_AMOUNT ,0) - NVL((
		                                    SELECT SUM(AA.RPAY_AMOUNT)
		                                    FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
		                                    WHERE AA.PBNCD_NO = A.PBNCD_NO
		                                    AND   AA.RPAY_DE <= #SEARCH_DE#
		                                ) ,0) AS BRRW_BALANCE         
		                          from TBFUN_PBNCD A
		                          LEFT OUTER JOIN TBPRJ_BSNS_CODE B
		                          ON A.BSNS_CODE = B.BSNS_CODE
		                          LEFT OUTER JOIN
		                            (
		                              SELECT DETAIL_CODE AS CODE ,
		                                DETAIL_CODE_NM   AS CODE_NM
		                              FROM TBFUN_CPTAL_DETAIL_CODE
		                              WHERE CODE_SE = '000'
		                            )
		                            C
		                          ON A.CPTAL_KND = C.CODE
		                          WHERE A.BRRW_DE <= #SEARCH_DE#
	                              AND   (A.LEASE_YM IS NOT NULL OR A.LEASE_YM <= #SEARCH_DE#)
		                          AND A.CPTAL_KND LIKE 'B%'
		                  ) AA
		                  GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
		      ) AA
		      WHERE BRRW_BALANCE > 0 
		      GROUP BY ROLLUP(AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM) 
		      HAVING GROUPING_ID(AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM) IN (0,3) 
		      order by grouping(AA.BSNS_NM) desc, AA.BSNS_NM
		             , grouping(AA.CPTAL_KND_NM) desc, AA.CPTAL_KND_NM
		)
		]]>
	</select>


	<!-- 채권유형별명세 조회 -->
	<select id="FUN020203DAO.selectPbncdList02" resultClass="java.util.HashMap">
		<![CDATA[	
		SELECT '1' AS DV1
		     , '공사채(A=B+C)' AS DV2
		     , '' AS BSNS_CODE
		     , '' AS BSNS_NM
		     , '' AS CPTAL_KND
		     , '' AS CPTAL_KND_NM
		     , '합계' AS BRRW_ACNUT_NM
		     , MIN(AA.BRRW_DE) AS BRRW_DE
		     , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
		     , NVL(TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00'), '0.00') AS INTRT
		     , NVL(TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#), 0) AS BRRW_AMOUNT
		     , NVL(TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS PRNCPAL_RPAY_AMOUNT
		     , NVL(TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS INTR_RPAY_AMOUNT
		     , NVL(TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#), 0) AS BRRW_BALANCE
		FROM
		(
            SELECT '' AS DV1
                 , '' AS DV2
                 , AA.BSNS_CODE AS BSNS_CODE
                 , DECODE(GROUPING_ID(AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BSNS_CODE, AA.BSNS_NM), '0', AA.BSNS_NM, '소계') AS BSNS_NM
                 , AA.CPTAL_KND AS CPTAL_KND
                 , AA.CPTAL_KND_NM AS CPTAL_KND_NM
                 , MIN(AA.BRRW_DE) AS BRRW_DE
                 , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
                 , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
                 , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
                 , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
                 , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
                 , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
            FROM 
            (
                    select A.BSNS_CODE
                         , B.BSNS_NM
                         , A.CPTAL_KND
                         , C.CODE_NM AS CPTAL_KND_NM
                         , A.BRRW_DE
                         , A.EXPRTN_DE
                         , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
                         , A.INTRT     
                         , A.BRRW_AMOUNT
                         , A.LEASE_YM
                         , CASE WHEN A.LEASE_YM IS NOT NULL OR A.LEASE_YM <= #SEARCH_DE#
                                THEN 'Y'
                                ELSE 'N'
                           END AS LEASE_YN     
                         ,NVL((
                            SELECT SUM(AA.RPAY_AMOUNT)
                            FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                            WHERE AA.PBNCD_NO = A.PBNCD_NO
                            AND   AA.RPAY_DE <= #SEARCH_DE#
                          ) ,0) AS PRNCPAL_RPAY_AMOUNT
                         ,NVL((
                            SELECT SUM(AA.RPAY_AMOUNT)
                            FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
                            WHERE AA.PBNCD_NO = A.PBNCD_NO
                            AND   AA.RPAY_DE <= #SEARCH_DE#
                          ) ,0) AS INTR_RPAY_AMOUNT        
                         , NVL(A.BRRW_AMOUNT ,0) - NVL((
                              SELECT SUM(AA.RPAY_AMOUNT)
                              FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                              WHERE AA.PBNCD_NO = A.PBNCD_NO
                              AND   AA.RPAY_DE <= #SEARCH_DE#
                          ) ,0) AS BRRW_BALANCE         
                    from TBFUN_PBNCD A
                    LEFT OUTER JOIN TBPRJ_BSNS_CODE B
                    ON A.BSNS_CODE = B.BSNS_CODE
                    LEFT OUTER JOIN
                      (
                        SELECT DETAIL_CODE AS CODE ,
                          DETAIL_CODE_NM   AS CODE_NM
                        FROM TBFUN_CPTAL_DETAIL_CODE
                        WHERE CODE_SE = '000'
                      )
                      C
                    ON A.CPTAL_KND = C.CODE
                    WHERE A.BRRW_DE <= #SEARCH_DE#
            ) AA
            GROUP BY AA.LEASE_YN, AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
		) AA
		WHERE AA.BRRW_BALANCE > 0
		
		UNION ALL
		
		SELECT *
		FROM 
		(
		      SELECT '2' AS DV1
		           , '' AS DV2
		           , '' AS BSNS_CODE
		           , '' AS BSNS_NM
		           , '' AS CPTAL_KND
		           , '' AS CPTAL_KND_NM
		           , AA.CPTAL_KND_NM AS BRRW_ACNUT_NM
		           , MIN(AA.BRRW_DE) AS BRRW_DE
		           , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
		           , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
		           , TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#) AS BRRW_AMOUNT
		           , TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#) AS PRNCPAL_RPAY_AMOUNT
		           , TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#) AS INTR_RPAY_AMOUNT
		           , TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#) AS BRRW_BALANCE
		      FROM
		      (
                  SELECT '' AS DV1
                       , '' AS DV2
                       , AA.BSNS_CODE AS BSNS_CODE
                       , AA.BSNS_NM AS BSNS_NM
                       , AA.CPTAL_KND AS CPTAL_KND
                       , AA.CPTAL_KND_NM AS CPTAL_KND_NM
                       , AA.LEASE_YN AS LEASE_YN
                       , MIN(AA.BRRW_DE) AS BRRW_DE
                       , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
                       , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
                       , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
                       , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
                       , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
                       , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
                  FROM 
                  (
                          select A.BSNS_CODE
                               , B.BSNS_NM
                               , A.CPTAL_KND
                               , C.CODE_NM AS CPTAL_KND_NM
                               , A.BRRW_DE
                               , A.EXPRTN_DE
                               , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
                               , A.INTRT     
                               , A.BRRW_AMOUNT
                               , A.LEASE_YM
                               , CASE WHEN A.LEASE_YM IS NOT NULL OR A.LEASE_YM <= #SEARCH_DE#
                                      THEN 'Y'
                                      ELSE 'N'
                                 END AS LEASE_YN                               
                               ,NVL((
                                  SELECT SUM(AA.RPAY_AMOUNT)
                                  FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
                                  AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS PRNCPAL_RPAY_AMOUNT
                               ,NVL((
                                  SELECT SUM(AA.RPAY_AMOUNT)
                                  FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
                                  AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS INTR_RPAY_AMOUNT        
                               , NVL(A.BRRW_AMOUNT ,0) - NVL((
                                    SELECT SUM(AA.RPAY_AMOUNT)
                                    FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                                    WHERE AA.PBNCD_NO = A.PBNCD_NO
                                    AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS BRRW_BALANCE         
                          from TBFUN_PBNCD A
                          LEFT OUTER JOIN TBPRJ_BSNS_CODE B
                          ON A.BSNS_CODE = B.BSNS_CODE
                          LEFT OUTER JOIN
                            (
                              SELECT DETAIL_CODE AS CODE ,
                                DETAIL_CODE_NM   AS CODE_NM
                              FROM TBFUN_CPTAL_DETAIL_CODE
                              WHERE CODE_SE = '000'
                            )
                            C
                          ON A.CPTAL_KND = C.CODE
                          WHERE A.BRRW_DE <= #SEARCH_DE#
                  ) AA
                  GROUP BY AA.LEASE_YN, AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
		      ) AA
		      WHERE AA.BRRW_BALANCE > 0
		      GROUP BY AA.CPTAL_KND_NM
		      ORDER BY AA.CPTAL_KND_NM
		)
		
		UNION ALL
		
		SELECT '3' AS DV1
		     , '금융부채(B=B1+B2)' AS DV2
		     , '' AS BSNS_CODE
		     , '' AS BSNS_NM
		     , '' AS CPTAL_KND
		     , '' AS CPTAL_KND_NM
		     , '합계' AS BRRW_ACNUT_NM
		     , MIN(AA.BRRW_DE) AS BRRW_DE
		     , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
		     , NVL(TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00'), '0.00') AS INTRT
		     , NVL(TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#), 0) AS BRRW_AMOUNT
		     , NVL(TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS PRNCPAL_RPAY_AMOUNT
		     , NVL(TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS INTR_RPAY_AMOUNT
		     , NVL(TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#), 0) AS BRRW_BALANCE
		FROM
		(
              SELECT '' AS DV1
                   , '' AS DV2
                   , AA.BSNS_CODE AS BSNS_CODE
                   , AA.BSNS_NM AS BSNS_NM
                   , AA.CPTAL_KND AS CPTAL_KND
                   , AA.CPTAL_KND_NM AS CPTAL_KND_NM
                   , MIN(AA.BRRW_DE) AS BRRW_DE
                   , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
                   , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
                   , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
                   , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
                   , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
                   , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
              FROM 
              (
                      select A.BSNS_CODE
                           , B.BSNS_NM
                           , A.CPTAL_KND
                           , C.CODE_NM AS CPTAL_KND_NM
                           , A.BRRW_DE
                           , A.EXPRTN_DE
                           , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
                           , A.INTRT     
                           , A.BRRW_AMOUNT
                           , A.LEASE_YM
                           ,NVL((
                              SELECT SUM(AA.RPAY_AMOUNT)
                              FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                              WHERE AA.PBNCD_NO = A.PBNCD_NO
                              AND   AA.RPAY_DE <= #SEARCH_DE#
                            ) ,0) AS PRNCPAL_RPAY_AMOUNT
                           ,NVL((
                              SELECT SUM(AA.RPAY_AMOUNT)
                              FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
                              WHERE AA.PBNCD_NO = A.PBNCD_NO
                              AND   AA.RPAY_DE <= #SEARCH_DE#
                            ) ,0) AS INTR_RPAY_AMOUNT        
                           , NVL(A.BRRW_AMOUNT ,0) - NVL((
                                SELECT SUM(AA.RPAY_AMOUNT)
                                FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                                WHERE AA.PBNCD_NO = A.PBNCD_NO
                                AND   AA.RPAY_DE <= #SEARCH_DE#
                            ) ,0) AS BRRW_BALANCE         
                      from TBFUN_PBNCD A
                      LEFT OUTER JOIN TBPRJ_BSNS_CODE B
                      ON A.BSNS_CODE = B.BSNS_CODE
                      LEFT OUTER JOIN
                        (
                          SELECT DETAIL_CODE AS CODE ,
                            DETAIL_CODE_NM   AS CODE_NM
                          FROM TBFUN_CPTAL_DETAIL_CODE
                          WHERE CODE_SE = '000'
                        )
                        C
                      ON A.CPTAL_KND = C.CODE
                      WHERE A.BRRW_DE <= #SEARCH_DE#
                      AND   (A.LEASE_YM IS NULL OR A.LEASE_YM > #SEARCH_DE#)
              ) AA
              GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
		) AA
		WHERE AA.BRRW_BALANCE > 0 
		
		UNION ALL
		
		SELECT *
		FROM
		(
		      SELECT '4' AS DV1
		           , '' AS DV2
		           , '' AS BSNS_CODE
		           , '' AS BSNS_NM
		           , '' AS CPTAL_KND
		           , '' AS CPTAL_KND_NM
		           , AA.CPTAL_KND_NM AS BRRW_ACNUT_NM
		           , MIN(AA.BRRW_DE) AS BRRW_DE
		           , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
		           , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
		           , TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#) AS BRRW_AMOUNT
		           , TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#) AS PRNCPAL_RPAY_AMOUNT
		           , TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#) AS INTR_RPAY_AMOUNT
		           , TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#) AS BRRW_BALANCE
		      FROM
		      (
                  SELECT '' AS DV1
                       , '' AS DV2
                       , AA.BSNS_CODE AS BSNS_CODE
                       , AA.BSNS_NM AS BSNS_NM
                       , AA.CPTAL_KND AS CPTAL_KND
                       , AA.CPTAL_KND_NM AS CPTAL_KND_NM
                       , MIN(AA.BRRW_DE) AS BRRW_DE
                       , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
                       , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
                       , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
                       , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
                       , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
                       , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
                  FROM 
                  (
                          select A.BSNS_CODE
                               , B.BSNS_NM
                               , A.CPTAL_KND
                               , C.CODE_NM AS CPTAL_KND_NM
                               , A.BRRW_DE
                               , A.EXPRTN_DE
                               , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
                               , A.INTRT     
                               , A.BRRW_AMOUNT
                               , A.LEASE_YM
                               ,NVL((
                                  SELECT SUM(AA.RPAY_AMOUNT)
                                  FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
                                  AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS PRNCPAL_RPAY_AMOUNT
                               ,NVL((
                                  SELECT SUM(AA.RPAY_AMOUNT)
                                  FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
                                  AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS INTR_RPAY_AMOUNT        
                               , NVL(A.BRRW_AMOUNT ,0) - NVL((
                                    SELECT SUM(AA.RPAY_AMOUNT)
                                    FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                                    WHERE AA.PBNCD_NO = A.PBNCD_NO
                                    AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS BRRW_BALANCE         
                          from TBFUN_PBNCD A
                          LEFT OUTER JOIN TBPRJ_BSNS_CODE B
                          ON A.BSNS_CODE = B.BSNS_CODE
                          LEFT OUTER JOIN
                            (
                              SELECT DETAIL_CODE AS CODE ,
                                DETAIL_CODE_NM   AS CODE_NM
                              FROM TBFUN_CPTAL_DETAIL_CODE
                              WHERE CODE_SE = '000'
                            )
                            C
                          ON A.CPTAL_KND = C.CODE
                          WHERE A.BRRW_DE <= #SEARCH_DE#
                          AND   (A.LEASE_YM IS NULL OR A.LEASE_YM > #SEARCH_DE#)
                  ) AA
                  GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
		      ) AA
		      WHERE AA.BRRW_BALANCE > 0       
		      GROUP BY AA.CPTAL_KND_NM
		      ORDER BY AA.CPTAL_KND_NM
		) 
		
		UNION ALL 
		
		SELECT '5' AS DV1
		     , '장기채(B1)' AS DV2
		     , '' AS BSNS_CODE
		     , '' AS BSNS_NM
		     , '' AS CPTAL_KND
		     , '' AS CPTAL_KND_NM
		     , '합계' AS BRRW_ACNUT_NM
		     , MIN(AA.BRRW_DE) AS BRRW_DE
		     , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
		     , NVL(TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00'), '0.00') AS INTRT
		     , NVL(TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#), 0) AS BRRW_AMOUNT
		     , NVL(TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS PRNCPAL_RPAY_AMOUNT
		     , NVL(TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS INTR_RPAY_AMOUNT
		     , NVL(TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#), 0) AS BRRW_BALANCE
		FROM
		(
              SELECT '' AS DV1
                   , '' AS DV2
                   , AA.BSNS_CODE AS BSNS_CODE
                   , AA.BSNS_NM AS BSNS_NM
                   , AA.CPTAL_KND AS CPTAL_KND
                   , AA.CPTAL_KND_NM AS CPTAL_KND_NM
                   , MIN(AA.BRRW_DE) AS BRRW_DE
                   , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
                   , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
                   , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
                   , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
                   , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
                   , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
              FROM 
              (
                      select A.BSNS_CODE
                           , B.BSNS_NM
                           , A.CPTAL_KND
                           , C.CODE_NM AS CPTAL_KND_NM
                           , A.BRRW_DE
                           , A.EXPRTN_DE
                           , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
                           , A.INTRT     
                           , A.BRRW_AMOUNT
                           , A.LEASE_YM
                           ,NVL((
                              SELECT SUM(AA.RPAY_AMOUNT)
                              FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                              WHERE AA.PBNCD_NO = A.PBNCD_NO
                              AND   AA.RPAY_DE <= #SEARCH_DE#
                            ) ,0) AS PRNCPAL_RPAY_AMOUNT
                           ,NVL((
                              SELECT SUM(AA.RPAY_AMOUNT)
                              FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
                              WHERE AA.PBNCD_NO = A.PBNCD_NO
                              AND   AA.RPAY_DE <= #SEARCH_DE#
                            ) ,0) AS INTR_RPAY_AMOUNT        
                           , NVL(A.BRRW_AMOUNT ,0) - NVL((
                                SELECT SUM(AA.RPAY_AMOUNT)
                                FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                                WHERE AA.PBNCD_NO = A.PBNCD_NO
                                AND   AA.RPAY_DE <= #SEARCH_DE#
                            ) ,0) AS BRRW_BALANCE         
                      from TBFUN_PBNCD A
                      LEFT OUTER JOIN TBPRJ_BSNS_CODE B
                      ON A.BSNS_CODE = B.BSNS_CODE
                      LEFT OUTER JOIN
                        (
                          SELECT DETAIL_CODE AS CODE ,
                            DETAIL_CODE_NM   AS CODE_NM
                          FROM TBFUN_CPTAL_DETAIL_CODE
                          WHERE CODE_SE = '000'
                        )
                        C
                      ON A.CPTAL_KND = C.CODE
                      WHERE A.BRRW_DE <= #SEARCH_DE#
                      AND   (A.LEASE_YM IS NULL OR A.LEASE_YM > #SEARCH_DE#)
                      AND   A.CPTAL_KND LIKE 'A%'
              ) AA
              GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
		) AA
		WHERE AA.BRRW_BALANCE > 0 
		
		UNION ALL 
		
		select *
		from 
		(
		    SELECT '6' AS DV1
		         , '' AS DV2
		         , '' AS BSNS_CODE
		         , '' AS BSNS_NM
		         , DECODE(GROUPING_ID(AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM), '1', AA.CPTAL_KND, '') AS CPTAL_KND
		         , DECODE(GROUPING_ID(AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM), '1', AA.CPTAL_KND_NM, '') AS CPTAL_KND_NM
		         , DECODE(GROUPING_ID(AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM), '0', AA.BRRW_ACNUT_NM, '소계') AS BRRW_ACNUT_NM
		         , MIN(AA.BRRW_DE) AS BRRW_DE
		         , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
		         , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
		         , TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#) AS BRRW_AMOUNT
		         , TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#) AS PRNCPAL_RPAY_AMOUNT
		         , TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#) AS INTR_RPAY_AMOUNT
		         , TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#) AS BRRW_BALANCE
		    FROM
		    (
		          SELECT AA.*
		               , MAX(AA.BRRW_BALANCE) OVER (PARTITION BY AA.BSNS_NM) AS GROUP_MAX
		          FROM
		          (     
		                  SELECT '' AS DV1
		                       , '' AS DV2
		                       , AA.BSNS_CODE AS BSNS_CODE
		                       , AA.BSNS_NM AS BSNS_NM
		                       , AA.CPTAL_KND AS CPTAL_KND
		                       , AA.CPTAL_KND_NM AS CPTAL_KND_NM
		                       , AA.BRRW_ACNUT_NM AS BRRW_ACNUT_NM
		                       , MIN(AA.BRRW_DE) AS BRRW_DE
		                       , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
		                       , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
		                       , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
		                       , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
		                       , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
		                       , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
		                  FROM 
		                  (
		                          select A.BSNS_CODE
		                               , B.BSNS_NM
		                               , A.CPTAL_KND
		                               , C.CODE_NM AS CPTAL_KND_NM
		                               , A.BRRW_DE
		                               , A.EXPRTN_DE
		                               , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
		                               , A.INTRT     
		                               , A.BRRW_AMOUNT
		                               , A.LEASE_YM
		                               , A.BRRW_ACNUT_NM
		                               ,NVL((
		                                  SELECT SUM(AA.RPAY_AMOUNT)
		                                  FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
		                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
		                                  AND   AA.RPAY_DE <= #SEARCH_DE#
		                                ) ,0) AS PRNCPAL_RPAY_AMOUNT
		                               ,NVL((
		                                  SELECT SUM(AA.RPAY_AMOUNT)
		                                  FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
		                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
		                                  AND   AA.RPAY_DE <= #SEARCH_DE#
		                                ) ,0) AS INTR_RPAY_AMOUNT        
		                               , NVL(A.BRRW_AMOUNT ,0) - NVL((
		                                    SELECT SUM(AA.RPAY_AMOUNT)
		                                    FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
		                                    WHERE AA.PBNCD_NO = A.PBNCD_NO
		                                    AND   AA.RPAY_DE <= #SEARCH_DE#
		                                ) ,0) AS BRRW_BALANCE         
		                          from TBFUN_PBNCD A
		                          LEFT OUTER JOIN TBPRJ_BSNS_CODE B
		                          ON A.BSNS_CODE = B.BSNS_CODE
		                          LEFT OUTER JOIN
		                            (
		                              SELECT DETAIL_CODE AS CODE ,
		                                DETAIL_CODE_NM   AS CODE_NM
		                              FROM TBFUN_CPTAL_DETAIL_CODE
		                              WHERE CODE_SE = '000'
		                            )
		                            C
		                          ON A.CPTAL_KND = C.CODE
		                          WHERE A.BRRW_DE <= #SEARCH_DE#
		                          AND (A.LEASE_YM IS NULL OR A.LEASE_YM > #SEARCH_DE#)
		                          AND   A.CPTAL_KND LIKE 'A%'
		                  ) AA
		                  GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM
		          ) AA
		    ) AA
		    WHERE AA.GROUP_MAX > 0
		    GROUP BY ROLLUP(AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM) 
		    HAVING GROUPING_ID(AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM) IN (0,1) 
		    order by grouping(AA.CPTAL_KND_NM) desc, AA.CPTAL_KND_NM
		           , grouping(AA.BRRW_ACNUT_NM) desc, AA.BRRW_ACNUT_NM
		)
		
		UNION ALL 
		
		SELECT '7' AS DV1
		     , '단기채(B2)' AS DV2
		     , '' AS BSNS_CODE
		     , '' AS BSNS_NM
		     , '' AS CPTAL_KND
		     , '' AS CPTAL_KND_NM
		     , '합계' AS BRRW_ACNUT_NM
		     , MIN(AA.BRRW_DE) AS BRRW_DE
		     , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
		     , NVL(TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00'), '0.00') AS INTRT
		     , NVL(TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#), 0) AS BRRW_AMOUNT
		     , NVL(TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS PRNCPAL_RPAY_AMOUNT
		     , NVL(TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS INTR_RPAY_AMOUNT
		     , NVL(TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#), 0) AS BRRW_BALANCE
		FROM
		(
             SELECT '' AS DV1
                  , '' AS DV2
                  , AA.BSNS_CODE AS BSNS_CODE
                  , AA.BSNS_NM AS BSNS_NM
                  , AA.CPTAL_KND AS CPTAL_KND
                  , AA.CPTAL_KND_NM AS CPTAL_KND_NM
                  , MIN(AA.BRRW_DE) AS BRRW_DE
                  , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
                  , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
                  , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
                  , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
                  , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
                  , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
             FROM 
             (
                     select A.BSNS_CODE
                          , B.BSNS_NM
                          , A.CPTAL_KND
                          , C.CODE_NM AS CPTAL_KND_NM
                          , A.BRRW_DE
                          , A.EXPRTN_DE
                          , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
                          , A.INTRT     
                          , A.BRRW_AMOUNT
                          , A.LEASE_YM
                          ,NVL((
                             SELECT SUM(AA.RPAY_AMOUNT)
                             FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                             WHERE AA.PBNCD_NO = A.PBNCD_NO
                             AND   AA.RPAY_DE <= #SEARCH_DE#
                           ) ,0) AS PRNCPAL_RPAY_AMOUNT
                          ,NVL((
                             SELECT SUM(AA.RPAY_AMOUNT)
                             FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
                             WHERE AA.PBNCD_NO = A.PBNCD_NO
                             AND   AA.RPAY_DE <= #SEARCH_DE#
                           ) ,0) AS INTR_RPAY_AMOUNT        
                          , NVL(A.BRRW_AMOUNT ,0) - NVL((
                               SELECT SUM(AA.RPAY_AMOUNT)
                               FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                               WHERE AA.PBNCD_NO = A.PBNCD_NO
                               AND   AA.RPAY_DE <= #SEARCH_DE#
                           ) ,0) AS BRRW_BALANCE         
                     from TBFUN_PBNCD A
                     LEFT OUTER JOIN TBPRJ_BSNS_CODE B
                     ON A.BSNS_CODE = B.BSNS_CODE
                     LEFT OUTER JOIN
                       (
                         SELECT DETAIL_CODE AS CODE ,
                           DETAIL_CODE_NM   AS CODE_NM
                         FROM TBFUN_CPTAL_DETAIL_CODE
                         WHERE CODE_SE = '000'
                       )
                       C
                     ON A.CPTAL_KND = C.CODE
                     WHERE A.BRRW_DE <= #SEARCH_DE#
                     AND   (A.LEASE_YM IS NULL OR A.LEASE_YM > #SEARCH_DE#)
                     AND   A.CPTAL_KND LIKE 'B%'
             ) AA
             GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
		) AA
		WHERE AA.BRRW_BALANCE > 0 
		
		UNION ALL 
		
		SELECT *
		FROM 
		(
		      SELECT '8' AS DV1
		           , '' AS DV2
			       , '' AS BSNS_CODE
			       , '' AS BSNS_NM
			       , DECODE(GROUPING_ID(AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM), '1', AA.CPTAL_KND, '') AS CPTAL_KND
			       , DECODE(GROUPING_ID(AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM), '1', AA.CPTAL_KND_NM, '') AS CPTAL_KND_NM
			       , DECODE(GROUPING_ID(AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM), '0', AA.BRRW_ACNUT_NM, '소계') AS BRRW_ACNUT_NM
		           , MIN(AA.BRRW_DE) AS BRRW_DE
		           , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
		           , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
		           , TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#) AS BRRW_AMOUNT
		           , TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#) AS PRNCPAL_RPAY_AMOUNT
		           , TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#) AS INTR_RPAY_AMOUNT
		           , TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#) AS BRRW_BALANCE
		      FROM
		      (
		          SELECT AA.*
		               , MAX(AA.BRRW_BALANCE) OVER (PARTITION BY AA.BSNS_NM) AS GROUP_MAX
		          FROM
		          (     
		                  SELECT '' AS DV1
		                       , '' AS DV2
		                       , AA.BSNS_CODE AS BSNS_CODE
		                       , AA.BSNS_NM AS BSNS_NM
		                       , AA.CPTAL_KND AS CPTAL_KND
		                       , AA.CPTAL_KND_NM AS CPTAL_KND_NM
		                       , AA.BRRW_ACNUT_NM AS BRRW_ACNUT_NM
		                       , MIN(AA.BRRW_DE) AS BRRW_DE
		                       , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
		                       , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
		                       , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
		                       , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
		                       , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
		                       , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
		                  FROM 
		                  (
		                          select A.BSNS_CODE
		                               , B.BSNS_NM
		                               , A.CPTAL_KND
		                               , C.CODE_NM AS CPTAL_KND_NM
		                               , A.BRRW_DE
		                               , A.EXPRTN_DE
		                               , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
		                               , A.INTRT     
		                               , A.BRRW_AMOUNT
		                               , A.LEASE_YM
		                               , A.BRRW_ACNUT_NM
		                               ,NVL((
		                                  SELECT SUM(AA.RPAY_AMOUNT)
		                                  FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
		                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
		                                  AND   AA.RPAY_DE <= #SEARCH_DE#
		                                ) ,0) AS PRNCPAL_RPAY_AMOUNT
		                               ,NVL((
		                                  SELECT SUM(AA.RPAY_AMOUNT)
		                                  FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
		                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
		                                  AND   AA.RPAY_DE <= #SEARCH_DE#
		                                ) ,0) AS INTR_RPAY_AMOUNT        
		                               , NVL(A.BRRW_AMOUNT ,0) - NVL((
		                                    SELECT SUM(AA.RPAY_AMOUNT)
		                                    FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
		                                    WHERE AA.PBNCD_NO = A.PBNCD_NO
		                                    AND   AA.RPAY_DE <= #SEARCH_DE#
		                                ) ,0) AS BRRW_BALANCE         
		                          from TBFUN_PBNCD A
		                          LEFT OUTER JOIN TBPRJ_BSNS_CODE B
		                          ON A.BSNS_CODE = B.BSNS_CODE
		                          LEFT OUTER JOIN
		                            (
		                              SELECT DETAIL_CODE AS CODE ,
		                                DETAIL_CODE_NM   AS CODE_NM
		                              FROM TBFUN_CPTAL_DETAIL_CODE
		                              WHERE CODE_SE = '000'
		                            )
		                            C
		                          ON A.CPTAL_KND = C.CODE
		                          WHERE A.BRRW_DE <= #SEARCH_DE#
		                          AND (A.LEASE_YM IS NULL OR A.LEASE_YM > #SEARCH_DE#)
		                          AND   A.CPTAL_KND LIKE 'B%'
		                  ) AA
		                  GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM
		          ) AA
		    ) AA
		    WHERE AA.GROUP_MAX > 0
		    GROUP BY ROLLUP(AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM) 
		    HAVING GROUPING_ID(AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM) IN (0,1) 
		    order by grouping(AA.CPTAL_KND_NM) desc, AA.CPTAL_KND_NM
		           , grouping(AA.BRRW_ACNUT_NM) desc, AA.BRRW_ACNUT_NM
		)
		
		UNION ALL 
		
		SELECT '9' AS DV1
		     , '금융리스처리(C=C1+C2)' AS DV2
		     , '' AS BSNS_CODE
		     , '' AS BSNS_NM
		     , '' AS CPTAL_KND
		     , '' AS CPTAL_KND_NM
		     , '합계' AS BRRW_ACNUT_NM
		     , MIN(AA.BRRW_DE) AS BRRW_DE
		     , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
		     , NVL(TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00'), '0.00') AS INTRT
		     , NVL(TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#), 0) AS BRRW_AMOUNT
		     , NVL(TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS PRNCPAL_RPAY_AMOUNT
		     , NVL(TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS INTR_RPAY_AMOUNT
		     , NVL(TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#), 0) AS BRRW_BALANCE
		FROM
		(
             SELECT '' AS DV1
                  , '' AS DV2
                  , AA.BSNS_CODE AS BSNS_CODE
                  , AA.BSNS_NM AS BSNS_NM
                  , AA.CPTAL_KND AS CPTAL_KND
                  , AA.CPTAL_KND_NM AS CPTAL_KND_NM
                  , MIN(AA.BRRW_DE) AS BRRW_DE
                  , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
                  , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
                  , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
                  , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
                  , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
                  , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
             FROM 
             (
                     select A.BSNS_CODE
                          , B.BSNS_NM
                          , A.CPTAL_KND
                          , C.CODE_NM AS CPTAL_KND_NM
                          , A.BRRW_DE
                          , A.EXPRTN_DE
                          , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
                          , A.INTRT     
                          , A.BRRW_AMOUNT
                          , A.LEASE_YM
                          ,NVL((
                             SELECT SUM(AA.RPAY_AMOUNT)
                             FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                             WHERE AA.PBNCD_NO = A.PBNCD_NO
                             AND   AA.RPAY_DE <= #SEARCH_DE#
                           ) ,0) AS PRNCPAL_RPAY_AMOUNT
                          ,NVL((
                             SELECT SUM(AA.RPAY_AMOUNT)
                             FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
                             WHERE AA.PBNCD_NO = A.PBNCD_NO
                             AND   AA.RPAY_DE <= #SEARCH_DE#
                           ) ,0) AS INTR_RPAY_AMOUNT        
                          , NVL(A.BRRW_AMOUNT ,0) - NVL((
                               SELECT SUM(AA.RPAY_AMOUNT)
                               FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                               WHERE AA.PBNCD_NO = A.PBNCD_NO
                               AND   AA.RPAY_DE <= #SEARCH_DE#
                           ) ,0) AS BRRW_BALANCE         
                     from TBFUN_PBNCD A
                     LEFT OUTER JOIN TBPRJ_BSNS_CODE B
                     ON A.BSNS_CODE = B.BSNS_CODE
                     LEFT OUTER JOIN
                       (
                         SELECT DETAIL_CODE AS CODE ,
                           DETAIL_CODE_NM   AS CODE_NM
                         FROM TBFUN_CPTAL_DETAIL_CODE
                         WHERE CODE_SE = '000'
                       )
                       C
                     ON A.CPTAL_KND = C.CODE
                     WHERE A.BRRW_DE <= #SEARCH_DE#
                     AND   (A.LEASE_YM IS NOT NULL OR A.LEASE_YM <= #SEARCH_DE#)
             ) AA
             GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
		) AA
		WHERE AA.BRRW_BALANCE > 0 
		
		UNION ALL 
		
		SELECT *
		FROM
		(
		      SELECT '10' AS DV1
		           , '' AS DV2
		           , '' AS BSNS_CODE
		           , '' AS BSNS_NM
		           , '' AS CPTAL_KND
          		   , '' AS CPTAL_KND_NM
           		   , AA.CPTAL_KND_NM AS BRRW_ACNUT_NM
		           , MIN(AA.BRRW_DE) AS BRRW_DE
		           , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
		           , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
		           , TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#) AS BRRW_AMOUNT
		           , TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#) AS PRNCPAL_RPAY_AMOUNT
		           , TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#) AS INTR_RPAY_AMOUNT
		           , TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#) AS BRRW_BALANCE
		      FROM
		      (
                  SELECT '' AS DV1
                       , '' AS DV2
                       , AA.BSNS_CODE AS BSNS_CODE
                       , AA.BSNS_NM AS BSNS_NM
                       , AA.CPTAL_KND AS CPTAL_KND
                       , AA.CPTAL_KND_NM AS CPTAL_KND_NM
                       , MIN(AA.BRRW_DE) AS BRRW_DE
                       , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
                       , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
                       , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
                       , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
                       , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
                       , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
                  FROM 
                  (
                          select A.BSNS_CODE
                               , B.BSNS_NM
                               , A.CPTAL_KND
                               , C.CODE_NM AS CPTAL_KND_NM
                               , A.BRRW_DE
                               , A.EXPRTN_DE
                               , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
                               , A.INTRT     
                               , A.BRRW_AMOUNT
                               , A.LEASE_YM
                               ,NVL((
                                  SELECT SUM(AA.RPAY_AMOUNT)
                                  FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
                                  AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS PRNCPAL_RPAY_AMOUNT
                               ,NVL((
                                  SELECT SUM(AA.RPAY_AMOUNT)
                                  FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
                                  AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS INTR_RPAY_AMOUNT        
                               , NVL(A.BRRW_AMOUNT ,0) - NVL((
                                    SELECT SUM(AA.RPAY_AMOUNT)
                                    FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                                    WHERE AA.PBNCD_NO = A.PBNCD_NO
                                    AND   AA.RPAY_DE <= #SEARCH_DE#
                                ) ,0) AS BRRW_BALANCE         
                          from TBFUN_PBNCD A
                          LEFT OUTER JOIN TBPRJ_BSNS_CODE B
                          ON A.BSNS_CODE = B.BSNS_CODE
                          LEFT OUTER JOIN
                            (
                              SELECT DETAIL_CODE AS CODE ,
                                DETAIL_CODE_NM   AS CODE_NM
                              FROM TBFUN_CPTAL_DETAIL_CODE
                              WHERE CODE_SE = '000'
                            )
                            C
                          ON A.CPTAL_KND = C.CODE
                          WHERE A.BRRW_DE <= #SEARCH_DE#
                          AND   (A.LEASE_YM IS NOT NULL OR A.LEASE_YM <= #SEARCH_DE#)
                  ) AA
                  GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
		      ) AA
		      WHERE AA.BRRW_BALANCE > 0 
		      GROUP BY AA.CPTAL_KND_NM
		      ORDER BY AA.CPTAL_KND_NM
		)
		
		UNION ALL 
		
		SELECT '11' AS DV1
		     , '장기채(C1)' AS DV2
		     , '' AS BSNS_CODE
		     , '' AS BSNS_NM
		     , '' AS CPTAL_KND
		     , '' AS CPTAL_KND_NM
		     , '합계' AS BRRW_ACNUT_NM
		     , MIN(AA.BRRW_DE) AS BRRW_DE
		     , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
		     , NVL(TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00'), '0.00') AS INTRT
		     , NVL(TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#), 0) AS BRRW_AMOUNT
		     , NVL(TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS PRNCPAL_RPAY_AMOUNT
		     , NVL(TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS INTR_RPAY_AMOUNT
		     , NVL(TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#), 0) AS BRRW_BALANCE
		FROM
		(
              SELECT '' AS DV1
                   , '' AS DV2
                   , AA.BSNS_CODE AS BSNS_CODE
                   , AA.BSNS_NM AS BSNS_NM
                   , AA.CPTAL_KND AS CPTAL_KND
                   , AA.CPTAL_KND_NM AS CPTAL_KND_NM
                   , MIN(AA.BRRW_DE) AS BRRW_DE
                   , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
                   , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
                   , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
                   , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
                   , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
                   , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
              FROM 
              (
                      select A.BSNS_CODE
                           , B.BSNS_NM
                           , A.CPTAL_KND
                           , C.CODE_NM AS CPTAL_KND_NM
                           , A.BRRW_DE
                           , A.EXPRTN_DE
                           , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
                           , A.INTRT     
                           , A.BRRW_AMOUNT
                           , A.LEASE_YM
                           ,NVL((
                              SELECT SUM(AA.RPAY_AMOUNT)
                              FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                              WHERE AA.PBNCD_NO = A.PBNCD_NO
                              AND   AA.RPAY_DE <= #SEARCH_DE#
                            ) ,0) AS PRNCPAL_RPAY_AMOUNT
                           ,NVL((
                              SELECT SUM(AA.RPAY_AMOUNT)
                              FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
                              WHERE AA.PBNCD_NO = A.PBNCD_NO
                              AND   AA.RPAY_DE <= #SEARCH_DE#
                            ) ,0) AS INTR_RPAY_AMOUNT        
                           , NVL(A.BRRW_AMOUNT ,0) - NVL((
                                SELECT SUM(AA.RPAY_AMOUNT)
                                FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                                WHERE AA.PBNCD_NO = A.PBNCD_NO
                                AND   AA.RPAY_DE <= #SEARCH_DE#
                            ) ,0) AS BRRW_BALANCE         
                      from TBFUN_PBNCD A
                      LEFT OUTER JOIN TBPRJ_BSNS_CODE B
                      ON A.BSNS_CODE = B.BSNS_CODE
                      LEFT OUTER JOIN
                        (
                          SELECT DETAIL_CODE AS CODE ,
                            DETAIL_CODE_NM   AS CODE_NM
                          FROM TBFUN_CPTAL_DETAIL_CODE
                          WHERE CODE_SE = '000'
                        )
                        C
                      ON A.CPTAL_KND = C.CODE
                      WHERE A.BRRW_DE <= #SEARCH_DE#
                      AND   (A.LEASE_YM IS NOT NULL OR A.LEASE_YM <= #SEARCH_DE#)
                      AND   A.CPTAL_KND LIKE 'A%'
              ) AA
              GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
		) AA
		WHERE AA.BRRW_BALANCE > 0 
		
		UNION ALL 
		
		SELECT *
		FROM 
		(
		      SELECT '12' AS DV1
		           , '' AS DV2
			       , '' AS BSNS_CODE
			       , '' AS BSNS_NM
			       , DECODE(GROUPING_ID(AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM), '1', AA.CPTAL_KND, '') AS CPTAL_KND
			       , DECODE(GROUPING_ID(AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM), '1', AA.CPTAL_KND_NM, '') AS CPTAL_KND_NM
			       , DECODE(GROUPING_ID(AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM), '0', AA.BRRW_ACNUT_NM, '소계') AS BRRW_ACNUT_NM
		           , MIN(AA.BRRW_DE) AS BRRW_DE
		           , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
		           , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
		           , TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#) AS BRRW_AMOUNT
		           , TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#) AS PRNCPAL_RPAY_AMOUNT
		           , TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#) AS INTR_RPAY_AMOUNT
		           , TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#) AS BRRW_BALANCE
		      FROM
		      (
		          SELECT AA.*
		               , MAX(AA.BRRW_BALANCE) OVER (PARTITION BY AA.BSNS_NM) AS GROUP_MAX
		          FROM
		          (     
		                  SELECT '' AS DV1
		                       , '' AS DV2
		                       , AA.BSNS_CODE AS BSNS_CODE
		                       , AA.BSNS_NM AS BSNS_NM
		                       , AA.CPTAL_KND AS CPTAL_KND
		                       , AA.CPTAL_KND_NM AS CPTAL_KND_NM
		                       , AA.BRRW_ACNUT_NM AS BRRW_ACNUT_NM
		                       , MIN(AA.BRRW_DE) AS BRRW_DE
		                       , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
		                       , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
		                       , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
		                       , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
		                       , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
		                       , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
		                  FROM 
		                  (
		                          select A.BSNS_CODE
		                               , B.BSNS_NM
		                               , A.CPTAL_KND
		                               , C.CODE_NM AS CPTAL_KND_NM
		                               , A.BRRW_DE
		                               , A.EXPRTN_DE
		                               , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
		                               , A.INTRT     
		                               , A.BRRW_AMOUNT
		                               , A.LEASE_YM
		                               , A.BRRW_ACNUT_NM
		                               ,NVL((
		                                  SELECT SUM(AA.RPAY_AMOUNT)
		                                  FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
		                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
		                                  AND   AA.RPAY_DE <= #SEARCH_DE#
		                                ) ,0) AS PRNCPAL_RPAY_AMOUNT
		                               ,NVL((
		                                  SELECT SUM(AA.RPAY_AMOUNT)
		                                  FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
		                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
		                                  AND   AA.RPAY_DE <= #SEARCH_DE#
		                                ) ,0) AS INTR_RPAY_AMOUNT        
		                               , NVL(A.BRRW_AMOUNT ,0) - NVL((
		                                    SELECT SUM(AA.RPAY_AMOUNT)
		                                    FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
		                                    WHERE AA.PBNCD_NO = A.PBNCD_NO
		                                    AND   AA.RPAY_DE <= #SEARCH_DE#
		                                ) ,0) AS BRRW_BALANCE         
		                          from TBFUN_PBNCD A
		                          LEFT OUTER JOIN TBPRJ_BSNS_CODE B
		                          ON A.BSNS_CODE = B.BSNS_CODE
		                          LEFT OUTER JOIN
		                            (
		                              SELECT DETAIL_CODE AS CODE ,
		                                DETAIL_CODE_NM   AS CODE_NM
		                              FROM TBFUN_CPTAL_DETAIL_CODE
		                              WHERE CODE_SE = '000'
		                            )
		                            C
		                          ON A.CPTAL_KND = C.CODE
		                          WHERE A.BRRW_DE <= #SEARCH_DE#
		                          AND   (A.LEASE_YM IS NOT NULL OR A.LEASE_YM <= #SEARCH_DE#)
		                          AND   A.CPTAL_KND LIKE 'A%'
		                  ) AA
		                  GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM
		          ) AA
		    ) AA
		    WHERE AA.GROUP_MAX > 0
		    GROUP BY ROLLUP(AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM) 
		    HAVING GROUPING_ID(AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM) IN (0,1) 
		    order by grouping(AA.CPTAL_KND_NM) desc, AA.CPTAL_KND_NM
		           , grouping(AA.BRRW_ACNUT_NM) desc, AA.BRRW_ACNUT_NM
		)
		
		UNION ALL 
		
		SELECT '13' AS DV1
		     , '단기채(C2)' AS DV2
		     , '' AS BSNS_CODE
		     , '' AS BSNS_NM
		     , '' AS CPTAL_KND
		     , '' AS CPTAL_KND_NM
		     , '합계' AS BRRW_ACNUT_NM
		     , MIN(AA.BRRW_DE) AS BRRW_DE
		     , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
		     , NVL(TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00'), '0.00') AS INTRT
		     , NVL(TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#), 0) AS BRRW_AMOUNT
		     , NVL(TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS PRNCPAL_RPAY_AMOUNT
		     , NVL(TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#), 0) AS INTR_RPAY_AMOUNT
		     , NVL(TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#), 0) AS BRRW_BALANCE
		FROM
		(
              SELECT '' AS DV1
                   , '' AS DV2
                   , AA.BSNS_CODE AS BSNS_CODE
                   , AA.BSNS_NM AS BSNS_NM
                   , AA.CPTAL_KND AS CPTAL_KND
                   , AA.CPTAL_KND_NM AS CPTAL_KND_NM
                   , MIN(AA.BRRW_DE) AS BRRW_DE
                   , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
                   , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
                   , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
                   , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
                   , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
                   , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
              FROM 
              (
                      select A.BSNS_CODE
                           , B.BSNS_NM
                           , A.CPTAL_KND
                           , C.CODE_NM AS CPTAL_KND_NM
                           , A.BRRW_DE
                           , A.EXPRTN_DE
                           , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
                           , A.INTRT     
                           , A.BRRW_AMOUNT
                           , A.LEASE_YM
                           ,NVL((
                              SELECT SUM(AA.RPAY_AMOUNT)
                              FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                              WHERE AA.PBNCD_NO = A.PBNCD_NO
                              AND   AA.RPAY_DE <= #SEARCH_DE#
                            ) ,0) AS PRNCPAL_RPAY_AMOUNT
                           ,NVL((
                              SELECT SUM(AA.RPAY_AMOUNT)
                              FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
                              WHERE AA.PBNCD_NO = A.PBNCD_NO
                              AND   AA.RPAY_DE <= #SEARCH_DE#
                            ) ,0) AS INTR_RPAY_AMOUNT        
                           , NVL(A.BRRW_AMOUNT ,0) - NVL((
                                SELECT SUM(AA.RPAY_AMOUNT)
                                FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
                                WHERE AA.PBNCD_NO = A.PBNCD_NO
                                AND   AA.RPAY_DE <= #SEARCH_DE#
                            ) ,0) AS BRRW_BALANCE         
                      from TBFUN_PBNCD A
                      LEFT OUTER JOIN TBPRJ_BSNS_CODE B
                      ON A.BSNS_CODE = B.BSNS_CODE
                      LEFT OUTER JOIN
                        (
                          SELECT DETAIL_CODE AS CODE ,
                            DETAIL_CODE_NM   AS CODE_NM
                          FROM TBFUN_CPTAL_DETAIL_CODE
                          WHERE CODE_SE = '000'
                        )
                        C
                      ON A.CPTAL_KND = C.CODE
                      WHERE A.BRRW_DE <= #SEARCH_DE#
                      AND   (A.LEASE_YM IS NOT NULL OR A.LEASE_YM <= #SEARCH_DE#)
                      AND   A.CPTAL_KND LIKE 'B%'
              ) AA
              GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM
		) AA
		WHERE AA.BRRW_BALANCE > 0 

		
		UNION ALL 
		
		SELECT *
		FROM 
		(
		      SELECT '14' AS DV1
		           , '' AS DV2
		           , '' AS BSNS_CODE
		           , '' AS BSNS_NM
		           , DECODE(GROUPING_ID(AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM), '1', AA.CPTAL_KND, '') AS CPTAL_KND
		           , DECODE(GROUPING_ID(AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM), '1', AA.CPTAL_KND_NM, '') AS CPTAL_KND_NM
		           , DECODE(GROUPING_ID(AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM), '0', AA.BRRW_ACNUT_NM, '소계') AS BRRW_ACNUT_NM
		           , MIN(AA.BRRW_DE) AS BRRW_DE
		           , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
		           , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
		           , TRUNC(SUM(AA.BRRW_AMOUNT) / #SEARCH_GBN#) AS BRRW_AMOUNT
		           , TRUNC(SUM(AA.PRNCPAL_RPAY_AMOUNT) / #SEARCH_GBN#) AS PRNCPAL_RPAY_AMOUNT
		           , TRUNC(SUM(AA.INTR_RPAY_AMOUNT) / #SEARCH_GBN#) AS INTR_RPAY_AMOUNT
		           , TRUNC(SUM(AA.BRRW_BALANCE) / #SEARCH_GBN#) AS BRRW_BALANCE
		      FROM
		      (
		          SELECT AA.*
		               , MAX(AA.BRRW_BALANCE) OVER (PARTITION BY AA.BSNS_NM) AS GROUP_MAX
		          FROM
		          (     
		                  SELECT '' AS DV1
		                       , '' AS DV2
		                       , AA.BSNS_CODE AS BSNS_CODE
		                       , AA.BSNS_NM AS BSNS_NM
		                       , AA.CPTAL_KND AS CPTAL_KND
		                       , AA.CPTAL_KND_NM AS CPTAL_KND_NM
		                       , AA.BRRW_ACNUT_NM AS BRRW_ACNUT_NM
		                       , MIN(AA.BRRW_DE) AS BRRW_DE
		                       , MAX(AA.EXPRTN_DE) AS EXPRTN_DE
		                       , TO_CHAR(SUM(AA.INTRT) / COUNT(AA.CPTAL_KND), 'FM9990D00') AS INTRT
		                       , SUM(AA.BRRW_AMOUNT) AS BRRW_AMOUNT
		                       , SUM(AA.PRNCPAL_RPAY_AMOUNT) AS PRNCPAL_RPAY_AMOUNT
		                       , SUM(AA.INTR_RPAY_AMOUNT) AS INTR_RPAY_AMOUNT
		                       , SUM(AA.BRRW_BALANCE) AS BRRW_BALANCE
		                  FROM 
		                  (
		                          select A.BSNS_CODE
		                               , B.BSNS_NM
		                               , A.CPTAL_KND
		                               , C.CODE_NM AS CPTAL_KND_NM
		                               , A.BRRW_DE
		                               , A.EXPRTN_DE
		                               , NVL(A.EXPRTN_AT, 0) AS EXPRTN_AT
		                               , A.INTRT     
		                               , A.BRRW_AMOUNT
		                               , A.LEASE_YM
		                               , A.BRRW_ACNUT_NM
		                               ,NVL((
		                                  SELECT SUM(AA.RPAY_AMOUNT)
		                                  FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
		                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
		                                  AND   AA.RPAY_DE <= #SEARCH_DE#
		                                ) ,0) AS PRNCPAL_RPAY_AMOUNT
		                               ,NVL((
		                                  SELECT SUM(AA.RPAY_AMOUNT)
		                                  FROM TBFUN_PBNCD_INTR_RPAY_DTLS AA
		                                  WHERE AA.PBNCD_NO = A.PBNCD_NO
		                                  AND   AA.RPAY_DE <= #SEARCH_DE#
		                                ) ,0) AS INTR_RPAY_AMOUNT        
		                               , NVL(A.BRRW_AMOUNT ,0) - NVL((
		                                    SELECT SUM(AA.RPAY_AMOUNT)
		                                    FROM TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
		                                    WHERE AA.PBNCD_NO = A.PBNCD_NO
		                                    AND   AA.RPAY_DE <= #SEARCH_DE#
		                                ) ,0) AS BRRW_BALANCE         
		                          from TBFUN_PBNCD A
		                          LEFT OUTER JOIN TBPRJ_BSNS_CODE B
		                          ON A.BSNS_CODE = B.BSNS_CODE
		                          LEFT OUTER JOIN
		                            (
		                              SELECT DETAIL_CODE AS CODE ,
		                                DETAIL_CODE_NM   AS CODE_NM
		                              FROM TBFUN_CPTAL_DETAIL_CODE
		                              WHERE CODE_SE = '000'
		                            )
		                            C
		                          ON A.CPTAL_KND = C.CODE
		                          WHERE A.BRRW_DE <= #SEARCH_DE#
		                          AND   (A.LEASE_YM IS NOT NULL OR A.LEASE_YM <= #SEARCH_DE#)
		                          AND   A.CPTAL_KND LIKE 'B%'
		                  ) AA
		                  GROUP BY AA.BSNS_CODE, AA.BSNS_NM, AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM
		          ) AA
		    ) AA
		    WHERE AA.GROUP_MAX > 0
		    GROUP BY ROLLUP(AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM) 
		    HAVING GROUPING_ID(AA.CPTAL_KND, AA.CPTAL_KND_NM, AA.BRRW_ACNUT_NM) IN (0,1) 
		    order by grouping(AA.CPTAL_KND_NM) desc, AA.CPTAL_KND_NM
		           , grouping(AA.BRRW_ACNUT_NM) desc, AA.BRRW_ACNUT_NM
		)
		]]>
	</select>

	<!-- 재무상태명세 조회 -->
	<select id="FUN020203DAO.selectPbncdList03" resultClass="java.util.HashMap">
		<![CDATA[	
		WITH THIS_STACNT_T AS
		  (
		    /*당기*/
		    SELECT ACCNUT_YEAR ,
		      CASE
		        WHEN ACCNUT_ACNT_CODE = '10000000'
		          /*자산*/
		        THEN '13030990'
		          /*자산총계*/
		        WHEN ACCNUT_ACNT_CODE = '20000000'
		          /*부채*/
		        THEN '22070990'
		          /*부채총계*/
		        WHEN ACCNUT_ACNT_CODE = '30000000'
		          /*자본*/
		        THEN '32070990'
		          /*자본총계*/
		        ELSE ACCNUT_ACNT_CODE
		      END                        AS ACCNUT_ACNT_CODE ,
		      NVL(SUM(DEBTOR_AMOUNT) ,0) AS DR_AMT           ,
		      CASE
		        WHEN ACCNUT_ACNT_CODE NOT IN ('30000000','34000000','34003000')  
		        THEN NVL(SUM(CRDIT_AMOUNT ) ,0)
		        ELSE NVL(SUM(CRDIT_AMOUNT ) ,0) +
		          (
		            SELECT NVL(SUM(DEBTOR_AMOUNT) - SUM(CRDIT_AMOUNT) ,0)
		            FROM TBACC_ACCNUT_STACNT
		            WHERE ACCNUT_YEAR = SUBSTR(#SEARCH_DE# ,1 ,4)
		            AND ACCNUT_MT BETWEEN '00' AND SUBSTR(#SEARCH_DE# ,5 ,2)
		            AND SUBSTR(ACCNUT_ACNT_CODE ,1 ,1) IN ('1' ,'2' ,'3')
		          )
		      END AS CR_AMT
		    FROM TBACC_ACCNUT_STACNTSUM
		    WHERE ACCNUT_YEAR = SUBSTR(#SEARCH_DE# ,1 ,4)
		    AND ACCNUT_MT BETWEEN '00'
		      /*이월*/
		    AND SUBSTR(#SEARCH_DE# ,5 ,2)
		      /*결산월*/
		    GROUP BY ACCNUT_YEAR ,
		      ACCNUT_ACNT_CODE
		    UNION ALL
		    SELECT ACCNUT_YEAR ,
		      CASE
		        WHEN ACCNUT_ACNT_CODE = '10000000'
		          /*자산*/
		        THEN '13030990'
		          /*자산총계*/
		        WHEN ACCNUT_ACNT_CODE = '20000000'
		          /*부채*/
		        THEN '22070990'
		          /*부채총계*/
		        WHEN ACCNUT_ACNT_CODE = '30000000'
		          /*자본*/
		        THEN '32070990'
		          /*자본총계*/
		        ELSE ACCNUT_ACNT_CODE
		      END                        AS ACCNUT_ACNT_CODE ,
		      NVL(SUM(DEBTOR_AMOUNT) ,0) AS DR_AMT           ,
		      CASE
		        WHEN ACCNUT_ACNT_CODE NOT IN ('34003000')
		        THEN NVL(SUM(CRDIT_AMOUNT ) ,0)
		        ELSE NVL(SUM(CRDIT_AMOUNT ) ,0) +
		          (
		            SELECT NVL(SUM(DEBTOR_AMOUNT) - SUM(CRDIT_AMOUNT) ,0)
		            FROM TBACC_ACCNUT_STACNT
		            WHERE ACCNUT_YEAR = SUBSTR(#SEARCH_DE# ,1 ,4)
		            AND ACCNUT_MT BETWEEN '00' AND SUBSTR(#SEARCH_DE# ,5 ,2)
		            AND SUBSTR(ACCNUT_ACNT_CODE ,1 ,1) IN ('1' ,'2' ,'3')
		          )
		      END AS CR_AMT
		    FROM TBACC_ACCNUT_STACNT
		    WHERE ACCNUT_YEAR = SUBSTR(#SEARCH_DE# ,1 ,4)
		    AND ACCNUT_MT BETWEEN '00'
		      /*이월*/
		    AND SUBSTR(#SEARCH_DE# ,5 ,2)
		      /*결산월*/
		    GROUP BY ACCNUT_YEAR ,
		      ACCNUT_ACNT_CODE
		  )
		  ,
		  FIN_DEBT_T AS
		  (
		    /* 단기차입금 */
		    SELECT '21020010' AS ACCNUT_ACNT_CODE
		         , SUM(NVL(A.BRRW_AMOUNT ,0) - NVL(
		          (
		            SELECT SUM(AA.RPAY_AMOUNT)
		            FROM   TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
		            WHERE   AA.PBNCD_NO = A.PBNCD_NO
		          ) ,0)) AS BRRW_BALANCE
		    FROM   TBFUN_PBNCD A
		    LEFT OUTER JOIN
		    (
		      SELECT CODE
		           , DETAIL_CODE
		           , DETAIL_CODE_NM
		        FROM TBFUN_CPTAL_DETAIL_CODE
		       WHERE CODE_SE = '000'
		    ) B
		    ON A.CPTAL_KND = B.DETAIL_CODE
		    WHERE B.CODE = 'B' /* 단기채 */
		    
		    UNION ALL
		    
		    /* 유동성장기차입금 */
		    SELECT '21020020' AS ACCNUT_ACNT_CODE
		          , SUM(NVL((
		            SELECT SUM(AA.RPAY_AMOUNT)
		            FROM   TBFUN_PBNCD_PRNCPAL_RPAY_PLAN AA
		            WHERE  AA.PBNCD_NO = A.PBNCD_NO
		            AND    AA.RPAY_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(#SEARCH_DE#), -12) + 1, 'YYYYMMDD') AND #SEARCH_DE#
		          ) ,0)) AS RPAY_PLAN_SM
		    FROM   TBFUN_PBNCD A
		    LEFT OUTER JOIN
		    (
		      SELECT CODE
		           , DETAIL_CODE
		           , DETAIL_CODE_NM
		        FROM TBFUN_CPTAL_DETAIL_CODE
		       WHERE CODE_SE = '000'
		    ) B
		    ON A.CPTAL_KND = B.DETAIL_CODE
		    WHERE B.CODE = 'A' /* 장기채 */
		    AND   A.CPTAL_KND IN ('A01', 'A05', 'A07') /* 금융기관차입, 지역개발기금, 에너지합리화자금 */
		    
		    UNION ALL
		    
		    /* 유동성사채 */
		    SELECT '21020040' AS ACCNUT_ACNT_CODE
		          , SUM(NVL((
		            SELECT SUM(AA.RPAY_AMOUNT)
		            FROM   TBFUN_PBNCD_PRNCPAL_RPAY_PLAN AA
		            WHERE  AA.PBNCD_NO = A.PBNCD_NO
		            AND    AA.RPAY_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(#SEARCH_DE#), -12) + 1, 'YYYYMMDD') AND #SEARCH_DE#
		          ) ,0)) AS RPAY_PLAN_SM
		    FROM   TBFUN_PBNCD A
		    LEFT OUTER JOIN
		    (
		      SELECT CODE
		           , DETAIL_CODE
		           , DETAIL_CODE_NM
		        FROM TBFUN_CPTAL_DETAIL_CODE
		       WHERE CODE_SE = '000'
		    ) B
		    ON A.CPTAL_KND = B.DETAIL_CODE
		    WHERE B.CODE = 'A' /* 장기채 */
		    AND   A.CPTAL_KND IN ('A03', 'A04') /* 공모채권, 사모채권 */
		    
		    UNION ALL
		    
		    /* 유동성국민주택기금차입금 */
		    SELECT '21020050' AS ACCNUT_ACNT_CODE
		          , SUM(NVL((
		            SELECT SUM(AA.RPAY_AMOUNT)
		            FROM   TBFUN_PBNCD_PRNCPAL_RPAY_PLAN AA
		            WHERE  AA.PBNCD_NO = A.PBNCD_NO
		            AND    AA.RPAY_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(#SEARCH_DE#), -12) + 1, 'YYYYMMDD') AND #SEARCH_DE#
		            AND    SUBSTR(AA.RPAY_DE, 0, 6) > A.LEASE_YM
		          ) ,0)) AS RPAY_PLAN_SM
		    FROM   TBFUN_PBNCD A
		    LEFT OUTER JOIN
		    (
		      SELECT CODE
		           , DETAIL_CODE
		           , DETAIL_CODE_NM
		        FROM TBFUN_CPTAL_DETAIL_CODE
		       WHERE CODE_SE = '000'
		    ) B
		    ON A.CPTAL_KND = B.DETAIL_CODE
		    WHERE B.CODE = 'A' /* 장기채 */
		    AND   A.CPTAL_KND IN ('A02') /* 주택도시기금 */
		    AND   (A.LEASE_YM IS NULL OR A.LEASE_YM >= SUBSTR(#SEARCH_DE#, 0, 6))
		    
		    UNION ALL
		    
		    /* 유동성보상채권차입금 */
		    SELECT '21020060' AS ACCNUT_ACNT_CODE
		          , SUM(NVL((
		            SELECT SUM(AA.RPAY_AMOUNT)
		            FROM   TBFUN_PBNCD_PRNCPAL_RPAY_PLAN AA
		            WHERE  AA.PBNCD_NO = A.PBNCD_NO
		            AND    AA.RPAY_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(#SEARCH_DE#), -12) + 1, 'YYYYMMDD') AND #SEARCH_DE#
		          ) ,0)) AS RPAY_PLAN_SM
		    FROM   TBFUN_PBNCD A
		    LEFT OUTER JOIN
		    (
		      SELECT CODE
		           , DETAIL_CODE
		           , DETAIL_CODE_NM
		        FROM TBFUN_CPTAL_DETAIL_CODE
		       WHERE CODE_SE = '000'
		    ) B
		    ON A.CPTAL_KND = B.DETAIL_CODE
		    WHERE B.CODE = 'A' /* 장기채 */
		    AND   A.CPTAL_KND IN ('A06') /* 용지보상채권 */
		  )  
		  ,
		  FIN_DEBT_T2 AS
		  (
		    /* 사채 */
		    SELECT '22020010' AS ACCNUT_ACNT_CODE
		          , SUM(NVL(A.BRRW_AMOUNT ,0) - NVL(
		          (
		            SELECT SUM(AA.RPAY_AMOUNT)
		            FROM   TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
		            WHERE   AA.PBNCD_NO = A.PBNCD_NO
		          ) ,0))AS BRRW_BALANCE
		    FROM   TBFUN_PBNCD A
		    LEFT OUTER JOIN
		    (
		      SELECT CODE
		           , DETAIL_CODE
		           , DETAIL_CODE_NM
		        FROM TBFUN_CPTAL_DETAIL_CODE
		       WHERE CODE_SE = '000'
		    ) B
		    ON A.CPTAL_KND = B.DETAIL_CODE
		    WHERE B.CODE = 'A' /* 장기채 */
		    AND   A.CPTAL_KND IN ('A03', 'A04') /* 공모채권, 사모채권 */
		    
		    UNION ALL
		    
		    /* 장기차입금 */
		    SELECT '22020020' AS ACCNUT_ACNT_CODE
		          , SUM(NVL(A.BRRW_AMOUNT ,0) - NVL(
		          (
		            SELECT SUM(AA.RPAY_AMOUNT)
		            FROM   TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
		            WHERE   AA.PBNCD_NO = A.PBNCD_NO
		          ) ,0)) AS BRRW_BALANCE
		    FROM   TBFUN_PBNCD A
		    LEFT OUTER JOIN
		    (
		      SELECT CODE
		           , DETAIL_CODE
		           , DETAIL_CODE_NM
		        FROM TBFUN_CPTAL_DETAIL_CODE
		       WHERE CODE_SE = '000'
		    ) B
		    ON A.CPTAL_KND = B.DETAIL_CODE
		    WHERE B.CODE = 'A' /* 장기채 */
		    AND   A.CPTAL_KND IN ('A01', 'A05', 'A07') /* 금융기관차입, 지역개발기금, 에너지합리화자금 */
		    
		    UNION ALL
		    
		    /* 국민주택기금차입금 */
		    SELECT '22020040' AS ACCNUT_ACNT_CODE
		          , SUM(NVL(A.BRRW_AMOUNT ,0) - NVL(
		          (
		            SELECT SUM(AA.RPAY_AMOUNT)
		            FROM   TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
		            WHERE  AA.PBNCD_NO = A.PBNCD_NO
		            AND    SUBSTR(AA.RPAY_DE, 0, 6) > A.LEASE_YM
		          ) ,0)) AS BRRW_BALANCE          
		    FROM   TBFUN_PBNCD A
		    LEFT OUTER JOIN
		    (
		      SELECT CODE
		           , DETAIL_CODE
		           , DETAIL_CODE_NM
		        FROM TBFUN_CPTAL_DETAIL_CODE
		       WHERE CODE_SE = '000'
		    ) B
		    ON A.CPTAL_KND = B.DETAIL_CODE
		    WHERE B.CODE = 'A' /* 장기채 */
		    AND   A.CPTAL_KND IN ('A02') /* 주택도시기금 */
		    AND   (A.LEASE_YM IS NULL OR A.LEASE_YM >= SUBSTR(#SEARCH_DE#, 0, 6))
		    
		    UNION ALL
		    
		    /* 장기보상채권차입금 */
		    SELECT '22020050' AS ACCNUT_ACNT_CODE
		          , SUM(NVL(A.BRRW_AMOUNT ,0) - NVL(
		          (
		            SELECT SUM(AA.RPAY_AMOUNT)
		            FROM   TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
		            WHERE  AA.PBNCD_NO = A.PBNCD_NO
		            AND    SUBSTR(AA.RPAY_DE, 0, 6) > A.LEASE_YM
		          ) ,0)) AS BRRW_BALANCE     
		    FROM   TBFUN_PBNCD A
		    LEFT OUTER JOIN
		    (
		      SELECT CODE
		           , DETAIL_CODE
		           , DETAIL_CODE_NM
		        FROM TBFUN_CPTAL_DETAIL_CODE
		       WHERE CODE_SE = '000'
		    ) B
		    ON A.CPTAL_KND = B.DETAIL_CODE
		    WHERE B.CODE = 'A' /* 장기채 */
		    AND   A.CPTAL_KND IN ('A06') /* 용지보상채권 */
		  )    
		SELECT AAA.ACCNUT_ACNT_CODE
		     , AAA.ACCNUT_ACNT_NM
		     , TRUNC(AAA.THSTRM_AMOUNT / #SEARCH_GBN#) AS THSTRM_AMOUNT
		     , TRUNC(AAA.THSTRM_SM / #SEARCH_GBN#) AS THSTRM_SM
		     , TRUNC(AAA.FIN_DEBT_AMOUNT / #SEARCH_GBN#) AS FIN_DEBT_AMOUNT
		     , TRUNC(AAA.FIN_DEBT_SM / #SEARCH_GBN#) AS FIN_DEBT_SM
		     , CASE WHEN ACCNUT_ACNT_CODE LIKE '2%' THEN TRUNC((AAA.THSTRM_AMOUNT - AAA.FIN_DEBT_AMOUNT) / #SEARCH_GBN#) ELSE 0 END AS OPR_DEBT_AMOUNT
		     , CASE WHEN ACCNUT_ACNT_CODE LIKE '2%' THEN TRUNC((AAA.THSTRM_SM - AAA.FIN_DEBT_SM) / #SEARCH_GBN#) ELSE 0 END AS OPR_DEBT_SM
		FROM (     
		      SELECT t1.ACCNUT_ACNT_CODE                                        ,
		        MAX(NVL(t1.OUTPT_ACNT_NM ,t1.ACCNUT_ACNT_NM)) AS ACCNUT_ACNT_NM ,
		        (
		        CASE
		          WHEN T1.ACNT_LEVEL >= 3
		          THEN NVL(SUM(
		            CASE
		              WHEN t1.DBRT_SE                  = 'D'
		              AND NVL(t1.RSYMNEY_ACNT_AT ,'0') = '0'
		              THEN t2.DR_AMT - t2.CR_AMT
		              WHEN t1.DBRT_SE                  = 'D'
		              AND NVL(t1.RSYMNEY_ACNT_AT ,'0') = '1'
		              THEN t2.CR_AMT - t2.DR_AMT
		              WHEN t1.DBRT_SE                  = 'C'
		              AND NVL(t1.RSYMNEY_ACNT_AT ,'0') = '0'
		              THEN t2.CR_AMT - t2.DR_AMT
		              WHEN t1.DBRT_SE                  = 'C'
		              AND NVL(t1.RSYMNEY_ACNT_AT ,'0') = '1'
		              THEN t2.DR_AMT - t2.CR_AMT
		              ELSE 0
		            END) ,0)
		          ELSE 0
		        END) AS THSTRM_AMOUNT ,
		        (
		        CASE
		          WHEN T1.ACNT_LEVEL < 3
		          THEN NVL(SUM(
		            CASE
		              WHEN t1.DBRT_SE                  = 'D'
		              AND NVL(t1.RSYMNEY_ACNT_AT ,'0') = '0'
		              THEN t2.DR_AMT - t2.CR_AMT
		              WHEN t1.DBRT_SE                  = 'D'
		              AND NVL(t1.RSYMNEY_ACNT_AT ,'0') = '1'
		              THEN t2.CR_AMT - t2.DR_AMT
		              WHEN t1.DBRT_SE                  = 'C'
		              AND NVL(t1.RSYMNEY_ACNT_AT ,'0') = '0'
		              THEN t2.CR_AMT - t2.DR_AMT
		              WHEN t1.DBRT_SE                  = 'C'
		              AND NVL(t1.RSYMNEY_ACNT_AT ,'0') = '1'
		              THEN t2.DR_AMT - t2.CR_AMT
		              ELSE 0
		            END) ,0)
		          ELSE 0
		        END) AS THSTRM_SM,
		        (
		        CASE
		          WHEN T1.ACNT_LEVEL >= 3 AND T1.ACCNUT_ACNT_CODE = '21020000'
		          THEN NVL((SELECT SUM(AA.BRRW_BALANCE) FROM FIN_DEBT_T AA), 0)
		          WHEN T1.ACNT_LEVEL >= 3 AND T1.ACCNUT_ACNT_CODE = '22020000'
		          THEN NVL((SELECT SUM(AA.BRRW_BALANCE) FROM FIN_DEBT_T2 AA), 0)
		             - NVL((SELECT SUM(AA.BRRW_BALANCE) FROM FIN_DEBT_T AA WHERE AA.ACCNUT_ACNT_CODE != '21020010'), 0)    
		          WHEN T1.ACNT_LEVEL >= 3 AND T1.ACCNUT_ACNT_CODE = '22020010'
		          THEN NVL(SUM(T4.BRRW_BALANCE), 0) - NVL((SELECT AA.BRRW_BALANCE FROM FIN_DEBT_T AA WHERE AA.ACCNUT_ACNT_CODE = '21020040'), 0) 
		          WHEN T1.ACNT_LEVEL >= 3 AND T1.ACCNUT_ACNT_CODE = '22020020'
		          THEN NVL(SUM(T4.BRRW_BALANCE), 0) - NVL((SELECT AA.BRRW_BALANCE FROM FIN_DEBT_T AA WHERE AA.ACCNUT_ACNT_CODE = '21020020') , 0)
		          WHEN T1.ACNT_LEVEL >= 3 AND T1.ACCNUT_ACNT_CODE = '22020040'
		          THEN NVL(SUM(T4.BRRW_BALANCE), 0) - NVL((SELECT AA.BRRW_BALANCE FROM FIN_DEBT_T AA WHERE AA.ACCNUT_ACNT_CODE = '21020050') , 0)
		          WHEN T1.ACNT_LEVEL >= 3 AND T1.ACCNUT_ACNT_CODE = '22020050'
		          THEN NVL(SUM(T4.BRRW_BALANCE), 0) - NVL((SELECT AA.BRRW_BALANCE FROM FIN_DEBT_T AA WHERE AA.ACCNUT_ACNT_CODE = '21020060') , 0)      
		          WHEN T1.ACNT_LEVEL >= 3
		          THEN NVL(SUM(T3.BRRW_BALANCE), 0)
		          ELSE 0
		        END) AS FIN_DEBT_AMOUNT,
				(
				CASE
				  WHEN T1.ACCNUT_ACNT_CODE = '21000000'
				  THEN NVL((SELECT SUM(AA.BRRW_BALANCE) FROM FIN_DEBT_T AA), 0)
				  WHEN T1.ACCNUT_ACNT_CODE = '22000000'
				  THEN NVL((SELECT SUM(AA.BRRW_BALANCE) FROM FIN_DEBT_T2 AA), 0) - NVL((SELECT SUM(AA.BRRW_BALANCE) FROM FIN_DEBT_T AA WHERE AA.ACCNUT_ACNT_CODE != '21020010'), 0)
				  WHEN T1.ACCNUT_ACNT_CODE = '22070990'
				  THEN NVL((SELECT SUM(AA.BRRW_BALANCE) FROM FIN_DEBT_T AA), 0)
				     + (NVL((SELECT SUM(AA.BRRW_BALANCE) FROM FIN_DEBT_T2 AA), 0) - NVL((SELECT SUM(AA.BRRW_BALANCE) FROM FIN_DEBT_T AA WHERE AA.ACCNUT_ACNT_CODE != '21020010'), 0))
				  ELSE 0
				END) AS FIN_DEBT_SM
		      FROM TBACC_ACCNUT_ACNT_SBJECT t1
		      LEFT OUTER JOIN THIS_STACNT_T t2
		      ON t1.ACCNUT_YEAR       = t2.ACCNUT_YEAR
		      AND t1.ACCNUT_ACNT_CODE = t2.ACCNUT_ACNT_CODE
		      LEFT OUTER JOIN FIN_DEBT_T t3
		      ON t1.ACCNUT_ACNT_CODE = t3.ACCNUT_ACNT_CODE
		      LEFT OUTER JOIN FIN_DEBT_T2 t4
		      ON t1.ACCNUT_ACNT_CODE = t4.ACCNUT_ACNT_CODE
		      WHERE t1.ACCNUT_YEAR         = SUBSTR(#SEARCH_DE# ,1 ,4)
		      AND t1.ACCNUT_ACNT_CODE NOT IN ('32080999')
		      AND t1.ACNT_SE               = '1'  /*재무상태표*/
		      AND t1.OUTPT_AT = '1'  /*출력여부*/
		      AND (t1.ACCNUT_ACNT_CODE LIKE '2%' OR t1.ACCNUT_ACNT_CODE LIKE '3%')
		      GROUP BY t1.ACCNUT_YEAR ,
		        t1.ACNT_LEVEL         ,
		        t1.ACCNUT_ACNT_CODE   ,
		        t1.RSYMNEY_ACNT_AT
		      UNION ALL
		      SELECT '32080999'                                                                                                AS ACCNUT_ACNT_CODE ,
		        '[자본과부채총계]'                                                                                                    AS ACCNUT_ACNT_NM   ,
		        0                                                                                                              AS THSTRM_AMOUNT    ,
		        NVL(SUM(DECODE(t1.DBRT_SE ,'D' ,t2.DR_AMT - t2.CR_AMT ,'C' ,t2.CR_AMT - t2.DR_AMT ,t2.DR_AMT - t2.CR_AMT)) ,0) AS THSTRM_SM
		        , 0
		        , 0
		      FROM TBACC_ACCNUT_ACNT_SBJECT t1
		      LEFT OUTER JOIN THIS_STACNT_T t2
		      ON t1.ACCNUT_YEAR       = t2.ACCNUT_YEAR
		      AND t1.ACCNUT_ACNT_CODE = t2.ACCNUT_ACNT_CODE
		      WHERE t1.ACCNUT_YEAR   = SUBSTR(#SEARCH_DE# ,1 ,4)
		      AND t1.ACNT_SE         = '1'
		        /*재무상태표*/
		      AND t1.OUTPT_AT = '1'
		        /*출력여부*/
		      AND t1.ACCNUT_ACNT_CODE IN ('22070990' ,'32070990')
		      GROUP BY t1.ACCNUT_YEAR ,
		        t1.RSYMNEY_ACNT_AT        
		      ORDER BY ACCNUT_ACNT_CODE NULLS FIRST
		) AAA      		
		]]>
	</select>

	<!-- 부채비율산정 조회 -->
	<select id="FUN020203DAO.selectPbncdList04" resultClass="java.util.HashMap">
		<![CDATA[	
		WITH THIS_STACNT_T AS
		  (
		    /*당기*/
		    SELECT ACCNUT_YEAR ,
		      CASE
		        WHEN ACCNUT_ACNT_CODE = '10000000'
		          /*자산*/
		        THEN '13030990'
		          /*자산총계*/
		        WHEN ACCNUT_ACNT_CODE = '20000000'
		          /*부채*/
		        THEN '22070990'
		          /*부채총계*/
		        WHEN ACCNUT_ACNT_CODE = '30000000'
		          /*자본*/
		        THEN '32070990'
		          /*자본총계*/
		        ELSE ACCNUT_ACNT_CODE
		      END                        AS ACCNUT_ACNT_CODE ,
		      NVL(SUM(DEBTOR_AMOUNT) ,0) AS DR_AMT           ,
		      CASE
		        WHEN ACCNUT_ACNT_CODE NOT IN ('30000000','34000000','34003000')  
		        THEN NVL(SUM(CRDIT_AMOUNT ) ,0)
		        ELSE NVL(SUM(CRDIT_AMOUNT ) ,0) +
		          (
		            SELECT NVL(SUM(DEBTOR_AMOUNT) - SUM(CRDIT_AMOUNT) ,0)
		            FROM TBACC_ACCNUT_STACNT
		            WHERE ACCNUT_YEAR = SUBSTR(#SEARCH_DE# ,1 ,4)
		            AND ACCNUT_MT BETWEEN '00' AND SUBSTR(#SEARCH_DE# ,5 ,2)
		            AND SUBSTR(ACCNUT_ACNT_CODE ,1 ,1) IN ('1' ,'2' ,'3')
		          )
		      END AS CR_AMT
		    FROM TBACC_ACCNUT_STACNTSUM
		    WHERE ACCNUT_YEAR = SUBSTR(#SEARCH_DE# ,1 ,4)
		    AND ACCNUT_MT BETWEEN '00'
		      /*이월*/
		    AND SUBSTR(#SEARCH_DE# ,5 ,2)
		      /*결산월*/
		    GROUP BY ACCNUT_YEAR ,
		      ACCNUT_ACNT_CODE
		    UNION ALL
		    SELECT ACCNUT_YEAR ,
		      CASE
		        WHEN ACCNUT_ACNT_CODE = '10000000'
		          /*자산*/
		        THEN '13030990'
		          /*자산총계*/
		        WHEN ACCNUT_ACNT_CODE = '20000000'
		          /*부채*/
		        THEN '22070990'
		          /*부채총계*/
		        WHEN ACCNUT_ACNT_CODE = '30000000'
		          /*자본*/
		        THEN '32070990'
		          /*자본총계*/
		        ELSE ACCNUT_ACNT_CODE
		      END                        AS ACCNUT_ACNT_CODE ,
		      NVL(SUM(DEBTOR_AMOUNT) ,0) AS DR_AMT           ,
		      CASE
		        WHEN ACCNUT_ACNT_CODE NOT IN ('34003000')
		        THEN NVL(SUM(CRDIT_AMOUNT ) ,0)
		        ELSE NVL(SUM(CRDIT_AMOUNT ) ,0) +
		          (
		            SELECT NVL(SUM(DEBTOR_AMOUNT) - SUM(CRDIT_AMOUNT) ,0)
		            FROM TBACC_ACCNUT_STACNT
		            WHERE ACCNUT_YEAR = SUBSTR(#SEARCH_DE# ,1 ,4)
		            AND ACCNUT_MT BETWEEN '00' AND SUBSTR(#SEARCH_DE# ,5 ,2)
		            AND SUBSTR(ACCNUT_ACNT_CODE ,1 ,1) IN ('1' ,'2' ,'3')
		          )
		      END AS CR_AMT
		    FROM TBACC_ACCNUT_STACNT
		    WHERE ACCNUT_YEAR = SUBSTR(#SEARCH_DE# ,1 ,4)
		    AND ACCNUT_MT BETWEEN '00'
		      /*이월*/
		    AND SUBSTR(#SEARCH_DE# ,5 ,2)
		      /*결산월*/
		    GROUP BY ACCNUT_YEAR ,
		      ACCNUT_ACNT_CODE
		  )
		  ,
		  FIN_DEBT_T AS
		  (
		    /* 단기차입금 */
		    SELECT '21020010' AS ACCNUT_ACNT_CODE
		         , SUM(NVL(A.BRRW_AMOUNT ,0) - NVL(
		          (
		            SELECT SUM(AA.RPAY_AMOUNT)
		            FROM   TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
		            WHERE   AA.PBNCD_NO = A.PBNCD_NO
		          ) ,0)) AS BRRW_BALANCE
		    FROM   TBFUN_PBNCD A
		    LEFT OUTER JOIN
		    (
		      SELECT CODE
		           , DETAIL_CODE
		           , DETAIL_CODE_NM
		        FROM TBFUN_CPTAL_DETAIL_CODE
		       WHERE CODE_SE = '000'
		    ) B
		    ON A.CPTAL_KND = B.DETAIL_CODE
		    WHERE B.CODE = 'B' /* 단기채 */
		    
		    UNION ALL
		    
		    /* 유동성장기차입금 */
		    SELECT '21020020' AS ACCNUT_ACNT_CODE
		          , SUM(NVL((
		            SELECT SUM(AA.RPAY_AMOUNT)
		            FROM   TBFUN_PBNCD_PRNCPAL_RPAY_PLAN AA
		            WHERE  AA.PBNCD_NO = A.PBNCD_NO
		            AND    AA.RPAY_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(#SEARCH_DE#), -12) + 1, 'YYYYMMDD') AND #SEARCH_DE#
		          ) ,0)) AS RPAY_PLAN_SM
		    FROM   TBFUN_PBNCD A
		    LEFT OUTER JOIN
		    (
		      SELECT CODE
		           , DETAIL_CODE
		           , DETAIL_CODE_NM
		        FROM TBFUN_CPTAL_DETAIL_CODE
		       WHERE CODE_SE = '000'
		    ) B
		    ON A.CPTAL_KND = B.DETAIL_CODE
		    WHERE B.CODE = 'A' /* 장기채 */
		    AND   A.CPTAL_KND IN ('A01', 'A05', 'A07') /* 금융기관차입, 지역개발기금, 에너지합리화자금 */
		    
		    UNION ALL
		    
		    /* 유동성사채 */
		    SELECT '21020040' AS ACCNUT_ACNT_CODE
		          , SUM(NVL((
		            SELECT SUM(AA.RPAY_AMOUNT)
		            FROM   TBFUN_PBNCD_PRNCPAL_RPAY_PLAN AA
		            WHERE  AA.PBNCD_NO = A.PBNCD_NO
		            AND    AA.RPAY_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(#SEARCH_DE#), -12) + 1, 'YYYYMMDD') AND #SEARCH_DE#
		          ) ,0)) AS RPAY_PLAN_SM
		    FROM   TBFUN_PBNCD A
		    LEFT OUTER JOIN
		    (
		      SELECT CODE
		           , DETAIL_CODE
		           , DETAIL_CODE_NM
		        FROM TBFUN_CPTAL_DETAIL_CODE
		       WHERE CODE_SE = '000'
		    ) B
		    ON A.CPTAL_KND = B.DETAIL_CODE
		    WHERE B.CODE = 'A' /* 장기채 */
		    AND   A.CPTAL_KND IN ('A03', 'A04') /* 공모채권, 사모채권 */
		    
		    UNION ALL
		    
		    /* 유동성국민주택기금차입금 */
		    SELECT '21020050' AS ACCNUT_ACNT_CODE
		          , SUM(NVL((
		            SELECT SUM(AA.RPAY_AMOUNT)
		            FROM   TBFUN_PBNCD_PRNCPAL_RPAY_PLAN AA
		            WHERE  AA.PBNCD_NO = A.PBNCD_NO
		            AND    AA.RPAY_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(#SEARCH_DE#), -12) + 1, 'YYYYMMDD') AND #SEARCH_DE#
		            AND    SUBSTR(AA.RPAY_DE, 0, 6) > A.LEASE_YM
		          ) ,0)) AS RPAY_PLAN_SM
		    FROM   TBFUN_PBNCD A
		    LEFT OUTER JOIN
		    (
		      SELECT CODE
		           , DETAIL_CODE
		           , DETAIL_CODE_NM
		        FROM TBFUN_CPTAL_DETAIL_CODE
		       WHERE CODE_SE = '000'
		    ) B
		    ON A.CPTAL_KND = B.DETAIL_CODE
		    WHERE B.CODE = 'A' /* 장기채 */
		    AND   A.CPTAL_KND IN ('A02') /* 주택도시기금 */
		    AND   (A.LEASE_YM IS NULL OR A.LEASE_YM >= SUBSTR(#SEARCH_DE#, 0, 6))
		    
		    UNION ALL
		    
		    /* 유동성보상채권차입금 */
		    SELECT '21020060' AS ACCNUT_ACNT_CODE
		          , SUM(NVL((
		            SELECT SUM(AA.RPAY_AMOUNT)
		            FROM   TBFUN_PBNCD_PRNCPAL_RPAY_PLAN AA
		            WHERE  AA.PBNCD_NO = A.PBNCD_NO
		            AND    AA.RPAY_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(#SEARCH_DE#), -12) + 1, 'YYYYMMDD') AND #SEARCH_DE#
		          ) ,0)) AS RPAY_PLAN_SM
		    FROM   TBFUN_PBNCD A
		    LEFT OUTER JOIN
		    (
		      SELECT CODE
		           , DETAIL_CODE
		           , DETAIL_CODE_NM
		        FROM TBFUN_CPTAL_DETAIL_CODE
		       WHERE CODE_SE = '000'
		    ) B
		    ON A.CPTAL_KND = B.DETAIL_CODE
		    WHERE B.CODE = 'A' /* 장기채 */
		    AND   A.CPTAL_KND IN ('A06') /* 용지보상채권 */
		  )  
		  ,
		  FIN_DEBT_T2 AS
		  (
		    /* 사채 */
		    SELECT '22020010' AS ACCNUT_ACNT_CODE
		          , SUM(NVL(A.BRRW_AMOUNT ,0) - NVL(
		          (
		            SELECT SUM(AA.RPAY_AMOUNT)
		            FROM   TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
		            WHERE   AA.PBNCD_NO = A.PBNCD_NO
		          ) ,0))AS BRRW_BALANCE
		    FROM   TBFUN_PBNCD A
		    LEFT OUTER JOIN
		    (
		      SELECT CODE
		           , DETAIL_CODE
		           , DETAIL_CODE_NM
		        FROM TBFUN_CPTAL_DETAIL_CODE
		       WHERE CODE_SE = '000'
		    ) B
		    ON A.CPTAL_KND = B.DETAIL_CODE
		    WHERE B.CODE = 'A' /* 장기채 */
		    AND   A.CPTAL_KND IN ('A03', 'A04') /* 공모채권, 사모채권 */
		    
		    UNION ALL
		    
		    /* 장기차입금 */
		    SELECT '22020020' AS ACCNUT_ACNT_CODE
		          , SUM(NVL(A.BRRW_AMOUNT ,0) - NVL(
		          (
		            SELECT SUM(AA.RPAY_AMOUNT)
		            FROM   TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
		            WHERE   AA.PBNCD_NO = A.PBNCD_NO
		          ) ,0)) AS BRRW_BALANCE
		    FROM   TBFUN_PBNCD A
		    LEFT OUTER JOIN
		    (
		      SELECT CODE
		           , DETAIL_CODE
		           , DETAIL_CODE_NM
		        FROM TBFUN_CPTAL_DETAIL_CODE
		       WHERE CODE_SE = '000'
		    ) B
		    ON A.CPTAL_KND = B.DETAIL_CODE
		    WHERE B.CODE = 'A' /* 장기채 */
		    AND   A.CPTAL_KND IN ('A01', 'A05', 'A07') /* 금융기관차입, 지역개발기금, 에너지합리화자금 */
		    
		    UNION ALL
		    
		    /* 국민주택기금차입금 */
		    SELECT '22020040' AS ACCNUT_ACNT_CODE
		          , SUM(NVL(A.BRRW_AMOUNT ,0) - NVL(
		          (
		            SELECT SUM(AA.RPAY_AMOUNT)
		            FROM   TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
		            WHERE  AA.PBNCD_NO = A.PBNCD_NO
		            AND    SUBSTR(AA.RPAY_DE, 0, 6) > A.LEASE_YM
		          ) ,0)) AS BRRW_BALANCE          
		    FROM   TBFUN_PBNCD A
		    LEFT OUTER JOIN
		    (
		      SELECT CODE
		           , DETAIL_CODE
		           , DETAIL_CODE_NM
		        FROM TBFUN_CPTAL_DETAIL_CODE
		       WHERE CODE_SE = '000'
		    ) B
		    ON A.CPTAL_KND = B.DETAIL_CODE
		    WHERE B.CODE = 'A' /* 장기채 */
		    AND   A.CPTAL_KND IN ('A02') /* 주택도시기금 */
		    AND   (A.LEASE_YM IS NULL OR A.LEASE_YM >= SUBSTR(#SEARCH_DE#, 0, 6))
		    
		    UNION ALL
		    
		    /* 장기보상채권차입금 */
		    SELECT '22020050' AS ACCNUT_ACNT_CODE
		          , SUM(NVL(A.BRRW_AMOUNT ,0) - NVL(
		          (
		            SELECT SUM(AA.RPAY_AMOUNT)
		            FROM   TBFUN_PBNCD_PRNCPAL_RPAY_DTLS AA
		            WHERE  AA.PBNCD_NO = A.PBNCD_NO
		            AND    SUBSTR(AA.RPAY_DE, 0, 6) > A.LEASE_YM
		          ) ,0)) AS BRRW_BALANCE     
		    FROM   TBFUN_PBNCD A
		    LEFT OUTER JOIN
		    (
		      SELECT CODE
		           , DETAIL_CODE
		           , DETAIL_CODE_NM
		        FROM TBFUN_CPTAL_DETAIL_CODE
		       WHERE CODE_SE = '000'
		    ) B
		    ON A.CPTAL_KND = B.DETAIL_CODE
		    WHERE B.CODE = 'A' /* 장기채 */
		    AND   A.CPTAL_KND IN ('A06') /* 용지보상채권 */
		  )    
		SELECT TRUNC(SUM(DECODE(AA.ACCNUT_ACNT_CODE, '22070990', AA.THSTRM_SM)) / #SEARCH_GBN#) AS THSTRM_SM1 /* 부채총계 */
		     , TRUNC(SUM(DECODE(AA.ACCNUT_ACNT_CODE, '21000000', AA.THSTRM_SM)) / #SEARCH_GBN#) AS THSTRM_SM2 /* 유동부채 */
		     , TRUNC(SUM(DECODE(AA.ACCNUT_ACNT_CODE, '22000000', AA.THSTRM_SM)) / #SEARCH_GBN#) AS THSTRM_SM3 /* 비유동부채 */
		     , TRUNC(SUM(DECODE(AA.ACCNUT_ACNT_CODE, '22070990', AA.FIN_DEBT_SM)) / #SEARCH_GBN#) AS THSTRM_SM4 /* 금융부채총계 */
		     , TRUNC(SUM(DECODE(AA.ACCNUT_ACNT_CODE, '32070990', AA.THSTRM_SM)) / #SEARCH_GBN#) AS THSTRM_SM5 /* 자본총계 */
		     , TO_CHAR((SUM(DECODE(AA.ACCNUT_ACNT_CODE, '22070990', AA.THSTRM_SM)) / SUM(DECODE(AA.ACCNUT_ACNT_CODE, '32070990', AA.THSTRM_SM))) * 100, 'FM9990D00') AS  DEBT_RATIO_1 /* 부채비율 */
		     , TO_CHAR((SUM(DECODE(AA.ACCNUT_ACNT_CODE, '21000000', AA.THSTRM_SM)) / SUM(DECODE(AA.ACCNUT_ACNT_CODE, '32070990', AA.THSTRM_SM))) * 100, 'FM9990D00') AS  DEBT_RATIO_2 /* 유동부채비율 */
		     , TO_CHAR((SUM(DECODE(AA.ACCNUT_ACNT_CODE, '22000000', AA.THSTRM_SM)) / SUM(DECODE(AA.ACCNUT_ACNT_CODE, '32070990', AA.THSTRM_SM))) * 100, 'FM9990D00') AS  DEBT_RATIO_3 /* 비유동부채비율 */
		     , TO_CHAR((SUM(DECODE(AA.ACCNUT_ACNT_CODE, '22070990', AA.FIN_DEBT_SM)) / SUM(DECODE(AA.ACCNUT_ACNT_CODE, '32070990', AA.THSTRM_SM))) * 100, 'FM9990D00') AS  DEBT_RATIO_4 /* 금융부채비율 */
		FROM 
		(
		      SELECT AAA.ACCNUT_ACNT_CODE
		           , AAA.ACCNUT_ACNT_NM
		           , AAA.THSTRM_AMOUNT
		           , AAA.THSTRM_SM
		           , AAA.FIN_DEBT_AMOUNT
		           , AAA.FIN_DEBT_SM
		           , CASE WHEN ACCNUT_ACNT_CODE LIKE '2%' THEN AAA.THSTRM_AMOUNT - AAA.FIN_DEBT_AMOUNT ELSE 0 END AS OPR_DEBT_AMOUNT
		           , CASE WHEN ACCNUT_ACNT_CODE LIKE '2%' THEN AAA.THSTRM_SM - AAA.FIN_DEBT_SM ELSE 0 END AS OPR_DEBT_SM
		      FROM (     
		            SELECT t1.ACCNUT_ACNT_CODE                                        ,
		              MAX(NVL(t1.OUTPT_ACNT_NM ,t1.ACCNUT_ACNT_NM)) AS ACCNUT_ACNT_NM ,
		              (
		              CASE
		                WHEN T1.ACNT_LEVEL >= 3
		                THEN NVL(SUM(
		                  CASE
		                    WHEN t1.DBRT_SE                  = 'D'
		                    AND NVL(t1.RSYMNEY_ACNT_AT ,'0') = '0'
		                    THEN t2.DR_AMT - t2.CR_AMT
		                    WHEN t1.DBRT_SE                  = 'D'
		                    AND NVL(t1.RSYMNEY_ACNT_AT ,'0') = '1'
		                    THEN t2.CR_AMT - t2.DR_AMT
		                    WHEN t1.DBRT_SE                  = 'C'
		                    AND NVL(t1.RSYMNEY_ACNT_AT ,'0') = '0'
		                    THEN t2.CR_AMT - t2.DR_AMT
		                    WHEN t1.DBRT_SE                  = 'C'
		                    AND NVL(t1.RSYMNEY_ACNT_AT ,'0') = '1'
		                    THEN t2.DR_AMT - t2.CR_AMT
		                    ELSE 0
		                  END) ,0)
		                ELSE 0
		              END) AS THSTRM_AMOUNT ,
		              (
		              CASE
		                WHEN T1.ACNT_LEVEL < 3
		                THEN NVL(SUM(
		                  CASE
		                    WHEN t1.DBRT_SE                  = 'D'
		                    AND NVL(t1.RSYMNEY_ACNT_AT ,'0') = '0'
		                    THEN t2.DR_AMT - t2.CR_AMT
		                    WHEN t1.DBRT_SE                  = 'D'
		                    AND NVL(t1.RSYMNEY_ACNT_AT ,'0') = '1'
		                    THEN t2.CR_AMT - t2.DR_AMT
		                    WHEN t1.DBRT_SE                  = 'C'
		                    AND NVL(t1.RSYMNEY_ACNT_AT ,'0') = '0'
		                    THEN t2.CR_AMT - t2.DR_AMT
		                    WHEN t1.DBRT_SE                  = 'C'
		                    AND NVL(t1.RSYMNEY_ACNT_AT ,'0') = '1'
		                    THEN t2.DR_AMT - t2.CR_AMT
		                    ELSE 0
		                  END) ,0)
		                ELSE 0
		              END) AS THSTRM_SM,
		              (
		              CASE
		                WHEN T1.ACNT_LEVEL >= 3 AND T1.ACCNUT_ACNT_CODE = '21020000'
		                THEN NVL((SELECT SUM(AA.BRRW_BALANCE) FROM FIN_DEBT_T AA), 0)
		                WHEN T1.ACNT_LEVEL >= 3 AND T1.ACCNUT_ACNT_CODE = '22020000'
		                THEN NVL((SELECT SUM(AA.BRRW_BALANCE) FROM FIN_DEBT_T2 AA), 0)
		                   - NVL((SELECT SUM(AA.BRRW_BALANCE) FROM FIN_DEBT_T AA WHERE AA.ACCNUT_ACNT_CODE != '21020010'), 0)    
		                WHEN T1.ACNT_LEVEL >= 3 AND T1.ACCNUT_ACNT_CODE = '22020010'
		                THEN NVL(SUM(T4.BRRW_BALANCE), 0) - NVL((SELECT AA.BRRW_BALANCE FROM FIN_DEBT_T AA WHERE AA.ACCNUT_ACNT_CODE = '21020040'), 0) 
		                WHEN T1.ACNT_LEVEL >= 3 AND T1.ACCNUT_ACNT_CODE = '22020020'
		                THEN NVL(SUM(T4.BRRW_BALANCE), 0) - NVL((SELECT AA.BRRW_BALANCE FROM FIN_DEBT_T AA WHERE AA.ACCNUT_ACNT_CODE = '21020020') , 0)
		                WHEN T1.ACNT_LEVEL >= 3 AND T1.ACCNUT_ACNT_CODE = '22020040'
		                THEN NVL(SUM(T4.BRRW_BALANCE), 0) - NVL((SELECT AA.BRRW_BALANCE FROM FIN_DEBT_T AA WHERE AA.ACCNUT_ACNT_CODE = '21020050') , 0)
		                WHEN T1.ACNT_LEVEL >= 3 AND T1.ACCNUT_ACNT_CODE = '22020050'
		                THEN NVL(SUM(T4.BRRW_BALANCE), 0) - NVL((SELECT AA.BRRW_BALANCE FROM FIN_DEBT_T AA WHERE AA.ACCNUT_ACNT_CODE = '21020060') , 0)      
		                WHEN T1.ACNT_LEVEL >= 3
		                THEN NVL(SUM(T3.BRRW_BALANCE), 0)
		                ELSE 0
		              END) AS FIN_DEBT_AMOUNT,
		              (
		              CASE
		                WHEN T1.ACCNUT_ACNT_CODE = '21000000'
		                THEN NVL((SELECT SUM(AA.BRRW_BALANCE) FROM FIN_DEBT_T AA), 0)
		                WHEN T1.ACCNUT_ACNT_CODE = '22000000'
		                THEN NVL((SELECT SUM(AA.BRRW_BALANCE) FROM FIN_DEBT_T2 AA), 0) - NVL((SELECT SUM(AA.BRRW_BALANCE) FROM FIN_DEBT_T AA WHERE AA.ACCNUT_ACNT_CODE != '21020010'), 0)
		                WHEN T1.ACCNUT_ACNT_CODE = '22070990'
		                THEN NVL((SELECT SUM(AA.BRRW_BALANCE) FROM FIN_DEBT_T AA), 0)
		                   + (NVL((SELECT SUM(AA.BRRW_BALANCE) FROM FIN_DEBT_T2 AA), 0) - NVL((SELECT SUM(AA.BRRW_BALANCE) FROM FIN_DEBT_T AA WHERE AA.ACCNUT_ACNT_CODE != '21020010'), 0))
		                ELSE 0
		              END) AS FIN_DEBT_SM
		            FROM TBACC_ACCNUT_ACNT_SBJECT t1
		            LEFT OUTER JOIN THIS_STACNT_T t2
		            ON t1.ACCNUT_YEAR       = t2.ACCNUT_YEAR
		            AND t1.ACCNUT_ACNT_CODE = t2.ACCNUT_ACNT_CODE
		            LEFT OUTER JOIN FIN_DEBT_T t3
		            ON t1.ACCNUT_ACNT_CODE = t3.ACCNUT_ACNT_CODE
		            LEFT OUTER JOIN FIN_DEBT_T2 t4
		            ON t1.ACCNUT_ACNT_CODE = t4.ACCNUT_ACNT_CODE
		            WHERE t1.ACCNUT_YEAR         = SUBSTR(#SEARCH_DE# ,1 ,4)
		            AND t1.ACCNUT_ACNT_CODE NOT IN ('32080999')
		            AND t1.ACNT_SE               = '1'  /*재무상태표*/
		            AND t1.OUTPT_AT = '1'  /*출력여부*/
		            AND (t1.ACCNUT_ACNT_CODE LIKE '2%' OR t1.ACCNUT_ACNT_CODE LIKE '3%')
		            GROUP BY t1.ACCNUT_YEAR ,
		              t1.ACNT_LEVEL         ,
		              t1.ACCNUT_ACNT_CODE   ,
		              t1.RSYMNEY_ACNT_AT
		            UNION ALL
		            SELECT '32080999'                                                                                                AS ACCNUT_ACNT_CODE ,
		              '[자본과부채총계]'                                                                                                    AS ACCNUT_ACNT_NM   ,
		              0                                                                                                              AS THSTRM_AMOUNT    ,
		              NVL(SUM(DECODE(t1.DBRT_SE ,'D' ,t2.DR_AMT - t2.CR_AMT ,'C' ,t2.CR_AMT - t2.DR_AMT ,t2.DR_AMT - t2.CR_AMT)) ,0) AS THSTRM_SM
		              , 0
		              , 0
		            FROM TBACC_ACCNUT_ACNT_SBJECT t1
		            LEFT OUTER JOIN THIS_STACNT_T t2
		            ON t1.ACCNUT_YEAR       = t2.ACCNUT_YEAR
		            AND t1.ACCNUT_ACNT_CODE = t2.ACCNUT_ACNT_CODE
		            WHERE t1.ACCNUT_YEAR   = SUBSTR(#SEARCH_DE# ,1 ,4)
		            AND t1.ACNT_SE         = '1'
		              /*재무상태표*/
		            AND t1.OUTPT_AT = '1'
		              /*출력여부*/
		            AND t1.ACCNUT_ACNT_CODE IN ('22070990' ,'32070990')
		            GROUP BY t1.ACCNUT_YEAR ,
		              t1.RSYMNEY_ACNT_AT        
		            ORDER BY ACCNUT_ACNT_CODE NULLS FIRST
		      ) AAA      
		) AA
		]]>
	</select>
</sqlMap>