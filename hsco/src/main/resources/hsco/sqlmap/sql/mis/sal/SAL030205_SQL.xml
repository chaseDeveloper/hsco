<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="SAL030205_SQL">	
	
	<!-- 월급노동통계조사표정보 목록조회 -->
	<select id="SAL030205DAO.selectPymntTotList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[
			  SELECT PYMNT_DDC_CODE_NM
			       , PYMNT_DDC_CODE
			       , TOT
			       , TOT2
			       , TOT3
			    FROM (
			                    SELECT PYMNT_DDC_CODE_NM
			                         , PYMNT_DDC_CODE
			                         , NVL(SUM(TOT), 0)  AS TOT
			                         , NVL(SUM(TOT2), 0) AS TOT2
			                         , NVL(SUM(TOT3), 0) AS TOT3
			                      FROM (
			                                      SELECT B.PYMNT_DDC_CODE_NM
			                                           , B.PYMNT_DDC_CODE
			                                           , NVL(SUM(
			                                             CASE C.SEXDSTN
			                                                      WHEN '1'
			                                                      THEN A.PYMNT_AMOUNT
			                                             END), 0) AS TOT
			                                           , NVL(SUM(
			                                             CASE C.SEXDSTN
			                                                      WHEN '2'
			                                                      THEN A.PYMNT_AMOUNT
			                                             END), 0)                    AS TOT2
			                                           , NVL(SUM(A.PYMNT_AMOUNT), 0) AS TOT3
			                                        FROM TBSAL_MT_PYMNT_DTLS A
			                                           , TBSAL_PYMNT_DDC_STDR_CODE B
			                                           , TBHRM_HR_MASTR C
			                                       WHERE A.EMPNO           	= C.EMPNO
			                                         AND A.PYMNT_DDC_CODE   = B.PYMNT_DDC_CODE
			                                         AND A.PYMNT_YM     	= #PYMNT_YM#
			                                         AND A.CLOS_AT IS NOT NULL
			                                    GROUP BY B.PYMNT_DDC_CODE
			                                           , B.PYMNT_DDC_CODE_NM
			                                    
			                                    UNION ALL
			                                      
			                                      SELECT B.PYMNT_DDC_CODE_NM
			                                           , B.PYMNT_DDC_CODE
			                                           , NVL(SUM(
			                                             CASE C.SEXDSTN
			                                                      WHEN '1'
			                                                      THEN A.SLARY
			                                             END), 0) AS TOT
			                                           , NVL(SUM(
			                                             CASE C.SEXDSTN
			                                                      WHEN '2'
			                                                      THEN A.SLARY
			                                             END), 0)             AS TOT2
			                                           , NVL(SUM(A.SLARY), 0) AS TOT3
			                                        FROM TBSAL_PD_WORK_SALARY A
			                                           , TBSAL_PYMNT_DDC_STDR_CODE B
			                                           , TBHRM_HR_MASTR C
			                                       WHERE A.EMPNO          	= C.EMPNO
			                                         AND B.PYMNT_DDC_CODE 	= 'P1010'		/* 봉급 */
			                                         AND A.PYMNT_YM   		= #PYMNT_YM#
			                                         AND A.CLOS_AT IS NOT NULL
			                                    GROUP BY B.PYMNT_DDC_CODE
			                                           , B.PYMNT_DDC_CODE_NM
			                                    
			                                    UNION ALL
			                                      
			                                      SELECT B.PYMNT_DDC_CODE_NM
			                                           , B.PYMNT_DDC_CODE
			                                           , NVL(SUM(
			                                             CASE C.SEXDSTN
			                                                      WHEN '1'
			                                                      THEN A.BONUS
			                                             END), 0) AS TOT
			                                           , NVL(SUM(
			                                             CASE C.SEXDSTN
			                                                      WHEN '2'
			                                                      THEN A.BONUS
			                                             END), 0)             AS TOT2
			                                           , NVL(SUM(A.BONUS), 0) AS TOT3
			                                        FROM TBSAL_PD_WORK_SALARY A
			                                           , TBSAL_PYMNT_DDC_STDR_CODE B
			                                           , TBHRM_HR_MASTR C
			                                       WHERE A.EMPNO          	= C.EMPNO
			                                         AND B.PYMNT_DDC_CODE 	= 'P1020'	/* 상여금 */
			                                         AND A.PYMNT_YM       	= #PYMNT_YM#
			                                         AND A.CLOS_AT IS NOT NULL
			                                    GROUP BY B.PYMNT_DDC_CODE
			                                           , B.PYMNT_DDC_CODE_NM
			                                    
			                                    UNION ALL
			                                      
			                                      SELECT B.PYMNT_DDC_CODE_NM
			                                           , B.PYMNT_DDC_CODE
			                                           , NVL(SUM(
			                                             CASE C.SEXDSTN
			                                                      WHEN '1'
			                                                      THEN A.REST_ALLWNC
			                                             END), 0) AS TOT
			                                           , NVL(SUM(
			                                             CASE C.SEXDSTN
			                                                      WHEN '2'
			                                                      THEN A.REST_ALLWNC
			                                             END), 0)                   AS TOT2
			                                           , NVL(SUM(A.REST_ALLWNC), 0) AS TOT3
			                                        FROM TBSAL_PD_WORK_SALARY A
			                                           , TBSAL_PYMNT_DDC_STDR_CODE B
			                                           , TBHRM_HR_MASTR C
			                                       WHERE A.EMPNO          	= C.EMPNO
			                                         AND B.PYMNT_DDC_CODE 	= 'P1999'	/* 주휴수당 */
			                                         AND A.PYMNT_YM     	= #PYMNT_YM#
			                                         AND A.CLOS_AT IS NOT NULL
			                                    GROUP BY B.PYMNT_DDC_CODE
			                                           , B.PYMNT_DDC_CODE_NM
			                                    
			                                    UNION ALL
			                                      
			                                      SELECT B.PYMNT_DDC_CODE_NM
			                                           , B.PYMNT_DDC_CODE
			                                           , NVL(SUM(
			                                             CASE C.SEXDSTN
			                                                      WHEN '1'
			                                                      THEN A.MLSV_SBSIDY
			                                             END), 0) AS TOT
			                                           , NVL(SUM(
			                                             CASE C.SEXDSTN
			                                                      WHEN '2'
			                                                      THEN A.MLSV_SBSIDY
			                                             END), 0)                   AS TOT2
			                                           , NVL(SUM(A.MLSV_SBSIDY), 0) AS TOT3
			                                        FROM TBSAL_PD_WORK_SALARY A
			                                           , TBSAL_PYMNT_DDC_STDR_CODE B
			                                           , TBHRM_HR_MASTR C
			                                       WHERE A.EMPNO          	= C.EMPNO
			                                         AND B.PYMNT_DDC_CODE 	= 'P1940'	/* 급식보조비 */
			                                         AND A.PYMNT_YM       	= #PYMNT_YM#
			                                         AND A.CLOS_AT IS NOT NULL
			                                    GROUP BY B.PYMNT_DDC_CODE
			                                           , B.PYMNT_DDC_CODE_NM
			                                    
			                                    UNION ALL
			                                      
			                                      SELECT B.PYMNT_DDC_CODE_NM
			                                           , B.PYMNT_DDC_CODE
			                                           , NVL(SUM(
			                                             CASE C.SEXDSTN
			                                                      WHEN '1'
			                                                      THEN A.FAMILY_ALLWNC
			                                             END), 0) AS TOT
			                                           , NVL(SUM(
			                                             CASE C.SEXDSTN
			                                                      WHEN '2'
			                                                      THEN A.FAMILY_ALLWNC
			                                             END), 0)                     AS TOT2
			                                           , NVL(SUM(A.FAMILY_ALLWNC), 0) AS TOT3
			                                        FROM TBSAL_PD_WORK_SALARY A
			                                           , TBSAL_PYMNT_DDC_STDR_CODE B
			                                           , TBHRM_HR_MASTR C
			                                       WHERE A.EMPNO          	= C.EMPNO
			                                         AND B.PYMNT_DDC_CODE 	= 'P1080'	/* 가족수당 */
			                                         AND A.PYMNT_YM    		= #PYMNT_YM#
			                                         AND A.CLOS_AT IS NOT NULL
			                                    GROUP BY B.PYMNT_DDC_CODE
			                                           , B.PYMNT_DDC_CODE_NM
			                                    
			                                    UNION ALL
			                                      
			                                      SELECT B.PYMNT_DDC_CODE_NM
			                                           , B.PYMNT_DDC_CODE
			                                           , NVL(SUM(
			                                             CASE C.SEXDSTN
			                                                      WHEN '1'
			                                                      THEN A.TRNSPORT_SBSIDY
			                                             END), 0) AS TOT
			                                           , NVL(SUM(
			                                             CASE C.SEXDSTN
			                                                      WHEN '2'
			                                                      THEN A.TRNSPORT_SBSIDY
			                                             END), 0)                       AS TOT2
			                                           , NVL(SUM(A.TRNSPORT_SBSIDY), 0) AS TOT3
			                                        FROM TBSAL_PD_WORK_SALARY A
			                                           , TBSAL_PYMNT_DDC_STDR_CODE B
			                                           , TBHRM_HR_MASTR C
			                                       WHERE A.EMPNO          	= C.EMPNO
			                                         AND B.PYMNT_DDC_CODE 	= 'P1960'	/* 교통보조비 */
			                                         AND A.PYMNT_YM       	= #PYMNT_YM#
			                                         AND A.CLOS_AT IS NOT NULL
			                                    GROUP BY B.PYMNT_DDC_CODE
			                                           , B.PYMNT_DDC_CODE_NM
			                                    
			                                    UNION ALL
			                                      
			                                      SELECT B.PYMNT_DDC_CODE_NM
			                                           , B.PYMNT_DDC_CODE
			                                           , NVL(SUM(
			                                             CASE C.SEXDSTN
			                                                      WHEN '1'
			                                                      THEN A.SCHXPN_SBSIDY
			                                             END), 0) AS TOT
			                                           , NVL(SUM(
			                                             CASE C.SEXDSTN
			                                                      WHEN '2'
			                                                      THEN A.SCHXPN_SBSIDY
			                                             END), 0)                     AS TOT2
			                                           , NVL(SUM(A.SCHXPN_SBSIDY), 0) AS TOT3
			                                        FROM TBSAL_PD_WORK_SALARY A
			                                           , TBSAL_PYMNT_DDC_STDR_CODE B
			                                           , TBHRM_HR_MASTR C
			                                       WHERE A.EMPNO          	= C.EMPNO
			                                         AND B.PYMNT_DDC_CODE 	= 'P1140'	/* 학자금보조비 */
			                                         AND A.PYMNT_YM      	= #PYMNT_YM#
			                                         AND A.CLOS_AT IS NOT NULL
			                                    GROUP BY B.PYMNT_DDC_CODE
			                                           , B.PYMNT_DDC_CODE_NM
			                                    
			                                    UNION ALL
			                                      
			                                      SELECT B.PYMNT_DDC_CODE_NM
			                                           , B.PYMNT_DDC_CODE
			                                           , NVL(SUM(
			                                             CASE C.SEXDSTN
			                                                      WHEN '1'
			                                                      THEN A.YRYC_ALLWNC
			                                             END), 0) AS TOT
			                                           , NVL(SUM(
			                                             CASE C.SEXDSTN
			                                                      WHEN '2'
			                                                      THEN A.YRYC_ALLWNC
			                                             END), 0)                   AS TOT2
			                                           , NVL(SUM(A.YRYC_ALLWNC), 0) AS TOT3
			                                        FROM TBSAL_PD_WORK_SALARY A
			                                           , TBSAL_PYMNT_DDC_STDR_CODE B
			                                           , TBHRM_HR_MASTR C
			                                       WHERE A.EMPNO          	= C.EMPNO
			                                         AND B.PYMNT_DDC_CODE 	= 'P1110'	/* 연차수당 */
			                                         AND A.PYMNT_YM  		= #PYMNT_YM#
			                                         AND A.CLOS_AT IS NOT NULL
			                                    GROUP BY B.PYMNT_DDC_CODE
			                                           , B.PYMNT_DDC_CODE_NM
			                                    
			                                    UNION ALL
			                                    
			                                    SELECT '급여정산'  AS PYMNT_DDC_CODE_NM
			                                         , 'R0001' AS PYMNT_DDC_CODE
			                                         , NVL(SUM(
			                                           CASE C.SEXDSTN
			                                                  WHEN '1'
			                                                  THEN A.SALARY_EXCCLC
			                                           END), 0) AS TOT
			                                         , NVL(SUM(
			                                           CASE C.SEXDSTN
			                                                  WHEN '2'
			                                                  THEN A.SALARY_EXCCLC
			                                           END), 0)                     AS TOT2
			                                         , NVL(SUM(A.SALARY_EXCCLC), 0) AS TOT3
			                                      FROM TBSAL_PD_WORK_SALARY A
			                                         , TBHRM_HR_MASTR C
			                                     WHERE A.EMPNO             = C.EMPNO
			                                       AND A.PYMNT_YM          = #PYMNT_YM#
			                                       AND A.CLOS_AT IS NOT NULL
			                                    
			                                    UNION ALL
			                                    
			                                    SELECT '훈련비'   AS PYMNT_DDC_CODE_NM
			                                         , 'R0002' AS PYMNT_DDC_CODE
			                                         , NVL(SUM(
			                                           CASE C.SEXDSTN
			                                                  WHEN '1'
			                                                  THEN A.TRAINING_COST
			                                           END), 0) AS TOT
			                                         , NVL(SUM(
			                                           CASE C.SEXDSTN
			                                                  WHEN '2'
			                                                  THEN A.TRAINING_COST
			                                           END), 0)                     AS TOT2
			                                         , NVL(SUM(A.TRAINING_COST), 0) AS TOT3
			                                      FROM TBSAL_PD_WORK_SALARY A
			                                         , TBHRM_HR_MASTR C
			                                     WHERE A.EMPNO             = C.EMPNO
			                                       AND A.PYMNT_YM          = #PYMNT_YM#
			                                       AND A.CLOS_AT IS NOT NULL
			                           )
			                  GROUP BY PYMNT_DDC_CODE_NM
			                         , PYMNT_DDC_CODE
			                  
			                  UNION ALL
			                  
			                  SELECT '근로시간수'
			                       , 'Z0001'
			                       , NVL(SUM(
			                         CASE B.SEXDSTN
			                                WHEN '1'
			                                THEN (A.RL_WORK_DAYCNT * 8)
			                                ELSE 0
			                         END), 0) AS TOT
			                       , NVL(SUM(
			                         CASE B.SEXDSTN
			                                WHEN '2'
			                                THEN (A.RL_WORK_DAYCNT * 8)
			                                ELSE 0
			                         END), 0)                          AS TOT2
			                       , NVL(SUM(A.RL_WORK_DAYCNT * 8), 0) AS TOT3
			                    FROM TBHRM_MNBY_DCLZ_BSIS A
			                       , TBHRM_HR_MASTR B
			                   WHERE A.EMPNO   = B.EMPNO
			                     AND A.STDR_YM = #PYMNT_YM#
			                  
			                  UNION ALL
			                  
			                  SELECT '초과근무시간수'
			                       , 'Z0002'
			                       , NVL(
			                               (
			                               SELECT SUM(B.PYMNT_TIME)
			                                 FROM TBSAL_MT_SALARY_PYMNT A
			                                    , TBSAL_EXCESS_WORK_DTLS B
			                                    , TBHRM_HR_MASTR C
			                                WHERE A.EMPNO    = B.EMPNO
			                                  AND A.EMPNO    = C.EMPNO
			                                  AND C.SEXDSTN  = '1'
			                                  AND A.PYMNT_YM = #PYMNT_YM#
			                                  AND B.PYMNT_YM = TO_CHAR(TO_DATE(A.PYMNT_YM, 'YYYYMM') - 1, 'YYYYMM')
			                                  AND A.EMPL_SE IN ('000', '001', '002', '003', '004', '007')
			                                  AND A.CLOS_AT IS NOT NULL
			                               )
			                             , 0) AS TOT
			                       , NVL(
			                               (
			                               SELECT SUM(B.PYMNT_TIME)
			                                 FROM TBSAL_MT_SALARY_PYMNT A
			                                    , TBSAL_EXCESS_WORK_DTLS B
			                                    , TBHRM_HR_MASTR C
			                                WHERE A.EMPNO    = B.EMPNO
			                                  AND A.EMPNO    = C.EMPNO
			                                  AND C.SEXDSTN  = '2'
			                                  AND A.PYMNT_YM = #PYMNT_YM#
			                                  AND B.PYMNT_YM = TO_CHAR(TO_DATE(A.PYMNT_YM, 'YYYYMM') - 1, 'YYYYMM')
			                                  AND A.EMPL_SE IN ('000', '001', '002', '003', '004', '007')
			                                  AND A.CLOS_AT IS NOT NULL
			                               )
			                             , 0) AS TOT2
			                       , NVL(
			                               (
			                               SELECT SUM(B.PYMNT_TIME)
			                                 FROM TBSAL_MT_SALARY_PYMNT A
			                                    , TBSAL_EXCESS_WORK_DTLS B
			                                    , TBHRM_HR_MASTR C
			                                WHERE A.EMPNO = B.EMPNO
			                                  AND A.EMPNO = C.EMPNO
			                                  AND C.SEXDSTN IN ('1', '2')
			                                  AND A.PYMNT_YM = #PYMNT_YM#
			                                  AND B.PYMNT_YM = TO_CHAR(TO_DATE(A.PYMNT_YM, 'YYYYMM') - 1, 'YYYYMM')
			                                  AND A.EMPL_SE IN ('000', '001', '002', '003', '004', '007')
			                                  AND A.CLOS_AT IS NOT NULL
			                               )
			                             , 0) AS TOT3
			                    FROM DUAL
			                  
			                  UNION ALL
			                  
			                  SELECT '휴가일수'
			                       , 'Z0003'
			                       , NVL(
			                               (
			                               SELECT SUM(A.DCLZ_DAYCNT)
			                                 FROM TBHRM_MNBY_DCLZ_DTLS A
			                                    , TBHRM_HR_MASTR B
			                                WHERE A.EMPNO   = B.EMPNO
			                                  AND B.SEXDSTN = '1'
			                                  AND A.DCLZ_SE IN ('201', '204', '205', '208', '211', '212', '214', '215')	/* 연차,보건휴가,청원휴가,안식휴가,출산휴가,포상휴가,휴가,대체휴가 */
			                                  AND TO_CHAR(A.BGNDT, 'YYYYMM') = #PYMNT_YM#
			                                  AND TO_CHAR(A.ENDDT, 'YYYYMM') = #PYMNT_YM#
			                               )
			                             , 0) AS TOT
			                       , NVL(
			                               (
			                               SELECT SUM(A.DCLZ_DAYCNT)
			                                 FROM TBHRM_MNBY_DCLZ_DTLS A
			                                    , TBHRM_HR_MASTR B
			                                WHERE A.EMPNO   = B.EMPNO
			                                  AND B.SEXDSTN = '2'
			                                  AND A.DCLZ_SE IN ('201', '204', '205', '208', '211', '212', '214', '215')
			                                  AND TO_CHAR(A.BGNDT, 'YYYYMM') = #PYMNT_YM#
			                                  AND TO_CHAR(A.ENDDT, 'YYYYMM') = #PYMNT_YM#
			                               )
			                             , 0) AS TOT2
			                       , NVL(
			                               (
			                               SELECT SUM(A.DCLZ_DAYCNT)
			                                 FROM TBHRM_MNBY_DCLZ_DTLS A
			                                    , TBHRM_HR_MASTR B
			                                WHERE A.EMPNO = B.EMPNO
			                                  AND A.DCLZ_SE IN ('201', '204', '205', '208', '211', '212', '214', '215')
			                                  AND TO_CHAR(A.BGNDT, 'YYYYMM') = #PYMNT_YM#
			                                  AND TO_CHAR(A.ENDDT, 'YYYYMM') = #PYMNT_YM#
			                               )
			                             , 0) AS TOT3
			                    FROM DUAL
			                  
			                  UNION ALL
			                  
			                  SELECT '인원'
			                       , 'Z0004'
			                       , NVL(SUM(TOT), 0)  AS TOT
			                       , NVL(SUM(TOT2), 0) AS TOT2
			                       , NVL(SUM(TOT3), 0) AS TOT3
			                    FROM (
			                                SELECT NVL(SUM(
			                                       CASE B.SEXDSTN
			                                              WHEN '1'
			                                              THEN 1
			                                              ELSE 0
			                                       END), 0) AS TOT
			                                     , NVL(SUM(
			                                       CASE B.SEXDSTN
			                                              WHEN '2'
			                                              THEN 1
			                                              ELSE 0
			                                       END), 0)   AS TOT2
			                                     , COUNT( * ) AS TOT3
			                                  FROM TBSAL_MT_SALARY_PYMNT A
			                                     , TBHRM_HR_MASTR B
			                                 WHERE A.EMPNO    = B.EMPNO
			                                   AND A.PYMNT_YM = #PYMNT_YM#
			                                
			                                UNION ALL
			                                
			                                SELECT NVL(SUM(
			                                       CASE B.SEXDSTN
			                                              WHEN '1'
			                                              THEN 1
			                                              ELSE 0
			                                       END), 0) AS TOT
			                                     , NVL(SUM(
			                                       CASE B.SEXDSTN
			                                              WHEN '2'
			                                              THEN 1
			                                              ELSE 0
			                                       END), 0)   AS TOT2
			                                     , COUNT( * ) AS TOT3
			                                  FROM TBSAL_PD_WORK_SALARY A
			                                     , TBHRM_HR_MASTR B
			                                 WHERE A.EMPNO    = B.EMPNO
			                                   AND A.PYMNT_YM = #PYMNT_YM#
			                         )
			                  
			                  UNION ALL
			                  
			                  SELECT '정액급여'
			                       , 'Z9991'
			                       , NVL(
			                               (
			                               SELECT SUM(PYMNT_AMOUNT)
			                                 FROM (
			                                             SELECT SUM(A.PYMNT_AMOUNT) AS PYMNT_AMOUNT
			                                               FROM TBSAL_MT_PYMNT_DTLS A
			                                                  , TBHRM_HR_MASTR B
			                                                  , TBSAL_MT_SALARY_PYMNT C
			                                              WHERE A.EMPNO           = B.EMPNO
			                                                AND A.PYMNT_YM        = C.PYMNT_YM
			                                                AND A.SALARY_SE       = C.SALARY_SE
			                                                AND A.PYMNT_DE        = C.PYMNT_DE
			                                                AND A.EMPNO           = C.EMPNO
			                                                AND A.PYMNT_YM        = #PYMNT_YM#
			                                                AND B.SEXDSTN         = '1'
			                                                AND A.PYMNT_DDC_CODE <> 'P1020'
			                                                AND C.EMPL_SE IN ('000', '001', '002', '003', '004', '007')
			                                                AND A.CLOS_AT IS NOT NULL
			                                             
			                                             UNION ALL
			                                             
			                                             SELECT (SUM(A.SLARY) + SUM(A.REST_ALLWNC) + SUM(A.YRYC_ALLWNC) + SUM(A.SALARY_EXCCLC) + SUM(A.MLSV_SBSIDY) + SUM(A.TRNSPORT_SBSIDY) + SUM(A.FAMILY_ALLWNC) + SUM(A.SCHXPN_SBSIDY) + SUM( A.TRAINING_COST)) AS PYMNT_AMOUNT
			                                               FROM TBSAL_PD_WORK_SALARY A
			                                                  , TBHRM_HR_MASTR B
			                                              WHERE A.EMPNO             = B.EMPNO
			                                                AND A.PYMNT_YM          = #PYMNT_YM#
			                                                AND B.SEXDSTN           = '1'
			                                                AND A.CLOS_AT IS NOT NULL
			                                      )
			                               )
			                             , 0) AS TOT
			                       , NVL(
			                               (
			                               SELECT SUM(PYMNT_AMOUNT)
			                                 FROM (
			                                             SELECT SUM(A.PYMNT_AMOUNT) AS PYMNT_AMOUNT
			                                               FROM TBSAL_MT_PYMNT_DTLS A
			                                                  , TBHRM_HR_MASTR B
			                                                  , TBSAL_MT_SALARY_PYMNT C
			                                              WHERE A.EMPNO           = B.EMPNO
			                                                AND A.PYMNT_YM        = C.PYMNT_YM
			                                                AND A.SALARY_SE       = C.SALARY_SE
			                                                AND A.PYMNT_DE        = C.PYMNT_DE
			                                                AND A.EMPNO           = C.EMPNO
			                                                AND A.PYMNT_YM        = #PYMNT_YM#
			                                                AND B.SEXDSTN         = '2'
			                                                AND A.PYMNT_DDC_CODE <> 'P1020'
			                                                AND C.EMPL_SE IN ('000', '001', '002', '003', '004', '007')
			                                                AND A.CLOS_AT IS NOT NULL
			                                             
			                                             UNION ALL
			                                             
			                                             SELECT (SUM(A.SLARY) + SUM(A.REST_ALLWNC) + SUM(A.YRYC_ALLWNC) + SUM(A.SALARY_EXCCLC) + SUM(A.MLSV_SBSIDY) + SUM(A.TRNSPORT_SBSIDY) + SUM(A.FAMILY_ALLWNC) + SUM(A.SCHXPN_SBSIDY) + SUM( A.TRAINING_COST)) AS PYMNT_AMOUNT
			                                               FROM TBSAL_PD_WORK_SALARY A
			                                                  , TBHRM_HR_MASTR B
			                                              WHERE A.EMPNO             = B.EMPNO
			                                                AND A.PYMNT_YM          = #PYMNT_YM#
			                                                AND B.SEXDSTN           = '2'
			                                                AND A.CLOS_AT IS NOT NULL
			                                      )
			                               )
			                             , 0) AS TOT2
			                       , NVL(
			                               (
			                               SELECT SUM(PYMNT_AMOUNT)
			                                 FROM (
			                                             SELECT SUM(A.PYMNT_AMOUNT) AS PYMNT_AMOUNT
			                                               FROM TBSAL_MT_PYMNT_DTLS A
			                                                  , TBHRM_HR_MASTR B
			                                                  , TBSAL_MT_SALARY_PYMNT C
			                                              WHERE A.EMPNO     = B.EMPNO
			                                                AND A.PYMNT_YM  = C.PYMNT_YM
			                                                AND A.SALARY_SE = C.SALARY_SE
			                                                AND A.PYMNT_DE  = C.PYMNT_DE
			                                                AND A.EMPNO     = C.EMPNO
			                                                AND A.PYMNT_YM  = #PYMNT_YM#
			                                                AND B.SEXDSTN IN ('1', '2')
			                                                AND A.PYMNT_DDC_CODE <> 'P1020'
			                                                AND C.EMPL_SE IN ('000', '001', '002', '003', '004', '007')
			                                                AND A.CLOS_AT IS NOT NULL
			                                             
			                                             UNION ALL
			                                             
			                                             SELECT (SUM(A.SLARY) + SUM(A.REST_ALLWNC) + SUM(A.YRYC_ALLWNC) + SUM(A.SALARY_EXCCLC) + SUM(A.MLSV_SBSIDY) + SUM(A.TRNSPORT_SBSIDY) + SUM(A.FAMILY_ALLWNC) + SUM(A.SCHXPN_SBSIDY) + SUM( A.TRAINING_COST)) AS PYMNT_AMOUNT
			                                               FROM TBSAL_PD_WORK_SALARY A
			                                                  , TBHRM_HR_MASTR B
			                                              WHERE A.EMPNO    = B.EMPNO
			                                                AND A.PYMNT_YM = #PYMNT_YM#
			                                                AND B.SEXDSTN IN ('1', '2')
			                                                AND A.CLOS_AT IS NOT NULL
			                                      )
			                               )
			                             , 0) AS TOT3
			                    FROM DUAL
			                  
			                  UNION ALL
			                  
			                  SELECT '특별급여'
			                       , 'Z9992'
			                       , NVL(
			                               (
			                               SELECT SUM(PYMNT_AMOUNT)
			                                 FROM (
			                                             SELECT SUM(A.PYMNT_AMOUNT) AS PYMNT_AMOUNT
			                                               FROM TBSAL_MT_PYMNT_DTLS A
			                                                  , TBHRM_HR_MASTR B
			                                                  , TBSAL_MT_SALARY_PYMNT C
			                                              WHERE A.EMPNO          = B.EMPNO
			                                                AND A.PYMNT_YM       = C.PYMNT_YM
			                                                AND A.SALARY_SE      = C.SALARY_SE
			                                                AND A.PYMNT_DE       = C.PYMNT_DE
			                                                AND A.EMPNO          = C.EMPNO
			                                                AND A.PYMNT_YM       = #PYMNT_YM#
			                                                AND B.SEXDSTN        = '1'
			                                                AND A.PYMNT_DDC_CODE = 'P1020'
			                                                AND C.EMPL_SE IN ('000', '001', '002', '003', '004', '007')
			                                                AND A.CLOS_AT IS NOT NULL
			                                             
			                                             UNION ALL
			                                             
			                                             SELECT SUM(A.BONUS) AS PYMNT_AMOUNT
			                                               FROM TBSAL_PD_WORK_SALARY A
			                                                  , TBHRM_HR_MASTR B
			                                              WHERE A.EMPNO             = B.EMPNO
			                                                AND A.PYMNT_YM          = #PYMNT_YM#
			                                                AND B.SEXDSTN           = '1'
			                                                AND A.CLOS_AT IS NOT NULL
			                                      )
			                               )
			                             , 0 ) AS TOT
			                       , NVL(
			                               (
			                               SELECT SUM(PYMNT_AMOUNT)
			                                 FROM (
			                                             SELECT SUM(A.PYMNT_AMOUNT) AS PYMNT_AMOUNT
			                                               FROM TBSAL_MT_PYMNT_DTLS A
			                                                  , TBHRM_HR_MASTR B
			                                                  , TBSAL_MT_SALARY_PYMNT C
			                                              WHERE A.EMPNO          = B.EMPNO
			                                                AND A.PYMNT_YM       = C.PYMNT_YM
			                                                AND A.SALARY_SE      = C.SALARY_SE
			                                                AND A.PYMNT_DE       = C.PYMNT_DE
			                                                AND A.EMPNO          = C.EMPNO
			                                                AND A.PYMNT_YM       = #PYMNT_YM#
			                                                AND B.SEXDSTN        = '2'
			                                                AND A.PYMNT_DDC_CODE = 'P1020'
			                                                AND C.EMPL_SE IN ('000', '001', '002', '003', '004', '007')
			                                                AND A.CLOS_AT IS NOT NULL
			                                             
			                                             UNION ALL
			                                             
			                                             SELECT SUM(A.BONUS) AS PYMNT_AMOUNT
			                                               FROM TBSAL_PD_WORK_SALARY A
			                                                  , TBHRM_HR_MASTR B
			                                              WHERE A.EMPNO             = B.EMPNO
			                                                AND A.PYMNT_YM          = #PYMNT_YM#
			                                                AND B.SEXDSTN           = '2'
			                                                AND A.CLOS_AT IS NOT NULL
			                                      )
			                               )
			                             , 0 ) AS TOT2
			                       , NVL(
			                               (
			                               SELECT SUM(PYMNT_AMOUNT)
			                                 FROM (
			                                             SELECT SUM(A.PYMNT_AMOUNT) AS PYMNT_AMOUNT
			                                               FROM TBSAL_MT_PYMNT_DTLS A
			                                                  , TBHRM_HR_MASTR B
			                                                  , TBSAL_MT_SALARY_PYMNT C
			                                              WHERE A.EMPNO     = B.EMPNO
			                                                AND A.PYMNT_YM  = C.PYMNT_YM
			                                                AND A.SALARY_SE = C.SALARY_SE
			                                                AND A.PYMNT_DE  = C.PYMNT_DE
			                                                AND A.EMPNO     = C.EMPNO
			                                                AND A.PYMNT_YM  = #PYMNT_YM#
			                                                AND B.SEXDSTN IN ('1', '2')
			                                                AND A.PYMNT_DDC_CODE = 'P1020'
			                                                AND C.EMPL_SE IN ('000', '001', '002', '003', '004', '007')
			                                                AND A.CLOS_AT IS NOT NULL
			                                             
			                                             UNION ALL
			                                             
			                                             SELECT SUM(A.BONUS) AS PYMNT_AMOUNT
			                                               FROM TBSAL_PD_WORK_SALARY A
			                                                  , TBHRM_HR_MASTR B
			                                              WHERE A.EMPNO    = B.EMPNO
			                                                AND A.PYMNT_YM = #PYMNT_YM#
			                                                AND B.SEXDSTN IN ('1', '2')
			                                                AND A.CLOS_AT IS NOT NULL
			                                      )
			                               )
			                             , 0 ) AS TOT3
			                    FROM DUAL
			         )
			ORDER BY PYMNT_DDC_CODE
		]]>
    </select> 
    
	<select id="SAL030205DAO.selectPymntTotList_OLD" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[
				   SELECT PYMNT_DDC_CODE_NM, PYMNT_DDC_CODE, TOT, TOT2, TOT3
				   FROM (
					    SELECT C.PYMNT_DDC_CODE_NM, C.PYMNT_DDC_CODE,
					    ((  SELECT SUM(A.PYMNT_AMOUNT)
					        FROM TBSAL_MT_PYMNT_DTLS A
					            ,TBHRM_HR_MASTR B 					       
					        WHERE A.PYMNT_YM = #PYMNT_YM#
					        AND A.EMPNO = B.EMPNO
                            AND B.SEXDSTN ='1'					     
					        AND A.EMPNO IN (SELECT EMPNO FROM TBSAL_MT_SALARY_PYMNT WHERE PYMNT_YM = #PYMNT_YM# AND ANSLRY_AT IS NULL) 
					        AND A.PYMNT_DDC_CODE ='P1010'
					        AND A.CLOS_AT IS NOT NULL  ) +
					    
					    NVL((   SELECT SUM(A.PYMNT_AMOUNT)
					        FROM TBSAL_MT_PYMNT_DTLS A	
					            ,TBHRM_HR_MASTR B				          
					        WHERE A.PYMNT_YM = #PYMNT_YM#
					        AND A.EMPNO = B.EMPNO
                            AND B.SEXDSTN ='1'					      
					        AND A.EMPNO IN (SELECT EMPNO FROM TBSAL_MT_SALARY_PYMNT WHERE PYMNT_YM = #PYMNT_YM# AND ANSLRY_AT = 'Y') 
					        AND A.PYMNT_DDC_CODE ='P1015'
					        AND A.CLOS_AT IS NOT NULL  ),0)  ) AS TOT
					    ,((  SELECT SUM(A.PYMNT_AMOUNT)
					        FROM TBSAL_MT_PYMNT_DTLS A
					            ,TBHRM_HR_MASTR B 					       
					        WHERE A.PYMNT_YM = #PYMNT_YM#
					        AND A.EMPNO = B.EMPNO
                            AND B.SEXDSTN ='2'					     
					        AND A.EMPNO IN (SELECT EMPNO FROM TBSAL_MT_SALARY_PYMNT WHERE PYMNT_YM = #PYMNT_YM# AND ANSLRY_AT IS NULL) 
					        AND A.PYMNT_DDC_CODE ='P1010'
					        AND A.CLOS_AT IS NOT NULL  ) +
					    
					    NVL((   SELECT SUM(A.PYMNT_AMOUNT)
					        FROM TBSAL_MT_PYMNT_DTLS A	
					            ,TBHRM_HR_MASTR B				          
					        WHERE A.PYMNT_YM = #PYMNT_YM#
					        AND A.EMPNO = B.EMPNO
                            AND B.SEXDSTN ='2'					      
					        AND A.EMPNO IN (SELECT EMPNO FROM TBSAL_MT_SALARY_PYMNT WHERE PYMNT_YM = #PYMNT_YM# AND ANSLRY_AT = 'Y') 
					        AND A.PYMNT_DDC_CODE ='P1015'
					        AND A.CLOS_AT IS NOT NULL  ),0)  ) AS TOT2  
					    ,((  SELECT SUM(A.PYMNT_AMOUNT)
					        FROM TBSAL_MT_PYMNT_DTLS A			       
					        WHERE A.PYMNT_YM = #PYMNT_YM#     
					        AND A.EMPNO IN (SELECT EMPNO FROM TBSAL_MT_SALARY_PYMNT WHERE PYMNT_YM = #PYMNT_YM# AND ANSLRY_AT IS NULL) 
					        AND A.PYMNT_DDC_CODE ='P1010'
					        AND A.CLOS_AT IS NOT NULL  ) +
					    
					    NVL((   SELECT SUM(A.PYMNT_AMOUNT)
					        FROM TBSAL_MT_PYMNT_DTLS A		          
					        WHERE A.PYMNT_YM = #PYMNT_YM#	      
					        AND A.EMPNO IN (SELECT EMPNO FROM TBSAL_MT_SALARY_PYMNT WHERE PYMNT_YM = #PYMNT_YM# AND ANSLRY_AT = 'Y') 
					        AND A.PYMNT_DDC_CODE ='P1015'
					        AND A.CLOS_AT IS NOT NULL  ),0)  ) AS TOT3      
					    FROM TBSAL_PYMNT_DDC_STDR_CODE C
					    WHERE C.PYMNT_DDC_CODE = 'P1010'
					    
					    UNION ALL
					    
					    SELECT D.PYMNT_DDC_CODE_NM, D.PYMNT_DDC_CODE
					    ,NVL(SUM(CASE B.SEXDSTN  WHEN '1' THEN C.PYMNT_AMOUNT END),0) AS TOT
					    ,NVL(SUM(CASE B.SEXDSTN  WHEN '2' THEN C.PYMNT_AMOUNT END),0) AS TOT2
					    ,NVL(SUM(C.PYMNT_AMOUNT),0) AS TOT3
					    FROM TBSAL_MT_PYMNT_DTLS C
					        ,TBSAL_PYMNT_DDC_STDR_CODE D
					        ,TBHRM_HR_MASTR B					       
					    WHERE C.PYMNT_YM = #PYMNT_YM#
					    AND C.EMPNO = B.EMPNO					    
					    AND C.PYMNT_DDC_CODE = D.PYMNT_DDC_CODE					  
					    AND C.CLOS_AT IS NOT NULL
					    AND C.PYMNT_DDC_CODE NOT IN ('P1010', 'P1015')
					    GROUP BY D.PYMNT_DDC_CODE, D.PYMNT_DDC_CODE_NM
					    
					    UNION ALL
					    
					    SELECT '근로시간수',''
					   ,NVL((SELECT SUM(A.MNBY_WORK_DAYCNT * 8)   
		                     FROM TBHRM_MNBY_DCLZ_SM A
		                         ,TBHRM_HR_MASTR B
		                     WHERE A.STDR_YM = #PYMNT_YM#
		                     AND A.EMPNO = B.EMPNO
		                     AND B.SEXDSTN ='1'),0) AS TOT
		               ,NVL((SELECT SUM(A.MNBY_WORK_DAYCNT * 8)   
		                     FROM TBHRM_MNBY_DCLZ_SM A
		                         ,TBHRM_HR_MASTR B
		                     WHERE A.STDR_YM = #PYMNT_YM#
		                     AND A.EMPNO = B.EMPNO
		                     AND B.SEXDSTN ='2'),0) AS TOT2  
		               ,NVL((SELECT SUM(A.MNBY_WORK_DAYCNT * 8)   
		                     FROM TBHRM_MNBY_DCLZ_SM A
		                     WHERE A.STDR_YM = #PYMNT_YM#),0) AS TOT3           
					    FROM DUAL
					    
					    UNION ALL
					    
				        SELECT '휴가일수'
				              ,''
				              ,NVL((SELECT SUM(B.DCLZ_DAYCNT)
				                     FROM TBHRM_MNBY_DCLZ_DTLS B, TBHRM_HR_MASTR C
				                    WHERE 1 = 1
				                      AND B.EMPNO = C.EMPNO
				                      AND C.SEXDSTN = '1'
				                      AND B.DCLZ_SE IN ('201','204','205','208','211','212','214','215') /* 연차,보건휴가,청원휴가,안식휴가,출산휴가,포상휴가,휴가,대체휴가 */
				                      AND TO_CHAR(B.BGNDT , 'YYYYMM') = #PYMNT_YM#
              						  AND TO_CHAR(B.ENDDT, 'YYYYMM') = #PYMNT_YM#)
				                  ,0) AS TOT
				               
				              ,NVL((SELECT SUM(B.DCLZ_DAYCNT)
				                     FROM TBHRM_MNBY_DCLZ_DTLS B, TBHRM_HR_MASTR C
				                    WHERE 1 = 1
				                      AND B.EMPNO = C.EMPNO
				                      AND C.SEXDSTN = '2'
				                      AND B.DCLZ_SE IN ('201','204','205','208','211','212','214','215')
				                      AND TO_CHAR(B.BGNDT , 'YYYYMM') = #PYMNT_YM#
              						  AND TO_CHAR(B.ENDDT, 'YYYYMM') = #PYMNT_YM#)
				                  ,0) AS TOT2
				                  
				              ,NVL((SELECT SUM(B.DCLZ_DAYCNT)
				                     FROM TBHRM_MNBY_DCLZ_DTLS B, TBHRM_HR_MASTR C
				                    WHERE 1 = 1
				                      AND B.EMPNO = C.EMPNO
				                      AND B.DCLZ_SE IN ('201','204','205','208','211','212','214','215')
				                      AND TO_CHAR(B.BGNDT , 'YYYYMM') = #PYMNT_YM#
              						  AND TO_CHAR(B.ENDDT, 'YYYYMM') = #PYMNT_YM#)
				                  ,0) AS TOT3
				        
				          FROM DUAL           
					      
					    UNION ALL
					    
					    SELECT '정액급여',''
					    ,(
					            NVL((SELECT SUM(A.PYMNT_AMOUNT)
					            FROM TBSAL_MT_PYMNT_DTLS A
					                ,TBHRM_HR_MASTR B					               
					            WHERE A.PYMNT_YM = #PYMNT_YM#	
					            AND A.EMPNO = B.EMPNO
                                AND B.SEXDSTN ='1'				          
					            AND A.EMPNO IN (SELECT EMPNO FROM TBSAL_MT_SALARY_PYMNT WHERE PYMNT_YM = #PYMNT_YM# AND ANSLRY_AT IS NULL) 
					            AND A.PYMNT_DDC_CODE ='P1010'
					            AND A.CLOS_AT IS NOT NULL  ),0) +
					        
					          NVL(( SELECT SUM(A.PYMNT_AMOUNT)
					            FROM TBSAL_MT_PYMNT_DTLS A	
					                ,TBHRM_HR_MASTR B				             
					            WHERE A.PYMNT_YM = #PYMNT_YM#
					            AND A.EMPNO = B.EMPNO
                                AND B.SEXDSTN ='1'					          
					            AND A.EMPNO IN (SELECT EMPNO FROM TBSAL_MT_SALARY_PYMNT WHERE PYMNT_YM = #PYMNT_YM# AND ANSLRY_AT = 'Y') 
					            AND A.PYMNT_DDC_CODE ='P1015'
					            AND A.CLOS_AT IS NOT NULL  ),0) + 
					          
					          NVL(( SELECT SUM(A.PYMNT_AMOUNT)
					            FROM TBSAL_MT_PYMNT_DTLS A	
					                ,TBHRM_HR_MASTR B				           
					            WHERE A.PYMNT_YM = #PYMNT_YM#	
					            AND A.EMPNO = B.EMPNO
                                AND B.SEXDSTN ='1'				               
					            AND A.PYMNT_DDC_CODE NOT IN ('P1010','P1015')
					            AND A.CLOS_AT IS NOT NULL  ),0) ) AS TOT
					        ,(
					            NVL((SELECT SUM(A.PYMNT_AMOUNT)
					            FROM TBSAL_MT_PYMNT_DTLS A
					                ,TBHRM_HR_MASTR B					               
					            WHERE A.PYMNT_YM = #PYMNT_YM#	
					            AND A.EMPNO = B.EMPNO
                                AND B.SEXDSTN ='2'				          
					            AND A.EMPNO IN (SELECT EMPNO FROM TBSAL_MT_SALARY_PYMNT WHERE PYMNT_YM = #PYMNT_YM# AND ANSLRY_AT IS NULL) 
					            AND A.PYMNT_DDC_CODE ='P1010'
					            AND A.CLOS_AT IS NOT NULL  ),0) +
					        
					          NVL(( SELECT SUM(A.PYMNT_AMOUNT)
					            FROM TBSAL_MT_PYMNT_DTLS A	
					                ,TBHRM_HR_MASTR B				             
					            WHERE A.PYMNT_YM = #PYMNT_YM#
					            AND A.EMPNO = B.EMPNO
                                AND B.SEXDSTN ='2'					          
					            AND A.EMPNO IN (SELECT EMPNO FROM TBSAL_MT_SALARY_PYMNT WHERE PYMNT_YM = #PYMNT_YM# AND ANSLRY_AT = 'Y') 
					            AND A.PYMNT_DDC_CODE ='P1015'
					            AND A.CLOS_AT IS NOT NULL  ),0) + 
					          
					          NVL(( SELECT SUM(A.PYMNT_AMOUNT)
					            FROM TBSAL_MT_PYMNT_DTLS A	
					                ,TBHRM_HR_MASTR B				           
					            WHERE A.PYMNT_YM = #PYMNT_YM#	
					            AND A.EMPNO = B.EMPNO
                                AND B.SEXDSTN ='2'				               
					            AND A.PYMNT_DDC_CODE NOT IN ('P1010','P1015')
					            AND A.CLOS_AT IS NOT NULL  ),0) ) AS TOT2 
					        ,(
					            NVL((SELECT SUM(A.PYMNT_AMOUNT)
					            FROM TBSAL_MT_PYMNT_DTLS A			               
					            WHERE A.PYMNT_YM = #PYMNT_YM#		          
					            AND A.EMPNO IN (SELECT EMPNO FROM TBSAL_MT_SALARY_PYMNT WHERE PYMNT_YM = #PYMNT_YM# AND ANSLRY_AT IS NULL) 
					            AND A.PYMNT_DDC_CODE ='P1010'
					            AND A.CLOS_AT IS NOT NULL  ),0) +
					        
					          NVL(( SELECT SUM(A.PYMNT_AMOUNT)
					            FROM TBSAL_MT_PYMNT_DTLS A		             
					            WHERE A.PYMNT_YM = #PYMNT_YM#	          
					            AND A.EMPNO IN (SELECT EMPNO FROM TBSAL_MT_SALARY_PYMNT WHERE PYMNT_YM = #PYMNT_YM# AND ANSLRY_AT = 'Y') 
					            AND A.PYMNT_DDC_CODE ='P1015'
					            AND A.CLOS_AT IS NOT NULL  ),0) + 
					          
					          NVL(( SELECT SUM(A.PYMNT_AMOUNT)
					            FROM TBSAL_MT_PYMNT_DTLS A		           
					            WHERE A.PYMNT_YM = #PYMNT_YM#               
					            AND A.PYMNT_DDC_CODE NOT IN ('P1010','P1015')
					            AND A.CLOS_AT IS NOT NULL  ),0) ) AS TOT3        
					        FROM DUAL   
					        
					        UNION ALL
					        
					        SELECT '특별급여',''
					        ,NVL((SELECT SUM(A.PYMNT_AMOUNT)
		                          FROM TBSAL_MT_PYMNT_DTLS A
		                              ,TBHRM_HR_MASTR B
		                          WHERE A.PYMNT_YM = #PYMNT_YM#
		                          AND A.EMPNO = B.EMPNO
                                  AND B.SEXDSTN ='1'
		                          AND A.PYMNT_DDC_CODE = 'P1020'
		                          AND A.CLOS_AT IS NOT NULL),0) AS TOT
		                    ,NVL((SELECT SUM(A.PYMNT_AMOUNT)
		                          FROM TBSAL_MT_PYMNT_DTLS A
		                              ,TBHRM_HR_MASTR B
		                          WHERE A.PYMNT_YM = #PYMNT_YM#
		                          AND A.EMPNO = B.EMPNO
                                  AND B.SEXDSTN ='2'
		                          AND A.PYMNT_DDC_CODE = 'P1020'
		                          AND A.CLOS_AT IS NOT NULL),0) AS TOT2 
		                    ,NVL((SELECT SUM(A.PYMNT_AMOUNT)
		                          FROM TBSAL_MT_PYMNT_DTLS A
		                          WHERE A.PYMNT_YM = #PYMNT_YM#
		                          AND A.PYMNT_DDC_CODE = 'P1020'
		                          AND A.CLOS_AT IS NOT NULL),0) AS TOT3            
					        FROM DUAL					           
					    )
					
					ORDER BY PYMNT_DDC_CODE
		]]>	 		        	     
    </select>

</sqlMap>