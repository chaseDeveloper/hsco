<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="FUN020201_SQL">	
	<typeAlias alias="egovMap"          type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	
	<!-- 차입금 총괄요약현황 조회 -->
	<select id="FUN020201DAO.selectBrrwSmrizeList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
		       <isEqual property="PRT_KND" compareValue="1">
		       B.CPTAL_KND            AS CPTAL_KND
		      ,E.CODE_NM              AS NM1
		      ,B.BSNS_CODE            AS BSNS_CODE
		      ,D.BSNS_NM              AS NM2
		      ,B.FNNC_INSTT_SPOT_CODE AS FNNC_INSTT_CODE
		      ,C.FNNC_INSTT_CODE_NM   AS NM3
		       </isEqual>
		       <isEqual property="PRT_KND" compareValue="2">
		       B.BSNS_CODE            AS BSNS_CODE
		      ,D.BSNS_NM              AS NM1
		      ,B.CPTAL_KND            AS CPTAL_KND
		      ,E.CODE_NM              AS NM2
		      ,B.FNNC_INSTT_SPOT_CODE AS FNNC_INSTT_CODE
		      ,C.FNNC_INSTT_CODE_NM   AS NM3
		       </isEqual>
		       <isEqual property="PRT_KND" compareValue="3">
		       B.FNNC_INSTT_SPOT_CODE AS FNNC_INSTT_CODE
		      ,C.FNNC_INSTT_CODE_NM   AS NM1
		      ,B.CPTAL_KND            AS CPTAL_KND
		      ,E.CODE_NM              AS NM2
		      ,B.BSNS_CODE            AS BSNS_CODE
		      ,D.BSNS_NM              AS NM3
		       </isEqual>
		       <isEqual property="PRT_KND" compareValue="4">
		       B.CPTAL_KND            AS CPTAL_KND
		      ,E.CODE_NM              AS NM1
		      ,''                     AS BSNS_CODE
		      ,''                     AS NM2
		      ,''                     AS FNNC_INSTT_CODE
		      ,''                     AS NM3
		       </isEqual>
		      ,CASE B.AMT0  WHEN 0 THEN 0 ELSE TRUNC(B.AMT0  / #PRT_GBN1#) END AS AMT0
		      ,CASE B.AMT1  WHEN 0 THEN 0 ELSE TRUNC(B.AMT1  / #PRT_GBN1#) END AS AMT1
		      ,CASE B.AMT2  WHEN 0 THEN 0 ELSE TRUNC(B.AMT2  / #PRT_GBN1#) END AS AMT2
		      ,CASE B.AMT3  WHEN 0 THEN 0 ELSE TRUNC(B.AMT3  / #PRT_GBN1#) END AS AMT3
		      ,CASE B.AMT4  WHEN 0 THEN 0 ELSE TRUNC(B.AMT4  / #PRT_GBN1#) END AS AMT4
		      ,CASE B.AMT5  WHEN 0 THEN 0 ELSE TRUNC(B.AMT5  / #PRT_GBN1#) END AS AMT5
		      ,CASE B.AMT6  WHEN 0 THEN 0 ELSE TRUNC(B.AMT6  / #PRT_GBN1#) END AS AMT6
		      ,CASE B.AMT7  WHEN 0 THEN 0 ELSE TRUNC(B.AMT7  / #PRT_GBN1#) END AS AMT7
		      ,CASE B.AMT8  WHEN 0 THEN 0 ELSE TRUNC(B.AMT8  / #PRT_GBN1#) END AS AMT8
		      ,CASE B.AMT9  WHEN 0 THEN 0 ELSE TRUNC(B.AMT9  / #PRT_GBN1#) END AS AMT9
		      ,CASE B.AMT10 WHEN 0 THEN 0 ELSE TRUNC(B.AMT10 / #PRT_GBN1#) END AS AMT10
		      ,CASE B.AMT11 WHEN 0 THEN 0 ELSE TRUNC(B.AMT11 / #PRT_GBN1#) END AS AMT11
		      ,CASE B.AMT12 WHEN 0 THEN 0 ELSE TRUNC(B.AMT12 / #PRT_GBN1#) END AS AMT12
		      ,CASE B.AMT13 WHEN 0 THEN 0 ELSE TRUNC(B.AMT13 / #PRT_GBN1#) END AS AMT13
		      ,CASE B.AMT14 WHEN 0 THEN 0 ELSE TRUNC(B.AMT14 / #PRT_GBN1#) END AS AMT14
		      ,CASE B.AMT15 WHEN 0 THEN 0 ELSE TRUNC(B.AMT15 / #PRT_GBN1#) END AS AMT15
		      ,CASE B.AMT16 WHEN 0 THEN 0 ELSE TRUNC(B.AMT16 / #PRT_GBN1#) END AS AMT16
		      ,CASE B.AMT17 WHEN 0 THEN 0 ELSE TRUNC(B.AMT17 / #PRT_GBN1#) END AS AMT17
		      ,CASE B.AMT18 WHEN 0 THEN 0 ELSE TRUNC(B.AMT18 / #PRT_GBN1#) END AS AMT18
		      ,CASE B.AMT19 WHEN 0 THEN 0 ELSE TRUNC(B.AMT19 / #PRT_GBN1#) END AS AMT19
		      ,CASE B.INT0  WHEN 0 THEN 0 ELSE TRUNC(B.INT0  / #PRT_GBN1#) END AS INT0
		      ,CASE B.INT1  WHEN 0 THEN 0 ELSE TRUNC(B.INT1  / #PRT_GBN1#) END AS INT1
		      ,CASE B.INT2  WHEN 0 THEN 0 ELSE TRUNC(B.INT2  / #PRT_GBN1#) END AS INT2
		      ,CASE B.INT3  WHEN 0 THEN 0 ELSE TRUNC(B.INT3  / #PRT_GBN1#) END AS INT3
		      ,CASE B.INT4  WHEN 0 THEN 0 ELSE TRUNC(B.INT4  / #PRT_GBN1#) END AS INT4
		      ,CASE B.INT5  WHEN 0 THEN 0 ELSE TRUNC(B.INT5  / #PRT_GBN1#) END AS INT5
		      ,CASE B.INT6  WHEN 0 THEN 0 ELSE TRUNC(B.INT6  / #PRT_GBN1#) END AS INT6
		      ,CASE B.INT7  WHEN 0 THEN 0 ELSE TRUNC(B.INT7  / #PRT_GBN1#) END AS INT7
		      ,CASE B.INT8  WHEN 0 THEN 0 ELSE TRUNC(B.INT8  / #PRT_GBN1#) END AS INT8
		      ,CASE B.INT9  WHEN 0 THEN 0 ELSE TRUNC(B.INT9  / #PRT_GBN1#) END AS INT9
		      ,CASE B.INT10 WHEN 0 THEN 0 ELSE TRUNC(B.INT10 / #PRT_GBN1#) END AS INT10
		      ,CASE B.INT11 WHEN 0 THEN 0 ELSE TRUNC(B.INT11 / #PRT_GBN1#) END AS INT11
		      ,CASE B.INT12 WHEN 0 THEN 0 ELSE TRUNC(B.INT12 / #PRT_GBN1#) END AS INT12
		      ,CASE B.INT13 WHEN 0 THEN 0 ELSE TRUNC(B.INT13 / #PRT_GBN1#) END AS INT13
		      ,CASE B.INT14 WHEN 0 THEN 0 ELSE TRUNC(B.INT14 / #PRT_GBN1#) END AS INT14
		      ,CASE B.INT15 WHEN 0 THEN 0 ELSE TRUNC(B.INT15 / #PRT_GBN1#) END AS INT15
		      ,CASE B.INT16 WHEN 0 THEN 0 ELSE TRUNC(B.INT16 / #PRT_GBN1#) END AS INT16
		      ,CASE B.INT17 WHEN 0 THEN 0 ELSE TRUNC(B.INT17 / #PRT_GBN1#) END AS INT17
		      ,CASE B.INT18 WHEN 0 THEN 0 ELSE TRUNC(B.INT18 / #PRT_GBN1#) END AS INT18
		      ,CASE B.INT19 WHEN 0 THEN 0 ELSE TRUNC(B.INT19 / #PRT_GBN1#) END AS INT19
		  FROM
		       (SELECT
		               SUBSTR(A.CPTAL_KND,1,1) AS CPTAL_KND
		       <isNotEqual property="PRT_KND" compareValue="4">
		              ,A.BSNS_CODE AS BSNS_CODE
		              ,A.FNNC_INSTT_SPOT_CODE AS FNNC_INSTT_SPOT_CODE
		              ,NVL(SUM(C.RPAY_AMOUNT - C.PRNCPAL_RPAY_AG0 ),0) AS AMT0
		              ,NVL(SUM(C.RPAY_AMOUNT - C.PRNCPAL_RPAY_AG1 ),0) AS AMT1
		              ,NVL(SUM(C.RPAY_AMOUNT - C.PRNCPAL_RPAY_AG2 ),0) AS AMT2
		              ,NVL(SUM(C.RPAY_AMOUNT - C.PRNCPAL_RPAY_AG3 ),0) AS AMT3
		              ,NVL(SUM(C.RPAY_AMOUNT - C.PRNCPAL_RPAY_AG4 ),0) AS AMT4
		              ,NVL(SUM(C.RPAY_AMOUNT - C.PRNCPAL_RPAY_AG5 ),0) AS AMT5
		              ,NVL(SUM(C.RPAY_AMOUNT - C.PRNCPAL_RPAY_AG6 ),0) AS AMT6
		              ,NVL(SUM(C.RPAY_AMOUNT - C.PRNCPAL_RPAY_AG7 ),0) AS AMT7
		              ,NVL(SUM(C.RPAY_AMOUNT - C.PRNCPAL_RPAY_AG8 ),0) AS AMT8
		              ,NVL(SUM(C.RPAY_AMOUNT - C.PRNCPAL_RPAY_AG9 ),0) AS AMT9
		              ,NVL(SUM(C.RPAY_AMOUNT - C.PRNCPAL_RPAY_AG10),0) AS AMT10
		              ,NVL(SUM(C.RPAY_AMOUNT - C.PRNCPAL_RPAY_AG11),0) AS AMT11
		              ,NVL(SUM(C.RPAY_AMOUNT - C.PRNCPAL_RPAY_AG12),0) AS AMT12
		              ,NVL(SUM(C.RPAY_AMOUNT - C.PRNCPAL_RPAY_AG13),0) AS AMT13
		              ,NVL(SUM(C.RPAY_AMOUNT - C.PRNCPAL_RPAY_AG14),0) AS AMT14
		              ,NVL(SUM(C.RPAY_AMOUNT - C.PRNCPAL_RPAY_AG15),0) AS AMT15
		              ,NVL(SUM(C.RPAY_AMOUNT - C.PRNCPAL_RPAY_AG16),0) AS AMT16
		              ,NVL(SUM(C.RPAY_AMOUNT - C.PRNCPAL_RPAY_AG17),0) AS AMT17
		              ,NVL(SUM(C.RPAY_AMOUNT - C.PRNCPAL_RPAY_AG18),0) AS AMT18
		              ,NVL(SUM(C.RPAY_AMOUNT - C.PRNCPAL_RPAY_AG19),0) AS AMT19
		              ,NVL(SUM(E.RPAY_AMOUNT - E.INTR_RPAY_AG0),0)  AS INT0
		              ,NVL(SUM(E.RPAY_AMOUNT - E.INTR_RPAY_AG1),0)  AS INT1
		              ,NVL(SUM(E.RPAY_AMOUNT - E.INTR_RPAY_AG2),0)  AS INT2
		              ,NVL(SUM(E.RPAY_AMOUNT - E.INTR_RPAY_AG3),0)  AS INT3
		              ,NVL(SUM(E.RPAY_AMOUNT - E.INTR_RPAY_AG4),0)  AS INT4
		              ,NVL(SUM(E.RPAY_AMOUNT - E.INTR_RPAY_AG5),0)  AS INT5
		              ,NVL(SUM(E.RPAY_AMOUNT - E.INTR_RPAY_AG6),0)  AS INT6
		              ,NVL(SUM(E.RPAY_AMOUNT - E.INTR_RPAY_AG7),0)  AS INT7
		              ,NVL(SUM(E.RPAY_AMOUNT - E.INTR_RPAY_AG8),0)  AS INT8
		              ,NVL(SUM(E.RPAY_AMOUNT - E.INTR_RPAY_AG9),0)  AS INT9
		              ,NVL(SUM(E.RPAY_AMOUNT - E.INTR_RPAY_AG10),0) AS INT10
		              ,NVL(SUM(E.RPAY_AMOUNT - E.INTR_RPAY_AG11),0) AS INT11
		              ,NVL(SUM(E.RPAY_AMOUNT - E.INTR_RPAY_AG12),0) AS INT12
		              ,NVL(SUM(E.RPAY_AMOUNT - E.INTR_RPAY_AG13),0) AS INT13
		              ,NVL(SUM(E.RPAY_AMOUNT - E.INTR_RPAY_AG14),0) AS INT14
		              ,NVL(SUM(E.RPAY_AMOUNT - E.INTR_RPAY_AG15),0) AS INT15
		              ,NVL(SUM(E.RPAY_AMOUNT - E.INTR_RPAY_AG16),0) AS INT16
		              ,NVL(SUM(E.RPAY_AMOUNT - E.INTR_RPAY_AG17),0) AS INT17
		              ,NVL(SUM(E.RPAY_AMOUNT - E.INTR_RPAY_AG18),0) AS INT18
		              ,NVL(SUM(E.RPAY_AMOUNT - E.INTR_RPAY_AG19),0) AS INT19
		       </isNotEqual>
		       <isEqual property="PRT_KND" compareValue="4">
		              ,NVL(SUM(C.PRNCPAL_RPAY_AG0 ),0) AS AMT0
		              ,NVL(SUM(C.PRNCPAL_RPAY_AG1 ),0) AS AMT1
		              ,NVL(SUM(C.PRNCPAL_RPAY_AG2 ),0) AS AMT2
		              ,NVL(SUM(C.PRNCPAL_RPAY_AG3 ),0) AS AMT3
		              ,NVL(SUM(C.PRNCPAL_RPAY_AG4 ),0) AS AMT4
		              ,NVL(SUM(C.PRNCPAL_RPAY_AG5 ),0) AS AMT5
		              ,NVL(SUM(C.PRNCPAL_RPAY_AG6 ),0) AS AMT6
		              ,NVL(SUM(C.PRNCPAL_RPAY_AG7 ),0) AS AMT7
		              ,NVL(SUM(C.PRNCPAL_RPAY_AG8 ),0) AS AMT8
		              ,NVL(SUM(C.PRNCPAL_RPAY_AG9 ),0) AS AMT9
		              ,NVL(SUM(C.PRNCPAL_RPAY_AG10),0) AS AMT10
		              ,NVL(SUM(C.PRNCPAL_RPAY_AG11),0) AS AMT11
		              ,NVL(SUM(C.PRNCPAL_RPAY_AG12),0) AS AMT12
		              ,NVL(SUM(C.PRNCPAL_RPAY_AG13),0) AS AMT13
		              ,NVL(SUM(C.PRNCPAL_RPAY_AG14),0) AS AMT14
		              ,NVL(SUM(C.PRNCPAL_RPAY_AG15),0) AS AMT15
		              ,NVL(SUM(C.PRNCPAL_RPAY_AG16),0) AS AMT16
		              ,NVL(SUM(C.PRNCPAL_RPAY_AG17),0) AS AMT17
		              ,NVL(SUM(C.PRNCPAL_RPAY_AG18),0) AS AMT18
		              ,NVL(SUM(C.PRNCPAL_RPAY_AG19),0) AS AMT19
		              ,NVL(SUM(E.INTR_RPAY_AG0),0)  AS INT0
		              ,NVL(SUM(E.INTR_RPAY_AG1),0)  AS INT1
		              ,NVL(SUM(E.INTR_RPAY_AG2),0)  AS INT2
		              ,NVL(SUM(E.INTR_RPAY_AG3),0)  AS INT3
		              ,NVL(SUM(E.INTR_RPAY_AG4),0)  AS INT4
		              ,NVL(SUM(E.INTR_RPAY_AG5),0)  AS INT5
		              ,NVL(SUM(E.INTR_RPAY_AG6),0)  AS INT6
		              ,NVL(SUM(E.INTR_RPAY_AG7),0)  AS INT7
		              ,NVL(SUM(E.INTR_RPAY_AG8),0)  AS INT8
		              ,NVL(SUM(E.INTR_RPAY_AG9),0)  AS INT9
		              ,NVL(SUM(E.INTR_RPAY_AG10),0) AS INT10
		              ,NVL(SUM(E.INTR_RPAY_AG11),0) AS INT11
		              ,NVL(SUM(E.INTR_RPAY_AG12),0) AS INT12
		              ,NVL(SUM(E.INTR_RPAY_AG13),0) AS INT13
		              ,NVL(SUM(E.INTR_RPAY_AG14),0) AS INT14
		              ,NVL(SUM(E.INTR_RPAY_AG15),0) AS INT15
		              ,NVL(SUM(E.INTR_RPAY_AG16),0) AS INT16
		              ,NVL(SUM(E.INTR_RPAY_AG17),0) AS INT17
		              ,NVL(SUM(E.INTR_RPAY_AG18),0) AS INT18
		              ,NVL(SUM(E.INTR_RPAY_AG19),0) AS INT19
		       </isEqual>
		         FROM TBFUN_PBNCD A
		         
		       <!-- 원금계산 부분 -->
		              LEFT OUTER JOIN
		              (SELECT A.PBNCD_NO AS PBNCD_NO,
		                     SUM(A.RPAY_AMOUNT) AS RPAY_AMOUNT,
		       <isNotEqual property="PRT_KND" compareValue="4">
		       <isEqual property="PRT_GBN2" compareValue="Y">
		         <![CDATA[
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,4) <= #SEARCH_YEAR#   THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,4) <= #SEARCH_YEAR#   THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG0,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,4) <= #SEARCH_YEAR#+1 THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,4) <= #SEARCH_YEAR#+1 THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG1,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,4) <= #SEARCH_YEAR#+2 THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,4) <= #SEARCH_YEAR#+2 THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG2,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,4) <= #SEARCH_YEAR#+3 THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,4) <= #SEARCH_YEAR#+3 THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG3,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,4) <= #SEARCH_YEAR#+4 THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,4) <= #SEARCH_YEAR#+4 THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG4,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,4) <= #SEARCH_YEAR#+5 THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,4) <= #SEARCH_YEAR#+5 THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG5,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,4) <= #SEARCH_YEAR#+6 THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,4) <= #SEARCH_YEAR#+6 THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG6,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,4) <= #SEARCH_YEAR#+7 THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,4) <= #SEARCH_YEAR#+7 THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG7,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,4) <= #SEARCH_YEAR#+8 THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,4) <= #SEARCH_YEAR#+8 THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG8,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,4) <= #SEARCH_YEAR#+9 THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,4) <= #SEARCH_YEAR#+9 THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG9,
		                     0 AS PRNCPAL_RPAY_AG10,0 AS PRNCPAL_RPAY_AG11,0 AS PRNCPAL_RPAY_AG12,0 AS PRNCPAL_RPAY_AG13,0 AS PRNCPAL_RPAY_AG14,
		                     0 AS PRNCPAL_RPAY_AG15,0 AS PRNCPAL_RPAY_AG16,0 AS PRNCPAL_RPAY_AG17,0 AS PRNCPAL_RPAY_AG18,0 AS PRNCPAL_RPAY_AG19
		         ]]>
		       </isEqual>
		       <isEqual property="PRT_GBN2" compareValue="Q">
		         <![CDATA[
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#  ||'03' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#  ||'03' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG0,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#  ||'06' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#  ||'06' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG1,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#  ||'09' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#  ||'09' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG2,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#  ||'12' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#  ||'12' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG3,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+1||'03' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+1||'03' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG4,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+1||'06' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+1||'06' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG5,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+1||'09' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+1||'09' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG6,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+1||'12' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+1||'12' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG7,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+2||'03' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+2||'03' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG8,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+2||'06' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+2||'06' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG9,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+2||'09' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+2||'09' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG10,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+2||'12' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+2||'12' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG11,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+3||'03' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+3||'03' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG12,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+3||'06' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+3||'06' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG13,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+3||'09' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+3||'09' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG14,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+3||'12' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+3||'12' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG15,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+4||'03' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+4||'03' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG16,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+4||'06' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+4||'06' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG17,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+4||'09' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+4||'09' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG18,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+4||'12' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+4||'12' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS PRNCPAL_RPAY_AG19
		         ]]>
		       </isEqual>
		       <isEqual property="PRT_GBN2" compareValue="M">
		         <![CDATA[
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'01' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'01' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END PRNCPAL_RPAY_AG0,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'02' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'02' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END PRNCPAL_RPAY_AG1,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'03' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'03' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END PRNCPAL_RPAY_AG2,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'04' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'04' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END PRNCPAL_RPAY_AG3,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'05' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'05' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END PRNCPAL_RPAY_AG4,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'06' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'06' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END PRNCPAL_RPAY_AG5,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'07' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'07' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END PRNCPAL_RPAY_AG6,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'08' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'08' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END PRNCPAL_RPAY_AG7,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'09' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'09' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END PRNCPAL_RPAY_AG8,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'10' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'10' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END PRNCPAL_RPAY_AG9,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'11' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'11' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END PRNCPAL_RPAY_AG10,
		                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'12' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'12' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END PRNCPAL_RPAY_AG11,
		                     0 AS PRNCPAL_RPAY_AG12,0 AS PRNCPAL_RPAY_AG13,0 AS PRNCPAL_RPAY_AG14,0 AS PRNCPAL_RPAY_AG15,
		                     0 AS PRNCPAL_RPAY_AG16,0 AS PRNCPAL_RPAY_AG17,0 AS PRNCPAL_RPAY_AG18,0 AS PRNCPAL_RPAY_AG19
		         ]]>
		       </isEqual>
		       </isNotEqual>
		       <isEqual property="PRT_KND" compareValue="4">
		       <isEqual property="PRT_GBN2" compareValue="Y">
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#    THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG0,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+1  THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG1,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+2  THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG2,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+3  THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG3,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+4  THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG4,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+5  THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG5,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+6  THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG6,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+7  THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG7,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+8  THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG8,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+9  THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG9,
		                     0 AS PRNCPAL_RPAY_AG10,0 AS PRNCPAL_RPAY_AG11,0 AS PRNCPAL_RPAY_AG12,0 AS PRNCPAL_RPAY_AG13,0 AS PRNCPAL_RPAY_AG14,
		                     0 AS PRNCPAL_RPAY_AG15,0 AS PRNCPAL_RPAY_AG16,0 AS PRNCPAL_RPAY_AG17,0 AS PRNCPAL_RPAY_AG18,0 AS PRNCPAL_RPAY_AG19
		       </isEqual>
		       <isEqual property="PRT_GBN2" compareValue="Q">
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#   AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '1' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG0,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#   AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '2' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG1,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#   AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '3' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG2,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#   AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '4' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG3,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+1 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '1' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG4,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+1 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '2' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG5,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+1 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '3' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG6,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+1 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '4' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG7,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+2 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '1' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG8,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+2 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '2' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG9,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+2 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '3' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG10,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+2 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '4' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG11,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+3 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '1' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG12,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+3 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '2' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG13,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+3 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '3' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG14,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+3 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '4' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG15,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+4 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '1' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG16,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+4 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '2' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG17,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+4 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '3' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG18,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+4 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '4' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG19
		       </isEqual>
		       <isEqual property="PRT_GBN2" compareValue="M">
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'01' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG0,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'02' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG1,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'03' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG2,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'04' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG3,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'05' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG4,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'06' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG5,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'07' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG6,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'08' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG7,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'09' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG8,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'10' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG9,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'11' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG10,
		                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'12' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS PRNCPAL_RPAY_AG11,
		                     0 AS PRNCPAL_RPAY_AG12,0 AS PRNCPAL_RPAY_AG13,0 AS PRNCPAL_RPAY_AG14,0 AS PRNCPAL_RPAY_AG15,
		                     0 AS PRNCPAL_RPAY_AG16,0 AS PRNCPAL_RPAY_AG17,0 AS PRNCPAL_RPAY_AG18,0 AS PRNCPAL_RPAY_AG19
		       </isEqual>		       
		       </isEqual>
		                FROM TBFUN_PBNCD_PRNCPAL_RPAY_PLAN A
		                LEFT OUTER JOIN TBFUN_PBNCD B
		                        ON A.PBNCD_NO = B.PBNCD_NO
		               GROUP BY A.PBNCD_NO
		              )C
		              ON A.PBNCD_NO = C.PBNCD_NO
		              
		       <!-- 이자계산 부분 -->
		              LEFT OUTER JOIN
		              (SELECT A.PBNCD_NO AS PBNCD_NO,
		                      SUM(A.RPAY_AMOUNT) AS RPAY_AMOUNT,
		       <isNotEqual property="PRT_KND" compareValue="4">
			       <isEqual property="PRT_GBN2" compareValue="Y">
			         <![CDATA[
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,4) <= #SEARCH_YEAR#   THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,4) <= #SEARCH_YEAR#   THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG0,
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,4) <= #SEARCH_YEAR#+1 THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,4) <= #SEARCH_YEAR#+1 THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG1,
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,4) <= #SEARCH_YEAR#+2 THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,4) <= #SEARCH_YEAR#+2 THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG2,
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,4) <= #SEARCH_YEAR#+3 THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,4) <= #SEARCH_YEAR#+3 THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG3,
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,4) <= #SEARCH_YEAR#+4 THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,4) <= #SEARCH_YEAR#+4 THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG4,
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,4) <= #SEARCH_YEAR#+5 THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,4) <= #SEARCH_YEAR#+5 THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG5,
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,4) <= #SEARCH_YEAR#+6 THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,4) <= #SEARCH_YEAR#+6 THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG6,
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,4) <= #SEARCH_YEAR#+7 THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,4) <= #SEARCH_YEAR#+7 THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG7,
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,4) <= #SEARCH_YEAR#+8 THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,4) <= #SEARCH_YEAR#+8 THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG8,
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,4) <= #SEARCH_YEAR#+9 THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,4) <= #SEARCH_YEAR#+9 THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG9,
			                     0 AS INTR_RPAY_AG10,0 AS INTR_RPAY_AG11,0 AS INTR_RPAY_AG12,0 AS INTR_RPAY_AG13,0 AS INTR_RPAY_AG14,
			                     0 AS INTR_RPAY_AG15,0 AS INTR_RPAY_AG16,0 AS INTR_RPAY_AG17,0 AS INTR_RPAY_AG18,0 AS INTR_RPAY_AG19 
			         ]]>
			       </isEqual>
			       <isEqual property="PRT_GBN2" compareValue="Q">
			         <![CDATA[
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#  ||'03' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#  ||'03' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG0, 
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#  ||'06' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#  ||'06' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG1, 
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#  ||'09' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#  ||'09' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG2, 
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#  ||'12' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#  ||'12' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG3, 
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+1||'03' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+1||'03' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG4, 
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+1||'06' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+1||'06' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG5, 
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+1||'09' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+1||'09' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG6, 
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+1||'12' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+1||'12' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG7, 
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+2||'03' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+2||'03' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG8, 
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+2||'06' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+2||'06' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG9, 
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+2||'09' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+2||'09' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG10,
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+2||'12' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+2||'12' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG11,
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+3||'03' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+3||'03' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG12,
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+3||'06' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+3||'06' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG13,
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+3||'09' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+3||'09' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG14,
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+3||'12' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+3||'12' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG15,
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+4||'03' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+4||'03' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG16,
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+4||'06' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+4||'06' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG17,
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+4||'09' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+4||'09' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG18,
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#+4||'12' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#+4||'12' THEN A.RPAY_AMOUNT ELSE 0 END) ELSE SUM(A.RPAY_AMOUNT) END AS INTR_RPAY_AG19 
			         ]]>
			       </isEqual>
			       <isEqual property="PRT_GBN2" compareValue="M">
			         <![CDATA[
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'01' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'01' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END INTR_RPAY_AG0, 
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'02' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'02' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END INTR_RPAY_AG1, 
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'03' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'03' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END INTR_RPAY_AG2, 
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'04' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'04' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END INTR_RPAY_AG3, 
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'05' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'05' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END INTR_RPAY_AG4, 
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'06' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'06' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END INTR_RPAY_AG5, 
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'07' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'07' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END INTR_RPAY_AG6, 
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'08' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'08' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END INTR_RPAY_AG7, 
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'09' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'09' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END INTR_RPAY_AG8, 
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'10' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'10' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END INTR_RPAY_AG9, 
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'11' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'11' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END INTR_RPAY_AG10,
			                     CASE WHEN SUBSTR(MAX(B.BRRW_DE),1,6) <= #SEARCH_YEAR#||'12' THEN SUM(CASE WHEN SUBSTR(A.RPAY_DE,1,6) <= #SEARCH_YEAR#||'12' THEN A.RPAY_AMOUNT ELSE 0 END) AS ELSE SUM(A.RPAY_AMOUNT) END INTR_RPAY_AG11,
			                     0 AS INTR_RPAY_AG12,0 AS INTR_RPAY_AG13,0 AS INTR_RPAY_AG14,0 AS INTR_RPAY_AG15,
			                     0 AS INTR_RPAY_AG16,0 AS INTR_RPAY_AG17,0 AS INTR_RPAY_AG18,0 AS INTR_RPAY_AG19 
			         ]]>
			       </isEqual>
		       </isNotEqual>
		       <isEqual property="PRT_KND" compareValue="4">
			       <isEqual property="PRT_GBN2" compareValue="Y">
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#    THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG0,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+1  THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG1,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+2  THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG2,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+3  THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG3,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+4  THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG4,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+5  THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG5,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+6  THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG6,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+7  THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG7,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+8  THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG8,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+9  THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG9,
			                     0 AS INTR_RPAY_AG10,0 AS INTR_RPAY_AG11,0 AS INTR_RPAY_AG12,0 AS INTR_RPAY_AG13,0 AS INTR_RPAY_AG14,
			                     0 AS INTR_RPAY_AG15,0 AS INTR_RPAY_AG16,0 AS INTR_RPAY_AG17,0 AS INTR_RPAY_AG18,0 AS INTR_RPAY_AG19
			       </isEqual>
			       <isEqual property="PRT_GBN2" compareValue="Q">
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#   AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '1' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG0,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#   AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '2' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG1,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#   AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '3' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG2,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#   AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '4' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG3,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+1 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '1' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG4,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+1 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '2' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG5,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+1 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '3' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG6,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+1 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '4' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG7,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+2 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '1' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG8,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+2 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '2' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG9,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+2 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '3' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG10,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+2 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '4' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG11,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+3 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '1' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG12,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+3 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '2' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG13,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+3 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '3' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG14,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+3 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '4' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG15,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+4 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '1' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG16,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+4 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '2' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG17,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+4 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '3' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG18,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,4) = #SEARCH_YEAR#+4 AND TO_CHAR(TO_DATE(MAX(B.EXPRTN_DE), 'YYYYMMDD'),'Q') = '4' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG19
			       </isEqual>
			       <isEqual property="PRT_GBN2" compareValue="M">
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'01' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG0,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'02' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG1,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'03' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG2,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'04' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG3,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'05' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG4,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'06' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG5,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'07' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG6,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'08' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG7,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'09' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG8,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'10' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG9,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'11' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG10,
			                     CASE WHEN SUBSTR(MAX(B.EXPRTN_DE),1,6) = #SEARCH_YEAR#||'12' THEN SUM(A.RPAY_AMOUNT) ELSE 0 END AS INTR_RPAY_AG11,
			                     0 AS INTR_RPAY_AG12,0 AS INTR_RPAY_AG13,0 AS INTR_RPAY_AG14,0 AS INTR_RPAY_AG15,
			                     0 AS INTR_RPAY_AG16,0 AS INTR_RPAY_AG17,0 AS INTR_RPAY_AG18,0 AS INTR_RPAY_AG19
			       </isEqual>
		       </isEqual>
		                FROM TBFUN_PBNCD_INTR_RPAY_PLAN A
		                LEFT OUTER JOIN TBFUN_PBNCD B
		                        ON A.PBNCD_NO = B.PBNCD_NO
		               GROUP BY A.PBNCD_NO
		              )E
		              ON A.PBNCD_NO = E.PBNCD_NO
		        WHERE SUBSTR(A.EXPRTN_DE,1,4) <![CDATA[>=]]> #SEARCH_YEAR# 
		       <isEqual property="PRT_KND" compareValue="1">
		        GROUP BY SUBSTR(A.CPTAL_KND,1,1), A.BSNS_CODE, A.FNNC_INSTT_SPOT_CODE
		       </isEqual>
		       <isEqual property="PRT_KND" compareValue="2">
		        GROUP BY A.BSNS_CODE, SUBSTR(A.CPTAL_KND,1,1), A.FNNC_INSTT_SPOT_CODE
		       </isEqual>
		       <isEqual property="PRT_KND" compareValue="3">
		        GROUP BY A.FNNC_INSTT_SPOT_CODE, SUBSTR(A.CPTAL_KND,1,1), A.BSNS_CODE
		       </isEqual>
		       <isEqual property="PRT_KND" compareValue="4">
		       GROUP BY SUBSTR(A.CPTAL_KND,1,1)
		       </isEqual>
		       ) B
		       <isNotEqual property="PRT_KND" compareValue="4">
		       LEFT OUTER JOIN
		       TBACC_FNNC_INSTT_CODE C
		       ON B.FNNC_INSTT_SPOT_CODE = C.FNNC_INSTT_CODE
		       LEFT OUTER JOIN
		       TBPRJ_BSNS_CODE D
		       ON B.BSNS_CODE = D.BSNS_CODE
		       </isNotEqual>
		       LEFT OUTER JOIN
		       (SELECT CODE,
		              CODE_NM
		         FROM TBFUN_CPTAL_CODE
		        WHERE CODE_SE = '000'
		       ) E
		       ON B.CPTAL_KND = E.CODE
		       <isNotEqual property="PRT_KND" compareValue="4">
		 ORDER BY NM1, NM2, NM3  
		       </isNotEqual>
		       <isEqual property="PRT_KND" compareValue="4">
		 ORDER BY NM1
		       </isEqual>  
    </select>

	<!-- 차입금 만기현황(년도별) 조회 -->
	<select id="FUN020201DAO.selectYearBrrwSmrizeList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[	
			SELECT  A.CODE              AS CPTAL_KND
			        ,A.CODE_NM          AS CPTAL_KND_NM
			        ,NVL(B.PRNCPAL1,0)  AS PRNCPAL1
			        ,NVL(B.PRNCPAL2,0)  AS PRNCPAL2
			        ,NVL(B.PRNCPAL3,0)  AS PRNCPAL3
			        ,NVL(B.PRNCPAL4,0)  AS PRNCPAL4
			        ,NVL(B.PRNCPAL5,0)  AS PRNCPAL5
			        ,NVL(B.PRNCPAL6,0)  AS PRNCPAL6
			        ,NVL(B.PRNCPAL7,0)  AS PRNCPAL7
			        ,NVL(B.PRNCPAL8,0)  AS PRNCPAL8
			        ,NVL(B.PRNCPAL9,0)  AS PRNCPAL9
			        ,NVL(B.PRNCPAL10,0) AS PRNCPAL10
			        ,NVL(B.PRNCPAL11,0) AS PRNCPAL11
			        ,NVL(B.PRNCPAL12,0) AS PRNCPAL12
			FROM    (SELECT CODE, CODE_NM
                     FROM TBFUN_CPTAL_CODE
                     WHERE CODE_SE = '000'
			        ) A
			        LEFT OUTER JOIN (SELECT  A.CPTAL_KND AS CPTAL_KND
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 1, 4) = SUBSTR(#SEARCH_YEAR#,1,4) AND TO_CHAR(TO_DATE(A.EXPRTN_DE, 'YYYYMMDD'),'Q') = '1' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL1
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 1, 4) = SUBSTR(#SEARCH_YEAR#,1,4) AND TO_CHAR(TO_DATE(A.EXPRTN_DE, 'YYYYMMDD'),'Q') = '2' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL2
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 1, 4) = SUBSTR(#SEARCH_YEAR#,1,4) AND TO_CHAR(TO_DATE(A.EXPRTN_DE, 'YYYYMMDD'),'Q') = '3' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL3
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 1, 4) = SUBSTR(#SEARCH_YEAR#,1,4) AND TO_CHAR(TO_DATE(A.EXPRTN_DE, 'YYYYMMDD'),'Q') = '4' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL4
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 1, 4) = SUBSTR(#SEARCH_YEAR#,1,4)+1 AND TO_CHAR(TO_DATE(A.EXPRTN_DE, 'YYYYMMDD'),'Q') = '1' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL5
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 1, 4) = SUBSTR(#SEARCH_YEAR#,1,4)+1 AND TO_CHAR(TO_DATE(A.EXPRTN_DE, 'YYYYMMDD'),'Q') = '2' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL6
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 1, 4) = SUBSTR(#SEARCH_YEAR#,1,4)+1 AND TO_CHAR(TO_DATE(A.EXPRTN_DE, 'YYYYMMDD'),'Q') = '3' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL7
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 1, 4) = SUBSTR(#SEARCH_YEAR#,1,4)+1 AND TO_CHAR(TO_DATE(A.EXPRTN_DE, 'YYYYMMDD'),'Q') = '4' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL8
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 1, 4) = SUBSTR(#SEARCH_YEAR#,1,4)+2 AND TO_CHAR(TO_DATE(A.EXPRTN_DE, 'YYYYMMDD'),'Q') = '1' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL9
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 1, 4) = SUBSTR(#SEARCH_YEAR#,1,4)+2 AND TO_CHAR(TO_DATE(A.EXPRTN_DE, 'YYYYMMDD'),'Q') = '2' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL10
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 1, 4) = SUBSTR(#SEARCH_YEAR#,1,4)+2 AND TO_CHAR(TO_DATE(A.EXPRTN_DE, 'YYYYMMDD'),'Q') = '3' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL11
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 1, 4) = SUBSTR(#SEARCH_YEAR#,1,4)+2 AND TO_CHAR(TO_DATE(A.EXPRTN_DE, 'YYYYMMDD'),'Q') = '4' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL12     
			                         FROM    TBFUN_PBNCD A
			                         WHERE   SUBSTR(A.EXPRTN_DE, 1, 4) >= SUBSTR(#SEARCH_YEAR#,1,4)
			                           AND   SUBSTR(A.EXPRTN_DE, 1, 4) <= SUBSTR(#SEARCH_YEAR#,1,4)+2
			                         GROUP BY A.CPTAL_KND
			                        ) B
			                     ON A.CODE = SUBSTR(B.CPTAL_KND,1,1)
			ORDER BY A.CODE
	    ]]>
    </select>
    
	<!-- 차입금 만기현황(월별) 조회 -->
	<select id="FUN020201DAO.selectMonthBrrwSmrizeList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[	
			SELECT  A.CODE              AS CPTAL_KND
			        ,A.CODE_NM          AS CPTAL_KND_NM
			        ,NVL(B.PRNCPAL1,0)  AS PRNCPAL1
			        ,NVL(B.PRNCPAL2,0)  AS PRNCPAL2
			        ,NVL(B.PRNCPAL3,0)  AS PRNCPAL3
			        ,NVL(B.PRNCPAL4,0)  AS PRNCPAL4
			        ,NVL(B.PRNCPAL5,0)  AS PRNCPAL5
			        ,NVL(B.PRNCPAL6,0)  AS PRNCPAL6
			        ,NVL(B.PRNCPAL7,0)  AS PRNCPAL7
			        ,NVL(B.PRNCPAL8,0)  AS PRNCPAL8
			        ,NVL(B.PRNCPAL9,0)  AS PRNCPAL9
			        ,NVL(B.PRNCPAL10,0) AS PRNCPAL10
			        ,NVL(B.PRNCPAL11,0) AS PRNCPAL11
			        ,NVL(B.PRNCPAL12,0) AS PRNCPAL12
			FROM    (SELECT CODE, CODE_NM
                     FROM TBFUN_CPTAL_CODE
                     WHERE CODE_SE = '000'
			        ) A
			        LEFT OUTER JOIN (SELECT  A.CPTAL_KND AS CPTAL_KND
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 5, 2) = '01' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL1
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 5, 2) = '02' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL2
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 5, 2) = '03' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL3
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 5, 2) = '04' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL4
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 5, 2) = '05' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL5
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 5, 2) = '06' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL6
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 5, 2) = '07' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL7
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 5, 2) = '08' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL8
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 5, 2) = '09' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL9
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 5, 2) = '10' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL10
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 5, 2) = '11' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL11
			                                 ,SUM(CASE WHEN SUBSTR(A.EXPRTN_DE, 5, 2) = '12' THEN NVL(A.BRRW_AMOUNT,0)ELSE 0 END) AS PRNCPAL12     
			                         FROM    TBFUN_PBNCD A
			                         WHERE   SUBSTR(A.EXPRTN_DE, 1, 4) = SUBSTR(#SEARCH_YEAR#,1,4)
			                         GROUP BY A.CPTAL_KND
			                        ) B
			                     ON A.CODE = SUBSTR(B.CPTAL_KND,1,1)
			ORDER BY A.CODE
	    ]]>
    </select>	

</sqlMap>