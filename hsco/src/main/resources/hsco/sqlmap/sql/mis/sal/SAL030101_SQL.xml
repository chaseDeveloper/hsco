<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="SAL030101_SQL">	


	<parameterMap id="SAL030101DAO.salaryCalcMap" class="java.util.HashMap">
		<parameter property="PYMNT_YM"      jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="SN"          	jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="JSSFC_SE"      jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="PYMNT_DE"      jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="S_USER_ID"     jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="CNT"        	jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
		<parameter property="ERROR"        	jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	</parameterMap>
	
	<!-- 급여 계산 -->
	<procedure id="SAL030101DAO.salaryCalc" parameterMap="SAL030101DAO.salaryCalcMap">
		{ CALL PKG_SAL_급여계산.SPSAL_급여계산(?, ?, ?, '1', NULL, ?, ?, ?, ?) }
	</procedure>
	
	<!-- 급여 삭제 -->
	<delete id="SAL030101DAO.deleteMtSalaryDtls" parameterClass="java.util.HashMap">
		DELETE FROM TBSAL_MT_SALARY_DTLS t1
		WHERE t1.PYMNT_YM 	= #PYMNT_YM#
		  AND t1.SN			= #SN#
		  AND EXISTS (
		  	SELECT 1
		  	FROM TBHRM_HR_MASTR t2
		  	WHERE t2.JSSFC_SE  	= #JSSFC_SE#
		  	  AND t1.EMPNO 		= t2.EMPNO
		  )
		  AND EXISTS (
		  	SELECT 1
		  	FROM TBSAL_MT_SALARY_CALC t3
		  	WHERE t1.PYMNT_YM 	= t3.PYMNT_YM
		  	  AND t1.SN			= t3.SN
		  	  AND t3.CLOS_AT	<![CDATA[<>]]> '1'
		  )
	</delete>
	
	<delete id="SAL030101DAO.deleteMtSalaryPymnt" parameterClass="java.util.HashMap">
		DELETE FROM TBSAL_MT_SALARY_PYMNT t1
		WHERE t1.PYMNT_YM 	= #PYMNT_YM#
		  AND t1.SN			= #SN#
		  AND EXISTS (
		  	SELECT 1
		  	FROM TBHRM_HR_MASTR t2
		  	WHERE t2.JSSFC_SE  	= #JSSFC_SE#
		  	  AND t1.EMPNO 		= t2.EMPNO
		  )
		  AND EXISTS (
		  	SELECT 1
		  	FROM TBSAL_MT_SALARY_CALC t3
		  	WHERE t1.PYMNT_YM 	= t3.PYMNT_YM
		  	  AND t1.SN			= t3.SN
		  	  AND t3.CLOS_AT	<![CDATA[<>]]> '1'
		  ) 
	</delete>
	

	<!-- 급여계산 내역 -->
	<select id="SAL030101DAO.selectSalaryCalList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
			 PYMNT_YM
			,SN
			,PYMNT_DE
			,CLOS_AT
		FROM TBSAL_MT_SALARY_CALC
		WHERE PYMNT_YM LIKE #PYMNT_YR# ||'%' 
	</select>
	
	<insert id="SAL030101DAO.insertSalaryCal" parameterClass="java.util.HashMap">
		INSERT INTO TBSAL_MT_SALARY_CALC
		(
			 PYMNT_YM
			,SN
			,PYMNT_DE
			,CLOS_AT
			,REGISTER_ID
			,REGIST_DT
			,UPDUSR_ID
			,UPDT_DT
		) VALUES (
			 #PYMNT_YM#
			,#SN#
			,#PYMNT_DE#
			,NVL(#CLOS_AT#,'0')
			,#S_USER_ID#
			,SYSDATE
			,#S_USER_ID#
			,SYSDATE
		)
	</insert>
	
	<update id="SAL030101DAO.updateSalaryCal" parameterClass="java.util.HashMap">
		UPDATE TBSAL_MT_SALARY_CALC
		SET
			 PYMNT_DE	= #PYMNT_DE#
			,CLOS_AT	= #CLOS_AT#
			,UPDUSR_ID	= #S_USER_ID#
			,UPDT_DT	= SYSDATE
		WHERE PYMNT_YM  = #PYMNT_YM#
		  AND SN 		= #SN#
	</update>
	
	<delete id="SAL030101DAO.deleteSalaryCal" parameterClass="java.util.HashMap">
		DELETE FROM TBSAL_MT_SALARY_CALC
		WHERE PYMNT_YM  = #PYMNT_YM#
		  AND SN 		= #SN#
	</delete>
	
	<!-- 직종구분 -->
	<select id="SAL030101DAO.selectJssfcSeList" resultClass="java.util.HashMap">
		SELECT 
		     t1.CODE 			AS JSSFC_SE
		    ,t1.CODE_NM 		AS JSSFC_NM
		    ,'0'			 	AS CHK
		FROM TBCOM_CMMN_CODE t1
		     LEFT OUTER JOIN
		     (SELECT JSSFC_SE, '1' AS CHK
		      FROM TBSAL_MT_SALARY_IEM
		      WHERE PYMNT_YM 	= #PYMNT_YM#
		        AND SN 			= #SN#
		      GROUP BY JSSFC_SE) t2
		     ON t1.CODE = t2.JSSFC_SE
		WHERE GRP_CODE 	= 'HRM001'
		  AND USE_AT 	= '1'
		ORDER BY t1.CODE_ORDR
	</select>
	
	<!-- 급여항목 -->
	<select id="SAL030101DAO.selectSalaryIemList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
			 t3.PYMNT_YM		  AS PYMNT_YM
			,t3.SN				  AS SN
		    ,t2.CODE              AS JSSFC_SE
		    ,t2.CODE_NM           AS JSSFC_NM
		    ,t1.PYMNT_DDC_CODE
		    ,t1.PYMNT_DDC_CODE_NM
		    ,t1.PYMNT_DDC_SE
		    ,t1.OUTPT_ORDR
		    ,NVL(t3.CALC_AT,'0') AS CALC_AT
		    ,DECODE(t3.PYMNT_DDC_CODE,NULL,'0','1') AS CHK
		    ,CASE t2.CODE WHEN '01' THEN NVL(EXCTV_AT,'0')
                      WHEN '02' THEN NVL(POIGS_AT,'0')
                      WHEN '03' THEN NVL(PSDP_AT,'0')
                      WHEN '04' THEN NVL(CNTTK_AT,'0')
                      WHEN '05' THEN NVL(FCLTY_MANAGE_AT,'0')
                      WHEN '06' THEN NVL(INSTR_AT,'0')
                      WHEN '07' THEN '0'
                      WHEN '08' THEN NVL(DSPTC_AT,'0')
                      WHEN '09' THEN NVL(TMPR_AT,'0')
                      WHEN '103' THEN NVL(CRW_AT,'0')  /*운수직*/
                      ELSE '0'
         	 END AS DFLT
		FROM TBSAL_PYMNT_DDC_STDR_CODE t1
		     INNER JOIN TBCOM_CMMN_CODE t2 
		     ON t2.GRP_CODE = 'HRM001'
		     LEFT OUTER JOIN TBSAL_MT_SALARY_IEM t3
		     ON  t2.CODE 			= t3.JSSFC_SE
		     AND t1.PYMNT_DDC_CODE 	= t3.PYMNT_DDC_CODE
		     AND t3.PYMNT_YM 		= #PYMNT_YM#
		     AND t3.SN 				= #SN#
		WHERE t1.PYMNT_DDC_SE		= #PYMNT_DDC_SE#
		ORDER BY t2.CODE, t1.PYMNT_DDC_SE, t1.OUTPT_ORDR
	</select>
	
	<!-- 급여계산 결과 -->
	<select id="SAL030101DAO.selectSalaryRsltList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		WITH MT_SALARY_T AS (
		    SELECT
		    	 PYMNT_YM
        		,SN
		        ,JSSFC_SE
		        ,COUNT(1) AS CNT
		        ,SUM(PYMNT_AMT) AS PYMNT_AMT
		        ,SUM(DDC_AMT) AS DDC_AMT
		        ,SUM(TOT_AMT) AS TOT_AMT
		    FROM (
		          SELECT 
		          	   t1.PYMNT_YM
              		  ,t1.SN
		              ,t3.JSSFC_SE
		              ,t1.EMPNO
		              ,SUM(DECODE(t2.PYMNT_DDC_SE,0,t1.AMOUNT,0)) AS PYMNT_AMT
		              ,SUM(DECODE(t2.PYMNT_DDC_SE,1,t1.AMOUNT,0)) AS DDC_AMT
		              ,SUM(DECODE(t2.PYMNT_DDC_SE,0,1,-1) * t1.AMOUNT) AS TOT_AMT
		          FROM TBSAL_MT_SALARY_DTLS t1
		               INNER JOIN TBSAL_PYMNT_DDC_STDR_CODE t2
		               ON t1.PYMNT_DDC_CODE = t2.PYMNT_DDC_CODE
		               INNER JOIN TBHRM_HR_MASTR t3
		               ON t1.EMPNO = t3.EMPNO
		          WHERE t1.PYMNT_YM = #PYMNT_YM#
		            AND t1.SN 		= #SN#
		          GROUP BY t1.PYMNT_YM, t1.SN, t3.JSSFC_SE, t1.EMPNO
		         )
		    GROUP BY PYMNT_YM, SN, JSSFC_SE
		)
		SELECT
			 t1.PYMNT_YM
    		,t1.SN
		    ,t1.JSSFC_SE
		    ,t2.CODE_NM AS JSSFC_NM
		    ,t1.CNT
		    ,t1.PYMNT_AMT
		    ,t1.DDC_AMT
		    ,t1.TOT_AMT
		FROM MT_SALARY_T t1
		     LEFT OUTER JOIN TBCOM_CMMN_CODE t2
		     ON  t2.GRP_CODE = 'HRM001'
		     AND t1.JSSFC_SE = t2.CODE
		ORDER BY t2.CODE_ORDR
	</select>

	<!-- 급여항목 등록 -->
	<insert id="SAL030101DAO.insertMtSalaryIem" parameterClass="java.util.HashMap">
		MERGE INTO TBSAL_MT_SALARY_IEM
		USING DUAL
		ON (PYMNT_YM = #PYMNT_YM# AND SN = #SN# AND JSSFC_SE = #JSSFC_SE# AND PYMNT_DDC_CODE = #PYMNT_DDC_CODE#)
		WHEN MATCHED THEN
			UPDATE
			SET	  CALC_AT 	= #CALC_AT#
				 ,UPDUSR_ID	= #S_USER_ID#
				 ,UPDT_DT	= SYSDATE
			WHERE PYMNT_YM 	= #PYMNT_YM# 
			  AND SN 		= #SN# 
			  AND JSSFC_SE = #JSSFC_SE# 
			  AND PYMNT_DDC_CODE = #PYMNT_DDC_CODE#
		WHEN NOT MATCHED THEN
			INSERT
			(
				 PYMNT_YM
				,SN
				,JSSFC_SE
				,PYMNT_DDC_CODE
				,CALC_AT
				,REGISTER_ID
				,REGIST_DT
				,UPDUSR_ID
				,UPDT_DT
			) VALUES (
				 #PYMNT_YM#
				,#SN#
				,#JSSFC_SE#
				,#PYMNT_DDC_CODE#
				,#CALC_AT#
				,#S_USER_ID#
				,SYSDATE
				,#S_USER_ID#
				,SYSDATE
			)
	</insert>
	
	<!-- 급여항목 삭제 -->
	<delete id="SAL030101DAO.deleteMtSalaryIem" parameterClass="java.util.HashMap">
		DELETE FROM TBSAL_MT_SALARY_IEM
		WHERE PYMNT_YM 			= #PYMNT_YM#
		  AND SN 				= #SN#
		  AND JSSFC_SE			= #JSSFC_SE#
		  AND PYMNT_DDC_CODE 	= #PYMNT_DDC_CODE#
	</delete>
	
	<!-- 급여항목 전체삭제 -->
	<delete id="SAL030101DAO.deleteAllMtSalaryIem" parameterClass="java.util.HashMap">
		DELETE FROM TBSAL_MT_SALARY_IEM
		WHERE PYMNT_YM 	= #PYMNT_YM#
		  AND SN 		= #SN#
	</delete>
	
	
	<!-- 월급여데이터생성정보 목록조회 -->
	<select id="SAL030101DAO.selectMtSalaryCreatList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
	        SELECT 
				   A.PYMNT_YM
				  ,A.SALARY_SE 
				  ,A.PYMNT_SE
				  ,A.PYMNT_DE
				  ,A.PYMNT_NMPR
				  ,A.DCSN_AT
				  ,A.DCSN_DE
				  ,A.CALC_TOTAMT
				  ,A.DDC_TOTAMT
				  ,A.RL_RECPT_AMOUNT
				  ,A.OPERTOR
				  ,SFSAL_GETEMPNO_01(A.OPERTOR) AS OPERTOR_NM				 
			FROM TBSAL_MT_SALARY_CREAT A		
			WHERE 1=1
			AND SUBSTR(A.PYMNT_YM,1,4) = SUBSTR(#PYMNT_YM#,1,4)
			ORDER BY A.PYMNT_YM DESC , A.PYMNT_DE DESC
    </select> 
    
    <!-- 월급여데이터내역정보 목록조회 -->
	<select id="SAL030101DAO.selectMtSalaryPymntList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
	        SELECT 
				   A.PYMNT_YM
				  ,A.PYMNT_SE
				  ,A.PYMNT_DE
				  ,A.DCSN_AT
				  ,A.DCSN_DE				  
			FROM TBSAL_MT_SALARY_CREAT A		
			WHERE 1=1
			AND A.PYMNT_YM 	= #PYMNT_YM#
			AND A.SALARY_SE = #SALARY_SE#	
			AND A.PYMNT_SE 	= #PYMNT_SE#
		<isNotEmpty property="DCSN_AT">
			AND A.DCSN_AT 	= #DCSN_AT#
		</isNotEmpty>
    </select> 

    <!-- 월급여데이터생성- 마스터기초생성 -->
    <insert id="SAL030101DAO.MtSalaryPymntC" parameterClass="java.util.HashMap">
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_SALARY_PYMNT
			       (
			              PYMNT_YM         /* 지급년월  */
			            , SALARY_SE        /* 급여구분  */
			            , PYMNT_SE         /* 지급구분  */
			            , PYMNT_DE         /* 지급일자 */
			            , EMPNO            /* 사번 */
			            , EMPNM            /* 사원명 */
			            , EMPL_SE          /* 사원구분 */
			            , ANSLRY_AT        /* 연봉여부 */
			            , DEPT_CODE        /* 부서코드 */
			            , DEPT_NM          /* 부서명 */
			            , PRMPC_SE         /* 원가구분 */
			            , RSPOFC_SE        /* 직책구분 */
			            , CLSF_CODE        /* 직급코드 */
			            , SRCLS            /* 호봉 */
			            , ECNY_DE          /* 입사일자 */
			            , RETIRE_DE        /* 퇴사일자 */
			            , STDR_DE     		/* 호봉승급일 */
			            , CLSF_PRMOT_DE     /* 직급승진일 */
			            , DCLZ_SE           /* 근태구분 */
			            , BGNDE             /* 시작일 */
			            , ENDDE             /* 종료일 */
			            , LBUN_SBSCRB_SE    /* 노조가입구분 */
			            , TRTMT_EMP_AT      /* 대우직원여부 */
			            , DSPSN_GRAD        /* 장애자등급 */
			            , WORK_STTUS        /* 근무상태 */
			            , MT_DAYCNT         /* 월일수 */
			            , NTHG_PLAN_ABSENC_DAYCNT  /* 무계획결근일수 */
			            , ABSENC_DAYCNT     /* 결근일수 */
			            , LATEN_DAYCNT      /* 지각일수 */
			            , SLYRD_RT          /* 감봉율 */
			            , LAYOFF_SALARY_RT           /* 휴직급여율 */
			            , INDVDL_PRICEWAGE_PYMNT_RT  /* 개인성과급지급율 */
			            , SEIZR_AT             /* 압류여부 */
			            , HN_DDC_NMPR          /* 인적공제인원 */
			            , HN_DDC_NMPR20    	   /* 인적공제인원20세이하*/
			            , TIME__ELSE_TIME      /* 시간외시간 */
			            , NIGHT_LABOR_TIME     /* 야간근로시간 */
			            , RESTDE_LABOR_TIME    /* 휴일근로시간 */
			            , YEAST_HLDY_RCOGN     /* 국공휴일인정 */
			            , SALARY_BANK_CODE     /* 급여은행코드 */
			            , SALARY_BANK_ACNUT    /* 급여은행계좌 */
			            , ALLWNC_BANK_CODE     /* 수당은행코드 */
			            , ALLWNC_BANK_ACNUT    /* 수당은행계좌 */
			            , BSLRY                /* 기본급 */
			            , BSLRY_EXCCLC         /* 기본급정산 */
			            , CNSTRC_ALLWNC        /* 건설수당 */
			            , INORG_CNWK_ALLWNC    /* 장기근속수당 */
			            , TCHNLGY_ALLWNC       /* 기술수당 */
			            , FAMILY_ALLWNC        /* 가족수당 */
			            , SPCL_JOB_ALLWNC      /* 특수업무수당 */
			            , SPCIFY_JOB_EXC       /* 특정업무수행 */
			            , DRV_ALLWNC           /* 운전수당 */
			            , RISK_ALLWNC          /* 위험수당 */
			            , TRTMNT_ALLWNC        /* 대우수당 */
			            , YRYC_ALLWNC          /* 연차수당 */
			            , SCHXPN_SBSIDY        /* 학자금보조비 */
			            , INCNTV_PRICEWAGE     /* 인센티브성과급 */
			            , BUDGET_PRICEWAGE     /* 예산성과급 */
			            , DTY_ALLWNC           /* 직무수당 */
			            , TIME__ELSE_ALLWNC    /* 시간외수당 */
			            , MLSV_SBSIDY          /* 급식보조비 */
			            , RSPOFC_SBSIDY        /* 직책보조비 */
			            , TRNSPORT_SBSIDY      /* 교통보조비 */
			            , JOB_PRTN_TRVCT       /* 업무추진여비 */
			            , SPT_SYSM_CT          /* 현장체제비 */
			            , MNG_ALLWNC           /* 감독수당 */
			            , MANAGE_JOB_ALLWNC    /* 관리업무수당 */
			            , RESTDE_ALLWNC        /* 휴일수당 */
			            , INFANT_NRTR_CT       /* 영유아보육비 */
			            , ETC_ALLWNC           /* 기타수당 */
			            , ALLWNC_EXCCLC        /* 수당정산 */
			            , SALARY_PYMNT_TOTAMT  /* 급여지급총액 */
			            , ALLWNC_PYMNT_TOTAMT  /* 수당지급총액 */
			            , TOT_PYMNTAMT         /* 총지급액 */
			            , TAXT_AMOUNT          /* 과세금액 */
			            , TAXXMPT_AMOUNT       /* 비과세금액 */
			            , INCMTAX              /* 소득세 */
			            , LCLTY_INCMTAX        /* 지방소득세 */
			            , HLTHINS              /* 건강보험 */
			            , NPN                  /* 국민연금 */
			            , EMPLYMINSRNC         /* 고용보험 */
			            , ENDW_PRNCPAL         /* 기금원금 */
			            , ENDW_INTR            /* 기금이자 */
			            , MXTR_CT              /* 조합비 */
			            , SRVC_GRP_ENDW        /* 봉사단기금 */
			            , SCHXPN_RPAY          /* 학자금상환 */
			            , YND_EXCCLC           /* 연말정산 */
			            , MENDNG_SEIZR         /* 보수압류 */
			            , INCMTAX_EXCCLC       /* 소득세정산 */
			            , LCLTY_INCMTAX_EXCCLC /* 지방소득세정산 */
			            , HLTHINS_EXCCLC       /* 건강보험정산 */
			            , EMPLYMINSRNC_EXCCLC  /* 고용보험정산 */
			            , DDC_TOTAMT           /* 공제총액 */
			            , ODYGS                /* 통상임금 */
			            , RL_RECPT_AMOUNT      /* 실수령액 */
			            , CLOS_AT              /* 마감여부 */
			            , CLOS_DE              /* 마감일자 */
			            , RM                   /* 비고 */
			            , STDR_ANSLRY          /* 기준연봉 2016.02.19 */
			            , WAGE_PEAK            /* 임금피크 2016.02.19 */
			            , REGISTER_ID          /* 등록자ID */
			            , REGIST_DT            /* 등록일시 */
			            , UPDUSR_ID            /* 수정자ID */
			            , UPDT_DT              /* 수정일시 */
			       )
			SELECT #PYMNT_YM#              /* 지급년월  */
			     , #SALARY_SE#             /* 급여구분  */
			     , #PYMNT_SE#              /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.JSSFC_SE              /* 사원구분 */
			     , (
			              SELECT
			                     CASE COUNT(I.EMPNO)
			                            WHEN 1
			                            THEN 'Y'
			                            ELSE ''
			                     END
			                FROM TBSAL_ANSLRY_INFO I
			               WHERE I.APPLC_DE =
			                     (
			                            SELECT MAX(APPLC_DE)
			                              FROM TBSAL_ANSLRY_INFO
			                             WHERE APPLC_DE <= #PYMNT_DE#
			                     )
			                 AND I.PYMNT_SE = '1'
			                 AND I.EMPNO    = A.EMPNO
			       )               						 /* 연봉여부 */
			     , A.DEPT_CODE                           /* 부서코드 */
			     , SFSAL_GETDEPTNM_01(A.DEPT_CODE)       /* 부서명 */
			     , ''                                    /* 원가구분 */
			     , A.RSPOFC_SE                           /* 직책구분 */
			     , A.PAY_CLSF_SE                         /* 직급코드 */
			     , A.SRCLS                    			 /* 호봉 */
			     /* NVL(A.SRCLS, '01')*/
			     , A.ECNY_DE                             /* 입사일자 */
			     , A.RETIRE_DE                           /* 퇴사일자 */
			     , A.STDR_DE                             /* 기준일자 */
			     , (
			              SELECT MAX(AF.GNFD_DE)
			                FROM TBHRM_GNFD AF
			               WHERE AF.EMPNO = A.EMPNO
			                 AND AF.GNFD_SE IN ('005', '010')
			       )                          			/* 직급승진일 */
			     , (
			              SELECT AA.DCLZ_SE
			                FROM TBHRM_MNBY_DCLZ_DTLS AA
			               WHERE AA.DCLZ_SE                  = '216'    /* 휴직자 제외 */
			                 AND TO_CHAR(AA.BGNDT, 'YYYYMM') = #PYMNT_YM#
			                 AND TO_CHAR(AA.ENDDT, 'YYYYMM') = #PYMNT_YM#
			                 AND AA.EMPNO                    = A.EMPNO
			       )
			       AS DCLZ_SE                    		/* 근태구분 */
			     , (
			              SELECT TO_CHAR(AB.BGNDT, 'YYYYMMDD')
			                FROM TBHRM_MNBY_DCLZ_DTLS AB
			               WHERE AB.DCLZ_SE                  = '216'    /* 휴직자 제외 */
			                 AND TO_CHAR(AB.BGNDT, 'YYYYMM') = #PYMNT_YM#
			                 AND TO_CHAR(AB.ENDDT, 'YYYYMM') = #PYMNT_YM#
			                 AND AB.EMPNO                    = A.EMPNO
			       )
			       AS BGNDE                      		/* 시작일 */
			     , (
			              SELECT TO_CHAR(AC.ENDDT, 'YYYYMMDD')
			                FROM TBHRM_MNBY_DCLZ_DTLS AC
			               WHERE AC.DCLZ_SE                  = '216'    /* 휴직자 제외 */
			                 AND TO_CHAR(AC.BGNDT, 'YYYYMM') = #PYMNT_YM#
			                 AND TO_CHAR(AC.ENDDT, 'YYYYMM') = #PYMNT_YM#
			                 AND AC.EMPNO                    = A.EMPNO
			       )
			       AS ENDDE                      		/* 종료일 */
			     , (
			              SELECT
			                     CASE COUNT(B.EMPNO)
			                            WHEN 1
			                            THEN 'Y'
			                            ELSE ''
			                     END
			                FROM TBHRM_HR_ETC B
			               WHERE B.EMPNO          = A.EMPNO
			                 AND B.LBUN_SBSCRB_AT = '1'
			       )        							/* 노조가입구분 */
			     , (
			              SELECT
			                     CASE COUNT(AD.EMPNO)
			                            WHEN 1
			                            THEN 'Y'
			                            ELSE ''
			                     END
			                FROM TBHRM_HR_MASTR AD
			               WHERE AD.TRTMT_EMP_AT               = '1'
			                 AND SUBSTR(AD.TRTMT_BGNDE, 1, 6) <= #PYMNT_YM#
			                 AND SUBSTR(AD.TRTMT_ENDDE, 1, 6) >= #PYMNT_YM#
			                 AND AD.EMPNO                      = A.EMPNO
			       )                                   	/* 대우직원구분 */
			     , (
			              SELECT C.TROBL_GRAD_SE
			                FROM TBHRM_HR_ETC C
			               WHERE C.EMPNO = A.EMPNO
			       )                               		/* 장애자등급 */
			     , A.STTUS_SE                       	/* 근무상태 */
			     , TO_CHAR(LAST_DAY(TO_DATE(#PYMNT_YM#, 'YYYYMM')), 'DD')       /* 월일수 */
			     , 0     /* 무계획결근일수 */
			     , 0     /* 결근일수 */
			     , 0     /* 지각일수 */
			     , 0     /* 감봉율 */
			     , 0     /* 휴직급여율 */
			     , 0     /* 개인성과급지급율 */
			     , (
			              SELECT
			                     CASE COUNT(DISTINCT D.EMPNO)
			                            WHEN 1
			                            THEN 'Y'
			                            ELSE ''
			                     END
			                FROM TBSAL_MENDNG_SEIZR_TKBAK D
			               WHERE D.TRMNAT_AT = '1'
			                 AND D.EMPNO     = A.EMPNO
			       )      /* 압류여부 */
			     , (
				       (
				              SELECT COUNT(E.EMPNO) AS PER_CNT1    	/* 배우자 공제수 */
				                FROM TBHRM_HR_FAMILY E
				               WHERE E.EMPNO     = A.EMPNO
				                 AND E.SUPORT_AT = '1'
				                 AND E.FAMILY_RELATE_SE IN ('005', '006')
				       )
				       +
				       (
				              SELECT COUNT(E.EMPNO) AS PER_CNT2    	/* 만20세 이하 공제수 */
				                FROM TBHRM_HR_FAMILY E
				               WHERE E.EMPNO     = A.EMPNO
				                 AND E.SUPORT_AT = '1'
				                 AND E.FAMILY_RELATE_SE IN ('007', '008', '009', '010', '011', '012', '015', '016', '037')
				                 AND TO_NUMBER(MONTHS_BETWEEN (LAST_DAY(SYSDATE), TO_DATE(E.BRTHDY, 'YYYYMMDD'))) / 12 < 21
				       )
				       +
				       (
				              SELECT COUNT(E.EMPNO) AS PER_CNT3    	/* 만60세 이상 공제수 */
				                FROM TBHRM_HR_FAMILY E
				               WHERE E.EMPNO     = A.EMPNO
				                 AND E.SUPORT_AT = '1'
				                 AND E.FAMILY_RELATE_SE IN ('001', '002', '003', '004', '013', '014', '017', '018', '035', '036')
				                 AND TO_NUMBER(MONTHS_BETWEEN (LAST_DAY(SYSDATE), TO_DATE(E.BRTHDY, 'YYYYMMDD'))) / 12 > 59
				       )
				       + 1         									/* 본인공제 */
				    )	  	/* 인적공제인원(기본공제(본인), 배우자공제(처/남편), 부양가족공제(20세이하 및 60세 이상) */
			     , (
			              SELECT NVL(COUNT(E2.EMPNO), 0)
			                FROM TBHRM_HR_FAMILY E2
			               WHERE E2.EMPNO     = A.EMPNO
			                 AND E2.SUPORT_AT = '1'
			                 AND E2.FAMILY_RELATE_SE IN ('007', '008', '009', '010', '011', '012', '015', '016', '037')
			                 AND TO_NUMBER(MONTHS_BETWEEN (LAST_DAY(SYSDATE), TO_DATE(E2.BRTHDY, 'YYYYMMDD'))) / 12 < 21
			       ) 	  	/* 인적공제인원20세이하 */
			     , (
			              SELECT F.PYMNT_TIME
			                FROM TBSAL_EXCESS_WORK_DTLS F
			               WHERE F.EMPNO    = A.EMPNO
			                 AND F.PYMNT_YM = #PYMNT_YM#
			       )      	/* 시간외시간 */
			     , 0      	/* 야간근로시간 */
			     , 0      	/* 휴일근로시간 */
			     , 0      	/* 국공휴일인정 */
			     , (
			              SELECT G.SALARY_BANK_CODE
			                FROM TBSAL_EMPL_BANK_ACNUT G
			               WHERE G.EMPNO = A.EMPNO
			       )  		/* 급여은행코드 */
			     , (
			              SELECT G2.SALARY_BANK_ACNUT
			                FROM TBSAL_EMPL_BANK_ACNUT G2
			               WHERE G2.EMPNO = A.EMPNO
			       )        /* 급여은행계좌 */
			     , (
			              SELECT G3.ALLWNC_BANK_CODE
			                FROM TBSAL_EMPL_BANK_ACNUT G3
			               WHERE G3.EMPNO = A.EMPNO
			       )        /* 수당은행코드 */
			     , (
			              SELECT G4.ALLWNC_BANK_ACNUT
			                FROM TBSAL_EMPL_BANK_ACNUT G4
			               WHERE G4.EMPNO = A.EMPNO
			       )        /* 수당은행계좌 */
			     , (
			              SELECT H.BASS_AMOUNT
			                FROM TBSAL_SLARY_TABLE H
			               WHERE H.APPLC_DE =
			                     (
			                            SELECT MAX(APPLC_DE)
			                              FROM TBSAL_SLARY_TABLE
			                             WHERE APPLC_DE <= #PYMNT_DE#
			                     )
			                 AND H.EMPL_SE   = A.JSSFC_SE
			                 AND H.CLSF_CODE = A.PAY_CLSF_SE
			                 AND H.SRCLS     = A.SRCLS
			       )      /* 기본급 */
			     , 0      /* 기본급정산 */
			     , 0      /* 건설수당 */
			     , 0      /* 장기근속수당 */
			     , 0      /* 기술수당 */
			     , 0      /* 가족수당 */
			     , 0      /* 특수업무수당 */
			     , 0      /* 특정업무수행 */
			     , 0      /* 운전수당 */
			     , 0      /* 위험수당 */
			     , 0      /* 대우수당 */
			     , 0      /* 연차수당 */
			     , 0      /* 학자금보조비 */
			     , 0      /* 인센티브성과급 */
			     , 0      /* 예산성과급 */
			     , 0      /* 직무수당 */
			     , 0      /* 시간외수당 */
			     , 0      /* 급식보조비 */
			     , 0      /* 직책보조비 */
			     , 0      /* 교통보조비 */
			     , 0      /* 업무추진여비 */
			     , 0      /* 현장체제비 */
			     , 0      /* 감독수당 */
			     , 0      /* 관리업무수당 */
			     , 0      /* 휴일수당 */
			     , 0      /* 영유아보육비 */
			     , 0      /* 기타수당 */
			     , 0      /* 수당정산 */
			     , 0      /* 급여지급총액 */
			     , 0      /* 수당지급총액 */
			     , 0      /* 총지급액 */
			     , 0      /* 과세금액 */
			     , 0      /* 비과세금액 */
			     , 0      /* 소득세 */
			     , 0      /* 지방소득세 */
			     , 0      /* 건강보험 */
			     , 0      /* 국민연금 */
			     , 0      /* 고용보험 */
			     , 0      /* 기금원금 */
			     , 0      /* 기금이자 */
			     , 0      /* 조합비 */
			     , 0      /* 봉사단기금 */
			     , 0      /* 학자금상환 */
			     , 0      /* 연말정산 */
			     , 0      /* 보수압류 */
			     , 0      /* 소득세정산 */
			     , 0      /* 지방소득세정산 */
			     , 0      /* 건강보험정산 */
			     , 0      /* 고용보험정산 */
			     , 0      /* 공제총액 */
			     , 0      /* 통상임금 */
			     , 0      /* 실수령액 */
			     , ''     /* 마감여부 */
			     , ''     /* 마감일자 */
			     , ''     /* 비고 */
			     , 0      /* 기준연봉 2016.02.19 */
			     , 0      /* 임금피크 2016.02.19 */
			     , #S_USER_ID#     /* 등록자ID */
			     , SYSDATE         /* 등록일시 */
			     , #S_USER_ID#     /* 수정자ID */
			     , SYSDATE         /* 수정일시 */
			  FROM TBHRM_HR_MASTR A
			 WHERE A.PAY_CLSF_SE IS NOT NULL
			   AND A.ECNY_DE <= #PYMNT_DE#	  /* 수정 : 20일이후 입사자 는 급여 처리안함 */
		]]>
		<isEqual property = "PYMNT_SE" compareValue = "1">	/* 복리후생비 */		
			   AND ( A.STTUS_SE = '000'
					 OR SUBSTR(A.RETIRE_DE,1,6) = TO_CHAR(ADD_MONTHS (TO_DATE(#PYMNT_YM#,'YYYYMM') , -1), 'YYYYMM')  ) /* 수정 : 퇴사자 1일자 지급시 전월 퇴사자도 포함 함 */
			   AND A.JSSFC_SE IN ('000','001','002','003','007')
		</isEqual>	
		<isEqual property = "PYMNT_SE" compareValue = "2"> /* 급여 */
			   AND ( A.STTUS_SE = '000'
			   		 OR SUBSTR(A.RETIRE_DE,1,6) = #PYMNT_YM# )		/* 20160827 수정 : 당월 퇴사자도 포함 */
			   AND A.JSSFC_SE IN ('000','001','002','003','007')
		</isEqual>	
		<isEqual property = "PYMNT_SE" compareValue = "4"> /* 계약직 */			
			   AND ( A.STTUS_SE = '000' 
			   		 OR SUBSTR(A.RETIRE_DE,1,6) = #PYMNT_YM# )		/* 20160827 수정 : 당월 퇴사자도 포함 */
			   AND A.JSSFC_SE IN ('004')
		</isEqual>		
			 ORDER BY A.JSSFC_SE, A.PAY_CLSF_SE, A.SRCLS
   	</insert>
   
  	<!-- 월급여데이터생성- 기본급생성 -->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1010" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2">
		<![CDATA[         
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#            /* 지급년월 */
			     , #SALARY_SE#           /* 급여구분 */
			     , #PYMNT_DE#            /* 지급일자 */
			     , A.EMPNO               /* 사번 */
			     , A.EMPNM               /* 사원명 */
			     , A.DEPT_CODE           /* 부서코드 */
			     , A.CLSF_CODE           /* 직급코드 */
			     , 'P1010'               /* 기본급 */
			     , 'P1010'               /* 지급상세코드 */
			     , SFSAL_DAY_PERC_CALC1 (
			       (
			              SELECT B.BASS_AMOUNT
			                FROM TBSAL_SLARY_TABLE B
			               WHERE B.CLSF_CODE = A.CLSF_CODE
			                 AND B.SRCLS     = A.SRCLS
			                 AND B.EMPL_SE   = A.EMPL_SE
			                 AND B.APPLC_DE  =
			                     (
			                            SELECT MAX(APPLC_DE)
			                              FROM TBSAL_SLARY_TABLE
			                             WHERE APPLC_DE <= #PYMNT_DE#
			                     )
			       )
			       , A.EMPNO, #PYMNT_YM#, #PYMNT_SE# ) AS PYMNT_AMOUNT       /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , ''                    /* 과세여부 */
			     , '1'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_DE  = #PYMNT_DE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216') 	/* 휴직자 제외 */
		]]>
        </isEqual>
        <isEqual property="PYMNT_SE" compareValue = "4">
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#            /* 지급년월 */
			     , #SALARY_SE#           /* 급여구분 */
			     , #PYMNT_DE#            /* 지급일자 */
			     , A.EMPNO               /* 사번 */
			     , A.EMPNM               /* 사원명 */
			     , A.DEPT_CODE           /* 부서코드 */
			     , A.CLSF_CODE           /* 직급코드 */
			     , 'P1010'               /* 기본급 */
			     , 'P1010'               /* 지급상세코드 */
			     , SFSAL_DAY_PERC_CALC1 (
			       (
			              SELECT B.BASS_AMOUNT
			                FROM TBSAL_SLARY_TABLE B
			               WHERE B.CLSF_CODE = A.CLSF_CODE
			                 AND B.SRCLS     = '01'
			                 AND B.EMPL_SE   = A.EMPL_SE
			                 AND B.APPLC_DE  =
			                     (
			                            SELECT MAX(APPLC_DE)
			                              FROM TBSAL_SLARY_TABLE
			                             WHERE APPLC_DE <= #PYMNT_DE#
			                     )
			       )
			       , A.EMPNO, #PYMNT_YM#, #PYMNT_SE#) AS PYMNT_AMOUNT       /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , ''                    /* 과세여부 */
			     , '1'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_DE  = #PYMNT_DE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>    
    </insert> 
   
   	<!-- 월급여데이터생성- 건설수당생성 -->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1050" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2">  
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , 'P1050'                 /* 기본급 */
			     , 'P1050'                 /* 지급상세코드 */
			     , SFSAL_DAY_PERC_CALC1 (( FLOOR(
			     	(
			           (
			                  SELECT B.BASS_AMOUNT
			                    FROM TBSAL_SLARY_TABLE B
			                   WHERE B.CLSF_CODE = A.CLSF_CODE
			                     AND B.SRCLS     = A.SRCLS
			                     AND B.EMPL_SE   = A.EMPL_SE
			                     AND B.APPLC_DE  =
			                         (
			                                SELECT MAX(APPLC_DE)
			                                  FROM TBSAL_SLARY_TABLE
			                                 WHERE APPLC_DE <= #PYMNT_DE#
			                         )
			           )
			           *
			           (
			                  SELECT SE_1
			                    FROM TBSAL_PYMNT_DETAIL_CODE
			                   WHERE PYMNT_DETAIL_CODE = 'P1050001'
			           )
			       	) / 1000) * 10), A.EMPNO, #PYMNT_YM#, #PYMNT_SE#) AS PYMNT_AMOUNT          /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , ''                    /* 과세여부 */
			     , '1'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			 WHERE A.PYMNT_YM        = #PYMNT_YM#
			   AND A.SALARY_SE       = #SALARY_SE#
			   AND A.PYMNT_DE        = #PYMNT_DE#
			   AND A.PYMNT_SE        = #PYMNT_SE#
			   AND A.ANSLRY_AT IS NULL
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
		]]>
       	</isEqual> 
       	<isEqual property="PYMNT_SE" compareValue = "4">  
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , 'P1050'                 /* 기본급 */
			     , 'P1050'                 /* 지급상세코드 */
			     , SFSAL_DAY_PERC_CALC1 (( FLOOR((
				       (
				              SELECT B.BASS_AMOUNT
				                FROM TBSAL_SLARY_TABLE B
				               WHERE B.CLSF_CODE = A.CLSF_CODE
				                 AND B.SRCLS     = '01'
				                 AND B.EMPL_SE   = A.EMPL_SE
				                 AND B.APPLC_DE  =
				                     (
				                            SELECT MAX(APPLC_DE)
				                              FROM TBSAL_SLARY_TABLE
				                             WHERE APPLC_DE <= #PYMNT_DE#
				                     )
				       )
				       *
				       (
				              SELECT SE_1
				                FROM TBSAL_PYMNT_DETAIL_CODE
				               WHERE PYMNT_DETAIL_CODE = 'P1050001'
				       )
				       ) / 1000) * 10), A.EMPNO, #PYMNT_YM#, #PYMNT_SE#) AS PYMNT_AMOUNT          /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , ''                    /* 과세여부 */
			     , '1'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			 WHERE A.PYMNT_YM        = #PYMNT_YM#
			   AND A.SALARY_SE       = #SALARY_SE#
			   AND A.PYMNT_DE        = #PYMNT_DE#
			   AND A.PYMNT_SE        = #PYMNT_SE#
			   AND A.ANSLRY_AT IS NULL
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
		]]>
       	</isEqual> 
       
       	<isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert> 
    
    <!-- 월급여데이터생성- 직책보조비생성 (1일자) -->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1955" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "1">
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , 'P1955'                 /* 기본급 */
			     , 'P1955'                 /* 지급상세코드 */
			     , SFSAL_DAY_PERC_CALC1 (
			         (
			                SELECT B.PYMNTAMT
			                  FROM TBSAL_PYMNT_DETAIL_CODE B
			                 WHERE SUBSTR(B.PYMNT_DETAIL_CODE, 1, 5) = 'P1955'
			                   AND B.SE_1                            = A.RSPOFC_SE
			         )
			       , A.EMPNO, #PYMNT_YM#, #PYMNT_SE# ) AS PYMNT_AMOUNT     /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , ''                    /* 과세여부 */
			     , '1'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_DE  = #PYMNT_DE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
			   AND A.RSPOFC_SE IN('000', '100', '350', '310', '250', '260')
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
		]]>
        </isEqual> 
        
        <isEqual property="PYMNT_SE" compareValue = "2">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert> 
    
    <!-- 월급여데이터생성- 특수업수수당(운전, 위험, 특수업무) 생성 -->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1090" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2">
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , SUBSTR(C.PYMNT_DETAIL_CODE, 1, 5)   /* 지급코드 */
			     , C.PYMNT_DETAIL_CODE                 /* 지급상세코드 */
			     , SFSAL_DAY_PERC_CALC2(
			       (
			              SELECT B.PYMNTAMT
			                FROM TBSAL_PYMNT_DETAIL_CODE B
			               WHERE SUBSTR(B.PYMNT_DETAIL_CODE, 1, 5) = C.PYMNT_DETAIL_CODE
			       )
			       , A.EMPNO, #PYMNT_YM#, SUBSTR(C.PYMNT_DETAIL_CODE, 1, 5) ) AS PYMNT_AMOUNT     /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , ''                    /* 과세여부 */
			     , '1'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			     , TBSAL_SPCL_JOB_ALLWNC C
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_DE  = #PYMNT_DE#
			   AND A.EMPNO     = C.EMPNO
			   AND A.PYMNT_SE  = #PYMNT_SE#
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
        ]]>
        <isNotEmpty property="PYMNT_DDC_CODE">
			   AND SUBSTR(C.PYMNT_DETAIL_CODE, 1, 5)  = #PYMNT_DDC_CODE#
        </isNotEmpty>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert> 
    
    <!-- 월급여데이터생성- 기술수당 생성 ++++ 정규직 임직원만 ++++  -->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1070" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2">
    	<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                     /* 일련번호 */
			            , PYMNT_YM               /* 지급년월 */
			            , SALARY_SE              /* 급여구분 */
			            , PYMNT_DE               /* 지급일자 */
			            , EMPNO                  /* 사번 */
			            , EMPNM                  /* 사원명 */
			            , DEPT_CODE              /* 부서코드 */
			            , CLSF_CODE              /* 직급코드 */
			            , PYMNT_DDC_CODE         /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE      /* 지급상세코드 */
			            , PYMNT_AMOUNT           /* 지급금액 */
			            , UPDT_AMOUNT            /* 수정금액 */
			            , TAXT_AT                /* 과세여부 */
			            , ALLWNC_SE              /* 수당구분 */
			            , PRMPC_SE               /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT                /* 마감여부 */
			            , CLOS_DE                /* 마감일자 */
			            , RM                     /* 비고 */
			            , REGISTER_ID            /* 등록자ID */
			            , REGIST_DT              /* 등록일시 */
			            , UPDUSR_ID              /* 수정자ID */
			            , UPDT_DT                /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , 'P1070'                 /* 기술수당 */
			     , 'P1070'                 /* 지급상세코드 */
			     , (
			              SELECT PYMNTAMT
			                FROM TBSAL_PYMNT_DETAIL_CODE
			               WHERE SUBSTR(PYMNT_DETAIL_CODE, 1, 5) = 'P1070'
			                 AND SE_1                            = B.QUALF_ALLWNC
			       )
			       AS PYMNT_AMOUNT    	  /* 지급금액 */
			     , 0                      /* 수정금액 */
			     , ''                     /* 과세여부 */
			     , '1'                    /* 수당구분  일반:1, 복리:2 */
			     , ''                     /* 원가구분 */
			     , #PYMNT_SE#             /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                     /* 마감여부 마감:1 */
			     , ''                     /* 마감일자 */
			     , ''                     /* 비고 */
			     , #S_USER_ID#            /* 등록자ID */
			     , SYSDATE                /* 등록일시 */
			     , #S_USER_ID#            /* 수정자ID */
			     , SYSDATE                /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			     , TBHRM_HR_QUALF B
			 WHERE A.PYMNT_YM      = #PYMNT_YM#
			   AND A.SALARY_SE     = #SALARY_SE#
			   AND A.PYMNT_DE      = #PYMNT_DE#
			   AND A.PYMNT_SE      = #PYMNT_SE#
			   AND A.EMPNO         = B.EMPNO
			   AND B.ALLWNC_AT     = '1'   /* 수당지급여부 */
			   AND B.QUALF_ALLWNC <> '000'
			   AND A.EMPL_SE IN ('000', '001', '002', '003', '007')
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
        ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert>
    
    <!-- 월급여데이터생성- 직무수당 생성 ++++ 계약직 ++++  -->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1957" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "4">
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , 'P1957'                 /* 기술수당 */
			     , 'P1957'                 /* 지급상세코드 */
			     , SFSAL_DAY_PERC_CALC1 (
			       (
			              SELECT C.PYMNTAMT
			                FROM TBSAL_PYMNT_DETAIL_CODE C
			               WHERE C.PYMNT_DETAIL_CODE = 'P1957001'
			       )
			       , A.EMPNO, #PYMNT_YM#, #PYMNT_SE#) AS PYMNT_AMOUNT     /* 직무수당_가 */
			     , 0                     /* 수정금액 */
			     , ''                    /* 과세여부 */
			     , '1'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_DE  = #PYMNT_DE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
			   AND A.EMPL_SE IN ('004')
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
        ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert>
    
    <!-- 통상임금 -->
    <update id="SAL030101DAO.MtSalaryPymnt_ODYGS" parameterClass="java.util.HashMap">
       	<isEqual property="PYMNT_SE" compareValue = "2"> 
		<![CDATA[
			UPDATE TBSAL_MT_SALARY_PYMNT A
			   SET A.ODYGS = CEIL(
			       (
		              SELECT SUM(B.PYMNT_AMOUNT)
		                FROM TBSAL_MT_PYMNT_DTLS B
		               WHERE B.PYMNT_YM        = A.PYMNT_YM
		                 AND B.SALARY_SE       = A.SALARY_SE
		                 AND B.EMPNO           = A.EMPNO
		                 AND B.PYMNT_DDC_CODE IN
		                     (
	                            SELECT C.PYMNT_DDC_CODE
	                              FROM TBSAL_PYMNT_DDC_STDR_CODE C
	                             WHERE C.ODYGS_AT = '1'
		                     )
			       )
			       / 10 ) * 10
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_DE  = #PYMNT_DE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "4"> 
		<![CDATA[
			UPDATE TBSAL_MT_SALARY_PYMNT A
			   SET A.ODYGS = CEIL(
			       (
		              SELECT SUM(B.PYMNT_AMOUNT)
		                FROM TBSAL_MT_PYMNT_DTLS B
		               WHERE B.PYMNT_YM  = A.PYMNT_YM
		                 AND B.SALARY_SE = A.SALARY_SE
		                 AND B.PYMNT_DE  = A.PYMNT_DE
		                 AND B.EMPNO     = A.EMPNO
		                 AND B.PYMNT_DDC_CODE IN
		                     (
	                            SELECT C.PYMNT_DDC_CODE
	                              FROM TBSAL_PYMNT_DDC_STDR_CODE C
	                             WHERE C.ODYGS_AT = '1'
		                     )
			       )
			       / 10 ) * 10
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_DE  = #PYMNT_DE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
		]]>
        </isEqual> 
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual> 
    </update>
    
    <!-- 통상임금 연봉제 건설수당 +  -->
    <update id="SAL030101DAO.MtSalaryPymnt_ODYGS_ANSLRY" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2"> 
		<![CDATA[
			UPDATE TBSAL_MT_SALARY_PYMNT A
			   SET A.ODYGS = A.ODYGS + FLOOR((
				       (
				              SELECT B.BASS_AMOUNT
				                FROM TBSAL_SLARY_TABLE B
				               WHERE B.CLSF_CODE = A.CLSF_CODE
				                 AND B.SRCLS     = A.SRCLS
				                 AND B.EMPL_SE   = A.EMPL_SE
				                 AND B.APPLC_DE  =
				                     (
				                            SELECT MAX(APPLC_DE)
				                              FROM TBSAL_SLARY_TABLE
				                             WHERE APPLC_DE <= A.PYMNT_DE
				                     )
				       )
				       *
				       (
				              SELECT SE_1
				                FROM TBSAL_PYMNT_DETAIL_CODE
				               WHERE PYMNT_DETAIL_CODE = 'P1050001'
				       )
			       ) / 1000) * 10
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_DE  = #PYMNT_DE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
			   AND A.ANSLRY_AT = 'Y'
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
             SELECT SYSDATE FROM DUAL  
        </isEqual>
    </update>
    
    <!-- 월급여데이터생성- 장기근속수당 생성 근무월 + 군경력 + 사회경력 - 징계  +++호봉제 정규직만 지급 +++ -->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1060" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2"> 
		<![CDATA[
	       INSERT INTO TBSAL_MT_PYMNT_DTLS (
			            SN                    /* 일련번호 */
			           ,PYMNT_YM              /* 지급년월 */
			           ,SALARY_SE             /* 급여구분 */
			           ,PYMNT_DE              /* 지급일자 */
			           ,EMPNO                 /* 사번 */
			           ,EMPNM                 /* 사원명 */
			           ,DEPT_CODE             /* 부서코드 */
			           ,CLSF_CODE             /* 직급코드 */
			           ,PYMNT_DDC_CODE        /* 지급공제코드 */
			           ,PYMNT_DETAIL_CODE     /* 지급상세코드 */
			           ,PYMNT_AMOUNT          /* 지급금액 */
			           ,UPDT_AMOUNT           /* 수정금액 */
			           ,TAXT_AT               /* 과세여부 */
			           ,ALLWNC_SE             /* 수당구분 */
			           ,PRMPC_SE              /* 원가구분 */
			           ,PYMNT_SE              /* 지급구분 */
			           ,CLOS_AT               /* 마감여부 */
			           ,CLOS_DE               /* 마감일자 */	
			           ,RM                    /* 비고 */			       
					   ,REGISTER_ID           /* 등록자ID */
					   ,REGIST_DT             /* 등록일시 */
					   ,UPDUSR_ID             /* 수정자ID */
					   ,UPDT_DT               /* 수정일시 */
			)
	      	SELECT 
			            SQ_TBSAL_2.NEXTVAL
			           ,#PYMNT_YM#              /* 지급년월 */
			           ,#SALARY_SE#             /* 급여구분 */
			           ,#PYMNT_DE#              /* 지급일자 */
			           ,A.EMPNO                 /* 사번 */
			           ,A.EMPNM                 /* 사원명 */
			           ,A.DEPT_CODE             /* 부서코드 */
			           ,A.CLSF_CODE             /* 직급코드 */
			           ,'P1060'                 /* 장기근속수당 */
			           ,'P1060'                 /* 지급상세코드 */
			           ,SFSAL_DAY_PERC_CALC1 ( (
			             SELECT PYMNTAMT 
	                       FROM TBSAL_PYMNT_DETAIL_CODE B
	                      WHERE SUBSTR(B.PYMNT_DETAIL_CODE,1,5) = 'P1060'
	                        AND (
	                            SELECT 
									FLOOR((NVL((SELECT FLOOR(MONTHS_BETWEEN(to_date(#PYMNT_YM# || '20','YYYYMMDD' ), TO_DATE(C.ECNY_DE,'YYYYMMDD')) / 12) * 12 +
									    	           MOD(FLOOR(MONTHS_BETWEEN(to_date(#PYMNT_YM# || '20','YYYYMMDD' ), TO_DATE(C.ECNY_DE,'YYYYMMDD'))), 12)
											      FROM TBHRM_HR_MASTR C
											     WHERE C.STTUS_SE = '000'
										           AND C.EMPNO = A.EMPNO),0) 
							
								+	NVL((SELECT FLOOR(MONTHS_BETWEEN(to_date(D.DMBLZ_DE,'YYYYMMDD' ), TO_DATE(D.ENST_DE,'YYYYMMDD')) / 12) * 12 +
									            MOD(FLOOR(MONTHS_BETWEEN(to_date(D.DMBLZ_DE,'YYYYMMDD' ), TO_DATE(D.ENST_DE,'YYYYMMDD'))), 12) AS BB
										   FROM TBHRM_HR_ETC D
								 	      WHERE D.EMPNO = A.EMPNO),0) 
									
								+	NVL((SELECT SUM(E.CRTFC_CAREER_YY) * 12 + SUM(E.CRTFC_CAREER_MT)
										   FROM TBHRM_HR_CAREER E
										  WHERE E.EMPNO = A.EMPNO),0)  
							
								-	NVL((SELECT FLOOR(SUM(MONTHS_BETWEEN(TO_DATE(CASE WHEN F.DSPS_ENDDE > #PYMNT_YM# || '20' THEN #PYMNT_YM# || '20' ELSE F.DSPS_ENDDE END,'YYYYMMDD')+1,TO_DATE(F.DSPS_BGNDE,'YYYYMMDD')))/12)*12 +
					                            MOD(FLOOR(SUM(MONTHS_BETWEEN(TO_DATE(CASE WHEN F.DSPS_ENDDE > #PYMNT_YM# || '20' THEN #PYMNT_YM# || '20' ELSE F.DSPS_ENDDE END,'YYYYMMDD')+1,TO_DATE(F.DSPS_BGNDE,'YYYYMMDD')))),12)
						                   FROM TBHRM_DSCPL_DSPS F
						                  WHERE F.DSCPL_ERSR_DE > #PYMNT_DE#
						                    AND F.EMPNO = A.EMPNO),0)) / 12) AS YEAR
							  FROM DUAL ) <= B.SE_2
	                       AND (
	                           SELECT 
									FLOOR((NVL((SELECT FLOOR(MONTHS_BETWEEN(to_date(#PYMNT_YM#  || '20','YYYYMMDD' ), TO_DATE(C.ECNY_DE,'YYYYMMDD')) / 12) * 12 +
											      	   MOD(FLOOR(MONTHS_BETWEEN(to_date(#PYMNT_YM# || '20','YYYYMMDD' ), TO_DATE(C.ECNY_DE,'YYYYMMDD'))), 12)
												  FROM TBHRM_HR_MASTR C
												 WHERE C.STTUS_SE = '000'
												   AND C.EMPNO = A.EMPNO),0) 
							
								+	NVL((SELECT FLOOR(MONTHS_BETWEEN(to_date(D.DMBLZ_DE,'YYYYMMDD' ), TO_DATE(D.ENST_DE,'YYYYMMDD')) / 12) * 12 +
									       		MOD(FLOOR(MONTHS_BETWEEN(to_date(D.DMBLZ_DE,'YYYYMMDD' ), TO_DATE(D.ENST_DE,'YYYYMMDD'))), 12) AS BB
										   FROM TBHRM_HR_ETC D
										  WHERE D.EMPNO = A.EMPNO),0) 
							
								+	NVL((SELECT SUM(E.CRTFC_CAREER_YY) * 12 + SUM(E.CRTFC_CAREER_MT)
										   FROM TBHRM_HR_CAREER E
										  WHERE E.EMPNO = A.EMPNO),0)  
							
								-	NVL((SELECT FLOOR(SUM(MONTHS_BETWEEN(TO_DATE(CASE WHEN F.DSPS_ENDDE > #PYMNT_YM# || '20' THEN #PYMNT_YM# || '20' ELSE F.DSPS_ENDDE END,'YYYYMMDD')+1,TO_DATE(F.DSPS_BGNDE,'YYYYMMDD')))/12)*12 +
					                            MOD(FLOOR(SUM(MONTHS_BETWEEN(TO_DATE(CASE WHEN F.DSPS_ENDDE > #PYMNT_YM# || '20' THEN #PYMNT_YM# || '20' ELSE F.DSPS_ENDDE END,'YYYYMMDD')+1,TO_DATE(F.DSPS_BGNDE,'YYYYMMDD')))),12)
					                       FROM TBHRM_DSCPL_DSPS F
						                  WHERE F.DSCPL_ERSR_DE > #PYMNT_DE#
						                    AND F.EMPNO = A.EMPNO),0)) / 12) AS YEAR
								FROM DUAL  ) >= B.SE_1) , A.EMPNO, #PYMNT_YM#, #PYMNT_SE# ) AS  PYMNT_AMOUNT     /* 지급금액 */
			           ,0                     /* 수정금액 */
			           ,''                    /* 과세여부 */
			           ,'1'                   /* 수당구분  일반:1, 복리:2 */
			           ,''                    /* 원가구분 */
			           ,#PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			           ,''                    /* 마감여부 마감:1 */
			           ,''                    /* 마감일자 */
			           ,''                    /* 비고 */
			           ,#S_USER_ID#           /* 등록자ID */
					   ,SYSDATE               /* 등록일시 */
					   ,#S_USER_ID#           /* 수정자ID */
					   ,SYSDATE               /* 수정일시 */
			FROM TBSAL_MT_SALARY_PYMNT A                   
			WHERE A.PYMNT_YM 	= #PYMNT_YM#
			AND A.SALARY_SE 	= #SALARY_SE# 
			AND A.PYMNT_DE 		= #PYMNT_DE#
			AND A.PYMNT_SE 		= #PYMNT_SE#
	        AND A.ANSLRY_AT IS NULL
	        AND A.EMPL_SE IN ('001','002','003')
	        AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL
        </isEqual>  
    </insert>
    
    <!-- 월급여데이터생성- 시간외수당 생성 (1일자) -->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1910" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "1">
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                     /* 일련번호 */
			            , PYMNT_YM               /* 지급년월 */
			            , SALARY_SE              /* 급여구분 */
			            , PYMNT_DE               /* 지급일자 */
			            , EMPNO                  /* 사번 */
			            , EMPNM                  /* 사원명 */
			            , DEPT_CODE              /* 부서코드 */
			            , CLSF_CODE              /* 직급코드 */
			            , PYMNT_DDC_CODE         /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE      /* 지급상세코드 */
			            , PYMNT_AMOUNT           /* 지급금액 */
			            , UPDT_AMOUNT            /* 수정금액 */
			            , TAXT_AT                /* 과세여부 */
			            , ALLWNC_SE              /* 수당구분 */
			            , PRMPC_SE               /* 원가구분 */
			            , PYMNT_SE               /* 지급구분 */
			            , CLOS_AT                /* 마감여부 */
			            , CLOS_DE                /* 마감일자 */
			            , RM                     /* 비고 */
			            , REGISTER_ID            /* 등록자ID */
			            , REGIST_DT              /* 등록일시 */
			            , UPDUSR_ID              /* 수정자ID */
			            , UPDT_DT                /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#             /* 지급년월 */
			     , #SALARY_SE#            /* 급여구분 */
			     , #PYMNT_DE#             /* 지급일자 */
			     , A.EMPNO                /* 사번 */
			     , A.EMPNM                /* 사원명 */
			     , A.DEPT_CODE            /* 부서코드 */
			     , A.CLSF_CODE            /* 직급코드 */
			     , 'P1910'                /* 시간외수당 */
			     , 'P1910'                /* 지급상세코드 */
			     , B.PYMNT_AMOUNT         /* 지급금액 */
			     , 0                      /* 수정금액 */
			     , ''                     /* 과세여부 */
			     , '2'                    /* 수당구분  일반:1, 복리:2 */
			     , ''                     /* 원가구분 */
			     , #PYMNT_SE#             /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                     /* 마감여부 마감:1 */
			     , ''                     /* 마감일자 */
			     , B.PYMNT_TIME           /* 비고 */
			     , #S_USER_ID#            /* 등록자ID */
			     , SYSDATE                /* 등록일시 */
			     , #S_USER_ID#            /* 수정자ID */
			     , SYSDATE                /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			     , TBSAL_EXCESS_WORK_DTLS B
			 WHERE A.PYMNT_YM      = #PYMNT_YM#  /* 초과근무년월 */
			   AND A.SALARY_SE     = #SALARY_SE#
			   AND A.PYMNT_DE      = #PYMNT_DE#
			   AND A.PYMNT_SE      = #PYMNT_SE#
			   AND B.PYMNT_YM      = DECODE( #SALARY_SE#, '3', A.PYMNT_YM, TO_CHAR(TO_DATE(A.PYMNT_YM, 'YYYYMM') - 1, 'YYYYMM') )	/* 시간외 수당은 급여월의 초과근무 정보 조회 */ 
			   AND A.PYMNT_DE      = #PYMNT_DE#
			   AND A.EMPNO         = B.EMPNO
			   AND B.PYMNT_AMOUNT <> 0
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    /* 휴직자 제외 */
		]]>
        </isEqual>
		<!--
        <isEqual property="PYMNT_SE" compareValue = "4">
          <![CDATA[
               INSERT INTO TBSAL_MT_PYMNT_DTLS (
				            SN                    	/* 일련번호 */
				           ,PYMNT_YM              	/* 지급년월 */
				           ,SALARY_SE             	/* 급여구분 */
				           ,PYMNT_DE              	/* 지급일자 */
				           ,EMPNO                 	/* 사번 */
				           ,EMPNM                 	/* 사원명 */
				           ,DEPT_CODE             	/* 부서코드 */
				           ,CLSF_CODE             	/* 직급코드 */
				           ,PYMNT_DDC_CODE        	/* 지급공제코드 */
				           ,PYMNT_DETAIL_CODE     	/* 지급상세코드 */
				           ,PYMNT_AMOUNT          	/* 지급금액 */
				           ,UPDT_AMOUNT           	/* 수정금액 */
				           ,TAXT_AT               	/* 과세여부 */
				           ,ALLWNC_SE             	/* 수당구분 */
				           ,PRMPC_SE              	/* 원가구분 */
				           ,PYMNT_SE              	/* 지급구분 */
				           ,CLOS_AT               	/* 마감여부 */
				           ,CLOS_DE               	/* 마감일자 */
				           ,RM                    	/* 비고 */				       
						   ,REGISTER_ID           	/* 등록자ID */
						   ,REGIST_DT             	/* 등록일시 */
						   ,UPDUSR_ID             	/* 수정자ID */
						   ,UPDT_DT               	/* 수정일시 */
				)
              	SELECT 
				            SQ_TBSAL_2.NEXTVAL
				           ,#PYMNT_YM#           	/* 지급년월 */
				           ,#SALARY_SE#             /* 급여구분 */
				           ,#PYMNT_DE#              /* 지급일자 */
				           ,A.EMPNO                 /* 사번 */
				           ,A.EMPNM                 /* 사원명 */
				           ,A.DEPT_CODE             /* 부서코드 */
				           ,A.CLSF_CODE             /* 직급코드 */
				           ,'P1910'                 /* 시간외수당 */
				           ,'P1910'                 /* 지급상세코드 */
				           ,B.PYMNT_AMOUNT      	/* 지급금액 */
				           ,0                    	/* 수정금액 */
				           ,''                    	/* 과세여부 */
				           ,'2'                   	/* 수당구분  일반:1, 복리:2 */
				           ,''                    	/* 원가구분 */
				           ,#PYMNT_SE#            	/* 지급구분 - 1일:1, 20일:2, 계약직:4 */
				           ,''                    	/* 마감여부 마감:1 */
				           ,''                    	/* 마감일자 */
				           ,B.PYMNT_TIME          	/* 비고 */
				           ,#S_USER_ID#           	/* 등록자ID */
						   ,SYSDATE               	/* 등록일시 */
						   ,#S_USER_ID#           	/* 수정자ID */
						   ,SYSDATE               	/* 수정일시 */
				FROM TBSAL_MT_SALARY_PYMNT A  
				    ,TBSAL_EXCESS_WORK_DTLS B                 
				WHERE A.PYMNT_YM 	= #PYMNT_YM#
				AND A.SALARY_SE 	= #SALARY_SE# 
				AND A.PYMNT_DE 		= #PYMNT_DE#
				AND A.PYMNT_SE 		= #PYMNT_SE#
                AND A.PYMNT_YM 		= B.PYMNT_YM
                AND A.EMPNO 		= B.EMPNO
                AND B.PYMNT_AMOUNT <> 0
			    AND NVL(A.DCLZ_SE,0) NOT IN ('216')    /* 휴직자 제외 */
            ]]>
        </isEqual>
        -->

        <isEqual property="PYMNT_SE" compareValue = "2">
			SELECT SYSDATE FROM DUAL  
        </isEqual>
    </insert>
    
    <!-- 월급여데이터생성- 급식보조비 생성 (1일자, 계약직) -->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1940" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "1"> 
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , 'P1940'                 /* 급식보조비 */
			     , 'P1940'                 /* 지급상세코드 */
			     , SFSAL_DAY_PERC_CALC1 (
			       (
			              SELECT PYMNTAMT
			                FROM TBSAL_PYMNT_DETAIL_CODE B
			               WHERE SUBSTR(B.PYMNT_DETAIL_CODE, 1, 5) = 'P1940'
			       )
			       , A.EMPNO, #PYMNT_YM#, #PYMNT_SE# ) AS PYMNT_AMOUNT     /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , '1'                   /* 과세여부 비과세:1 */
			     , '2'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_DE  = #PYMNT_DE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216','211')  	/* 휴직자 , 출산휴가제외 */
			   AND NVL(PKG_SAL_UTIL.FN_GET_GNFD_SE(A.EMPNO,#PYMNT_DE#),0) NOT IN ('060') /* 교육파견 */
		]]>
		</isEqual> 
      	<isEqual property="PYMNT_SE" compareValue = "4"> 
     	<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , 'P1940'                 /* 급식보조비 */
			     , 'P1940'                 /* 지급상세코드 */
			     , SFSAL_DAY_PERC_CALC1 (
			       (
			              SELECT PYMNTAMT
			                FROM TBSAL_PYMNT_DETAIL_CODE B
			               WHERE SUBSTR(B.PYMNT_DETAIL_CODE, 1, 5) = 'P1940'
			       )
			       , A.EMPNO, #PYMNT_YM#, #PYMNT_SE# ) AS PYMNT_AMOUNT     /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , '1'                   /* 과세여부 비과세:1 */
			     , '2'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_DE  = #PYMNT_DE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
			   AND A.RSPOFC_SE NOT IN ('000')
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
		]]>
  		</isEqual>
         
    	<isEqual property="PYMNT_SE" compareValue = "2">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert>
    
	<!-- 월급여데이터생성- 교통보조비 생성 (1일자, 계약직) : 사장제외 -->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1960" parameterClass="java.util.HashMap">
 		<isEqual property="PYMNT_SE" compareValue = "1"> 
   		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , 'P1960'                 /* 교통보조비 */
			     , 'P1960'                 /* 지급상세코드 */
			     , SFSAL_DAY_PERC_CALC1 (
			       (
			              SELECT C.PYMNTAMT
			                FROM TBSAL_PYMNT_DETAIL_CODE C
			               WHERE SUBSTR(C.PYMNT_DETAIL_CODE, 1, 5) = 'P1960'
			                 AND A.EMPL_SE                         = C.SE_1
			       )
			       , A.EMPNO, #PYMNT_YM#, #PYMNT_SE# ) AS PYMNT_AMOUNT     /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , ''                    /* 과세여부 비과세:1 */
			     , '2'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_DE  = #PYMNT_DE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
			   AND A.RSPOFC_SE NOT IN ('000')   		/* 직책: 사장  제외 */
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')     	/* 휴직자 제외 */
               AND NVL(PKG_SAL_UTIL.FN_GET_GNFD_SE(A.EMPNO,#PYMNT_DE#),'0') NOT IN ('060') /* 교육파견 */
        ]]>
        </isEqual>
         
        <isEqual property="PYMNT_SE" compareValue = "4"> 
        <![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , 'P1960'                 /* 교통보조비 */
			     , 'P1960'                 /* 지급상세코드 */
			     , SFSAL_DAY_PERC_CALC1 (
			       (
			              SELECT C.PYMNTAMT
			                FROM TBSAL_PYMNT_DETAIL_CODE C
			               WHERE SUBSTR(C.PYMNT_DETAIL_CODE, 1, 5) = 'P1960'
			                 AND A.EMPL_SE                         = C.SE_1
			       )
			       , A.EMPNO, #PYMNT_YM#, #PYMNT_SE# ) AS PYMNT_AMOUNT     /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , ''                    /* 과세여부 비과세:1 */
			     , '2'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			 WHERE A.PYMNT_YM   = #PYMNT_YM#
			   AND A.SALARY_SE  = #SALARY_SE#
			   AND A.PYMNT_DE   = #PYMNT_DE#
			   AND A.PYMNT_SE   = #PYMNT_SE#
			   AND A.CLSF_CODE <> '00'
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
  		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "2">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert>
    
    <!-- 장기교육자 급식보조비, 교통보조비 삭제 (1일자) -->
    <delete id="SAL030101DAO.MtSalaryPymnt_P194060_D" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "1"> 
   		<![CDATA[
			DELETE
			  FROM TBSAL_MT_PYMNT_DTLS
			 WHERE PYMNT_YM  = #PYMNT_YM#
			   AND SALARY_SE = #SALARY_SE#
			   AND PYMNT_SE  = #PYMNT_SE#
			   AND PYMNT_DDC_CODE IN ('P1940', 'P1960')
			   AND EMPNO IN
			       (
	                  SELECT C.EMPNO
	                    FROM TBHRM_GNFD C, TBHRM_HR_MASTR D
	                   WHERE C.GNFD_SE  = '060'
	                     AND C.EMPNO    = D.EMPNO
	                     AND D.STTUS_SE = '000'
	                     AND
	                         (
                                SELECT COUNT(*)
                                  FROM TBHRM_GNFD B
                                 WHERE B.GNFD_DE >
                                       (
                                           SELECT A.GNFD_DE
                                             FROM TBHRM_GNFD A
                                            WHERE A.EMPNO                 = B.EMPNO
                                              AND SUBSTR(A.GNFD_DE, 1, 6) < #PYMNT_YM#
                                              AND A.GNFD_SE               = '060'
                                              AND ROWNUM                  = '1'
                                       )
                                   AND B.EMPNO                 = C.EMPNO
                                   AND SUBSTR(B.GNFD_DE, 1, 6) < #PYMNT_YM#
	                         )
	                         = 0
	                  GROUP BY C.EMPNO
			       )
        ]]> 
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "2">
			SELECT SYSDATE FROM DUAL  
        </isEqual>         
    </delete> 
    
    <!-- 월급여데이터생성- 특정업무수행비 생성  -->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1191" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2"> 
		<![CDATA[
			 INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , RM_2                  /* 비고2 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , 'P1191'                 /* 특정업무수행비 */
			     , 'P1191'                 /* 지급상세코드 */
			     , SFSAL_DAY_PERC_CALC2(
			       (
			              SELECT C.PYMNTAMT
			                FROM TBSAL_PYMNT_DETAIL_CODE C
			               WHERE C.PYMNT_DETAIL_CODE = 'P1191001'
			       )
			       , A.EMPNO, #PYMNT_YM#, 'P1191' ) AS PYMNT_AMOUNT     /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , ''                    /* 과세여부 비과세:1 */
			     , '1'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , B.BGNDE               /* 비고 시작일자 */
			     , B.ENDDE               /* 비고 종료일자 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			     , TBSAL_SPCIFY_JOB_EXC_CT B
			 WHERE A.PYMNT_YM             = #PYMNT_YM#
			   AND A.SALARY_SE            = #SALARY_SE#
			   AND A.PYMNT_DE             = #PYMNT_DE#
			   AND A.PYMNT_SE             = #PYMNT_SE#
			   AND A.EMPNO                = B.EMPNO
			   AND SUBSTR(B.BGNDE, 1, 6) <= #PYMNT_YM#
			   AND SUBSTR(B.ENDDE, 1, 6) >= #PYMNT_YM#
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
        ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert>
    
    <!-- 월급여데이터생성- 복리후생수당(현장체제비,업무추진여비,감독수당,직무수당) 생성 (1일자) -->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1990" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "1"> 
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , RM_2                  /* 비고2 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , SUBSTR(B.PYMNT_DETAIL_CODE, 1, 5)   /* 지급코드 */
			     , B.PYMNT_DETAIL_CODE       /* 지급상세코드 */
			     , SFSAL_DAY_PERC_CALC2( NVL(B.ALLWNC_AMOUNT, 0), A.EMPNO, #PYMNT_YM#, SUBSTR(B.PYMNT_DETAIL_CODE, 1, 5))  /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , ''                    /* 과세여부 비과세:1 */
			     , '2'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , B.BGNDE               /* 비고 적용일자 */
			     , ''                    /* 비고 종료일자 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			     , TBSAL_CMPNINT_WELFR_ALLWNC B
			 WHERE A.PYMNT_YM             = #PYMNT_YM#
			   AND A.SALARY_SE            = #SALARY_SE#
			   AND A.PYMNT_DE             = #PYMNT_DE#
			   AND A.PYMNT_SE             = #PYMNT_SE#
			   AND A.EMPNO                = B.EMPNO
			   AND SUBSTR(B.BGNDE, 1, 6) <= #PYMNT_YM#
			   AND SUBSTR(B.ENDDE, 1, 6) >= #PYMNT_YM#
			   AND B.ENDDE NOT IN('99991231')
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
          ]]>
        <isNotEmpty property="PYMNT_DDC_CODE">
			   AND SUBSTR(B.PYMNT_DETAIL_CODE, 1, 5)  = #PYMNT_DDC_CODE#
        </isNotEmpty>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "2">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert>
    
    <!-- 월급여데이터생성- 학자보조금 생성  -->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1140" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2">
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , RM_2                  /* 비고2 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , 'P1140'                 /* 지급코드 */
			     , 'P1140'                 /* 지급상세코드 */
			     , SFSAL_DAY_PERC_CALC1 (B.REQST_AMOUNT, A.EMPNO, #PYMNT_YM#, #PYMNT_SE#)       /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , ''                    /* 과세여부 비과세:1 */
			     , '1'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , B.GRADE               /* 비고 학년 */
			     , B.QU                  /* 비고 분기 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			     , TBSAL_SCHXPN_SBSIDY B
			 WHERE A.PYMNT_YM          = #PYMNT_YM#
			   AND A.SALARY_SE         = #SALARY_SE#
			   AND A.PYMNT_DE          = #PYMNT_DE#
			   AND A.PYMNT_SE          = #PYMNT_SE#
			   AND A.EMPNO             = B.EMPNO
			   AND B.PYMNT_PREARNGE_YM = #PYMNT_YM#
			   AND B.SALARY_CONFM_AT   = '2'
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "4"> 
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , RM_2                  /* 비고2 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , 'P1140'                 /* 지급코드 */
			     , 'P1140'                 /* 지급상세코드 */
			     , SFSAL_DAY_PERC_CALC1 (B.REQST_AMOUNT, A.EMPNO, #PYMNT_YM#, #PYMNT_SE#)        /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , ''                    /* 과세여부 비과세:1 */
			     , '1'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , B.GRADE               /* 비고 학년 */
			     , B.QU                  /* 비고 분기 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			     , TBSAL_SCHXPN_SBSIDY B
			 WHERE A.PYMNT_YM          = #PYMNT_YM#
			   AND A.SALARY_SE         = #SALARY_SE#
			   AND A.PYMNT_DE          = #PYMNT_DE#
			   AND A.PYMNT_SE          = #PYMNT_SE#
			   AND A.EMPNO             = B.EMPNO
			   AND B.PYMNT_PREARNGE_YM = #PYMNT_YM#
			   AND B.SALARY_CONFM_AT   = '2'
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
        ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>   
    </insert>
    
    <!-- 월급여데이터생성- 연차수당 생성  -->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1110" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2"> 
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , RM_2                  /* 비고2 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , 'P1110'                 /* 지급코드 */
			     , 'P1110'                 /* 지급상세코드 */
			     , FLOOR( (A.ODYGS * C.SE_1 / C.SE_2 * C.SE_3 * B.REAL_PYMNT_DAYCNT) / 10 ) * 10       /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , ''                    /* 과세여부 비과세:1 */
			     , '1'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , B.YRYC_CREAT_DAYCNT   /* 비고 연차생성일수 */
			     , B.REAL_PYMNT_DAYCNT   /* 비고 실제지급일수 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			     , TBSAL_YRYC_ALLWNC B
			     , TBSAL_PYMNT_DETAIL_CODE C
			 WHERE A.PYMNT_YM          = TO_CHAR(ADD_MONTHS(TO_DATE(#PYMNT_YM#, 'YYYYMM'), - 1), 'YYYYMM') /*지난달 통상임금 취득*/
			   AND A.SALARY_SE         = #SALARY_SE#
			   AND A.PYMNT_SE          = #PYMNT_SE#
			   AND A.EMPNO             = B.EMPNO
			   AND B.PYMNT_YM          = #PYMNT_YM#
			   AND C.PYMNT_DETAIL_CODE = 'P1110001'
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
        ]]>
        </isEqual>  
            
        <isEqual property="PYMNT_SE" compareValue = "4"> 
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , RM_2                  /* 비고2 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , 'P1110'                 /* 지급코드 */
			     , 'P1110'                 /* 지급상세코드 */
			     , FLOOR( (A.ODYGS * C.SE_1 / C.SE_2 * C.SE_3 * B.REAL_PYMNT_DAYCNT) / 10 ) * 10       /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , ''                    /* 과세여부 비과세:1 */
			     , '1'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , B.YRYC_CREAT_DAYCNT   /* 비고 연차생성일수 */
			     , B.REAL_PYMNT_DAYCNT   /* 비고 실제지급일수 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			     , TBSAL_YRYC_ALLWNC B
			     , TBSAL_PYMNT_DETAIL_CODE C
			 WHERE A.PYMNT_YM          = #PYMNT_YM#
			   AND A.SALARY_SE         = #SALARY_SE#
			   AND A.PYMNT_DE          = #PYMNT_DE#
			   AND A.PYMNT_SE          = #PYMNT_SE#
			   AND A.EMPNO             = B.EMPNO
			   AND B.PYMNT_YM          = #PYMNT_YM#
			   AND C.PYMNT_DETAIL_CODE = 'P1110001'
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
        ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>    
    </insert>
    
    <!-- 월급여데이터생성- 대우수당 생성  -->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1220" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2"> 
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , RM_2                  /* 비고2 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , 'P1220'                 /* 지급코드 */
			     , 'P1220'                 /* 지급상세코드 */
			     , SFSAL_DAY_PERC_CALC1 ( ( FLOOR(
			       (
			              SELECT B.BASS_AMOUNT
			                FROM TBSAL_SLARY_TABLE B
			               WHERE B.CLSF_CODE = A.CLSF_CODE
			                 AND B.SRCLS     = A.SRCLS
			                 AND B.EMPL_SE   = A.EMPL_SE
			                 AND B.APPLC_DE  =
			                     (
			                            SELECT MAX(APPLC_DE)
			                              FROM TBSAL_SLARY_TABLE
			                             WHERE APPLC_DE <= #PYMNT_DE#
			                     )
			       )
			       * SE_1 / 1000) * 10), A.EMPNO, #PYMNT_YM#, #PYMNT_SE#)     /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , ''                    /* 과세여부 비과세:1 */
			     , '1'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			     , TBSAL_PYMNT_DETAIL_CODE C
			 WHERE A.PYMNT_YM          = #PYMNT_YM#
			   AND A.SALARY_SE         = #SALARY_SE#
			   AND A.PYMNT_DE          = #PYMNT_DE#
			   AND A.PYMNT_SE          = #PYMNT_SE#
			   AND A.TRTMT_EMP_AT      = 'Y'
			   AND C.PYMNT_DETAIL_CODE = 'P1220001'
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
        ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>    
    </insert>
    
    <!-- 월급여데이터생성- 성과급 생성  -->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1030" parameterClass="java.util.HashMap">
        <isEqual property="PYMNT_SE" compareValue = "2"> 
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , RM_2                  /* 비고2 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , 'P1030'                 /* 지급코드 */
			     , 'P1030'                 /* 지급상세코드 */
			     , B.BUDGET_PRICEWAGE    /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , ''                    /* 과세여부 비과세:1 */
			     , '1'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			     , TBSAL_BUDGET_PRICEWAGE B
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.PYMNT_YM  = B.PYMNT_YM
			   AND A.EMPNO     = B.EMPNO
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
			
        ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>    
    </insert>
    
    <!-- 월급여데이터생성- 예산성과급 생성  -->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1150" parameterClass="java.util.HashMap">
        <isEqual property="PYMNT_SE" compareValue = "2"> 
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , RM_2                  /* 비고2 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , 'P1150'                 /* 지급코드 */
			     , 'P1150'                 /* 지급상세코드 */
			     , SFSAL_DAY_PERC_CALC1 (B.PRICEWAGE, A.EMPNO, #PYMNT_YM#, #PYMNT_SE#)           /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , ''                    /* 과세여부 비과세:1 */
			     , '1'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			     , TBSAL_PRICEWAGE B
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.PYMNT_YM  = B.PYMNT_YM
			   AND A.EMPNO     = B.EMPNO
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
        ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>    
    </insert>
    
    <!-- 월급여데이터생성- 가족수당대상자 생성 -->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1080_01" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2"> 
		<![CDATA[
			INSERT
			  INTO TBSAL_FAMILY_ALLWNC_MANAGE
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , SEXDSTN_SE            /* 성별구분 */
			            , FAMILY_RELATE_SE      /* 가족관계구분 */
			            , FAMILY_NM             /* 가족성명 */
			            , BRTHDY                /* 생년월일 */
			            , TROBL_AT              /* 장애여부 */
			            , SUPORT_AT             /* 부양여부 */
			            , ALLWNC_PYMNT_AT       /* 수당지급여부 */
			            , ALLWNC_REQST_DE       /* 수당신청일자 */
			            , ALLWNC_AMOUNT         /* 수당금액 */
			            , ALLWNC_AMOUNT_2       /* 수당금액2 */
			            , TAXT_SE               /* 과세구분 */
			            , PYMNT_SE
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_1.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , B.SEXDSTN_SE            /* 성별구분 */
			     , B.FAMILY_RELATE_SE      /* 가족관계구분 */
			     , B.FAMILY_NM             /* 가족성명 */
			     , B.BRTHDY                /* 생년월일 */
			     , B.TROBL_AT              /* 장애여부 */
			     , B.SUPORT_AT             /* 부양여부 */
			     , B.ALLWNC_PYMNT_AT       /* 수당지급여부 */
			     , B.ALLWNC_REQST_DE       /* 수당신청일자 */
			     , 0                       /* 수당금액 */
			     , 0                       /* 수당금액2 */
			     , '0'                     /* 과세구분 */
			     , #PYMNT_SE#
			     , #S_USER_ID#             /* 등록자ID */
			     , SYSDATE                 /* 등록일시 */
			     , #S_USER_ID#             /* 수정자ID */
			     , SYSDATE                 /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			     , TBHRM_HR_FAMILY B
			 WHERE A.PYMNT_YM        = #PYMNT_YM#
			   AND A.SALARY_SE       = #SALARY_SE#
			   AND A.PYMNT_DE        = #PYMNT_DE#
			   AND A.PYMNT_SE        = #PYMNT_SE#
			   AND A.EMPNO           = B.EMPNO
			   AND B.ALLWNC_PYMNT_AT = '1'
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')   	/* 휴직자 제외 */
			   AND SUBSTR(B.BRTHDY,1,6) <= #PYMNT_YM#
       	]]>
        </isEqual>
          
        <isEqual property="PYMNT_SE" compareValue = "4"> 
		<![CDATA[
			INSERT
			  INTO TBSAL_FAMILY_ALLWNC_MANAGE
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , SEXDSTN_SE            /* 성별구분 */
			            , FAMILY_RELATE_SE      /* 가족관계구분 */
			            , FAMILY_NM             /* 가족성명 */
			            , BRTHDY                /* 생년월일 */
			            , TROBL_AT              /* 장애여부 */
			            , SUPORT_AT             /* 부양여부 */
			            , ALLWNC_PYMNT_AT       /* 수당지급여부 */
			            , ALLWNC_REQST_DE       /* 수당신청일자 */
			            , ALLWNC_AMOUNT         /* 수당금액 */
			            , ALLWNC_AMOUNT_2       /* 수당금액2 */
			            , TAXT_SE               /* 과세구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_1.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , B.SEXDSTN_SE            /* 성별구분 */
			     , B.FAMILY_RELATE_SE      /* 가족관계구분 */
			     , B.FAMILY_NM             /* 가족성명 */
			     , B.BRTHDY                /* 생년월일 */
			     , B.TROBL_AT              /* 장애여부 */
			     , B.SUPORT_AT             /* 부양여부 */
			     , B.ALLWNC_PYMNT_AT       /* 수당지급여부 */
			     , B.ALLWNC_REQST_DE       /* 수당신청일자 */
			     , 0                       /* 수당금액 */
			     , 0                       /* 수당금액2 */
			     , '0'                     /* 과세구분 */
			     , #PYMNT_SE#              /* 지급구분 */
			     , #S_USER_ID#             /* 등록자ID */
			     , SYSDATE                 /* 등록일시 */
			     , #S_USER_ID#             /* 수정자ID */
			     , SYSDATE                 /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			     , TBHRM_HR_FAMILY B
			 WHERE A.PYMNT_YM        = #PYMNT_YM#
			   AND A.SALARY_SE       = #SALARY_SE#
			   AND A.PYMNT_DE        = #PYMNT_DE#
			   AND A.PYMNT_SE        = #PYMNT_SE#
			   AND A.EMPNO           = B.EMPNO
			   AND B.ALLWNC_PYMNT_AT = '1'
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
        ]]>
        </isEqual>  
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert> 
    
   	<!-- 월급여데이터생성- 가족수당(처) 금액적용 -->
    <update id="SAL030101DAO.MtSalaryPymnt_P1080_02" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2"> 
		<![CDATA[
			UPDATE TBSAL_FAMILY_ALLWNC_MANAGE A
			   SET ALLWNC_AMOUNT =
			       (
			              SELECT B.PYMNTAMT
			                FROM TBSAL_PYMNT_DETAIL_CODE B
			               WHERE B.PYMNT_DETAIL_CODE = 'P1080001'
			                 AND B.SE_1              = A.FAMILY_RELATE_SE
			       )     /* 지급금액 */
			 WHERE A.PYMNT_YM = #PYMNT_YM#
			   AND A.PYMNT_SE = #PYMNT_SE#
			   AND A.FAMILY_RELATE_SE IN ('005')        /* 가족관계구분 - 005:처 */
        ]]>
        </isEqual> 

        <isEqual property="PYMNT_SE" compareValue = "4"> 
		<![CDATA[
			UPDATE TBSAL_FAMILY_ALLWNC_MANAGE A
			   SET ALLWNC_AMOUNT =
			       (
			              SELECT B.PYMNTAMT
			                FROM TBSAL_PYMNT_DETAIL_CODE B
			               WHERE B.PYMNT_DETAIL_CODE = 'P1080001'
			                 AND B.SE_1              = A.FAMILY_RELATE_SE
			       )     /* 지급금액 */
			 WHERE A.PYMNT_YM = #PYMNT_YM#
			   AND A.PYMNT_SE = #PYMNT_SE#
			   AND A.FAMILY_RELATE_SE IN ('005')        /* 가족관계구분 - 005:처 */
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>   
    </update>
    
    <!-- 월급여데이터생성- 가족수당(남편) 금액적용 -->
    <update id="SAL030101DAO.MtSalaryPymnt_P1080_07" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2"> 
		<![CDATA[
			UPDATE TBSAL_FAMILY_ALLWNC_MANAGE A
			   SET ALLWNC_AMOUNT =
			       (
			              SELECT B.PYMNTAMT
			                FROM TBSAL_PYMNT_DETAIL_CODE B
			               WHERE B.PYMNT_DETAIL_CODE = 'P1080002'
			                 AND B.SE_1              = A.FAMILY_RELATE_SE
			       )     /* 지급금액 */
			 WHERE A.PYMNT_YM = #PYMNT_YM#
			   AND A.PYMNT_SE = #PYMNT_SE#
			   AND A.FAMILY_RELATE_SE IN ('006')        /* 가족관계구분 - 006:남편 */
        ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "4"> 
		<![CDATA[
			UPDATE TBSAL_FAMILY_ALLWNC_MANAGE A
			   SET ALLWNC_AMOUNT =
			       (
			              SELECT B.PYMNTAMT
			                FROM TBSAL_PYMNT_DETAIL_CODE B
			               WHERE B.PYMNT_DETAIL_CODE = 'P1080002'
			                 AND B.SE_1              = A.FAMILY_RELATE_SE
			       )     /* 지급금액 */
			 WHERE A.PYMNT_YM = #PYMNT_YM#
			   AND A.PYMNT_SE = #PYMNT_SE#
			   AND A.FAMILY_RELATE_SE IN ('006')        /* 가족관계구분 - 006:남편 */
        ]]>
        </isEqual> 

        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>   
    </update>
    
    <!-- 월급여데이터생성- 가족수당(기타)  금액적용 -->
    <update id="SAL030101DAO.MtSalaryPymnt_P1080_03" parameterClass="java.util.HashMap">
        <isEqual property="PYMNT_SE" compareValue = "2"> 
		<![CDATA[
			UPDATE TBSAL_FAMILY_ALLWNC_MANAGE A
			   SET ALLWNC_AMOUNT =
			       (
			              SELECT B.PYMNTAMT
			                FROM TBSAL_PYMNT_DETAIL_CODE B
			               WHERE B.PYMNT_DETAIL_CODE = 'P1080003'
			       )     /* 지급금액 */
			 WHERE A.PYMNT_YM = #PYMNT_YM#
			   AND A.PYMNT_SE = #PYMNT_SE#
			   AND A.FAMILY_RELATE_SE NOT IN ('005', '006')
			   AND
			       (
			              (
			                     A.SEXDSTN_SE = '1'
			                 AND TRUNC((MONTHS_BETWEEN(LAST_DAY(TO_DATE(#PYMNT_YM#||'20', 'YYYYMMDD')), TO_DATE(A.BRTHDY, 'YYYYMMDD')) - 1) / 12) NOT BETWEEN 20 AND 59
			              )
			           OR
			              (
			                     A.SEXDSTN_SE = '2'
			                 AND TRUNC((MONTHS_BETWEEN(LAST_DAY(TO_DATE(#PYMNT_YM#||'20', 'YYYYMMDD')), TO_DATE(A.BRTHDY, 'YYYYMMDD')) - 1) / 12) NOT BETWEEN 20 AND 54
			              )
			           OR
			              (
			                     NVL(A.TROBL_AT, '0') = '1'
			              ) /* 장애인은 나이와 무관하게 지급*/
			       )
		]]>
        </isEqual> 
        <isEqual property="PYMNT_SE" compareValue = "4"> 
		<![CDATA[
			UPDATE TBSAL_FAMILY_ALLWNC_MANAGE A
			   SET ALLWNC_AMOUNT =
			       (
			              SELECT B.PYMNTAMT
			                FROM TBSAL_PYMNT_DETAIL_CODE B
			               WHERE B.PYMNT_DETAIL_CODE = 'P1080003'
			       )     /* 지급금액 */
			 WHERE A.PYMNT_YM = #PYMNT_YM#
			   AND A.PYMNT_SE = #PYMNT_SE#
			   AND A.FAMILY_RELATE_SE NOT IN ('005', '006')
			   AND
			       (
			              (
			                     A.SEXDSTN_SE = '1'
			                 AND TRUNC((MONTHS_BETWEEN(LAST_DAY(TO_DATE(#PYMNT_YM#||'20', 'YYYYMMDD')), TO_DATE(A.BRTHDY, 'YYYYMMDD')) - 1) / 12) NOT BETWEEN 20 AND 59
			              )
			           OR
			              (
			                     A.SEXDSTN_SE = '2'
			                 AND TRUNC((MONTHS_BETWEEN(LAST_DAY(TO_DATE(#PYMNT_YM#||'20', 'YYYYMMDD')), TO_DATE(A.BRTHDY, 'YYYYMMDD')) - 1) / 12) NOT BETWEEN 20 AND 54
			              )
			           OR
			              (
			                     NVL(A.TROBL_AT, '0') = '1'
			              ) /* 장애인은 나이와 무관하게 지급*/
			       )
		]]>
        </isEqual> 
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>   
    </update>
   
    <!-- 월급여데이터생성- 가족수당 3자녀 생성     /* 20세 이하적용시  AND months_between(#PYMNT_YM# || '01',BRTHDY)/12 < 20 */ -->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1080_04" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2"> 
		<![CDATA[
			INSERT
			  INTO TBSAL_FAMILY_ALLWNC_MANAGE
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , SEXDSTN_SE         /* 주민등록번호암호화 */
			            , FAMILY_RELATE_SE      /* 가족관계구분 */
			            , FAMILY_NM             /* 가족성명 */
			            , BRTHDY                /* 생년월일 */
			            , TROBL_AT              /* 장애여부 */
			            , SUPORT_AT             /* 부양여부 */
			            , ALLWNC_PYMNT_AT       /* 수당지급여부 */
			            , ALLWNC_REQST_DE       /* 수당신청일자 */
			            , ALLWNC_AMOUNT         /* 수당금액 */
			            , ALLWNC_AMOUNT_2       /* 수당금액2 */
			            , TAXT_SE               /* 과세구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_1.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , ''                      /* 주민등록번호암호화 */
			     , '007'                   /* 가족관계구분 */
			     , '3자녀'                 /* 가족성명 */
			     , ''                      /* 생년월일 */
			     , ''                      /* 장애여부 */
			     , ''                      /* 부양여부 */
			     , '1'                     /* 수당지급여부 */
			     , ''                      /* 수당신청일자 */
			     , (
			              SELECT C.PYMNTAMT
			                FROM TBSAL_PYMNT_DETAIL_CODE C
			               WHERE C.PYMNT_DETAIL_CODE = 'P1080004'
			       )
			       AS ALLWNC_AMOUNT     /* 수당금액 */
			     , 0                       /* 수당금액2 */
			     , '0'                     /* 과세구분 */
			     , #PYMNT_SE#              /* 지급구분 */
			     , #S_USER_ID#             /* 등록자ID */
			     , SYSDATE                 /* 등록일시 */
			     , #S_USER_ID#             /* 수정자ID */
			     , SYSDATE                 /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_DE  = #PYMNT_DE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
			   AND A.EMPNO IN
			       (
			              SELECT C.EMPNO
			                FROM (
			                                SELECT EMPNO
			                                     , COUNT(EMPNO) AS CO
			                                  FROM TBHRM_HR_FAMILY
			                                 WHERE FAMILY_RELATE_SE = '007'
			                              GROUP BY EMPNO
			                     )
			                     C
			               WHERE C.CO >= 3
			       )
			   AND A.EMPNO IN
			       (
			              SELECT EMPNO
			                FROM TBHRM_HR_FAMILY
			               WHERE FAMILY_RELATE_SE                                = '007'
			                 AND MONTHS_BETWEEN(#PYMNT_YM# || '01', BRTHDY) / 12 < 20
			                 AND ALLWNC_PYMNT_AT                                 = '1'
			       )
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "4"> 
		<![CDATA[
			INSERT
			  INTO TBSAL_FAMILY_ALLWNC_MANAGE
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , SEXDSTN_SE         /* 주민등록번호암호화 */
			            , FAMILY_RELATE_SE      /* 가족관계구분 */
			            , FAMILY_NM             /* 가족성명 */
			            , BRTHDY                /* 생년월일 */
			            , TROBL_AT              /* 장애여부 */
			            , SUPORT_AT             /* 부양여부 */
			            , ALLWNC_PYMNT_AT       /* 수당지급여부 */
			            , ALLWNC_REQST_DE       /* 수당신청일자 */
			            , ALLWNC_AMOUNT         /* 수당금액 */
			            , ALLWNC_AMOUNT_2       /* 수당금액2 */
			            , TAXT_SE               /* 과세구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_1.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , ''                      /* 주민등록번호암호화 */
			     , '007'                   /* 가족관계구분 */
			     , '3자녀'                 /* 가족성명 */
			     , ''                      /* 생년월일 */
			     , ''                      /* 장애여부 */
			     , ''                      /* 부양여부 */
			     , '1'                     /* 수당지급여부 */
			     , ''                      /* 수당신청일자 */
			     , (
			              SELECT C.PYMNTAMT
			                FROM TBSAL_PYMNT_DETAIL_CODE C
			               WHERE C.PYMNT_DETAIL_CODE = 'P1080004'
			       )
			       AS ALLWNC_AMOUNT     /* 수당금액 */
			     , 0                       /* 수당금액2 */
			     , '0'                     /* 과세구분 */
			     , #PYMNT_SE#              /* 지급구분 */
			     , #S_USER_ID#             /* 등록자ID */
			     , SYSDATE                 /* 등록일시 */
			     , #S_USER_ID#             /* 수정자ID */
			     , SYSDATE                 /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_DE  = #PYMNT_DE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
			   AND A.EMPNO IN
			       (
			              SELECT C.EMPNO
			                FROM (
		                                SELECT EMPNO
		                                     , COUNT(EMPNO) AS CO
		                                  FROM TBHRM_HR_FAMILY
		                                 WHERE FAMILY_RELATE_SE = '007'
		                              GROUP BY EMPNO
			                     )
			                     C
			               WHERE C.CO >= 3
			       )
			   AND A.EMPNO IN
			       (
			              SELECT EMPNO
			                FROM TBHRM_HR_FAMILY
			               WHERE FAMILY_RELATE_SE                                = '007'
			                 AND MONTHS_BETWEEN(#PYMNT_YM# || '01', BRTHDY) / 12 < 20
			                 AND ALLWNC_PYMNT_AT                                 = '1'
			       )
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
        ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert> 
    
    <!-- 월급여데이터생성- 가족수당 3자녀 2014년 이후 추가금액 생성    -->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1080_08" parameterClass="java.util.HashMap">
        <isEqual property="PYMNT_SE" compareValue = "2"> 
		<![CDATA[
			INSERT
			  INTO TBSAL_FAMILY_ALLWNC_MANAGE
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , SEXDSTN_SE            /* 남녀구분 */
			            , FAMILY_RELATE_SE      /* 가족관계구분 */
			            , FAMILY_NM             /* 가족성명 */
			            , BRTHDY                /* 생년월일 */
			            , TROBL_AT              /* 장애여부 */
			            , SUPORT_AT             /* 부양여부 */
			            , ALLWNC_PYMNT_AT       /* 수당지급여부 */
			            , ALLWNC_REQST_DE       /* 수당신청일자 */
			            , ALLWNC_AMOUNT         /* 수당금액 */
			            , ALLWNC_AMOUNT_2       /* 수당금액2 */
			            , TAXT_SE               /* 과세구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_1.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , ''                      /* 주민등록번호암호화 */
			     , '007'                   /* 가족관계구분 */
			     , '3자녀2014'             /* 가족성명 */
			     , ''                      /* 생년월일 */
			     , ''                      /* 장애여부 */
			     , ''                      /* 부양여부 */
			     , '1'                     /* 수당지급여부 */
			     , ''                      /* 수당신청일자 */
			     , (
			              SELECT C.PYMNTAMT
			                FROM TBSAL_PYMNT_DETAIL_CODE C
			               WHERE C.PYMNT_DETAIL_CODE = 'P1080005'
			       )
			       AS ALLWNC_AMOUNT     /* 수당금액 */
			     , 0                       /* 수당금액2 */
			     , '0'                     /* 과세구분 */
			     , #PYMNT_SE#              /* 지급구분 */
			     , #S_USER_ID#             /* 등록자ID */
			     , SYSDATE                 /* 등록일시 */
			     , #S_USER_ID#             /* 수정자ID */
			     , SYSDATE                 /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_DE  = #PYMNT_DE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
			   AND A.EMPNO IN
			       (
			              SELECT D.EMPNO
			                FROM TBHRM_HR_FAMILY D, TBSAL_FAMILY_ALLWNC_MANAGE E
			               WHERE D.FAMILY_RELATE_SE      = '007'
			                 AND D.EMPNO                 = E.EMPNO
			                 AND E.FAMILY_NM             = '3자녀'
			                 AND E.PYMNT_YM              = #PYMNT_YM#
			                 AND SUBSTR(D.BRTHDY, 1, 4) >= '2014'
			       )
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "4"> 
		<![CDATA[
			INSERT
			  INTO TBSAL_FAMILY_ALLWNC_MANAGE
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , SEXDSTN_SE         /* 주민등록번호암호화 */
			            , FAMILY_RELATE_SE      /* 가족관계구분 */
			            , FAMILY_NM             /* 가족성명 */
			            , BRTHDY                /* 생년월일 */
			            , TROBL_AT              /* 장애여부 */
			            , SUPORT_AT             /* 부양여부 */
			            , ALLWNC_PYMNT_AT       /* 수당지급여부 */
			            , ALLWNC_REQST_DE       /* 수당신청일자 */
			            , ALLWNC_AMOUNT         /* 수당금액 */
			            , ALLWNC_AMOUNT_2       /* 수당금액2 */
			            , TAXT_SE               /* 과세구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_1.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , ''                      /* 주민등록번호암호화 */
			     , '007'                   /* 가족관계구분 */
			     , '3자녀2014'             /* 가족성명 */
			     , ''                      /* 생년월일 */
			     , ''                      /* 장애여부 */
			     , ''                      /* 부양여부 */
			     , '1'                     /* 수당지급여부 */
			     , ''                      /* 수당신청일자 */
			     , (
			              SELECT C.PYMNTAMT
			                FROM TBSAL_PYMNT_DETAIL_CODE C
			               WHERE C.PYMNT_DETAIL_CODE = 'P1080004'
			       )
			       AS ALLWNC_AMOUNT     /* 수당금액 */
			     , 0                       /* 수당금액2 */
			     , '0'                     /* 과세구분 */
			     , #PYMNT_SE#              /* 지급구분 */
			     , #S_USER_ID#             /* 등록자ID */
			     , SYSDATE                 /* 등록일시 */
			     , #S_USER_ID#             /* 수정자ID */
			     , SYSDATE                 /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_DE  = #PYMNT_DE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
			   AND A.EMPNO IN
			       (
			              SELECT D.EMPNO
			                FROM TBHRM_HR_FAMILY D, TBSAL_FAMILY_ALLWNC_MANAGE E
			               WHERE D.FAMILY_RELATE_SE      = '007'
			                 AND D.EMPNO                 = E.EMPNO
			                 AND E.FAMILY_NM             = '3자녀'
			                 AND E.PYMNT_YM              = #PYMNT_YM#
			                 AND SUBSTR(D.BRTHDY, 1, 4) >= '2014'
			       )
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert> 
    
    <!-- 월급여데이터생성- 가족수당(20세이상자녀 0원)  금액적용 -->
    <update id="SAL030101DAO.MtSalaryPymnt_P1080_05" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2"> 
		<![CDATA[
            UPDATE TBSAL_FAMILY_ALLWNC_MANAGE A
            SET  ALLWNC_AMOUNT 		= 0    /* 지급금액 */
			WHERE A.PYMNT_YM 		= #PYMNT_YM#
			AND months_between(TO_DATE(#PYMNT_YM#,'YYYYMM'), TO_DATE(A.BRTHDY,'YYYYMMDD'))/12 > 20
			AND A.FAMILY_RELATE_SE 	= '007'
			AND A.TROBL_AT 			= '0'
			AND A.PYMNT_SE 			= #PYMNT_SE#
		]]>
        </isEqual>

        <isEqual property="PYMNT_SE" compareValue = "4"> 
		<![CDATA[
            UPDATE TBSAL_FAMILY_ALLWNC_MANAGE A
            SET  ALLWNC_AMOUNT 		= 0    /* 지급금액 */
			WHERE A.PYMNT_YM 		= #PYMNT_YM#
			AND months_between(TO_DATE(#PYMNT_YM#,'YYYYMM'), TO_DATE(A.BRTHDY,'YYYYMMDD'))/12 > 20
			AND A.FAMILY_RELATE_SE 	= '007'
			AND A.TROBL_AT 			= '0'
			AND A.PYMNT_SE 			= #PYMNT_SE#
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>   
    </update>
    
    <!-- 월급여데이터생성- 가족수당(6세이하자녀 비과세)  금액적용 -->
    <update id="SAL030101DAO.MtSalaryPymnt_P1080_06" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2"> 
		<![CDATA[
            UPDATE TBSAL_FAMILY_ALLWNC_MANAGE A
            SET  TAXT_SE 			= '0'            	/* 비과세 (과세로 변경. 확인필요) */
			WHERE A.PYMNT_YM 		= #PYMNT_YM#
			AND months_between(TO_DATE(#PYMNT_YM#,'YYYYMM'), TO_DATE(A.BRTHDY,'YYYYMMDD'))/12 < 7
			AND A.FAMILY_RELATE_SE 	= '007'			
			AND A.PYMNT_SE 			= #PYMNT_SE#
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "4"> 
           <![CDATA[
            UPDATE TBSAL_FAMILY_ALLWNC_MANAGE A
            SET  TAXT_SE 			= '0'            	/* 비과세 (과세로 변경. 확인필요) */
			WHERE A.PYMNT_YM 		= #PYMNT_YM#
			AND months_between(TO_DATE(#PYMNT_YM#,'YYYYMM'), TO_DATE(A.BRTHDY,'YYYYMMDD'))/12 < 7
			AND A.FAMILY_RELATE_SE 	= '007'			
			AND A.PYMNT_SE 			= #PYMNT_SE#
          ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>   
    </update>
   
   	<!-- 월급여데이터생성- 가족수당합계(과세) 생성  -->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1080" parameterClass="java.util.HashMap">
        <isEqual property="PYMNT_SE" compareValue = "2"> 
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , RM_2                  /* 비고2 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , 'P1080'                 /* 지급코드 */
			     , 'P1080'                 /* 지급상세코드 */
			     , (
			              SELECT NVL(SUM(B.ALLWNC_AMOUNT), 0)
			                FROM TBSAL_FAMILY_ALLWNC_MANAGE B
			               WHERE B.EMPNO    = A.EMPNO
			                 AND B.PYMNT_YM = A.PYMNT_YM
			                 AND B.TAXT_SE  = '0'
			       )				     /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , ''                    /* 과세여부 비과세:1 */
			     , '1'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고  */
			     , ''                    /* 비고  */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_DE  = #PYMNT_DE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
        ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "4"> 
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , RM_2                  /* 비고2 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , 'P1080'                 /* 지급코드 */
			     , 'P1080'                 /* 지급상세코드 */
			     , (
			              SELECT NVL(SUM(B.ALLWNC_AMOUNT), 0)
			                FROM TBSAL_FAMILY_ALLWNC_MANAGE B
			               WHERE B.EMPNO    = A.EMPNO
			                 AND B.PYMNT_YM = A.PYMNT_YM
			                 AND B.TAXT_SE  = '0'
			       )				     /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , ''                    /* 과세여부 비과세:1 */
			     , '1'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고  */
			     , ''                    /* 비고  */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_DE  = #PYMNT_DE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
        ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>    
    </insert>
    
    <!-- 월급여데이터생성- 가족수당합계(비과세) 생성  -->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1080_00" parameterClass="java.util.HashMap">
        <isEqual property="PYMNT_SE" compareValue = "2"> 
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , RM_2                  /* 비고2 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , 'P1080'                 /* 지급코드 */
			     , 'P1080'                 /* 지급상세코드 */
			     , (
			              SELECT NVL(SUM(B.ALLWNC_AMOUNT), 0)
			                FROM TBSAL_FAMILY_ALLWNC_MANAGE B
			               WHERE B.EMPNO    = A.EMPNO
			                 AND B.PYMNT_YM = A.PYMNT_YM
			                 AND B.TAXT_SE  = '1'
			       )				     /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , '1'                   /* 과세여부 비과세:1 */
			     , '1'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고  */
			     , ''                    /* 비고  */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_DE  = #PYMNT_DE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
          ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "4"> 
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , RM_2                  /* 비고2 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , 'P1080'                 /* 지급코드 */
			     , 'P1080'                 /* 지급상세코드 */
			     , (
			              SELECT NVL(SUM(B.ALLWNC_AMOUNT), 0)
			                FROM TBSAL_FAMILY_ALLWNC_MANAGE B
			               WHERE B.EMPNO    = A.EMPNO
			                 AND B.PYMNT_YM = A.PYMNT_YM
			                 AND B.TAXT_SE  = '1'
			       )       				 /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , '1'                   /* 과세여부 비과세:1 */
			     , '1'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고  */
			     , ''                    /* 비고  */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_DE  = #PYMNT_DE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
        ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>    
    </insert>
   
   	<!-- 월급여데이터생성- 기본연봉생성 임원 연봉/12-급식보조비-직책보조비-->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1015" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2">
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#            /* 지급년월 */
			     , #SALARY_SE#           /* 급여구분 */
			     , #PYMNT_DE#            /* 지급일자 */
			     , A.EMPNO               /* 사번 */
			     , A.EMPNM               /* 사원명 */
			     , A.DEPT_CODE           /* 부서코드 */
			     , A.CLSF_CODE           /* 직급코드 */
			     , 'P1015'               /* 기본급 */
			     , 'P1015'               /* 지급상세코드 */
			     , SFSAL_DAY_PERC_CALC1 ( FLOOR(
			       (
			              SELECT B.ANSLRY_AMOUNT / 12
			                FROM TBSAL_ANSLRY_INFO B
			               WHERE B.PYMNT_SE = '1'
			                 AND B.APPLC_DE =
			                     (
			                            SELECT MAX(APPLC_DE)
			                              FROM TBSAL_ANSLRY_INFO
			                             WHERE APPLC_DE <= #PYMNT_DE#
			                     )
			                 AND B.EMPNO = A.EMPNO
			       )
			       / 10) * 10 - NVL(
			                          (
			                          SELECT SUM(C.PYMNT_AMOUNT)
			                            FROM TBSAL_MT_PYMNT_DTLS C
			                           WHERE C.EMPNO = A.EMPNO
			                             AND C.PYMNT_DDC_CODE IN ('P1940', 'P1955') /* 급식보조비, 직책보조비 */
			                             AND C.PYMNT_YM = A.PYMNT_YM
			                          )
			                        , 0), A.EMPNO, #PYMNT_YM#, #PYMNT_SE#) AS PYMNT_AMOUNT          /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , ''                    /* 과세여부 */
			     , '1'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_DE  = #PYMNT_DE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
			   AND A.EMPL_SE   = '000'   /* 임원 */
			   AND A.ANSLRY_AT = 'Y'
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert> 
    
    <!-- 월급여데이터생성- 기본연봉생성 직원: 연봉/12-급식보조비-->
    <insert id="SAL030101DAO.MtSalaryPymnt_P1015_2" parameterClass="java.util.HashMap">
        <isEqual property="PYMNT_SE" compareValue = "2">
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#            /* 지급년월 */
			     , #SALARY_SE#           /* 급여구분 */
			     , #PYMNT_DE#            /* 지급일자 */
			     , A.EMPNO               /* 사번 */
			     , A.EMPNM               /* 사원명 */
			     , A.DEPT_CODE           /* 부서코드 */
			     , A.CLSF_CODE           /* 직급코드 */
			     , 'P1015'               /* 기본급 */
			     , 'P1015'               /* 지급상세코드 */
			     , SFSAL_DAY_PERC_CALC1 ( FLOOR(
			       (
			              SELECT B.ANSLRY_AMOUNT / 12
			                FROM TBSAL_ANSLRY_INFO B
			               WHERE B.PYMNT_SE = '1'
			                 AND B.APPLC_DE =
			                     (
			                            SELECT MAX(APPLC_DE)
			                              FROM TBSAL_ANSLRY_INFO
			                             WHERE APPLC_DE <= #PYMNT_DE#
			                     )
			                 AND B.EMPNO = A.EMPNO
			       )
			       / 10) * 10 - NVL(
			                          (
			                          SELECT PYMNTAMT
			                            FROM TBSAL_PYMNT_DETAIL_CODE
			                           WHERE PYMNT_DETAIL_CODE = 'P1940001' /* 급식보조비 */
			                          )
			                        , 0), A.EMPNO, #PYMNT_YM#, #PYMNT_SE#) AS PYMNT_AMOUNT          /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , ''                    /* 과세여부 */
			     , '1'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_DE  = #PYMNT_DE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
			   AND A.EMPL_SE NOT IN ('000')  /* 임원 제외 */
			   AND A.ANSLRY_AT = 'Y'
			   AND NVL(A.DCLZ_SE,0) NOT IN ('216')    	/* 휴직자 제외 */
        ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert> 
   
    <!-- 0원삭제 삭제 -->
    <delete id="SAL030101DAO.MtSalaryPymnt_P_0_D" parameterClass="java.util.HashMap">
        <![CDATA[
			DELETE
			  FROM TBSAL_MT_PYMNT_DTLS
			 WHERE PYMNT_YM             = #PYMNT_YM#
			   AND SALARY_SE            = #SALARY_SE#
			   AND PYMNT_SE             = #PYMNT_SE#
			   AND NVL(PYMNT_AMOUNT, 0) = 0
        ]]>         
        <isNotEmpty property="PYMNT_DDC_CODE">
			   AND SUBSTR(PYMNT_DETAIL_CODE, 1, 5)  = #PYMNT_DDC_CODE#
        </isNotEmpty>
    </delete> 
   
   <!-- [추가] 2016.08.05  ==> 연봉제일시 P1010 제거  후  P1015를  P1015로 UPDATE  -->
    <update id="SAL030101DAO.MtSalaryPymnt_DELETE_ANSLRY_AT" parameterClass="java.util.HashMap">
     <![CDATA[
     DECLARE
     BEGIN
     
		/* 연봉제 P1010 제거 */
		DELETE
		  FROM TBSAL_MT_PYMNT_DTLS A
		 WHERE A.EMPNO IN
		       (
		              SELECT EMPNO
		                FROM TBSAL_MT_SALARY_PYMNT B
		               WHERE B.PYMNT_YM  = #PYMNT_YM#
		                 AND B.PYMNT_DE  = #PYMNT_DE#
		                 AND B.SALARY_SE = #SALARY_SE#
		                 AND B.PYMNT_SE  = #PYMNT_SE#
		                 AND B.ANSLRY_AT = 'Y'
		       )
		   AND A.PYMNT_YM       = #PYMNT_YM#
		   AND A.PYMNT_DE       = #PYMNT_DE#
		   AND A.SALARY_SE      = #SALARY_SE#
		   AND A.PYMNT_SE       = #PYMNT_SE#
		   AND A.PYMNT_DDC_CODE = 'P1010';
		
		/* P1015를 P1010으로 강제 UPDATE */
		UPDATE TBSAL_MT_PYMNT_DTLS
		   SET PYMNT_DDC_CODE = 'P1010'
		 WHERE PYMNT_YM       = #PYMNT_YM#
		   AND PYMNT_DE       = #PYMNT_DE#
		   AND SALARY_SE      = #SALARY_SE#
		   AND PYMNT_SE       = #PYMNT_SE#
		   AND PYMNT_DDC_CODE = 'P1015';
		  
	END;	  		
    ]]>
    </update>

    <!-- 월급여데이터생성-과세총액(호봉제/연봉제=>전체급여과세금액 ) -->
    <update id="SAL030101DAO.MtSalaryPymnt_TAXT_AMOUNT" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2"> 
		<![CDATA[
			UPDATE TBSAL_MT_SALARY_PYMNT B
			   SET B.TAXT_AMOUNT =
			       (
			              SELECT NVL(SUM(A.PYMNT_AMOUNT), 0)
			                FROM TBSAL_MT_PYMNT_DTLS A
			               WHERE A.PYMNT_YM      = B.PYMNT_YM
			                 AND A.PYMNT_DE      = B.PYMNT_DE
			                 AND A.SALARY_SE     = B.SALARY_SE
			                 AND A.EMPNO         = B.EMPNO
			                 AND A.TAXT_AT IS NULL
			       )
			 WHERE B.PYMNT_YM  = #PYMNT_YM#
			   AND B.PYMNT_DE  = #PYMNT_DE#
			   AND B.SALARY_SE = #SALARY_SE#
			   AND B.PYMNT_SE  = #PYMNT_SE#
		]]>
        </isEqual>

        <isEqual property="PYMNT_SE" compareValue = "1"> 
		<![CDATA[
				UPDATE TBSAL_MT_SALARY_PYMNT B
				   SET B.TAXT_AMOUNT =
				       (
				              SELECT NVL(SUM(A.PYMNT_AMOUNT), 0)
				                FROM TBSAL_MT_PYMNT_DTLS A
				               WHERE A.PYMNT_YM      = B.PYMNT_YM
				                 AND A.PYMNT_DE      = B.PYMNT_DE
				                 AND A.SALARY_SE     = B.SALARY_SE
				                 AND A.EMPNO         = B.EMPNO
				                 AND A.TAXT_AT IS NULL
				       )
				 WHERE B.PYMNT_YM  = #PYMNT_YM#
				   AND B.PYMNT_DE  = #PYMNT_DE#
				   AND B.SALARY_SE = #SALARY_SE#
				   AND B.PYMNT_SE  = #PYMNT_SE#			
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "4"> 
		<![CDATA[
			UPDATE TBSAL_MT_SALARY_PYMNT B
			   SET B.TAXT_AMOUNT =
			       (
			              SELECT NVL(SUM(A.PYMNT_AMOUNT), 0)
			                FROM TBSAL_MT_PYMNT_DTLS A
			               WHERE A.PYMNT_YM      = B.PYMNT_YM
			                 AND A.PYMNT_DE      = B.PYMNT_DE
			                 AND A.EMPNO         = B.EMPNO
			                 AND A.TAXT_AT IS NULL
			       )
			 WHERE B.PYMNT_YM  = #PYMNT_YM#
			   AND B.PYMNT_DE  = #PYMNT_DE#
			   AND B.SALARY_SE = #SALARY_SE#
			   AND B.PYMNT_SE  = #PYMNT_SE#				
		]]>
        </isEqual>
    </update>
    
    <!-- 월급여데이터생성- 연말정산 환급액 생성  -->
    <insert id="SAL030101DAO.MtSalaryPymnt_YND_BONUS" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2"> 
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , RM_2                  /* 비고2 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , 'P1240'                 /* 지급코드 */
			     , 'P1240'                 /* 지급상세코드 */
			     , (
			              SELECT NVL(DDCT_RETUN_INCMTAX, 0) + NVL(DDCT_RETUN_LCLTY_INCMTAX, 0)
			                FROM TBSAL_YND_EXCCLC_DETAIL
			               WHERE DDCT_RETUN_INCMTAX > 0
			                 AND PYMNT_YM           = A.PYMNT_YM
			                 AND EMPNO              = A.EMPNO
			       )
			       AS DDCT_RETUN_INCMTAX /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , '1'                   /* 과세여부 비과세:1 */
			     , '1'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고  */
			     , ''                    /* 비고  */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_DE  = #PYMNT_DE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
			   AND EMPNO IN
			       (
			              SELECT EMPNO
			                FROM TBSAL_YND_EXCCLC_DETAIL
			               WHERE DDCT_RETUN_INCMTAX > 0
			                 AND PYMNT_YM           = #PYMNT_YM#
			       )
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "4"> 
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_PYMNT_DTLS
			       (
			              SN                    /* 일련번호 */
			            , PYMNT_YM              /* 지급년월 */
			            , SALARY_SE             /* 급여구분 */
			            , PYMNT_DE              /* 지급일자 */
			            , EMPNO                 /* 사번 */
			            , EMPNM                 /* 사원명 */
			            , DEPT_CODE             /* 부서코드 */
			            , CLSF_CODE             /* 직급코드 */
			            , PYMNT_DDC_CODE        /* 지급공제코드 */
			            , PYMNT_DETAIL_CODE     /* 지급상세코드 */
			            , PYMNT_AMOUNT          /* 지급금액 */
			            , UPDT_AMOUNT           /* 수정금액 */
			            , TAXT_AT               /* 과세여부 */
			            , ALLWNC_SE             /* 수당구분 */
			            , PRMPC_SE              /* 원가구분 */
			            , PYMNT_SE              /* 지급구분 */
			            , CLOS_AT               /* 마감여부 */
			            , CLOS_DE               /* 마감일자 */
			            , RM                    /* 비고 */
			            , RM_2                  /* 비고2 */
			            , REGISTER_ID           /* 등록자ID */
			            , REGIST_DT             /* 등록일시 */
			            , UPDUSR_ID             /* 수정자ID */
			            , UPDT_DT               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , A.EMPNO                 /* 사번 */
			     , A.EMPNM                 /* 사원명 */
			     , A.DEPT_CODE             /* 부서코드 */
			     , A.CLSF_CODE             /* 직급코드 */
			     , 'P1240'                 /* 지급코드 */
			     , 'P1240'                 /* 지급상세코드 */
			     , (
			              SELECT NVL(DDCT_RETUN_INCMTAX, 0) + NVL(DDCT_RETUN_LCLTY_INCMTAX, 0)
			                FROM TBSAL_YND_EXCCLC_DETAIL
			               WHERE DDCT_RETUN_INCMTAX > 0
			                 AND PYMNT_YM           = A.PYMNT_YM
			                 AND EMPNO              = A.EMPNO
			       )
			       AS DDCT_RETUN_INCMTAX /* 지급금액 */
			     , 0                     /* 수정금액 */
			     , '1'                   /* 과세여부 비과세:1 */
			     , '1'                   /* 수당구분  일반:1, 복리:2 */
			     , ''                    /* 원가구분 */
			     , #PYMNT_SE#            /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고  */
			     , ''                    /* 비고  */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT A
			 WHERE A.PYMNT_YM  = #PYMNT_YM#
			   AND A.SALARY_SE = #SALARY_SE#
			   AND A.PYMNT_DE  = #PYMNT_DE#
			   AND A.PYMNT_SE  = #PYMNT_SE#
			   AND EMPNO IN
			       (
			              SELECT EMPNO
			                FROM TBSAL_YND_EXCCLC_DETAIL
			               WHERE DDCT_RETUN_INCMTAX > 0
			                 AND PYMNT_YM           = #PYMNT_YM#
			       )
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>    
    </insert>
   
    <!-- 월급여데이터생성-비과세총액 -->
    <update id="SAL030101DAO.MtSalaryPymnt_TAXXMPT_AMOUNT" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2"> 
		<![CDATA[
			UPDATE TBSAL_MT_SALARY_PYMNT B
			   SET B.TAXXMPT_AMOUNT =
			       (
			              SELECT NVL(SUM(A.PYMNT_AMOUNT), 0)
			                FROM TBSAL_MT_PYMNT_DTLS A
			               WHERE A.PYMNT_YM  = B.PYMNT_YM
			                 AND A.SALARY_SE = B.SALARY_SE
			                 AND A.PYMNT_DE  = B.PYMNT_DE
			                 AND A.EMPNO     = B.EMPNO
			                 AND A.TAXT_AT   = '1'
			       )
			 WHERE B.PYMNT_YM  = #PYMNT_YM#
			   AND B.PYMNT_DE  = #PYMNT_DE#
			   AND B.SALARY_SE = #SALARY_SE#
			   AND B.PYMNT_SE  = #PYMNT_SE#
		]]>
        </isEqual>

        <isEqual property="PYMNT_SE" compareValue = "1"> 
		<![CDATA[
			UPDATE TBSAL_MT_SALARY_PYMNT B
			   SET B.TAXXMPT_AMOUNT =
			       (
			              SELECT NVL(SUM(A.PYMNT_AMOUNT), 0)
			                FROM TBSAL_MT_PYMNT_DTLS A
			               WHERE A.PYMNT_YM  = B.PYMNT_YM
			                 AND A.SALARY_SE = B.SALARY_SE
			                 AND A.PYMNT_DE  = B.PYMNT_DE
			                 AND A.EMPNO     = B.EMPNO
			                 AND A.TAXT_AT   = '1'
			       )
			 WHERE B.PYMNT_YM  = #PYMNT_YM#
			   AND B.PYMNT_DE  = #PYMNT_DE#
			   AND B.SALARY_SE = #SALARY_SE#
			   AND B.PYMNT_SE  = #PYMNT_SE#
		]]>
        </isEqual>
         
        <isEqual property="PYMNT_SE" compareValue = "4"> 
		<![CDATA[
			UPDATE TBSAL_MT_SALARY_PYMNT B
			   SET B.TAXXMPT_AMOUNT =
			       (
			              SELECT NVL(SUM(A.PYMNT_AMOUNT), 0)
			                FROM TBSAL_MT_PYMNT_DTLS A
			               WHERE A.PYMNT_YM = B.PYMNT_YM
			                 AND A.EMPNO    = B.EMPNO
			                 AND A.TAXT_AT  = '1'
			       )
			 WHERE B.PYMNT_YM  = #PYMNT_YM#
			   AND B.PYMNT_DE  = #PYMNT_DE#
			   AND B.SALARY_SE = #SALARY_SE#
			   AND B.PYMNT_SE  = #PYMNT_SE#		
		]]>
        </isEqual> 
    </update>
    
	<!-- 월급여데이터생성-기준연봉   추가:2016.02.18    -->
    <update id="SAL030101DAO.MtSalaryPymnt_STDR_ANSLRY" parameterClass="java.util.HashMap">
        <isEqual property="PYMNT_SE" compareValue = "2"> 
		<![CDATA[
            UPDATE TBSAL_MT_SALARY_PYMNT A
			SET  A.STDR_ANSLRY = (
				        (SELECT B.BASS_AMOUNT
						 FROM TBSAL_SLARY_TABLE B
						 WHERE B.CLSF_CODE = A.CLSF_CODE
						 AND B.SRCLS = A.SRCLS
						 AND B.EMPL_SE = A.EMPL_SE 
						 AND B.APPLC_DE = (SELECT MAX(APPLC_DE) FROM TBSAL_SLARY_TABLE WHERE APPLC_DE <= #PYMNT_DE#)) +
						 
						 FLOOR(((SELECT B.BASS_AMOUNT
						 FROM TBSAL_SLARY_TABLE B
						 WHERE B.CLSF_CODE = A.CLSF_CODE
						 AND B.SRCLS = A.SRCLS
						 AND B.EMPL_SE = A.EMPL_SE 
						 AND B.APPLC_DE = (SELECT MAX(APPLC_DE) FROM TBSAL_SLARY_TABLE WHERE APPLC_DE <= #PYMNT_DE#)) *
						(SELECT SE_1 
						 FROM TBSAL_PYMNT_DETAIL_CODE
						 WHERE PYMNT_DETAIL_CODE = 'P1050001')) / 1000) * 10  +
						
						(SELECT PYMNTAMT 
						 FROM TBSAL_PYMNT_DETAIL_CODE B
						 WHERE SUBSTR(B.PYMNT_DETAIL_CODE,1,5) = 'P1060'
						 AND (
						 SELECT 
						 FLOOR((NVL((SELECT FLOOR(MONTHS_BETWEEN(to_date(#PYMNT_YM# || '20','YYYYMMDD' ), TO_DATE(C.ECNY_DE,'YYYYMMDD')) / 12) * 12 +
						 					MOD(FLOOR(MONTHS_BETWEEN(to_date(#PYMNT_YM# || '20','YYYYMMDD' ), TO_DATE(C.ECNY_DE,'YYYYMMDD'))), 12)
						 			   FROM TBHRM_HR_MASTR C
						 			  WHERE C.STTUS_SE = '000'
						 				AND C.EMPNO = A.EMPNO),0) +	
								NVL((SELECT FLOOR(MONTHS_BETWEEN(to_date(D.DMBLZ_DE,'YYYYMMDD' ), TO_DATE(D.ENST_DE,'YYYYMMDD')) / 12) * 12 +
								      		MOD(FLOOR(MONTHS_BETWEEN(to_date(D.DMBLZ_DE,'YYYYMMDD' ), TO_DATE(D.ENST_DE,'YYYYMMDD'))), 12) AS BB
									   FROM TBHRM_HR_ETC D
									  WHERE  D.EMPNO = A.EMPNO),0) +
						
								NVL((SELECT SUM(E.CRTFC_CAREER_YY) * 12 + SUM(E.CRTFC_CAREER_MT)
									   FROM  TBHRM_HR_CAREER E
									  WHERE E.EMPNO = A.EMPNO),0) - 
						
								NVL((SELECT NVL(SUM(F.LMTT_PD),0)
									   FROM TBHRM_DSCPL_DSPS F
									  WHERE F.EMPNO = A.EMPNO
									    AND #PYMNT_YM# BETWEEN SUBSTR(F.DSPS_BGNDE,1,6) AND SUBSTR(F.LMTT_ENDDE,1,6)),0)) /12) AS YEAR
						  FROM DUAL ) <= B.SE_2
						   AND (
						        SELECT 
								FLOOR((NVL((SELECT FLOOR(MONTHS_BETWEEN(to_date(#PYMNT_YM#  || '20','YYYYMMDD' ), TO_DATE(C.ECNY_DE,'YYYYMMDD')) / 12) * 12 +
								      			   MOD(FLOOR(MONTHS_BETWEEN(to_date(#PYMNT_YM# || '20','YYYYMMDD' ), TO_DATE(C.ECNY_DE,'YYYYMMDD'))), 12)
											  FROM TBHRM_HR_MASTR C
											 WHERE C.STTUS_SE = '000'
											   AND C.EMPNO = A.EMPNO),0) +
						
								NVL((SELECT FLOOR(MONTHS_BETWEEN(to_date(D.DMBLZ_DE,'YYYYMMDD' ), TO_DATE(D.ENST_DE,'YYYYMMDD')) / 12) * 12 +
								      		MOD(FLOOR(MONTHS_BETWEEN(to_date(D.DMBLZ_DE,'YYYYMMDD' ), TO_DATE(D.ENST_DE,'YYYYMMDD'))), 12) AS BB
									   FROM TBHRM_HR_ETC D
									  WHERE D.EMPNO = A.EMPNO),0) +
						
								NVL((SELECT SUM(E.CRTFC_CAREER_YY) * 12 + SUM(E.CRTFC_CAREER_MT)
								       FROM TBHRM_HR_CAREER E
								      WHERE E.EMPNO = A.EMPNO),0) - 
						
								NVL((SELECT NVL(SUM(F.LMTT_PD),0)
								       FROM TBHRM_DSCPL_DSPS F
								      WHERE F.EMPNO = A.EMPNO
								        AND #PYMNT_YM# BETWEEN SUBSTR(F.DSPS_BGNDE,1,6) AND SUBSTR(F.LMTT_ENDDE,1,6)),0)) /12) AS YEAR
						    FROM DUAL  ) >= B.SE_1)      +
						
						(SELECT PYMNTAMT 
						 FROM TBSAL_PYMNT_DETAIL_CODE B
						 WHERE SUBSTR(B.PYMNT_DETAIL_CODE,1,5) = 'P1940') )
			WHERE A.PYMNT_YM 	= #PYMNT_YM#
			AND A.PYMNT_DE 		= #PYMNT_DE#
			AND A.SALARY_SE 	= #SALARY_SE#	
			AND A.PYMNT_SE 		= #PYMNT_SE#			
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1"> 
			SELECT SYSDATE FROM DUAL  
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "4"> 
			SELECT SYSDATE FROM DUAL  
        </isEqual> 
    </update>
        
   	<!-- 공제시작 =================================================== --> 
    
    <!-- 월급여데이터생성- 공제 - 소득세, 원천징수조정-->
    <insert id="SAL030101DAO.MtSalaryPymnt_S2010" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2">
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_DDC_DTLS
			       (
			              SN                  /* 일련번호 */
			            , PYMNT_YM            /* 지급년월 */
			            , SALARY_SE           /* 급여구분 */
			            , PYMNT_DE            /* 지급일자 */
			            , PYMNT_SE            /* 지급구분 */
			            , EMPNO               /* 사번 */
			            , EMPNM               /* 사원명 */
			            , DEPT_CODE           /* 부서코드 */
			            , CLSF_CODE           /* 직급코드 */
			            , PYMNT_DDC_CODE      /* 지급공제코드 */
			            , DDC_DETAIL_CODE     /* 공제상세코드 */
			            , DDC_AMOUNT          /* 공제금액 */
			            , UPDT_DDC_AMOUNT     /* 수정공제금액 */
			            , CLOS_AT             /* 마감여부 */
			            , CLOS_DE             /* 마감일자 */
			            , RM                  /* 비고 */
			            , REGISTER_ID         /* 등록자ID */
			            , REGIST_DT           /* 등록일시 */
			            , UPDUSR_ID           /* 수정자ID */
			            , UPDT_DT             /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL     /* 일련번호 */
			     , #PYMNT_YM#             /* 지급년월 */
			     , #SALARY_SE#            /* 급여구분 */
			     , #PYMNT_DE#             /* 지급일자 */
			     , #PYMNT_SE#             /* 지급구분 */
			     , B.EMPNO                /* 사번 */
			     , B.EMPNM                /* 사원명 */
			     , B.DEPT_CODE            /* 부서코드 */
			     , B.CLSF_CODE            /* 직급코드 */
			     , 'S2010'                /* 지급공제코드 */
			     , 'S2010'                /* 공제상세코드 */
			     , SFSAL_TAX_INCOM_AMT(B.EMPNO, #PYMNT_YM#, NVL(C.TAXT_AMOUNT, 0), NVL(B.HN_DDC_NMPR, 0)) AS TAXX_AMT /* 공제금액 */
			     , 0                      /* 수정공제금액 */
			     , ''                     /* 마감여부 마감:1 */
			     , ''                     /* 마감일자 */
			     , ''                     /* 비고 */
			     , #S_USER_ID#            /* 등록자ID */
			     , SYSDATE                /* 등록일시 */
			     , #S_USER_ID#            /* 수정자ID */
			     , SYSDATE                /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT B
			   INNER JOIN
			              (
			                         SELECT PYMNT_YM
			                              , SALARY_SE
			                              , EMPNO
			                              , SUM(TAXT_AMOUNT) AS TAXT_AMOUNT  /* 과세소득 합산 */
			                           FROM TBSAL_MT_SALARY_PYMNT
			                          WHERE PYMNT_YM  = #PYMNT_YM#
			                            AND SALARY_SE = #SALARY_SE#
			                       GROUP BY PYMNT_YM
			                              , SALARY_SE
			                              , EMPNO
			              )
			              C
			           ON B.PYMNT_YM  = C.PYMNT_YM
			          AND B.SALARY_SE = C.SALARY_SE
			          AND B.EMPNO     = C.EMPNO
			 WHERE B.PYMNT_YM         = #PYMNT_YM#
			   AND B.SALARY_SE        = #SALARY_SE#
			   AND B.PYMNT_DE         = #PYMNT_DE#
			   AND B.PYMNT_SE         = #PYMNT_SE#
			   AND NVL(B.DCLZ_SE,0) NOT IN ('216')		/* 휴직자 제외 */	
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "4">
		<![CDATA[
			 INSERT
			  INTO TBSAL_MT_DDC_DTLS
			       (
			              SN                  /* 일련번호 */
			            , PYMNT_YM            /* 지급년월 */
			            , SALARY_SE           /* 급여구분 */
			            , PYMNT_DE            /* 지급일자 */
			            , PYMNT_SE            /* 지급구분 */
			            , EMPNO               /* 사번 */
			            , EMPNM               /* 사원명 */
			            , DEPT_CODE           /* 부서코드 */
			            , CLSF_CODE           /* 직급코드 */
			            , PYMNT_DDC_CODE      /* 지급공제코드 */
			            , DDC_DETAIL_CODE     /* 공제상세코드 */
			            , DDC_AMOUNT          /* 공제금액 */
			            , UPDT_DDC_AMOUNT     /* 수정공제금액 */
			            , CLOS_AT             /* 마감여부 */
			            , CLOS_DE             /* 마감일자 */
			            , RM                  /* 비고 */
			            , REGISTER_ID         /* 등록자ID */
			            , REGIST_DT           /* 등록일시 */
			            , UPDUSR_ID           /* 수정자ID */
			            , UPDT_DT             /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL     /* 일련번호 */
			     , #PYMNT_YM#             /* 지급년월 */
			     , #SALARY_SE#            /* 급여구분 */
			     , #PYMNT_DE#             /* 지급일자 */
			     , #PYMNT_SE#             /* 지급구분 */
			     , B.EMPNO                /* 사번 */
			     , B.EMPNM                /* 사원명 */
			     , B.DEPT_CODE            /* 부서코드 */
			     , B.CLSF_CODE            /* 직급코드 */
			     , 'S2010'                /* 지급공제코드 */
			     , 'S2010'                /* 공제상세코드 */
			     , SFSAL_TAX_INCOM_AMT(B.EMPNO, #PYMNT_YM#, NVL(C.TAXT_AMOUNT, 0), NVL(B.HN_DDC_NMPR, 0)) AS TAXX_AMT /* 공제금액 */
			     , 0                      /* 수정공제금액 */
			     , ''                     /* 마감여부 마감:1 */
			     , ''                     /* 마감일자 */
			     , ''                     /* 비고 */
			     , #S_USER_ID#            /* 등록자ID */
			     , SYSDATE                /* 등록일시 */
			     , #S_USER_ID#            /* 수정자ID */
			     , SYSDATE                /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT B
			   INNER JOIN
			              (
			                         SELECT PYMNT_YM
			                              , SALARY_SE
			                              , EMPNO
			                              , SUM(TAXT_AMOUNT) AS TAXT_AMOUNT  /* 과세소득 합산 */
			                           FROM TBSAL_MT_SALARY_PYMNT
			                          WHERE PYMNT_YM  = #PYMNT_YM#
			                            AND SALARY_SE = #SALARY_SE#
			                       GROUP BY PYMNT_YM
			                              , SALARY_SE
			                              , EMPNO
			              )
			              C
			           ON B.PYMNT_YM  = C.PYMNT_YM
			          AND B.SALARY_SE = C.SALARY_SE
			          AND B.EMPNO     = C.EMPNO
			 WHERE B.PYMNT_YM         = #PYMNT_YM#
			   AND B.SALARY_SE        = #SALARY_SE#
			   AND B.PYMNT_DE         = #PYMNT_DE#
			   AND B.PYMNT_SE         = #PYMNT_SE#
			   AND NVL(B.DCLZ_SE,0) NOT IN ('216')		/* 휴직자 제외 */
 		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert> 
    
    <!-- 월급여데이터생성- 공제 - 지방소득세-->
    <insert id="SAL030101DAO.MtSalaryPymnt_S2020" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2">
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_DDC_DTLS
			       (
			              SN                  /* 일련번호 */
			            , PYMNT_YM            /* 지급년월 */
			            , SALARY_SE           /* 급여구분 */
			            , PYMNT_DE            /* 지급일자 */
			            , PYMNT_SE            /* 지급구분 */
			            , EMPNO               /* 사번 */
			            , EMPNM               /* 사원명 */
			            , DEPT_CODE           /* 부서코드 */
			            , CLSF_CODE           /* 직급코드 */
			            , PYMNT_DDC_CODE      /* 지급공제코드 */
			            , DDC_DETAIL_CODE     /* 공제상세코드 */
			            , DDC_AMOUNT          /* 공제금액 */
			            , UPDT_DDC_AMOUNT     /* 수정공제금액 */
			            , CLOS_AT             /* 마감여부 */
			            , CLOS_DE             /* 마감일자 */
			            , RM                  /* 비고 */
			            , REGISTER_ID         /* 등록자ID */
			            , REGIST_DT           /* 등록일시 */
			            , UPDUSR_ID           /* 수정자ID */
			            , UPDT_DT             /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL     /* 일련번호 */
			     , #PYMNT_YM#             /* 지급년월 */
			     , #SALARY_SE#            /* 급여구분 */
			     , #PYMNT_DE#             /* 지급일자 */
			     , #PYMNT_SE#
			     , B.EMPNO                /* 사번 */
			     , B.EMPNM                /* 사원명 */
			     , B.DEPT_CODE            /* 부서코드 */
			     , B.CLSF_CODE            /* 직급코드 */
			     , 'S2020'                /* 지급공제코드 */
			     , 'S2020'                /* 공제상세코드 */
			     , (
			              SELECT FLOOR(NVL(A.DDC_AMOUNT, 0) / 100) * 10
			                FROM TBSAL_MT_DDC_DTLS A
			               WHERE A.PYMNT_YM       = B.PYMNT_YM
			                 AND A.PYMNT_DE       = B.PYMNT_DE
			                 AND A.SALARY_SE      = B.SALARY_SE
			                 AND A.EMPNO          = B.EMPNO
			                 AND A.PYMNT_DDC_CODE = 'S2010'
			       )
			       AS TAXX_AMT         /* 공제금액 */
			     , 0                      /* 수정공제금액 */
			     , ''                     /* 마감여부 마감:1 */
			     , ''                     /* 마감일자 */
			     , ''                     /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE                /* 등록일시 */
			     , #S_USER_ID#            /* 수정자ID */
			     , SYSDATE                /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT B
			 WHERE B.PYMNT_YM  = #PYMNT_YM#
			   AND B.SALARY_SE = #SALARY_SE#
			   AND B.PYMNT_DE  = #PYMNT_DE#
			   AND B.PYMNT_SE  = #PYMNT_SE#
			   AND NVL(B.DCLZ_SE,0) NOT IN ('216')	/* 휴직자 제외 */
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "4">
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_DDC_DTLS
			       (
			              SN                  /* 일련번호 */
			            , PYMNT_YM            /* 지급년월 */
			            , SALARY_SE           /* 급여구분 */
			            , PYMNT_DE            /* 지급일자 */
			            , PYMNT_SE            /* 지급구분 */
			            , EMPNO               /* 사번 */
			            , EMPNM               /* 사원명 */
			            , DEPT_CODE           /* 부서코드 */
			            , CLSF_CODE           /* 직급코드 */
			            , PYMNT_DDC_CODE      /* 지급공제코드 */
			            , DDC_DETAIL_CODE     /* 공제상세코드 */
			            , DDC_AMOUNT          /* 공제금액 */
			            , UPDT_DDC_AMOUNT     /* 수정공제금액 */
			            , CLOS_AT             /* 마감여부 */
			            , CLOS_DE             /* 마감일자 */
			            , RM                  /* 비고 */
			            , REGISTER_ID         /* 등록자ID */
			            , REGIST_DT           /* 등록일시 */
			            , UPDUSR_ID           /* 수정자ID */
			            , UPDT_DT             /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL     /* 일련번호 */
			     , #PYMNT_YM#             /* 지급년월 */
			     , #SALARY_SE#            /* 급여구분 */
			     , #PYMNT_DE#             /* 지급일자 */
			     , #PYMNT_SE#
			     , B.EMPNO                /* 사번 */
			     , B.EMPNM                /* 사원명 */
			     , B.DEPT_CODE            /* 부서코드 */
			     , B.CLSF_CODE            /* 직급코드 */
			     , 'S2020'                /* 지급공제코드 */
			     , 'S2020'               /* 공제상세코드 */
			     , (
			              SELECT FLOOR(NVL(A.DDC_AMOUNT, 0) / 100) * 10
			                FROM TBSAL_MT_DDC_DTLS A
			               WHERE A.PYMNT_YM       = B.PYMNT_YM
			                 AND A.PYMNT_DE       = B.PYMNT_DE
			                 AND A.SALARY_SE      = B.SALARY_SE
			                 AND A.EMPNO          = B.EMPNO
			                 AND A.PYMNT_DDC_CODE = 'S2010'
			       )
			       AS TAXX_AMT         /* 공제금액 */
			     , 0                      /* 수정공제금액 */
			     , ''                     /* 마감여부 마감:1 */
			     , ''                     /* 마감일자 */
			     , ''                     /* 비고 */
			     , #S_USER_ID#            /* 등록자ID */
			     , SYSDATE                /* 등록일시 */
			     , #S_USER_ID#            /* 수정자ID */
			     , SYSDATE                /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT B
			 WHERE B.PYMNT_YM  = #PYMNT_YM#
			   AND B.SALARY_SE = #SALARY_SE#
			   AND B.PYMNT_DE  = #PYMNT_DE#
			   AND B.PYMNT_SE  = #PYMNT_SE#
			   AND NVL(B.DCLZ_SE,0) NOT IN ('216')	/* 휴직자 제외 */	
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>
    </insert> 
    
    <!-- 월급여데이터생성- 공제 - 연말정산 소득세-->
    <insert id="SAL030101DAO.MtSalaryPymnt_S2210" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2">
		<![CDATA[
			 INSERT
			  INTO TBSAL_MT_DDC_DTLS
			       (
			              SN                 /* 일련번호 */
			            , PYMNT_YM           /* 지급년월 */
			            , SALARY_SE          /* 급여구분 */
			            , PYMNT_DE           /* 지급일자 */
			            , PYMNT_SE           /* 지급구분 */
			            , EMPNO              /* 사번 */
			            , EMPNM              /* 사원명 */
			            , DEPT_CODE          /* 부서코드 */
			            , CLSF_CODE          /* 직급코드 */
			            , PYMNT_DDC_CODE     /* 지급공제코드 */
			            , DDC_DETAIL_CODE    /* 공제상세코드 */
			            , DDC_AMOUNT         /* 공제금액 */
			            , UPDT_DDC_AMOUNT    /* 수정공제금액 */
			            , CLOS_AT            /* 마감여부 */
			            , CLOS_DE            /* 마감일자 */
			            , RM                 /* 비고 */
			            , REGISTER_ID        /* 등록자ID */
			            , REGIST_DT          /* 등록일시 */
			            , UPDUSR_ID          /* 수정자ID */
			            , UPDT_DT            /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL      /* 일련번호 */
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , #PYMNT_SE#
			     , B.EMPNO                 /* 사번 */
			     , B.EMPNM                 /* 사원명 */
			     , B.DEPT_CODE             /* 부서코드 */
			     , B.CLSF_CODE             /* 직급코드 */
			     , 'S2210'                 /* 지급공제코드 */
			     , 'S2210'                 /* 공제상세코드 */
			     , (
			              SELECT DDCT_LEV_INCMTAX
			                FROM TBSAL_YND_EXCCLC_DETAIL
			               WHERE DDCT_LEV_INCMTAX > 0
			                 AND PYMNT_YM         = B.PYMNT_YM
			                 AND EMPNO            = B.EMPNO
			       )
			       AS TAXX_AMT    /* 공제금액 */
			     , 0                     /* 수정공제금액 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT B
			 WHERE B.PYMNT_YM  = #PYMNT_YM#
			   AND B.SALARY_SE = #SALARY_SE#
			   AND B.PYMNT_DE  = #PYMNT_DE#
			   AND B.PYMNT_SE  = #PYMNT_SE#
			   AND B.EMPNO IN
			       (
			              SELECT EMPNO
			                FROM TBSAL_YND_EXCCLC_DETAIL
			               WHERE DDCT_LEV_INCMTAX > 0
			                 AND PYMNT_YM         = #PYMNT_YM#
			       )
 		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "4">
		<![CDATA[
			 INSERT
			  INTO TBSAL_MT_DDC_DTLS
			       (
			              SN                 /* 일련번호 */
			            , PYMNT_YM           /* 지급년월 */
			            , SALARY_SE          /* 급여구분 */
			            , PYMNT_DE           /* 지급일자 */
			            , PYMNT_SE           /* 지급구분 */
			            , EMPNO              /* 사번 */
			            , EMPNM              /* 사원명 */
			            , DEPT_CODE          /* 부서코드 */
			            , CLSF_CODE          /* 직급코드 */
			            , PYMNT_DDC_CODE     /* 지급공제코드 */
			            , DDC_DETAIL_CODE    /* 공제상세코드 */
			            , DDC_AMOUNT         /* 공제금액 */
			            , UPDT_DDC_AMOUNT    /* 수정공제금액 */
			            , CLOS_AT            /* 마감여부 */
			            , CLOS_DE            /* 마감일자 */
			            , RM                 /* 비고 */
			            , REGISTER_ID        /* 등록자ID */
			            , REGIST_DT          /* 등록일시 */
			            , UPDUSR_ID          /* 수정자ID */
			            , UPDT_DT            /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL      /* 일련번호 */
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , #PYMNT_SE#
			     , B.EMPNO                 /* 사번 */
			     , B.EMPNM                 /* 사원명 */
			     , B.DEPT_CODE             /* 부서코드 */
			     , B.CLSF_CODE             /* 직급코드 */
			     , 'S2210'                 /* 지급공제코드 */
			     , 'S2210'                 /* 공제상세코드 */
			     , (
			              SELECT DDCT_LEV_INCMTAX
			                FROM TBSAL_YND_EXCCLC_DETAIL
			               WHERE DDCT_LEV_INCMTAX > 0
			                 AND PYMNT_YM         = A.PYMNT_YM
			                 AND EMPNO            = A.EMPNO
			       )
			       AS TAXX_AMT    /* 공제금액 */
			     , 0                     /* 수정공제금액 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT B
			 WHERE B.PYMNT_YM  = #PYMNT_YM#
			   AND B.SALARY_SE = #SALARY_SE#
			   AND B.PYMNT_DE  = #PYMNT_DE#
			   AND B.PYMNT_SE  = #PYMNT_SE#
			   AND B.EMPNO IN
			       (
			              SELECT EMPNO
			                FROM TBSAL_YND_EXCCLC_DETAIL
			               WHERE DDCT_LEV_INCMTAX > 0
			                 AND PYMNT_YM         = #PYMNT_YM#
			       )
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert> 
    
    <!-- 월급여데이터생성- 공제 - 연말정산 지방소득세-->
    <insert id="SAL030101DAO.MtSalaryPymnt_S2021" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2">
		<![CDATA[
			 INSERT
			  INTO TBSAL_MT_DDC_DTLS
			       (
			              SN                 /* 일련번호 */
			            , PYMNT_YM           /* 지급년월 */
			            , SALARY_SE          /* 급여구분 */
			            , PYMNT_DE           /* 지급일자 */
			            , PYMNT_SE           /* 지급구분 */
			            , EMPNO              /* 사번 */
			            , EMPNM              /* 사원명 */
			            , DEPT_CODE          /* 부서코드 */
			            , CLSF_CODE          /* 직급코드 */
			            , PYMNT_DDC_CODE     /* 지급공제코드 */
			            , DDC_DETAIL_CODE    /* 공제상세코드 */
			            , DDC_AMOUNT         /* 공제금액 */
			            , UPDT_DDC_AMOUNT    /* 수정공제금액 */
			            , CLOS_AT            /* 마감여부 */
			            , CLOS_DE            /* 마감일자 */
			            , RM                 /* 비고 */
			            , REGISTER_ID        /* 등록자ID */
			            , REGIST_DT          /* 등록일시 */
			            , UPDUSR_ID          /* 수정자ID */
			            , UPDT_DT            /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL      /* 일련번호 */
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , #PYMNT_SE#
			     , B.EMPNO                 /* 사번 */
			     , B.EMPNM                 /* 사원명 */
			     , B.DEPT_CODE             /* 부서코드 */
			     , B.CLSF_CODE             /* 직급코드 */
			     , 'S2021'                 /* 지급공제코드 */
			     , 'S2021'                 /* 공제상세코드 */
			     , (
			              SELECT DDCT_LEV_LCLTY_INCMTAX
			                FROM TBSAL_YND_EXCCLC_DETAIL
			               WHERE DDCT_LEV_LCLTY_INCMTAX > 0
			                 AND PYMNT_YM               = B.PYMNT_YM
			                 AND EMPNO                  = B.EMPNO
			       )
			       AS TAXX_AMT    /* 공제금액 */
			     , 0                     /* 수정공제금액 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT B
			 WHERE B.PYMNT_YM  = #PYMNT_YM#
			   AND B.SALARY_SE = #SALARY_SE#
			   AND B.PYMNT_DE  = #PYMNT_DE#
			   AND B.PYMNT_SE  = #PYMNT_SE#
			   AND B.EMPNO IN
			       (
			              SELECT EMPNO
			                FROM TBSAL_YND_EXCCLC_DETAIL
			               WHERE DDCT_LEV_LCLTY_INCMTAX > 0
			                 AND PYMNT_YM               = #PYMNT_YM#
			       )
        
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "4">
		<![CDATA[
			  INSERT
			  INTO TBSAL_MT_DDC_DTLS
			       (
			              SN                 /* 일련번호 */
			            , PYMNT_YM           /* 지급년월 */
			            , SALARY_SE          /* 급여구분 */
			            , PYMNT_DE           /* 지급일자 */
			            , PYMNT_SE           /* 지급구분 */
			            , EMPNO              /* 사번 */
			            , EMPNM              /* 사원명 */
			            , DEPT_CODE          /* 부서코드 */
			            , CLSF_CODE          /* 직급코드 */
			            , PYMNT_DDC_CODE     /* 지급공제코드 */
			            , DDC_DETAIL_CODE    /* 공제상세코드 */
			            , DDC_AMOUNT         /* 공제금액 */
			            , UPDT_DDC_AMOUNT    /* 수정공제금액 */
			            , CLOS_AT            /* 마감여부 */
			            , CLOS_DE            /* 마감일자 */
			            , RM                 /* 비고 */
			            , REGISTER_ID        /* 등록자ID */
			            , REGIST_DT          /* 등록일시 */
			            , UPDUSR_ID          /* 수정자ID */
			            , UPDT_DT            /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL      /* 일련번호 */
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , #PYMNT_SE#
			     , B.EMPNO                 /* 사번 */
			     , B.EMPNM                 /* 사원명 */
			     , B.DEPT_CODE             /* 부서코드 */
			     , B.CLSF_CODE             /* 직급코드 */
			     , 'S2021'                 /* 지급공제코드 */
			     , 'S2021'                 /* 공제상세코드 */
			     , (
			              SELECT DDCT_LEV_LCLTY_INCMTAX
			                FROM TBSAL_YND_EXCCLC_DETAIL
			               WHERE DDCT_LEV_LCLTY_INCMTAX > 0
			                 AND PYMNT_YM               = A.PYMNT_YM
			                 AND EMPNO                  = A.EMPNO
			       )
			       AS TAXX_AMT    /* 공제금액 */
			     , 0                     /* 수정공제금액 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT B
			 WHERE B.PYMNT_YM  = #PYMNT_YM#
			   AND B.SALARY_SE = #SALARY_SE#
			   AND B.PYMNT_DE  = #PYMNT_DE#
			   AND B.PYMNT_SE  = #PYMNT_SE#
			   AND B.EMPNO IN
			       (
			              SELECT EMPNO
			                FROM TBSAL_YND_EXCCLC_DETAIL
			               WHERE DDCT_LEV_LCLTY_INCMTAX > 0
			                 AND PYMNT_YM               = #PYMNT_YM#
			       )
     	]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert> 
    
    <!-- 월급여데이터생성- 공제 - 급여압류 -->
    <insert id="SAL030101DAO.MtSalaryPymnt_S2280" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2">
 		<![CDATA[
			INSERT
			  INTO TBSAL_MT_DDC_DTLS
			       (
			              SN                 /* 일련번호 */
			            , PYMNT_YM           /* 지급년월 */
			            , SALARY_SE          /* 급여구분 */
			            , PYMNT_DE           /* 지급일자 */
			            , PYMNT_SE           /* 지급구분 */
			            , EMPNO              /* 사번 */
			            , EMPNM              /* 사원명 */
			            , DEPT_CODE          /* 부서코드 */
			            , CLSF_CODE          /* 직급코드 */
			            , PYMNT_DDC_CODE     /* 지급공제코드 */
			            , DDC_DETAIL_CODE    /* 공제상세코드 */
			            , DDC_AMOUNT         /* 공제금액 */
			            , UPDT_DDC_AMOUNT    /* 수정공제금액 */
			            , CLOS_AT            /* 마감여부 */
			            , CLOS_DE            /* 마감일자 */
			            , RM                 /* 비고 */
			            , REGISTER_ID        /* 등록자ID */
			            , REGIST_DT          /* 등록일시 */
			            , UPDUSR_ID          /* 수정자ID */
			            , UPDT_DT            /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL      /* 일련번호 */
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , #PYMNT_SE#
			     , B.EMPNO                 /* 사번 */
			     , B.EMPNM                 /* 사원명 */
			     , B.DEPT_CODE             /* 부서코드 */
			     , B.CLSF_CODE             /* 직급코드 */
			     , 'S2280'                 /* 지급공제코드 */
			     , 'S2280'                 /* 공제상세코드 */
			     , (
			              SELECT SUM(C.SEIZR_AMOUNT)
			                FROM TBSAL_MENDNG_SEIZR_TKBAK A
			                   , TBSAL_MENDNG_SEIZR_TKBAK_PYMNT C
			               WHERE A.SN                     = C.SN
			                 AND SUBSTR(C.PYMNT_DE, 1, 6) = #PYMNT_YM#
			                 AND A.EMPNO                  = B.EMPNO
			       )
			       AS DDC_AMOUNT         /* 공제금액 */
			     , 0                     /* 수정공제금액 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT B
			 WHERE B.PYMNT_YM  = #PYMNT_YM#
			   AND B.SALARY_SE = #SALARY_SE#
			   AND B.PYMNT_DE  = #PYMNT_DE#
			   AND B.PYMNT_SE  = #PYMNT_SE#
			   AND B.EMPNO IN
			       (
			              SELECT D.EMPNO
			                FROM TBSAL_MENDNG_SEIZR_TKBAK D
			               WHERE D.SEIZR_ENDDE IS NULL
			       )
			   AND NVL(B.DCLZ_SE,0) NOT IN ('216')	/* 휴직자 제외 */
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert> 
    
    <!-- 월급여데이터생성- 공제 - 건강보험 -->
    <insert id="SAL030101DAO.MtSalaryPymnt_S2110" parameterClass="java.util.HashMap">
		<isEqual property="PYMNT_SE" compareValue = "2">
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_DDC_DTLS
			       (
			              SN                 /* 일련번호 */
			            , PYMNT_YM           /* 지급년월 */
			            , SALARY_SE          /* 급여구분 */
			            , PYMNT_DE           /* 지급일자 */
			            , PYMNT_SE           /* 지급구분 */
			            , EMPNO              /* 사번 */
			            , EMPNM              /* 사원명 */
			            , DEPT_CODE          /* 부서코드 */
			            , CLSF_CODE          /* 직급코드 */
			            , PYMNT_DDC_CODE     /* 지급공제코드 */
			            , DDC_DETAIL_CODE    /* 공제상세코드 */
			            , DDC_AMOUNT         /* 공제금액 */
			            , UPDT_DDC_AMOUNT    /* 수정공제금액 */
			            , CLOS_AT            /* 마감여부 */
			            , CLOS_DE            /* 마감일자 */
			            , RM                 /* 비고 */
			            , REGISTER_ID        /* 등록자ID */
			            , REGIST_DT          /* 등록일시 */
			            , UPDUSR_ID          /* 수정자ID */
			            , UPDT_DT            /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL      /* 일련번호 */
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , #PYMNT_SE#
			     , B.EMPNO                 /* 사번 */
			     , B.EMPNM                 /* 사원명 */
			     , B.DEPT_CODE             /* 부서코드 */
			     , B.CLSF_CODE             /* 직급코드 */
			     , 'S2110'                 /* 지급공제코드 */
			     , 'S2110'                 /* 공제상세코드 */
			     , (
			              SELECT FLOOR( NVL(A.HLTHINS_SM_AMOUNT, 0) / 10) * 10
			                FROM TBSAL_HLTHINS A
			               WHERE A.APPLC_DE =
			                     (
			                            SELECT MAX(APPLC_DE)
			                              FROM TBSAL_HLTHINS
			                             WHERE APPLC_DE <= #PYMNT_DE#
			                     )
			                 AND A.EMPNO = B.EMPNO
			       )
			       AS DDC_AMOUNT         /* 공제금액 */
			     , 0                     /* 수정공제금액 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT B
			 WHERE B.PYMNT_YM  = #PYMNT_YM#
			   AND B.SALARY_SE = #SALARY_SE#
			   AND B.PYMNT_DE  = #PYMNT_DE#
			   AND B.PYMNT_SE  = #PYMNT_SE#
			   AND NVL(B.DCLZ_SE,0) NOT IN ('216')	/* 휴직자 제외 */
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "4">
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_DDC_DTLS
			       (
			              SN                 /* 일련번호 */
			            , PYMNT_YM           /* 지급년월 */
			            , SALARY_SE          /* 급여구분 */
			            , PYMNT_DE           /* 지급일자 */
			            , PYMNT_SE           /* 지급구분 */
			            , EMPNO              /* 사번 */
			            , EMPNM              /* 사원명 */
			            , DEPT_CODE          /* 부서코드 */
			            , CLSF_CODE          /* 직급코드 */
			            , PYMNT_DDC_CODE     /* 지급공제코드 */
			            , DDC_DETAIL_CODE    /* 공제상세코드 */
			            , DDC_AMOUNT         /* 공제금액 */
			            , UPDT_DDC_AMOUNT    /* 수정공제금액 */
			            , CLOS_AT            /* 마감여부 */
			            , CLOS_DE            /* 마감일자 */
			            , RM                 /* 비고 */
			            , REGISTER_ID        /* 등록자ID */
			            , REGIST_DT          /* 등록일시 */
			            , UPDUSR_ID          /* 수정자ID */
			            , UPDT_DT            /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL      /* 일련번호 */
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , #PYMNT_SE#
			     , B.EMPNO                 /* 사번 */
			     , B.EMPNM                 /* 사원명 */
			     , B.DEPT_CODE             /* 부서코드 */
			     , B.CLSF_CODE             /* 직급코드 */
			     , 'S2110'                 /* 지급공제코드 */
			     , 'S2110'                 /* 공제상세코드 */
			     , (
			              SELECT FLOOR( NVL(A.HLTHINS_SM_AMOUNT, 0) / 10) * 10
			                FROM TBSAL_HLTHINS A
			               WHERE A.APPLC_DE =
			                     (
			                            SELECT MAX(APPLC_DE)
			                              FROM TBSAL_HLTHINS
			                             WHERE APPLC_DE <= #PYMNT_DE#
			                     )
			                 AND A.EMPNO = B.EMPNO
			       )
			       AS DDC_AMOUNT         /* 공제금액 */
			     , 0                     /* 수정공제금액 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT B
			 WHERE B.PYMNT_YM  = #PYMNT_YM#
			   AND B.SALARY_SE = #SALARY_SE#
			   AND B.PYMNT_DE  = #PYMNT_DE#
			   AND B.PYMNT_SE  = #PYMNT_SE#
			   AND NVL(B.DCLZ_SE,0) NOT IN ('216')	/* 휴직자 제외 */	
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert> 
  
    <!-- 월급여데이터생성- 공제 - 국민연금 -->
    <insert id="SAL030101DAO.MtSalaryPymnt_S2120" parameterClass="java.util.HashMap">
        <isEqual property="PYMNT_SE" compareValue = "2">
 		<![CDATA[
			 INSERT
			  INTO TBSAL_MT_DDC_DTLS
			       (
			              SN                 /* 일련번호 */
			            , PYMNT_YM           /* 지급년월 */
			            , SALARY_SE          /* 급여구분 */
			            , PYMNT_DE           /* 지급일자 */
			            , PYMNT_SE           /* 지급구분 */
			            , EMPNO              /* 사번 */
			            , EMPNM              /* 사원명 */
			            , DEPT_CODE          /* 부서코드 */
			            , CLSF_CODE          /* 직급코드 */
			            , PYMNT_DDC_CODE     /* 지급공제코드 */
			            , DDC_DETAIL_CODE    /* 공제상세코드 */
			            , DDC_AMOUNT         /* 공제금액 */
			            , UPDT_DDC_AMOUNT    /* 수정공제금액 */
			            , CLOS_AT            /* 마감여부 */
			            , CLOS_DE            /* 마감일자 */
			            , RM                 /* 비고 */
			            , REGISTER_ID        /* 등록자ID */
			            , REGIST_DT          /* 등록일시 */
			            , UPDUSR_ID          /* 수정자ID */
			            , UPDT_DT            /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL      /* 일련번호 */
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , #PYMNT_SE#
			     , B.EMPNO                 /* 사번 */
			     , B.EMPNM                 /* 사원명 */
			     , B.DEPT_CODE             /* 부서코드 */
			     , B.CLSF_CODE             /* 직급코드 */
			     , 'S2120'                 /* 지급공제코드 */
			     , 'S2120'                 /* 공제상세코드 */
			     , (
			              SELECT FLOOR( NVL(A.NPN_AMOUNT, 0) / 10 ) * 10
			                FROM TBSAL_NPN A
			               WHERE A.APPLC_DE =
			                     (
			                            SELECT MAX(APPLC_DE)
			                              FROM TBSAL_HLTHINS
			                             WHERE APPLC_DE <= #PYMNT_DE#
			                     )
			                 AND A.EMPNO = B.EMPNO
			       )
			       AS DDC_AMOUNT         /* 공제금액 */
			     , 0                     /* 수정공제금액 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT B
			 WHERE B.PYMNT_YM  = #PYMNT_YM#
			   AND B.SALARY_SE = #SALARY_SE#
			   AND B.PYMNT_DE  = #PYMNT_DE#
			   AND B.PYMNT_SE  = #PYMNT_SE#
			   AND B.EMPNO NOT IN
			       (
			              SELECT EMPNO
			                FROM TBHRM_HR_MASTR
			               WHERE MONTHS_BETWEEN(TO_DATE(#PYMNT_YM#, 'YYYYMM'), TO_DATE(BRTHDY, 'YYYYMMDD')) / 12 > 60
			                 AND STTUS_SE                                                                        = '000'
			       )
			   AND NVL(B.DCLZ_SE,0) NOT IN ('216')	/* 휴직자 제외 */		
  		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "4">
     	<![CDATA[
			INSERT
			  INTO TBSAL_MT_DDC_DTLS
			       (
			              SN                 /* 일련번호 */
			            , PYMNT_YM           /* 지급년월 */
			            , SALARY_SE          /* 급여구분 */
			            , PYMNT_DE           /* 지급일자 */
			            , PYMNT_SE           /* 지급구분 */
			            , EMPNO              /* 사번 */
			            , EMPNM              /* 사원명 */
			            , DEPT_CODE          /* 부서코드 */
			            , CLSF_CODE          /* 직급코드 */
			            , PYMNT_DDC_CODE     /* 지급공제코드 */
			            , DDC_DETAIL_CODE    /* 공제상세코드 */
			            , DDC_AMOUNT         /* 공제금액 */
			            , UPDT_DDC_AMOUNT    /* 수정공제금액 */
			            , CLOS_AT            /* 마감여부 */
			            , CLOS_DE            /* 마감일자 */
			            , RM                 /* 비고 */
			            , REGISTER_ID        /* 등록자ID */
			            , REGIST_DT          /* 등록일시 */
			            , UPDUSR_ID          /* 수정자ID */
			            , UPDT_DT            /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL      /* 일련번호 */
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , #PYMNT_SE#
			     , B.EMPNO                 /* 사번 */
			     , B.EMPNM                 /* 사원명 */
			     , B.DEPT_CODE             /* 부서코드 */
			     , B.CLSF_CODE             /* 직급코드 */
			     , 'S2120'                 /* 지급공제코드 */
			     , 'S2120'                 /* 공제상세코드 */
			     , (
			              SELECT FLOOR( NVL(A.NPN_AMOUNT, 0) / 10 ) * 10
			                FROM TBSAL_NPN A
			               WHERE A.APPLC_DE =
			                     (
			                            SELECT MAX(APPLC_DE)
			                              FROM TBSAL_HLTHINS
			                             WHERE APPLC_DE <= #PYMNT_DE#
			                     )
			                 AND A.EMPNO = B.EMPNO
			       )
			       AS DDC_AMOUNT         /* 공제금액 */
			     , 0                     /* 수정공제금액 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT B
			 WHERE B.PYMNT_YM  = #PYMNT_YM#
			   AND B.SALARY_SE = #SALARY_SE#
			   AND B.PYMNT_DE  = #PYMNT_DE#
			   AND B.PYMNT_SE  = #PYMNT_SE#
			   AND B.EMPNO NOT IN
			       (
			              SELECT EMPNO
			                FROM TBHRM_HR_MASTR
			               WHERE MONTHS_BETWEEN(TO_DATE(#PYMNT_YM#, 'YYYYMM'), TO_DATE(BRTHDY, 'YYYYMMDD')) / 12 > 60
			                 AND STTUS_SE                                                                        = '000'
			       )
			   AND NVL(B.DCLZ_SE,0) NOT IN ('216')		/* 휴직자 제외 */	
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert> 
    
    <!-- 월급여데이터생성- 공제 - 고용보험 -->
    <insert id="SAL030101DAO.MtSalaryPymnt_S2150" parameterClass="java.util.HashMap">
        <isEqual property="PYMNT_SE" compareValue = "2">
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_DDC_DTLS
			       (
			              SN                 /* 일련번호 */
			            , PYMNT_YM           /* 지급년월 */
			            , SALARY_SE          /* 급여구분 */
			            , PYMNT_DE           /* 지급일자 */
			            , PYMNT_SE           /* 지급구분 */
			            , EMPNO              /* 사번 */
			            , EMPNM              /* 사원명 */
			            , DEPT_CODE          /* 부서코드 */
			            , CLSF_CODE          /* 직급코드 */
			            , PYMNT_DDC_CODE     /* 지급공제코드 */
			            , DDC_DETAIL_CODE    /* 공제상세코드 */
			            , DDC_AMOUNT         /* 공제금액 */
			            , UPDT_DDC_AMOUNT    /* 수정공제금액 */
			            , CLOS_AT            /* 마감여부 */
			            , CLOS_DE            /* 마감일자 */
			            , RM                 /* 비고 */
			            , REGISTER_ID        /* 등록자ID */
			            , REGIST_DT          /* 등록일시 */
			            , UPDUSR_ID          /* 수정자ID */
			            , UPDT_DT            /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL      /* 일련번호 */
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , #PYMNT_SE#
			     , B.EMPNO                 /* 사번 */
			     , B.EMPNM        /* 사원명 */
			     , B.DEPT_CODE     /* 부서코드 */
			     , B.CLSF_CODE    /* 직급코드 */
			     , 'S2150'                 /* 지급공제코드 */
			     , 'S2150'                 /* 공제상세코드 */
			     , FLOOR(NVL(A.TAXT_AMOUNT, 0) *
			       (
			              SELECT NVL(LABRR_BND, 0)
			                FROM TBSAL_SOCTY_INSRNC_TARIFF
			               WHERE APPLC_DE =
			                     (
			                            SELECT MAX(APPLC_DE)
			                              FROM TBSAL_SOCTY_INSRNC_TARIFF
			                             WHERE APPLC_DE < #PYMNT_DE#
			                     )
			                 AND INSRNC_CODE = '40'
			       )
			       / 100 / 10) * 10 AS DDC_AMOUNT
			     , 0                     /* 수정공제금액 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT B
			LEFT OUTER JOIN
			              (
			                         SELECT EMPNO
			                              , SUM(TAXT_AMOUNT) AS TAXT_AMOUNT
			                           FROM TBSAL_MT_SALARY_PYMNT
			                          WHERE PYMNT_YM  = #PYMNT_YM#
			                            AND SALARY_SE = #SALARY_SE#
			                       GROUP BY EMPNO
			              )
			              A
			           ON A.EMPNO = B.EMPNO
			 WHERE B.PYMNT_YM     = #PYMNT_YM#
			   AND B.SALARY_SE    = #SALARY_SE#
			   AND B.PYMNT_DE     = #PYMNT_DE#
			   AND B.PYMNT_SE     = #PYMNT_SE#
			   AND B.EMPL_SE NOT IN ('000')
			   AND B.EMPNO NOT IN
			       (
			              SELECT EMPNO
			                FROM TBHRM_HR_MASTR
			               WHERE MONTHS_BETWEEN(TO_DATE(#PYMNT_YM#, 'YYYYMM'), TO_DATE(BRTHDY, 'YYYYMMDD')) / 12 > 65
			                 AND STTUS_SE                                                                        = '000'
			       )
			   AND NVL(B.DCLZ_SE,0) NOT IN ('216')		/* 휴직자 제외 */
        ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "4">
		<![CDATA[
			 INSERT
			  INTO TBSAL_MT_DDC_DTLS
			       (
			              SN                 /* 일련번호 */
			            , PYMNT_YM           /* 지급년월 */
			            , SALARY_SE          /* 급여구분 */
			            , PYMNT_DE           /* 지급일자 */
			            , PYMNT_SE           /* 지급구분 */
			            , EMPNO              /* 사번 */
			            , EMPNM              /* 사원명 */
			            , DEPT_CODE          /* 부서코드 */
			            , CLSF_CODE          /* 직급코드 */
			            , PYMNT_DDC_CODE     /* 지급공제코드 */
			            , DDC_DETAIL_CODE    /* 공제상세코드 */
			            , DDC_AMOUNT         /* 공제금액 */
			            , UPDT_DDC_AMOUNT    /* 수정공제금액 */
			            , CLOS_AT            /* 마감여부 */
			            , CLOS_DE            /* 마감일자 */
			            , RM                 /* 비고 */
			            , REGISTER_ID        /* 등록자ID */
			            , REGIST_DT          /* 등록일시 */
			            , UPDUSR_ID          /* 수정자ID */
			            , UPDT_DT            /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL      /* 일련번호 */
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , #PYMNT_SE#
			     , B.EMPNO                 /* 사번 */
			     , B.EMPNM                 /* 사원명 */
			     , B.DEPT_CODE             /* 부서코드 */
			     , B.CLSF_CODE             /* 직급코드 */
			     , 'S2150'                 /* 지급공제코드 */
			     , 'S2150'                 /* 공제상세코드 */
			     , TRUNC(B.TAXT_AMOUNT *
			       (
			              SELECT LABRR_BND
			                FROM TBSAL_SOCTY_INSRNC_TARIFF
			               WHERE INSRNC_CODE = '40'
			                 AND APPLC_DE    =
			                     (
			                            SELECT MAX(APPLC_DE)
			                              FROM TBSAL_SOCTY_INSRNC_TARIFF
			                             WHERE INSRNC_CODE = '40'
			                     )
			       )
			       / 1000) * 10 AS DDC_AMOUNT         /* 공제금액 */
			     , 0                     /* 수정공제금액 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT B
			 WHERE B.PYMNT_YM  = #PYMNT_YM#
			   AND B.SALARY_SE = #SALARY_SE#
			   AND B.PYMNT_DE  = #PYMNT_DE#
			   AND B.PYMNT_SE  = #PYMNT_SE#
			   AND B.EMPNO NOT IN
			       (
			              SELECT EMPNO
			                FROM TBHRM_HR_MASTR
			               WHERE MONTHS_BETWEEN(TO_DATE(#PYMNT_YM#, 'YYYYMM'), TO_DATE(BRTHDY, 'YYYYMMDD')) / 12 > 65
			                 AND STTUS_SE                                                                        = '000'
			       )
			   AND NVL(B.DCLZ_SE,0) NOT IN ('216')		/* 휴직자 제외 */
        ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert> 
    
    <!-- 월급여데이터생성- 공제 - 노동조합 가입정보입력 -->
    <insert id="SAL030101DAO.MtSalaryPymnt_S2250_1" parameterClass="java.util.HashMap">
        <isEqual property="PYMNT_SE" compareValue = "2">
			 INSERT
			  INTO TBSAL_LBUN_SBSCRB
			       (
			              DDC_YM    		/* 공제년월 */
			            , EMPNO    			/* 사번 */
			            , EMPNM    			/* 사원명 */
			            , DEPT_CODE   		/* 부서코드 */
			            , CLSF_CODE   		/* 직급코드 */
			            , SRCLS    			/* 호봉 */
			            , SBSCRB_DE   		/* 가입일자 */
			            , SECSN_DE   		/* 탈퇴일자 */
			            , LBUN_RSPOFC_NM  	/* 노조직책명 */
			            , REGISTER_ID        /* 등록자ID */
			            , REGIST_DT          /* 등록일시 */
			            , UPDUSR_ID          /* 수정자ID */
			            , UPDT_DT            /* 수정일시 */
			       )
			SELECT #PYMNT_YM#
			     , A.EMPNO
			     , B.EMPNM
			     , B.DEPT_CODE
			     , B.PAY_CLSF_SE
			     , B.SRCLS
			     , A.LBUN_BGNDE  		/* 노조가입일 */
			     , A.LBUN_ENDDE  		/* 노조탈퇴일 */
			     , A.LBUN_RSPOFC_NM 	/* 노조직책명 */
			     , #S_USER_ID#        	/* 등록자ID */
			     , SYSDATE            	/* 등록일시 */
			     , #S_USER_ID#        	/* 수정자ID */
			     , SYSDATE            	/* 수정일시 */
			  FROM TBHRM_HR_ETC A
			     , TBHRM_HR_MASTR B
			 WHERE A.EMPNO          = B.EMPNO
			   AND B.STTUS_SE       = '000'
			   AND A.LBUN_SBSCRB_AT = '1'  /* 노동조합가입여부 (1:가입) */
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert> 
    
    <!-- 월급여데이터생성- 공제 - 노동조합비 -->
    <insert id="SAL030101DAO.MtSalaryPymnt_S2250" parameterClass="java.util.HashMap">
        <isEqual property="PYMNT_SE" compareValue = "2">
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_DDC_DTLS
			       (
			              SN                                    /* 일련번호 */
			            , PYMNT_YM                              /* 지급년월 */
			            , SALARY_SE                             /* 급여구분 */
			            , PYMNT_DE                              /* 지급일자 */
			            , PYMNT_SE                              /* 지급구분 */
			            , EMPNO                                 /* 사번 */
			            , EMPNM                                 /* 사원명 */
			            , DEPT_CODE                             /* 부서코드 */
			            , CLSF_CODE                             /* 직급코드 */
			            , PYMNT_DDC_CODE                       /* 지급공제코드 */
			            , DDC_DETAIL_CODE                      /* 공제상세코드 */
			            , DDC_AMOUNT                            /* 공제금액 */
			            , UPDT_DDC_AMOUNT                      /* 수정공제금액 */
			            , CLOS_AT                               /* 마감여부 */
			            , CLOS_DE                               /* 마감일자 */
			            , RM                                    /* 비고 */
			            , REGISTER_ID                           /* 등록자ID */
			            , REGIST_DT                             /* 등록일시 */
			            , UPDUSR_ID                             /* 수정자ID */
			            , UPDT_DT                               /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL                                        /* 일련번호 */
			     , #PYMNT_YM#                                                /* 지급년월 */
			     , #SALARY_SE#                                               /* 급여구분 */
			     , #PYMNT_DE#                                                /* 지급일자 */
			     , #PYMNT_SE#
			     , B.EMPNO                                                   /* 사번 */
			     , B.EMPNM                                                   /* 사원명 */
			     , B.DEPT_CODE                                               /* 부서코드 */
			     , B.CLSF_CODE                                               /* 직급코드 */
			     , 'S2250'                                                  /* 지급공제코드 */
			     , 'S2250'                                                  /* 공제상세코드 */
			     , SFSAL_DAY_PERC_CALC1 ((ROUND((C.BASS_AMOUNT *
			       (
			              SELECT SE_1
			                FROM TBSAL_DDC_DETAIL_CODE
			               WHERE DDC_DETAIL_CODE = 'S2250001'
			       )
			       / 1000)) * 10), B.EMPNO, #PYMNT_YM#, #PYMNT_SE#) AS DDC_AMOUNT                           /* 공제금액 */
			     , 0                                                        /* 수정공제금액 */
			     , ''                                                      /* 마감여부 마감:1 */
			     , ''                                                        /* 마감일자 */
			     , ''                                                        /* 비고 */
			     , #S_USER_ID#                                               /* 등록자ID */
			     , SYSDATE                                                   /* 등록일시 */
			     , #S_USER_ID#                                               /* 수정자ID */
			     , SYSDATE                                                   /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT B
			     , TBSAL_SLARY_TABLE C
			     , TBSAL_LBUN_SBSCRB D
			 WHERE B.PYMNT_YM  = #PYMNT_YM#
			   AND B.PYMNT_YM  = D.DDC_YM
			   AND B.EMPNO     = D.EMPNO
			   AND B.EMPL_SE   = C.EMPL_SE
			   AND B.CLSF_CODE = C.CLSF_CODE
			   AND B.SRCLS     = C.SRCLS
			   AND B.SALARY_SE = #SALARY_SE#
			   AND B.PYMNT_DE  = #PYMNT_DE#
			   AND B.PYMNT_SE  = #PYMNT_SE#
			   AND C.APPLC_DE  =
			       (
			              SELECT MAX(APPLC_DE) AS APPLC_DE
			                FROM TBSAL_SLARY_TABLE
			       )
			   AND NVL(B.DCLZ_SE, 0) NOT IN ('216')	/* 휴직자 제외 */
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL
        </isEqual>  
    </insert> 
    
    <!-- 월급여데이터생성- 공제 - 식권구입비 (1일자) -->
    <insert id="SAL030101DAO.MtSalaryPymnt_S2298" parameterClass="java.util.HashMap">
        <isEqual property="PYMNT_SE" compareValue = "1">
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_DDC_DTLS
			       (
			              SN                 /* 일련번호 */
			            , PYMNT_YM           /* 지급년월 */
			            , SALARY_SE          /* 급여구분 */
			            , PYMNT_DE           /* 지급일자 */
			            , PYMNT_SE           /* 지급구분 */
			            , EMPNO              /* 사번 */
			            , EMPNM              /* 사원명 */
			            , DEPT_CODE          /* 부서코드 */
			            , CLSF_CODE          /* 직급코드 */
			            , PYMNT_DDC_CODE     /* 지급공제코드 */
			            , DDC_DETAIL_CODE    /* 공제상세코드 */
			            , DDC_AMOUNT         /* 공제금액 */
			            , UPDT_DDC_AMOUNT    /* 수정공제금액 */
			            , CLOS_AT            /* 마감여부 */
			            , CLOS_DE            /* 마감일자 */
			            , RM                 /* 비고 */
			            , REGISTER_ID        /* 등록자ID */
			            , REGIST_DT          /* 등록일시 */
			            , UPDUSR_ID          /* 수정자ID */
			            , UPDT_DT            /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL      /* 일련번호 */
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , #PYMNT_SE#
			     , B.EMPNO                 /* 사번 */
			     , B.EMPNM                 /* 사원명 */
			     , B.DEPT_CODE             /* 부서코드 */
			     , B.CLSF_CODE             /* 직급코드 */
			     , 'S2298'                 /* 지급공제코드 */
			     , 'S2298'                 /* 공제상세코드 */
			     , NVL(
			            (
			            SELECT A.PURCHS_AMOUNT
			              FROM TBSAL_FSTMP_DLRY A
			             WHERE A.DDC_YM = B.PYMNT_YM
			               AND A.EMPNO  = B.EMPNO
			            )
			           , 0) AS DDC_AMOUNT         /* 공제금액 */
			     , 0                     /* 수정공제금액 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT B
			 WHERE B.PYMNT_YM  = #PYMNT_YM#
			   AND B.SALARY_SE = #SALARY_SE#
			   AND B.PYMNT_DE  = #PYMNT_DE#
			   AND B.PYMNT_SE  = #PYMNT_SE#
			   AND NVL(B.DCLZ_SE,0) NOT IN ('216')		/* 휴직자 제외 */
        ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "2">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert> 
    
    <!-- 월급여데이터생성- 공제 - 청아람봉사단대상자정보입력 -->
    <insert id="SAL030101DAO.MtSalaryPymnt_S2301_1" parameterClass="java.util.HashMap">
        <isEqual property="PYMNT_SE" compareValue = "2">
		<![CDATA[
			 INSERT
			  INTO TBSAL_SRVC_STG_ENDW
			       (
			              DDC_YM
			            , EMPNO
			            , EMPNM
			            , DEPT_CODE
			            , CLSF_CODE
			            , JSSFC_SE
			            , RM               /* 비고 */
			            , REGISTER_ID        /* 등록자ID */
			            , REGIST_DT          /* 등록일시 */
			            , UPDUSR_ID          /* 수정자ID */
			            , UPDT_DT            /* 수정일시 */
			       )
			SELECT #PYMNT_YM#
			     , B.EMPNO
			     , B.EMPNM
			     , B.DEPT_CODE
			     , B.CLSF_CODE
			     , B.EMPL_SE
			     , B.RM
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT B
			 WHERE B.PYMNT_YM  = #PYMNT_YM#
			   AND B.SALARY_SE = '1'
			   AND B.PYMNT_DE  = #PYMNT_DE#
			   AND B.PYMNT_SE  = '2'
			   AND B.EMPL_SE IN ('000', '001', '002', '003')
			   AND NVL(B.DCLZ_SE,0) NOT IN ('216')		/* 휴직자 제외 */
        ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert>
    
    <!-- 월급여데이터생성- 공제 - 청아람봉사단기금 -->
    <insert id="SAL030101DAO.MtSalaryPymnt_S2301" parameterClass="java.util.HashMap">
        <isEqual property="PYMNT_SE" compareValue = "2">
        <![CDATA[
			INSERT
			  INTO TBSAL_MT_DDC_DTLS
			       (
			              SN                 /* 일련번호 */
			            , PYMNT_YM           /* 지급년월 */
			            , SALARY_SE          /* 급여구분 */
			            , PYMNT_DE           /* 지급일자 */
			            , PYMNT_SE           /* 지급구분 */
			            , EMPNO              /* 사번 */
			            , EMPNM              /* 사원명 */
			            , DEPT_CODE          /* 부서코드 */
			            , CLSF_CODE          /* 직급코드 */
			            , PYMNT_DDC_CODE     /* 지급공제코드 */
			            , DDC_DETAIL_CODE    /* 공제상세코드 */
			            , DDC_AMOUNT         /* 공제금액 */
			            , UPDT_DDC_AMOUNT    /* 수정공제금액 */
			            , CLOS_AT            /* 마감여부 */
			            , CLOS_DE            /* 마감일자 */
			            , RM                 /* 비고 */
			            , REGISTER_ID        /* 등록자ID */
			            , REGIST_DT          /* 등록일시 */
			            , UPDUSR_ID          /* 수정자ID */
			            , UPDT_DT            /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL     /* 일련번호 */
			     , #PYMNT_YM#             /* 지급년월 */
			     , #SALARY_SE#            /* 급여구분 */
			     , #PYMNT_DE#             /* 지급일자 */
			     , #PYMNT_SE#    /* 지급구분 */
			     , B.EMPNO                /* 사번 */
			     , B.EMPNM                /* 사원명 */
			     , B.DEPT_CODE            /* 부서코드 */
			     , B.CLSF_CODE            /* 직급코드 */
			     , 'S2301'                /* 지급공제코드 */
			     , 'S2301'                /* 공제상세코드 */
			     , SFSAL_DAY_PERC_CALC1 (
			       (
			              SELECT C.DDC_AMOUNT
			                FROM TBSAL_DDC_DETAIL_CODE C
			               WHERE C.DDC_DETAIL_CODE = 'S2301001'
			       )
			       , B.EMPNO, #PYMNT_YM#, #PYMNT_SE#) AS DDC_AMOUNT         /* 공제금액 */
			     , 0                     /* 수정공제금액 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT B
			     , TBSAL_SRVC_STG_ENDW A
			 WHERE B.PYMNT_YM  = #PYMNT_YM#
			   AND B.SALARY_SE = #SALARY_SE#
			   AND B.PYMNT_DE  = #PYMNT_DE#
			   AND B.PYMNT_SE  = #PYMNT_SE#
			   AND B.EMPNO     = A.EMPNO
			   AND B.PYMNT_YM  = A.DDC_YM
			   AND NVL(B.DCLZ_SE,0) NOT IN ('216')		/* 휴직자 제외 */
        ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert> 
    
    <!-- 월급여데이터생성- 공제 - 기금원금, 원금상환, 이자상환 생성 -->
    <insert id="SAL030101DAO.MtSalaryPymnt_S2230_C" parameterClass="java.util.HashMap">
        <isEqual property="PYMNT_SE" compareValue = "2">
		<![CDATA[
              INSERT INTO TBSAL_ENDW_LOAN_RPAY (
							 SN
							,DDC_YM
							,EMPNO
							,LOAN_BLCE
							,PRNCPAL_RPAY_AM
							,INTR_RPAY_AM
							,ARRRG_INTR_AM
							,SM_AM
							,LOAN_TARIFF_1
							,LOAN_TARIFF_2
							,RPAY_MTH
							,AT_1
							,LOAN_DE
							,AT_2
							,RPAY_COMPT_DE
							,SCRITS_NO
							,RM
							,REGISTER_ID        /* 등록자ID */
						    ,REGIST_DT          /* 등록일시 */
						    ,UPDUSR_ID          /* 수정자ID */
						    ,UPDT_DT            /* 수정일시 */
			 )
			  SELECT 
					      A.SN
					     ,#PYMNT_YM#  AS DDC_YM
					     ,A.EMPNO
					     ,(SELECT NVL(LOAN_BLCE,0)
			               FROM TBSAL_ENDW_LOAN_RPAY 
						   WHERE SN = A.SN 
						   AND DDC_YM = TO_CHAR(ADD_MONTHS(TO_DATE(#PYMNT_YM#,'YYYYMM') ,-1),'YYYYMM')) - 
			               CASE WHEN A.RPAY_COMPT_DE IS NULL THEN 
			                  (SELECT NVL(PRNCPAL_RPAY_AM,0)  FROM TBSAL_ENDW_LOAN_RPAY  WHERE SN = A.SN AND RPAY_COMPT_DE IS NULL
			                   AND DDC_YM = TO_CHAR(ADD_MONTHS(TO_DATE(#PYMNT_YM#,'YYYYMM') ,-1),'YYYYMM')) 
			               ELSE 0 END                                AS  LOAN_BLCE
						  ,NVL(A.PRNCPAL_RPAY_AM,166660)
						  ,CASE WHEN A.RPAY_COMPT_DE IS NULL THEN 
			                   ROUND((SELECT NVL(LOAN_BLCE,0) - NVL(PRNCPAL_RPAY_AM,0)  FROM TBSAL_ENDW_LOAN_RPAY 
						              WHERE SN = A.SN AND RPAY_COMPT_DE IS NULL
						              AND DDC_YM = TO_CHAR(ADD_MONTHS(TO_DATE(#PYMNT_YM#,'YYYYMM') ,-1),'YYYYMM')) *0.02 /12/ 10)*10            
			               ELSE  A.INTR_RPAY_AM END                  AS INTR_RPAY_AM
						  ,0                                         AS ARRRG_INTR_AM
						  ,NVL(A.PRNCPAL_RPAY_AM,166660) + 
						   CASE WHEN A.RPAY_COMPT_DE IS NULL THEN 
			                   ROUND((SELECT NVL(LOAN_BLCE,0) - NVL(PRNCPAL_RPAY_AM,0) FROM TBSAL_ENDW_LOAN_RPAY 
						              WHERE SN = A.SN AND RPAY_COMPT_DE IS NULL
						              AND DDC_YM = TO_CHAR(ADD_MONTHS(TO_DATE(#PYMNT_YM#,'YYYYMM') ,-1),'YYYYMM')) *0.02 /12/ 10)*10            
			               ELSE  A.INTR_RPAY_AM END                  AS SM_AM
					    ,A.LOAN_TARIFF_1
					    ,A.LOAN_TARIFF_2
					    ,A.RPAY_MTH
					    ,A.AT_1
					    ,A.LOAN_DE
					    ,A.AT_2
					    ,A.RPAY_COMPT_DE
					    ,A.SCRITS_NO
					    ,A.RM
					    ,#S_USER_ID#           /* 등록자ID */
					    ,SYSDATE               /* 등록일시 */
					    ,#S_USER_ID#           /* 수정자ID */
					    ,SYSDATE               /* 수정일시 */
				FROM TBSAL_ENDW_LOAN_RPAY A
				WHERE A.DDC_YM =  TO_CHAR(ADD_MONTHS(TO_DATE(#PYMNT_YM#,'YYYYMM') ,-1),'YYYYMM')
   		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert> 
   
   	<!-- 월급여데이터생성- 공제 - 기금원금 -->
    <insert id="SAL030101DAO.MtSalaryPymnt_S2230" parameterClass="java.util.HashMap">
        <isEqual property="PYMNT_SE" compareValue = "2">
    	<![CDATA[
			 INSERT
			  INTO TBSAL_MT_DDC_DTLS
			       (
			              SN                 /* 일련번호 */
			            , PYMNT_YM           /* 지급년월 */
			            , SALARY_SE          /* 급여구분 */
			            , PYMNT_DE           /* 지급일자 */
			            , PYMNT_SE           /* 지급구분 */
			            , EMPNO              /* 사번 */
			            , EMPNM              /* 사원명 */
			            , DEPT_CODE          /* 부서코드 */
			            , CLSF_CODE          /* 직급코드 */
			            , PYMNT_DDC_CODE     /* 지급공제코드 */
			            , DDC_DETAIL_CODE    /* 공제상세코드 */
			            , DDC_AMOUNT         /* 공제금액 */
			            , UPDT_DDC_AMOUNT    /* 수정공제금액 */
			            , CLOS_AT            /* 마감여부 */
			            , CLOS_DE            /* 마감일자 */
			            , RM                 /* 비고 */
			            , REGISTER_ID        /* 등록자ID */
			            , REGIST_DT          /* 등록일시 */
			            , UPDUSR_ID          /* 수정자ID */
			            , UPDT_DT            /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL      /* 일련번호 */
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , #PYMNT_SE#
			     , B.EMPNO                 /* 사번 */
			     , B.EMPNM                 /* 사원명 */
			     , B.DEPT_CODE             /* 부서코드 */
			     , B.CLSF_CODE             /* 직급코드 */
			     , 'S2230'                 /* 지급공제코드 */
			     , 'S2230'                 /* 공제상세코드 */
			     , (
			              SELECT SUM(C.PRNCPAL_RPAY_AM)
			                FROM TBSAL_ENDW_LOAN_RPAY C
			               WHERE C.DDC_YM              = B.PYMNT_YM
			                 AND C.EMPNO               = B.EMPNO
			                 AND C.PRNCPAL_RPAY_AM    <> 0
			                 AND C.RPAY_COMPT_DE IS NULL
			       )
			       AS DDC_AMOUNT         /* 공제금액 */
			     , 0                     /* 수정공제금액 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT B
			 WHERE B.PYMNT_YM  = #PYMNT_YM#
			   AND B.SALARY_SE = #SALARY_SE#
			   AND B.PYMNT_DE  = #PYMNT_DE#
			   AND B.PYMNT_SE  = #PYMNT_SE#
			   AND NVL(B.DCLZ_SE,0) NOT IN ('216')	/* 휴직자 제외 */
        ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert> 
   
    <!-- 월급여데이터생성- 공제 - 기금이자 -->
    <insert id="SAL030101DAO.MtSalaryPymnt_S2240" parameterClass="java.util.HashMap">
        <isEqual property="PYMNT_SE" compareValue = "2">
		<![CDATA[
			INSERT
			  INTO TBSAL_MT_DDC_DTLS
			       (
			              SN                 /* 일련번호 */
			            , PYMNT_YM           /* 지급년월 */
			            , SALARY_SE          /* 급여구분 */
			            , PYMNT_DE           /* 지급일자 */
			            , PYMNT_SE           /* 지급구분 */
			            , EMPNO              /* 사번 */
			            , EMPNM              /* 사원명 */
			            , DEPT_CODE          /* 부서코드 */
			            , CLSF_CODE          /* 직급코드 */
			            , PYMNT_DDC_CODE     /* 지급공제코드 */
			            , DDC_DETAIL_CODE    /* 공제상세코드 */
			            , DDC_AMOUNT         /* 공제금액 */
			            , UPDT_DDC_AMOUNT    /* 수정공제금액 */
			            , CLOS_AT            /* 마감여부 */
			            , CLOS_DE            /* 마감일자 */
			            , RM                 /* 비고 */
			            , REGISTER_ID        /* 등록자ID */
			            , REGIST_DT          /* 등록일시 */
			            , UPDUSR_ID          /* 수정자ID */
			            , UPDT_DT            /* 수정일시 */
			       )
			SELECT SQ_TBSAL_2.NEXTVAL      /* 일련번호 */
			     , #PYMNT_YM#              /* 지급년월 */
			     , #SALARY_SE#             /* 급여구분 */
			     , #PYMNT_DE#              /* 지급일자 */
			     , #PYMNT_SE#
			     , B.EMPNO                 /* 사번 */
			     , B.EMPNM                 /* 사원명 */
			     , B.DEPT_CODE             /* 부서코드 */
			     , B.CLSF_CODE             /* 직급코드 */
			     , 'S2240'                 /* 지급공제코드 */
			     , 'S2240'                 /* 공제상세코드 */
			     , (
			              SELECT SUM(C.INTR_RPAY_AM)
			                FROM TBSAL_ENDW_LOAN_RPAY C
			               WHERE C.DDC_YM              = B.PYMNT_YM
			                 AND C.EMPNO               = B.EMPNO
			                 AND C.INTR_RPAY_AM       <> 0
			                 AND C.RPAY_COMPT_DE IS NULL
			       )
			       AS DDC_AMOUNT         /* 공제금액 */
			     , 0                     /* 수정공제금액 */
			     , ''                    /* 마감여부 마감:1 */
			     , ''                    /* 마감일자 */
			     , ''                    /* 비고 */
			     , #S_USER_ID#           /* 등록자ID */
			     , SYSDATE               /* 등록일시 */
			     , #S_USER_ID#           /* 수정자ID */
			     , SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT B
			 WHERE B.PYMNT_YM  = #PYMNT_YM#
			   AND B.SALARY_SE = #SALARY_SE#
			   AND B.PYMNT_DE  = #PYMNT_DE#
			   AND B.PYMNT_SE  = #PYMNT_SE#
			   AND NVL(B.DCLZ_SE,0) NOT IN ('216')	/* 휴직자 제외 */
        ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert>
   
   	<!-- 월급여데이터생성- 공제 - 학자금대부상환 -->
    <insert id="SAL030101DAO.MtSalaryPymnt_S2260" parameterClass="java.util.HashMap">
        <isEqual property="PYMNT_SE" compareValue = "2">
		<![CDATA[
              INSERT INTO TBSAL_MT_DDC_DTLS (
					 SN                 /* 일련번호 */
					,PYMNT_YM           /* 지급년월 */
					,SALARY_SE          /* 급여구분 */
					,PYMNT_DE           /* 지급일자 */
					,PYMNT_SE           /* 지급구분 */
					,EMPNO              /* 사번 */
					,EMPNM              /* 사원명 */
					,DEPT_CODE          /* 부서코드 */
					,CLSF_CODE          /* 직급코드 */
					,PYMNT_DDC_CODE     /* 지급공제코드 */
					,DDC_DETAIL_CODE    /* 공제상세코드 */
					,DDC_AMOUNT         /* 공제금액 */
					,UPDT_DDC_AMOUNT    /* 수정공제금액 */
					,CLOS_AT            /* 마감여부 */
					,CLOS_DE            /* 마감일자 */
					,RM                 /* 비고 */
					,REGISTER_ID        /* 등록자ID */
				    ,REGIST_DT          /* 등록일시 */
				    ,UPDUSR_ID          /* 수정자ID */
				    ,UPDT_DT            /* 수정일시 */
			 )
			 SELECT  		       
	                 SQ_TBSAL_2.NEXTVAL      /* 일련번호 */
					,#PYMNT_YM#              /* 지급년월 */
					,#SALARY_SE#             /* 급여구분 */
					,#PYMNT_DE#              /* 지급일자 */
					,#PYMNT_SE#
					,B.EMPNO                 /* 사번 */
					,B.EMPNM                 /* 사원명 */
					,B.DEPT_CODE             /* 부서코드 */
					,B.CLSF_CODE             /* 직급코드 */
					,'S2260'                 /* 지급공제코드 */
					,'S2260'                 /* 공제상세코드 */
					,(  SELECT 
		                   SUM(CASE WHEN A.RPAY_ENDDE = A.RPAY_BEGIN_DE THEN 0 
		                            ELSE TRUNC(A.LOAN_AMOUNT/ 
				                            case when A.RPAY_BEGIN_DE >= '20140301' 
				                            then ROUND(MONTHS_BETWEEN(TO_DATE(A.RPAY_ENDDE,'YYYYMMDD'),TO_DATE(A.RPAY_BEGIN_DE,'YYYYMMDD'))) 
				                            else TRUNC(MONTHS_BETWEEN(TO_DATE(A.RPAY_ENDDE,'YYYYMMDD'),TO_DATE(A.RPAY_BEGIN_DE,'YYYYMMDD'))) end
		                            /10)*10 END) MONTH_AMT
		                FROM TBSAL_SCHXPN_LOAN A
		                WHERE NVL(A.RPAY_END_ENNC,'0') = '1' 
		                AND A.EMPNO = B.EMPNO
		                AND SUBSTR(A.RPAY_BEGIN_DE,1,6) <= #PYMNT_YM#
		                AND SUBSTR(A.RPAY_ENDDE,1,6) 	>= #PYMNT_YM#
		                GROUP BY A.EMPNO)     AS  DDC_AMOUNT         /* 공제금액 */
				   ,0                     /* 수정공제금액 */
				   ,''                    /* 마감여부 마감:1 */
		           ,''                    /* 마감일자 */
		           ,''                    /* 비고 */
		           ,#S_USER_ID#           /* 등록자ID */
				   ,SYSDATE               /* 등록일시 */
				   ,#S_USER_ID#           /* 수정자ID */
				   ,SYSDATE               /* 수정일시 */
			  FROM TBSAL_MT_SALARY_PYMNT B
			 WHERE B.PYMNT_YM 	= #PYMNT_YM#
			   AND B.SALARY_SE 	= #SALARY_SE#
			   AND B.PYMNT_DE 	= #PYMNT_DE#
			   AND B.PYMNT_SE 	= #PYMNT_SE#
			   AND B.EMPNO IN (SELECT DISTINCT  D.EMPNO 
			                   FROM TBSAL_SCHXPN_LOAN D
			                  WHERE NVL(D.RPAY_END_ENNC,'0') 	= '1'
		                        AND SUBSTR(D.RPAY_BEGIN_DE,1,6) <= #PYMNT_YM#
		                        AND SUBSTR(D.RPAY_ENDDE,1,6) 	>= #PYMNT_YM# )
			   AND NVL(B.DCLZ_SE,0) NOT IN ('216')	/* 휴직자 제외 */
        ]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert> 
    
    <!-- 월급여데이터생성- 공제 - 임금피크제 -->
    <insert id="SAL030101DAO.MtSalaryPymnt_S2221" parameterClass="java.util.HashMap">
        <isEqual property="PYMNT_SE" compareValue = "2">
		<![CDATA[
              INSERT INTO TBSAL_MT_DDC_DTLS (
						 SN                 /* 일련번호 */
						,PYMNT_YM           /* 지급년월 */
						,SALARY_SE          /* 급여구분 */
						,PYMNT_DE           /* 지급일자 */
						,PYMNT_SE           /* 지급구분 */
						,EMPNO              /* 사번 */
						,EMPNM              /* 사원명 */
						,DEPT_CODE          /* 부서코드 */
						,CLSF_CODE          /* 직급코드 */
						,PYMNT_DDC_CODE     /* 지급공제코드 */
						,DDC_DETAIL_CODE    /* 공제상세코드 */
						,DDC_AMOUNT         /* 공제금액 */
						,UPDT_DDC_AMOUNT    /* 수정공제금액 */
						,CLOS_AT            /* 마감여부 */
						,CLOS_DE            /* 마감일자 */
						,RM                 /* 비고 */
						,REGISTER_ID        /* 등록자ID */
					    ,REGIST_DT          /* 등록일시 */
					    ,UPDUSR_ID          /* 수정자ID */
					    ,UPDT_DT            /* 수정일시 */
			 )
			 SELECT  		       
		                 SQ_TBSAL_2.NEXTVAL      /* 일련번호 */
						,#PYMNT_YM#              /* 지급년월 */
						,#SALARY_SE#             /* 급여구분 */
						,#PYMNT_DE#              /* 지급일자 */
						,#PYMNT_SE#
						,t1.EMPNO                 /* 사번 */
						,t1.EMPNM                 /* 사원명 */
						,t1.DEPT_CODE             /* 부서코드 */
						,t1.CLSF_CODE             /* 직급코드 */
						,'S2221'                 /* 지급공제코드 */
						,'S2221'                 /* 공제상세코드 */
						,FLOOR(NVL((SELECT SUM(t3.PYMNT_AMOUNT)
							          FROM TBSAL_MT_PYMNT_DTLS t3
							         WHERE t1.PYMNT_YM  = t3.PYMNT_YM
							           AND t1.SALARY_SE = t3.SALARY_SE
							           AND t1.EMPNO     = t3.EMPNO	/*   AND t3.PYMNT_DDC_CODE <> CASE WHEN t1.ANSLRY_AT = 'Y' THEN 'P1010' ELSE 'P1015' END */
							           AND t3.PYMNT_DDC_CODE IN (  
							              SELECT PYMNT_DDC_CODE
							                FROM TBSAL_PYMNT_DDC_STDR_CODE
							               WHERE WAGE_PEAK_AT = '1'
							          )
							         GROUP BY EMPNO
							        ),0) 
							     * t4.RDCAMT_RT / 1000
							   ) * 10 AS DDC_AMOUNT         /* 임금피크공제금액 */
					    ,0                     /* 수정공제금액 */
					    ,''                    /* 마감여부 마감:1 */
			            ,''                    /* 마감일자 */
			            ,''                    /* 비고 */
			            ,#S_USER_ID#           /* 등록자ID */
					    ,SYSDATE               /* 등록일시 */
					    ,#S_USER_ID#           /* 수정자ID */
					    ,SYSDATE               /* 수정일시 */
			 FROM TBSAL_MT_SALARY_PYMNT t1
			 	  INNER JOIN TBSAL_WAGE_PEAK t2
			 	  ON  t1.EMPNO 		= t2.EMPNO
     			  AND t1.PYMNT_YM BETWEEN SUBSTR(t2.BGNDE,1,6) AND SUBSTR(t2.ENDDE,1,6)
     			  LEFT OUTER JOIN TBSAL_WAGE_PEAK_STDR t4
     			  ON  t2.YY_ODR 	= t4.YY_ODR
     			  AND t4.STDR_YEAR 	= SUBSTR(#PYMNT_YM#,1,4)
			 WHERE t1.PYMNT_YM 		= #PYMNT_YM#
			   AND t1.SALARY_SE 	= #SALARY_SE#
			   AND t1.PYMNT_DE 		= #PYMNT_DE#
			   AND t1.PYMNT_SE 		= #PYMNT_SE#
		]]>
        </isEqual>
        
        <isEqual property="PYMNT_SE" compareValue = "1">
			SELECT SYSDATE FROM DUAL  
        </isEqual>  
    </insert>
   
   	<!-- 0원삭제 삭제 -->
    <delete id="SAL030101DAO.MtSalaryPymnt_S_0_D" parameterClass="java.util.HashMap">
		DELETE
		  FROM TBSAL_MT_DDC_DTLS
		 WHERE PYMNT_YM           = #PYMNT_YM#
		   AND SALARY_SE          = #SALARY_SE#
		   AND PYMNT_SE           = #PYMNT_SE#
		   AND NVL(DDC_AMOUNT, 0) = 0
    </delete> 

   	<!-- 월급여데이터생성- 급여생성내역 생성 -->
    <insert id="SAL030101DAO.MtSalaryPymnt_CREAT" parameterClass="java.util.HashMap">
        <![CDATA[
              INSERT INTO TBSAL_MT_SALARY_CREAT (
				            PYMNT_YM              /* 지급년월 */ 
				           ,SALARY_SE             /* 급여구분 */
				           ,PYMNT_SE              /* 지급구분 */
				           ,PYMNT_DE              /* 지급일자 */
				           ,PYMNT_NMPR            /* 지급인원 */
				           ,DCSN_AT               /* 확정여부 */
				           ,DCSN_DE               /* 확정일자 */
				           ,CALC_TOTAMT           /* 계산총액 */
				           ,DDC_TOTAMT            /* 공제총액 */
				           ,RL_RECPT_AMOUNT       /* 실수령액 */
				           ,OPERTOR               /* 작업자   */				                      
				           ,REGISTER_ID           /* 등록자ID */
						   ,REGIST_DT             /* 등록일시 */
						   ,UPDUSR_ID             /* 수정자ID */
						   ,UPDT_DT               /* 수정일시 */
				) 
				 SELECT 
						    #PYMNT_YM#              /* 지급년월 */ 
				           ,#SALARY_SE#             /* 급여구분 */
				           ,#PYMNT_SE#
				           ,#PYMNT_DE#              /* 지급일자 */				           
				           ,(SELECT COUNT(*)
							 FROM TBHRM_HR_MASTR A
							 WHERE A.STTUS_SE = '000'	
		]]>
						<isEqual property="PYMNT_SE" compareValue = "1">           
							 AND A.JSSFC_SE IN ('000','001','002','003','007') )  AS PYMNT_NMPR         /* 지급인원 */
						</isEqual> 
						<isEqual property="PYMNT_SE" compareValue = "2">           
							 AND A.JSSFC_SE IN ('000','001','002','003','007') )  AS PYMNT_NMPR         /* 지급인원 */
						</isEqual> 
						<isEqual property="PYMNT_SE" compareValue = "4">           
							 AND A.JSSFC_SE IN ('004') )  AS PYMNT_NMPR         /* 지급인원 */
						</isEqual> 
						<![CDATA[	 
				           ,'0'      	/* 확정여부 */
				           ,''       	/* 확정일자 */
				           ,(SELECT NVL(SUM(A.PYMNT_AMOUNT),0)
							   FROM TBSAL_MT_PYMNT_DTLS A
							       ,TBSAL_MT_SALARY_PYMNT B
							  WHERE A.PYMNT_YM 		= #PYMNT_YM#
							    AND A.SALARY_SE		= #SALARY_SE#
							    AND A.PYMNT_DE 		= #PYMNT_DE#
							    AND A.PYMNT_SE 		= #PYMNT_SE#
							    AND A.PYMNT_YM 		= B.PYMNT_YM
							    AND A.SALARY_SE 	= B.SALARY_SE
							    AND A.PYMNT_DE 		= B.PYMNT_DE
							    AND A.PYMNT_SE 		= B.PYMNT_SE
							    AND A.EMPNO 		= B.EMPNO)		AS CALC_TOTAMT           	/* 계산총액 */
							 
				           ,(SELECT NVL(SUM(DDC_AMOUNT),0)
							   FROM TBSAL_MT_DDC_DTLS A							     
							  WHERE A.PYMNT_YM 		= #PYMNT_YM#
							    AND A.SALARY_SE 	= #SALARY_SE#
							    AND A.PYMNT_DE 		= #PYMNT_DE#
							    AND A.PYMNT_SE 		= #PYMNT_SE#)    AS  DDC_TOTAMT            /* 공제총액 */
							 
				           ,( (SELECT NVL(SUM(A.PYMNT_AMOUNT),0)
						     	 FROM TBSAL_MT_PYMNT_DTLS A
						         	 ,TBSAL_MT_SALARY_PYMNT B
						     	WHERE A.PYMNT_YM 	= #PYMNT_YM#
						     	  AND A.SALARY_SE 	= #SALARY_SE#
						     	  AND A.PYMNT_DE 	= #PYMNT_DE#
						     	  AND A.PYMNT_SE 	= #PYMNT_SE#
						     	  AND A.PYMNT_YM 	= B.PYMNT_YM
						     	  AND A.SALARY_SE 	= B.SALARY_SE
						    	  AND A.PYMNT_DE 	= B.PYMNT_DE
						     	  AND A.PYMNT_SE 	= B.PYMNT_SE
						     	  AND A.EMPNO 		= B.EMPNO)
						       - 
							  (SELECT NVL(SUM(DDC_AMOUNT),0)
							 	 FROM TBSAL_MT_DDC_DTLS
							 	WHERE PYMNT_YM 		= #PYMNT_YM#
							 	  AND SALARY_SE 	= #SALARY_SE#
							 	  AND PYMNT_DE 		= #PYMNT_DE#
							 	  AND PYMNT_SE 		= #PYMNT_SE#) )  AS  RL_RECPT_AMOUNT    	/* 실수령액 */
				           ,#S_USER_ID#          	/* 작업자   */				         				           
				           ,#S_USER_ID#           	/* 등록자ID */
						   ,SYSDATE               	/* 등록일시 */
						   ,#S_USER_ID#           	/* 수정자ID */
						   ,SYSDATE               	/* 수정일시 */
				FROM DUAL
        ]]>
    </insert> 

    <!-- 월급여데이터생성- 마스터기초생성 (시간외수당: 12월말) -->
    <insert id="SAL030101DAO.MtSalaryPymntC_P1910" parameterClass="java.util.HashMap">
        <![CDATA[
			 INSERT
			  INTO TBSAL_MT_SALARY_PYMNT
			       (
			              PYMNT_YM     /* 지급년월  */
			            , SALARY_SE    /* 급여구분  */
			            , PYMNT_SE     /* 지급구분  */
			            , PYMNT_DE     /* 지급일자 */
			            , EMPNO        /* 사번 */
			            , EMPNM        /* 사원명 */
			            , EMPL_SE      /* 사원구분 */
			            , ANSLRY_AT    /* 연봉여부 */
			            , DEPT_CODE    /* 부서코드 */
			            , DEPT_NM      /* 부서명 */
			            , PRMPC_SE     /* 원가구분 */
			            , RSPOFC_SE    /* 직책구분 */
			            , CLSF_CODE    /* 직급코드 */
			            , SRCLS        /* 호봉 */
			            , ECNY_DE      /* 입사일자 */
			            , RETIRE_DE    /* 퇴사일자 */
			            , STDR_DE  /* 호봉승급일 */
			            , CLSF_PRMOT_DE  /* 직급승진일 */
			            , DCLZ_SE        /* 근태구분 */
			            , BGNDE          /* 시작일 */
			            , ENDDE          /* 종료일 */
			            , LBUN_SBSCRB_SE /* 노조가입구분 */
			            , TRTMT_EMP_AT   /* 대우직원여부 */
			            , DSPSN_GRAD     /* 장애자등급 */
			            , WORK_STTUS     /* 근무상태 */
			            , MT_DAYCNT      /* 월일수 */
			            , NTHG_PLAN_ABSENC_DAYCNT /* 무계획결근일수 */
			            , ABSENC_DAYCNT  /* 결근일수 */
			            , LATEN_DAYCNT   /* 지각일수 */
			            , SLYRD_RT       /* 감봉율 */
			            , LAYOFF_SALARY_RT          /* 휴직급여율 */
			            , INDVDL_PRICEWAGE_PYMNT_RT /* 개인성과급지급율 */
			            , SEIZR_AT           /* 압류여부 */
			            , HN_DDC_NMPR        /* 인적공제인원 */
			            , HN_DDC_NMPR20  /* 인적공제인원20세이하*/
			            , TIME__ELSE_TIME    /* 시간외시간 */
			            , NIGHT_LABOR_TIME   /* 야간근로시간 */
			            , RESTDE_LABOR_TIME  /* 휴일근로시간 */
			            , YEAST_HLDY_RCOGN   /* 국공휴일인정 */
			            , SALARY_BANK_CODE   /* 급여은행코드 */
			            , SALARY_BANK_ACNUT  /* 급여은행계좌 */
			            , ALLWNC_BANK_CODE   /* 수당은행코드 */
			            , ALLWNC_BANK_ACNUT  /* 수당은행계좌 */
			            , BSLRY              /* 기본급 */
			            , BSLRY_EXCCLC       /* 기본급정산 */
			            , CNSTRC_ALLWNC      /* 건설수당 */
			            , INORG_CNWK_ALLWNC  /* 장기근속수당 */
			            , TCHNLGY_ALLWNC     /* 기술수당 */
			            , FAMILY_ALLWNC      /* 가족수당 */
			            , SPCL_JOB_ALLWNC    /* 특수업무수당 */
			            , SPCIFY_JOB_EXC     /* 특정업무수행 */
			            , DRV_ALLWNC         /* 운전수당 */
			            , RISK_ALLWNC        /* 위험수당 */
			            , TRTMNT_ALLWNC      /* 대우수당 */
			            , YRYC_ALLWNC        /* 연차수당 */
			            , SCHXPN_SBSIDY      /* 학자금보조비 */
			            , INCNTV_PRICEWAGE    /* 인센티브성과급 */
			            , BUDGET_PRICEWAGE   /* 예산성과급 */
			            , DTY_ALLWNC         /* 직무수당 */
			            , TIME__ELSE_ALLWNC  /* 시간외수당 */
			            , MLSV_SBSIDY        /* 급식보조비 */
			            , RSPOFC_SBSIDY      /* 직책보조비 */
			            , TRNSPORT_SBSIDY    /* 교통보조비 */
			            , JOB_PRTN_TRVCT     /* 업무추진여비 */
			            , SPT_SYSM_CT        /* 현장체제비 */
			            , MNG_ALLWNC         /* 감독수당 */
			            , MANAGE_JOB_ALLWNC  /* 관리업무수당 */
			            , RESTDE_ALLWNC      /* 휴일수당 */
			            , INFANT_NRTR_CT     /* 영유아보육비 */
			            , ETC_ALLWNC         /* 기타수당 */
			            , ALLWNC_EXCCLC      /* 수당정산 */
			            , SALARY_PYMNT_TOTAMT /* 급여지급총액 */
			            , ALLWNC_PYMNT_TOTAMT /* 수당지급총액 */
			            , TOT_PYMNTAMT       /* 총지급액 */
			            , TAXT_AMOUNT        /* 과세금액 */
			            , TAXXMPT_AMOUNT     /* 비과세금액 */
			            , INCMTAX            /* 소득세 */
			            , LCLTY_INCMTAX      /* 지방소득세 */
			            , HLTHINS            /* 건강보험 */
			            , NPN                /* 국민연금 */
			            , EMPLYMINSRNC       /* 고용보험 */
			            , ENDW_PRNCPAL       /* 기금원금 */
			            , ENDW_INTR          /* 기금이자 */
			            , MXTR_CT            /* 조합비 */
			            , SRVC_GRP_ENDW      /* 봉사단기금 */
			            , SCHXPN_RPAY        /* 학자금상환 */
			            , YND_EXCCLC         /* 연말정산 */
			            , MENDNG_SEIZR       /* 보수압류 */
			            , INCMTAX_EXCCLC     /* 소득세정산 */
			            , LCLTY_INCMTAX_EXCCLC /* 지방소득세정산 */
			            , HLTHINS_EXCCLC       /* 건강보험정산 */
			            , EMPLYMINSRNC_EXCCLC  /* 고용보험정산 */
			            , DDC_TOTAMT         /* 공제총액 */
			            , ODYGS              /* 통상임금 */
			            , RL_RECPT_AMOUNT    /* 실수령액 */
			            , CLOS_AT            /* 마감여부 */
			            , CLOS_DE            /* 마감일자 */
			            , RM                 /* 비고 */
			            , STDR_ANSLRY        /* 기준연봉 2016.02.19 */
			            , WAGE_PEAK          /* 임금피크 2016.02.19 */
			            , REGISTER_ID        /* 등록자ID */
			            , REGIST_DT          /* 등록일시 */
			            , UPDUSR_ID          /* 수정자ID */
			            , UPDT_DT            /* 수정일시 */
			       )
			SELECT #PYMNT_YM#         /* 지급년월  */
			     , #SALARY_SE#        /* 급여구분  */
			     , #PYMNT_SE#         /* 지급구분 - 1일:1, 20일:2, 계약직:4 */
			     , #PYMNT_DE#         /* 지급일자 */
			     , A.EMPNO            /* 사번 */
			     , A.EMPNM            /* 사원명 */
			     , A.JSSFC_SE         /* 사원구분 */
			     , (
			              SELECT
			                     CASE COUNT(I.EMPNO)
			                            WHEN 1
			                            THEN 'Y'
			                            ELSE ''
			                     END
			                FROM TBSAL_ANSLRY_INFO I
			               WHERE I.APPLC_DE =
			                     (
			                            SELECT MAX(APPLC_DE)
			                              FROM TBSAL_ANSLRY_INFO
			                             WHERE APPLC_DE <= #PYMNT_DE#
			                     )
			                 AND I.PYMNT_SE = '1'
			                 AND I.EMPNO    = A.EMPNO
			       )               /* 연봉여부 */
			     , A.DEPT_CODE                           /* 부서코드 */
			     , SFSAL_GETDEPTNM_01(A.DEPT_CODE)       /* 부서명 */
			     , ''                                    /* 원가구분 */
			     , A.RSPOFC_SE                           /* 직책구분 */
			     , A.PAY_CLSF_SE                         /* 직급코드 */
			     , NVL(A.SRCLS, '01')                     /* 호봉 */
			     , A.ECNY_DE                             /* 입사일자 */
			     , A.RETIRE_DE                           /* 퇴사일자 */
			     , A.STDR_DE                             /* 기준일자 */
			     , (
			              SELECT MAX(AF.GNFD_DE)
			                FROM TBHRM_GNFD AF
			               WHERE AF.EMPNO = A.EMPNO
			                 AND AF.GNFD_SE IN ('005', '010')
			       )                          /* 직급승진일 */
			     , (
			              SELECT AA.DCLZ_SE
			                FROM TBHRM_MNBY_DCLZ_DTLS AA
			               WHERE AA.DCLZ_SE                  = '216'    /* 휴직자 제외 */
			                 AND TO_CHAR(AA.BGNDT, 'YYYYMM') = #PYMNT_YM#
			                 AND TO_CHAR(AA.ENDDT, 'YYYYMM') = #PYMNT_YM#
			                 AND AA.EMPNO                    = A.EMPNO
			       )
			       AS DCLZ_SE                    /* 근태구분 */
			     , (
			              SELECT TO_CHAR(AB.BGNDT, 'YYYYMMDD')
			                FROM TBHRM_MNBY_DCLZ_DTLS AB
			               WHERE AB.DCLZ_SE                  = '216'    /* 휴직자 제외 */
			                 AND TO_CHAR(AB.BGNDT, 'YYYYMM') = #PYMNT_YM#
			                 AND TO_CHAR(AB.ENDDT, 'YYYYMM') = #PYMNT_YM#
			                 AND AB.EMPNO                    = A.EMPNO
			       )
			       AS BGNDE                      /* 시작일 */
			     , (
			              SELECT TO_CHAR(AC.ENDDT, 'YYYYMMDD')
			                FROM TBHRM_MNBY_DCLZ_DTLS AC
			               WHERE AC.DCLZ_SE                  = '216'
			                 AND TO_CHAR(AC.BGNDT, 'YYYYMM') = #PYMNT_YM#
			                 AND TO_CHAR(AC.ENDDT, 'YYYYMM') = #PYMNT_YM#
			                 AND AC.EMPNO                    = A.EMPNO
			       )
			       AS ENDDE                      /* 종료일 */
			     , (
			              SELECT
			                     CASE COUNT(B.EMPNO)
			                            WHEN 1
			                            THEN 'Y'
			                            ELSE ''
			                     END
			                FROM TBHRM_HR_ETC B
			               WHERE B.EMPNO          = A.EMPNO
			                 AND B.LBUN_SBSCRB_AT = '1'
			       )        /* 노조가입구분 */
			     , (
			              SELECT
			                     CASE COUNT(AD.EMPNO)
			                            WHEN 1
			                            THEN 'Y'
			                            ELSE ''
			                     END
			                FROM TBHRM_HR_MASTR AD
			               WHERE AD.TRTMT_EMP_AT               = '1'
			                 AND SUBSTR(AD.TRTMT_BGNDE, 1, 6) <= #PYMNT_YM#
			                 AND SUBSTR(AD.TRTMT_ENDDE, 1, 6) >= #PYMNT_YM#
			                 AND AD.EMPNO                      = A.EMPNO
			       )                                   /* 대우직원구분 */
			     , (
			              SELECT C.TROBL_GRAD_SE
			                FROM TBHRM_HR_ETC C
			               WHERE C.EMPNO = A.EMPNO
			       )                               /* 장애자등급 */
			     , A.STTUS_SE                                                 /* 근무상태 */
			     , TO_CHAR(LAST_DAY(TO_DATE(#PYMNT_YM#, 'YYYYMM')), 'DD')       /* 월일수 */
			     , 0     /* 무계획결근일수 */
			     , 0     /* 결근일수 */
			     , 0     /* 지각일수 */
			     , 0     /* 감봉율 */
			     , 0     /* 휴직급여율 */
			     , 0     /* 개인성과급지급율 */
			     , (
			              SELECT
			                     CASE COUNT(DISTINCT D.EMPNO)
			                            WHEN 1
			                            THEN 'Y'
			                            ELSE ''
			                     END
			                FROM TBSAL_MENDNG_SEIZR_TKBAK D
			               WHERE D.TRMNAT_AT = '1'
			                 AND D.EMPNO     = A.EMPNO
			       )         /* 압류여부 */
			     , 0  /* 인적공제인원 */
			     , 0  /* 인적공제인원20세이하 */
			     , (
			              SELECT F.PYMNT_TIME
			                FROM TBSAL_EXCESS_WORK_DTLS F
			               WHERE F.EMPNO    = A.EMPNO
			                 AND F.PYMNT_YM = #PYMNT_YM#
			       )     /* 시간외시간 */
			     , 0      /* 야간근로시간 */
			     , 0      /* 휴일근로시간 */
			     , 0      /* 국공휴일인정 */
			     , (
			              SELECT G.SALARY_BANK_CODE
			                FROM TBSAL_EMPL_BANK_ACNUT G
			               WHERE G.EMPNO = A.EMPNO
			       )       /* 급여은행코드 */
			     , (
			              SELECT G2.SALARY_BANK_ACNUT
			                FROM TBSAL_EMPL_BANK_ACNUT G2
			               WHERE G2.EMPNO = A.EMPNO
			       )      /* 급여은행계좌 */
			     , (
			              SELECT G3.ALLWNC_BANK_CODE
			                FROM TBSAL_EMPL_BANK_ACNUT G3
			               WHERE G3.EMPNO = A.EMPNO
			       )      /* 수당은행코드 */
			     , (
			              SELECT G4.ALLWNC_BANK_ACNUT
			                FROM TBSAL_EMPL_BANK_ACNUT G4
			               WHERE G4.EMPNO = A.EMPNO
			       )      /* 수당은행계좌 */
			     , 0      /* 기본급 */
			     , 0      /* 기본급정산 */
			     , 0      /* 건설수당 */
			     , 0      /* 장기근속수당 */
			     , 0      /* 기술수당 */
			     , 0      /* 가족수당 */
			     , 0      /* 특수업무수당 */
			     , 0      /* 특정업무수행 */
			     , 0      /* 운전수당 */
			     , 0      /* 위험수당 */
			     , 0      /* 대우수당 */
			     , 0      /* 연차수당 */
			     , 0      /* 학자금보조비 */
			     , 0      /* 인센티브성과급 */
			     , 0      /* 예산성과급 */
			     , 0      /* 직무수당 */
			     , 0      /* 시간외수당 */
			     , 0      /* 급식보조비 */
			     , 0      /* 직책보조비 */
			     , 0      /* 교통보조비 */
			     , 0      /* 업무추진여비 */
			     , 0      /* 현장체제비 */
			     , 0      /* 감독수당 */
			     , 0      /* 관리업무수당 */
			     , 0      /* 휴일수당 */
			     , 0      /* 영유아보육비 */
			     , 0      /* 기타수당 */
			     , 0      /* 수당정산 */
			     , 0      /* 급여지급총액 */
			     , 0      /* 수당지급총액 */
			     , 0      /* 총지급액 */
			     , 0      /* 과세금액 */
			     , 0      /* 비과세금액 */
			     , 0      /* 소득세 */
			     , 0      /* 지방소득세 */
			     , 0      /* 건강보험 */
			     , 0      /* 국민연금 */
			     , 0      /* 고용보험 */
			     , 0      /* 기금원금 */
			     , 0      /* 기금이자 */
			     , 0      /* 조합비 */
			     , 0      /* 봉사단기금 */
			     , 0      /* 학자금상환 */
			     , 0      /* 연말정산 */
			     , 0      /* 보수압류 */
			     , 0      /* 소득세정산 */
			     , 0      /* 지방소득세정산 */
			     , 0      /* 건강보험정산 */
			     , 0      /* 고용보험정산 */
			     , 0      /* 공제총액 */
			     , 0      /* 통상임금 */
			     , 0      /* 실수령액 */
			     , ''     /* 마감여부 */
			     , ''     /* 마감일자 */
			     , ''     /* 비고 */
			     , 0      /* 기준연봉 2016.02.19 */
			     , 0      /* 임금피크 2016.02.19 */
			     , #S_USER_ID#     /* 등록자ID */
			     , SYSDATE         /* 등록일시 */
			     , #S_USER_ID#     /* 수정자ID */
			     , SYSDATE         /* 수정일시 */
			  FROM TBHRM_HR_MASTR A
			 WHERE A.PAY_CLSF_SE IS NOT NULL
			   AND A.ECNY_DE <= #PYMNT_DE#	  /* 수정 : 20일이후 입사자 는 급여 처리안함 */
		]]>		
		<isEqual property = "PYMNT_SE" compareValue = "1">	/* 복리후생비 */		
			   AND ( A.STTUS_SE = '000'
					 OR SUBSTR(A.RETIRE_DE,1,6) = TO_CHAR(ADD_MONTHS (TO_DATE(#PYMNT_YM#,'YYYYMM') , -1), 'YYYYMM')  ) /* 수정 : 퇴사자 1일자 지급시 전월 퇴사자도 포함 함 */
			   AND A.JSSFC_SE IN ('000','001','002','003','007')
		</isEqual>
		<isEqual property = "PYMNT_SE" compareValue = "2"> /* 급여 */
			   AND ( A.STTUS_SE = '000'
			   		 OR SUBSTR(A.RETIRE_DE,1,6) = #PYMNT_YM# )		/* 20160827 수정 : 당월 퇴사자도 포함 */
			   AND A.JSSFC_SE IN ('000','001','002','003','007')
		</isEqual>	
		<isEqual property = "PYMNT_SE" compareValue = "4"> /* 계약직 */			
			   AND ( A.STTUS_SE = '000' 
			   		 OR SUBSTR(A.RETIRE_DE,1,6) = #PYMNT_YM# )		/* 20160827 수정 : 당월 퇴사자도 포함 */
			   AND A.JSSFC_SE IN ('004')
		</isEqual>
			 ORDER BY A.JSSFC_SE, A.PAY_CLSF_SE, A.SRCLS
   	</insert>
   	
   	<!-- 월급여데이터생성- 급여생성내역 생성 (시간외수당: 12월말) -->
    <insert id="SAL030101DAO.MtSalaryPymnt_CREAT_P1910" parameterClass="java.util.HashMap">
        <![CDATA[
              INSERT INTO TBSAL_MT_SALARY_CREAT (
				            PYMNT_YM              /* 지급년월 */ 
				           ,SALARY_SE             /* 급여구분 */
				           ,PYMNT_SE              /* 지급구분 */
				           ,PYMNT_DE              /* 지급일자 */
				           ,PYMNT_NMPR            /* 지급인원 */
				           ,DCSN_AT               /* 확정여부 */
				           ,DCSN_DE               /* 확정일자 */
				           ,CALC_TOTAMT           /* 계산총액 */
				           ,DDC_TOTAMT            /* 공제총액 */
				           ,RL_RECPT_AMOUNT       /* 실수령액 */
				           ,OPERTOR               /* 작업자   */				                      
				           ,REGISTER_ID           /* 등록자ID */
						   ,REGIST_DT             /* 등록일시 */
						   ,UPDUSR_ID             /* 수정자ID */
						   ,UPDT_DT               /* 수정일시 */
				) 
				 SELECT 
						    #PYMNT_YM#              /* 지급년월 */ 
				           ,#SALARY_SE#             /* 급여구분 */
				           ,#PYMNT_SE#
				           ,#PYMNT_DE#              /* 지급일자 */				           
				           ,(SELECT COUNT(*)
							 FROM TBHRM_HR_MASTR A
							 WHERE A.STTUS_SE = '000'	
						]]>
						<isEqual property="PYMNT_SE" compareValue = "1">           
							 AND A.JSSFC_SE IN ('000','001','002','003','007') )  AS PYMNT_NMPR         /* 지급인원 */
						</isEqual> 
						<isEqual property="PYMNT_SE" compareValue = "2">           
							 AND A.JSSFC_SE IN ('000','001','002','003','007') )  AS PYMNT_NMPR         /* 지급인원 */
						</isEqual> 
						<isEqual property="PYMNT_SE" compareValue = "4">           
							 AND A.JSSFC_SE IN ('004') )  AS PYMNT_NMPR         /* 지급인원 */
						</isEqual> 
						<![CDATA[	 
				           ,'0'      	/* 확정여부 */
				           ,''       	/* 확정일자 */
				           ,(SELECT NVL(SUM(A.PYMNT_AMOUNT),0)
							   FROM TBSAL_MT_PYMNT_DTLS A
							       ,TBSAL_MT_SALARY_PYMNT B
							  WHERE A.PYMNT_YM 			= #PYMNT_YM#
							    AND A.SALARY_SE			= #SALARY_SE#
							    AND A.PYMNT_DE 			= #PYMNT_DE#
							    AND A.PYMNT_SE 			= #PYMNT_SE#
							    AND A.PYMNT_DDC_CODE 	= 'P1910'
							    AND A.PYMNT_YM 			= B.PYMNT_YM
							    AND A.SALARY_SE 		= B.SALARY_SE
							    AND A.PYMNT_DE 			= B.PYMNT_DE
							    AND A.PYMNT_SE 			= B.PYMNT_SE
							    AND A.EMPNO 			= B.EMPNO)		AS CALC_TOTAMT           	/* 계산총액 */
							 
				           ,0    AS  DDC_TOTAMT            /* 공제총액 */
							 
				           ,( (SELECT NVL(SUM(A.PYMNT_AMOUNT),0)
						     	 FROM TBSAL_MT_PYMNT_DTLS A
						         	 ,TBSAL_MT_SALARY_PYMNT B
						     	WHERE A.PYMNT_YM 		= #PYMNT_YM#
						     	  AND A.SALARY_SE 		= #SALARY_SE#
						     	  AND A.PYMNT_DE 		= #PYMNT_DE#
						     	  AND A.PYMNT_SE 		= #PYMNT_SE#
						     	  AND A.PYMNT_DDC_CODE 	= 'P1910'
						     	  AND A.PYMNT_YM 		= B.PYMNT_YM
						     	  AND A.SALARY_SE 		= B.SALARY_SE
						    	  AND A.PYMNT_DE 		= B.PYMNT_DE
						     	  AND A.PYMNT_SE 		= B.PYMNT_SE
						     	  AND A.EMPNO 			= B.EMPNO))  AS  RL_RECPT_AMOUNT    	/* 실수령액 */
				           ,#S_USER_ID#          	/* 작업자   */				         				           
				           ,#S_USER_ID#           	/* 등록자ID */
						   ,SYSDATE               	/* 등록일시 */
						   ,#S_USER_ID#           	/* 수정자ID */
						   ,SYSDATE               	/* 수정일시 */
				FROM DUAL
        ]]>
    </insert> 
    
	<!-- 월급여데이터마스터정보 삭제 -->
    <delete id="SAL030101DAO.MtSalaryPymntD" parameterClass="java.util.HashMap">
         DELETE FROM TBSAL_MT_SALARY_PYMNT
         WHERE PYMNT_YM = #PYMNT_YM#  
         AND SALARY_SE 	= #SALARY_SE#
         AND PYMNT_SE  	= #PYMNT_SE#  
    </delete> 
    
    <!-- 월급여데이터지급상세정보 삭제 -->
    <delete id="SAL030101DAO.MtSalaryPymntDtlsD" parameterClass="java.util.HashMap">
         DELETE FROM TBSAL_MT_PYMNT_DTLS
         WHERE PYMNT_YM	= #PYMNT_YM#  
         AND SALARY_SE 	= #SALARY_SE#
         AND PYMNT_SE 	= #PYMNT_SE#
    </delete>
    
    <!-- 월급여데이터지급상세정보 삭제(코드) -->
    <delete id="SAL030101DAO.MtSalaryPymntDtlsCodeD" parameterClass="java.util.HashMap">
         DELETE FROM TBSAL_MT_PYMNT_DTLS
         WHERE PYMNT_YM	= #PYMNT_YM#  
         AND SALARY_SE 	= #SALARY_SE#
         AND PYMNT_SE 	= #PYMNT_SE#
         AND PYMNT_DDC_CODE 	= #PYMNT_DDC_CODE#
    </delete>
    
    <!-- 월급여데이터공제상세정보 삭제 -->
    <delete id="SAL030101DAO.MtSalaryDdcDtlsD" parameterClass="java.util.HashMap">
         DELETE FROM TBSAL_MT_DDC_DTLS
         WHERE PYMNT_YM = #PYMNT_YM#  
         AND SALARY_SE 	= #SALARY_SE#
         AND PYMNT_SE  	= #PYMNT_SE#  
    </delete> 
    
    <!-- 가족수당대상자 삭제 -->
    <delete id="SAL030101DAO.MtSalaryPymnt_P1080_01D" parameterClass="java.util.HashMap">
         DELETE FROM TBSAL_FAMILY_ALLWNC_MANAGE
         WHERE PYMNT_YM = #PYMNT_YM#
         AND PYMNT_SE  	= #PYMNT_SE#  
    </delete>
    
    <!-- 노조원 삭제 -->
    <delete id="SAL030101DAO.MtSalaryPymnt_S2250_D" parameterClass="java.util.HashMap">
         DELETE FROM TBSAL_LBUN_SBSCRB
         WHERE DDC_YM 	= #PYMNT_YM#
    </delete> 
    
    <!-- 청아람대상자 삭제 -->
    <delete id="SAL030101DAO.MtSalaryPymnt_S2301_D" parameterClass="java.util.HashMap">
         DELETE FROM TBSAL_SRVC_STG_ENDW
         WHERE DDC_YM 	= #PYMNT_YM#
    </delete> 
    
    <!-- 급여생성내역정보 삭제 -->
    <delete id="SAL030101DAO.MtSalaryPymnt_CREATD" parameterClass="java.util.HashMap">
         DELETE FROM TBSAL_MT_SALARY_CREAT
         WHERE PYMNT_YM = #PYMNT_YM#  
         AND SALARY_SE 	= #SALARY_SE#
         AND PYMNT_SE  	= #PYMNT_SE#  
    </delete> 
    
    <!-- 기금대부정보 삭제 -->
    <delete id="SAL030101DAO.MtSalaryPymnt_EndwD" parameterClass="java.util.HashMap">
         DELETE FROM TBSAL_ENDW_LOAN_RPAY
         WHERE DDC_YM 	= #PYMNT_YM#  
    </delete> 

</sqlMap>