<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="HRM060501_SQL">
	<typeAlias alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	

    <!--집계내역조회 -->
	<select id="HRM060501DAO.selectMlssList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		WITH TEMP AS (
		    SELECT T1.EVL_YEAR
		         , T1.HT_SE
		         , T1.EMPNO
		         , T1.APRSR_EMPNO
		         , T1.EMPNM
		         , T1.DEPT_NM
		         , T1.OFCPS_NM
		         , DECODE(T1.APRSR_SE, '2', T1.RK+3, T1.RK) AS RK
		         , T1.PRSEN_AT
		         , T1.JSSFC_SE
                 , T1.HR_CLSF_SE
		     FROM (SELECT H2.EVL_YEAR
		                , H2.HT_SE
		                , H2.EMPNO
		                , H2.APRSR_EMPNO
		                , H3.EMPNM
		                , H1.JSSFC_SE
                        , H1.HR_CLSF_SE
		                , SFHRM_GET_DEPTNM(H1.DEPT_CODE, NULL) AS DEPT_NM
		                , SFCOM_CODE_NM('HRM003', H1.OFCPS_SE) AS OFCPS_NM
		                , RANK() OVER(PARTITION BY H2.EVL_YEAR, H2.HT_SE, H2.EMPNO, H2.APRSR_SE ORDER BY H2.APRSR_NO) AS RK
		                , H2.APRSR_SE
		                , H2.PRSEN_AT
		             FROM TBHRM_MLSS_APRSEE H1 
		            LEFT OUTER JOIN TBHRM_MLSS_APRSR H2
                      ON H1.EVL_YEAR = H2.EVL_YEAR
		                  AND H1.HT_SE = H2.HT_SE
		                  AND H1.EMPNO = H2.EMPNO
		            INNER JOIN TBHRM_HR_MASTR H3
		                  ON H2.APRSR_EMPNO = H3.EMPNO
		            WHERE H2.EMPNO IS NOT NULL 
		              AND H2.EVL_YEAR = #EVL_YEAR#
		              AND H2.HT_SE = #HT_SE#
		          ) T1
		)
		SELECT T2.EMPNM
		     , T2.ECNY_DE
             , T3.CODE_NM AS JSSFC_NM
             , T4.CODE_NM  AS CLSF_NM
             , T1.*
		  FROM (
		          SELECT *
		            FROM TEMP 
		           PIVOT (
		                MAX(EMPNM), MAX(APRSR_EMPNO) AS NO, MAX(PRSEN_AT) AS AT
		                FOR RK IN (1 AS EMPNM_1, 2 AS EMPNM_2, 3 AS EMPNM_3, 4 AS EMPNM_4, 5 AS EMPNM_5, 6 AS EMPNM_6, 7 AS EMPNM_7, 8 AS EMPNM_8, 9 AS EMPNM_9, 10 AS EMPNM_10, 11 AS EMPNM_11, 12 AS EMPNM_12, 13 AS EMPNM_13, 14 AS EMPNM_14, 15 AS EMPNM_15, 16 AS EMPNM_16, 17 AS EMPNM_17)
		           )
		       ) T1
		  LEFT OUTER JOIN TBHRM_HR_MASTR T2
		       ON T1.EMPNO = T2.EMPNO
		  LEFT OUTER JOIN TBCOM_CMMN_CODE T3
		            ON T1.JSSFC_SE = T3.CODE
		           AND T3.GRP_CODE = 'HRM001'
		  LEFT OUTER JOIN TBCOM_CMMN_CODE T4
		            ON T1.HR_CLSF_SE = T4.CODE
		           AND T4.GRP_CODE = 'HRM002'
		ORDER BY T3.CODE_ORDR , T4.CODE_ORDR, T2.ECNY_DE
    </select>

    <!-- 평가자 세부목록 조회 -->
    <select id="HRM060501DAO.selectAprsrList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT T1.EVL_YEAR
	          ,T1.HT_SE
	          ,T1.EMPNO
	          ,T2.APRSR_EMPNO
	          ,T2.APRSR_NO
	          ,T2.EMPNM
	          ,T2.CLSF_NM
	          ,T2.JSSFC_NM
	          ,T1.APRSR_SE
	          ,T1.RK
	          ,DECODE(NVL(T2.PRSEN_AT,'0'), '0', '미제출', '제출') AS PRSEN_AT
              ,DECODE(T1.APRSR_SE, '2', '동료/하급자', '상급자') AS GRADE 
		FROM (
		    SELECT #EVL_YEAR# AS EVL_YEAR
		          ,#HT_SE# AS HT_SE
		          ,#EMPNO# AS EMPNO
		          ,LEVEL AS RK
		          ,CASE WHEN LEVEL <![CDATA[< ]]>4 THEN '1' ELSE '2' END AS APRSR_SE
		    FROM DUAL            CONNECT BY
		        LEVEL <![CDATA[<=]]> 17        ) T1
		LEFT OUTER JOIN (
		    SELECT H2.EVL_YEAR
		           , H2.HT_SE
		           , H2.EMPNO
		           , H2.APRSR_NO
		           , H2.APRSR_EMPNO
		           , H3.EMPNM                                  
		           , SFCOM_CODE_NM('HRM002', H3.HR_CLSF_SE) AS CLSF_NM
		           , SFCOM_CODE_NM('HRM001', H3.JSSFC_SE) AS JSSFC_NM
		           , H2.PRSEN_AT
		           , CASE
		        WHEN H2.APRSR_SE = 2 THEN RANK() OVER(
		            PARTITION BY H2.APRSR_SE
		            ORDER BY H2.APRSR_NO
		        ) + 3
		        ELSE RANK() OVER(
		            PARTITION BY H2.APRSR_SE
		            ORDER BY H2.APRSR_NO
		        )
		    END AS RK
		           , H2.APRSR_SE
		    FROM TBHRM_MLSS_APRSEE H1
		    LEFT OUTER JOIN TBHRM_MLSS_APRSR H2
		    ON H1.EVL_YEAR = H2.EVL_YEAR
		       AND H1.HT_SE = H2.HT_SE
		       AND H1.EMPNO = H2.EMPNO
		    INNER JOIN TBHRM_HR_MASTR H3
		    ON H2.APRSR_EMPNO = H3.EMPNO
		    WHERE H1.EMPNO = #EMPNO#
		          AND H1.EVL_YEAR = #EVL_YEAR#
		          AND H1.HT_SE = #HT_SE#
		) T2
		ON 1=1      
		AND T1.EVL_YEAR = T2.EVL_YEAR
		AND T1.HT_SE = T2.HT_SE
		AND T1.EMPNO = T2.EMPNO
		AND T1.RK = T2.RK  
		ORDER BY T1.RK
    </select>
    
    <!-- 엑셀업로드시 테이블저장 -->
    <insert id="HRM060501DAO.insertMlssAprsee" parameterClass="java.util.HashMap">
    	INSERT INTO TBHRM_MLSS_APRSEE(
    			  EVL_YEAR
    			, HT_SE
    			, EMPNO
    			, DEPT_CODE
    			, HR_CLSF_SE
    			, JSSFC_SE
    			, OFCPS_SE
    			, JBLN_SE
    			, NOW_CLSF_EMPLMN_DE
    			, REGISTER_ID
				, REGIST_DT
				, UPDUSR_ID
				, UPDT_DT
		)
		SELECT #EVL_YEAR#
		     , #HT_SE#
		     , #EMPNO#
		     , DEPT_CODE
		     , HR_CLSF_SE
		     , JSSFC_SE
		     , OFCPS_SE
		     , JBLN_SE
		     , NOW_CLSF_EMPLMN_DE
		     , #S_USER_ID#
			 , SYSDATE
			 , #S_USER_ID#
			 , SYSDATE
	     FROM TBHRM_HR_MASTR
	    WHERE EMPNO = #EMPNO#
    </insert>
    
    <insert id="HRM060501DAO.insertMlssAprsr" parameterClass="java.util.HashMap">
    	INSERT INTO TBHRM_MLSS_APRSR(
    			EVL_YEAR
    			, HT_SE
    			, EMPNO
    			, APRSR_NO
    			, APRSR_SE
    			, APRSR_EMPNO
    			, PRSEN_AT
				, REGISTER_ID
				, REGIST_DT
				, UPDUSR_ID
				, UPDT_DT
    	) VALUES (
    			#EVL_YEAR#
    			, #HT_SE#
    			, #EMPNO#
    			, (SELECT NVL(MAX(APRSR_NO), 0) + 1 
    			     FROM TBHRM_MLSS_APRSR 
    			    WHERE EVL_YEAR = #EVL_YEAR# 
    			      AND HT_SE = #HT_SE# 
    			      AND EMPNO = #EMPNO#
    			  )
    			, #APRSR_SE#
    			, #APRSR_EMPNO#
    			, '0'
				, #S_USER_ID#
			 	, SYSDATE
			 	, #S_USER_ID#
			 	, SYSDATE
    	)
    </insert>
    
    <!-- 중복여부 --> 
    <select id="HRM060501DAO.chkAprsee" parameterClass="java.util.HashMap" resultClass="java.lang.Integer">
    	SELECT COUNT(*) AS CNT
		FROM TBHRM_MLSS_APRSEE
		WHERE EMPNO = #EMPNO#
		  AND EVL_YEAR = #EVL_YEAR#
		  AND HT_SE = #HT_SE#
    </select>
    
    <!-- 새로 업로드 받을시 기존 테이블에서 데이터 모두삭제  -->
    <delete id="HRM060501DAO.deleteMlssAprsr" parameterClass="java.util.HashMap" >
    	DELETE FROM TBHRM_MLSS_APRSR
    	WHERE EVL_YEAR = #EVL_YEAR# 
    	  AND HT_SE = #HT_SE#
    </delete>
    
    <delete id="HRM060501DAO.deleteMlssAprsee" parameterClass="java.util.HashMap" >
    	DELETE FROM TBHRM_MLSS_APRSEE
    	WHERE EVL_YEAR = #EVL_YEAR# 
    	  AND HT_SE = #HT_SE#
    </delete>
    
    <!-- 점수 테이블 데이터 count -->
    <select id="HRM060501DAO.chkMlssScore" parameterClass="java.util.HashMap" resultClass="java.lang.Integer">
    	SELECT COUNT(*) AS SCORECNT
		FROM TBHRM_MLSS_SCORE
		WHERE EMPNO = #EMPNO#
		  AND EVL_YEAR = #EVL_YEAR#
		  AND HT_SE = #HT_SE#
    </select>	
   
   <!-- 제출여부 확인 -->
   <select id="HRM060501DAO.chkPrsenAt" parameterClass="java.util.HashMap" resultClass="java.lang.Integer">
    	SELECT COUNT(*) AS PRSENCNT
		FROM TBHRM_MLSS_APRSR
		WHERE EVL_YEAR = #EVL_YEAR#
		  AND HT_SE = #HT_SE#
		  AND NVL(PRSEN_AT, '0') = '0'
    </select>
    
    <update id="HRM060501DAO.deleteAprsrList" parameterClass="java.util.HashMap">
    	UPDATE TBHRM_MLSS_APRSR 
    	   SET APRSR_EMPNO = NULL
    	     , UPDUSR_ID = #S_USER_ID#
			 , UPDT_DT = SYSDATE
    	 WHERE EVL_YEAR = #EVL_YEAR#
    	   AND HT_SE = #HT_SE#
    </update>

    
    <!-- 평가자 상세목록 수정 -->
    <update id="HRM060501DAO.updateAprDetail" parameterClass="java.util.HashMap">
    	MERGE INTO TBHRM_MLSS_APRSR
		USING DUAL
		   ON (EVL_YEAR = #EVL_YEAR#
		   AND HT_SE = #HT_SE#
		   AND EMPNO = #EMPNO#
    	   AND APRSR_NO = #APRSR_NO#)
		WHEN MATCHED THEN
		UPDATE SET  APRSR_EMPNO               = #APRSR_EMPNO# 
					,UPDUSR_ID                 = #S_USER_ID#
					,UPDT_DT                   = SYSDATE
		WHEN NOT MATCHED THEN
		INSERT  (
			 EVL_YEAR
			,HT_SE
			,EMPNO
			,APRSR_NO
			,APRSR_SE
			,APRSR_EMPNO
			,PRSEN_AT
			,REGISTER_ID
			,REGIST_DT
			,UPDUSR_ID
			,UPDT_DT
		)VALUES (
			 #EVL_YEAR#
		    ,#HT_SE#
		    ,#EMPNO#
		    ,(SELECT NVL(MAX(APRSR_NO), 0) + 1 
    			     FROM TBHRM_MLSS_APRSR 
    			    WHERE EVL_YEAR = #EVL_YEAR# 
    			      AND HT_SE = #HT_SE# 
    			      AND EMPNO = #EMPNO#
    		 )
		    ,#APRSR_SE#
		    ,#APRSR_EMPNO#
		    ,'0'
		    ,#S_USER_ID#
	        ,SYSDATE
		    ,#S_USER_ID#
	        ,SYSDATE
		)
    </update>
    
    <!-- 평가자 상세목록 삭제 -->
    <delete id="HRM060501DAO.deleteAprDetail" parameterClass="java.util.HashMap">
    	DELETE FROM TBHRM_MLSS_APRSR
    	WHERE  EVL_YEAR = #EVL_YEAR#
		   AND HT_SE = #HT_SE#
		   AND EMPNO = #EMPNO#
    	   AND APRSR_NO = #APRSR_NO#
    </delete>
    
    <!-- 평가자 자동생성 -->
    <select id="HRM060501DAO.selectRandomList" resultClass="java.util.HashMap">
    <![CDATA[
		WITH T_MLSS AS (
		    /*발령정보*/
		    SELECT *
		    FROM (
		            SELECT t1.EMPNO
		                  ,t1.GNFD_SE
		                  ,CASE WHEN t3.JSSFC_SE IN ('05','06','100') THEN 'A' /*업무직(업무직,업무직(강사),전임강사)*/
		                        WHEN t3.JSSFC_SE IN ('02','03','04') THEN 'B'  /*일반직,계약직,청원경찰*/
		                   END JSSFC_TY
		                  ,DECODE(t3.JSSFC_SE,'03','Y','N') AS PSDP_AT /*청원경찰여부*/
		                  ,CASE WHEN t3.JSSFC_SE IN ('05','06','100') AND t3.ECNY_DE >= TO_CHAR(SYSDATE - 180, 'YYYYMMDD') THEN 'N' /*업무직 입사 6개월 이하 제외*/
		                        WHEN t3.JSSFC_SE IN ('02','03','04')  AND t3.ECNY_DE >= TO_CHAR(SYSDATE - 90 , 'YYYYMMDD') THEN 'N' /*일반직 입사 3개월 이하 제외*/
		                        ELSE 'Y'
		                   END AS TRGET_AT
		                  ,t1.DEPT_CODE
		                  ,t2.DEPT_NM AS DEPT_NM
		                  ,t1.GNFD_DE AS BGNDE
		                  ,TO_CHAR(NVL(TO_DATE(LAG(t1.GNFD_DE) OVER (PARTITION BY t1.EMPNO ORDER BY t1.GNFD_DE DESC),'YYYYMMDD')-1,SYSDATE),'YYYYMMDD') AS ENDDE
		                  ,NVL(TO_DATE(LAG(t1.GNFD_DE) OVER (PARTITION BY t1.EMPNO ORDER BY t1.GNFD_DE DESC),'YYYYMMDD')-1,TRUNC(SYSDATE)) - TO_DATE(t1.GNFD_DE,'YYYYMMDD') AS DAYCNT
		            FROM (
		                    SELECT EMPNO
		                         , DEPT_CODE /*2020.07.14 조회 안되서 주석처리 CASE WHEN GNFD_SE IN ('015','027') THEN '999999' ELSE DEPT_CODE END AS DEPT_CODE 육아휴직, 휴직*/
		                         , GNFD_DE
		                         , GNFD_SE
		                         , LEAD(DEPT_CODE) OVER (PARTITION BY EMPNO ORDER BY GNFD_DE DESC) BF_DEPT_CODE
		                    FROM TBHRM_GNFD_DTLS s1
		                    WHERE 1=1
		                      AND DEPT_CODE IS NOT NULL
		                      AND DCSN_AT = '1'
		                      AND NOT EXISTS (
		                        SELECT 1
		                        FROM TBHRM_HR_MASTR s2
		                        WHERE s1.EMPNO = s2.EMPNO
		                          AND s2.STTUS_SE IN ('001','003','007','009') /* 휴직, 외부파견, 질병휴직, 퇴사 제외 */
		                      )
		                 ) t1
		                 LEFT OUTER JOIN TBHRM_DEPT t2
		                 ON t1.DEPT_CODE = t2.DEPT_CODE
		                 LEFT OUTER JOIN TBHRM_HR_MASTR t3
		                 ON t1.EMPNO = t3.EMPNO
		            WHERE (NVL(t1.DEPT_CODE,'-') <> NVL(t1.BF_DEPT_CODE,'-') OR GNFD_SE IN ('003','004','007','016','017','028')) /*계약종료, 계약해지, 면직, 의원면직, 임용취소, 희망퇴직*/
		         )
		    WHERE TRGET_AT = 'Y'
		      AND GNFD_SE NOT IN ('003','004','007','016','017','028') /*계약종료, 계약해지, 면직, 의원면직, 임용취소, 희망퇴직*/
		      AND DEPT_CODE <> '999999'
		      AND ENDDE > TO_CHAR(SYSDATE - 365*3, 'YYYYMMDD')
		)
		, T_EXCTV_INFO AS (
		    /*임원정보*/
		    SELECT MAX(DECODE(OFCPS_SE,'01',EMPNO,NULL)) AS PRSD_EMPNO
		          ,MAX(DECODE(OFCPS_SE,'01',EMPNM,NULL)) AS PRSD_EMPNM
		          ,MAX(DECODE(OFCPS_SE,'35',EMPNO,NULL)) AS DRCT_EMPNO
		          ,MAX(DECODE(OFCPS_SE,'35',EMPNM,NULL)) AS DRCT_EMPNM
		    FROM TBHRM_HR_MASTR
		    WHERE OFCPS_SE IN ('01','35')
		      AND STTUS_SE NOT IN ('001','003','007','009')   /*휴직,외부파견,질병휴직,퇴사 제외*/
		)
		, T_CHIEF_INFO AS (
		    /*실처장정보*/
		    SELECT EMPNO
		         , EMPNM
		         , DEPT_CODE
		      FROM TBHRM_HR_MASTR
		     WHERE OFCPS_SE IN ('03','36','37','38','14','39') /*실처장*/
		       AND STTUS_SE NOT IN ('001','003','007','009')   /*휴직,외부파견,질병휴직,퇴사 제외*/
		
		)
		, T_TIMHDER_INFO AS (
		    /*팀장정보*/
		    SELECT T1.EMPNO
		         , T1.EMPNM
		         , T1.DEPT_CODE
		         , T2.UPPER_DEPT_CODE
		         , ROW_NUMBER() OVER(PARTITION BY T1.DEPT_CODE ORDER BY DBMS_RANDOM.VALUE) AS RANDOM_NUMBER1
		         , ROW_NUMBER() OVER(PARTITION BY T2.UPPER_DEPT_CODE ORDER BY DBMS_RANDOM.VALUE) AS RANDOM_NUMBER2
		      FROM TBHRM_HR_MASTR T1
		           INNER JOIN VWHRM_DEPT T2
		                ON T1.DEPT_CODE = T2.DEPT_CODE
		     WHERE T1.OFCPS_SE IN ('05','08') /*팀장*/
		       AND T1.STTUS_SE NOT IN ('001','003','007','009')   /*휴직,외부파견,질병휴직,퇴사 제외*/
		)
		, T_DEPT_INFO AS (
		    /*부서정보*/
		    SELECT 
		         s1.DEPT_CODE
		        ,s1.DEPT_NM
		        ,DECODE(s1.DEPT_CODE,'010000','020000',s1.UPPER_DEPT_CODE) AS UPPER_DEPT_CODE
		        ,s2.DEPT_NM         AS UPPER_DEPT_NM
		        ,s3.EMPNO           AS TEAM_EMPNO
		        ,s3.EMPNM           AS TEAM_EMPNM
		        ,s4.EMPNO           AS DEPT_EMPNO
		        ,s4.EMPNM           AS DEPT_EMPNM
		    FROM VWHRM_DEPT s1
		         INNER JOIN VWHRM_DEPT s2
		         ON s1.UPPER_DEPT_CODE = s2.DEPT_CODE
		         LEFT OUTER JOIN TBHRM_HR_MASTR s3
		         ON  s1.DEPT_CODE = s3.DEPT_CODE
		         AND s3.OFCPS_SE IN ('05','08') /*팀장,팀장직무대리*/
		         AND s3.STTUS_SE NOT IN ('001','003','007','009')   /*휴직,외부파견,질병휴직,퇴사 제외*/
		         LEFT OUTER JOIN TBHRM_HR_MASTR s4
		         ON  DECODE(s1.DEPT_CODE,'010000','020000',s1.UPPER_DEPT_CODE) = s4.DEPT_CODE
		         AND s4.OFCPS_SE IN ('03','36','37','38','14','39') /*실장,처장,단장,실장직무대행,센터장,처장직무대행*/
		         AND s4.STTUS_SE NOT IN ('001','003','007','009')   /*휴직,외부파견,질병휴직,퇴사 제외*/
		    WHERE s1.DEPT_SE = '03' OR s1.DEPT_CODE = '010000' /*윤리감사팀*/
		    ORDER BY s1.OUTPT_ORDR
		)
		, T_GNRL_CHIEF_EMP AS (
		    /*일반직 실처장-4급이하직원,청원경찰*/
		    SELECT  EMPNO
		          , EMPNO2
		          , DAYCNT
		          , ROW_NUMBER() OVER(PARTITION BY EMPNO ORDER BY DBMS_RANDOM.VALUE + ADDCNT) AS RANDOM_NUMBER
		    FROM (
		            SELECT EMPNO
		                  ,EMPNO2
		                  ,SUM(DAYCNT) AS DAYCNT
		                  ,AVG(ADDCNT) AS ADDCNT
		            FROM (
		                    SELECT 
		                           t1.EMPNO
		                          ,t2.EMPNO AS EMPNO2
		                          ,TO_DATE(LEAST(t1.ENDDE, t2.ENDDE),'YYYYMMDD') - TO_DATE(GREATEST(t1.BGNDE,t2.BGNDE,TO_CHAR(SYSDATE - 365*3, 'YYYYMMDD')),'YYYYMMDD') AS DAYCNT
		                          ,CASE WHEN t1.JSSFC_TY = t2.JSSFC_TY THEN 0 ELSE 100 END AS ADDCNT
		                    FROM T_MLSS t1
		                         INNER JOIN T_MLSS t2  
		                         ON  t1.DEPT_CODE = t2.DEPT_CODE
		                         AND t1.BGNDE <= t2.ENDDE
		                         AND t1.ENDDE >= t2.BGNDE
		                         AND t1.JSSFC_TY = t2.JSSFC_TY
		                    WHERE 1=1
		                      AND t1.EMPNO <> t2.EMPNO
		                      AND t1.JSSFC_TY = 'B'
		                      AND t1.PSDP_AT  = 'N'
		                      AND EXISTS (
		                        SELECT 1
		                        FROM TBHRM_HR_MASTR t3
		                        WHERE t1.EMPNO = t3.EMPNO
		                          AND t3.OFCPS_SE IN ('03','36','37','38','14','39') /*실처장*/
		                      )
		                      AND NOT EXISTS (
		                        SELECT 1
		                        FROM TBHRM_HR_MASTR t4
		                        WHERE t2.EMPNO = t4.EMPNO
		                          AND t4.OFCPS_SE IN ('01','02','35','03','04','05','08','35','36','37','38','31','14','39')  /* 상급자 제외 */
		                                             /*사장,상임이사,실장,부장,팀장,팀장직무대리,파트장,본부장,처장,처장직무대행,단장,실장직무대행,센터장*/
		                      )
		                  )
		            GROUP BY EMPNO, EMPNO2
		            HAVING SUM(DAYCNT) > 30
		    )
		)
		, TIMHDER_EMP AS (
		    /*팀장-팀장*/
		    SELECT T1.UPPER_DEPT_CODE
		         , T1.UPPER_DEPT_NM
		         , T1.DEPT_CODE
		         , T1.DEPT_NM
		         , T1.TEAM_EMPNO
		         , T1.TEAM_EMPNM
		         , T2.TEAM_EMPNO AS TEAM_EMPNO2
		         , T2.TEAM_EMPNM AS TEAM_EMPNM2
		         , T1.DEPT_EMPNO
		         , T1.DEPT_EMPNM
		         , CASE WHEN T3.JSSFC_SE IN ('05','06','100') AND T3.ECNY_DE >= TO_CHAR(SYSDATE - 180, 'YYYYMMDD') THEN 'N' /*업무직 입사 6개월 이하 제외*/
		                WHEN T3.JSSFC_SE IN ('02','03','04')  AND T3.ECNY_DE >= TO_CHAR(SYSDATE - 90 , 'YYYYMMDD') THEN 'N' /*일반직 입사 3개월 이하 제외*/
		                ELSE 'Y'
		           END AS TRGET_AT1
		         , CASE WHEN T4.JSSFC_SE IN ('05','06','100') AND T4.ECNY_DE >= TO_CHAR(SYSDATE - 180, 'YYYYMMDD') THEN 'N' /*업무직 입사 6개월 이하 제외*/
		                WHEN T4.JSSFC_SE IN ('02','03','04')  AND T4.ECNY_DE >= TO_CHAR(SYSDATE - 90 , 'YYYYMMDD') THEN 'N' /*일반직 입사 3개월 이하 제외*/
		                ELSE 'Y'
		           END AS TRGET_AT2
		         , ROW_NUMBER() OVER(PARTITION BY T1.UPPER_DEPT_CODE, T1.TEAM_EMPNO ORDER BY DBMS_RANDOM.VALUE) AS RANDOM_NUMBER
		      FROM T_DEPT_INFO T1
		           INNER JOIN T_DEPT_INFO T2
		                ON T1.UPPER_DEPT_CODE = T2.UPPER_DEPT_CODE
		           INNER JOIN TBHRM_HR_MASTR T3
		                ON T1.TEAM_EMPNO = T3.EMPNO
		           INNER JOIN TBHRM_HR_MASTR T4
		                ON T2.TEAM_EMPNO = T4.EMPNO
		     WHERE T1.TEAM_EMPNO <> T2.TEAM_EMPNO
		)
		, T_GNRL_TIMHDER_EMP AS (
		    /*일반직 팀장-팀장*/
		    SELECT EMPNO
		         , EMPNO2
		         , DAYCNT
		         , ROW_NUMBER() OVER(PARTITION BY EMPNO ORDER BY UPPER_DEPT_CODE_SE, DBMS_RANDOM.VALUE + ADDCNT) AS RANDOM_NUMBER
		      FROM (
		    SELECT  S1.EMPNO
		          , S1.EMPNO2
		          , S1.DAYCNT
		          , S1.ADDCNT
		          , CASE WHEN S3.UPPER_DEPT_CODE = S5.UPPER_DEPT_CODE THEN '1'
		                 ELSE '2'
		            END UPPER_DEPT_CODE_SE
		    FROM (
		            SELECT EMPNO
		                  ,EMPNO2
		                  ,SUM(DAYCNT) AS DAYCNT
		                  ,AVG(ADDCNT) AS ADDCNT
		            FROM (
		                    SELECT t1.EMPNO
		                          ,t2.EMPNO AS EMPNO2
		                          ,TO_DATE(LEAST(t1.ENDDE, t2.ENDDE),'YYYYMMDD') - TO_DATE(GREATEST(t1.BGNDE,t2.BGNDE,TO_CHAR(SYSDATE - 365*3, 'YYYYMMDD')),'YYYYMMDD') AS DAYCNT
		                          ,CASE WHEN t1.JSSFC_TY = t2.JSSFC_TY THEN 0 ELSE 100 END AS ADDCNT
		                    FROM T_MLSS t1
		                         INNER JOIN T_MLSS t2  
		                         ON  t1.DEPT_CODE = t2.DEPT_CODE
		                         AND t1.BGNDE <= t2.ENDDE
		                         AND t1.ENDDE >= t2.BGNDE
		                         AND t1.JSSFC_TY = t2.JSSFC_TY
		                    WHERE 1=1
		                      AND t1.EMPNO <> t2.EMPNO
		                      AND t1.JSSFC_TY = 'B'
		                      AND t1.PSDP_AT  = 'N'
		                      AND EXISTS (
		                        SELECT 1
		                        FROM TBHRM_HR_MASTR t3
		                        WHERE t1.EMPNO = t3.EMPNO
		                          AND t3.OFCPS_SE IN ('05','08')  /*팀장*/
		                      )
		                      AND EXISTS (
		                        SELECT 1
		                        FROM TBHRM_HR_MASTR t4
		                        WHERE t2.EMPNO = t4.EMPNO
		                          AND t4.OFCPS_SE IN ('05','08')  /*팀장*/
		                      )
		                      AND NOT EXISTS (
		                        SELECT 1
		                        FROM TIMHDER_EMP t5
		                        WHERE t1.EMPNO = t5.TEAM_EMPNO
		                          AND t2.EMPNO <> T5.TEAM_EMPNO2
		                      )
		                  )
		            GROUP BY EMPNO, EMPNO2
		            HAVING SUM(DAYCNT) > 30
		        ) S1
		        INNER JOIN TBHRM_HR_MASTR S2
		             ON S1.EMPNO = S2.EMPNO
		        INNER JOIN T_DEPT_INFO S3
		             ON S2.DEPT_CODE = S3.DEPT_CODE
		        INNER JOIN TBHRM_HR_MASTR S4
		             ON S1.EMPNO2 = S4.EMPNO
		        INNER JOIN T_DEPT_INFO S5
		             ON S4.DEPT_CODE = S5.DEPT_CODE
		        )
		)
		, T_GNRL_TIMHDER_EMP2 AS (
		    /*일반직 팀장-4급이하직원,청원경찰*/
		    SELECT  EMPNO
		          , EMPNO2
		          , DAYCNT
		          , ROW_NUMBER() OVER(PARTITION BY EMPNO ORDER BY DBMS_RANDOM.VALUE + ADDCNT) AS RANDOM_NUMBER
		    FROM (
		            SELECT EMPNO
		                  ,EMPNO2
		                  ,SUM(DAYCNT) AS DAYCNT
		                  ,AVG(ADDCNT) AS ADDCNT
		            FROM (
		                    SELECT 
		                           t1.EMPNO
		                          ,t2.EMPNO AS EMPNO2
		                          ,TO_DATE(LEAST(t1.ENDDE, t2.ENDDE),'YYYYMMDD') - TO_DATE(GREATEST(t1.BGNDE,t2.BGNDE,TO_CHAR(SYSDATE - 365*3, 'YYYYMMDD')),'YYYYMMDD') AS DAYCNT
		                          ,CASE WHEN t1.JSSFC_TY = t2.JSSFC_TY THEN 0 ELSE 100 END AS ADDCNT
		                    FROM T_MLSS t1
		                         INNER JOIN T_MLSS t2  
		                         ON  t1.DEPT_CODE = t2.DEPT_CODE
		                         AND t1.BGNDE <= t2.ENDDE
		                         AND t1.ENDDE >= t2.BGNDE
		                         AND t1.JSSFC_TY = t2.JSSFC_TY
		                    WHERE 1=1
		                      AND t1.EMPNO <> t2.EMPNO
		                      AND t1.JSSFC_TY = 'B'
		                      AND t1.PSDP_AT  = 'N'
		                      AND EXISTS (
		                        SELECT 1
		                        FROM TBHRM_HR_MASTR t3
		                        WHERE t1.EMPNO = t3.EMPNO
		                          AND t3.OFCPS_SE IN ('05','08')  /*팀장*/
		                      )
		                      AND NOT EXISTS (
		                        SELECT 1
		                        FROM TBHRM_HR_MASTR t4
		                        WHERE t2.EMPNO = t4.EMPNO
		                          AND t4.OFCPS_SE IN ('01','02','35','03','04','05','08','35','36','37','38','31','14','39')  /* 상급자 제외 */
		                                             /*사장,상임이사,실장,부장,팀장,팀장직무대리,파트장,본부장,처장,처장직무대행,단장,실장직무대행,센터장*/
		                      )
		                  )
		            GROUP BY EMPNO, EMPNO2
		            HAVING SUM(DAYCNT) > 30
		    )
		)
		, T_GNRL_EMP AS (
		    /*일반직 4급이하 직원*/
		    SELECT  EMPNO
		          , EMPNO2
		          , DAYCNT
		          , ROW_NUMBER() OVER(PARTITION BY EMPNO ORDER BY DBMS_RANDOM.VALUE + ADDCNT) AS RANDOM_NUMBER
		    FROM (
		            SELECT EMPNO
		                  ,EMPNO2
		                  ,SUM(DAYCNT) AS DAYCNT
		                  ,AVG(ADDCNT) AS ADDCNT
		            FROM (
		                    SELECT t1.EMPNO
		                          ,t2.EMPNO AS EMPNO2
		                          ,TO_DATE(LEAST(t1.ENDDE, t2.ENDDE),'YYYYMMDD') - TO_DATE(GREATEST(t1.BGNDE,t2.BGNDE,TO_CHAR(SYSDATE - 365*3, 'YYYYMMDD')),'YYYYMMDD') AS DAYCNT
		                          ,CASE WHEN t1.JSSFC_TY = t2.JSSFC_TY THEN 0 ELSE 100 END AS ADDCNT
		                    FROM T_MLSS t1
		                         INNER JOIN T_MLSS t2  
		                         ON  t1.DEPT_CODE = t2.DEPT_CODE
		                         AND t1.BGNDE <= t2.ENDDE
		                         AND t1.ENDDE >= t2.BGNDE
		                         AND t1.JSSFC_TY = t2.JSSFC_TY
		                    WHERE 1=1
		                      AND t1.EMPNO <> t2.EMPNO
		                      AND t1.JSSFC_TY = 'B'
		                      AND t1.PSDP_AT  = 'N'
		                      AND NOT EXISTS (
		                        SELECT 1
		                        FROM TBHRM_HR_MASTR t3
		                        WHERE t2.EMPNO = t3.EMPNO
		                          AND t3.OFCPS_SE IN ('01','02','35','03','04','05','08','35','36','37','38','31','14','39')  /* 상급자 제외 */
		                                             /*사장,상임이사,실장,부장,팀장,팀장직무대리,파트장,본부장,처장,처장직무대행,단장,실장직무대행,센터장*/
		                      )
		                  )
		            GROUP BY EMPNO, EMPNO2
		            HAVING SUM(DAYCNT) > 30
		        )
		)
		, T_GNRL_SAME_UPPER AS (
		    /*일반직 4급이하 동일 실처*/
		    SELECT T1.EMPNO
		         , T1.DEPT_CODE
		         , T2.UPPER_DEPT_CODE
		         , T1.JSSFC_SE
		         , T1.HR_CLSF_SE
		         , T1.OFCPS_SE
		         , T4.EMPNO      AS EMPNO2
		         , T4.DEPT_CODE  AS DEPT_CODE2
		         , T4.JSSFC_SE   AS JSSFC_SE2
		         , T4.HR_CLSF_SE AS HR_CLSF_SE2
		         , T4.OFCPS_SE   AS OFCPS_SE2
		         , ROW_NUMBER() OVER(PARTITION BY T1.EMPNO ORDER BY DBMS_RANDOM.VALUE) AS RANDOM_NUMBER
		      FROM TBHRM_HR_MASTR T1
		           INNER JOIN VWHRM_DEPT T2
		                ON T1.DEPT_CODE = T2.DEPT_CODE
		           INNER JOIN VWHRM_DEPT T3
		                ON T2.UPPER_DEPT_CODE = T3.UPPER_DEPT_CODE
		           INNER JOIN TBHRM_HR_MASTR T4
		                ON T3.DEPT_CODE = T4.DEPT_CODE
		     WHERE T1.EMPNO <> T4.EMPNO
		       AND T1.DEPT_CODE <> T4.DEPT_CODE
		       AND T1.OFCPS_SE NOT IN ('01','02','35','03','04','05','08','35','36','37','38','31','14','39')  /* 상급자 제외 */
		       AND T1.STTUS_SE NOT IN ('001','003','007','009')   /*휴직,외부파견,질병휴직,퇴사 제외*/
		       AND T1.JSSFC_SE IN ('02','04')  /*일반직,계약직*/
		       AND T1.ECNY_DE <= TO_CHAR(SYSDATE - 90 , 'YYYYMMDD') /*일반직 입사 3개월 이하 제외*/
		       AND T4.OFCPS_SE NOT IN ('01','02','35','03','04','05','08','35','36','37','38','31','14','39')  /* 상급자 제외 */
		       AND T4.STTUS_SE NOT IN ('001','003','007','009')   /*휴직,외부파견,질병휴직,퇴사 제외*/
		       AND T4.JSSFC_SE IN ('02','04')  /*일반직,계약직*/
		       AND T4.ECNY_DE <= TO_CHAR(SYSDATE - 90 , 'YYYYMMDD') /*일반직 입사 3개월 이하 제외*/
		)
		, T_JOB_EMP AS (
		    /*업무직 4급이하*/
		    SELECT  EMPNO
		          , EMPNO2
		          , DAYCNT
		          , ROW_NUMBER() OVER(PARTITION BY EMPNO ORDER BY DBMS_RANDOM.VALUE + ADDCNT) AS RANDOM_NUMBER
		    FROM (
		            SELECT EMPNO
		                  ,EMPNO2
		                  ,SUM(DAYCNT) AS DAYCNT
		                  ,AVG(ADDCNT) AS ADDCNT
		            FROM (
		                    SELECT t1.EMPNO
		                          ,t2.EMPNO AS EMPNO2
		                          ,TO_DATE(LEAST(t1.ENDDE, t2.ENDDE),'YYYYMMDD') - TO_DATE(GREATEST(t1.BGNDE,t2.BGNDE,TO_CHAR(SYSDATE - 365*3, 'YYYYMMDD')),'YYYYMMDD') AS DAYCNT
		                          ,CASE WHEN t1.JSSFC_TY = t2.JSSFC_TY THEN 0 ELSE 100 END AS ADDCNT
		                    FROM T_MLSS t1
		                         INNER JOIN T_MLSS t2  
		                         ON  t1.DEPT_CODE = t2.DEPT_CODE
		                         AND t1.BGNDE <= t2.ENDDE
		                         AND t1.ENDDE >= t2.BGNDE
		                         AND t1.JSSFC_TY = t2.JSSFC_TY
		                    WHERE 1=1
		                      AND t1.EMPNO <> t2.EMPNO
		                      AND t1.JSSFC_TY = 'A'
		                      AND NOT EXISTS (
		                        SELECT 1
		                        FROM TBHRM_HR_MASTR t3
		                        WHERE t2.EMPNO = t3.EMPNO
		                          AND t3.OFCPS_SE IN ('01','02','35','03','04','05','08','35','36','37','38','31','14','39')  /* 상급자 제외 */
		                                             /*사장,상임이사,실장,부장,팀장,팀장직무대리,파트장,본부장,처장,처장직무대행,단장,실장직무대행,센터장*/
		                      )
		                  )
		            GROUP BY EMPNO, EMPNO2
		            HAVING SUM(DAYCNT) > 30
		        )
		)
		, T_JOB_SAME_UPPER AS (
		    /*업무직 4급이하 동일 실처*/
		    SELECT T1.EMPNO
		         , T1.DEPT_CODE
		         , T2.UPPER_DEPT_CODE
		         , T1.JSSFC_SE
		         , T1.HR_CLSF_SE
		         , T1.OFCPS_SE
		         , T4.EMPNO      AS EMPNO2
		         , T4.DEPT_CODE  AS DEPT_CODE2
		         , T4.JSSFC_SE   AS JSSFC_SE2
		         , T4.HR_CLSF_SE AS HR_CLSF_SE2
		         , T4.OFCPS_SE   AS OFCPS_SE2
		         , ROW_NUMBER() OVER(PARTITION BY T1.EMPNO ORDER BY DBMS_RANDOM.VALUE) AS RANDOM_NUMBER
		      FROM TBHRM_HR_MASTR T1
		           INNER JOIN VWHRM_DEPT T2
		                ON T1.DEPT_CODE = T2.DEPT_CODE
		           INNER JOIN VWHRM_DEPT T3
		                ON T2.UPPER_DEPT_CODE = T3.UPPER_DEPT_CODE
		           INNER JOIN TBHRM_HR_MASTR T4
		                ON T3.DEPT_CODE = T4.DEPT_CODE
		     WHERE T1.EMPNO <> T4.EMPNO
		       AND T1.DEPT_CODE <> T4.DEPT_CODE
		       AND T1.OFCPS_SE NOT IN ('01','02','35','03','04','05','08','35','36','37','38','31','14','39')  /* 상급자 제외 */
		       AND T1.STTUS_SE NOT IN ('001','003','007','009')   /*휴직,외부파견,질병휴직,퇴사 제외*/
		       AND T1.JSSFC_SE IN ('05','06','100')  /*업무직,업무직(상사),전임강사*/
		       AND T1.ECNY_DE <= TO_CHAR(SYSDATE - 180 , 'YYYYMMDD') /*업무직 입사 6개월 이하 제외*/
		       AND T4.OFCPS_SE NOT IN ('01','02','35','03','04','05','08','35','36','37','38','31','14','39')  /* 상급자 제외 */
		       AND T4.STTUS_SE NOT IN ('001','003','007','009')   /*휴직,외부파견,질병휴직,퇴사 제외*/
		       AND T4.JSSFC_SE IN ('05','06','100')  /*일반직,계약직*/
		       AND T4.ECNY_DE <= TO_CHAR(SYSDATE - 180 , 'YYYYMMDD') /*업무직 입사 6개월 이하 제외*/
		)
		, T_PSDP_EMP AS (
		    /*청원경찰*/
		    SELECT  EMPNO
		          , EMPNO2
		          , DAYCNT
		          , ROW_NUMBER() OVER(PARTITION BY EMPNO ORDER BY DBMS_RANDOM.VALUE + ADDCNT) AS RANDOM_NUMBER
		    FROM (
		            SELECT EMPNO
		                  ,EMPNO2
		                  ,SUM(DAYCNT) AS DAYCNT
		                  ,AVG(ADDCNT) AS ADDCNT
		            FROM (
		                    SELECT t1.EMPNO
		                          ,t2.EMPNO AS EMPNO2
		                          ,TO_DATE(LEAST(t1.ENDDE, t2.ENDDE),'YYYYMMDD') - TO_DATE(GREATEST(t1.BGNDE,t2.BGNDE,TO_CHAR(SYSDATE - 365*3, 'YYYYMMDD')),'YYYYMMDD') AS DAYCNT
		                          ,CASE WHEN t1.JSSFC_TY = t2.JSSFC_TY THEN 0 ELSE 100 END AS ADDCNT
		                    FROM T_MLSS t1
		                         INNER JOIN T_MLSS t2  
		                         ON  t1.DEPT_CODE = t2.DEPT_CODE
		                         AND t1.BGNDE <= t2.ENDDE
		                         AND t1.ENDDE >= t2.BGNDE
		                         AND t1.JSSFC_TY = t2.JSSFC_TY
		                    WHERE 1=1
		                      AND t1.EMPNO <> t2.EMPNO
		                      AND t1.PSDP_AT = 'Y'
		                  )
		            GROUP BY EMPNO, EMPNO2
		            HAVING SUM(DAYCNT) > 30
		        )
		)
		, T_PSDP_SAME_UPPER AS (
		    /*청원경찰 4급이하 동일 실처*/
		    SELECT T1.EMPNO
		         , T1.DEPT_CODE
		         , T2.UPPER_DEPT_CODE
		         , T1.JSSFC_SE
		         , T1.HR_CLSF_SE
		         , T1.OFCPS_SE
		         , T4.EMPNO      AS EMPNO2
		         , T4.DEPT_CODE  AS DEPT_CODE2
		         , T4.JSSFC_SE   AS JSSFC_SE2
		         , T4.HR_CLSF_SE AS HR_CLSF_SE2
		         , T4.OFCPS_SE   AS OFCPS_SE2
		         , ROW_NUMBER() OVER(PARTITION BY T1.EMPNO ORDER BY DBMS_RANDOM.VALUE) AS RANDOM_NUMBER
		      FROM TBHRM_HR_MASTR T1
		           INNER JOIN VWHRM_DEPT T2
		                ON T1.DEPT_CODE = T2.DEPT_CODE
		           INNER JOIN VWHRM_DEPT T3
		                ON T2.UPPER_DEPT_CODE = T3.UPPER_DEPT_CODE
		           INNER JOIN TBHRM_HR_MASTR T4
		                ON T3.DEPT_CODE = T4.DEPT_CODE
		     WHERE T1.EMPNO <> T4.EMPNO
		       AND T1.DEPT_CODE <> T4.DEPT_CODE
		       AND T1.OFCPS_SE NOT IN ('01','02','35','03','04','05','08','35','36','37','38','31','14','39')  /* 상급자 제외 */
		       AND T1.STTUS_SE NOT IN ('001','003','007','009')   /*휴직,외부파견,질병휴직,퇴사 제외*/
		       AND T1.JSSFC_SE IN ('03')  /*일반직,청원경찰,계약직*/
		       AND T1.ECNY_DE <= TO_CHAR(SYSDATE - 90 , 'YYYYMMDD') /*일반직 입사 3개월 이하 제외*/
		       AND T4.OFCPS_SE NOT IN ('01','02','35','03','04','05','08','35','36','37','38','31','14','39')  /* 상급자 제외 */
		       AND T4.STTUS_SE NOT IN ('001','003','007','009')   /*휴직,외부파견,질병휴직,퇴사 제외*/
		       AND T4.JSSFC_SE IN ('02','03','04')  /*일반직,청원경찰,계약직*/
		       AND T4.ECNY_DE <= TO_CHAR(SYSDATE - 90 , 'YYYYMMDD') /*일반직 입사 3개월 이하 제외*/
		)
		, T_CHIEF AS (
		    /*실처장*/
		    SELECT T1.EMPNO
		         , T1.DEPT_CODE
		         , T2.EMPNO AS EMPNO2
		         , ROW_NUMBER() OVER(PARTITION BY T1.EMPNO ORDER BY DBMS_RANDOM.VALUE) AS RANDOM_NUMBER
		      FROM T_CHIEF_INFO T1
		           LEFT OUTER JOIN T_CHIEF_INFO T2
		                ON T1.EMPNO <> T2.EMPNO
		)
		, T_GNRL_2 AS (
		    /*실처장*/
		    SELECT s1.EMPNO
		          ,MAX(s2.JSSFC_SE)     AS JSSFC_SE
		          ,MAX(s2.HR_CLSF_SE)   AS HR_CLSF_SE
		          ,MAX(s2.OFCPS_SE)     AS OFCPS_SE
		          ,MAX(s4.DRCT_EMPNO)   AS EMPNO1 /*이사*/
		          ,MAX(s4.PRSD_EMPNO)   AS EMPNO2 /*사장*/
		          ,NULL                 AS EMPNO3
		          ,MAX(DECODE(s1.RANDOM_NUMBER,1,s1.EMPNO2,NULL)) AS EMPNO4  /*실처장*/
		          ,MAX(DECODE(s1.RANDOM_NUMBER,2,s1.EMPNO2,NULL)) AS EMPNO5  /*실처장*/
		          ,MAX(DECODE(s1.RANDOM_NUMBER,3,s1.EMPNO2,NULL)) AS EMPNO6  /*실처장*/
		          ,MAX(DECODE(s1.RANDOM_NUMBER,4,s1.EMPNO2,NULL)) AS EMPNO7  /*실처장*/
		          ,MAX(DECODE(s1.RANDOM_NUMBER,5,s1.EMPNO2,NULL)) AS EMPNO8  /*실처장*/
		          ,MAX(DECODE(s1.RANDOM_NUMBER,6,s1.EMPNO2,NULL)) AS EMPNO9  /*실처장*/
		          ,MAX(DECODE(s5.RANDOM_NUMBER2,1,s5.EMPNO,NULL)) AS EMPNO10 /*팀장*/
		          ,MAX(DECODE(s5.RANDOM_NUMBER2,2,s5.EMPNO,NULL)) AS EMPNO11 /*팀장*/
		          ,MAX(DECODE(s6.RANDOM_NUMBER,1,s6.EMPNO2,NULL)) AS EMPNO12
		          ,MAX(DECODE(s6.RANDOM_NUMBER,2,s6.EMPNO2,NULL)) AS EMPNO13
		          ,MAX(DECODE(s6.RANDOM_NUMBER,3,s6.EMPNO2,NULL)) AS EMPNO14
		          ,MAX(DECODE(s6.RANDOM_NUMBER,4,s6.EMPNO2,NULL)) AS EMPNO15
		          ,MAX(DECODE(s6.RANDOM_NUMBER,5,s6.EMPNO2,NULL)) AS EMPNO16
		          ,MAX(DECODE(s6.RANDOM_NUMBER,6,s6.EMPNO2,NULL)) AS EMPNO17
		    FROM T_CHIEF s1
		            INNER JOIN TBHRM_HR_MASTR s2
		            ON s1.EMPNO = s2.EMPNO
		            LEFT OUTER JOIN TBHRM_DEPT s3
		            ON s2.DEPT_CODE = s3.DEPT_CODE
		            INNER JOIN T_EXCTV_INFO s4
		            ON 1=1
		            LEFT OUTER JOIN T_TIMHDER_INFO s5
		            ON s1.DEPT_CODE = s5.UPPER_DEPT_CODE
		            LEFT OUTER JOIN T_GNRL_CHIEF_EMP s6
		            ON s1.EMPNO = s6.EMPNO
		    GROUP BY s1.EMPNO
		)
		, T_GNRL_3 AS (
		    /*팀장*/
		    SELECT s6.TEAM_EMPNO AS EMPNO
		          ,MAX(s2.JSSFC_SE)     AS JSSFC_SE
		          ,MAX(s2.HR_CLSF_SE)   AS HR_CLSF_SE
		          ,MAX(s2.OFCPS_SE)     AS OFCPS_SE
		          ,MAX(s3.DEPT_EMPNO)   AS EMPNO1 /*실처장*/
		          ,MAX(s4.DRCT_EMPNO)   AS EMPNO2 /*이사*/
		          ,MAX(s4.PRSD_EMPNO)   AS EMPNO3 /*사장*/
		          ,MAX(
		               CASE WHEN s6.RANDOM_NUMBER = 1 AND s6.TRGET_AT2 = 'Y' THEN s6.TEAM_EMPNO2
		                    WHEN s1.RANDOM_NUMBER = 1 THEN s1.EMPNO2
		                    ELSE NULL
		               END
		              ) AS EMPNO4 /*팀장*/
		          ,MAX(
		               CASE WHEN s6.RANDOM_NUMBER = 2 AND s6.TRGET_AT2 = 'Y' THEN s6.TEAM_EMPNO2
		                    WHEN s1.RANDOM_NUMBER = 2 THEN s1.EMPNO2
		                    ELSE NULL
		               END
		              ) AS EMPNO5 /*팀장*/
		          ,MAX(
		               CASE WHEN s6.RANDOM_NUMBER = 3 AND s6.TRGET_AT2 = 'Y' THEN s6.TEAM_EMPNO2
		                    WHEN s1.RANDOM_NUMBER = 3 THEN s1.EMPNO2
		                    ELSE NULL
		               END
		              ) AS EMPNO6 /*팀장*/
		          ,MAX(DECODE(s5.RANDOM_NUMBER,1,s5.EMPNO2,NULL)) AS EMPNO7
		          ,MAX(DECODE(s5.RANDOM_NUMBER,2,s5.EMPNO2,NULL)) AS EMPNO8
		          ,MAX(DECODE(s5.RANDOM_NUMBER,3,s5.EMPNO2,NULL)) AS EMPNO9
		          ,MAX(DECODE(s5.RANDOM_NUMBER,4,s5.EMPNO2,NULL)) AS EMPNO10
		          ,MAX(DECODE(s5.RANDOM_NUMBER,5,s5.EMPNO2,NULL)) AS EMPNO11
		          ,MAX(DECODE(s5.RANDOM_NUMBER,6,s5.EMPNO2,NULL)) AS EMPNO12
		          ,MAX(DECODE(s5.RANDOM_NUMBER,7,s5.EMPNO2,NULL)) AS EMPNO13
		          ,NULL AS EMPNO14
		          ,NULL AS EMPNO15
		          ,NULL AS EMPNO16
		          ,NULL AS EMPNO17
		    FROM TIMHDER_EMP s6
		         LEFT OUTER JOIN T_GNRL_TIMHDER_EMP s1
		              ON s6.TEAM_EMPNO = s1.EMPNO
		         LEFT OUTER JOIN TBHRM_HR_MASTR s2
		              ON s6.TEAM_EMPNO = s2.EMPNO
		         LEFT OUTER JOIN T_DEPT_INFO s3
		              ON s6.DEPT_CODE = s3.DEPT_CODE
		         LEFT OUTER JOIN T_EXCTV_INFO s4
		              ON 1=1
		         LEFT OUTER JOIN T_GNRL_TIMHDER_EMP2 s5
		              ON s6.TEAM_EMPNO = s5.EMPNO
		    WHERE s6.TRGET_AT1 = 'Y'
		    GROUP BY s6.TEAM_EMPNO
		)
		, T_GNRL_4 AS (
		    /*일반직 4급이하 직원*/
		    SELECT s1.EMPNO
		          ,MAX(s2.JSSFC_SE)     AS JSSFC_SE
		          ,MAX(s2.HR_CLSF_SE)   AS HR_CLSF_SE
		          ,MAX(s2.OFCPS_SE)     AS OFCPS_SE
		          ,MAX(s3.TEAM_EMPNO)   AS EMPNO1 /*팀장*/
		          ,MAX(s3.DEPT_EMPNO)   AS EMPNO2 /*실처장*/
		          ,NULL                 AS EMPNO3
		          ,MAX(DECODE(s1.RANDOM_NUMBER,1,s1.EMPNO2,NULL)) AS EMPNO4
		          ,MAX(DECODE(s1.RANDOM_NUMBER,2,s1.EMPNO2,NULL)) AS EMPNO5
		          ,MAX(DECODE(s1.RANDOM_NUMBER,3,s1.EMPNO2,NULL)) AS EMPNO6
		          ,MAX(DECODE(s1.RANDOM_NUMBER,4,s1.EMPNO2,NULL)) AS EMPNO7
		          ,MAX(DECODE(s1.RANDOM_NUMBER,5,s1.EMPNO2,NULL)) AS EMPNO8
		          ,MAX(DECODE(s1.RANDOM_NUMBER,6,s1.EMPNO2,NULL)) AS EMPNO9
		          ,MAX(DECODE(s1.RANDOM_NUMBER,7,s1.EMPNO2,NULL)) AS EMPNO10
		          ,MAX(DECODE(s1.RANDOM_NUMBER,8,s1.EMPNO2,NULL)) AS EMPNO11
		          ,NULL AS EMPNO12
		          ,NULL AS EMPNO13
		          ,NULL AS EMPNO14
		          ,NULL AS EMPNO15
		          ,NULL AS EMPNO16
		          ,NULL AS EMPNO17
		    FROM T_GNRL_EMP s1
		            INNER JOIN TBHRM_HR_MASTR s2
		            ON s1.EMPNO = s2.EMPNO
		            INNER JOIN T_DEPT_INFO s3
		            ON s2.DEPT_CODE = s3.DEPT_CODE
		            INNER JOIN T_EXCTV_INFO s4
		            ON 1=1
		    WHERE s2.OFCPS_SE NOT IN ('03','36','37','38','14','39','05','08') /*실,처,팀장 제외*/
		    GROUP BY s1.EMPNO
		)
		, T_GNRL_4_SAME_UPPER AS (
		    /*일반직 4급이하 동일실처 일반직*/
		    SELECT T1.EMPNO
		         , T1.EMPNO2
		         , ROW_NUMBER() OVER(PARTITION BY T1.EMPNO ORDER BY DBMS_RANDOM.VALUE) AS RANDOM_NUMBER
		      FROM T_GNRL_SAME_UPPER T1
		           INNER JOIN T_GNRL_4 T2
		                ON T1.EMPNO = T2.EMPNO
		     WHERE T1.EMPNO2 <> NVL(T2.EMPNO4 , 'COMPARE')
		       AND T1.EMPNO2 <> NVL(T2.EMPNO5 , 'COMPARE')
		       AND T1.EMPNO2 <> NVL(T2.EMPNO6 , 'COMPARE')
		       AND T1.EMPNO2 <> NVL(T2.EMPNO7 , 'COMPARE')
		       AND T1.EMPNO2 <> NVL(T2.EMPNO8 , 'COMPARE')
		       AND T1.EMPNO2 <> NVL(T2.EMPNO9 , 'COMPARE')
		       AND T1.EMPNO2 <> NVL(T2.EMPNO10, 'COMPARE')
		       AND T1.EMPNO2 <> NVL(T2.EMPNO11, 'COMPARE')
		)
		, GNRL_4 AS (
		    /*일반직 4급이하*/
		    SELECT T1.EMPNO
		         , T1.JSSFC_SE
		         , T1.HR_CLSF_SE
		         , T1.OFCPS_SE
		         , T1.EMPNO1
		         , T1.EMPNO2
		         , T1.EMPNO3
		         , NVL(T1.EMPNO4,  (SELECT EMPNO2 FROM T_GNRL_4_SAME_UPPER S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 1)) AS EMPNO4
		         , NVL(T1.EMPNO5,  (SELECT EMPNO2 FROM T_GNRL_4_SAME_UPPER S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 2)) AS EMPNO5
		         , NVL(T1.EMPNO6,  (SELECT EMPNO2 FROM T_GNRL_4_SAME_UPPER S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 3)) AS EMPNO6
		         , NVL(T1.EMPNO7,  (SELECT EMPNO2 FROM T_GNRL_4_SAME_UPPER S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 4)) AS EMPNO7
		         , NVL(T1.EMPNO8,  (SELECT EMPNO2 FROM T_GNRL_4_SAME_UPPER S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 5)) AS EMPNO8
		         , NVL(T1.EMPNO9,  (SELECT EMPNO2 FROM T_GNRL_4_SAME_UPPER S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 6)) AS EMPNO9
		         , NVL(T1.EMPNO10, (SELECT EMPNO2 FROM T_GNRL_4_SAME_UPPER S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 7)) AS EMPNO10
		         , NVL(T1.EMPNO11, (SELECT EMPNO2 FROM T_GNRL_4_SAME_UPPER S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 8)) AS EMPNO11
		         , T1.EMPNO12
		         , T1.EMPNO13
		         , T1.EMPNO14
		         , T1.EMPNO15
		         , T1.EMPNO16
		         , T1.EMPNO17
		      FROM T_GNRL_4 T1
		)
		, T_JOB AS (
		    /*업무직*/
		    SELECT s1.EMPNO
		          ,MAX(s2.JSSFC_SE)     AS JSSFC_SE
		          ,MAX(s2.HR_CLSF_SE)   AS HR_CLSF_SE
		          ,MAX(s2.OFCPS_SE)     AS OFCPS_SE
		          ,MAX(s3.TEAM_EMPNO)   AS EMPNO1 /*팀장*/
		          ,MAX(s3.DEPT_EMPNO)   AS EMPNO2 /*처장*/
		          ,NULL                 AS EMPNO3
		          ,MAX(DECODE(s1.RANDOM_NUMBER,1,s1.EMPNO2,NULL)) AS EMPNO4
		          ,MAX(DECODE(s1.RANDOM_NUMBER,2,s1.EMPNO2,NULL)) AS EMPNO5
		          ,MAX(DECODE(s1.RANDOM_NUMBER,3,s1.EMPNO2,NULL)) AS EMPNO6
		          ,MAX(DECODE(s1.RANDOM_NUMBER,4,s1.EMPNO2,NULL)) AS EMPNO7
		          ,MAX(DECODE(s1.RANDOM_NUMBER,5,s1.EMPNO2,NULL)) AS EMPNO8
		          ,MAX(DECODE(s1.RANDOM_NUMBER,6,s1.EMPNO2,NULL)) AS EMPNO9
		          ,MAX(DECODE(s1.RANDOM_NUMBER,7,s1.EMPNO2,NULL)) AS EMPNO10
		          ,MAX(DECODE(s1.RANDOM_NUMBER,8,s1.EMPNO2,NULL)) AS EMPNO11
		          ,NULL AS EMPNO12
		          ,NULL AS EMPNO13
		          ,NULL AS EMPNO14
		          ,NULL AS EMPNO15
		          ,NULL AS EMPNO16
		          ,NULL AS EMPNO17
		    FROM T_JOB_EMP s1
		            INNER JOIN TBHRM_HR_MASTR s2
		            ON s1.EMPNO = s2.EMPNO
		            INNER JOIN T_DEPT_INFO s3
		            ON s2.DEPT_CODE = s3.DEPT_CODE
		            INNER JOIN T_EXCTV_INFO s4
		            ON 1=1
		    GROUP BY s1.EMPNO
		)
		, T_JOB_SAME_UPPER2 AS (
		    /*업무직 동일실처 업무직*/
		    SELECT T1.EMPNO
		         , T1.EMPNO2
		         , ROW_NUMBER() OVER(PARTITION BY T1.EMPNO ORDER BY DBMS_RANDOM.VALUE) AS RANDOM_NUMBER
		      FROM T_JOB_SAME_UPPER T1
		           INNER JOIN T_JOB T2
		                ON T1.EMPNO = T2.EMPNO
		     WHERE T1.EMPNO2 <> NVL(T2.EMPNO4 , 'COMPARE')
		       AND T1.EMPNO2 <> NVL(T2.EMPNO5 , 'COMPARE')
		       AND T1.EMPNO2 <> NVL(T2.EMPNO6 , 'COMPARE')
		       AND T1.EMPNO2 <> NVL(T2.EMPNO7 , 'COMPARE')
		       AND T1.EMPNO2 <> NVL(T2.EMPNO8 , 'COMPARE')
		       AND T1.EMPNO2 <> NVL(T2.EMPNO9 , 'COMPARE')
		       AND T1.EMPNO2 <> NVL(T2.EMPNO10, 'COMPARE')
		       AND T1.EMPNO2 <> NVL(T2.EMPNO11, 'COMPARE')
		)
		, JOB_EMP AS (
		    /*업무직*/
		    SELECT T1.EMPNO
		         , T1.JSSFC_SE
		         , T1.HR_CLSF_SE
		         , T1.OFCPS_SE
		         , T1.EMPNO1
		         , T1.EMPNO2
		         , T1.EMPNO3
		         , NVL(T1.EMPNO4,  (SELECT EMPNO2 FROM T_JOB_SAME_UPPER2 S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 1)) AS EMPNO4
		         , NVL(T1.EMPNO5,  (SELECT EMPNO2 FROM T_JOB_SAME_UPPER2 S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 2)) AS EMPNO5
		         , NVL(T1.EMPNO6,  (SELECT EMPNO2 FROM T_JOB_SAME_UPPER2 S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 3)) AS EMPNO6
		         , NVL(T1.EMPNO7,  (SELECT EMPNO2 FROM T_JOB_SAME_UPPER2 S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 4)) AS EMPNO7
		         , NVL(T1.EMPNO8,  (SELECT EMPNO2 FROM T_JOB_SAME_UPPER2 S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 5)) AS EMPNO8
		         , NVL(T1.EMPNO9,  (SELECT EMPNO2 FROM T_JOB_SAME_UPPER2 S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 6)) AS EMPNO9
		         , NVL(T1.EMPNO10, (SELECT EMPNO2 FROM T_JOB_SAME_UPPER2 S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 7)) AS EMPNO10
		         , NVL(T1.EMPNO11, (SELECT EMPNO2 FROM T_JOB_SAME_UPPER2 S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 8)) AS EMPNO11
		         , T1.EMPNO12
		         , T1.EMPNO13
		         , T1.EMPNO14
		         , T1.EMPNO15
		         , T1.EMPNO16
		         , T1.EMPNO17
		      FROM T_JOB T1
		)
		, T_PSDP AS (
		    /*청원경찰*/
		    SELECT s1.EMPNO
		          ,MAX(s2.JSSFC_SE)     AS JSSFC_SE
		          ,MAX(s2.HR_CLSF_SE)   AS HR_CLSF_SE
		          ,MAX(s2.OFCPS_SE)     AS OFCPS_SE
		          ,MAX(s3.TEAM_EMPNO)   AS EMPNO1 /*팀장*/
		          ,MAX(s3.DEPT_EMPNO)   AS EMPNO2 /*처장*/
		          ,NULL                 AS EMPNO3
		          ,MAX(DECODE(s1.RANDOM_NUMBER,1,s1.EMPNO2,NULL)) AS EMPNO4
		          ,MAX(DECODE(s1.RANDOM_NUMBER,2,s1.EMPNO2,NULL)) AS EMPNO5
		          ,MAX(DECODE(s1.RANDOM_NUMBER,3,s1.EMPNO2,NULL)) AS EMPNO6
		          ,MAX(DECODE(s1.RANDOM_NUMBER,4,s1.EMPNO2,NULL)) AS EMPNO7
		          ,MAX(DECODE(s1.RANDOM_NUMBER,5,s1.EMPNO2,NULL)) AS EMPNO8
		          ,MAX(DECODE(s1.RANDOM_NUMBER,6,s1.EMPNO2,NULL)) AS EMPNO9
		          ,MAX(DECODE(s1.RANDOM_NUMBER,7,s1.EMPNO2,NULL)) AS EMPNO10
		          ,MAX(DECODE(s1.RANDOM_NUMBER,8,s1.EMPNO2,NULL)) AS EMPNO11
		          ,NULL AS EMPNO12
		          ,NULL AS EMPNO13
		          ,NULL AS EMPNO14
		          ,NULL AS EMPNO15
		          ,NULL AS EMPNO16
		          ,NULL AS EMPNO17
		    FROM T_PSDP_EMP s1
		            INNER JOIN TBHRM_HR_MASTR s2
		            ON s1.EMPNO = s2.EMPNO
		            INNER JOIN T_DEPT_INFO s3
		            ON s2.DEPT_CODE = s3.DEPT_CODE
		            INNER JOIN T_EXCTV_INFO s4
		            ON 1=1
		    GROUP BY s1.EMPNO
		)
		, T_PSDP_SAME_UPPER2 AS (
		    /*청원경찰 동일실처 일반직*/
		    SELECT T1.EMPNO
		         , T1.EMPNO2
		         , ROW_NUMBER() OVER(PARTITION BY T1.EMPNO ORDER BY DBMS_RANDOM.VALUE) AS RANDOM_NUMBER
		      FROM T_PSDP_SAME_UPPER T1
		           INNER JOIN T_PSDP T2
		                ON T1.EMPNO = T2.EMPNO
		     WHERE T1.EMPNO2 <> NVL(T2.EMPNO4 , 'COMPARE')
		       AND T1.EMPNO2 <> NVL(T2.EMPNO5 , 'COMPARE')
		       AND T1.EMPNO2 <> NVL(T2.EMPNO6 , 'COMPARE')
		       AND T1.EMPNO2 <> NVL(T2.EMPNO7 , 'COMPARE')
		       AND T1.EMPNO2 <> NVL(T2.EMPNO8 , 'COMPARE')
		       AND T1.EMPNO2 <> NVL(T2.EMPNO9 , 'COMPARE')
		       AND T1.EMPNO2 <> NVL(T2.EMPNO10, 'COMPARE')
		       AND T1.EMPNO2 <> NVL(T2.EMPNO11, 'COMPARE')
		)
		, PSDP_EMP AS (
		    /*청원경찰*/
		    SELECT T1.EMPNO
		         , T1.JSSFC_SE
		         , T1.HR_CLSF_SE
		         , T1.OFCPS_SE
		         , T1.EMPNO1
		         , T1.EMPNO2
		         , T1.EMPNO3
		         , NVL(T1.EMPNO4,  (SELECT EMPNO2 FROM T_PSDP_SAME_UPPER2 S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 1)) AS EMPNO4
		         , NVL(T1.EMPNO5,  (SELECT EMPNO2 FROM T_PSDP_SAME_UPPER2 S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 2)) AS EMPNO5
		         , NVL(T1.EMPNO6,  (SELECT EMPNO2 FROM T_PSDP_SAME_UPPER2 S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 3)) AS EMPNO6
		         , NVL(T1.EMPNO7,  (SELECT EMPNO2 FROM T_PSDP_SAME_UPPER2 S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 4)) AS EMPNO7
		         , NVL(T1.EMPNO8,  (SELECT EMPNO2 FROM T_PSDP_SAME_UPPER2 S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 5)) AS EMPNO8
		         , NVL(T1.EMPNO9,  (SELECT EMPNO2 FROM T_PSDP_SAME_UPPER2 S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 6)) AS EMPNO9
		         , NVL(T1.EMPNO10, (SELECT EMPNO2 FROM T_PSDP_SAME_UPPER2 S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 7)) AS EMPNO10
		         , NVL(T1.EMPNO11, (SELECT EMPNO2 FROM T_PSDP_SAME_UPPER2 S1 WHERE T1.EMPNO = S1.EMPNO AND RANDOM_NUMBER = 8)) AS EMPNO11
		         , T1.EMPNO12
		         , T1.EMPNO13
		         , T1.EMPNO14
		         , T1.EMPNO15
		         , T1.EMPNO16
		         , T1.EMPNO17
		      FROM T_PSDP T1
		)
		, TRGET_INFO AS (
		    SELECT EMPNO
		         , JSSFC_SE
		         , HR_CLSF_SE
		         , OFCPS_SE
		         , EMPNO1
		         , EMPNO2
		         , EMPNO3
		         , EMPNO4
		         , EMPNO5
		         , EMPNO6
		         , EMPNO7
		         , EMPNO8
		         , EMPNO9
		         , EMPNO10
		         , EMPNO11
		         , EMPNO12
		         , EMPNO13
		         , EMPNO14
		         , EMPNO15
		         , EMPNO16
		         , EMPNO17
		      FROM T_GNRL_2
		    UNION ALL
		    SELECT EMPNO
		         , JSSFC_SE
		         , HR_CLSF_SE
		         , OFCPS_SE
		         , EMPNO1
		         , EMPNO2
		         , EMPNO3
		         , EMPNO4
		         , EMPNO5
		         , EMPNO6
		         , EMPNO7
		         , EMPNO8
		         , EMPNO9
		         , EMPNO10
		         , EMPNO11
		         , EMPNO12
		         , EMPNO13
		         , EMPNO14
		         , EMPNO15
		         , EMPNO16
		         , EMPNO17
		      FROM T_GNRL_3
		    UNION ALL
		    SELECT EMPNO
		         , JSSFC_SE
		         , HR_CLSF_SE
		         , OFCPS_SE
		         , EMPNO1
		         , EMPNO2
		         , EMPNO3
		         , EMPNO4
		         , EMPNO5
		         , EMPNO6
		         , EMPNO7
		         , EMPNO8
		         , EMPNO9
		         , EMPNO10
		         , EMPNO11
		         , EMPNO12
		         , EMPNO13
		         , EMPNO14
		         , EMPNO15
		         , EMPNO16
		         , EMPNO17
		      FROM GNRL_4
		    UNION ALL
		    SELECT EMPNO
		         , JSSFC_SE
		         , HR_CLSF_SE
		         , OFCPS_SE
		         , EMPNO1
		         , EMPNO2
		         , EMPNO3
		         , EMPNO4
		         , EMPNO5
		         , EMPNO6
		         , EMPNO7
		         , EMPNO8
		         , EMPNO9
		         , EMPNO10
		         , EMPNO11
		         , EMPNO12
		         , EMPNO13
		         , EMPNO14
		         , EMPNO15
		         , EMPNO16
		         , EMPNO17
		      FROM JOB_EMP
		    UNION ALL
		    SELECT EMPNO
		         , JSSFC_SE
		         , HR_CLSF_SE
		         , OFCPS_SE
		         , EMPNO1
		         , EMPNO2
		         , EMPNO3
		         , EMPNO4
		         , EMPNO5
		         , EMPNO6
		         , EMPNO7
		         , EMPNO8
		         , EMPNO9
		         , EMPNO10
		         , EMPNO11
		         , EMPNO12
		         , EMPNO13
		         , EMPNO14
		         , EMPNO15
		         , EMPNO16
		         , EMPNO17
		      FROM PSDP_EMP
		)
		SELECT EMPNO
		     , JSSFC_SE
		     , HR_CLSF_SE
		     , OFCPS_SE
		     , EMPNO1
		     , EMPNO2
		     , EMPNO3
		     , EMPNO4
		     , EMPNO5
		     , EMPNO6
		     , EMPNO7
		     , EMPNO8
		     , EMPNO9
		     , EMPNO10
		     , EMPNO11
		     , EMPNO12
		     , EMPNO13
		     , EMPNO14
		     , EMPNO15
		     , EMPNO16
		     , EMPNO17
		  FROM TRGET_INFO
		ORDER BY JSSFC_SE, HR_CLSF_SE, OFCPS_SE
	]]>
    </select>
</sqlMap>