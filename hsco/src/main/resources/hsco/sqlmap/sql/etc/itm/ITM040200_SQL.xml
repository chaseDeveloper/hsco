<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="ITM040200_SQL">
	<typeAlias alias="egovMap"          type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<!-- 코드 목록조회 -->
	<!-- 
	<select id="ITM040200DAO.ITM040200List" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        SELECT     CHCK_YM, 
                   nvl((select max(SN)                           /*현재 201611월에 대한 SN의 최대값에서 이후에 조회되는 값이 NUL이면 1씩 증가하여 조회*/     
            	   		from TBITM_MT_CHCK_MANAGE
          				where chck_ym = #CHCK_YM#), 0) + rownum as SN,
                   MODEL_NO, 
                   EQPMN_NO, 
                   CHCK_MANAGE_IEM, 
                   CHCK_DETAIL_IEM, 
                   CHCK_THRHLD, 
                   CHCK_VALUE, 
                   CHCK_DCSN_ENNC, 
                   RM, 
                   CHCK_ATCH_FILE, 
                   REGISTER_ID, 
                   REGIST_DT, 
                   UPDUSR_ID, 
                   UPDT_DT
               FROM TBITM_MT_CHCK_MANAGE
              WHERE CHCK_YM = #CHCK_YM#
              <isNotEmpty property="MODEL_NO">
                AND MODEL_NO = #MODEL_NO#
              </isNotEmpty>
              <isNotEmpty property="EQPMN_NO">
                AND EQPMN_NO = #EQPMN_NO#
              </isNotEmpty>
               ORDER BY CHCK_MANAGE_IEM, SN DESC	        	     
    </select>
    -->
    <select id="ITM040200DAO.ITM040200List" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        SELECT     CHCK_YM, 
                   SN,
                   MODEL_NO, 
                   EQPMN_NO, 
                   CHCK_MANAGE_IEM, 
                   CHCK_DETAIL_IEM, 
                   CHCK_THRHLD, 
                   CHCK_VALUE, 
                   CHCK_DCSN_ENNC, 
                   RM, 
                   CHCK_ATCH_FILE, 
                   REGISTER_ID, 
                   REGIST_DT, 
                   UPDUSR_ID, 
                   UPDT_DT,
                   FILE_SN,
                   FILE_ORDR
               FROM TBITM_MT_CHCK_MANAGE
              WHERE CHCK_YM = #CHCK_YM#
              <isNotEmpty property="MODEL_NO">
                AND MODEL_NO = #MODEL_NO#
              </isNotEmpty>
              <isNotEmpty property="EQPMN_NO">
                AND EQPMN_NO = #EQPMN_NO#
              </isNotEmpty>
               ORDER BY CHCK_MANAGE_IEM, SN DESC
<!-- 
select * from (
  SELECT '1' AS NUM,
         CHCK_YM,
         TO_CHAR(SN) AS SN,
         MODEL_NO,
         EQPMN_NO,
         CHCK_MANAGE_IEM,
         CHCK_DETAIL_IEM,
         CHCK_THRHLD,
         CHCK_VALUE,
         CHCK_DCSN_ENNC,
         RM,
         '' AS RM2,
         CHCK_ATCH_FILE,
         REGISTER_ID,
         TO_CHAR(REGIST_DT, 'yyyymmdd') AS REGIST_DT,
         UPDUSR_ID,
         TO_CHAR(UPDT_DT, 'yyyymmdd') AS UPDT_DT,
         TO_CHAR(FILE_SN) AS FILE_SN,
         TO_CHAR(FILE_ORDR) AS FILE_ORDR
     FROM TBITM_MT_CHCK_MANAGE
   WHERE     CHCK_YM = #CHCK_YM#
              <isNotEmpty property="MODEL_NO">
                AND MODEL_NO = #MODEL_NO#
              </isNotEmpty>
              <isNotEmpty property="EQPMN_NO">
                AND EQPMN_NO = #EQPMN_NO#
              </isNotEmpty>
UNION
select   '2' AS NUM,
	     '' AS CHCK_YM,
         '' AS SN,
         MODEL_NO,
         EQPMN_NO,
         '' AS CHCK_MANAGE_IEM,
         '' AS CHCK_DETAIL_IEM,
         '' AS CHCK_THRHLD,
         '' AS CHCK_VALUE,
         '' AS CHCK_DCSN_ENNC,
         '' AS RM,
         RM AS RM2,
         '' AS CHCK_ATCH_FILE,
         '' AS REGISTER_ID,
         '' AS REGIST_DT,
         '' AS UPDUSR_ID,
         '' AS UPDT_DT,
         '' AS FILE_SN,
         '' AS FILE_ORDR
     FROM TBITM_EQPMN_LIST
   WHERE 1=1
              <isNotEmpty property="MODEL_NO">
                AND MODEL_NO = #MODEL_NO#
              </isNotEmpty>
              <isNotEmpty property="EQPMN_NO">
                AND EQPMN_NO = #EQPMN_NO#
              </isNotEmpty>
     UNION
          SELECT '3' AS NUM,
                 '' AS CHCK_YM,
                 '' AS SN,
                 MODEL_NO,
                 '' EQPMN_NO,
                 '' AS CHCK_MANAGE_IEM,
                 '' AS CHCK_DETAIL_IEM,
                 '' AS CHCK_THRHLD,
                 '' AS CHCK_VALUE,
                 '' AS CHCK_DCSN_ENNC,
                 '' AS RM,
                 RM AS RM2,
                 '' AS CHCK_ATCH_FILE,
                 '' AS REGISTER_ID,
                 '' AS REGIST_DT,
                 '' AS UPDUSR_ID,
                 '' AS UPDT_DT,
                 '' AS FILE_SN,
                 '' AS FILE_ORDR
            FROM TBITM_SW_REGSTR
           WHERE 1 = 1
             <isNotEmpty property="MODEL_NO">
             AND MODEL_NO = #MODEL_NO#
             </isNotEmpty> )
     ORDER BY CHCK_MANAGE_IEM, SN DESC
     -->	     
    </select>
    <!-- 업체 및 소속인원 목록조회 -->
	<select id="ITM040200DAO.ITM040200List_P" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
	    SELECT A.SERVC_ENTRPS_CODE, A.ENTRPS_NM
		  FROM TBCTR_SERVC_ENTRPS A
		 WHERE A.ENTRPS_SE = '03'
		   AND A.USE_AT = '1'
		   <isNotEmpty property="ENTRPS_NM">
		     AND A.ENTRPS_NM LIKE '%' || #ENTRPS_NM# ||'%'
		   </isNotEmpty>		   
		 ORDER BY A.ENTRPS_NM
	</select>
	
	
	<!-- 
		수정일시 : 2016.10.14
		수정내용 : SQL쿼리 수정.
		작성자 : 김선진 
	 -->
	<!-- IT분류코드 목록조회 -->
	<select id="ITM040200DAO.ITM040200ITCodeList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
<!--  	
 		 SELECT  A.IT_CL
                , A.IT_CODE AS CODE
                , '[' || A.IT_CODE || ']' || A.IT_CODE_NM AS CODE_NM
                , A.USE_AT
          FROM TBITM_IT_CL A, TBITM_IT_CL_DETAIL B
         WHERE A.IT_CL = '01'
           AND A.IT_CL = B.IT_CL
           AND A.IT_CODE = B.IT_CODE
           AND NVL(B.MT_CHCK_ENNC,'0') = '1'
           AND EXISTS(SELECT 1 FROM TBITM_EQPMN_CNTRCT_HIST C
                       WHERE SUBSTR(C.MODEl_NO,1,2) = A.IT_CODE                         
                         AND #CHCK_YM# BETWEEN SUBSTR(C.CNTRCT_BGNDE,1,6) AND SUBSTR(C.CNTRCT_ENDDE,1,6)                         
                         AND C.SERVC_ENTRPS_CODE LIKE #SERVC_ENTRPS_CODE#
                      )   
         UNION 		
         SELECT  A.IT_CL
                , A.IT_CODE AS CODE
                , '[' || A.IT_CODE || ']' || A.IT_CODE_NM AS CODE_NM
                , A.USE_AT
          FROM TBITM_IT_CL A, TBITM_IT_CL_DETAIL B
         WHERE A.IT_CL = '02'
           AND A.IT_CL = B.IT_CL
           AND A.IT_CODE = B.IT_CODE
           AND NVL(B.MT_CHCK_ENNC,'0') = '1'
           AND NVL(A.SLA_EVL_APPLC_ENNC,'0') = '1'
           AND EXISTS(SELECT 1 FROM TBITM_SW_REGSTR C
                       WHERE SUBSTR(C.MODEl_NO,1,2) = A.IT_CODE                         
                         AND C.SERVC_ENTRPS_CODE LIKE #SERVC_ENTRPS_CODE#
                      )             
         ORDER BY IT_CL, CODE
-->

		SELECT  A.IT_CL
                , A.IT_CODE AS CODE
                , '[' || A.IT_CODE || ']' || A.IT_CODE_NM AS CODE_NM
                , A.USE_AT
          FROM TBITM_IT_CL A, TBITM_IT_CL_DETAIL B
         WHERE A.IT_CL = '01'
           AND A.IT_CL = B.IT_CL
           AND A.IT_CODE = B.IT_CODE
            <!-- AND NVL(A.SLA_EVL_APPLC_ENNC,'0') = '1' -->     
           AND EXISTS(SELECT 1 FROM TBITM_EQPMN_CNTRCT_HIST C
                       WHERE SUBSTR(C.MODEl_NO,1,2) = A.IT_CODE                         
                         AND #CHCK_YM# BETWEEN SUBSTR(C.CNTRCT_BGNDE,1,6) AND SUBSTR(C.CNTRCT_ENDDE,1,6)                         
                         AND C.SERVC_ENTRPS_CODE LIKE #SERVC_ENTRPS_CODE#
                      )   
         UNION 		
         SELECT  A.IT_CL
                , A.IT_CODE AS CODE
                , '[' || A.IT_CODE || ']' || A.IT_CODE_NM AS CODE_NM
                , A.USE_AT
          FROM TBITM_IT_CL A, TBITM_IT_CL_DETAIL B
         WHERE A.IT_CL = '02'
           AND A.IT_CL = B.IT_CL
           AND A.IT_CODE = B.IT_CODE
           <!--AND NVL(B.MT_CHCK_ENNC,'0') = '1'-->
           <!-- AND NVL(A.SLA_EVL_APPLC_ENNC,'0') = '1' -->           
           AND EXISTS(SELECT 1 FROM TBITM_SW_CNTRCT_HIST C
                       WHERE SUBSTR(C.MODEl_NO,1,2) = A.IT_CODE                         
                         AND #CHCK_YM# BETWEEN SUBSTR(C.CNTRCT_BGNDE,1,6) AND SUBSTR(C.CNTRCT_ENDDE,1,6)
                         AND C.SERVC_ENTRPS_CODE LIKE #SERVC_ENTRPS_CODE#
                      )             
         ORDER BY IT_CL, CODE
	</select>
	
	<!-- IT분류코드상세 목록조회 -->
	<select id="ITM040200DAO.ITM040200ITCodeDetail" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
	<!-- 
		SELECT   IT_CL
		       , IT_CODE
		       , IT_DETAIL_CODE AS CODE
		       , '[' || IT_DETAIL_CODE || ']' || IT_DETAIL_CODE_NM AS CODE_NM
		       , USE_AT
		  FROM TBITM_IT_CL_DETAIL A
		 WHERE A.IT_CODE LIKE #IT_CODE#
		   AND NVL(A.MT_CHCK_ENNC,'0') = '1'
		   AND (EXISTS(SELECT 1 FROM TBITM_EQPMN_CNTRCT_HIST C
                       WHERE SUBSTR(C.MODEl_NO,1,2) = A.IT_CODE
                         AND SUBSTR(C.MODEl_NO,3,3) = A.IT_DETAIL_CODE                         
                         AND #CHCK_YM# BETWEEN SUBSTR(C.CNTRCT_BGNDE,1,6) AND SUBSTR(C.CNTRCT_ENDDE,1,6)                         
                         AND C.SERVC_ENTRPS_CODE LIKE #SERVC_ENTRPS_CODE#
                      ) 
           OR  EXISTS(SELECT 1 FROM TBITM_SW_REGSTR C
                       WHERE SUBSTR(C.MODEl_NO,1,2) = A.IT_CODE
                         AND SUBSTR(C.MODEl_NO,3,3) = A.IT_DETAIL_CODE                         
                         AND C.SERVC_ENTRPS_CODE LIKE #SERVC_ENTRPS_CODE#
                      )
               )                
		 ORDER BY IT_CL, IT_CODE, CODE
	-->
		SELECT   IT_CL
		       , IT_CODE
		       , IT_DETAIL_CODE AS CODE
		       , '[' || IT_DETAIL_CODE || ']' || IT_DETAIL_CODE_NM AS CODE_NM
		       , USE_AT
		  FROM TBITM_IT_CL_DETAIL A
		 WHERE A.IT_CODE LIKE #IT_CODE#
		   <!-- AND NVL(A.MT_CHCK_ENNC,'0') = '1'  -->
		   AND (EXISTS(SELECT 1 FROM TBITM_EQPMN_CNTRCT_HIST C
                       WHERE SUBSTR(C.MODEl_NO,1,2) = A.IT_CODE
                         AND SUBSTR(C.MODEl_NO,3,3) = A.IT_DETAIL_CODE                         
                         AND #CHCK_YM# BETWEEN SUBSTR(C.CNTRCT_BGNDE,1,6) AND SUBSTR(C.CNTRCT_ENDDE,1,6)                         
                         AND C.SERVC_ENTRPS_CODE LIKE #SERVC_ENTRPS_CODE#
                      ) 
           OR  EXISTS(SELECT 1 FROM TBITM_SW_CNTRCT_HIST C
                       WHERE SUBSTR(C.MODEl_NO,1,2) = A.IT_CODE
                         AND SUBSTR(C.MODEl_NO,3,3) = A.IT_DETAIL_CODE                         
                         AND #CHCK_YM# BETWEEN SUBSTR(C.CNTRCT_BGNDE,1,6) AND SUBSTR(C.CNTRCT_ENDDE,1,6)
                         AND C.SERVC_ENTRPS_CODE LIKE #SERVC_ENTRPS_CODE#
                      )
               )                
		 ORDER BY IT_CL, IT_CODE, CODE
	</select>
	
	<!-- 모델 목록조회 -->
	<select id="ITM040200DAO.ITM040200MODELCodeList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
	<!--
		 SELECT A.HW_SE AS IT_CODE , A.EQPMN_SE AS IT_DETAIL_CODE, A.MODEL_NO AS CODE
             , '[' || A.MODEL_NM || ']' || B.EQPMN_NO AS CODE_NM
	         , B.EQPMN_NO AS EQPMN_NO
		  FROM TBITM_EQPMN_REGSTR A,
		       TBITM_EQPMN_LIST B
		 WHERE A.MODEL_NO = B.MODEL_NO
		   AND A.HW_SE LIKE #IT_CODE#   
		   AND A.EQPMN_SE LIKE #IT_DETAIL_CODE#   
           AND EXISTS(SELECT 1 FROM TBITM_EQPMN_CNTRCT_HIST C
                       WHERE C.MODEl_NO = B.MODEL_NO
                         AND C.EQPMN_NO = B.EQPMN_NO
                         AND #CHCK_YM# BETWEEN SUBSTR(C.CNTRCT_BGNDE,1,6) AND SUBSTR(C.CNTRCT_ENDDE,1,6)                         
                         AND C.SERVC_ENTRPS_CODE LIKE #SERVC_ENTRPS_CODE#
                      )
         UNION 
         SELECT A.SW_JOB_SE AS IT_CODE , A.SW_SE AS IT_DETAIL_CODE, A.MODEL_NO AS CODE
             , '[' || A.MODEL_NM || '] 1'  AS CODE_NM
	         , '1' AS EQPMN_NO
		  FROM TBITM_SW_REGSTR A
		 WHERE A.SW_JOB_SE LIKE #IT_CODE#   
		   AND A.SW_SE LIKE #IT_DETAIL_CODE#   
		   AND A.SERVC_ENTRPS_CODE LIKE #SERVC_ENTRPS_CODE#
	-->
		SELECT '1' AS NUM, A.HW_SE AS IT_CODE , A.EQPMN_SE AS IT_DETAIL_CODE, A.MODEL_NO AS CODE
	             , '[' || A.MODEL_NM || ']' || B.EQPMN_NO AS CODE_NM
		         , B.EQPMN_NO AS EQPMN_NO
		         , B.RM
			  FROM TBITM_EQPMN_REGSTR A,
			       TBITM_EQPMN_LIST B
			 WHERE A.MODEL_NO = B.MODEL_NO
			   AND A.HW_SE LIKE #IT_CODE#   
			   AND A.EQPMN_SE LIKE #IT_DETAIL_CODE#   
	           AND EXISTS(SELECT 1 FROM TBITM_EQPMN_CNTRCT_HIST C
	                       WHERE C.MODEl_NO = B.MODEL_NO
	                         AND C.EQPMN_NO = B.EQPMN_NO
	                         AND #CHCK_YM# BETWEEN SUBSTR(C.CNTRCT_BGNDE,1,6) AND SUBSTR(C.CNTRCT_ENDDE,1,6)                         
	                         <!-- AND C.SERVC_ENTRPS_CODE LIKE #SERVC_ENTRPS_CODE# -->
	                      )
	         UNION 
	         SELECT '2' AS NUM, A.SW_JOB_SE AS IT_CODE , A.SW_SE AS IT_DETAIL_CODE, A.MODEL_NO AS CODE
	             , '[' || A.MODEL_NM || '] 1'  AS CODE_NM
		         , '1' AS EQPMN_NO
		         , A.CHCK_RM AS RM
			  FROM TBITM_SW_REGSTR A
			 WHERE A.SW_JOB_SE LIKE #IT_CODE#   
			   AND A.SW_SE LIKE #IT_DETAIL_CODE#   
			   <!-- AND A.SERVC_ENTRPS_CODE LIKE #SERVC_ENTRPS_CODE# -->
	           AND EXISTS(SELECT 1 FROM TBITM_SW_CNTRCT_HIST C
	                       WHERE C.MODEl_NO = A.MODEL_NO
	                         AND #CHCK_YM# BETWEEN SUBSTR(C.CNTRCT_BGNDE,1,6) AND SUBSTR(C.CNTRCT_ENDDE,1,6)                         
	                         <!-- AND C.SERVC_ENTRPS_CODE LIKE #SERVC_ENTRPS_CODE# -->
	                      )			   
	</select>
	
    <!-- 운영현황표 Master 목록조회 -->
	<select id="ITM040200DAO.ITM040200Tab2List" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT '[' || C.IT_CODE || ']' || C.IT_CODE_NM as HW_SE
		     , A.MODEL_NO, B.MODEL_NM, A.EQPMN_NO, C.SORT_STDR, C.IT_CODE  
		  FROM TBITM_MT_CHCK_MANAGE A, TBITM_EQPMN_REGSTR B, TBITM_IT_CL C
		 WHERE A.MODEL_NO = B.MODEL_NO
		   AND C.IT_CODE = B.HW_SE
		   <isNotEmpty property="MODEL_NO">
		   AND A.MODEL_NO = #MODEL_NO#
		   </isNotEmpty>
		   <isNotEmpty property="EQPMN_NO">
           AND A.EQPMN_NO = #EQPMN_NO#
           </isNotEmpty>
           AND EXISTS(SELECT 1 FROM TBITM_EQPMN_CNTRCT_HIST S
                       WHERE S.MODEL_NO = A.MODEL_NO
                         AND S.EQPMN_NO = A.EQPMN_NO
                         AND #CHCK_YM# BETWEEN SUBSTR(S.CNTRCT_BGNDE,1,6) AND SUBSTR(S.CNTRCT_ENDDE,1,6)
                         <isNotEmpty property="SERVC_ENTRPS_CODE">                         
                         AND S.SERVC_ENTRPS_CODE LIKE #SERVC_ENTRPS_CODE#
                         </isNotEmpty>
                      )                      
		 GROUP BY C.SORT_STDR, C.IT_CODE, C.IT_CODE_NM, A.MODEL_NO, B.MODEL_NM, A.EQPMN_NO
		 UNION
		 SELECT '[' || C.IT_CODE || ']' || C.IT_CODE_NM as HW_SE
		      , A.MODEL_NO, B.MODEL_NM, A.EQPMN_NO, C.SORT_STDR, C.IT_CODE  
		  FROM TBITM_MT_CHCK_MANAGE A, TBITM_SW_REGSTR B, TBITM_IT_CL C
		 WHERE A.MODEL_NO = B.MODEL_NO
		   AND C.IT_CODE = B.SW_JOB_SE
		   <isNotEmpty property="MODEL_NO">
		   AND A.MODEL_NO = #MODEL_NO#
		   </isNotEmpty>
		   <isNotEmpty property="EQPMN_NO">
           AND A.EQPMN_NO = #EQPMN_NO#
           </isNotEmpty>
           AND EXISTS(SELECT 1 FROM TBITM_SW_CNTRCT_HIST S
                       WHERE S.MODEL_NO = A.MODEL_NO
                         AND #CHCK_YM# BETWEEN SUBSTR(S.CNTRCT_BGNDE,1,6) AND SUBSTR(S.CNTRCT_ENDDE,1,6)
                         <isNotEmpty property="SERVC_ENTRPS_CODE">                         
                         AND S.SERVC_ENTRPS_CODE LIKE #SERVC_ENTRPS_CODE#
                         </isNotEmpty>
                      )  
		 GROUP BY C.SORT_STDR, C.IT_CODE, C.IT_CODE_NM, A.MODEL_NO, B.MODEL_NM, A.EQPMN_NO		 
		 ORDER BY SORT_STDR, IT_CODE, MODEL_NO, EQPMN_NO
    </select>
    
    <!-- 운영현황표 월 타이틀 록조회 -->
	<select id="ITM040200DAO.ITM040200Tab2Month" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
             SELECT to_char(add_months(#CHCK_YM# ||'10', -11),'yyyy-mm') as V01  
			       , to_char(add_months(#CHCK_YM# ||'10', -10),'yyyy-mm') as V02
			       , to_char(add_months(#CHCK_YM# ||'10', -9),'yyyy-mm') as V03
			       , to_char(add_months(#CHCK_YM# ||'10', -8),'yyyy-mm') as V04
			       , to_char(add_months(#CHCK_YM# ||'10', -7),'yyyy-mm') as V05
			       , to_char(add_months(#CHCK_YM# ||'10', -6),'yyyy-mm') as V06
			       , to_char(add_months(#CHCK_YM# ||'10', -5),'yyyy-mm') as V07
			       , to_char(add_months(#CHCK_YM# ||'10', -4),'yyyy-mm') as V08
			       , to_char(add_months(#CHCK_YM# ||'10', -3),'yyyy-mm') as V09
			       , to_char(add_months(#CHCK_YM# ||'10', -2),'yyyy-mm') as V10
			       , to_char(add_months(#CHCK_YM# ||'10', -1),'yyyy-mm') as V11
			       , substr( #CHCK_YM#,1,4 ) || '-' || substr( #CHCK_YM#,5,2 ) as V12
       from dual
    </select>
    
    <!-- 운영현황표 Detail 목록조회 -->
	<select id="ITM040200DAO.ITM040200Tab22List" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT A.MODEL_NO, A.EQPMN_NO,B.MODEL_NM, A.CHCK_MANAGE_IEM, A.CHCK_DETAIL_IEM
		       , max(decode(A.CHCK_YM, #CHCK_YM#, A.CHCK_VALUE,'')) as CHCK_THRHLD
		       , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -11),'yyyymm'),A.CHCK_VALUE,'')) as V01  
		       , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -10),'yyyymm'),A.CHCK_VALUE,'')) as V02
		       , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -9 ),'yyyymm'),A.CHCK_VALUE,'')) as V03
		       , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -8 ),'yyyymm'),A.CHCK_VALUE,'')) as V04
		       , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -7 ),'yyyymm'),A.CHCK_VALUE,'')) as V05
		       , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -6 ),'yyyymm'),A.CHCK_VALUE,'')) as V06
		       , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -5 ),'yyyymm'),A.CHCK_VALUE,'')) as V07
		       , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -4 ),'yyyymm'),A.CHCK_VALUE,'')) as V08
		       , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -3 ),'yyyymm'),A.CHCK_VALUE,'')) as V09
		       , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -2 ),'yyyymm'),A.CHCK_VALUE,'')) as V10
		       , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -1 ),'yyyymm'),A.CHCK_VALUE,'')) as V11
		       , max(decode(A.CHCK_YM, #CHCK_YM#, A.CHCK_VALUE, '')) as V12
          FROM TBITM_MT_CHCK_MANAGE A, TBITM_EQPMN_REGSTR B 
         WHERE CHCK_YM between to_char(add_months( #CHCK_YM# ||'10', -11),'yyyymm') and #CHCK_YM#                
           AND A.MODEL_NO = B.MODEL_NO
           AND A.MODEL_NO = #MODEL_NO#
           AND A.EQPMN_NO = #EQPMN_NO#
        GROUP BY A.MODEL_NO, A.EQPMN_NO, B.MODEL_NM, A.CHCK_MANAGE_IEM, A.CHCK_DETAIL_IEM, CHCK_THRHLD
        UNION
        SELECT A.MODEL_NO, A.EQPMN_NO,B.MODEL_NM, A.CHCK_MANAGE_IEM, A.CHCK_DETAIL_IEM
		       , max(decode(A.CHCK_YM, #CHCK_YM#, A.CHCK_VALUE,'')) as CHCK_THRHLD
		       , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -11),'yyyymm'),A.CHCK_VALUE,'')) as V01  
		       , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -10),'yyyymm'),A.CHCK_VALUE,'')) as V02
		       , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -9 ),'yyyymm'),A.CHCK_VALUE,'')) as V03
		       , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -8 ),'yyyymm'),A.CHCK_VALUE,'')) as V04
		       , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -7 ),'yyyymm'),A.CHCK_VALUE,'')) as V05
		       , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -6 ),'yyyymm'),A.CHCK_VALUE,'')) as V06
		       , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -5 ),'yyyymm'),A.CHCK_VALUE,'')) as V07
		       , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -4 ),'yyyymm'),A.CHCK_VALUE,'')) as V08
		       , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -3 ),'yyyymm'),A.CHCK_VALUE,'')) as V09
		       , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -2 ),'yyyymm'),A.CHCK_VALUE,'')) as V10
		       , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -1 ),'yyyymm'),A.CHCK_VALUE,'')) as V11
		       , max(decode(A.CHCK_YM, #CHCK_YM#, A.CHCK_VALUE, '')) as V12
          FROM TBITM_MT_CHCK_MANAGE A, TBITM_SW_REGSTR B 
         WHERE CHCK_YM between to_char(add_months( #CHCK_YM# ||'10', -11),'yyyymm') and #CHCK_YM#                
           AND A.MODEL_NO = B.MODEL_NO
           AND A.MODEL_NO = #MODEL_NO#
           AND A.EQPMN_NO = #EQPMN_NO#
        GROUP BY A.MODEL_NO, A.EQPMN_NO, B.MODEL_NM, A.CHCK_MANAGE_IEM, A.CHCK_DETAIL_IEM, CHCK_THRHLD
          ORDER BY MODEL_NO, EQPMN_NO,MODEL_NM, CHCK_MANAGE_IEM 
    </select>      
        
    <!-- 운영현황표 특이사항 목록조회 -->
	<select id="ITM040200DAO.ITM040200Tab23List" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
             SELECT CHCK_YM, RM
               FROM TBITM_MT_CHCK_MANAGE A 
              WHERE CHCK_YM between to_char(add_months( #CHCK_YM# ||'10', -11),'yyyymm') and #CHCK_YM#
                AND A.MODEL_NO = #MODEL_NO#
                AND A.EQPMN_NO = #EQPMN_NO#
                AND A.RM IS NOT NULL
                ORDER BY CHCK_YM DESC
    </select>
        
    <!-- 월정기점검관리 운영현황표 보고서 조회 -->
    <select id="ITM040200DAO.ITM040200Report" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		    SELECT A.MODEL_NO, A.EQPMN_NO,B.MODEL_NM, A.CHCK_MANAGE_IEM
		               , (SELECT CODE_NM from TBCOM_CMMN_CODE M WHERE M.GRP_CODE = 'ITM004' AND M.CODE = A.CHCK_MANAGE_IEM) CHCK_MANAGE_NAME 
		               , A.CHCK_DETAIL_IEM
		               , '[' || B.HW_SE || ']' || C.IT_CODE_NM  AS IT_CODE_NM
		               , max(decode(A.CHCK_YM, #CHCK_YM#, A.CHCK_VALUE,'')) as CHCK_THRHLD
		               , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -11),'yyyymm'),A.CHCK_VALUE,'')) as V01  
		               , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -10),'yyyymm'),A.CHCK_VALUE,'')) as V02
		               , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -9 ),'yyyymm'),A.CHCK_VALUE,'')) as V03
		               , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -8 ),'yyyymm'),A.CHCK_VALUE,'')) as V04
		               , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -7 ),'yyyymm'),A.CHCK_VALUE,'')) as V05
		               , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -6 ),'yyyymm'),A.CHCK_VALUE,'')) as V06
		               , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -5 ),'yyyymm'),A.CHCK_VALUE,'')) as V07
		               , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -4 ),'yyyymm'),A.CHCK_VALUE,'')) as V08
		               , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -3 ),'yyyymm'),A.CHCK_VALUE,'')) as V09
		               , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -2 ),'yyyymm'),A.CHCK_VALUE,'')) as V10
		               , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -1 ),'yyyymm'),A.CHCK_VALUE,'')) as V11
		               , max(decode(A.CHCK_YM, #CHCK_YM#, A.CHCK_VALUE, '')) as V12
		               , C.SORT_STDR, C.IT_CODE
		          FROM TBITM_MT_CHCK_MANAGE A, TBITM_EQPMN_REGSTR B, TBITM_IT_CL C 
		         WHERE CHCK_YM between to_char(add_months( #CHCK_YM# ||'10', -11),'yyyymm') and #CHCK_YM#                
		           AND A.MODEL_NO = B.MODEL_NO   
		           AND C.IT_CL = '01'                  
                   AND B.HW_SE = C.IT_CODE 
		           <isNotEmpty property="MODEL_NO">        
		             AND A.MODEL_NO = #MODEL_NO#
		           </isNotEmpty>
		           <isNotEmpty property="EQPMN_NO">        
		             AND A.EQPMN_NO = #EQPMN_NO#
		           </isNotEmpty>
		           AND EXISTS(SELECT 1 FROM TBITM_EQPMN_CNTRCT_HIST S
		                       WHERE S.MODEL_NO = A.MODEL_NO
		                         AND S.EQPMN_NO = A.EQPMN_NO
		                         AND #CHCK_YM# BETWEEN SUBSTR(S.CNTRCT_BGNDE,1,6) AND SUBSTR(S.CNTRCT_ENDDE,1,6)
                  		         <isNotEmpty property="SERVC_ENTRPS_CODE">                          
		                         AND S.SERVC_ENTRPS_CODE LIKE #SERVC_ENTRPS_CODE#
		                         </isNotEmpty>
		                      )
		        GROUP BY B.HW_SE, A.MODEL_NO, A.EQPMN_NO, B.MODEL_NM, A.CHCK_MANAGE_IEM, A.CHCK_DETAIL_IEM, CHCK_THRHLD, C.SORT_STDR
		                        , C.IT_CODE,C.IT_CODE_NM	
		        UNION
		        SELECT A.MODEL_NO, A.EQPMN_NO,B.MODEL_NM, A.CHCK_MANAGE_IEM
		               , (SELECT CODE_NM from TBCOM_CMMN_CODE M WHERE M.GRP_CODE = 'ITM004' AND M.CODE = A.CHCK_MANAGE_IEM) CHCK_MANAGE_NAME 
		               , A.CHCK_DETAIL_IEM
		               , '[' || B.SW_JOB_SE || ']' || C.IT_CODE_NM  AS IT_CODE_NM
		               , max(decode(A.CHCK_YM, #CHCK_YM#, A.CHCK_VALUE,'')) as CHCK_THRHLD
		               , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -11),'yyyymm'),A.CHCK_VALUE,'')) as V01  
		               , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -10),'yyyymm'),A.CHCK_VALUE,'')) as V02
		               , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -9 ),'yyyymm'),A.CHCK_VALUE,'')) as V03
		               , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -8 ),'yyyymm'),A.CHCK_VALUE,'')) as V04
		               , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -7 ),'yyyymm'),A.CHCK_VALUE,'')) as V05
		               , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -6 ),'yyyymm'),A.CHCK_VALUE,'')) as V06
		               , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -5 ),'yyyymm'),A.CHCK_VALUE,'')) as V07
		               , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -4 ),'yyyymm'),A.CHCK_VALUE,'')) as V08
		               , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -3 ),'yyyymm'),A.CHCK_VALUE,'')) as V09
		               , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -2 ),'yyyymm'),A.CHCK_VALUE,'')) as V10
		               , max(decode(A.CHCK_YM, to_char(add_months( #CHCK_YM# ||'10', -1 ),'yyyymm'),A.CHCK_VALUE,'')) as V11
		               , max(decode(A.CHCK_YM, #CHCK_YM#, A.CHCK_VALUE, '')) as V12
		               , C.SORT_STDR, C.IT_CODE
		          FROM TBITM_MT_CHCK_MANAGE A, TBITM_SW_REGSTR B, TBITM_IT_CL C 
		         WHERE CHCK_YM between to_char(add_months( #CHCK_YM# ||'10', -11),'yyyymm') and #CHCK_YM#                
		           AND A.MODEL_NO = B.MODEL_NO   
		           AND C.IT_CL = '02'                
                   AND B.SW_JOB_SE = C.IT_CODE   
		           <isNotEmpty property="MODEL_NO">        
		             AND A.MODEL_NO = #MODEL_NO#
		           </isNotEmpty>
		           <isNotEmpty property="EQPMN_NO">        
		             AND A.EQPMN_NO = #EQPMN_NO#
		           </isNotEmpty>
		           <isNotEmpty property="SERVC_ENTRPS_CODE"> 
		           AND B.SERVC_ENTRPS_CODE LIKE #SERVC_ENTRPS_CODE#
		          </isNotEmpty>
		           AND EXISTS(SELECT 1 FROM TBITM_SW_CNTRCT_HIST S
		                       WHERE S.MODEL_NO = A.MODEL_NO
		                         AND #CHCK_YM# BETWEEN SUBSTR(S.CNTRCT_BGNDE,1,6) AND SUBSTR(S.CNTRCT_ENDDE,1,6)
                  		         <isNotEmpty property="SERVC_ENTRPS_CODE">                          
		                         AND S.SERVC_ENTRPS_CODE LIKE #SERVC_ENTRPS_CODE#
		                         </isNotEmpty>
		                      )		                      
		        GROUP BY B.SW_JOB_SE, A.MODEL_NO, A.EQPMN_NO, B.MODEL_NM, A.CHCK_MANAGE_IEM, A.CHCK_DETAIL_IEM, CHCK_THRHLD	
		                        , C.SORT_STDR, C.IT_CODE,C.IT_CODE_NM	                                        
		      ORDER BY SORT_STDR, IT_CODE, MODEL_NO,  EQPMN_NO
    </select>              
    
    <!-- 월정기점검관리 운영현황표 보고서 - 특이사항  조회 -->
    <select id="ITM040200DAO.ITM040200ReportRM" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
			   SELECT A.MODEL_NO, A.EQPMN_NO, C.SORT_STDR, C.IT_CODE,  
			               LISTAGG ( A.CHCK_YM ||  ' : ' || A.RM, CHR(13)||CHR(10)) within group (order by A.MODEL_NO, A.EQPMN_NO) RM
			    FROM TBITM_MT_CHCK_MANAGE A, TBITM_EQPMN_REGSTR B, TBITM_IT_CL C 
			   WHERE A.CHCK_YM between to_char(add_months( #CHCK_YM# ||'10', -11),'yyyymm') and #CHCK_YM#
		   	     AND A.RM IS NOT NULL
			     AND A.MODEL_NO = B.MODEL_NO
			     AND C.IT_CL = '01'                  
                 AND B.HW_SE = C.IT_CODE 
			     <isNotEmpty property="MODEL_NO">        
		             AND A.MODEL_NO = #MODEL_NO#
		         </isNotEmpty>
		         <isNotEmpty property="EQPMN_NO">        
		           AND A.EQPMN_NO = #EQPMN_NO#
		         </isNotEmpty>
			       AND EXISTS(SELECT 1 FROM TBITM_EQPMN_CNTRCT_HIST S
			                   WHERE S.MODEL_NO = A.MODEL_NO
			                     AND S.EQPMN_NO = A.EQPMN_NO
			                     AND #CHCK_YM# BETWEEN SUBSTR(S.CNTRCT_BGNDE,1,6) AND SUBSTR(S.CNTRCT_ENDDE,1,6)
			                     <isNotEmpty property="SERVC_ENTRPS_CODE">                         
			                     AND S.SERVC_ENTRPS_CODE LIKE #SERVC_ENTRPS_CODE#
			                     </isNotEmpty>
			                 )
			        GROUP BY A.MODEL_NO, A.EQPMN_NO, C.SORT_STDR, C.IT_CODE,C.IT_CODE_NM         
			     UNION 			     
			     SELECT A.MODEL_NO, A.EQPMN_NO, C.SORT_STDR, C.IT_CODE, 
			                  LISTAGG ( A.CHCK_YM || ' : ' || A.RM, CHR(13)||CHR(10)) within group (order by A.MODEL_NO, A.EQPMN_NO) RM
			    FROM TBITM_MT_CHCK_MANAGE A, TBITM_SW_REGSTR B, TBITM_IT_CL C 
			   WHERE A.CHCK_YM between to_char(add_months( #CHCK_YM# ||'10', -11),'yyyymm') and #CHCK_YM#
		   	     AND A.RM IS NOT NULL
			     AND A.MODEL_NO = B.MODEL_NO
			     AND C.IT_CL = '02'                
                 AND B.SW_JOB_SE = C.IT_CODE   
			     <isNotEmpty property="MODEL_NO">        
		             AND A.MODEL_NO = #MODEL_NO#
		         </isNotEmpty>
		         <isNotEmpty property="EQPMN_NO">        
		           AND A.EQPMN_NO = #EQPMN_NO#
		         </isNotEmpty>
			       AND EXISTS(SELECT 1 FROM TBITM_SW_CNTRCT_HIST S
			                   WHERE S.MODEL_NO = A.MODEL_NO
			                     AND #CHCK_YM# BETWEEN SUBSTR(S.CNTRCT_BGNDE,1,6) AND SUBSTR(S.CNTRCT_ENDDE,1,6)
			                     <isNotEmpty property="SERVC_ENTRPS_CODE">                         
			                     AND S.SERVC_ENTRPS_CODE LIKE #SERVC_ENTRPS_CODE#
			                     </isNotEmpty>
			                 )     
			       GROUP BY A.MODEL_NO, A.EQPMN_NO, C.SORT_STDR, C.IT_CODE,C.IT_CODE_NM
			       ORDER BY SORT_STDR, IT_CODE, MODEL_NO,  EQPMN_NO                                       		      
    </select>
    
    <!-- 월정기점검관리 운영현황표 보고서 - 타이틀(월)  조회 -->
    <select id="ITM040200DAO.ITM040200ReportMonth" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
             SELECT C.IT_CODE, C.SORT_STDR, A.MODEL_NO, A.EQPMN_NO
                   , to_char(add_months(#CHCK_YM# ||'10', -11),'yyyy-mm') as V01  
                   , to_char(add_months(#CHCK_YM# ||'10', -10),'yyyy-mm') as V02
                   , to_char(add_months(#CHCK_YM# ||'10', -9),'yyyy-mm') as V03
                   , to_char(add_months(#CHCK_YM# ||'10', -8),'yyyy-mm') as V04
                   , to_char(add_months(#CHCK_YM# ||'10', -7),'yyyy-mm') as V05
                   , to_char(add_months(#CHCK_YM# ||'10', -6),'yyyy-mm') as V06
                   , to_char(add_months(#CHCK_YM# ||'10', -5),'yyyy-mm') as V07
                   , to_char(add_months(#CHCK_YM# ||'10', -4),'yyyy-mm') as V08
                   , to_char(add_months(#CHCK_YM# ||'10', -3),'yyyy-mm') as V09
                   , to_char(add_months(#CHCK_YM# ||'10', -2),'yyyy-mm') as V10
                   , to_char(add_months(#CHCK_YM# ||'10', -1),'yyyy-mm') as V11
                   , substr( #CHCK_YM#,1,4 ) || '-' || substr( #CHCK_YM#,5,2 ) as V12
          FROM TBITM_MT_CHCK_MANAGE A, TBITM_EQPMN_REGSTR B, TBITM_IT_CL C
         WHERE A.MODEL_NO = B.MODEL_NO
           AND C.IT_CODE = B.HW_SE      
           <isNotEmpty property="MODEL_NO">
           AND A.MODEL_NO = #MODEL_NO#
           </isNotEmpty>
           <isNotEmpty property="EQPMN_NO">
           AND A.EQPMN_NO = #EQPMN_NO#
           </isNotEmpty>           
           AND EXISTS(SELECT 1 FROM TBITM_EQPMN_CNTRCT_HIST S
                       WHERE S.MODEL_NO = A.MODEL_NO
                         AND S.EQPMN_NO = A.EQPMN_NO
                         AND #CHCK_YM# BETWEEN SUBSTR(S.CNTRCT_BGNDE,1,6) AND SUBSTR(S.CNTRCT_ENDDE,1,6)
                         <isNotEmpty property="SERVC_ENTRPS_CODE">                         
                         AND S.SERVC_ENTRPS_CODE LIKE #SERVC_ENTRPS_CODE#
                         </isNotEmpty>
                      )
         UNION 
         SELECT C.IT_CODE, C.SORT_STDR, A.MODEL_NO, A.EQPMN_NO
                   , to_char(add_months(#CHCK_YM# ||'10', -11),'yyyy-mm') as V01  
                   , to_char(add_months(#CHCK_YM# ||'10', -10),'yyyy-mm') as V02
                   , to_char(add_months(#CHCK_YM# ||'10', -9),'yyyy-mm') as V03
                   , to_char(add_months(#CHCK_YM# ||'10', -8),'yyyy-mm') as V04
                   , to_char(add_months(#CHCK_YM# ||'10', -7),'yyyy-mm') as V05
                   , to_char(add_months(#CHCK_YM# ||'10', -6),'yyyy-mm') as V06
                   , to_char(add_months(#CHCK_YM# ||'10', -5),'yyyy-mm') as V07
                   , to_char(add_months(#CHCK_YM# ||'10', -4),'yyyy-mm') as V08
                   , to_char(add_months(#CHCK_YM# ||'10', -3),'yyyy-mm') as V09
                   , to_char(add_months(#CHCK_YM# ||'10', -2),'yyyy-mm') as V10
                   , to_char(add_months(#CHCK_YM# ||'10', -1),'yyyy-mm') as V11
                   , substr( #CHCK_YM#,1,4 ) || '-' || substr( #CHCK_YM#,5,2 ) as V12
          FROM TBITM_MT_CHCK_MANAGE A, TBITM_SW_REGSTR B, TBITM_IT_CL C
         WHERE A.MODEL_NO = B.MODEL_NO
           AND C.IT_CODE = B.SW_JOB_SE      
           <isNotEmpty property="MODEL_NO">
           AND A.MODEL_NO = #MODEL_NO#
           </isNotEmpty>
           <isNotEmpty property="EQPMN_NO">
           AND A.EQPMN_NO = #EQPMN_NO#
           </isNotEmpty>
	       AND EXISTS(SELECT 1 FROM TBITM_SW_CNTRCT_HIST S
	                   WHERE S.MODEL_NO = A.MODEL_NO
	                     AND #CHCK_YM# BETWEEN SUBSTR(S.CNTRCT_BGNDE,1,6) AND SUBSTR(S.CNTRCT_ENDDE,1,6)
	                     <isNotEmpty property="SERVC_ENTRPS_CODE">                         
	                     AND S.SERVC_ENTRPS_CODE LIKE #SERVC_ENTRPS_CODE#
	                     </isNotEmpty>
	                 ) 
         ORDER BY SORT_STDR, IT_CODE, MODEL_NO, EQPMN_NO
    </select>
         
    <!-- 월점검 관리내역 등록 -->
    <insert id="ITM040200DAO.ITM040200C" parameterClass="java.util.HashMap" >
    	<![CDATA[
			INSERT INTO TBITM_MT_CHCK_MANAGE (
			   CHCK_YM, SN, MODEL_NO, 
			   EQPMN_NO, CHCK_MANAGE_IEM, CHCK_DETAIL_IEM, 
			   CHCK_THRHLD, CHCK_VALUE, CHCK_DCSN_ENNC, 
			   RM, CHCK_ATCH_FILE, REGISTER_ID, 
			   REGIST_DT, UPDUSR_ID, UPDT_DT
			) VALUES ( 
				#CHCK_YM#,
			 	(SELECT NVL(MAX(SN) + 1, 1) FROM TBITM_MT_CHCK_MANAGE WHERE CHCK_YM=#CHCK_YM#),
			 	#MODEL_NO#,
			 	#EQPMN_NO#,
			 	#CHCK_MANAGE_IEM#,
			 	#CHCK_DETAIL_IEM#,
			 	#CHCK_THRHLD#,
			 	#CHCK_VALUE#,
			 	#CHCK_DCSN_ENNC#,
			 	#RM#,
			 	#CHCK_ATCH_FILE#,
			 	#S_USER_ID#,
			 	SYSDATE,
			 	#S_USER_ID#,
			 	SYSDATE
			)
		]]>
    </insert>
    
    <!-- 월점검 관리내역 수정 -->
    <update id="ITM040200DAO.ITM040200U" parameterClass="java.util.HashMap" >
    	<![CDATA[
			UPDATE TBITM_MT_CHCK_MANAGE
			SET    MODEL_NO        = #MODEL_NO#,
			       EQPMN_NO        = #EQPMN_NO#,
			       CHCK_MANAGE_IEM = #CHCK_MANAGE_IEM#,
			       CHCK_DETAIL_IEM = #CHCK_DETAIL_IEM#,
			       CHCK_THRHLD     = #CHCK_THRHLD#,
			       CHCK_VALUE      = #CHCK_VALUE#,
			       CHCK_DCSN_ENNC  = #CHCK_DCSN_ENNC#,
			       RM              = #RM#,
			       CHCK_ATCH_FILE  = #CHCK_ATCH_FILE#,
			       UPDUSR_ID       = #S_USER_ID#,
			       UPDT_DT         = SYSDATE
			WHERE  CHCK_YM         = #CHCK_YM#
			AND    SN              = #SN#
		]]>
    </update>
    
    <!-- 월점검 관리내역 삭제 -->
    <delete id="ITM040200DAO.ITM040200D" parameterClass="java.util.HashMap" >
    	<![CDATA[
		    DELETE TBITM_MT_CHCK_MANAGE		   
			WHERE  CHCK_YM         = #CHCK_YM#
			AND    SN              = #SN#
		]]>
    </delete>
    
    <!-- 월점검 관리내역 전월 자료 복사 -->
	<insert id="ITM040200DAO.ITM040200COPY" parameterClass="java.util.HashMap">
		DECLARE
		BEGIN
			
			DELETE FROM TBITM_MT_CHCK_MANAGE
			 WHERE CHCK_YM  = #CHCK_YM#
			   AND MODEL_NO = #MODEL_NO#
			   AND EQPMN_NO = #EQPMN_NO#
			;
			
			
			INSERT INTO TBITM_MT_CHCK_MANAGE
			   ( CHCK_YM
				,SN
				,MODEL_NO
				,EQPMN_NO
				,CHCK_MANAGE_IEM
				,CHCK_DETAIL_IEM
				,CHCK_THRHLD
				,CHCK_VALUE
				,CHCK_DCSN_ENNC
				,RM
				,CHCK_ATCH_FILE
				,REGISTER_ID
				,REGIST_DT
				,UPDUSR_ID
				,UPDT_DT
			)
			SELECT   #CHCK_YM# AS CHCK_YM
				,SN
				,MODEL_NO
				,EQPMN_NO
				,CHCK_MANAGE_IEM
				,CHCK_DETAIL_IEM
				,CHCK_THRHLD
				,CHCK_VALUE
				,CHCK_DCSN_ENNC
				,RM
				,CHCK_ATCH_FILE
				,REGISTER_ID
				,SYSDATE
				,UPDUSR_ID
				,SYSDATE
			 FROM TBITM_MT_CHCK_MANAGE
			WHERE CHCK_YM = TO_CHAR( ADD_MONTHS( to_date(#CHCK_YM#||'01'), -1), 'YYYYMM')
			  AND MODEL_NO = #MODEL_NO#
			  AND EQPMN_NO = #EQPMN_NO#
			   ;
		   	
		END;
	</insert>
	
<!-- 	
	 쿼리명 : 첨부파일 등록
	설명 : 공종코드 수정 쿼리
	수정일  수정자  수정내용
	
	작성자 : 김선진
	최초작성일 : 2015.11.17 
-->	
<update id="ITM040200DAO.listU" parameterClass="java.util.Map">
UPDATE TBITM_MT_CHCK_MANAGE
   SET FILE_SN = #FILE_SN# 
     , FILE_ORDR = #FILE_ORDR#
     , UPDUSR_ID       = #S_USER_ID#
     , UPDT_DT         = SYSDATE
 WHERE CHCK_YM = #CHCK_YM#
   and SN = #SN#
   and MODEL_NO = #MODEL_NO#
</update>

<!-- 	
	 쿼리명 : 첨부파일 삭제
	설명 : 공종코드 수정 쿼리
	수정일  수정자  수정내용
	
	작성자 : 김선진
	최초작성일 : 2015.11.17 
-->	
<update id="ITM040200DAO.ITM040200DFILE" parameterClass="java.util.HashMap" >
<![CDATA[
begin

	delete from TBCOM_CMMN_ATCHMNFL_MASTR
	 where file_sn = #FILE_SN#;
	 
	delete from TBCOM_CMMN_ATCHMNFL
	 where file_sn = #FILE_SN#
	   and file_ordr = #FILE_ORDR#;

	UPDATE TBITM_MT_CHCK_MANAGE
	   SET FILE_SN = NULL
	     , FILE_ORDR = NULL
	     , CHCK_ATCH_FILE = NULL
	     , UPDUSR_ID       = #S_USER_ID#
	     , UPDT_DT         = SYSDATE
	 WHERE CHCK_YM = #CHCK_YM#
	   and SN = #SN#
	   and MODEL_NO = #MODEL_NO#;
   
end;
]]>
</update>


<!-- 	
	 쿼리명 : HW 비고란 등록
	설명 : 공종코드 수정 쿼리
	수정일  수정자  수정내용
	
	작성자 : 김선진
	최초작성일 : 2015.11.17 
-->	
<update id="ITM040200DAO.hwRmU" parameterClass="java.util.Map">
UPDATE TBITM_EQPMN_LIST
   SET RM = #RM#
     , UPDUSR_ID       = #S_USER_ID#
     , UPDT_DT         = SYSDATE
 WHERE EQPMN_NO = #EQPMN_NO#
   and MODEL_NO = #CODE#
</update>


<!-- 	
	 쿼리명 : SW 비고란 등록
	설명 : 공종코드 수정 쿼리
	수정일  수정자  수정내용
	
	작성자 : 김선진
	최초작성일 : 2015.11.17 
-->	
<update id="ITM040200DAO.swRmU" parameterClass="java.util.Map">
UPDATE TBITM_SW_REGSTR
   SET CHCK_RM = #RM#
     , UPDUSR_ID       = #S_USER_ID#
     , UPDT_DT         = SYSDATE
 WHERE MODEL_NO = #CODE#
</update>
</sqlMap>