<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="RNT030305">

	<!-- 쿼리명 : 계약자 조회
	설명 : 계약자 조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.07.03 
	-->
	<select id="RNT030305DAO.getList1" parameterClass="java.util.Map" resultClass="java.util.HashMap">
 SELECT
      TLC.CNTRCTR_NO
    , TLC.CNTRCT_CO
    , TLC.RE_CNTRCT_CO
    , TLC.AREA_SE
    , TLC.DONG
    , TLC.HO
    , TLC.LFSTS_CSTMR_NO
    , TLC.FRST_CNTRCT_DE
    , TLC.CNTRCT_CO
    , TLC.QUALF_SE
    , TLC.FAMILY_CO
    , TLC.ZIP_DM
    , TLC.ADRES_DM
    , TLC.ADRES_DETAIL_DM
    , TLC.HOUSE_POSESN_AT
    , TLC.LAD_POSESN_AT
    , TLC.BILD_POSESN_AT
    , TLC.CAR_POSESN_AT
    , TLC.BEFORE_ADRES
    , TLC.SCRT_INFO_EXAMIN_ID
    , TLC.RM
    , TLHC.ELCTRN_SANCTN_NO
    , TLHC.RNTCHRG + TLHC.RSVMNEY AS SUM
    , TLC.REGISTER_ID
    , TLC.REGIST_DT
    , TLC.UPDUSR_ID
    , TLC.UPDT_DT
    , TLHC.DCSN_DE
    , TLHC.CNTRCT_DE
    , TLHC.TRNSFRN_DE
    , TLHC.CDIT_PRESV_MTHD
    , TLHC.CNTRCTR_CO
    , TLHC.HOUSE_KND
    , TLHC.ZIP AS ZIP_HOUSE
    , TLHC.ADRES AS ADRES_HOUSE
    , TLHC.ADRES_DETAIL AS ADRES_DETAIL_HOUSE
    , TLHC.HEAT_SE
    , TLHC.FLOOR_SE
    , TLHC.AR
    , TLHC.ALL_ROOM_CO
    , TLHC.RENT_ROOM_CO
    , TLHC.SPORT_BGNDE
    , TLHC.SPORT_ENDDE
    , TLHC.LFSTS_AMOUNT
    , TLHC.SPORT_AMOUNT
    , TLHC.RENT_ALOTM
    , TLHC.ADIT_ALOTM
    , TLHC.RNTCHRG
    , TLHC.RSVMNEY
    , TLHC.BILDNG_STRCT
    , TLHC.RE_CNTRCT_SE
    , TLRC.NM
    , SFCOM_DEC_ALL(TLRC.IHIDNUM) AS IHIDNUM 
    , TLRC.ZIP
    , TLRC.ADRES
    , TLRC.ADRES_DETAIL
    , TLRC.TELNO
    , TLRC.MBTLNO
    , TLRT.RESCI_TRMNAT_DE
    , TLC.FILE_SN
    , TLHC.PC_DECSN_MTH
    , TLHC.HOUSE_POTVALE
    , TLHC.RCOGN_RATE
    , TLHC.HOUSE_PC
    , TLHC.DEBT_RATE
    , TLHC.HOUSE_STDPC
    , TLHC.FDLTR_ESTBS_AMOUNT
    , TLHC.RLDB_ESTBS_AMOUNT
    , TLHC.LEGACY_RENT_AMOUNT
    , TLHC.LFSTS_CONFM_AMOUNT
    , TLHC.EVL_DE   
	, TLHC.LEGACY_RENT_CNT
	, TLHC.VACANT_ROOM_CO
	, TLHC.FDLTR_ESTBS_CNT         
    , Z.NM AS NM_PSN
    , (SELECT (CASE WHEN COUNT(*) >= '1' THEN '1' ELSE '0' END)
         FROM TBRNT_LFSTS_SEIZR TLS 
     	WHERE TLC.CNTRCTR_NO = TLS.APPLCNT_CNTRCTR_NO
     	  AND TLS.RELIS_DE IS NULL) AS LOAN_POSESN_AT        
 FROM TBRNT_LFSTS_CNTRCT TLC  
 JOIN TBRNT_LFSTS_CSTMR TLRC ON TLC.LFSTS_CSTMR_NO = TLRC.LFSTS_CSTMR_NO
 JOIN TBRNT_LFSTS_HOUSE_CNTRCTR TLHC ON TLC.CNTRCTR_NO = TLHC.CNTRCTR_NO AND TLC.CNTRCT_CO = TLHC.CNTRCTR_CO
 <isEqual property="CNTRCT_GB" compareValue="%" >
 LEFT JOIN TBRNT_LFSTS_RESCI_TRMNAT TLRT ON TLC.CNTRCTR_NO = TLRT.CNTRCTR_NO AND TLC.CNTRCT_CO = TLRT.CNTRCTR_CO
 </isEqual>
 <isEqual property="CNTRCT_GB" compareValue="1" >
 LEFT JOIN TBRNT_LFSTS_RESCI_TRMNAT TLRT ON TLC.CNTRCTR_NO = TLRT.CNTRCTR_NO AND TLC.CNTRCT_CO = TLRT.CNTRCTR_CO
 </isEqual> 
 <isEqual property="CNTRCT_GB" compareValue="2">
 JOIN TBRNT_LFSTS_RESCI_TRMNAT TLRT ON TLC.CNTRCTR_NO = TLRT.CNTRCTR_NO AND TLC.CNTRCT_CO = TLRT.CNTRCTR_CO
 </isEqual> 
 LEFT JOIN TBRNT_LFSTS_RENT_PSN TLRP ON TLC.CNTRCTR_NO = TLRP.CNTRCTR_NO AND TLC.CNTRCT_CO = TLRP.CNTRCTR_CO 
 LEFT JOIN TBRNT_LFSTS_CSTMR Z ON TLRP.LFSTS_CSTMR_NO = Z.LFSTS_CSTMR_NO
WHERE 1=1    
    AND TLRP.RNTAGNT_NO =
                       (SELECT   NVL (MAX (RNTAGNT_NO), 1)
                          FROM   TBRNT_LFSTS_RENT_PSN
                         WHERE   CNTRCTR_NO = TLC.CNTRCTR_NO
                                 AND CNTRCTR_CO = TLC.CNTRCT_CO)     
 <isNotEmpty property="AREA_SE">
	 AND TLC.AREA_SE = #AREA_SE#
 </isNotEmpty>
 <isNotEmpty property="NM">
 	AND TLRC.NM LIKE #NM#||'%'
 </isNotEmpty>
 <isNotEmpty property="OWNER">
 	AND Z.NM LIKE #OWNER#||'%'
 </isNotEmpty>
  <isNotEmpty property="DONG">
 	AND TLC.DONG LIKE  '%' || #DONG# || '%'
 </isNotEmpty>	
  <isNotEmpty property="HO">
 	AND TLC.HO LIKE  '%' || #HO# || '%'
 </isNotEmpty>	
 <isNotEmpty property="ADRES">
 	AND TLRC.ADRES LIKE '%'||#ADRES#||'%'
 </isNotEmpty>	
 <isNotEmpty property="CSTMR_NO">
 	AND TLC.LFSTS_CSTMR_NO = #CSTMR_NO#
 </isNotEmpty> 
 <isEqual property="CNTRCT_GB" compareValue="1">
 	AND NOT EXISTS (SELECT 1 
 	                  FROM TBRNT_LFSTS_RESCI_TRMNAT A 
 	                 WHERE A.CNTRCTR_NO = TLC.CNTRCTR_NO 
 	                   AND A.CNTRCTR_CO = TLC.CNTRCT_CO)
  </isEqual>
	ORDER BY TLC.AREA_SE , TLC.CNTRCTR_NO , TLHC.CNTRCTR_CO  
 
</select>

<!-- 	
	</update>
	 쿼리명 : 계약자 수정
	설명 : 재계약자 수정 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.07.03 
	-->	
	
<update id="RNT030305DAO.list1U" parameterClass="java.util.Map">
BEGIN
	UPDATE TBRNT_LFSTS_CSTMR
	SET
		  NM                   = #NM#
		, IHIDNUM               = SFCOM_ENC_ALL(REPLACE(#IHIDNUM#, '-', ''))
		, ZIP                  = #ZIP#
		, ADRES                = #ADRES#
		, ADRES_DETAIL         = #ADRES_DETAIL#
		, TELNO                = #TELNO#
		, MBTLNO               = #MBTLNO#
		, UPDUSR_ID            = #S_USER_ID#
		, UPDT_DT              = SYSDATE
	WHERE LFSTS_CSTMR_NO = #LFSTS_CSTMR_NO#	
		;	
	UPDATE TBRNT_LFSTS_CNTRCT
	   SET
			  QUALF_SE	= #QUALF_SE# 
			, CNTRCT_CO = #CNTRCT_CO#  
			, RE_CNTRCT_CO = #RE_CNTRCT_CO#
			, FAMILY_CO	= #FAMILY_CO# 
			, ZIP_DM	= #ZIP_DM# 
			, ADRES_DM	= #ADRES_DM# 
			, ADRES_DETAIL_DM	= #ADRES_DETAIL_DM# 
			, HOUSE_POSESN_AT	= #HOUSE_POSESN_AT# 
			, LAD_POSESN_AT	= #LAD_POSESN_AT# 
			, BILD_POSESN_AT	= #BILD_POSESN_AT# 
			, CAR_POSESN_AT	= #CAR_POSESN_AT# 
			, BEFORE_ADRES	= #BEFORE_ADRES# 
			, SCRT_INFO_EXAMIN_ID	= #SCRT_INFO_EXAMIN_ID# 
			, RM	= #RM# 
			, UPDUSR_ID	= #UPDUSR_ID# 
			, UPDT_DT	= SYSDATE 
			, AREA_SE	= #AREA_SE# 
			, DONG	= #DONG# 
			, HO	= #HO#  
	WHERE CNTRCTR_NO = #CNTRCTR_NO#
	;
	UPDATE TBRNT_LFSTS_HOUSE_CNTRCTR
		SET
			  HOUSE_KND	=	#HOUSE_KND#
			, ZIP	=	#ZIP_HOUSE#
			, ADRES	=	#ADRES_HOUSE#
			, ADRES_DETAIL	=	#ADRES_DETAIL_HOUSE#
			, HEAT_SE	=	#HEAT_SE#
			, FLOOR_SE	=	#FLOOR_SE#
			, AR	=	#AR#
			, ALL_ROOM_CO	=	#ALL_ROOM_CO#
			, RENT_ROOM_CO	=	#RENT_ROOM_CO#
			, SPORT_BGNDE	=	#SPORT_BGNDE#
			, SPORT_ENDDE	=	#SPORT_ENDDE#
			, DCSN_DE		=	#DCSN_DE#
			, CNTRCT_DE		=	#CNTRCT_DE#
			, TRNSFRN_DE	=	#TRNSFRN_DE#						
			, LFSTS_AMOUNT	=	#LFSTS_AMOUNT#
			, SPORT_AMOUNT	=	#SPORT_AMOUNT#
			, RENT_ALOTM	=	#RENT_ALOTM#
			, ADIT_ALOTM	=	#ADIT_ALOTM#
			, RNTCHRG	=	#RNTCHRG#
			, RSVMNEY	=	#RSVMNEY#
			, BILDNG_STRCT = #BILDNG_STRCT#
			, UPDUSR_ID	=	#S_USER_ID#
			, UPDT_DT	=	SYSDATE
			, CDIT_PRESV_MTHD	= #CDIT_PRESV_MTHD# 
		    , PC_DECSN_MTH         = #PC_DECSN_MTH#
		    , HOUSE_POTVALE        = #HOUSE_POTVALE#
		    , HOUSE_PC             = #HOUSE_PC#
		    , HOUSE_STDPC          = #HOUSE_STDPC#
		    , FDLTR_ESTBS_AMOUNT   = #FDLTR_ESTBS_AMOUNT#
		    , RLDB_ESTBS_AMOUNT    = #RLDB_ESTBS_AMOUNT#
		    , LEGACY_RENT_AMOUNT   = #LEGACY_RENT_AMOUNT#
		    , LFSTS_CONFM_AMOUNT   = #LFSTS_CONFM_AMOUNT#
		    , RCOGN_RATE           = #RCOGN_RATE#
		    , DEBT_RATE		       = #DEBT_RATE#
			, EVL_DE			   = #EVL_DE#
			, LEGACY_RENT_CNT      = #LEGACY_RENT_CNT#
			, VACANT_ROOM_CO       = #VACANT_ROOM_CO#
			, FDLTR_ESTBS_CNT	   = #FDLTR_ESTBS_CNT#	
	WHERE CNTRCTR_NO = #CNTRCTR_NO#	
	 AND  CNTRCTR_CO = #CNTRCT_CO#
	;			
END;		
	</update>
	

	<!-- 쿼리명 : 계약자 삭제
	설명 : 계약자 삭제 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.07.03 
	-->	
	<delete id="RNT030305DAO.list1D" parameterClass="java.util.Map">
	 BEGIN
	     <!-- 
       	 DELETE TBRNT_LFSTS_CSTMR
		  WHERE LFSTS_CSTMR_NO = (SELECT LFSTS_CSTMR_NO 
							      FROM TBRNT_LFSTS_FAMILY_MATTER 
							     WHERE APPLCNT_CNTRCTR_NO = #CNTRCTR_NO# )
	  	 ;
       	 DELETE TBRNT_LFSTS_CSTMR
		  WHERE LFSTS_CSTMR_NO = (SELECT LFSTS_CSTMR_NO 
							      FROM TBRNT_LFSTS_COCNR 
							     WHERE CNTRCTR_NO = #CNTRCTR_NO# )
	  	 ;	
       	 DELETE TBRNT_LFSTS_CSTMR
		  WHERE LFSTS_CSTMR_NO = (SELECT LFSTS_CSTMR_NO_AFTCH 
							      FROM TBRNT_LFSTS_RENT_PSN_CHANGE 
							     WHERE CNTRCTR_NO = #CNTRCTR_NO# )
	  	 ;		  	  
	  	  -->
         DELETE TBRNT_LFSTS_COCNR
		  WHERE CNTRCTR_NO	=	#CNTRCTR_NO#
		    AND CNTRCTR_CO = #CNTRCT_CO#
	     ;
		 DELETE TBRNT_LFSTS_RENT_PSN_CHANGE
		   WHERE CNTRCTR_NO = #CNTRCTR_NO#
		     AND CNTRCTR_CO = #CNTRCT_CO#
	      ;	     	  	  	 
		 DELETE TBRNT_LFSTS_RENT_PSN
		   WHERE CNTRCTR_NO = #CNTRCTR_NO#
		     AND CNTRCTR_CO = #CNTRCT_CO#
	      ;
		 DELETE TBRNT_LFSTS_INSRNC
		  WHERE CNTRCTR_NO = #CNTRCTR_NO#
		    AND CNTRCTR_CO = #CNTRCT_CO#
	      ;
		  DELETE TBRNT_LFSTS_MDIATN_JCFFR
			WHERE CNTRCTR_NO = #CNTRCTR_NO#
			  AND CNTRCTR_CO = #CNTRCT_CO#
		  ;
       	  DELETE TBRNT_LFSTS_HOUSE_CNTRCTR
		     WHERE CNTRCTR_NO = #CNTRCTR_NO#
		       AND CNTRCTR_CO = #CNTRCT_CO#
		  ;    	
		  DELETE TBRNT_LFSTS_CNTRCT
		   WHERE CNTRCTR_NO = #CNTRCTR_NO#
		     AND CNTRCT_CO = #CNTRCT_CO#
  		  ;	 
   	 END;	  
	</delete>

	<!-- 쿼리명 : 임대인 조회
	설명 : 임대인 조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.15 
	-->
	<select id="RNT030305DAO.getListR1" parameterClass="java.util.Map" resultClass="java.util.HashMap">
       SELECT
          ROW_NUMBER() OVER(ORDER BY TRPC.SN DESC) AS ROW_NUM 
        , TRP.CNTRCTR_NO
        , TRP.CNTRCTR_CO
        , TRP.RNTAGNT_NO
        , TRP.ACQS_DE
        , TRP.BANK_CODE
        , TRP.ACNUTNO
        , TRP.DPSTR
        , TRP.REGISTER_ID
        , TRP.REGIST_DT
        , TRP.UPDUSR_ID
        , TRP.UPDT_DT
        , TRPC.CHANGE_DE
        , TRPC.CHGHY
        , TRPC.RM
        , TRPC.SN
        , TRPC.LFSTS_CSTMR_NO_BFCHG
        , TRPC.LFSTS_CSTMR_NO_AFTCH        
        , TLRC.NM
        , SFCOM_DEC_ALL(TLRC.IHIDNUM) AS IHIDNUM 
        , TLRC.TELNO
        , TLRC.MBTLNO
        , TLRC.ZIP
        , TLRC.ADRES
        , TLRC.ADRES_DETAIL
        , TRP.LFSTS_CSTMR_NO
      FROM TBRNT_LFSTS_RENT_PSN TRP
         , TBRNT_LFSTS_RENT_PSN_CHANGE TRPC
         , TBRNT_LFSTS_CSTMR TLRC
     WHERE TRP.CNTRCTR_NO = TRPC.CNTRCTR_NO(+)
       AND TRP.CNTRCTR_CO = TRPC.CNTRCTR_CO(+)    
       AND TRP.RNTAGNT_NO = TRPC.RNTAGNT_NO(+)
       AND TRP.LFSTS_CSTMR_NO = TLRC.LFSTS_CSTMR_NO
       AND TRP.CNTRCTR_NO = #CNTRCTR_NO#
       AND TRP.CNTRCTR_CO = #CNTRCTR_CO#
       ORDER BY ROW_NUM DESC
	</select>
	<!-- 쿼리명 : 임대인 수정
	설명 : 임대인 수정 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29 
	-->
	<update id="RNT030305DAO.listUR1" parameterClass="java.util.Map">
	BEGIN

	 UPDATE TBRNT_LFSTS_CSTMR
		SET
			  NM                   = #NM#
			, IHIDNUM               = SFCOM_ENC_ALL(REPLACE(#IHIDNUM#, '-', ''))
			, ZIP                  = #ZIP#
			, ADRES                = #ADRES#
			, ADRES_DETAIL         = #ADRES_DETAIL#
			, TELNO                = #TELNO#
			, MBTLNO               = #MBTLNO#
			, UPDUSR_ID            = #S_USER_ID#
			, UPDT_DT              = SYSDATE
		WHERE LFSTS_CSTMR_NO = #LFSTS_CSTMR_NO#	
		;		
		UPDATE TBRNT_LFSTS_RENT_PSN
		   SET		
			  ACQS_DE			=	#ACQS_DE#
			, BANK_CODE			=	#BANK_CODE#
			, ACNUTNO			=	#ACNUTNO#
			, DPSTR				=	#DPSTR#
			, UPDUSR_ID			=	#S_USER_ID#
			, UPDT_DT			=	SYSDATE
		WHERE CNTRCTR_NO = #CNTRCTR_NO#
		  AND CNTRCTR_CO = #CNTRCTR_CO#
		  AND RNTAGNT_NO = #RNTAGNT_NO#
		 ;	
		UPDATE TBRNT_LFSTS_RENT_PSN_CHANGE
		   SET		
			  CHANGE_DE			=	#CHANGE_DE#
			, CHGHY				=	#CHGHY#
			, RM				=	#RM#
			, UPDUSR_ID			=	#S_USER_ID#
			, UPDT_DT			=	SYSDATE
		WHERE CNTRCTR_NO = #CNTRCTR_NO#
		  AND CNTRCTR_CO = #CNTRCTR_CO#
		  AND RNTAGNT_NO = #RNTAGNT_NO#
		  AND SN 		 = #SN#
		 ;			 
	END; 
	</update>
	<!-- 쿼리명 : 임대인 신규
	설명 : 임대인 신규 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29 
	-->
	<insert id="RNT030305DAO.listCR1" parameterClass="java.util.Map">
	BEGIN
 		INSERT INTO TBRNT_LFSTS_CSTMR(
			  LFSTS_CSTMR_NO
			, NM
			, IHIDNUM
			, ZIP
			, ADRES
			, ADRES_DETAIL
			, TELNO
			, MBTLNO
			, REGISTER_ID
			, REGIST_DT
			, UPDUSR_ID
			, UPDT_DT
		 )VALUES(		    
		      (SELECT NVL(MAX(LFSTS_CSTMR_NO),0)+1 FROM TBRNT_LFSTS_CSTMR)
		    , #NM#
		    , SFCOM_ENC_ALL(REPLACE(#IHIDNUM#, '-', ''))
		    , #ZIP#
		    , #ADRES#
		    , #ADRES_DETAIL#
		    , #TELNO#
		    , #MBTLNO#
		    , #S_USER_ID#
		    , SYSDATE
		    , #S_USER_ID#
		    , SYSDATE
		 )
		 ;	
		INSERT INTO TBRNT_LFSTS_RENT_PSN
		(
			  CNTRCTR_NO
			, CNTRCTR_CO
			, RNTAGNT_NO
			, ACQS_DE
			, BANK_CODE
			, ACNUTNO
			, DPSTR
			, REGISTER_ID
			, REGIST_DT
			, UPDUSR_ID
			, UPDT_DT		
			, LFSTS_CSTMR_NO			
			)VALUES(
			  #CNTRCTR_NO#
			, #CNTRCTR_CO#
			, (SELECT NVL(MAX(RNTAGNT_NO)  , 0) + 1 
			     FROM TBRNT_LFSTS_RENT_PSN
			    WHERE CNTRCTR_NO = #CNTRCTR_NO#
			      AND CNTRCTR_CO = #CNTRCTR_CO#)
			, #ACQS_DE#
			, #BANK_CODE#
			, #ACNUTNO#
			, #DPSTR#
			, #S_USER_ID#
			, SYSDATE
			, #S_USER_ID#
			, SYSDATE		
			, (SELECT MAX(LFSTS_CSTMR_NO) FROM TBRNT_LFSTS_CSTMR)
		)
		;
	INSERT INTO TBRNT_LFSTS_RENT_PSN_CHANGE
		(
			  CNTRCTR_NO
			, CNTRCTR_CO
            , RNTAGNT_NO
			, SN
			, CHANGE_DE
			, CHGHY
			, RM
			, REGISTER_ID
			, REGIST_DT
			, UPDUSR_ID
			, UPDT_DT
			, LFSTS_CSTMR_NO_AFTCH
			, LFSTS_CSTMR_NO_BFCHG				
			)VALUES(
			  #CNTRCTR_NO#
			, #CNTRCTR_CO#
			, (SELECT NVL(MAX(RNTAGNT_NO) , 0) 
			     FROM TBRNT_LFSTS_RENT_PSN
			    WHERE CNTRCTR_NO = #CNTRCTR_NO#
			      AND CNTRCTR_CO = #CNTRCTR_CO#)			
			,NVL((SELECT NVL(MAX(SN),0)+1 
			     FROM TBRNT_LFSTS_RENT_PSN_CHANGE 
			    WHERE CNTRCTR_NO = #CNTRCTR_NO#
			      AND CNTRCTR_CO = #CNTRCTR_CO#) , 0)
			, #CHANGE_DE#
			, #CHGHY#
			, #RM#
			, #S_USER_ID#
			, SYSDATE
			, #S_USER_ID#
			, SYSDATE	
			, (SELECT MAX(LFSTS_CSTMR_NO) FROM TBRNT_LFSTS_CSTMR)
			, #LFSTS_CSTMR_NO#		
		)		
		; 
END;
	</insert>
	<!-- 쿼리명 : 임대인 삭제
	설명 : 임대인 삭제 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29 
	-->	
	<delete id="RNT030305DAO.listDR1" parameterClass="java.util.Map">
	BEGIN

		UPDATE TBRNT_LFSTS_RENT_PSN
		   SET
			 LFSTS_CSTMR_NO	= #LFSTS_CSTMR_NO_BFCHG# 
		WHERE CNTRCTR_NO = #CNTRCTR_NO#
		;
		DELETE TBRNT_LFSTS_CSTMR
		 WHERE LFSTS_CSTMR_NO = (SELECT LFSTS_CSTMR_NO 
		                           FROM TBRNT_LFSTS_RENT_PSN_CHANGE
								  WHERE CNTRCTR_NO	=	#CNTRCTR_NO#
								    AND CNTRCTR_CO  =   #CNTRCTR_CO#
								    AND RNTAGNT_NO = #RNTAGNT_NO#) 
		;		
	END;	   
	</delete>


	<!-- 쿼리명 : 공유자 조회
	설명 : 공유자 조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.07.03 
	-->
	<select id="RNT030305DAO.getListR2" parameterClass="java.util.Map" resultClass="java.util.HashMap">
     SELECT
          ROW_NUMBER() OVER(ORDER BY TC.CNTRCTR_NO) AS ROW_NUM 
        , TC.CNTRCTR_NO
        , TC.SN
        , TC.LFSTS_CSTMR_NO_RENT_PSN
        , TC.RELIS_DE
        , TC.RM
        , TC.REGISTER_ID
        , TC.REGIST_DT
        , TC.UPDUSR_ID
        , TC.UPDT_DT
        , TRP.ACQS_DE
        , TLRC.NM
        , SFCOM_DEC_ALL(TLRC.IHIDNUM) AS IHIDNUM
        , TLRC.TELNO
        , TLRC.MBTLNO
        , TLRC.ZIP
        , TLRC.ADRES
        , TLRC.ADRES_DETAIL
        , TRP.NM_PH
        , SFCOM_DEC_ALL(TRP.IHIDNUM_PH) AS IHIDNUM_PH 
        , TRP.TELNO_PH
        , TRP.MBTLNO_PH
      FROM TBRNT_LFSTS_COCNR TC
         , TBRNT_LFSTS_CSTMR TLRC
         , (SELECT B.NM AS NM_PH
                 , B.IHIDNUM AS IHIDNUM_PH
                 , B.TELNO AS TELNO_PH
                 , B.MBTLNO AS MBTLNO_PH
                 , A.LFSTS_CSTMR_NO
                 , A.CNTRCTR_NO
                 , A.ACQS_DE
              FROM TBRNT_LFSTS_RENT_PSN A
                 , TBRNT_LFSTS_CSTMR B
             WHERE A.LFSTS_CSTMR_NO = B.LFSTS_CSTMR_NO
               AND A.CNTRCTR_NO = #CNTRCTR_NO#
               AND A.CNTRCTR_CO = #CNTRCTR_CO#) TRP     
     WHERE TC.LFSTS_CSTMR_NO = TLRC.LFSTS_CSTMR_NO
       AND TC.CNTRCTR_NO = TRP.CNTRCTR_NO
       AND TC.LFSTS_CSTMR_NO_RENT_PSN = TRP.LFSTS_CSTMR_NO 
       
       ORDER BY TC.CNTRCTR_NO
	</select>
	<!-- 쿼리명 : 공유자 수정
	설명 : 공유자 수정 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.07.03 
	-->
	<update id="RNT030305DAO.listUR2" parameterClass="java.util.Map">
BEGIN
	UPDATE TBRNT_LFSTS_CSTMR
	SET
		  NM                   = #NM#
		, IHIDNUM               = SFCOM_ENC_ALL(REPLACE(#IHIDNUM#, '-', ''))
		, ZIP                  = #ZIP#
		, ADRES                = #ADRES#
		, ADRES_DETAIL         = #ADRES_DETAIL#
		, TELNO                = #TELNO#
		, MBTLNO               = #MBTLNO#
		, UPDUSR_ID            = #S_USER_ID#
		, UPDT_DT              = SYSDATE
	WHERE LFSTS_CSTMR_NO = #LFSTS_CSTMR_NO#	
		;	
	UPDATE TBRNT_LFSTS_COCNR
	   SET
		  RELIS_DE		=	#RELIS_DE#
		, RM			=	#RM#
		, UPDUSR_ID		=	#S_USER_ID#
		, UPDT_DT		=	#UPDT_DT#
	WHERE CNTRCTR_NO	=	#CNTRCTR_NO#
	  AND LFSTS_CSTMR_NO_RENT_PSN = #LFSTS_CSTMR_NO_RENT_PSN#
	  AND SN	=	#SN#	
	  ;
END;	  	
	</update>
	<!-- 쿼리명 : 공유자 신규
	설명 : 공유자 신규 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.07.03 
	-->

	<insert id="RNT030305DAO.listCR2" parameterClass="java.util.Map">
BEGIN
 		INSERT INTO TBRNT_LFSTS_CSTMR(
			  LFSTS_CSTMR_NO
			, NM
			, IHIDNUM
			, ZIP
			, ADRES
			, ADRES_DETAIL
			, TELNO
			, MBTLNO
			, REGISTER_ID
			, REGIST_DT
			, UPDUSR_ID
			, UPDT_DT
		 )VALUES(		    
		      (SELECT NVL(MAX(LFSTS_CSTMR_NO),0)+1 FROM TBRNT_LFSTS_CSTMR)
		    , #NM#
		    , SFCOM_ENC_ALL(REPLACE(#IHIDNUM#, '-', ''))
		    , #ZIP#
		    , #ADRES#
		    , #ADRES_DETAIL#
		    , #TELNO#
		    , #MBTLNO#
		    , #S_USER_ID#
		    , SYSDATE
		    , #S_USER_ID#
		    , SYSDATE
		 )
		 ;
		INSERT INTO TBRNT_LFSTS_COCNR(
			  CNTRCTR_NO
		    , CNTRCTR_CO
			, SN
			, RELIS_DE
			, RM
			, REGISTER_ID
			, REGIST_DT
			, UPDUSR_ID
			, UPDT_DT		
			, LFSTS_CSTMR_NO
			, LFSTS_CSTMR_NO_RENT_PSN	
			)VALUES(
			  #CNTRCTR_NO#
            , #CNTRCTR_CO#			  
			, (SELECT NVL(MAX(SN),0)+1 FROM TBRNT_LFSTS_COCNR)
			, #RELIS_DE#
			, #RM#
			, #S_USER_ID#
			, SYSDATE
			, #S_USER_ID#
			, SYSDATE		
			, (SELECT MAX(LFSTS_CSTMR_NO) FROM TBRNT_LFSTS_CSTMR)	
			, (SELECT MAX(LFSTS_CSTMR_NO) 
			     FROM TBRNT_LFSTS_RENT_PSN 
			    WHERE CNTRCTR_NO = #CNTRCTR_NO#
			      AND CNTRCTR_CO = #CNTRCTR_CO#)
		)
		;
END;		
	</insert>
	<!-- 쿼리명 : 공유자 삭제
	설명 : 공유자 삭제 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.07.03 
	-->	
	<delete id="RNT030305DAO.listDR2" parameterClass="java.util.Map">
BEGIN
		DELETE TBRNT_LFSTS_CSTMR
		WHERE LFSTS_CSTMR_NO	=	#LFSTS_CSTMR_NO#
		;
		DELETE TBRNT_COCNR
		WHERE CNTRCTR_NO	=	#CNTRCTR_NO#
		  AND SN	=	#SN#
		;
END;		  
	</delete>
<!-- 쿼리명 : 보증보험 조회
	설명 : 보증보험  조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.07.03 
-->
<select id="RNT030305DAO.getListR3" parameterClass="java.util.Map" resultClass="java.util.HashMap">
	   SELECT
	          ROW_NUMBER() OVER(ORDER BY CNTRCTR_NO) AS ROW_NUM 
			, INSRNC_SE
			, CNTRCTR_NO
			, CNTRCTR_CO
			, CNTRCT_BGNDE
			, CNTRCT_ENDDE
			, SCRITS_NO
			, ENDRS_NO
			, MANAGE_NO
			, PC_DECSN_MTH
			, PC_DECSN_DE
			, ESTATE_DECSN_PC
			, MRTGG_RATE
			, INSRNC_AMOUNT
			, EXCCLC_AMOUNT
			, RM
			, REGISTER_ID
			, REGIST_DT
			, UPDUSR_ID
			, UPDT_DT
	  FROM TBRNT_LFSTS_INSRNC
	 WHERE INSRNC_SE = '1'
	    AND CNTRCTR_NO = #CNTRCTR_NO#
	    AND CNTRCTR_CO = #CNTRCTR_CO#   
	    ORDER BY CNTRCTR_NO
	</select>
	<!-- 쿼리명 : 보증보험  수정
	설명 : 보증보험  수정 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.07.03 
	-->
	<update id="RNT030305DAO.listUR3" parameterClass="java.util.Map">
		UPDATE TBRNT_LFSTS_INSRNC
		   SET
			 INSRNC_SE	=	#INSRNC_SE#
			,CNTRCT_BGNDE	=	#CNTRCT_BGNDE#
			,CNTRCT_ENDDE	=	#CNTRCT_ENDDE#
			,SCRITS_NO	=	#SCRITS_NO#
			,ENDRS_NO	=	#ENDRS_NO#
			,MANAGE_NO	=	#MANAGE_NO#
			,PC_DECSN_MTH	=	#PC_DECSN_MTH#
			,PC_DECSN_DE	=	#PC_DECSN_DE#
			,ESTATE_DECSN_PC	=	#ESTATE_DECSN_PC#
			,MRTGG_RATE	=	#MRTGG_RATE#
			,INSRNC_AMOUNT	=	#INSRNC_AMOUNT#
			,EXCCLC_AMOUNT	=	#EXCCLC_AMOUNT#
			,RM	=	#RM#
			,REGISTER_ID	=	#S_USER_ID#
			,REGIST_DT	=	SYSDATE
			,UPDUSR_ID	=	#S_USER_ID#
			,UPDT_DT	=	SYSDATE
		WHERE INSRNC_SE = '1'
		  AND CNTRCTR_NO = #CNTRCTR_NO#
		  AND CNTRCTR_CO = #CNTRCTR_CO#
	</update>
	<!-- 쿼리명 : 보증보험  신규
	설명 : 보증보험  신규 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.07.03
	-->
	<insert id="RNT030305DAO.listCR3" parameterClass="java.util.Map">
		INSERT INTO TBRNT_LFSTS_INSRNC
		(
				  INSRNC_SE
				, CNTRCTR_NO
				, CNTRCTR_CO
				, CNTRCT_BGNDE
				, CNTRCT_ENDDE
				, SCRITS_NO
				, ENDRS_NO
				, MANAGE_NO
				, PC_DECSN_MTH
				, PC_DECSN_DE
				, ESTATE_DECSN_PC
				, MRTGG_RATE
				, INSRNC_AMOUNT
				, EXCCLC_AMOUNT
				, RM
				, REGISTER_ID
				, REGIST_DT
				, UPDUSR_ID
				, UPDT_DT			
				)
				VALUES
				(
				  '1'
				, #CNTRCTR_NO#
				, #CNTRCTR_CO#
				, #CNTRCT_BGNDE#
				, #CNTRCT_ENDDE#
				, #SCRITS_NO#
				, #ENDRS_NO#
				, #MANAGE_NO#
				, #PC_DECSN_MTH#
				, #PC_DECSN_DE#
				, #ESTATE_DECSN_PC#
				, #MRTGG_RATE#
				, #INSRNC_AMOUNT#
				, #EXCCLC_AMOUNT#
				, #RM#
				, #S_USER_ID#
				, SYSDATE
				, #S_USER_ID#
				, SYSDATE
		)
	</insert>
	<!-- 쿼리명 : 보증보험  삭제
	설명 : 보증보험  삭제 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.07.03
	-->	
	<delete id="RNT030305DAO.listDR3" parameterClass="java.util.Map">
		DELETE TBRNT_LFSTS_INSRNC
		WHERE INSRNC_SE = '1'
		  AND CNTRCTR_NO = #CNTRCTR_NO#
		  AND CNTRCTR_CO = #CNTRCTR_CO# 
	</delete>


	<!-- 쿼리명 : 화재보험 조회
	설명 : 화재보험 조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.07.03 
	-->
	<select id="RNT030305DAO.getListR4" parameterClass="java.util.Map" resultClass="java.util.HashMap">
	   SELECT
	          ROW_NUMBER() OVER(ORDER BY CNTRCTR_NO) AS ROW_NUM 
			, INSRNC_SE
			, CNTRCTR_NO
			, CNTRCTR_CO
			, CNTRCT_BGNDE
			, CNTRCT_ENDDE
			, SCRITS_NO
			, ENDRS_NO
			, MANAGE_NO
			, PC_DECSN_MTH
			, PC_DECSN_DE
			, ESTATE_DECSN_PC
			, MRTGG_RATE
			, INSRNC_AMOUNT
			, EXCCLC_AMOUNT
			, RM
			, REGISTER_ID
			, REGIST_DT
			, UPDUSR_ID
			, UPDT_DT
	  FROM TBRNT_LFSTS_INSRNC
	 WHERE INSRNC_SE = '2'
	   AND CNTRCTR_NO = #CNTRCTR_NO#
	   AND CNTRCTR_CO = #CNTRCTR_CO#
	   
	  ORDER BY CNTRCTR_NO  
	</select>
	<!-- 쿼리명 : 화재보험 수정
	설명 : 화재보험 수정 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.07.03
	-->
	<update id="RNT030305DAO.listUR4" parameterClass="java.util.Map">
		UPDATE TBRNT_LFSTS_INSRNC
		   SET
			 INSRNC_SE	=	#INSRNC_SE#
			,CNTRCT_BGNDE	=	#CNTRCT_BGNDE#
			,CNTRCT_ENDDE	=	#CNTRCT_ENDDE#
			,SCRITS_NO	=	#SCRITS_NO#
			,ENDRS_NO	=	#ENDRS_NO#
			,MANAGE_NO	=	#MANAGE_NO#
			,PC_DECSN_MTH	=	#PC_DECSN_MTH#
			,PC_DECSN_DE	=	#PC_DECSN_DE#
			,ESTATE_DECSN_PC	=	#ESTATE_DECSN_PC#
			,MRTGG_RATE	=	#MRTGG_RATE#
			,INSRNC_AMOUNT	=	#INSRNC_AMOUNT#
			,EXCCLC_AMOUNT	=	#EXCCLC_AMOUNT#
			,RM	=	#RM#
			,REGISTER_ID	=	#S_USER_ID#
			,REGIST_DT	=	SYSDATE
			,UPDUSR_ID	=	#S_USER_ID#
			,UPDT_DT	=	SYSDATE
		WHERE INSRNC_SE = '2'
		  AND CNTRCTR_NO = #CNTRCTR_NO#
		  AND CNTRCTR_CO = #CNTRCTR_CO#
			
	</update>
	<!-- 쿼리명 : 화재보험 신규
	설명 : 화재보험 신규 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.07.03
	-->
	<insert id="RNT030305DAO.listCR4" parameterClass="java.util.Map">
		INSERT INTO TBRNT_LFSTS_INSRNC
		(
				  INSRNC_SE
				, CNTRCTR_NO
				, CNTRCTR_CO
				, CNTRCT_BGNDE
				, CNTRCT_ENDDE
				, SCRITS_NO
				, ENDRS_NO
				, MANAGE_NO
				, PC_DECSN_MTH
				, PC_DECSN_DE
				, ESTATE_DECSN_PC
				, MRTGG_RATE
				, INSRNC_AMOUNT
				, EXCCLC_AMOUNT
				, RM
				, REGISTER_ID
				, REGIST_DT
				, UPDUSR_ID
				, UPDT_DT			
				)
				VALUES
				(
				  '2'
				, #CNTRCTR_NO#
				, #CNTRCTR_CO#
				, #CNTRCT_BGNDE#
				, #CNTRCT_ENDDE#
				, #SCRITS_NO#
				, #ENDRS_NO#
				, #MANAGE_NO#
				, #PC_DECSN_MTH#
				, #PC_DECSN_DE#
				, #ESTATE_DECSN_PC#
				, #MRTGG_RATE#
				, #INSRNC_AMOUNT#
				, #EXCCLC_AMOUNT#
				, #RM#
				, #S_USER_ID#
				, SYSDATE
				, #S_USER_ID#
				, SYSDATE
		)
	</insert>
	<!-- 쿼리명 : 화재보험 삭제
	설명 : 화재보험 삭제 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.07.03
	-->	
	<delete id="RNT030305DAO.listDR4" parameterClass="java.util.Map">
		DELETE TBRNT_LFSTS_INSRNC
		WHERE INSRNC_SE = '2'
		  AND CNTRCTR_NO = #CNTRCTR_NO#
		  AND CNTRCTR_CO = #CNTRCTR_CO#
	</delete>

	<!-- 쿼리명 : 법무사 조회
	설명 : 법무사 조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.07.03
	-->
	<select id="RNT030305DAO.getListR5" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		  SELECT 
		          ROW_NUMBER() OVER(ORDER BY TE.CNTRCTR_NO) AS ROW_NUM
			    , TE.CNTRCTR_NO
			    , TE.CNTRCTR_CO
			    , TEC.MDIATN_JCFFR_SE
			    , TEC.MDIATN_JCFFR_CODE
			    , TE.FEE
			    , TE.PYMNT_DE
			    , TE.DPSTR
			    , TE.RM
			    , TE.REGISTER_ID
			    , TE.REGIST_DT
			    , TE.UPDUSR_ID
			    , TE.UPDT_DT
			    , TEC.AREA_SE
			    , TEC.MTLTY
			    , TEC.BIZRNO
			    , TEC.RPRSNTV
			    , TEC.ZIP
			    , TEC.ADRES
			    , TEC.ADRES_DETAIL
			    , TEC.TELNO_1
			    , TEC.TELNO_2
			    , TEC.CNTRCT_AMOUNT
			    , TEC.DPSTR
			    , TEC.BANK_CODE
			    , TEC.ACNUTNO
		 FROM TBRNT_LFSTS_MDIATN_JCFFR_INFO TEC
		    , TBRNT_LFSTS_MDIATN_JCFFR TE     
		WHERE TEC.MDIATN_JCFFR_CODE = TE.MDIATN_JCFFR_CODE
	 	  AND TEC.MDIATN_JCFFR_SE = TE.MDIATN_JCFFR_SE
		  AND TE.CNTRCTR_NO = #CNTRCTR_NO# 
		   AND TEC.MDIATN_JCFFR_SE = '001'	
		   AND TE.CNTRCTR_CO = #CNTRCTR_CO#	  
		  
		  ORDER BY TE.CNTRCTR_NO
	</select>


<!-- 쿼리명 : 법무사 수정
설명 : 법무사 수정 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.07.03
-->
<update id="RNT030305DAO.listUR5" parameterClass="java.util.Map">
BEGIN
	UPDATE TBRNT_LFSTS_MDIATN_JCFFR_INFO
	   SET  MTLTY = #MTLTY#
	      , BIZRNO = #BIZRNO#
	      , RPRSNTV = #RPRSNTV#
	      , ZIP = #ZIP#
	      , ADRES = #ADRES#
	      , ADRES_DETAIL = #ADRES_DETAIL#
	      , TELNO_1 = #TELNO_1#
	      , TELNO_2 = #TELNO_2#
	      , BANK_CODE = #BANK_CODE#
	      , ACNUTNO = #ACNUTNO#
	      , AREA_SE = #AREA_SE#
	      , RM = #RM#
	WHERE MDIATN_JCFFR_SE = '001'
	  AND MDIATN_JCFFR_CODE = #MDIATN_JCFFR_CODE#
	  ;	

	UPDATE TBRNT_LFSTS_MDIATN_JCFFR
	   SET
			 FEE	=	#FEE#
			,PYMNT_DE	=	#PYMNT_DE#
			,BANK_CODE	=	#BANK_CODE#
			,ACNUTNO	=	#ACNUTNO#
			,DPSTR	=	#DPSTR#
			,RM	=	#RM#
			,UPDUSR_ID	=	#S_USER_ID#
			,UPDT_DT	=	SYSDATE
			,MDIATN_JCFFR_CODE = #MDIATN_JCFFR_CODE#
	WHERE MDIATN_JCFFR_SE = '001'
	  AND CNTRCTR_NO = #CNTRCTR_NO#
	  AND CNTRCTR_CO = #CNTRCTR_CO#
	  ;
END;	  
</update>

<!-- 쿼리명 : 법무사 신규
설명 : 법무사 신규 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.07.03
-->
<insert id="RNT030305DAO.listCR5" parameterClass="java.util.Map">
		INSERT INTO TBRNT_LFSTS_MDIATN_JCFFR
		(
				  CNTRCTR_NO
				, MDIATN_JCFFR_SE
				, MDIATN_JCFFR_CODE
				, FEE
				, PYMNT_DE
				, BANK_CODE
				, ACNUTNO
				, DPSTR
				, RM
				, REGISTER_ID
				, REGIST_DT
				, UPDUSR_ID
				, UPDT_DT	
				, CNTRCTR_CO			
				)
				VALUES
				(
				  #CNTRCTR_NO#
				, '001'
				, #MDIATN_JCFFR_CODE#
				, #FEE#
				, #PYMNT_DE#
				, #BANK_CODE#
				, #ACNUTNO#
				, #DPSTR#
				, #RM#
				, #S_USER_ID#
				, SYSDATE
				, #S_USER_ID#
				, SYSDATE	
				, #CNTRCTR_CO#			
		)
</insert>

<!-- 쿼리명 : 법무사 삭제
설명 : 법무사 삭제 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.07.03
-->	
<delete id="RNT030305DAO.listDR5" parameterClass="java.util.Map">
		DELETE TBRNT_LFSTS_MDIATN_JCFFR
		WHERE MDIATN_JCFFR_SE = '001'
		  AND CNTRCTR_NO = #CNTRCTR_NO#
		  AND CNTRCTR_CO = #CNTRCTR_CO#
		  AND MDIATN_JCFFR_CODE = #MDIATN_JCFFR_CODE#
</delete>
	<!-- 쿼리명 : 부동산 조회
	설명 : 부동산 조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.07.03
	-->
	<select id="RNT030305DAO.getListR6" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		  SELECT 
		          TE.CNTRCTR_NO
			    , TE.CNTRCTR_CO			    
			    , TEC.MDIATN_JCFFR_SE
			    , TEC.MDIATN_JCFFR_CODE
			    , TE.FEE
                , (CASE WHEN TEC.TAXT_SE = 1 THEN TE.FEE ELSE TE.FEE * 1.0 END) AS AMT1 
                , (CASE WHEN TEC.TAXT_SE = 1 THEN TE.FEE * 0.1 ELSE 0  END) AS AMT2                
			    , TE.PYMNT_DE
			    , TE.DPSTR
			    , TE.RM
			    , TE.REGISTER_ID
			    , TE.REGIST_DT
			    , TE.UPDUSR_ID
			    , TE.UPDT_DT
			    , TEC.MTLTY
			    , TEC.BIZRNO
			    , TEC.RPRSNTV
			    , TEC.ZIP
			    , TEC.ADRES
			    , TEC.ADRES_DETAIL
			    , TEC.TELNO_1
			    , TEC.TELNO_2
			    , TEC.CNTRCT_AMOUNT
			    , TEC.DPSTR
			    , TEC.BANK_CODE
			    , TEC.ACNUTNO
			    , TEC.TAXT_SE
		 FROM TBRNT_LFSTS_MDIATN_JCFFR_INFO TEC
		    , TBRNT_LFSTS_MDIATN_JCFFR TE       
		WHERE TEC.MDIATN_JCFFR_CODE = TE.MDIATN_JCFFR_CODE
		  AND TEC.MDIATN_JCFFR_SE = TE.MDIATN_JCFFR_SE
		   AND TE.CNTRCTR_NO = TO_CHAR(#CNTRCTR_NO#) 
		   AND TEC.MDIATN_JCFFR_SE = '002'
		   AND TE.CNTRCTR_CO = #CNTRCTR_CO#
		  ORDER BY TE.CNTRCTR_NO   
	</select>

<!-- 쿼리명 : 부동산 수정
설명 : 부동산 수정 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.07.03
-->
<update id="RNT030305DAO.listUR6" parameterClass="java.util.Map">
BEGIN
	UPDATE TBRNT_LFSTS_MDIATN_JCFFR_INFO
	   SET  MTLTY = #MTLTY#
	      , BIZRNO = #BIZRNO#
	      , RPRSNTV = #RPRSNTV#
	      , ZIP = #ZIP#
	      , ADRES = #ADRES#
	      , ADRES_DETAIL = #ADRES_DETAIL#
	      , TELNO_1 = #TELNO_1#
	      , TELNO_2 = #TELNO_2#
	      , BANK_CODE = #BANK_CODE#
	      , ACNUTNO = #ACNUTNO#
	      , AREA_SE = #AREA_SE#
	      , RM = #RM#
	      , TAXT_SE = #TAXT_SE#	      
	WHERE MDIATN_JCFFR_SE = '002'
	  AND MDIATN_JCFFR_CODE = #MDIATN_JCFFR_CODE#	  
	  ;			
	
	UPDATE TBRNT_LFSTS_MDIATN_JCFFR
	   SET
			 FEE	=	#FEE#
			,PYMNT_DE	=	#PYMNT_DE#
			,BANK_CODE	=	#BANK_CODE#
			,ACNUTNO	=	#ACNUTNO#
			,DPSTR	=	#DPSTR#
			,RM	=	#RM#
			,UPDUSR_ID	=	#S_USER_ID#
			,UPDT_DT	=	SYSDATE
			,MDIATN_JCFFR_CODE = #MDIATN_JCFFR_CODE#
	WHERE MDIATN_JCFFR_SE = '002'
	  AND CNTRCTR_NO = #CNTRCTR_NO#
	  AND CNTRCTR_CO = #CNTRCTR_CO#
	  ;
END;	  
</update>

<!-- 쿼리명 : 부동산 신규
설명 : 부동산 신규 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.07.03
-->
<insert id="RNT030305DAO.listCR6" parameterClass="java.util.Map">
		INSERT INTO TBRNT_LFSTS_MDIATN_JCFFR
		(
				  CNTRCTR_NO
				, MDIATN_JCFFR_SE
				, MDIATN_JCFFR_CODE
				, FEE
				, PYMNT_DE
				, BANK_CODE
				, ACNUTNO
				, DPSTR
				, RM
				, REGISTER_ID
				, REGIST_DT
				, UPDUSR_ID
				, UPDT_DT		
				, CNTRCTR_CO		
				)
				VALUES
				(
				  #CNTRCTR_NO#
				, '002'
				, #MDIATN_JCFFR_CODE#
			    , (SELECT MAX(BGMS)
			         FROM TBRNT_LFSTS_MDIATN_FEE
			        WHERE #LFSTS_AMOUNT# >= LFSTS_AMOUNT)
				, #PYMNT_DE#
				, #BANK_CODE#
				, #ACNUTNO#
				, #DPSTR#
				, #RM#
				, #S_USER_ID#
				, SYSDATE
				, #S_USER_ID#
				, SYSDATE		
				, #CNTRCTR_CO#		
		)
</insert>

<!-- 쿼리명 : 부동산 삭제
설명 : 부동산 삭제 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.07.03
-->	
<delete id="RNT030305DAO.listDR6" parameterClass="java.util.Map">
		DELETE TBRNT_LFSTS_MDIATN_JCFFR
		WHERE MDIATN_JCFFR_SE = '002'
		  AND CNTRCTR_NO = #CNTRCTR_NO#
		  AND CNTRCTR_CO = #CNTRCTR_CO#
		  AND MDIATN_JCFFR_CODE = #MDIATN_JCFFR_CODE#
</delete>


	<!-- 쿼리명 : 세대원 조회
	설명 : 세대원 조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.07.03
	-->
	<select id="RNT030305DAO.getListR7" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		SELECT
              ROW_NUMBER() OVER(ORDER BY TFM.SN) AS ROW_NUM
		    , TFM.APPLCNT_CNTRCTR_SE
		    , TFM.APPLCNT_CNTRCTR_NO
		    , TFM.SN
		    , SFCOM_DEC_ALL(TLRC.IHIDNUM) AS IHIDNUM  
		    , TLRC.NM
		    , TFM.FAMILY_RELATE
		    , TLRC.TELNO
		    , TLRC.MBTLNO
		    , TFM.SCRT_INFO_EXAMIN_ID
		    , TFM.RM
		    , TFM.REGISTER_ID
		    , TFM.REGIST_DT
		    , TFM.UPDUSR_ID
		    , TFM.UPDT_DT
		    , TLRC.LFSTS_CSTMR_NO
		 FROM TBRNT_LFSTS_FAMILY_MATTER TFM
		    , TBRNT_LFSTS_CSTMR TLRC
		WHERE TFM.LFSTS_CSTMR_NO = TLRC.LFSTS_CSTMR_NO		
		  AND APPLCNT_CNTRCTR_NO = #APPLCNT_CNTRCTR_NO#	
		  AND APPLCNT_CNTRCTR_SE = #APPLCNT_CNTRCTR_SE#	
		ORDER BY APPLCNT_CNTRCTR_NO
	</select>
	
<!-- 쿼리명 : 세대원 신규
설명 : 세대원 신규 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.07.03
-->
<insert id="RNT030305DAO.listCR7" parameterClass="java.util.Map">	
BEGIN	
 		INSERT INTO TBRNT_LFSTS_CSTMR(
			  LFSTS_CSTMR_NO
			, NM
			, IHIDNUM
			, ZIP
			, ADRES
			, ADRES_DETAIL
			, TELNO
			, MBTLNO
			, REGISTER_ID
			, REGIST_DT
		    , UPDUSR_ID
		    , UPDT_DT	
		 )VALUES(		    
		      (SELECT NVL(MAX(LFSTS_CSTMR_NO),0)+1 FROM TBRNT_LFSTS_CSTMR)
		    , #NM#
		    , SFCOM_ENC_ALL(REPLACE(#IHIDNUM#, '-', '')) 
		    , #ZIP#
		    , #ADRES#
		    , #ADRES_DETAIL#
		    , #TELNO#
		    , #MBTLNO#
		    , #S_USER_ID#
		    , SYSDATE
		    , #S_USER_ID#
		    , SYSDATE    
		 )
		 ;
		 INSERT INTO TBRNT_LFSTS_FAMILY_MATTER(
		      APPLCNT_CNTRCTR_SE
		    , APPLCNT_CNTRCTR_NO
		    , SN
		    , FAMILY_RELATE
		    , SCRT_INFO_EXAMIN_ID
		    , RM
		    , REGISTER_ID
		    , REGIST_DT
		    , UPDUSR_ID
		    , UPDT_DT
			, LFSTS_CSTMR_NO	    
		 )VALUES(
		      '002'
		    , #APPLCNT_CNTRCTR_NO#
		    , (SELECT NVL(MAX(SN),0)+1 FROM TBRNT_LFSTS_FAMILY_MATTER)
		    , #FAMILY_RELATE#
		    , #SCRT_INFO_EXAMIN_ID#
		    , #RM#
		    , #S_USER_ID#
		    , SYSDATE	
		    , #S_USER_ID#
		    , SYSDATE	
			, (SELECT MAX(LFSTS_CSTMR_NO) FROM TBRNT_LFSTS_CSTMR)    
		    )
		 ;
END;	 	
</insert>

<!-- 쿼리명 : 세대원 수정
설명 : 세대원 수정 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.07.03
-->
<update id="RNT030305DAO.listUR7" parameterClass="java.util.Map">
 BEGIN
		 UPDATE TBRNT_LFSTS_FAMILY_MATTER
		 SET
		   FAMILY_RELATE       =   #FAMILY_RELATE#
		 , SCRT_INFO_EXAMIN_ID =   #SCRT_INFO_EXAMIN_ID#
		  ,RM                  =   #RM#
		 , UPDUSR_ID           =   #S_USER_ID#
		 , UPDT_DT             =  SYSDATE
		WHERE APPLCNT_CNTRCTR_NO = #APPLCNT_CNTRCTR_NO#
		  AND APPLCNT_CNTRCTR_SE = #APPLCNT_CNTRCTR_SE#
		  AND SN = #SN#
		  ;
	UPDATE TBRNT_LFSTS_CSTMR
	SET
		  NM                   = #NM#
		, IHIDNUM               = SFCOM_ENC_ALL(REPLACE(#IHIDNUM#, '-', '')) 
		, ZIP                  = #ZIP#
		, ADRES                = #ADRES#
		, ADRES_DETAIL         = #ADRES_DETAIL#
		, TELNO                = #TELNO#
		, MBTLNO               = #MBTLNO#
		, UPDUSR_ID            = #S_USER_ID#
		, UPDT_DT              = SYSDATE
	WHERE LFSTS_CSTMR_NO = #LFSTS_CSTMR_NO#	
		;		  
END;
</update>		
<!-- 쿼리명 : 세대원 삭제
설명 : 세대원 삭제 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.07.03
-->	
<delete id="RNT030305DAO.listDR7" parameterClass="java.util.Map">
  BEGIN
    DELETE TBRNT_LFSTS_FAMILY_MATTER
     WHERE APPLCNT_CNTRCTR_NO = #APPLCNT_CNTRCTR_NO#
       AND SN = #SN#
    ;
    DELETE TBRNT_LFSTS_CSTMR
   	WHERE 1=1
   	  AND LFSTS_CSTMR_NO = #LFSTS_CSTMR_NO#
   	;
   END;  
</delete>
	<!-- 쿼리명 : 지원내역 조회
	설명 : 지원내역 조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.07.03
	-->
<select id="RNT030305DAO.getListR8" parameterClass="java.util.Map" resultClass="java.util.HashMap">
SELECT
      TLHC.CNTRCTR_NO
    , TLHC.CNTRCTR_CO
    , TLHC.LFSTS_AMOUNT
    , TLHC.SPORT_AMOUNT
    , TLHC.RENT_ALOTM
    , TLHC.ADIT_ALOTM
    , TLHC.RNTCHRG
    , TLHC.RSVMNEY
    , TLHC.CDIT_PRESV_MTHD
    , TLHC.RM
    , TLHC.REGISTER_ID
    , TLHC.REGIST_DT
    , TLHC.UPDUSR_ID
    , TLHC.UPDT_DT
    , TLHC.HOUSE_KND
    , TLHC.ZIP
    , TLHC.ADRES
    , TLHC.ADRES_DETAIL
    , ADRES || ADRES_DETAIL AS TOTAL_ADRES
    , TLHC.HEAT_SE
    , TLHC.FLOOR_SE
    , TLHC.AR
    , TLHC.ALL_ROOM_CO
    , TLHC.RENT_ROOM_CO
    , TLHC.PC_DECSN_MTH
    , TLHC.HOUSE_POTVALE
    , TLHC.RCOGN_RATE
    , TLHC.HOUSE_PC
    , TLHC.DEBT_RATE
    , TLHC.HOUSE_STDPC
    , TLHC.FDLTR_ESTBS_AMOUNT
    , TLHC.RLDB_ESTBS_AMOUNT
    , TLHC.LEGACY_RENT_AMOUNT
    , TLHC.LFSTS_CONFM_AMOUNT
    , TLHC.EVL_DE
    , TLHC.DCSN_DE
    , TLHC.CNTRCT_DE
    , TLHC.SPORT_BGNDE
    , TLHC.SPORT_ENDDE
    , TLHC.TRNSFRN_DE
    , TLRT.RESCI_TRMNAT_DE
    , TLRT.RESCI_TRMNAT_RESN
FROM TBRNT_LFSTS_HOUSE_CNTRCTR TLHC
   , TBRNT_LFSTS_RESCI_TRMNAT TLRT
WHERE TLHC.CNTRCTR_NO = TLRT.CNTRCTR_NO(+) 
  AND TLHC.CNTRCTR_CO = TLRT.CNTRCTR_CO(+)
  AND TLHC.CNTRCTR_NO = #CNTRCTR_NO#

ORDER BY TLHC.CNTRCT_DE DESC
</select>

<!-- 쿼리명 : 지원금반환 조회
	설명 : 지원반환금 조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.07.03
-->
<select id="RNT030305DAO.getListR10" parameterClass="java.util.Map" resultClass="java.util.HashMap">
SELECT 
        SUM(SPORT_RETURN_AMOUNT) AS SPORT_RETURN_AMOUNT
 FROM TBRNT_LFSTS_SPRMNY_RETURN TSD
WHERE CNTRCTR_NO = #CNTRCTR_NO#
   AND CNTRCTR_CO = #CNTRCTR_CO#
   AND RETURN_DE IS NOT NULL
ORDER BY CNTRCTR_NO
	</select>

<!-- 쿼리명 : 권리분석  조회
	설명 : 분리분석 조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.07.03 
-->
<select id="RNT030305DAO.getList3" parameterClass="java.util.Map" resultClass="java.util.HashMap">
        SELECT
              ROW_NUMBER() OVER(ORDER BY TRA.APPLCNT_CNTRCTR_NO) AS ROW_NUM
            , TRA.APPLCNT_CNTRCTR_SE
            , TRA.APPLCNT_CNTRCTR_NO
            , TRA.SN
            , TRA.RCEPT_DE
            , TRA.MDIATN_JCFFR_SE
            , TRA.MDIATN_JCFFR_CODE
            , TRA.MDIATN_JCFFR_CODE2
            , TRA.ZIP
            , TRA.ADRES
            , TRA.ADRES_DETAIL
            , TRA.ADRES || TRA.ADRES_DETAIL AS TOTAL_ADRES
            , TRA.OWNER
            , TRA.AR
            , TRA.PC_DECSN_MTH
            , TRA.HOUSE_POTVALE
            , TRA.HOUSE_STDPC
            , TRA.RCOGN_RATE
            , TRA.HOUSE_PC
            , TRA.DEBT_RATE
            , TRA.FDLTR_ESTBS_AMOUNT
            , TRA.RLDB_ESTBS_AMOUNT
            , TRA.LEGACY_RENT_AMOUNT
            , TRA.LFSTS_CONFM_AMOUNT
            , TRA.CDIT_PRESV_MTHD
            , TRA.CONFM_AT
            , TRA.ANALS_RESULT
            , TRA.RM
            , TRA.CNTRCT_AT
            , TRA.HOUSE_KND
            , TRA.HEAT_SE
            , TRA.FLOOR_SE
            , TRA.AR
            , TRA.ALL_ROOM_CO
            , TRA.RENT_ROOM
            , TRA.BILDNG_STRCT
            , TEC.MTLTY
            , TEC.RPRSNTV
            , TEC.TELNO_1
            , TEC.ZIP      
            , TRA.LEGACY_RENT_CNT
            , TRA.VACANT_ROOM_CO
            , TRA.FDLTR_ESTBS_CNT               
         FROM TBRNT_LFSTS_RIGHT_ANALS TRA  
            , TBRNT_LFSTS_MDIATN_JCFFR_INFO TEC
        WHERE TRA.MDIATN_JCFFR_CODE = TEC.MDIATN_JCFFR_CODE
          AND TRA.APPLCNT_CNTRCTR_NO = #APPLCNT_CNTRCTR_NO#
          AND TRA.APPLCNT_CNTRCTR_SE = '002'
          AND TRA.CONFM_AT = '1'
          AND (TRA.CNTRCT_AT IS NULL OR  TRA.CNTRCT_AT = 0)
          ORDER BY APPLCNT_CNTRCTR_NO
</select>

<!-- 쿼리명 : 지원정보 신규
설명 : 지원정보 신규 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.07.03
-->
<insert id="RNT030305DAO.listC3" parameterClass="java.util.Map">	
BEGIN
	INSERT INTO TBRNT_LFSTS_HOUSE_CNTRCTR(
	          LFSTS_AMOUNT
	        , SPORT_AMOUNT
	        , RENT_ALOTM
	        , ADIT_ALOTM
	        , RNTCHRG
	        , RSVMNEY
	        , CDIT_PRESV_MTHD
	        , RM
	        , REGISTER_ID
	        , REGIST_DT
	        , UPDUSR_ID
	        , UPDT_DT
	        , CNTRCTR_NO
	        , CNTRCTR_CO
	        , HOUSE_KND
	        , ZIP
	        , ADRES
	        , ADRES_DETAIL
	        , HEAT_SE
	        , FLOOR_SE
	        , AR
	        , ALL_ROOM_CO
	        , RENT_ROOM_CO
	        , PC_DECSN_MTH
	        , HOUSE_POTVALE
	        , RCOGN_RATE
	        , HOUSE_PC
	        , DEBT_RATE
	        , HOUSE_STDPC
	        , FDLTR_ESTBS_AMOUNT
	        , RLDB_ESTBS_AMOUNT
	        , LEGACY_RENT_AMOUNT
	        , LFSTS_CONFM_AMOUNT
	        , EVL_DE
	        , DCSN_DE
	        , CNTRCT_DE
	        , SPORT_BGNDE
	        , SPORT_ENDDE
	        , TRNSFRN_DE
	        , BILDNG_STRCT
	        , RE_CNTRCT_SE
			, LEGACY_RENT_CNT
			, VACANT_ROOM_CO
			, FDLTR_ESTBS_CNT	        
	        )VALUES(
	          #LFSTS_AMOUNT#
	        , #SPORT_AMOUNT#
	        , #RENT_ALOTM#
	        , #ADIT_ALOTM#
	        , #RNTCHRG#
	        , #RSVMNEY#
	        , #CDIT_PRESV_MTHD#
	        , #RM#
	        , #S_USER_ID#
	        , SYSDATE
	        , #S_USER_ID#
	        , SYSDATE
	        , #CNTRCTR_NO#
	        , #CNTRCTR_CO#
	        , #HOUSE_KND#
	        , #ZIP#
	        , #ADRES#
	        , #ADRES_DETAIL#
	        , #HEAT_SE#
	        , #FLOOR_SE#
	        , #AR#
	        , #ALL_ROOM_CO#
	        , #RENT_ROOM_CO#
	        , #PC_DECSN_MTH#
	        , #HOUSE_POTVALE#
	        , #RCOGN_RATE#
	        , #HOUSE_PC#
	        , #DEBT_RATE#
	        , #HOUSE_STDPC#
	        , #FDLTR_ESTBS_AMOUNT#
	        , #RLDB_ESTBS_AMOUNT#
	        , #LEGACY_RENT_AMOUNT#
	        , #LFSTS_CONFM_AMOUNT#
	        , #EVL_DE#
	        , #DCSN_DE#
	        , #CNTRCT_DE#
	        , #SPORT_BGNDE#
	        , #SPORT_ENDDE#
	        , #TRNSFRN_DE#  
			, #BILDNG_STRCT#     
			, #RE_CNTRCT_SE#
			, #LEGACY_RENT_CNT#
			, #VACANT_ROOM_CO#
			, #FDLTR_ESTBS_CNT#			
	)
	;
	UPDATE TBRNT_LFSTS_RIGHT_ANALS
	   SET CNTRCT_AT = '1'
	 WHERE APPLCNT_CNTRCTR_NO = #CNTRCTR_NO#
	   AND APPLCNT_CNTRCTR_SE = '002'
	   AND SN = #SN#
	   ;
END;	
</insert>

	
</sqlMap>