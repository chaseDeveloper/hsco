<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="SLS090202_SQL">	
	<typeAlias alias="egovMap"          type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
   
   <!-- 토지납부 조회  -->
	<select id="SLS090202DAO.selectLadPayList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">

			SELECT distinct A.CNTRCTR_NO
			      ,'0' AS CHK
			      ,E.LAD_CODE
			      ,E.LAD_NM
			      ,(SELECT BB.CSTMR_NM
			          FROM TBSLS_LAD_CSTMR BB
			         WHERE BB.LAD_CSTMR_NO = B.LAD_CSTMR_NO) AS LAD_CSTMR_NM
			      ,(SELECT BB.IHIDNUM
			          FROM TBSLS_LAD_CSTMR BB
			         WHERE BB.LAD_CSTMR_NO = B.LAD_CSTMR_NO) AS CSTMR_IHIDNUM
			      ,(SELECT BB.ADRES || ' ' || BB.ADRES_DETAIL
			          FROM TBSLS_LAD_CSTMR BB
			         WHERE BB.LAD_CSTMR_NO = B.LAD_CSTMR_NO) AS ADRES_FULL
			       
			      ,(SELECT BB.EMAIL
			          FROM TBSLS_LAD_CSTMR BB
			         WHERE BB.LAD_CSTMR_NO = B.LAD_CSTMR_NO) AS EMAIL
			      ,B.LAD_CODE
			      ,B.BLCK
			      ,B.LOT
			      ,B.LOT_TY
			      ,B.BLCK || '-' || B.LOT || '-' || B.LOT_TY AS BLT /* BLT     */
			      ,B.CNTRCT_DE
			       
			      ,A.PBLICTE_YEAR
			      ,A.PBLICTE_QU
			      /*
			      ,A.PAY_CODE
			      ,A.PAYAMT AS PAYAMT
			      ,A.SUPLY_AMOUNT AS PAY_SUPLY_AMOUNT
			      ,A.VAT AS PAY_VAT
			      ,A.UPDUSR_ID
			      ,A.UPDT_DT
			      */
			      ,C.CANCL_DE
			      ,D.BIZRNO
			      ,(SELECT BB.IHIDNUM
			          FROM TBSLS_LAD_CSTMR BB
			         WHERE BB.LAD_CSTMR_NO = D.LAD_CSTMR_NO) AS OWNER_IHIDNUM
			      ,D.MTLTY_NM
			      ,(SELECT BB.ADRES || ' ' || BB.ADRES_DETAIL
			          FROM TBSLS_LAD_CSTMR BB
			         WHERE BB.LAD_CSTMR_NO = D.LAD_CSTMR_NO) AS BSNM_ADRES
			      ,(SELECT BB.CSTMR_NM
			          FROM TBSLS_LAD_CSTMR BB
			         WHERE BB.LAD_CSTMR_NO = D.LAD_CSTMR_NO) AS OWNER_NM
			      ,D.BIZCND
			      ,D.INDUTY
			      ,F.LAD_SE
			
			  FROM TBSLS_LAD_VAT         A /* 토지부가세 */
			      ,TBSLS_LCNTRCTR        B /* 토지계약자 */
			      ,TBSLS_LCNTRCTR_CANCL  C /* 토지계약자해약 */
			      ,TBSLS_LCNTRCTR_BSNM   D /* 토지계약자사업자 */
			      ,TBSLS_LAD_INFO        E /* 토지정보 */
			      ,TBSLS_LAD_DETAIL_INFO F /* 토지정보상세   */
			
			 WHERE 1 = 1
			   AND A.PBLICTE_YEAR = #PBLICTE_YEAR#
			   AND A.PBLICTE_QU = #PBLICTE_QU#
			      
			   AND A.CNTRCTR_NO = B.CNTRCTR_NO
			   AND A.CNTRCTR_NO = D.CNTRCTR_NO(+)
			   AND A.CNTRCTR_NO = C.CNTRCTR_NO(+)
			   AND B.LAD_CODE = E.LAD_CODE
			      
			   AND B.LAD_CODE = F.LAD_CODE
			   AND B.BLCK = F.BLCK
			   AND B.LOT = F.LOT
			   AND B.LOT_TY = F.LOT_TY
			
			<isNotEmpty property="LAD_CODE">
			   	AND B.LAD_CODE = #LAD_CODE#
			</isNotEmpty>
			
			<isNotEmpty property="BLCK">
			   	AND B.BLCK LIKE '%' || #BLCK# || '%'
			</isNotEmpty>
						
			<isNotEmpty property="LOT">
			   	AND B.LOT LIKE '%' || #LOT# || '%'
			</isNotEmpty>
			
			<isNotEmpty property="LOT_TY">
			   	AND B.LOT_TY LIKE '%' || #LOT_TY# || '%'
			</isNotEmpty>
			
			ORDER BY B.LAD_CODE, B.BLCK, B.LOT, B.LOT_TY
			 
	</select>
	
	<!-- 토지납부 조회_old  -->
	<select id="SLS090202DAO.selectLadPayList_old" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">

			 SELECT '0' AS CHK
				     ,A.CNTRCTR_NO        				/* 계약자번호                         */
				     ,A.LAD_CODE          				/* 토지코드                           */
				     ,A.BLCK              				/* 블록                               */
				     ,A.LOT                       /* 롯트                               */
				     ,A.LOT_TY                    /* 롯트타입                           */
				     ,A.LAD_CSTMR_NO              /* 토지고객번호                       */
				     ,A.BLCK || '-' || A.LOT || '-' || A.LOT_TY AS BLT /* BLT     */
				     ,A.LAD_CSTMR_NO              /* 토지고객번호                       */
				     ,(SELECT CSTMR_NM
				         FROM TBSLS_LAD_CSTMR S
				        WHERE S.LAD_CSTMR_NO = A.LAD_CSTMR_NO) AS LAD_CSTMR_NM /* 거래처                      */
				     ,(SELECT IHIDNUM
				         FROM TBSLS_LAD_CSTMR S
				        WHERE S.LAD_CSTMR_NO = A.LAD_CSTMR_NO) AS CSTMR_IHIDNUM /* 주민등록번호                       */
				     ,(SELECT EMAIL
				         FROM TBSLS_LAD_CSTMR S
				        WHERE S.LAD_CSTMR_NO = A.LAD_CSTMR_NO) AS EMAIL /* 이메일                       */
				     ,(SELECT ADRES || ' ' || ADRES_DETAIL
				         FROM TBSLS_LAD_CSTMR S
				        WHERE S.LAD_CSTMR_NO = A.LAD_CSTMR_NO) AS ADRES_FULL /* 주소                        */
				     ,A.CNTRCTR_MTLTY             /* 계약자상호                         */
				     ,A.BDNBR                     /* 건물번호                           */
				     ,A.ZIP_DM                    /* DM우편번호                         */
				     ,A.BASS_ADRES_DM             /* DM기본주소                         */
				     ,A.DETAIL_ADRES_DM           /* DM상세주소                         */
				     ,A.BDNBR_DM                  /* DM건물번호                         */
				     ,A.ETC_CTTPC                 /* 기타연락처                         */
				     ,A.FAXNO                     /* 팩스번호                           */
				     ,A.RM                        /* 비고                               */
				     ,A.CNTRCT_DE                 /* 계약일자                           */
				     ,A.RENT_BGNDE                /* 임대시작일자                       */
				     ,A.RENT_ENDDE                /* 임대종료일자                       */
				     ,A.SUPLY_SE                  /* 공급구분                           */
				     ,A.CNTRCT_TY                 /* 계약타입                           */
				     ,A.CANCL_DE                  /* 해약일자                           */
				     ,A.NMCHANGE_CNNC_CODE        /* 명의변경 건에 대한 순번.. 연결코드 */
				     ,A.ENTRPS_CHARGER            /* 업체담당자                         */
				     ,A.ENTRPS_DEPT               /* 업체부서                           */
				     ,A.ENTRPS_TELNO              /* 업체전화번호                       */
				     ,A.CTRTC_FILE_COURS          /* 계약서파일경로                     */
				     ,A.CTRTC_FILE                /* 계약서파일                         */
				     
				     ,B.CNTRCTR_NO               			/* 계약자번호 */
				     ,B.PAY_NO                   			/* 납부번호 */
				     ,B.RQEST_YM                 			/* 청구년월 */
				     ,B.PAY_CODE                 			/* 납부코드 */
				     ,B.PAY_ODR                  			/* 납부차수(할부:순번,임대료:순번,분양:분납순번) */
				     ,B.PAY_SE                   			/* 납부구분(0.정상,1선납,2.연체) */
				     ,B.INSTLMT_SE               			/* 할부구분 */
				     ,B.PAYAMT                   			/* 납부금액 */
				     ,B.PAY_SUPLY_AMOUNT         			/* 납부공급금액 */
				     ,B.PAY_VAT                  			/* 납부부가세 */
				     ,B.INSTLMT_INTR             			/* 할부이자 */
				     ,B.INSTLMT_INTR_SUPLY_AMOUNT			/* 할부이자공급금액 */
				     ,B.INSTLMT_INTR_VAT         			/* 할부이자부가세 */
				     ,B.ARRRG_AMOUNT             			/* 연체금액 */
				     ,B.PREPAY_DSCNT_AMOUNT      			/* 선납할인금액 */
				     ,B.PAY_TMLMT                			/* 납부기한일 */
				     ,B.PAY_STDR_DE              			/* 납부기준일자 */
				     ,B.NHT_OUTPT_DE             			/* 고지서출력일자 */
				     ,B.PAYMTHD                  			/* 납부방법 */
				     ,B.BANK_CODE                			/* 은행코드 */
				     ,B.OCR_NO                   			/* OCR밴드 */
				     ,B.MDAT_DE                  			/* 조정일자 */
				     ,B.OPETR_ID                 			/* 처리자ID */
				     ,B.LEV_DECSN_NO             			/* 징수결의번호 */
				     ,B.RM AS RM2                       			/* 비고 */
				     ,B.USE_AT                   			/* 해지미사용구분(기본값=0) */
				     ,B.RCIV_DECSN_NO            			/* 수납결의번호 */
				     ,B.LTTOT_RENT_SE            			/* 분양임화성분(S:분양,R:임대분양, L:임대료) */
				     ,B.TMPR_RCIV_DE             			/* 임시수납일자 */
				     ,B.TMPR_RCIV_AMOUNT         			/* 임시수납금액 */
				     ,B.RDCAMT_AMOUNT            			/* 감액금액 */
				     ,B.ARRRG_DSCNT_SE           			/* 연체할인구분 P0-정상/PA-연체이자/PP-선납할인 */
				     ,B.ARRRG_DSCNT_AMOUNT       			/* 연체할인금액 */
				     ,B.ARRRG_DSCNT_SUPLY_AMOUNT 			/* 연체할인공급금액 */
				     ,B.ARRRG_DSCNT_VAT          			/* 연체할인부가세 */
				     ,B.ARRRG_DSCNT_DAYCNT       			/* 연체할인일수 */
				     ,B.ARRRG_DSCNT_INTRT        			/* 연체할인이율 */
				     ,B.RCIV_DE                  			/* 수납일자 */
				     
				     ,C.BSNM_SN             /*사업자일련번호 */
				     ,C.BIZRNO              /*사업자등록번호                           */
				     ,C.MTLTY_NM            /*상호명                                   */
				     ,C.BIZCND              /*업태                                     */
				     ,C.INDUTY              /*업종                                     */
				     ,C.BDNBR               /*건물번호                                      */
				     ,'' AS BSNM_ADRES          /*사업자주소                               */
				     ,'' AS BSNS_CONFM_DE       /*사업승인일자                             */
				     ,C.USE_AT              /*사용여부                                 */
				     ,C.RM AS RM3           /*비고                                     */
				     ,(SELECT CSTMR_NM  FROM TBSLS_LAD_CSTMR S WHERE S.LAD_CSTMR_NO =  C.LAD_CSTMR_NO) AS CSTMR_NM  /* 대표자명                      */
				     ,(SELECT IHIDNUM  FROM TBSLS_LAD_CSTMR S WHERE S.LAD_CSTMR_NO =  C.LAD_CSTMR_NO ) AS IHIDNUM  /* 주민등록번호                */
				     
				     ,D.LAD_CODE               			/* 토지코드           */
				     ,D.LAD_NM                 			/* 토지명             */
				     ,D.ACQS_AMOUNT            			/* 취득금액           */
				     ,D.USE_AT                 			/* 사용여부           */
				     ,D.BSNS_CODE              			/* 사업코드           */
				     ,D.LOCPLC_ZIP             			/* 소재지우편번호     */
				     ,D.LOCPLC_BASS_ADRES      			/* 소재지기본주소     */
				     ,D.OPERTN_BGNDE           			/* 시행시작일         */
				     ,D.OPERTN_ENDDE           			/* 시행종료일         */
				     ,D.PLAN_CONFM_NTFC_DE_1   			/* 계획승인고시일자1  */
				     ,D.PLAN_CONFM_NTFC_DE_2   			/* 계획승인고시일자2  */
				     ,D.LTTOT_BSNS_CODE        			/* 분양사업코드       */
				     ,D.RENT_BSNS_CODE         			/* 임대사업코드       */
				     ,D.PRPOS_CODE             			/* 용도코드           */
				     ,D.READNG_AT              			/* 열람여부           */
				     ,D.HMPG_USE_AT            			/* 홈페이지사용여부   */
				     ,D.BSNS_TY                			/* 사업타입           */
				     ,D.LOCPLC_DETAIL_ADRES    			/* 소재지상세주소     */
				     ,D.LOCPLC_ZIP_LNM         			/* 소재지우편번호지번 */
				     ,D.LOCPLC_BASS_ADRES_LNM  			/* 소재지기본주소지번 */
				     ,D.LOCPLC_DETAIL_ADRES_LNM			/* 소재지상세주소지번 */
				     
				     /*,E.LAD_CODE               			/* 토지코드           */
				     /*,E.BLCK                   			/* 블록               */
				     /*,E.LOT                    			/* 롯트               */
				     /*,E.LOT_TY                 			/* 롯트타입           */
				     ,E.LAD_SE                 			/* 토지구분           */
				     ,E.LOCPLC_ZIP             			/* 소재지우편번호     */
				     ,E.LOCPLC_BASS_ADRES      			/* 소재지기본주소     */
				     ,E.LOCPLC_DETAIL_ADRES    			/* 소재지상세주소     */
				     ,E.LOCPLC_ZIP_LNM         			/* 소재지우편번호지번 */
				     ,E.LOCPLC_BASS_ADRES_LNM  			/* 소재지기본주소지번 */
				     ,E.LOCPLC_DETAIL_ADRES_LNM			/* 소재지상세주소지번 */
				     ,E.PRPOS_SE               			/* 용도구분           */
				     ,E.CLASSIFICATION_SE      			/* 급지구분대상 : 산업용지   */
				     ,E.CNTNT_SE               			/*  목차구분 대상 : 공공용지 */
				     ,E.BGNN_AR                			/* 당초면적[권리면적]  */
				     ,E.BGNN_UNTPC             			/* 당초단가            */
				     ,E.BGNN_AMOUNT            			/* 당초금액[권리금액]*/
				     ,E.DCSN_AR                			/* 확정면적          */
				     ,E.DCSN_UNTPC             			/* 확정단가          */
				     ,E.DCSN_AMOUNT            			/* 확정금액          */
				     ,E.REMVL_FLFL_GTN         			/* 철거이행보증금    */
				     ,E.RENT_GTN               			/* 임대보증금        */
				     ,E.FYER_RNTCHRG           			/* 연간임대료        */
				     ,E.ATCH_FLPTH             			/* 첨부파일경로      */
				     ,E.ATCH_FILE              			/* 첨부파일          */
				     ,E.RM AS RM4                     	    /* 비고              */
				     ,E.REMNDR_LAD_SE          	    /* 잔여토지구분      */
				     ,E.SUPLY_CODE             	    /* 공급코드          */
				     ,E.CNTRCT_STTUS           	    /* 계약상태          */
				     ,E.BDNBR                  	    /* 건물번호          */
				     ,E.ALL_AR                 	    /* 전체면적          */
				     
				     ,F.CANCL_DE                      /* 해약일자         */
				     
				     ,#PBLICTE_YEAR# AS PBLICTE_YEAR /* 발행년도       */
				     ,#PBLICTE_QU# AS PBLICTE_QU /* 발행분기       */
				
				 FROM TBSLS_LCNTRCTR        A /* 토지계약자 */
				     ,TBSLS_LCNTRCTR_PAY    B /* 토지계약자납부 */
				     ,TBSLS_LCNTRCTR_BSNM   C /* 토지계약자사업자 */
				     ,TBSLS_LAD_INFO        D /* 토지정보       */
				     ,TBSLS_LAD_DETAIL_INFO E /* 토지정보상세   */
				     ,TBSLS_LCNTRCTR_CANCL  F /* 토지계약자해약 */
				
				WHERE 1 = 1
				  AND A.CNTRCTR_NO = B.CNTRCTR_NO
				  AND A.CNTRCTR_NO = C.CNTRCTR_NO(+)				 
				  AND A.LAD_CODE = D.LAD_CODE
				  AND A.LAD_CODE = E.LAD_CODE
				  AND A.BLCK = E.BLCK
				  AND A.LOT = E.LOT
				  AND A.LOT_TY = E.LOT_TY
				  AND A.CNTRCTR_NO = F.CNTRCTR_NO(+)
			   	  AND B.RCIV_DE IS NOT NULL
			  
			   
			<isNotEmpty property="PBLICTE_YEAR">
			   	AND SUBSTR(B.RCIV_DE, 0, 4) = #PBLICTE_YEAR#
			</isNotEmpty>
			
			<isEqual property="PBLICTE_QU" compareValue="1">
				AND SUBSTR(B.RCIV_DE, 0, 6) BETWEEN #PBLICTE_YEAR# || '01' AND #PBLICTE_YEAR# || '03'
			</isEqual>
			
			<isEqual property="PBLICTE_QU" compareValue="2">
				AND SUBSTR(B.RCIV_DE, 0, 6) BETWEEN #PBLICTE_YEAR# || '04' AND #PBLICTE_YEAR# || '06'
			</isEqual>
			
			<isEqual property="PBLICTE_QU" compareValue="3">
				AND SUBSTR(B.RCIV_DE, 0, 6) BETWEEN #PBLICTE_YEAR# || '07' AND #PBLICTE_YEAR# || '09'
			</isEqual>
			
			<isEqual property="PBLICTE_QU" compareValue="4">
				AND SUBSTR(B.RCIV_DE, 0, 6) BETWEEN #PBLICTE_YEAR# || '10' AND #PBLICTE_YEAR# || '12'
			</isEqual>
			
			<isNotEmpty property="LAD_CODE">
			   	AND A.LAD_CODE = #LAD_CODE#
			</isNotEmpty>
			
			<isNotEmpty property="BLCK">
			   	AND A.BLCK LIKE '%' || #BLCK# || '%'
			</isNotEmpty>
						
			<isNotEmpty property="LOT">
			   	AND A.LOT LIKE '%' || #LOT# || '%'
			</isNotEmpty>
			
			<isNotEmpty property="LOT_TY">
			   	AND A.LOT_TY LIKE '%' || #LOT_TY# || '%'
			</isNotEmpty>
			 
	</select>
	
	
	<!-- 토지부가세 조회  -->
	<select id="SLS090202DAO.selectLadVatList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[
			 SELECT '0' AS CHK
			        ,BILL_SE       		/* 계산서구분; 1:세금계산서 , 2:계산서 */
					,VAT_SN        		/* 부가세일련번호(발행구분별 일련번호) */
					,PBLICTE_YEAR  		/* 발행년도                            */
					,PBLICTE_QU    		/* 발행분기                            */
					,CNTRCTR_NO    		/* 계약자번호                          */
					,PAY_NO        		/* 납부번호                            */
					,PAY_CODE      		/* 납부코드                            */
					,PBLICTE_DE    		/* 발행일자                            */
					,(CASE
			           WHEN SUBSTR(PBLICTE_DE, 5, 2) = '01' OR
			                SUBSTR(PBLICTE_DE, 5, 2) = '04' OR
			                SUBSTR(PBLICTE_DE, 5, 2) = '07' OR
			                SUBSTR(PBLICTE_DE, 5, 2) = '10' THEN
			            '1'
			           WHEN SUBSTR(PBLICTE_DE, 5, 2) = '02' OR
			                SUBSTR(PBLICTE_DE, 5, 2) = '05' OR
			                SUBSTR(PBLICTE_DE, 5, 2) = '08' OR
			                SUBSTR(PBLICTE_DE, 5, 2) = '11' THEN
			            '2'
			           WHEN SUBSTR(PBLICTE_DE, 5, 2) = '03' OR
			                SUBSTR(PBLICTE_DE, 5, 2) = '06' OR
			                SUBSTR(PBLICTE_DE, 5, 2) = '09' OR
			                SUBSTR(PBLICTE_DE, 5, 2) = '12' THEN
			            '3'
			           ELSE
			            '0'
			         END) AS MT_SE 		/* 월구분         */
					,PRDLST        		/* 품목                                */
					,PAYAMT        		/* 납부금액                            */
					,SUPLY_AMOUNT  		/* 납부공급금액                        */
					,VAT           		/* 납부부가세                          */
					,RQEST_SE      		/* 청구구분(1:청구, 2:영수)     */
					,OPETR_ID      		/* 처리자ID                  */
					,PBLICTE_CNFIRM		/* 발행확인                            */
					,REGISTER_ID   		/* 등록자ID                  */
					,REGIST_DT     		/* 등록일시                            */
					,UPDUSR_ID     		/* 수정자ID                  */
					,UPDT_DT       		/* 수정일시                            */
					,NTS_CONFM_NO  		/* 국세청승인번호                      */
			
			   FROM TBSLS_LAD_VAT /* 토지부가세       */  
			  WHERE 1 = 1
		]]>
			   
			<isNotEmpty property="BILL_SE">
			   	AND BILL_SE = #BILL_SE#
			</isNotEmpty>
			
			<isNotEmpty property="PBLICTE_YEAR">
			   	AND PBLICTE_YEAR = #PBLICTE_YEAR#
			</isNotEmpty>
			
			<isNotEmpty property="PBLICTE_QU">
			   	AND PBLICTE_QU = #PBLICTE_QU#
			</isNotEmpty>
			
			<isNotEmpty property="CNTRCTR_NO">
			   	AND CNTRCTR_NO = #CNTRCTR_NO#
			</isNotEmpty>
			
			  ORDER BY PBLICTE_YEAR, PBLICTE_QU, CNTRCTR_NO
			 
	</select>
	<!-- 간주임대료 조회  -->
	<select id="SLS090202DAO.selectRegardList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[
				SELECT 
					   B.CNTRCT_DE				/* 계약일 */
					  ,A.CNTRCTR_NO				/* 계약자번호 */
					  ,A.PBLICTE_YEAR			/* 발행년도 */
					  ,A.PBLICTE_QU				/* 발행분기 */
					  ,A.DAYCNT					/* 일수 */
					  ,A.REGARD_GTN				/* 간주보증금 */
					  ,A.REGARD_RNTCHRG			/* 간주임대료 */
					  ,A.SUPLY_AMOUNT			/* 공급가액 */
					  ,A.VAT					/* 부가세 */
					  ,A.REGARD_INTRT			/* 간주이자율 */
				 FROM TBSLS_REGARD_RNTCHRG A,
							TBSLS_LCNTRCTR B
				WHERE 1=1
				  AND A.CNTRCTR_NO = B.CNTRCTR_NO 		 
		]]>		   
			<isNotEmpty property="PBLICTE_YEAR">
			   	  AND A.PBLICTE_YEAR = #PBLICTE_YEAR#
			</isNotEmpty>
			
			<isNotEmpty property="PBLICTE_QU">
			   	  AND A.PBLICTE_QU = #PBLICTE_QU#
			</isNotEmpty>
			
			<isNotEmpty property="CNTRCTR_NO">
			   	  AND A.CNTRCTR_NO = #CNTRCTR_NO#
			</isNotEmpty>
			
			    ORDER BY A.PBLICTE_YEAR, A.PBLICTE_QU, A.CNTRCTR_NO
	</select>
	
	
	<!-- 토지부가세생성 여부  -->
	<select id="SLS090202DAO.selectLadVatExsitYn" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		 SELECT DECODE(COUNT(CNTRCTR_NO), 0, 'N', 'Y') AS EXIST_YN
		   FROM TBSLS_LAD_VAT
		  WHERE 1 = 1
		    AND BILL_SE IN ('1','2')
			AND PBLICTE_YEAR 	= #PBLICTE_YEAR#
			AND PBLICTE_QU 		= #PBLICTE_QU#
		<isNotEmpty property="LAD_CODE">
		    AND CNTRCTR_NO IN (SELECT CNTRCTR_NO
			                      FROM TBSLS_LCNTRCTR
			                     WHERE LAD_CODE = #LAD_CODE#
			                  	)
		</isNotEmpty>
		
	</select>
	
<!-- ******************************************* 부가세생성 이벤트 실행쿼리 START *********************************************** -->	
	<!-- 토지부가세 삭제 -->
	<delete id="SLS090202DAO.deleteLadVat" parameterClass="java.util.Map">
	      DELETE TBSLS_LAD_VAT
		   WHERE 1 = 1
		     AND BILL_SE IN ('1','2')
		     AND PBLICTE_YEAR 	= #PBLICTE_YEAR#
		     AND PBLICTE_QU 	= #PBLICTE_QU#
		   
	</delete>
	

	<!-- 토지부가세 추가 -->
	<insert id="SLS090202DAO.insertLadVat1" parameterClass="java.util.Map">
	      INSERT INTO TBSLS_LAD_VAT
		  (    
		     	 BILL_SE       								/* 계산서구분; 1:세금계산서 , 2:계산서  */
				,VAT_SN        								/* 부가세일련번호(발행구분별 일련번호) */
				,PBLICTE_YEAR  								/* 발행년도 */
				,PBLICTE_QU    								/* 발행분기 */
				,CNTRCTR_NO    								/* 계약자번호 */
				,PAY_NO        								/* 납부번호 */
				,PAY_CODE     						 		/* 납부코드 */
				,PBLICTE_DE   						 		/* 발행일자 */
				,PRDLST        								/* 품목 */
				,PAYAMT        								/* 납부금액 */
				,SUPLY_AMOUNT  								/* 납부공급금액 */
				,VAT           								/* 납부부가세 */
				,RQEST_SE      								/* 청구구분(1:청구, 2:영수) */
				,OPETR_ID      								/* 처리자ID */
				,PBLICTE_CNFIRM								/* 발행확인 */
				,NTS_CONFM_NO  								/* 국세청승인번호 */
				,REGISTER_ID   								/* 등록자ID */
				,REGIST_DT     								/* 등록일시 */
				,UPDUSR_ID     								/* 수정자ID */
				,UPDT_DT       								/* 수정일시 */
			                
		  ) 
		  		
		  	  SELECT   #BILL_SE# AS BILL_SE					 /* 계산서구분:1세금계산서 , 2:계산서 */
			         , (ROW_NUMBER() OVER(ORDER BY B.PAY_CODE) +
			         (SELECT NVL(MAX(VAT_SN), 0)
			         FROM    TBSLS_LAD_VAT
			         WHERE   1       = 1
			         AND     BILL_SE = '1'
			         )
			         ) AS VAT_SN         					 /* 부가세일련번호 */
			         , #PBLICTE_YEAR# AS PBLICTE_YEAR        /* 발행년도 */
			         , #PBLICTE_QU# AS PBLICTE_QU        	 /* 발행분기 */
			         , B.CNTRCTR_NO       					 /* 계약자번호 */
			         , B.PAY_NO        						 /* 납부번호 */
			         , B.PAY_CODE      						 /* 납부코드 */
			           , B.MDAT_DE AS PBLICTE_DE      		 /* 수납일자 */
			           , DECODE(TO_NUMBER(SUBSTR(B.MDAT_DE, 5, 2)) -1, 0, 12
         																,TO_NUMBER(SUBSTR(B.MDAT_DE, 5, 2)) -1)
         				||'월분 '|| ( SELECT X.CODE_NM
								         FROM TBCOM_CMMN_CODE X
								        WHERE X.GRP_CODE = 'LAD0A1'
								          AND X.CODE     = B.PAY_CODE
			         )
			         AS PRDLST       						 /* 품목 */
			         , B.PAYAMT       						 /* 납부금액 */
			         , B.PAY_SUPLY_AMOUNT AS SUPLY_AMOUNT    /* 납부공급가액 */
			         , B.PAY_VAT AS VAT      				 /* 납부부가세 */
			         , #RQEST_SE# AS RQEST_SE      			 /* 청구구분(1:청구, 2:영수) */
			         , #S_USER_ID# AS OPETR_ID   			 /* 처리자ID */
			         , '' AS PBLICTE_CNFIRM     			 /* 발행확인ID */
			         , '' AS NTS_CONFM_NO       			 /* 국세청승인번호 */
			         , #S_USER_ID# AS REGISTER_ID  			 /*등록자ID */
			         , SYSDATE AS REGIST_DT       			 /*등록일시 */
			         , #S_USER_ID# AS UPDUSR_ID    			 /*수정자ID */
			         , SYSDATE AS UPDT_DT       			 /*수정일시 */
			FROM     TBSLS_LCNTRCTR A        				 /* 토지계약자 */
			         , TBSLS_LCNTRCTR_PAY B					 /* 토지계약자납부 */
			WHERE    1                   = 1
			AND      A.CNTRCTR_NO        = B.CNTRCTR_NO
			AND			 A.CNTRCT_TY	  = 'RN'
			AND 		 A.CANCL_DE IS NULL
			AND      B.PAY_CODE     = 'RN'
			AND			 B.LTTOT_RENT_SE = 'R'									
			     
			<isEqual property="PBLICTE_QU" compareValue="1">
				 AND SUBSTR(B.MDAT_DE, 0, 6) BETWEEN #PBLICTE_YEAR# || '01' AND #PBLICTE_YEAR# || '03'
			</isEqual>
			
			<isEqual property="PBLICTE_QU" compareValue="2">
				 AND SUBSTR(B.MDAT_DE, 0, 6) BETWEEN #PBLICTE_YEAR# || '04' AND #PBLICTE_YEAR# || '06'
			</isEqual>
			
			<isEqual property="PBLICTE_QU" compareValue="3">
				 AND SUBSTR(B.MDAT_DE, 0, 6) BETWEEN #PBLICTE_YEAR# || '07' AND #PBLICTE_YEAR# || '09'
			</isEqual>
			
			<isEqual property="PBLICTE_QU" compareValue="4">
				 AND SUBSTR(B.MDAT_DE, 0, 6) BETWEEN #PBLICTE_YEAR# || '10' AND #PBLICTE_YEAR# || '12'
			</isEqual>	      
			  
	</insert>
	<!-- 토지부가세(기타수입부가세) 추가 -->
	<insert id="SLS090202DAO.insertLadVat2" parameterClass="java.util.Map">
		INSERT INTO TBSLS_LAD_VAT
		  (    
		     	 BILL_SE       								/* 계산서구분; 1:세금계산서 , 2:계산서  */
				,VAT_SN        								/* 부가세일련번호(발행구분별 일련번호) */
				,PBLICTE_YEAR  								/* 발행년도 */
				,PBLICTE_QU    								/* 발행분기 */
				,CNTRCTR_NO    								/* 계약자번호 */
				,PAY_NO        								/* 납부번호 */
				,PAY_CODE     						 		/* 납부코드 */
				,PBLICTE_DE   						 		/* 발행일자 */
				,PRDLST        								/* 품목 */
				,PAYAMT        								/* 납부금액 */
				,SUPLY_AMOUNT  								/* 납부공급금액 */
				,VAT           								/* 납부부가세 */
				,RQEST_SE      								/* 청구구분(1:청구, 2:영수) */
				,OPETR_ID      								/* 처리자ID */
				,PBLICTE_CNFIRM								/* 발행확인 */
				,NTS_CONFM_NO  								/* 국세청승인번호 */
				,REGISTER_ID   								/* 등록자ID */
				,REGIST_DT     								/* 등록일시 */
				,UPDUSR_ID     								/* 수정자ID */
				,UPDT_DT       								/* 수정일시 */
			                
		  ) 
			SELECT   #BILL_SE# AS BILL_SE       							/* 계산서구분:1세금계산서 , 2:계산서       */
			         , (ROW_NUMBER() OVER(ORDER BY B.PAY_CODE) +
			         (SELECT NVL(MAX(VAT_SN), 0)
			         FROM    TBSLS_LAD_VAT
			         WHERE   1       = 1
			         AND     BILL_SE = '1'
			         )
			         ) AS VAT_SN         									/* 부가세일련번호       */
			         , #PBLICTE_YEAR# AS PBLICTE_YEAR       				/* 발행년도 */
			         , #PBLICTE_QU# AS PBLICTE_QU        					/* 발행분기 */
			         , B.CNTRCTR_NO       									/* 계약자번호 */
			         , B.PAY_NO        										/* 납부번호 */
			         , B.PAY_CODE      										/* 납부코드 */
			         , B.PAY_TMLMT AS PBLICTE_DE      						/* 수납일자 */
			         , DECODE(TO_NUMBER(SUBSTR(B.PAY_TMLMT, 5, 2)) -1, 0, 12
         																,TO_NUMBER(SUBSTR(B.PAY_TMLMT, 5, 2)) -1 ) 
         			   ||'월분 '|| ( SELECT X.CODE_NM
							            FROM TBCOM_CMMN_CODE X
							           WHERE X.GRP_CODE = 'LAD0A1'
							             AND X.CODE     = B.PAY_CODE
							        ) AS PRDLST       						/* 품목 */
			         , B.PAYAMT       										/* 납부금액 */
			         , B.PAY_SUPLY_AMOUNT AS SUPLY_AMOUNT        			/* 납부공급가액 */
			         , B.PAY_VAT AS VAT      								/* 납부부가세 */
			         , #RQEST_SE# AS RQEST_SE      							/* 청구구분(1:청구, 2:영수) */
			         , #S_USER_ID# AS OPETR_ID   					 		/* 처리자ID */
			         , '' AS PBLICTE_CNFIRM     							/* 발행확인ID */
			         , '' AS NTS_CONFM_NO       							/* 국세청승인번호 */
			         , #S_USER_ID# AS REGISTER_ID  						    /* 등록자ID */
			         , SYSDATE AS REGIST_DT       							/* 등록일시 */
			         , #S_USER_ID# AS UPDUSR_ID    						    /* 수정자ID */
			         , SYSDATE AS UPDT_DT       							/* 수정일시 */
			FROM     TBSLS_LCNTRCTR A        								/* 토지계약자 */
							 , TBSLS_ETC_INCME_PAY B
			   WHERE 1 = 1
			     AND A.CNTRCTR_NO = B.CNTRCTR_NO
			     AND B.JOB_SE = 'LAD'
			     AND B.PAY_VAT > 0
			     AND A.CANCL_DE IS NULL
			     AND (BILL_OUTPT_AT = '1' OR TAXBIL_OUTPT_AT = '1')	
		   
			<isEqual property="PBLICTE_QU" compareValue="1">
				 AND SUBSTR(B.PAY_TMLMT, 0, 6) BETWEEN #PBLICTE_YEAR# || '01' AND #PBLICTE_YEAR# || '03'
			</isEqual>
			
			<isEqual property="PBLICTE_QU" compareValue="2">
				 AND SUBSTR(B.PAY_TMLMT, 0, 6) BETWEEN #PBLICTE_YEAR# || '04' AND #PBLICTE_YEAR# || '06'
			</isEqual>
			
			<isEqual property="PBLICTE_QU" compareValue="3">
				 AND SUBSTR(B.PAY_TMLMT, 0, 6) BETWEEN #PBLICTE_YEAR# || '07' AND #PBLICTE_YEAR# || '09'
			</isEqual>
			
			<isEqual property="PBLICTE_QU" compareValue="4">
				 AND SUBSTR(B.PAY_TMLMT, 0, 6) BETWEEN #PBLICTE_YEAR# || '10' AND #PBLICTE_YEAR# || '12'
			</isEqual>	
	</insert>
	
	<!-- 간주임대료 기등록 삭제 -->
	<delete id="SLS090202DAO.deleteLadRegard" parameterClass="java.util.Map">
	      DELETE TBSLS_REGARD_RNTCHRG
		   WHERE 1 = 1
		     AND PBLICTE_YEAR 	= #PBLICTE_YEAR#
		     AND PBLICTE_QU 	= #PBLICTE_QU#
	</delete>
	
	<!-- 간주임대료 추가 -->
	<insert id="SLS090202DAO.insertLadVat3" parameterClass="java.util.Map">
			INSERT INTO TBSLS_REGARD_RNTCHRG (
				   CNTRCTR_NO																	/* 계약자번호 */
				   ,PBLICTE_YEAR																/* 발행년도 */
				   ,PBLICTE_QU																	/* 발행분기 */
				   ,DAYCNT																		/* 일수 */
				   ,REGARD_GTN																	/* 간주보증금 */
				   ,REGARD_RNTCHRG																/* 간주임대료 */
				   ,SUPLY_AMOUNT																/* 공급가액 */
				   ,VAT																			/* 부가세 */
				   ,REGARD_INTRT																/* 간주이자율 */
				   ,REGISTER_ID																	/* 등록자ID */
				   ,REGIST_DT																	/* 등록일 */
				   ,UPDUSR_ID																	/* 수정자ID */
				   ,UPDT_DT																		/* 수정일 */
			) 
			SELECT CNTRCTR_NO																	/* 계약자번호 */
				   ,#PBLICTE_YEAR# AS PBLIBTE_YEAR												/* 발행년도 */
			       ,#PBLICTE_QU# AS PBLICTE_QU													/* 발행분기 */
			       ,DAYCNT																		/* 일수 */
			       ,REGARD_GNT																	/* 간주보증금 */
			       ,REGARD_RNTCHRG																/* 간주임대료 */
			       ,TRUNC((TO_NUMBER(REGARD_RNTCHRG) - TO_NUMBER(VAT)),0) AS SUPLY_AMOUNT		/* 공급가액 */
			       ,VAT																			/* 부가세 */
			       ,REGARD_INTRT																/* 간주이자율 */
			       ,#S_USER_ID# AS REGISTER_ID													/* 등록자ID */
			       ,SYSDATE AS REGIST_DT														/* 등록일 */
			       ,#S_USER_ID# AS UPDUSR_ID													/* 수정자ID */
			       ,SYSDATE AS UPDT_DT															/* 수정일 */
		      
			  FROM 
				   (
				   SELECT
						  CNTRCTR_NO
					  	  ,REGARD_GNT
					  	  ,CNTRCT_DE
					  	  ,CANCL_DE
		 			 	  ,( TO_DATE(QU_DATE_TO,'YYYYMMDD') - TO_DATE(QU_DATE_FROM,'YYYYMMDD') +1) AS DAYCNT
					  	  , TRUNC (  (REGARD_GNT) * (SFPMS_GET_INTRT_RATE('LAD','','R3',#CURRENT_DE#,'') / 100)
			                          * (( TO_DATE(QU_DATE_TO,'YYYYMMDD') - TO_DATE(QU_DATE_FROM,'YYYYMMDD') +1) / (TO_DATE(#PBLICTE_YEAR#||'1231','YYYYMMDD') - TO_DATE(#PBLICTE_YEAR#||'0101','YYYYMMDD') + 1)),
			                          0
		                          )  AS  REGARD_RNTCHRG
					  	  , TRUNC (  (REGARD_GNT) * (SFPMS_GET_INTRT_RATE('LAD','','R3',#CURRENT_DE#,'') / 100 * 0.1)
			                          * (( TO_DATE(QU_DATE_TO,'YYYYMMDD') - TO_DATE(QU_DATE_FROM,'YYYYMMDD') +1) / (TO_DATE(#PBLICTE_YEAR#||'1231','YYYYMMDD') - TO_DATE(#PBLICTE_YEAR#||'0101','YYYYMMDD') + 1)),
			                          0
		                          ) AS VAT
					  	  , (SFPMS_GET_INTRT_RATE('LAD','','R3',#CURRENT_DE#,'')) AS REGARD_INTRT
					 FROM
					      (
		 <![CDATA[		  SELECT Z.CNTRCTR_NO
						         , SUM(Z.PAYAMT) AS REGARD_GNT
						         , T.CNTRCT_DE
						         , NVL(T.CANCL_DE,'') AS CANCL_DE
						         , CASE WHEN #QU_DATE_TO# > T.CANCL_DE THEN T.CANCL_DE
						         	    ELSE #QU_DATE_TO# END QU_DATE_TO
						         , CASE WHEN #QU_DATE_FROM# < T.CNTRCT_DE THEN T.CNTRCT_DE
						                ELSE #QU_DATE_FROM# END QU_DATE_FROM
						    FROM TBSLS_LCNTRCTR_PAY Z
						         , TBSLS_LCNTRCTR T
						   WHERE 1 = 1
						     AND Z.CNTRCTR_NO         = T.CNTRCTR_NO
						     AND T.CNTRCT_TY = 'RN'
						     AND (T.CANCL_DE IS NULL OR T.CANCL_DE BETWEEN #QU_DATE_FROM# AND #QU_DATE_TO#)
						     AND Z.PAY_CODE LIKE 'R%'
						     AND Z.PAY_CODE <> 'RN'
						     AND NOT EXISTS( SELECT 1 FROM TBSLS_LCNTRCTR_PAY F WHERE F.CNTRCTR_NO = T.CNTRCTR_NO AND F.PAY_CODE LIKE 'S%')
						   GROUP BY Z.CNTRCTR_NO, T.CNTRCT_DE, T.CANCL_DE  ]]>
						   )
					) 
			  WHERE 1=1
	</insert>
<!-- ******************************************* 부가세생성 이벤트 실행쿼리 END *********************************************** -->

	
	
	<!-- 토지부가세(임대료 / 간주임대료 / 기타수입 매출조서 조회  -->
	<select id="SLS090202DAO.selectLadSellingWtnncList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
			  /* 임대료 / 간주임대료 */
			  SELECT 
			         B.LAD_CODE													/* 토지코드  */
			         , B.BLCK || '-' || B.LOT || '-' || B.LOT_TY AS BLT         /* BLT     */
			         , '[' || B.BLCK || '-' || B.LOT || ']' AS BLCK_LOT
			         , (SELECT BIZRNO
			  	          FROM TBSLS_LCNTRCTR_BSNM S
			             WHERE S.CNTRCTR_NO = B.CNTRCTR_NO
			         )
			         AS BIZRNO													/* 사업자등록번호 */
			         , (SELECT CSTMR_NM
			        	  FROM TBSLS_LAD_CSTMR S
			         	 WHERE S.LAD_CSTMR_NO = B.LAD_CSTMR_NO
			         )
			         AS CSTMR_NM															/* 고객명 */
			         , A.REGARD_GTN       												    /* 간주보증금 */
			         , A.REGARD_RNTCHRG         							 			    /* 간주임대료 */
			         , A.REGARD_INTRT         												/* 간주이자율  */
			         , A.SUPLY_AMOUNT         												/* 공급가액 */
			         , A.VAT         														/* 부가세 */
			         , PAYAMT1																/* 분기 1번째 월 납부금액 */
			         , SUPLY_AMOUNT1														/* 분기 1번째 월 공급가액 */
			         , VAT1																	/* 분기 1번째 월 부가세 */
			         , PAYAMT2																/* 분기 2번째 월 납부금액 */
			         , SUPLY_AMOUNT2														/* 분기 2번째 월 공급가액 */
			         , VAT2																	/* 분기 2번째 월 부가세 */
			         , PAYAMT3																/* 분기 3번째 월 납부금액 */
			         , SUPLY_AMOUNT3														/* 분기 3번째 월 공급가액 */
			         , VAT3																	/* 분기 3번때 월 부가세 */
			         , PAYAMT1       + PAYAMT2 + PAYAMT3             AS PAYAMT_SUM			/* 분기 납부금액 합계 */
			         , SUPLY_AMOUNT1 + SUPLY_AMOUNT2 + SUPLY_AMOUNT3 AS SUPLY_AMOUNT_SUM	/* 분기 공급가액 합계 */
			         , VAT1          + VAT2 + VAT3                   AS VAT_SUM				/* 분기 부가세 합계 */
			         , SFSLS_LAD_NM(B.LAD_CODE, 'ALL_LAD_NM')        AS ALL_LAD_NM			/* 토지코드 토지명 */
			         , SFSLS_LAD_NM(B.LAD_CODE, 'LAD_NM')            AS LAD_NM				/* 토지명 */
			    FROM TBSLS_REGARD_RNTCHRG A         /* 간주임대료정보 */
			         , TBSLS_LCNTRCTR B         /* 토지계약자 */
			         , (SELECT CNTRCTR_NO
							   ,SUM(PAYAMT1) AS PAYAMT1
							   ,SUM(PAYAMT2) AS PAYAMT2
							   ,SUM(PAYAMT3) AS PAYAMT3
							   ,SUM(SUPLY_AMOUNT1) AS SUPLY_AMOUNT1
							   ,SUM(SUPLY_AMOUNT2) AS SUPLY_AMOUNT2
							   ,SUM(SUPLY_AMOUNT3) AS SUPLY_AMOUNT3
							   ,SUM(VAT1) AS VAT1
							   ,SUM(VAT2) AS VAT2
							   ,SUM(VAT3) AS VAT3
						  FROM (SELECT A.CNTRCTR_NO ,
							           CASE A.PBLICTE_QU
							     	   WHEN '1'
				                         	 THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '01', A.PAYAMT, 0)
				                       WHEN '2'
				                         	 THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '04', A.PAYAMT, 0)
				                       WHEN '3'
				                             THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '07', A.PAYAMT, 0)
				                       WHEN '4'
				                             THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '10', A.PAYAMT, 0)
							           END AS PAYAMT1 ,
							           CASE A.PBLICTE_QU
					                         WHEN '1'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'01' , A.SUPLY_AMOUNT , 0)
					                         WHEN '2'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'04' , A.SUPLY_AMOUNT , 0)
					                         WHEN '3'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'07' , A.SUPLY_AMOUNT , 0)
					                         WHEN '4'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'10' , A.SUPLY_AMOUNT , 0)
					                   END AS SUPLY_AMOUNT1 ,
					                   CASE A.PBLICTE_QU
					                         WHEN '1'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '01', A.VAT, 0)
					                         WHEN '2'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '04', A.VAT, 0)
					                         WHEN '3'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '07', A.VAT, 0)
					                         WHEN '4'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '10', A.VAT, 0)
					                   END AS VAT1 ,
					                   CASE A.PBLICTE_QU
					                         WHEN '1'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '02', A.PAYAMT, 0)
					                         WHEN '2'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '05', A.PAYAMT, 0)
					                         WHEN '3'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '08', A.PAYAMT, 0)
					                         WHEN '4'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '11', A.PAYAMT, 0)
					                   END AS PAYAMT2 ,
					                   CASE A.PBLICTE_QU
					                         WHEN '1'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'02' , A.SUPLY_AMOUNT , 0)
					                         WHEN '2'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'05' , A.SUPLY_AMOUNT , 0)
					                         WHEN '3'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'08' , A.SUPLY_AMOUNT , 0)
					                         WHEN '4'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'11' , A.SUPLY_AMOUNT , 0)
					                   END AS SUPLY_AMOUNT2 ,
					                   CASE A.PBLICTE_QU
					                         WHEN '1'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '02', A.VAT, 0)
					                         WHEN '2'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '05', A.VAT, 0)
					                         WHEN '3'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '08', A.VAT, 0)
					                         WHEN '4'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '11', A.VAT, 0)
					                   END AS VAT2 ,
					                   CASE A.PBLICTE_QU
					                         WHEN '1'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '03', A.PAYAMT, 0)
					                         WHEN '2'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '06', A.PAYAMT, 0)
					                         WHEN '3'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '09', A.PAYAMT, 0)
					                         WHEN '4'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '12', A.PAYAMT, 0)
					                   END AS PAYAMT3 ,
					                   CASE A.PBLICTE_QU
					                         WHEN '1'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'03' , A.SUPLY_AMOUNT , 0)
					                         WHEN '2'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'06' , A.SUPLY_AMOUNT , 0)
					                         WHEN '3'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'09' , A.SUPLY_AMOUNT , 0)
					                         WHEN '4'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'12' , A.SUPLY_AMOUNT , 0)
					                   END AS SUPLY_AMOUNT3 ,
					                   CASE A.PBLICTE_QU
					                         WHEN '1'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '03', A.VAT, 0)
					                         WHEN '2'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '06', A.VAT, 0)
					                         WHEN '3'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '09', A.VAT, 0)
					                         WHEN '4'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '12', A.VAT, 0)
					                   END AS VAT3
					         	  FROM TBSLS_LAD_VAT A	                 /* 토지부가세 */
					         	 WHERE 1 = 1
					         	   AND BILL_SE = '1'
								   AND PBLICTE_YEAR = #PBLICTE_YEAR#
								   AND PBLICTE_QU = #PBLICTE_QU#
					         	 )
					     GROUP BY CNTRCTR_NO
					     ORDER BY CNTRCTR_NO
					   )
	       					  C
			   WHERE    A.CNTRCTR_NO   = B.CNTRCTR_NO
			     AND PBLICTE_YEAR = #PBLICTE_YEAR#
				 AND PBLICTE_QU = #PBLICTE_QU#
			     AND A.CNTRCTR_NO   = C.CNTRCTR_NO(+)
			  <isNotEmpty property="LAD_CODE">
				 AND B.LAD_CODE = #LAD_CODE#
			  </isNotEmpty>
		   	  <isNotEmpty property="BLCK">
				 AND B.BLCK LIKE '%' || #BLCK# || '%'
			  </isNotEmpty>
  		      <isNotEmpty property="LOT">
				 AND B.LOT LIKE '%' || #LOT# || '%'
			  </isNotEmpty>
			  <isNotEmpty property="LOT_TY">
				 AND B.LOT_TY LIKE '%' || #LOT_TY# || '%'
			  </isNotEmpty>

		UNION ALL
			 /* 기타수입 */
			  SELECT
			         B.LAD_CODE																		         /* 토지코드  */
			         , B.BLCK || '-' || B.LOT || '-' || B.LOT_TY AS BLT        								 /* BLT     */
			         , '[' || B.BLCK || '-' || B.LOT || ']' AS BLCK_LOT
			         , (SELECT BIZRNO
			         	  FROM TBSLS_LCNTRCTR_BSNM S
			         	 WHERE S.CNTRCTR_NO = B.CNTRCTR_NO														
			         )
			         AS BIZRNO																				/* 사업자번호 */
			         , (SELECT CSTMR_NM
			         	  FROM TBSLS_LAD_CSTMR S
			         	 WHERE S.LAD_CSTMR_NO = B.LAD_CSTMR_NO
			         )
			         AS CSTMR_NM																			/* 고객명 */
			         , null AS REGARD_GTN        															/* 간주보증금 */
			         , null AS REGARD_RNTCHRG         													    /* 간주임대료 */
			         , null AS REGARD_INTRT        															/* 간주이자율  */
			         , null AS SUPLY_AMOUNT         														/* 공급가액 */
			         , null AS VAT         																	/* 부가세 */
			         , PAYAMT1																				/* 분기 1번째 월 납부금액 */
			         , SUPLY_AMOUNT1																		/* 분기 1번째 월 공급가액 */
			         , VAT1																					/* 분기 1번째 월 부가세 */
			         , PAYAMT2																				/* 분기 2번째 월 납부금액 */	
			         , SUPLY_AMOUNT2																		/* 분기 2번째 월 공급가액 */
			         , VAT2																					/* 분기 2번째 월 부가세 */
			         , PAYAMT3																				/* 분기 3번째 월 납부금액 */
			         , SUPLY_AMOUNT3																		/* 분기 3번째 월 공급가액 */
			         , VAT3																					/* 분기 3번째 월 부가세 */
			         , PAYAMT1       + PAYAMT2 + PAYAMT3             AS PAYAMT_SUM							/* 분기 납부금액 합계 */
			         , SUPLY_AMOUNT1 + SUPLY_AMOUNT2 + SUPLY_AMOUNT3 AS SUPLY_AMOUNT_SUM					/* 분기 공급가액 합계 */
			         , VAT1          + VAT2 + VAT3                   AS VAT_SUM								/* 분기 부가세 합계*/
			         , SFSLS_LAD_NM(B.LAD_CODE, 'ALL_LAD_NM')        AS ALL_LAD_NM							/* 토지코드  토지명 */
			         , SFSLS_LAD_NM(B.LAD_CODE, 'LAD_NM')            AS LAD_NM								/* 토지명 */
				FROM TBSLS_LCNTRCTR B         /* 토지계약자 */
			         , (SELECT B.CNTRCTR_NO ,
			                   SUM(B.PAYAMT1)AS PAYAMT1,
			            	   SUM(B.SUPLY_AMOUNT1) AS SUPLY_AMOUNT1,
			                   SUM(B.VAT1) AS VAT1,
			                   SUM(B.PAYAMT2) AS PAYAMT2,
			                   SUM(B.SUPLY_AMOUNT2) AS SUPLY_AMOUNT2,
			                   SUM(B.VAT2) AS VAT2,
			                   SUM(B.PAYAMT3) AS PAYAMT3,
			                   SUM(B.SUPLY_AMOUNT3) AS SUPLY_AMOUNT3,
			             	   SUM(B.VAT3) AS VAT3
			              FROM (SELECT A.CNTRCTR_NO,
			                  		   CASE A.PBLICTE_QU
					                         WHEN '1'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '01', A.PAYAMT, 0)
					                         WHEN '2'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '04', A.PAYAMT, 0)
					                         WHEN '3'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '07', A.PAYAMT, 0)
					                         WHEN '4'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '10', A.PAYAMT, 0)
					                   END AS PAYAMT1 ,
					                   CASE A.PBLICTE_QU
					                         WHEN '1'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'01' , A.SUPLY_AMOUNT , 0)
					                         WHEN '2'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'04' , A.SUPLY_AMOUNT , 0)
					                         WHEN '3'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'07' , A.SUPLY_AMOUNT , 0)
					                         WHEN '4'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'10' , A.SUPLY_AMOUNT , 0)
					                   END AS SUPLY_AMOUNT1 ,
					                   CASE A.PBLICTE_QU
					                         WHEN '1'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '01', A.VAT, 0)
					                         WHEN '2'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '04', A.VAT, 0)
					                         WHEN '3'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '07', A.VAT, 0)
					                         WHEN '4'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '10', A.VAT, 0)
					                   END AS VAT1 ,
					                   CASE A.PBLICTE_QU
					                         WHEN '1'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '02', A.PAYAMT, 0)
					                         WHEN '2'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '05', A.PAYAMT, 0)
					                         WHEN '3'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '08', A.PAYAMT, 0)
					                         WHEN '4'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '11', A.PAYAMT, 0)
					                   END AS PAYAMT2 ,
					                   CASE A.PBLICTE_QU
					                         WHEN '1'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'02' , A.SUPLY_AMOUNT , 0)
					                         WHEN '2'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'05' , A.SUPLY_AMOUNT , 0)
					                         WHEN '3'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'08' , A.SUPLY_AMOUNT , 0)
					                         WHEN '4'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'11' , A.SUPLY_AMOUNT , 0)
					                   END AS SUPLY_AMOUNT2 ,
					                   CASE A.PBLICTE_QU
					                         WHEN '1'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '02', A.VAT, 0)
					                         WHEN '2'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '05', A.VAT, 0)
					                         WHEN '3'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '08', A.VAT, 0)
					                         WHEN '4'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '11', A.VAT, 0)
					                   END AS VAT2 ,
					                   CASE A.PBLICTE_QU
					                         WHEN '1'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '03', A.PAYAMT, 0)
					                         WHEN '2'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '06', A.PAYAMT, 0)
					                         WHEN '3'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '09', A.PAYAMT, 0)
					                         WHEN '4'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '12', A.PAYAMT, 0)
					                   END AS PAYAMT3 ,
					                   CASE A.PBLICTE_QU
					                         WHEN '1'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'03' , A.SUPLY_AMOUNT , 0)
					                         WHEN '2'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'06' , A.SUPLY_AMOUNT , 0)
					                         WHEN '3'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'09' , A.SUPLY_AMOUNT , 0)
					                         WHEN '4'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2) ,'12' , A.SUPLY_AMOUNT , 0)
					                   END AS SUPLY_AMOUNT3 ,
					                   CASE A.PBLICTE_QU
					                         WHEN '1'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '03', A.VAT, 0)
					                         WHEN '2'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '06', A.VAT, 0)
					                         WHEN '3'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '09', A.VAT, 0)
					                         WHEN '4'
					                         THEN DECODE(SUBSTR(A.PBLICTE_DE, 5, 2), '12', A.VAT, 0)
					                   END AS VAT3
					
				                  FROM TBSLS_LAD_VAT A
					             WHERE 1 = 1
					               AND BILL_SE = '1'
								   AND PBLICTE_YEAR = #PBLICTE_YEAR#
								   AND PBLICTE_QU = #PBLICTE_QU#
					            ) B
					      WHERE 1 = 1
					      GROUP BY B.CNTRCTR_NO
					      ORDER BY CNTRCTR_NO
					     ) C
 			       WHERE 1=1
					 AND B.CNTRCTR_NO = C.CNTRCTR_NO
				<isNotEmpty property="LAD_CODE">
					 AND B.LAD_CODE = #LAD_CODE#
				</isNotEmpty>
				<isNotEmpty property="BLCK">
					 AND B.BLCK LIKE '%' || #BLCK# || '%'
				</isNotEmpty>
				<isNotEmpty property="LOT">
					 AND B.LOT LIKE '%' || #LOT# || '%'
				</isNotEmpty>
				<isNotEmpty property="LOT_TY">
				   	 AND B.LOT_TY LIKE '%' || #LOT_TY# || '%'
				</isNotEmpty>
			 
	</select>
	
	
	<!-- 토지부가세 매출조서 조회_old  -->
	<select id="SLS090202DAO.selectLadSellingWtnncList_old" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[
			SELECT A.PAY_CODE
				  , SFCMP_GET_CODENM('LAD0A1', A.PAY_CODE) AS PAY_CODE_NM    	/*납부코드 공통코드 LAD0A1*/ 
			 	  , B.LAD_CODE          										/* 토지코드                           */
			      , B.BLCK || '-' || B.LOT || '-' || B.LOT_TY AS BLT 			/* BLT     */ 
			      , C.CSTMR_NM
			      , E.RENT_GTN 							              			/* 임대보증금        */
				  , TRUNC(TO_NUMBER(E.RENT_GTN) / 1.1) AS SUPLY_AMOUNT
			      , TO_NUMBER(E.RENT_GTN) - TRUNC(TO_NUMBER(E.RENT_GTN) / 1.1) AS VAT   /* 부가세               */
			      
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '1' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '01' THEN A.PAYAMT ELSE 0 END) / 1, 0) AS PAYAMT1
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '1' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '01' THEN A.SUPLY_AMOUNT ELSE 0 END) / 1, 0) AS SUPLY_AMOUNT1
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '1' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '01' THEN A.VAT ELSE 0 END) / 1, 0) AS VAT1
			      
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '1' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '02' THEN A.PAYAMT ELSE 0 END) / 1, 0) AS PAYAMT2
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '1' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '02' THEN A.SUPLY_AMOUNT ELSE 0 END) / 1, 0) AS SUPLY_AMOUNT2
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '1' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '02' THEN A.VAT ELSE 0 END) / 1, 0) AS VAT2
			      
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '1' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '03' THEN A.PAYAMT ELSE 0 END) / 1, 0) AS PAYAMT3
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '1' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '03' THEN A.SUPLY_AMOUNT ELSE 0 END) / 1, 0) AS SUPLY_AMOUNT3
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '1' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '03' THEN A.VAT ELSE 0 END) / 1, 0) AS VAT3
			      
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '1' AND SUBSTR(A.PBLICTE_DE, 5, 2) IN ('01','02','03') THEN A.PAYAMT ELSE 0 END) / 1, 0) AS PAYAMT_SUM1
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '1' AND SUBSTR(A.PBLICTE_DE, 5, 2) IN ('01','02','03') THEN A.SUPLY_AMOUNT ELSE 0 END) / 1, 0) AS SUPLY_AMOUNT_SUM1
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '1' AND SUBSTR(A.PBLICTE_DE, 5, 2) IN ('01','02','03') THEN A.VAT ELSE 0 END) / 1, 0) AS VAT_SUM1
			      
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '2' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '04' THEN A.PAYAMT ELSE 0 END) / 1, 0) AS PAYAMT4
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '2' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '04' THEN A.SUPLY_AMOUNT ELSE 0 END) / 1, 0) AS SUPLY_AMOUNT4
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '2' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '04' THEN A.VAT ELSE 0 END) / 1, 0) AS VAT4
			      
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '2' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '05' THEN A.PAYAMT ELSE 0 END) / 1, 0) AS PAYAMT5
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '2' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '05' THEN A.SUPLY_AMOUNT ELSE 0 END) / 1, 0) AS SUPLY_AMOUNT5
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '2' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '05' THEN A.VAT ELSE 0 END) / 1, 0) AS VAT5
			      
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '2' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '06' THEN A.PAYAMT ELSE 0 END) / 1, 0) AS PAYAMT6
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '2' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '06' THEN A.SUPLY_AMOUNT ELSE 0 END) / 1, 0) AS SUPLY_AMOUNT6
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '2' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '06' THEN A.VAT ELSE 0 END) / 1, 0) AS VAT6
			      
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '2' AND SUBSTR(A.PBLICTE_DE, 5, 2) IN ('04','05','06') THEN A.PAYAMT ELSE 0 END) / 1, 0) AS PAYAMT_SUM2
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '2' AND SUBSTR(A.PBLICTE_DE, 5, 2) IN ('04','05','06') THEN A.SUPLY_AMOUNT ELSE 0 END) / 1, 0) AS SUPLY_AMOUNT_SUM2
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '2' AND SUBSTR(A.PBLICTE_DE, 5, 2) IN ('04','05','06') THEN A.VAT ELSE 0 END) / 1, 0) AS VAT_SUM2
			      
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '3' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '07' THEN A.PAYAMT ELSE 0 END) / 1, 0) AS PAYAMT7
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '3' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '07' THEN A.SUPLY_AMOUNT ELSE 0 END) / 1, 0) AS SUPLY_AMOUNT7
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '3' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '07' THEN A.VAT ELSE 0 END) / 1, 0) AS VAT7
			      
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '3' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '08' THEN A.PAYAMT ELSE 0 END) / 1, 0) AS PAYAMT8
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '3' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '08' THEN A.SUPLY_AMOUNT ELSE 0 END) / 1, 0) AS SUPLY_AMOUNT8
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '3' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '08' THEN A.VAT ELSE 0 END) / 1, 0) AS VAT8
			      
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '3' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '09' THEN A.PAYAMT ELSE 0 END) / 1, 0) AS PAYAMT9
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '3' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '09' THEN A.SUPLY_AMOUNT ELSE 0 END) / 1, 0) AS SUPLY_AMOUNT9
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '3' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '09' THEN A.VAT ELSE 0 END) / 1, 0) AS VAT9
			      
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '3' AND SUBSTR(A.PBLICTE_DE, 5, 2) IN ('07','08','09') THEN A.PAYAMT ELSE 0 END) / 1, 0) AS PAYAMT_SUM3
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '3' AND SUBSTR(A.PBLICTE_DE, 5, 2) IN ('07','08','09') THEN A.SUPLY_AMOUNT ELSE 0 END) / 1, 0) AS SUPLY_AMOUNT_SUM3
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '3' AND SUBSTR(A.PBLICTE_DE, 5, 2) IN ('07','08','09') THEN A.VAT ELSE 0 END) / 1, 0) AS VAT_SUM3
			      
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '4' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '10' THEN A.PAYAMT ELSE 0 END) / 1, 0) AS PAYAMT10
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '4' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '10' THEN A.SUPLY_AMOUNT ELSE 0 END) / 1, 0) AS SUPLY_AMOUNT10
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '4' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '10' THEN A.VAT ELSE 0 END) / 1, 0) AS VAT10
			      
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '4' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '11' THEN A.PAYAMT ELSE 0 END) / 1, 0) AS PAYAMT11
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '4' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '11' THEN A.SUPLY_AMOUNT ELSE 0 END) / 1, 0) AS SUPLY_AMOUNT11
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '4' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '11' THEN A.VAT ELSE 0 END) / 1, 0) AS VAT11
			      
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '4' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '12' THEN A.PAYAMT ELSE 0 END) / 1, 0) AS PAYAMT12
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '4' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '12' THEN A.SUPLY_AMOUNT ELSE 0 END) / 1, 0) AS SUPLY_AMOUNT12
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '4' AND SUBSTR(A.PBLICTE_DE, 5, 2) = '12' THEN A.VAT ELSE 0 END) / 1, 0) AS VAT12
			      
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '4' AND SUBSTR(A.PBLICTE_DE, 5, 2) IN ('10','11','12') THEN A.PAYAMT ELSE 0 END) / 1, 0) AS PAYAMT_SUM4
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '4' AND SUBSTR(A.PBLICTE_DE, 5, 2) IN ('10','11','12') THEN A.SUPLY_AMOUNT ELSE 0 END) / 1, 0) AS SUPLY_AMOUNT_SUM4
			      , TRUNC(SUM(CASE WHEN A.PBLICTE_QU  = '4' AND SUBSTR(A.PBLICTE_DE, 5, 2) IN ('10','11','12') THEN A.VAT ELSE 0 END) / 1, 0) AS VAT_SUM4
			       
			  FROM TBSLS_LAD_VAT A
			       ,TBSLS_LCNTRCTR B /* 토지계약자 */
			       ,TBSLS_LAD_CSTMR C /* 토지고객 */
			       ,TBSLS_LAD_INFO        D /* 토지정보       */
				   ,TBSLS_LAD_DETAIL_INFO E /* 토지정보상세   */
			       
			 WHERE 1 = 1
			   AND A.CNTRCTR_NO = B.CNTRCTR_NO     
			   AND B.LAD_CSTMR_NO = C.LAD_CSTMR_NO
			   AND B.LAD_CODE = D.LAD_CODE
			   AND B.LAD_CODE = E.LAD_CODE
			   AND B.BLCK = E.BLCK
			   AND B.LOT = E.LOT
			   AND B.LOT_TY = E.LOT_TY

		]]>
			   
			<isNotEmpty property="BILL_SE">
			   	AND A.BILL_SE = #BILL_SE#
			</isNotEmpty>
			
			<isNotEmpty property="PBLICTE_YEAR">
			   	AND A.PBLICTE_YEAR = #PBLICTE_YEAR#
			</isNotEmpty>
			
			<!--
			<isNotEmpty property="PBLICTE_QU">
			   	AND A.PBLICTE_QU = #PBLICTE_QU#
			</isNotEmpty>
			-->
			
			<isNotEmpty property="MT_SE">
			   	AND A.MT_SE = #MT_SE#
			</isNotEmpty>
			
			<isNotEmpty property="CNTRCTR_NO">
			   	AND A.CNTRCTR_NO = #CNTRCTR_NO#
			</isNotEmpty>
			
			<isNotEmpty property="PAY_CODE">
			   	AND A.PAY_CODE = #PAY_CODE#
			</isNotEmpty>
			
			<isNotEmpty property="LAD_CODE">
				AND B.LAD_CODE = #LAD_CODE#
			</isNotEmpty>
						
			<isNotEmpty property="BLCK">
			   	AND B.BLCK LIKE '%' || #BLCK# || '%'
			</isNotEmpty>
			
			<isNotEmpty property="LOT">
			   	AND B.LOT LIKE '%' || #LOT# || '%'
			</isNotEmpty>
			
			<isNotEmpty property="LOT_TY">
			   	AND B.LOT_TY LIKE '%' || #LOT_TY# || '%'
			</isNotEmpty>
			
			GROUP BY A.PAY_CODE
			 	  , B.LAD_CODE          				
			      , B.BLCK || '-' || B.LOT || '-' || B.LOT_TY
			      , C.CSTMR_NM
			      , E.RENT_GTN
				  , TRUNC(TO_NUMBER(E.RENT_GTN) / 1.1)
				  , TO_NUMBER(E.RENT_GTN) - TRUNC(TO_NUMBER(E.RENT_GTN) / 1.1)
				  
			ORDER BY B.LAD_CODE, B.BLCK || '-' || B.LOT || '-' || B.LOT_TY, A.PAY_CODE, C.CSTMR_NM
			 
	</select>
	
	
	<!-- 세금계산서_합계 출력 조회  -->
	<select id="SLS090202DAO.selectLadTaxbillSumList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[
					SELECT V1.MIN_DATE
					      ,V1.MAX_DATE
					      ,TO_CHAR(TO_DATE(V1.MIN_DATE), 'YYYY-MM-DD') || ' ~ ' ||
					       TO_CHAR(TO_DATE(V1.MAX_DATE), 'YYYY-MM-DD') AS BETWEEN_DATE2
					      ,DECODE(V1.MIN_DATE
					             ,'01'
					             ,''
					             ,TO_CHAR(TO_DATE(V1.MIN_DATE), 'YYYY-MM-DD')) || ' ~ ' ||
					       DECODE(V1.MAX_DATE
					             ,''
					             ,''
					             ,TO_CHAR(TO_DATE(V1.MAX_DATE), 'YYYY-MM-DD')) AS BETWEEN_DATE
					      ,V1.BIZ_CNT1
					      ,V1.TAX_CNT1
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT1, 1, 1) AS PAY_SUPLY_AMOUNT1_1
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT1, 2, 1) AS PAY_SUPLY_AMOUNT1_2
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT1, 3, 1) AS PAY_SUPLY_AMOUNT1_3
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT1, 4, 1) AS PAY_SUPLY_AMOUNT1_4
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT1, 5, 1) AS PAY_SUPLY_AMOUNT1_5
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT1, 6, 1) AS PAY_SUPLY_AMOUNT1_6
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT1, 7, 1) AS PAY_SUPLY_AMOUNT1_7
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT1, 8, 1) AS PAY_SUPLY_AMOUNT1_8
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT1, 9, 1) AS PAY_SUPLY_AMOUNT1_9
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT1, 10, 1) AS PAY_SUPLY_AMOUNT1_10
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT1, 11, 1) AS PAY_SUPLY_AMOUNT1_11
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT1, 12, 1) AS PAY_SUPLY_AMOUNT1_12
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT1, 13, 1) AS PAY_SUPLY_AMOUNT1_13
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT1, 14, 1) AS PAY_SUPLY_AMOUNT1_14
					      ,SUBSTR(V1.TOT_VAT1, 1, 1) AS PAY_VAT1_1
					      ,SUBSTR(V1.TOT_VAT1, 2, 1) AS PAY_VAT1_2
					      ,SUBSTR(V1.TOT_VAT1, 3, 1) AS PAY_VAT1_3
					      ,SUBSTR(V1.TOT_VAT1, 4, 1) AS PAY_VAT1_4
					      ,SUBSTR(V1.TOT_VAT1, 5, 1) AS PAY_VAT1_5
					      ,SUBSTR(V1.TOT_VAT1, 6, 1) AS PAY_VAT1_6
					      ,SUBSTR(V1.TOT_VAT1, 7, 1) AS PAY_VAT1_7
					      ,SUBSTR(V1.TOT_VAT1, 8, 1) AS PAY_VAT1_8
					      ,SUBSTR(V1.TOT_VAT1, 9, 1) AS PAY_VAT1_9
					      ,SUBSTR(V1.TOT_VAT1, 10, 1) AS PAY_VAT1_10
					      ,SUBSTR(V1.TOT_VAT1, 11, 1) AS PAY_VAT1_11
					      ,SUBSTR(V1.TOT_VAT1, 12, 1) AS PAY_VAT1_12
					      ,SUBSTR(V1.TOT_VAT1, 13, 1) AS PAY_VAT1_13
					       
					      ,V1.BIZ_CNT2
					      ,V1.TAX_CNT2
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT2, 1, 1) AS PAY_SUPLY_AMOUNT2_1
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT2, 2, 1) AS PAY_SUPLY_AMOUNT2_2
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT2, 3, 1) AS PAY_SUPLY_AMOUNT2_3
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT2, 4, 1) AS PAY_SUPLY_AMOUNT2_4
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT2, 5, 1) AS PAY_SUPLY_AMOUNT2_5
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT2, 6, 1) AS PAY_SUPLY_AMOUNT2_6
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT2, 7, 1) AS PAY_SUPLY_AMOUNT2_7
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT2, 8, 1) AS PAY_SUPLY_AMOUNT2_8
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT2, 9, 1) AS PAY_SUPLY_AMOUNT2_9
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT2, 10, 1) AS PAY_SUPLY_AMOUNT2_10
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT2, 11, 1) AS PAY_SUPLY_AMOUNT2_11
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT2, 12, 1) AS PAY_SUPLY_AMOUNT2_12
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT2, 13, 1) AS PAY_SUPLY_AMOUNT2_13
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT2, 14, 1) AS PAY_SUPLY_AMOUNT2_14
					      ,SUBSTR(V1.TOT_VAT2, 1, 1) AS PAY_VAT2_1
					      ,SUBSTR(V1.TOT_VAT2, 2, 1) AS PAY_VAT2_2
					      ,SUBSTR(V1.TOT_VAT2, 3, 1) AS PAY_VAT2_3
					      ,SUBSTR(V1.TOT_VAT2, 4, 1) AS PAY_VAT2_4
					      ,SUBSTR(V1.TOT_VAT2, 5, 1) AS PAY_VAT2_5
					      ,SUBSTR(V1.TOT_VAT2, 6, 1) AS PAY_VAT2_6
					      ,SUBSTR(V1.TOT_VAT2, 7, 1) AS PAY_VAT2_7
					      ,SUBSTR(V1.TOT_VAT2, 8, 1) AS PAY_VAT2_8
					      ,SUBSTR(V1.TOT_VAT2, 9, 1) AS PAY_VAT2_9
					      ,SUBSTR(V1.TOT_VAT2, 10, 1) AS PAY_VAT2_10
					      ,SUBSTR(V1.TOT_VAT2, 11, 1) AS PAY_VAT2_11
					      ,SUBSTR(V1.TOT_VAT2, 12, 1) AS PAY_VAT2_12
					      ,SUBSTR(V1.TOT_VAT2, 13, 1) AS PAY_VAT2_13
					      ,V1.BIZ_CNT3
					      ,V1.TAX_CNT3
					      ,V1.T_AMT3
					      ,V1.T_VAT3
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT3, 1, 1) AS PAY_SUPLY_AMOUNT3_1
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT3, 2, 1) AS PAY_SUPLY_AMOUNT3_2
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT3, 3, 1) AS PAY_SUPLY_AMOUNT3_3
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT3, 4, 1) AS PAY_SUPLY_AMOUNT3_4
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT3, 5, 1) AS PAY_SUPLY_AMOUNT3_5
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT3, 6, 1) AS PAY_SUPLY_AMOUNT3_6
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT3, 7, 1) AS PAY_SUPLY_AMOUNT3_7
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT3, 8, 1) AS PAY_SUPLY_AMOUNT3_8
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT3, 9, 1) AS PAY_SUPLY_AMOUNT3_9
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT3, 10, 1) AS PAY_SUPLY_AMOUNT3_10
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT3, 11, 1) AS PAY_SUPLY_AMOUNT3_11
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT3, 12, 1) AS PAY_SUPLY_AMOUNT3_12
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT3, 13, 1) AS PAY_SUPLY_AMOUNT3_13
					      ,SUBSTR(V1.TOT_SUPLY_AMOUNT3, 14, 1) AS PAY_SUPLY_AMOUNT3_14
					      ,SUBSTR(V1.TOT_VAT3, 1, 1) AS PAY_VAT3_1
					      ,SUBSTR(V1.TOT_VAT3, 2, 1) AS PAY_VAT3_2
					      ,SUBSTR(V1.TOT_VAT3, 3, 1) AS PAY_VAT3_3
					      ,SUBSTR(V1.TOT_VAT3, 4, 1) AS PAY_VAT3_4
					      ,SUBSTR(V1.TOT_VAT3, 5, 1) AS PAY_VAT3_5
					      ,SUBSTR(V1.TOT_VAT3, 6, 1) AS PAY_VAT3_6
					      ,SUBSTR(V1.TOT_VAT3, 7, 1) AS PAY_VAT3_7
					      ,SUBSTR(V1.TOT_VAT3, 8, 1) AS PAY_VAT3_8
					      ,SUBSTR(V1.TOT_VAT3, 9, 1) AS PAY_VAT3_9
					      ,SUBSTR(V1.TOT_VAT3, 10, 1) AS PAY_VAT3_10
					      ,SUBSTR(V1.TOT_VAT3, 11, 1) AS PAY_VAT3_11
					      ,SUBSTR(V1.TOT_VAT3, 12, 1) AS PAY_VAT3_12
					      ,SUBSTR(V1.TOT_VAT3, 13, 1) AS PAY_VAT3_13
					      ,S.*
					
					  FROM (SELECT MAX(V.MIN_DATE) AS MIN_DATE
					              ,MAX(V.MAX_DATE) AS MAX_DATE
					              ,SUM(V.BIZ_CNT1) AS BIZ_CNT1
					              ,SUM(V.TAX_CNT1) AS TAX_CNT1
					              ,LPAD(SUM(V.TOT_SUPLY_AMOUNT1), 14, '*') AS TOT_SUPLY_AMOUNT1
					              ,LPAD(SUM(V.TOT_VAT1), 13, '*') AS TOT_VAT1
					              ,SUM(V.BIZ_CNT2) AS BIZ_CNT2
					              ,SUM(V.TAX_CNT2) AS TAX_CNT2
					              ,LPAD(SUM(V.TOT_SUPLY_AMOUNT2), 14, '*') AS TOT_SUPLY_AMOUNT2
					              ,LPAD(SUM(V.TOT_VAT2), 13, '*') AS TOT_VAT2
					              ,SUM(V.BIZ_CNT3) AS BIZ_CNT3
					              ,SUM(V.TAX_CNT3) AS TAX_CNT3
					              ,LPAD(SUM(V.TOT_SUPLY_AMOUNT3), 14, '*') AS TOT_SUPLY_AMOUNT3
					              ,LPAD(SUM(V.TOT_VAT3), 13, '*') AS TOT_VAT3
					              ,SUM(V.TOT_SUPLY_AMOUNT3) AS T_AMT3
					              ,SUM(V.TOT_VAT3) AS T_VAT3
					        
					          FROM (SELECT SUBSTR(MIN(A.PBLICTE_DE), 0, 6) || '01' AS MIN_DATE
					                      ,MAX(A.PBLICTE_DE) AS MAX_DATE
					                      ,COUNT(DISTINCT CNTRCTR_NO) AS BIZ_CNT1
					                      ,COUNT(1) AS TAX_CNT1
					                      ,SUM(SUPLY_AMOUNT) AS TOT_SUPLY_AMOUNT1
					                      ,SUM(VAT) AS TOT_VAT1
					                      ,0 AS BIZ_CNT2
					                      ,0 AS TAX_CNT2
					                      ,0 AS TOT_SUPLY_AMOUNT2
					                      ,0 AS TOT_VAT2
					                      ,0 AS BIZ_CNT3
					                      ,0 AS TAX_CNT3
					                      ,0 AS TOT_SUPLY_AMOUNT3
					                      ,0 AS TOT_VAT3
					                
					                  FROM TBSLS_LAD_VAT A /* 토지부가세 */
					                 WHERE A.PBLICTE_YEAR = #PBLICTE_YEAR#
					                   AND A.PBLICTE_QU = #PBLICTE_QU#
					                
					                UNION ALL
					                
					                SELECT NULL AS MIN_DATE
					                      ,NULL AS MAX_DATE
					                      ,0 AS BIZ_CNT1
					                      ,0 AS TAX_CNT1
					                      ,0 AS TOT_SUPLY_AMOUNT1
					                      ,0 AS TOT_VAT1
					                      ,COUNT(DISTINCT CNTRCTR_NO) BIZ_CNT2
					                      ,COUNT(1) AS TAX_CNT2
					                      ,SUM(SUPLY_AMOUNT) AS TOT_SUPLY_AMOUNT2
					                      ,SUM(VAT) AS TOT_VAT2
					                      ,0 AS BIZ_CNT3
					                      ,0 AS TAX_CNT3
					                      ,0 AS TOT_SUPLY_AMOUNT3
					                      ,0 AS TOT_VAT3
					                
					                  FROM TBSLS_LAD_VAT A /* 토지부가세 */
					                 WHERE A.PBLICTE_YEAR = #PBLICTE_YEAR#
					                   AND A.PBLICTE_QU = #PBLICTE_QU#
					                   AND A.PBLICTE_DE >= (CASE
					                         WHEN SUBSTR(A.PBLICTE_DE, 5, 2) >= '01' AND
					                              SUBSTR(A.PBLICTE_DE, 5, 2) <= '03' THEN
					                          SUBSTR(A.PBLICTE_DE, 0, 4) || '0101'
					                         WHEN SUBSTR(A.PBLICTE_DE, 5, 2) >= '04' AND
					                              SUBSTR(A.PBLICTE_DE, 5, 2) <= '06' THEN
					                          SUBSTR(A.PBLICTE_DE, 0, 4) || '0401'
					                         WHEN SUBSTR(A.PBLICTE_DE, 5, 2) >= '07' AND
					                              SUBSTR(A.PBLICTE_DE, 5, 2) <= '09' THEN
					                          SUBSTR(A.PBLICTE_DE, 0, 4) || '0701'
					                         WHEN SUBSTR(A.PBLICTE_DE, 5, 2) >= '10' AND
					                              SUBSTR(A.PBLICTE_DE, 5, 2) <= '12' THEN
					                          SUBSTR(A.PBLICTE_DE, 0, 4) || '1001'
					                       END)
					                
					                UNION ALL
					                
					                SELECT NULL AS MIN_DATE
					                      ,NULL AS MAX_DATE
					                      ,0 AS BIZ_CNT1
					                      ,0 AS TAX_CNT1
					                      ,0 AS TOT_SUPLY_AMOUNT1
					                      ,0 AS TOT_VAT1
					                      ,0 AS BIZ_CNT2
					                      ,0 AS TAX_CNT2
					                      ,0 AS TOT_SUPLY_AMOUNT2
					                      ,0 AS TOT_VAT2
					                      ,COUNT(DISTINCT CNTRCTR_NO) BIZ_CNT3
					                      ,COUNT(1) AS TAX_CNT3
					                      ,SUM(SUPLY_AMOUNT) AS TOT_SUPLY_AMOUNT3
					                      ,SUM(VAT) AS TOT_VAT3
					                
					                  FROM TBSLS_LAD_VAT A /* 토지부가세 */
					                
					                 WHERE A.PBLICTE_YEAR = #PBLICTE_YEAR#
					                   AND A.PBLICTE_QU = #PBLICTE_QU#
					                   AND A.PBLICTE_DE >= (CASE
					                         WHEN SUBSTR(A.PBLICTE_DE, 5, 2) >= '01' AND
					                              SUBSTR(A.PBLICTE_DE, 5, 2) <= '03' THEN
					                          SUBSTR(A.PBLICTE_DE, 0, 4) || '0101'
					                         WHEN SUBSTR(A.PBLICTE_DE, 5, 2) >= '04' AND
					                              SUBSTR(A.PBLICTE_DE, 5, 2) <= '06' THEN
					                          SUBSTR(A.PBLICTE_DE, 0, 4) || '0401'
					                         WHEN SUBSTR(A.PBLICTE_DE, 5, 2) >= '07' AND
					                              SUBSTR(A.PBLICTE_DE, 5, 2) <= '09' THEN
					                          SUBSTR(A.PBLICTE_DE, 0, 4) || '0701'
					                         WHEN SUBSTR(A.PBLICTE_DE, 5, 2) >= '10' AND
					                              SUBSTR(A.PBLICTE_DE, 5, 2) <= '12' THEN
					                          SUBSTR(A.PBLICTE_DE, 0, 4) || '1001'
					                       END)
					                
					                ) V) V1
					      ,TBPMS_CPR_INFO S /*법인정보*/
		]]>
			 
	</select>
	
	<!-- 세금계산서_합계 출력 상세조회  -->
	<select id="SLS090202DAO.selectLadTaxbillSumDetailList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[
					SELECT B.BIZRNO
					      ,C.LAD_CODE
					      ,C.BLCK
					      ,C.LOT
					      ,B.BLANK
					      ,B.TAX_CNT
					      ,B.SUPLY_AMOUNT AS PAY_SUPLY_AMOUNT
					      ,B.VAT AS PAY_VAT
					      ,V.MTLTY_NM
					      ,V.BIZCND
					      ,V.INDUTY
					      ,SUBSTR(B.SUPLY_AMOUNT, 1, 1) AS PAY_SUPLY_AMOUNT_1
					      ,SUBSTR(B.SUPLY_AMOUNT, 2, 1) AS PAY_SUPLY_AMOUNT_2
					      ,SUBSTR(B.SUPLY_AMOUNT, 3, 1) AS PAY_SUPLY_AMOUNT_3
					      ,SUBSTR(B.SUPLY_AMOUNT, 4, 1) AS PAY_SUPLY_AMOUNT_4
					      ,SUBSTR(B.SUPLY_AMOUNT, 5, 1) AS PAY_SUPLY_AMOUNT_5
					      ,SUBSTR(B.SUPLY_AMOUNT, 6, 1) AS PAY_SUPLY_AMOUNT_6
					      ,SUBSTR(B.SUPLY_AMOUNT, 7, 1) AS PAY_SUPLY_AMOUNT_7
					      ,SUBSTR(B.SUPLY_AMOUNT, 8, 1) AS PAY_SUPLY_AMOUNT_8
					      ,SUBSTR(B.SUPLY_AMOUNT, 9, 1) AS PAY_SUPLY_AMOUNT_9
					      ,SUBSTR(B.SUPLY_AMOUNT, 10, 1) AS PAY_SUPLY_AMOUNT_10
					      ,SUBSTR(B.SUPLY_AMOUNT, 11, 1) AS PAY_SUPLY_AMOUNT_11
					      ,SUBSTR(B.SUPLY_AMOUNT, 12, 1) AS PAY_SUPLY_AMOUNT_12
					      ,SUBSTR(B.SUPLY_AMOUNT, 13, 1) AS PAY_SUPLY_AMOUNT_13
					      ,SUBSTR(B.SUPLY_AMOUNT, 14, 1) AS PAY_SUPLY_AMOUNT_14
					      ,SUBSTR(B.VAT, 1, 1) AS PAY_VAT_1
					      ,SUBSTR(B.VAT, 2, 1) AS PAY_VAT_2
					      ,SUBSTR(B.VAT, 3, 1) AS PAY_VAT_3
					      ,SUBSTR(B.VAT, 4, 1) AS PAY_VAT_4
					      ,SUBSTR(B.VAT, 5, 1) AS PAY_VAT_5
					      ,SUBSTR(B.VAT, 6, 1) AS PAY_VAT_6
					      ,SUBSTR(B.VAT, 7, 1) AS PAY_VAT_7
					      ,SUBSTR(B.VAT, 8, 1) AS PAY_VAT_8
					      ,SUBSTR(B.VAT, 9, 1) AS PAY_VAT_9
					      ,SUBSTR(B.VAT, 10, 1) AS PAY_VAT_10
					      ,SUBSTR(B.VAT, 11, 1) AS PAY_VAT_11
					      ,SUBSTR(B.VAT, 12, 1) AS PAY_VAT_12
					      ,SUBSTR(B.VAT, 13, 1) AS PAY_VAT_13
					
					  FROM TBSLS_LCNTRCTR C /* 토지계약자 */
					      ,(SELECT BIZRNO
					              ,COUNT(1) AS TAX_CNT
					              ,14 - LENGTH(SUM(SUPLY_AMOUNT)) AS BLANK
					              ,LPAD(SUM(SUPLY_AMOUNT), 14, '*') AS SUPLY_AMOUNT
					              ,LPAD(SUM(VAT), 13, '*') AS VAT
					        
					          FROM TBSLS_LAD_VAT A /* 토지부가세 */
					             , TBSLS_LCNTRCTR_BSNM B /* 토지계약자사업자 */
					         WHERE A.PBLICTE_YEAR = #PBLICTE_YEAR#
					           AND A.PBLICTE_QU = #PBLICTE_QU#
					           AND A.CNTRCTR_NO = B.CNTRCTR_NO(+)
					           AND EXISTS (SELECT 1
					                  FROM TBSLS_LCNTRCTR_BSNM D
					                 WHERE A.CNTRCTR_NO = D.CNTRCTR_NO
					                   AND D.BIZRNO IS NOT NULL
					                   AND A.PBLICTE_DE >= (CASE
					                         WHEN SUBSTR(A.PBLICTE_DE, 5, 2) >= '01' AND
					                              SUBSTR(A.PBLICTE_DE, 5, 2) <= '03' THEN
					                          SUBSTR(A.PBLICTE_DE, 0, 4) || '0101'
					                         WHEN SUBSTR(A.PBLICTE_DE, 5, 2) >= '04' AND
					                              SUBSTR(A.PBLICTE_DE, 5, 2) <= '06' THEN
					                          SUBSTR(A.PBLICTE_DE, 0, 4) || '0401'
					                         WHEN SUBSTR(A.PBLICTE_DE, 5, 2) >= '07' AND
					                              SUBSTR(A.PBLICTE_DE, 5, 2) <= '09' THEN
					                          SUBSTR(A.PBLICTE_DE, 0, 4) || '0701'
					                         WHEN SUBSTR(A.PBLICTE_DE, 5, 2) >= '10' AND
					                              SUBSTR(A.PBLICTE_DE, 5, 2) <= '12' THEN
					                          SUBSTR(A.PBLICTE_DE, 0, 4) || '1001'
					                       END))
					        
					         GROUP BY BIZRNO) B
					      ,(SELECT V1.*
					          FROM TBSLS_LCNTRCTR_BSNM V1 /* 토지계약자사업자 */
					              ,TBSLS_LCNTRCTR      C1 /* 토지계약자 */
					         WHERE V1.CNTRCTR_NO = C1.CNTRCTR_NO
					           AND V1.LAD_CSTMR_NO = C1.LAD_CSTMR_NO
					           AND C1.BLCK || C1.LOT || C1.LOT_TY =
					               (SELECT MIN(C2.BLCK || C2.LOT || C2.LOT_TY)
					                  FROM TBSLS_LCNTRCTR_BSNM V2, TBSLS_LCNTRCTR C2
					                 WHERE V2.CNTRCTR_NO = C2.CNTRCTR_NO
					                   AND V2.LAD_CSTMR_NO = C2.LAD_CSTMR_NO
					                   AND V2.BIZRNO = V1.BIZRNO)
					        
					        ) V
					
					 WHERE C.CNTRCTR_NO = V.CNTRCTR_NO
					   AND B.BIZRNO = V.BIZRNO(+)
					 ORDER BY C.LAD_CODE, C.BLCK, C.LOT, C.LOT_TY
		]]>
			 
	</select>
	
	
	<!-- 세금계산서_개별 출력 조회  -->
	<select id="SLS090202DAO.selectLadTaxbillIndvdlzList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[
					SELECT NVL(V.CHG_NAME, CC.CSTMR_NM) AS CSTMR_NM
					      ,CASE
					         WHEN V.LAST_DAY >= TO_CHAR((V.BSNS_CONFM_DE - 20), 'YYYY-MM-DD') THEN
					          CASE
					            WHEN V.BIZ_NO IS NULL THEN
					             NVL(V.CHG_PRSN, CC.IHIDNUM)
					            ELSE
					             SUBSTR(REPLACE(V.BIZ_NO, '-', ''), 1, 3) || '-' ||
					             SUBSTR(REPLACE(V.BIZ_NO, '-', ''), 4, 2) || '-' ||
					             SUBSTR(REPLACE(V.BIZ_NO, '-', ''), 6, 5)
					          END
					         ELSE
					          NVL(V.CHG_PRSN, CC.IHIDNUM)
					       END AS RBIZ_NO
					      ,CASE
					         WHEN V.LAST_DAY >= TO_CHAR((V.BSNS_CONFM_DE - 20), 'YYYY-MM-DD') THEN
					          V.CORP_NM
					       END AS RCORP_NAME
					      ,NVL(V.BIZ_OWNER_NM, NVL(V.CHG_NAME, CC.CSTMR_NM)) AS ROWNER_NM
					      ,CASE
					         WHEN V.LAST_DAY >= TO_CHAR((V.BSNS_CONFM_DE - 20), 'YYYY-MM-DD') THEN
					          V1.BIZCND
					         ELSE
					          ''
					       END AS RBIZCND
					      ,CASE
					         WHEN V.LAST_DAY >= TO_CHAR((V.BSNS_CONFM_DE - 20), 'YYYY-MM-DD') THEN
					          V1.INDUTY
					         ELSE
					          ''
					       END AS RINDUTY
					      ,NVL(V.BIZ_ADDR, NVL(V.CHG_ADDR, CC.ADRES || ' ' || CC.ADRES_DETAIL)) AS RADDR
					      ,A.LAD_NM AS RADDR1
					      ,(SELECT CODE_NM
					          FROM TBCOM_CMMN_CODE /* 공통코드 */
					         WHERE GRP_CODE = 'LAD0A1'
					           AND CODE = V.PAY_CODE) AS PAY_CODE_NM
					      ,V.RQEST_SE
					      ,V.LAST_DAY
					      ,V.SUPLY_AMOUNT AS PAY_SUPLY_AMOUNT
					      ,V.VAT AS PAY_VAT
					      ,V.TOTAL
					      ,V.BLANK
					      ,SUBSTR(V.SUPLY_AMOUNT1, 1, 1) AS PAY_SUPLY_AMOUNT_1
					      ,SUBSTR(V.SUPLY_AMOUNT1, 2, 1) AS PAY_SUPLY_AMOUNT_2
					      ,SUBSTR(V.SUPLY_AMOUNT1, 3, 1) AS PAY_SUPLY_AMOUNT_3
					      ,SUBSTR(V.SUPLY_AMOUNT1, 4, 1) AS PAY_SUPLY_AMOUNT_4
					      ,SUBSTR(V.SUPLY_AMOUNT1, 5, 1) AS PAY_SUPLY_AMOUNT_5
					      ,SUBSTR(V.SUPLY_AMOUNT1, 6, 1) AS PAY_SUPLY_AMOUNT_6
					      ,SUBSTR(V.SUPLY_AMOUNT1, 7, 1) AS PAY_SUPLY_AMOUNT_7
					      ,SUBSTR(V.SUPLY_AMOUNT1, 8, 1) AS PAY_SUPLY_AMOUNT_8
					      ,SUBSTR(V.SUPLY_AMOUNT1, 9, 1) AS PAY_SUPLY_AMOUNT_9
					      ,SUBSTR(V.SUPLY_AMOUNT1, 10, 1) AS PAY_SUPLY_AMOUNT_10
					      ,SUBSTR(V.VAT1, 1, 1) AS PAY_VAT_1
					      ,SUBSTR(V.VAT1, 2, 1) AS PAY_VAT_2
					      ,SUBSTR(V.VAT1, 3, 1) AS PAY_VAT_3
					      ,SUBSTR(V.VAT1, 4, 1) AS PAY_VAT_4
					      ,SUBSTR(V.VAT1, 5, 1) AS PAY_VAT_5
					      ,SUBSTR(V.VAT1, 6, 1) AS PAY_VAT_6
					      ,SUBSTR(V.VAT1, 7, 1) AS PAY_VAT_7
					      ,SUBSTR(V.VAT1, 8, 1) AS PAY_VAT_8
					      ,SUBSTR(V.VAT1, 9, 1) AS PAY_VAT_9
					      ,S.*
					
					  FROM (SELECT CNTRCTR_NO
					              ,TO_CHAR(TO_DATE(PBLICTE_DE), 'YYYY-MM-DD') AS LAST_DAY
					              ,SUPLY_AMOUNT AS SUPLY_AMOUNT
					              ,VAT AS VAT
					              ,SUPLY_AMOUNT + VAT AS TOTAL
					              ,LPAD(SUPLY_AMOUNT, 10, '*') AS SUPLY_AMOUNT1
					              ,LPAD(VAT, 9, '*') AS VAT1
					              ,14 - LENGTH(SUPLY_AMOUNT) AS BLANK
					              ,PAY_CODE AS PAY_CODE
					              ,RQEST_SE 
					              ,TO_DATE(SFSLS_BIZ_INFO('1', A.CNTRCTR_NO, A.PBLICTE_DE)) AS BSNS_CONFM_DE
					              ,SUBSTR(SFSLS_BIZ_INFO('2', A.CNTRCTR_NO, A.PBLICTE_DE)
					                     ,1
					                     ,100) AS BIZ_NO
					              ,SUBSTR(SFSLS_BIZ_INFO('3', A.CNTRCTR_NO, A.PBLICTE_DE)
					                     ,1
					                     ,100) AS CORP_NM
					              ,SUBSTR(SFSLS_BIZ_INFO('4', A.CNTRCTR_NO, A.PBLICTE_DE)
					                     ,1
					                     ,100) AS BIZ_OWNER_NM
					              ,SUBSTR(SFSLS_BIZ_INFO('5', A.CNTRCTR_NO, A.PBLICTE_DE)
					                     ,1
					                     ,100) AS BIZCND
					              ,SUBSTR(SFSLS_BIZ_INFO('6', A.CNTRCTR_NO, A.PBLICTE_DE)
					                     ,1
					                     ,100) AS INDUTY
					              ,SUBSTR(SFSLS_BIZ_INFO('7', A.CNTRCTR_NO, A.PBLICTE_DE)
					                     ,1
					                     ,100) AS BIZ_ADDR
					              ,SUBSTR(SFSLS_BIZ_INFO('8', A.CNTRCTR_NO, A.PBLICTE_DE)
					                     ,1
					                     ,100) AS CHG_NAME
					              ,SUBSTR(SFSLS_BIZ_INFO('9', A.CNTRCTR_NO, A.PBLICTE_DE)
					                     ,1
					                     ,100) AS CHG_ADDR
					              ,SUBSTR(SFSLS_BIZ_INFO('10', A.CNTRCTR_NO, A.PBLICTE_DE)
					                     ,1
					                     ,100) AS CHG_PRSN
					        
					          FROM TBSLS_LAD_VAT A /* 토지부가세 */
					         WHERE A.PBLICTE_YEAR = #PBLICTE_YEAR#
					           AND A.PBLICTE_QU = #PBLICTE_QU#
					           AND A.BILL_SE  = '1'
					           AND A.RQEST_SE = #RQEST_SE# ) V /* 청구구분(1:청구, 2:영수)  */
					           
					      ,TBPMS_CPR_INFO S /*법인정보 */
					      ,TBSLS_LCNTRCTR_BSNM V1 /* 토지계약자사업자 */
					      ,TBSLS_LAD_INFO A /* 토지정보 */
					      ,TBSLS_LCNTRCTR C /* 토지계약자 */
					      ,TBSLS_LAD_CSTMR CC /* 토지고객 */
					      
					 WHERE V.CNTRCTR_NO = V1.CNTRCTR_NO(+)
					   AND V.CNTRCTR_NO = C.CNTRCTR_NO
					   AND C.LAD_CODE = A.LAD_CODE
					   AND V.SUPLY_AMOUNT > 0
					      
					   AND C.LAD_CSTMR_NO = CC.LAD_CSTMR_NO
			 
		]]>
		
				<!-- 개별 시작 -->   
				<isNotEmpty property="LAD_CODE">
					 AND C.LAD_CODE = #LAD_CODE#
				</isNotEmpty>
				
				<isNotEmpty property="CNTRCTR_NO">
					 AND C.CNTRCTR_NO = #CNTRCTR_NO#
				</isNotEmpty>
				<!-- 개별 끝 -->
			 
			ORDER BY C.LAD_CODE, C.BLCK, C.LOT, C.LOT_TY, V.PAY_CODE
			
	</select>
	
	
	<!-- 전자세금계산서 조회  -->
	<select id="SLS090202DAO.selectLadElecTaxbillList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[
			    SELECT DISTINCT A.CNTRCTR_NO 
					   , '01'                        	  				AS TAX_KIND 			/* 전자세금계산서종류 */
				       , TO_CHAR(SYSDATE, 'YYYYMMDD')					AS MADE_DATE			/* 작성일자 */
				       , REPLACE(E.BIZRNO, '-', '') 					AS OWNER_BIZ_NO 		/* 공급자등록번호 */
				       , ''                         					AS OWNER_SUB_BIZ_NO 	/* 공급자종사업장번호 */
				       , E.MTLTY                     					AS OWNER_CORP_NAME 		/* 공급자상호 */
				       , E.RPRSNTV                   					AS OWNERER_NAME			/* 공급자성명 */
				       , E.ADRES                     					AS OWNER_ADDR 			/* 공급자사업장주소 */
				       , E.BIZCND                    					AS OWNER_BIZCND 		/* 공급자업태 */
				       , E.ITEM                      					AS OWNER_INDUTY 		/* 공급자종목 */
					   , E.EMAIL                     					AS OWNER_EMAIL 			/* 공급자이메일 */
					   , B.BIZRNO										AS RBIZ_NO				/* 공급받는자등록번호 */
				       , ''												AS RBIZ_SUB_NO			/* 공급받는자종사업장번호 */
				       , B.MTLTY_NM										AS RCORP_NAME 			/* 공급받는자상호 */
				       , C.CSTMR_NM										AS ROWNERER_NM			/* 공급받는자성명 */
				       , B.ADRES || ' ' || B.ADRES_DETAIL 				AS RADDR1				/* 공급받는자사업장주소 */
				       , B.BIZCND										AS RBIZCND				/* 공급받는자업태 */
				       , B.INDUTY										AS RINDUTY				/* 공급받는자종목 */
				       , C.EMAIL										AS C_EMAIL				/* 공급받는자이메일1 */
				       , ''												AS C_EMAIL2				/* 공급받는자이메일2 */
				       , D.SUPLY_AMOUNT									AS PAY_SUPLY_AMOUNT		/* 공급받는자공급가액 */
				       , D.VAT											AS PAY_VAT				/* 공급받는자세액 */
				       , TO_CHAR(SYSDATE, 'DD')							AS LASTDAY				/* 일자1 */
				       , DECODE(D.PAY_CODE, '','기타납부',
				       					(SELECT CODE_NM
				      					   FROM TBCOM_CMMN_CODE        
								          WHERE GRP_CODE = 'LAD0A1'
								            AND CODE     = D.PAY_CODE
				          ))											AS PAY_CODE_NM			/* 품목1 */
					   , #RQEST_SE# 									AS TAX_KIND1			/* 영수/청구  */
				  FROM TBSLS_LCNTRCTR A
					   , TBSLS_LCNTRCTR_BSNM B
					   , TBSLS_LAD_CSTMR C
					   , (SELECT 
					             A.CNTRCTR_NO
					             ,PAYAMT AS PAYAMT
					             ,PAY_SUPLY_AMOUNT AS SUPLY_AMOUNT
					             ,PAY_VAT AS VAT
					             ,PAY_CODE
				        	FROM TBSLS_LCNTRCTR_PAY A
				             	 , TBSLS_LCNTRCTR B
				           WHERE 1=1
				         	 AND A.CNTRCTR_NO = B.CNTRCTR_NO
				         	 AND B.CNTRCT_TY = 'RN'
				         	 AND A.PAY_CODE = 'RN'
				         	 AND A.LTTOT_RENT_SE = 'R'	
				          	 AND B.CANCL_DE IS NULL
				          	 AND SUBSTR(MDAT_DE,0,6) = #PBLICTE_MONTH#
				          	 
					 UNION ALL
				
				          SELECT 
				                 A.CNTRCTR_NO
				              	 , SUM(PAYAMT) AS PAYAMT
				              	 , SUM(PAY_SUPLY_AMOUNT) AS SUPLY_AMOUNT
				              	 , SUM(PAY_VAT) AS VAT
				              	 , NULL AS PAY_CODE
				       	    FROM
				            	 TBSLS_ETC_INCME_PAY A
				             	 , TBSLS_LCNTRCTR B
				           WHERE 1=1
				          	 AND A.CNTRCTR_NO = B.CNTRCTR_NO
				          	 AND A.JOB_SE = 'LAD'
				          	 AND B.CANCL_DE IS NULL
				          	 AND (BILL_OUTPT_AT = '1' OR TAXBIL_OUTPT_AT = '1')
				          	 AND SUBSTR(A.PAY_TMLMT,0,6) = #PBLICTE_MONTH#
				           GROUP BY A.CNTRCTR_NO
				           ORDER BY CNTRCTR_NO
				       ) D
				       , TBPMS_CPR_INFO E
				 WHERE 1=1
				   AND A.CNTRCTR_NO = B.CNTRCTR_NO
				   AND A.CNTRCTR_NO = D.CNTRCTR_NO
				   AND b.LAD_CSTMR_NO = C.LAD_CSTMR_NO
				   AND D.SUPLY_AMOUNT > 0
				   
		]]>
				<isNotEmpty property="LAD_CODE">
				   AND C.LAD_CODE = #LAD_CODE#
				</isNotEmpty>
				 ORDER BY CNTRCTR_NO
						
	</select>
	
	
	<!-- 부동산임대공급가액 명세서 조회  -->
	<select id="SLS090202DAO.selectLadRentSupplyBillList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[
					SELECT '0' AS CHK
						  ,(SELECT BIZRNO
					          FROM TBSLS_LCNTRCTR_BSNM
					         WHERE CNTRCTR_NO = A.CNTRCTR_NO) AS BIZRNO
					      ,(SELECT CSTMR_NM
					          FROM TBSLS_LAD_CSTMR S
					         WHERE S.LAD_CSTMR_NO = B.LAD_CSTMR_NO) AS LAD_CSTMR_NM
					      ,'지상 1' AS FLOOR
					      ,(B.BLCK || '-' || B.LOT) AS BLCK_LOT
					      ,(SELECT DCSN_AR
					          FROM TBSLS_LAD_DETAIL_INFO /* 토지상세정보 */
					         WHERE LAD_CODE = B.LAD_CODE
					           AND BLCK = B.BLCK
					           AND LOT = B.LOT
					           AND LOT_TY = B.LOT_TY) AS DCSN_AR
					      ,A.REGARD_GTN AS BO_AMT
					      ,TRUNC(NVL(C.SUPLY_AMOUNT, 0) / 6) AS WOL_AMT
					      ,A.REGARD_RNTCHRG AS BOJUNG_AMT
					      ,NVL(C.SUPLY_AMOUNT, 0) AS SUPLY_AMOUNT_SUM
					      ,NVL(C.SUPLY_AMOUNT, 0) + A.REGARD_RNTCHRG AS TOTAL_SUM
					      ,D.PAY_TMLMT AS START_DATE
					      ,CASE A.PBLICTE_QU
					         WHEN '1' THEN
					          CASE
					            WHEN NVL(SUBSTR(C.PBLICTE_DE, 7, 2), '31') NOT IN
					                 ('31', '28', '29') THEN
					             CASE
					               WHEN B.CANCL_DE IS NOT NULL THEN
					                C.PBLICTE_DE
					               ELSE
					                A.PBLICTE_YEAR || '-03-31'
					             END
					            ELSE
					             A.PBLICTE_YEAR || '-03-31'
					          END
					         WHEN '2' THEN
					          CASE
					            WHEN NVL(SUBSTR(C.PBLICTE_DE, 7, 2), '30') NOT IN ('30', '31') THEN
					             CASE
					               WHEN B.CANCL_DE IS NOT NULL THEN
					                C.PBLICTE_DE
					               ELSE
					                A.PBLICTE_YEAR || '-06-30'
					             END
					            ELSE
					             A.PBLICTE_YEAR || '-06-30'
					          END
					         WHEN '3' THEN
					          CASE
					            WHEN NVL(SUBSTR(C.PBLICTE_DE, 7, 2), '30') NOT IN ('30', '31') THEN
					             CASE
					               WHEN B.CANCL_DE IS NOT NULL THEN
					                C.PBLICTE_DE
					               ELSE
					                A.PBLICTE_YEAR || '-09-30'
					             END
					            ELSE
					             A.PBLICTE_YEAR || '-09-30'
					          END
					         WHEN '4' THEN
					          CASE
					            WHEN NVL(SUBSTR(C.PBLICTE_DE, 7, 2), '31') NOT IN ('30', '31') THEN
					             CASE
					               WHEN B.CANCL_DE IS NOT NULL THEN
					                C.PBLICTE_DE
					               ELSE
					                A.PBLICTE_YEAR || '-12-31'
					             END
					            ELSE
					             A.PBLICTE_YEAR || '-12-31'
					          END
					       
					       END AS END_DATE
					      ,SFSLS_LAD_NM(B.LAD_CODE, 'ALL_LAD_NM') AS ALL_LAD_NM
			]]>
					  FROM TBSLS_REGARD_RNTCHRG A /* 간주임대료 */
					      ,TBSLS_LCNTRCTR B /* 토지계약자 */
					      ,(SELECT *
					          FROM TBSLS_LAD_VAT /* 토지부가세 */
					         WHERE 1 = 1
					        <isNotEmpty property="LAD_CODE">
							   AND SUBSTR(CNTRCTR_NO, 1, 3) LIKE #LAD_CODE#
							</isNotEmpty>
					           AND BILL_SE = '1'
					           AND PBLICTE_YEAR = #PBLICTE_YEAR#
					           AND PBLICTE_QU = #PBLICTE_QU#) C
					      ,(SELECT CNTRCTR_NO
					              ,CASE #PBLICTE_QU#
					                 WHEN '1' THEN
					                  CASE
					                    WHEN D.PAY_TMLMT BETWEEN #PBLICTE_YEAR# || '0101' AND
					                         #PBLICTE_YEAR# || '0331' THEN
					                     D.PAY_TMLMT
					                    ELSE
					                     #PBLICTE_YEAR# || '-01-01'
					                  END
					                 WHEN '2' THEN
					                  CASE
					                    WHEN D.PAY_TMLMT BETWEEN #PBLICTE_YEAR# || '0401' AND
					                         #PBLICTE_YEAR# || '0630' THEN
					                     D.PAY_TMLMT
					                    ELSE
					                     #PBLICTE_YEAR# || '-04-01'
					                  END
					                 WHEN '3' THEN
					                  CASE
					                    WHEN D.PAY_TMLMT BETWEEN #PBLICTE_YEAR# || '0701' AND
					                         #PBLICTE_YEAR# || '0930' THEN
					                     D.PAY_TMLMT
					                    ELSE
					                     #PBLICTE_YEAR# || '-07-01'
					                  END
					                 WHEN '4' THEN
					                  CASE
					                    WHEN D.PAY_TMLMT BETWEEN #PBLICTE_YEAR# || '1001' AND
					                         #PBLICTE_YEAR# || '1231' THEN
					                     D.PAY_TMLMT
					                    ELSE
					                     #PBLICTE_YEAR# || '-10-01'
					                  END
					               END AS PAY_TMLMT
					        
					          FROM TBSLS_LCNTRCTR_PAY D /* 토지계약자납부 */
					         WHERE 1 = 1
					         <isNotEmpty property="LAD_CODE">
							   AND SUBSTR(D.CNTRCTR_NO, 1, 3) LIKE #LAD_CODE#
							 </isNotEmpty>
					           AND D.LTTOT_RENT_SE = 'R'
					           AND D.PAY_CODE = 'RN'
					           AND D.PAY_TMLMT = (SELECT MIN(PAY_TMLMT)
					                                FROM TBSLS_LCNTRCTR_PAY
					                               WHERE CNTRCTR_NO = D.CNTRCTR_NO
					                                 AND PAY_CODE = 'RN'
					                                 AND LTTOT_RENT_SE = 'R')
					          GROUP BY D.CNTRCTR_NO, D.PAY_TMLMT) D
					
					 WHERE A.CNTRCTR_NO = B.CNTRCTR_NO
					   AND A.CNTRCTR_NO = C.CNTRCTR_NO(+)
					   AND A.CNTRCTR_NO = D.CNTRCTR_NO(+)
					   
					   AND A.PBLICTE_YEAR = #PBLICTE_YEAR#
					   AND A.PBLICTE_QU = #PBLICTE_QU#
		
					<isNotEmpty property="LAD_CODE">
						AND B.LAD_CODE = #LAD_CODE#
					</isNotEmpty>
					
					<isNotEmpty property="LAD_CODE">
						AND SUBSTR(A.CNTRCTR_NO, 1, 3) LIKE #LAD_CODE#
					</isNotEmpty>
			 
				ORDER BY B.LAD_CODE, TO_NUMBER(B.BLCK), TO_NUMBER(B.LOT), B.LOT_TY
			
	</select>
		
</sqlMap>