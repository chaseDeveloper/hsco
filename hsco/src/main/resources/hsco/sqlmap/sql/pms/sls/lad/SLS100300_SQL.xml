<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="SLS100300_SQL">	
	<typeAlias alias="egovMap"          type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
   
   
   
   <!-- 수입조정일계표 -->
   	<parameterMap id="spsls_lad_temp_lad_decsn_id_param" class="java.util.HashMap">
		<parameter property="IN_DTA_SE"			jdbcType="VARCHAR"	javaType="string" 	mode="IN" />
		<parameter property="IN_DECSN_DE"		jdbcType="VARCHAR"	javaType="string" 	mode="IN" />
		<parameter property="OUT_RESULT_CD"		jdbcType="VARCHAR"	javaType="string"	mode="OUT" />
		<parameter property="OUT_RESULT_MSG"	jdbcType="VARCHAR"	javaType="string"	mode="OUT" />		
	</parameterMap>
	
   	<procedure id="SLS100300DAO.SPSLS_LAD_TEMP_LAD_DECSN_ID" parameterMap="spsls_lad_temp_lad_decsn_id_param">
		{ call SPSLS_LAD_TEMP_LAD_DECSN_ID(?, ?, ?, ?) }
	</procedure>
	
	
	<!-- 수입조정일계표 -->
	<select id="SLS100300DAO.selectLadIncmeMdatDailyList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
			
			SELECT '          총                 계' AS COL_TITLE
			      ,SUM(MDAT_CO) AS PAY_CNT
			      ,SUM(MDAT_AMOUNT) AS PAY_AMT
			      ,SUM(RCIV_CO) AS REC_CNT
			      ,SUM(RCIV_AMOUNT) AS REC_AMT
			      ,SUM(MDAT_CO_ACMTL) AS PAY_CNTT
			      ,SUM(MDAT_AMOUNT_ACMTL) AS PAY_AMTT
			      ,SUM(RCIV_CO_ACMTL) AS REC_CNTT
			      ,SUM(RCIV_AMOUNT_ACMTL) AS REC_AMTT
			      ,SUM(MDAT_AMOUNT_ACMTL) - SUM(RCIV_AMOUNT_ACMTL) AS DEL_AMT
			      ,'1' ORD
			      ,'1' AS ORD1
			      ,'총    계' KWAN_NM
			      ,NULL AS HANG_NM
			      ,NULL AS HANG_CODE
			      ,NULL AS SEHN_NM
			      ,NULL AS SEHN_CODE
			      ,NULL AS MOK_NM
			      ,'1' AS BSNS_SE
			      ,'1' AS BUDGET_ACNT_CODE
			      ,#IN_DECSN_DE# AS DECSN_DE
			  FROM TBSLS_MDAT_INCME_OUTPT /* 조정수입조회용임시테이블 */
			 WHERE 1 = 1
			   
			<isNotEmpty property="BUDGET_ACNT_CODE">
			   AND BUDGET_ACNT_CODE = #BUDGET_ACNT_CODE#
			</isNotEmpty>
			   AND DTA_SE = '1'
			
			UNION ALL
			
			SELECT KWAN_NM AS COL_TITLE
			      ,SUM(MDAT_CO) AS PAY_CNT
			      ,SUM(MDAT_AMOUNT) AS PAY_AMT
			      ,SUM(RCIV_CO) AS REC_CNT
			      ,SUM(RCIV_AMOUNT) AS REC_AMT
			      ,SUM(MDAT_CO_ACMTL) AS PAY_CNTT
			      ,SUM(MDAT_AMOUNT_ACMTL) AS PAY_AMTT
			      ,SUM(RCIV_CO_ACMTL) AS REC_CNTT
			      ,SUM(RCIV_AMOUNT_ACMTL) AS REC_AMTT
			      ,SUM(MDAT_AMOUNT_ACMTL) - SUM(RCIV_AMOUNT_ACMTL) AS DEL_AMT
			      ,'2' ORD
			      ,'2' AS ORD1
			      ,KWAN_NM
			      ,NULL AS HANG_NM
			      ,'1' AS HANG_CODE
			      ,NULL AS SEHN_NM
			      ,NULL AS SEHN_CODE
			      ,NULL AS MOK_NM
			      ,BSNS_SE || '1' AS BSNS_SE
			      ,'1' AS BUDGET_ACNT_CODE
			      ,#IN_DECSN_DE# AS DECSN_DE
			  FROM TBSLS_MDAT_INCME_OUTPT
			 WHERE 1 = 1
			 
			<isNotEmpty property="BUDGET_ACNT_CODE">
			   AND BUDGET_ACNT_CODE = #BUDGET_ACNT_CODE#
			</isNotEmpty>
			   AND DTA_SE = '1'
			   
			 GROUP BY KWAN_NM, BSNS_SE
			
			UNION ALL
			
			SELECT LPAD(' ', 6, ' ') || HANG_NM AS COL_TITLE
			      ,SUM(MDAT_CO) AS PAY_CNT
			      ,SUM(MDAT_AMOUNT) AS PAY_AMT
			      ,SUM(RCIV_CO) AS REC_CNT
			      ,SUM(RCIV_AMOUNT) AS REC_AMT
			      ,SUM(MDAT_CO_ACMTL) AS PAY_CNTT
			      ,SUM(MDAT_AMOUNT_ACMTL) AS PAY_AMTT
			      ,SUM(RCIV_CO_ACMTL) AS REC_CNTT
			      ,SUM(RCIV_AMOUNT_ACMTL) AS REC_AMTT
			      ,SUM(MDAT_AMOUNT_ACMTL) - SUM(RCIV_AMOUNT_ACMTL) AS DEL_AMT
			      ,'3' ORD
			      ,'2' AS ORD1
			      ,KWAN_NM
			      ,HANG_NM
			      ,HANG_CODE
			      ,NULL AS SEHN_NM
			      ,'1' AS SEHN_CODE
			      ,NULL AS MOK_NM
			      ,BSNS_SE || '1' AS BSNS_SE
			      ,'2' AS BUDGET_ACNT_CODE
			      ,#IN_DECSN_DE# AS DECSN_DE
			  FROM TBSLS_MDAT_INCME_OUTPT
			 WHERE 1 = 1
			 
			<isNotEmpty property="BUDGET_ACNT_CODE">
			   AND BUDGET_ACNT_CODE = #BUDGET_ACNT_CODE#
			</isNotEmpty>
			   AND DTA_SE = '1'
			
			 GROUP BY KWAN_NM, HANG_NM, BSNS_SE, HANG_CODE
			
			UNION ALL
			
			SELECT LPAD(' ', 15, ' ') || SEHN_NM AS COL_TITLE
			      ,SUM(MDAT_CO) AS PAY_CNT
			      ,SUM(MDAT_AMOUNT) AS PAY_AMT
			      ,SUM(RCIV_CO) AS REC_CNT
			      ,SUM(RCIV_AMOUNT) AS REC_AMT
			      ,SUM(MDAT_CO_ACMTL) AS PAY_CNTT
			      ,SUM(MDAT_AMOUNT_ACMTL) AS PAY_AMTT
			      ,SUM(RCIV_CO_ACMTL) AS REC_CNTT
			      ,SUM(RCIV_AMOUNT_ACMTL) AS REC_AMTT
			      ,SUM(MDAT_AMOUNT_ACMTL) - SUM(RCIV_AMOUNT_ACMTL) AS DEL_AMT
			      ,'4' ORD
			      ,'2' AS ORD1
			      ,KWAN_NM
			      ,HANG_NM
			      ,HANG_CODE
			      ,SEHN_NM
			      ,SEHN_CODE
			      ,NULL AS MOK_NM
			      ,BSNS_SE || '1' AS BSNS_SE
			      ,'3' AS BUDGET_ACNT_CODE
			      ,#IN_DECSN_DE# AS DECSN_DE
			  FROM TBSLS_MDAT_INCME_OUTPT
			 WHERE 1 = 1
			 
			<isNotEmpty property="BUDGET_ACNT_CODE">
			   AND BUDGET_ACNT_CODE = #BUDGET_ACNT_CODE#
			</isNotEmpty>
			   AND DTA_SE = '1'
			
			 GROUP BY KWAN_NM, HANG_NM, HANG_CODE, SEHN_NM, SEHN_CODE, BSNS_SE /*--, BUDGET_ACNT_CODE */
			
			UNION ALL
			
			SELECT LPAD(' ', 24, ' ') || MOK_NM AS COL_TITLE
			      ,SUM(MDAT_CO) AS PAY_CNT
			      ,SUM(MDAT_AMOUNT) AS PAY_AMT
			      ,SUM(RCIV_CO) AS REC_CNT
			      ,SUM(RCIV_AMOUNT) AS REC_AMT
			      ,SUM(MDAT_CO_ACMTL) AS PAY_CNTT
			      ,SUM(MDAT_AMOUNT_ACMTL) AS PAY_AMTT
			      ,SUM(RCIV_CO_ACMTL) AS REC_CNTT
			      ,SUM(RCIV_AMOUNT_ACMTL) AS REC_AMTT
			      ,SUM(MDAT_AMOUNT_ACMTL) - SUM(RCIV_AMOUNT_ACMTL) AS DEL_AMT
			      ,'5' ORD
			      ,'2' AS ORD1
			      ,KWAN_NM
			      ,HANG_NM
			      ,HANG_CODE
			      ,SEHN_NM
			      ,SEHN_CODE
			      ,MOK_NM
			      ,BSNS_SE || '1' AS BSNS_SE
			      ,BUDGET_ACNT_CODE
			      ,#IN_DECSN_DE# AS DECSN_DE
			  FROM TBSLS_MDAT_INCME_OUTPT
			 WHERE 1 = 1
			 
			<isNotEmpty property="BUDGET_ACNT_CODE">
			   AND BUDGET_ACNT_CODE = #BUDGET_ACNT_CODE#
			</isNotEmpty>
			   AND DTA_SE = '1'
			   
			 GROUP BY KWAN_NM
			         ,HANG_NM
			         ,HANG_CODE
			         ,SEHN_NM
			         ,SEHN_CODE
			         ,MOK_NM
			         ,BSNS_SE
			         ,BUDGET_ACNT_CODE
			
			 ORDER BY ORD1
			         ,BSNS_SE
			         ,KWAN_NM
			         ,HANG_CODE
			         ,SEHN_CODE
			         ,ORD
			         ,BUDGET_ACNT_CODE
			         
    </select>
    
    
    
    
    <!-- 월별징수현황 -->
   	<parameterMap id="spsls_lad_temp_lad_decsn_id1_param" class="java.util.HashMap">
		<parameter property="IN_DTA_SE"			jdbcType="VARCHAR"	javaType="string" 	mode="IN" />
		<parameter property="IN_DECSN_DE"		jdbcType="VARCHAR"	javaType="string" 	mode="IN" />
		<parameter property="OUT_RESULT_CD"		jdbcType="VARCHAR"	javaType="string"	mode="OUT" />
		<parameter property="OUT_RESULT_MSG"	jdbcType="VARCHAR"	javaType="string"	mode="OUT" />		
	</parameterMap>
	
   	<procedure id="SLS100300DAO.SPSLS_LAD_TEMP_LAD_DECSN_ID1" parameterMap="spsls_lad_temp_lad_decsn_id1_param">
		{ call SPSLS_LAD_TEMP_LAD_DECSN_ID1(?, ?, ?, ?) }
	</procedure>
	
	
	<!-- 월별징수현황 : 목별 -->
	<select id="SLS100300DAO.selectLadMonthlyLevList1" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
			
			SELECT '          총                 계' AS COL_TITLE
			      ,SUM(MDAT_CO) AS PAY_CNT
			      ,SUM(MDAT_AMOUNT) AS PAY_AMT
			      ,SUM(RCIV_CO) AS REC_CNT
			      ,SUM(RCIV_AMOUNT) AS REC_AMT
			      ,SUM(MDAT_CO_ACMTL) AS PAY_CNTT
			      ,SUM(MDAT_AMOUNT_ACMTL) AS PAY_AMTT
			      ,SUM(RCIV_CO_ACMTL) AS REC_CNTT
			      ,SUM(RCIV_AMOUNT_ACMTL) AS REC_AMTT
			      ,SUM(MDAT_AMOUNT) - SUM(RCIV_AMOUNT) AS DEL_AMT
			      ,SUM(MDAT_AMOUNT_ACMTL) - SUM(RCIV_AMOUNT_ACMTL) AS DEL_AMTT
			      ,SUM(NVL(BUDGET_AM, 0)) AS BUDGET_AM  
			      ,'1' ORD
			      ,'1' AS ORD1
			      ,'총    계' KWAN_NM
			      ,NULL AS HANG_NM
			      ,NULL AS HANG_CODE
			      ,NULL AS SEHN_NM
			      ,NULL AS SEHN_CODE
			      ,NULL AS MOK_NM
			      ,'1' AS BSNS_SE
			      ,'1' AS BUDGET_ACNT_CODE
			      ,#IN_DECSN_DE# AS DECSN_DE
			  FROM TBSLS_MDAT_INCME_OUTPT 
			 WHERE 1 = 1
			   AND DTA_SE = '2'
			
			UNION ALL
			
			SELECT KWAN_NM AS COL_TITLE
			      ,SUM(MDAT_CO) AS PAY_CNT
			      ,SUM(MDAT_AMOUNT) AS PAY_AMT
			      ,SUM(RCIV_CO) AS REC_CNT
			      ,SUM(RCIV_AMOUNT) AS REC_AMT
			      ,SUM(MDAT_CO_ACMTL) AS PAY_CNTT
			      ,SUM(MDAT_AMOUNT_ACMTL) AS PAY_AMTT
			      ,SUM(RCIV_CO_ACMTL) AS REC_CNTT
			      ,SUM(RCIV_AMOUNT_ACMTL) AS REC_AMTT
			      ,SUM(MDAT_AMOUNT) - SUM(RCIV_AMOUNT) AS DEL_AMT
			      ,SUM(MDAT_AMOUNT_ACMTL) - SUM(RCIV_AMOUNT_ACMTL) AS DEL_AMTT
			      ,SUM(NVL(BUDGET_AM, 0)) AS BUDGET_AM
			      ,'2' ORD
			      ,'2' AS ORD1
			      ,KWAN_NM
			      ,NULL AS HANG_NM
			      ,'1' AS HANG_CODE
			      ,NULL AS SEHN_NM
			      ,NULL AS SEHN_CODE
			      ,NULL AS MOK_NM
			      ,BSNS_SE
			      ,'1' AS BUDGET_ACNT_CODE
			      ,#IN_DECSN_DE# AS DECSN_DE
			  FROM TBSLS_MDAT_INCME_OUTPT
			 WHERE 1 = 1
			   AND DTA_SE = '2'
			 GROUP BY KWAN_NM, BSNS_SE
			
			UNION ALL
			
			SELECT LPAD(' ', 6, ' ') || HANG_NM AS COL_TITLE
			      ,SUM(MDAT_CO) AS PAY_CNT
			      ,SUM(MDAT_AMOUNT) AS PAY_AMT
			      ,SUM(RCIV_CO) AS REC_CNT
			      ,SUM(RCIV_AMOUNT) AS REC_AMT
			      ,SUM(MDAT_CO_ACMTL) AS PAY_CNTT
			      ,SUM(MDAT_AMOUNT_ACMTL) AS PAY_AMTT
			      ,SUM(RCIV_CO_ACMTL) AS REC_CNTT
			      ,SUM(RCIV_AMOUNT_ACMTL) AS REC_AMTT
			      ,SUM(MDAT_AMOUNT) - SUM(RCIV_AMOUNT) AS DEL_AMT
			      ,SUM(MDAT_AMOUNT_ACMTL) - SUM(RCIV_AMOUNT_ACMTL) AS DEL_AMTT
			      ,SUM(NVL(BUDGET_AM, 0)) AS BUDGET_AM
			      ,'3' ORD
			      ,'2' AS ORD1
			      ,KWAN_NM
			      ,HANG_NM
			      ,HANG_CODE
			      ,NULL AS SEHN_NM
			      ,'1' AS SEHN_CODE
			      ,NULL AS MOK_NM
			      ,BSNS_SE
			      ,'2' AS BUDGET_ACNT_CODE
			      ,#IN_DECSN_DE# AS DECSN_DE
			  FROM TBSLS_MDAT_INCME_OUTPT
			 WHERE 1 = 1
			   AND DTA_SE = '2'
			 GROUP BY KWAN_NM, HANG_NM, BSNS_SE, HANG_CODE
			
			UNION ALL
			
			SELECT LPAD(' ', 15, ' ') || SEHN_NM AS COL_TITLE
			      ,SUM(MDAT_CO) AS PAY_CNT
			      ,SUM(MDAT_AMOUNT) AS PAY_AMT
			      ,SUM(RCIV_CO) AS REC_CNT
			      ,SUM(RCIV_AMOUNT) AS REC_AMT
			      ,SUM(MDAT_CO_ACMTL) AS PAY_CNTT
			      ,SUM(MDAT_AMOUNT_ACMTL) AS PAY_AMTT
			      ,SUM(RCIV_CO_ACMTL) AS REC_CNTT
			      ,SUM(RCIV_AMOUNT_ACMTL) AS REC_AMTT
			      ,SUM(MDAT_AMOUNT) - SUM(RCIV_AMOUNT) AS DEL_AMT
			      ,SUM(MDAT_AMOUNT_ACMTL) - SUM(RCIV_AMOUNT_ACMTL) AS DEL_AMTT
			      ,SUM(NVL(BUDGET_AM, 0)) AS BUDGET_AM
			      ,'4' ORD
			      ,'2' AS ORD1
			      ,KWAN_NM
			      ,HANG_NM
			      ,HANG_CODE
			      ,SEHN_NM
			      ,SEHN_CODE
			      ,NULL AS MOK_NM
			      ,BSNS_SE
			      ,'3' AS BUDGET_ACNT_CODE
			      ,#IN_DECSN_DE# AS DECSN_DE
			  FROM TBSLS_MDAT_INCME_OUTPT
			 WHERE 1 = 1
			   AND DTA_SE = '2'
			 GROUP BY KWAN_NM, HANG_NM, HANG_CODE, SEHN_NM, SEHN_CODE, BSNS_SE /* , BUDGET_ACNT_CODE */
			
			UNION ALL
			
			SELECT LPAD(' ', 24, ' ') || MOK_NM AS COL_TITLE
			      ,SUM(MDAT_CO) AS PAY_CNT
			      ,SUM(MDAT_AMOUNT) AS PAY_AMT
			      ,SUM(RCIV_CO) AS REC_CNT
			      ,SUM(RCIV_AMOUNT) AS REC_AMT
			      ,SUM(MDAT_CO_ACMTL) AS PAY_CNTT
			      ,SUM(MDAT_AMOUNT_ACMTL) AS PAY_AMTT
			      ,SUM(RCIV_CO_ACMTL) AS REC_CNTT
			      ,SUM(RCIV_AMOUNT_ACMTL) AS REC_AMTT
			      ,SUM(MDAT_AMOUNT) - SUM(RCIV_AMOUNT) AS DEL_AMT
			      ,SUM(MDAT_AMOUNT_ACMTL) - SUM(RCIV_AMOUNT_ACMTL) AS DEL_AMTT
			      ,SUM(NVL(BUDGET_AM, 0)) AS BUDGET_AM
			      ,'5' ORD
			      ,'2' AS ORD1
			      ,KWAN_NM
			      ,HANG_NM
			      ,HANG_CODE
			      ,SEHN_NM
			      ,SEHN_CODE
			      ,MOK_NM
			      ,BSNS_SE
			      ,BUDGET_ACNT_CODE
			      ,#IN_DECSN_DE# AS DECSN_DE
			  FROM TBSLS_MDAT_INCME_OUTPT
			 WHERE 1 = 1
			   AND DTA_SE = '2'
			 GROUP BY KWAN_NM
			         ,HANG_NM
			         ,HANG_CODE
			         ,SEHN_NM
			         ,SEHN_CODE
			         ,MOK_NM
			         ,BSNS_SE
			         ,BUDGET_ACNT_CODE
			
			 ORDER BY ORD1
			         ,BSNS_SE
			         ,KWAN_NM
			         ,HANG_CODE
			         ,SEHN_CODE
			         ,ORD
			         ,BUDGET_ACNT_CODE
			         			         
    </select>
    
    
    <!-- 월별징수현황 : 지구별 -->
	<select id="SLS100300DAO.selectLadMonthlyLevList2" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
			
			SELECT '            총          계' AS COL_TITLE
			      ,A.ESTIMATE_AMT
			      ,B.PAY_MON_AMT
			      ,C.PAY_YEAR_AMT
			      ,B.REC_MON_AMT
			      ,C.REC_YEAR_AMT
			      ,(C.PAY_YEAR_AMT - C.REC_YEAR_AMT) AS MISU
			      ,'0' AS BSNS_SE
			      ,NULL AS BUDGET_ACNT_CODE
			      ,NULL AS LAD_CODE
			      ,NULL AS PRPOS_SE
			      ,NULL AS BUDGET_ACNT_NM
			      ,NULL AS ALL_LAD_NM
			      ,NULL AS PRPOS_SE_NM
			      ,'1' AS CNT
			      ,'1' AS CNT2
			      ,#IN_DECSN_DE# AS DECSN_DE
			  FROM (SELECT SUM(AMT) AS ESTIMATE_AMT
			          FROM (SELECT SUM(B.ORIBDGT + B.RVSPBGT_1_ODR) AS AMT
			                  FROM TBBDG_BUDGET_ACNT_CODE A /* 예산계정코드 */
			                      ,TBBDG_EXECUT_BUDGET    B /* 실행예산 */
			                 WHERE A.YEAR = SUBSTR(#DECSN_DE#, 0, 4)
			                   AND B.YEAR = A.YEAR
			                   AND B.BSNS_SE = A.BSNS_SE
			                   AND B.BUDGET_ACNT_CODE = A.BUDGET_ACNT_CODE
			                   AND B.EXPNDTR_UNIT_CODE =
			                       (SELECT MAX(EXPNDTR_UNIT_CODE)
			                          FROM TBBDG_EXPNDTR_UNIT_CODE X
			                         WHERE 1 = 1
			                           AND X.YEAR = A.YEAR
			                           AND X.BSNS_SE = A.BSNS_SE
			                           AND X.BALC_SE = A.BALC_SE
			                           AND X.BALC_SE = '1'
			                           AND X.BUDGET_ACNT_CODE = A.BUDGET_ACNT_CODE)
			                 GROUP BY A.YEAR, A.BSNS_SE, A.BUDGET_ACNT_CODE)) A /* 당해 예산내역 합산 */
			      ,(SELECT SUM(PAY_AMT) AS PAY_MON_AMT, SUM(REC_AMT) AS REC_MON_AMT
			          FROM VISLS_LAD_DECSN2
			         WHERE SUBSTR(DECSN_DE, 0, 6) = SUBSTR(#DECSN_DE#, 0, 6)) B /* 월 합계 */
			      ,(SELECT SUM(PAY_AMT) AS PAY_YEAR_AMT, SUM(REC_AMT) AS REC_YEAR_AMT
			          FROM VISLS_LAD_DECSN2
			         WHERE SUBSTR(DECSN_DE, 0, 6) BETWEEN
			               (SUBSTR(#DECSN_DE#, 0, 4) || '01') AND
			               SUBSTR(#DECSN_DE#, 0, 6)) C /* 누계 */
			
			UNION ALL
			
			/* 계정과목 표시 ( 당해 계정과목 금액, 당해 일반, 기타수입, 과년도) */
			SELECT A.COL_TITLE
			      ,NVL(C.ESTIMATE_AMT, 0) AS ESTIMATE_AMT /* 조정액 합계(월, 년) */
			      ,NVL(B.PAY_MON_AMT, 0) AS PAY_MON_AMT
			      ,NVL(B.PAY_YEAR_AMT, 0) AS PAY_YEAR_AMT /* 수납액 합계(월, 년) */
			      ,NVL(B.REC_MON_AMT, 0) AS REC_MON_AMT
			      ,NVL(B. REC_YEAR_AMT, 0) AS REC_YEAR_AMT /* 미수금액 합계 */
			      ,NVL(B.MISU, 0) AS MISU
			      ,A.BSNS_SE
			      ,A.BUDGET_ACNT_CODE
			      ,'0' AS LAD_CODE
			      ,'0' AS PRPOS_SE
			      ,'' AS BUDGET_ACNT_NM
			      ,NULL AS ALL_LAD_NM
			      ,NULL AS PRPOS_SE_NM
			      ,'2' AS CNT
			      ,'2' AS CNT2
			      ,#IN_DECSN_DE# AS DECSN_DE
			  FROM ( /* 당해 예산계정 내역 */
			        SELECT DISTINCT COL_TITLE, BUDGET_YEAR, BSNS_SE, BUDGET_ACNT_CODE
			          FROM ( /* 당해 예산 내역(여기서 건수가 많이 나옴) */
			                 SELECT DISTINCT A.BUDGET_ACNT_NM   AS COL_TITLE
			                                 ,A.YEAR             AS BUDGET_YEAR
			                                 ,A.BSNS_SE
			                                 ,A.BUDGET_ACNT_CODE
			                   FROM TBBDG_BUDGET_ACNT_CODE A /* 예산계정코드 */
			                  WHERE 1 = 1
			                    AND A.YEAR = SUBSTR(#DECSN_DE#, 0, 4)
			                    AND A.BALC_SE = '1'
			                 
			                 UNION ALL
			                 
			                 /* 기타수입 계정 과목 */
			                 SELECT DISTINCT B.BUDGET_ACNT_NM  AS COL_TITLE
			                                ,BUDGET_YEAR       AS BUDGET_YEAR
			                                ,A.BSNS_SE
			                                ,A.BUDGET_ACNTCTGR
			                   FROM TBSLS_ETC_INCME_PAY    A /* 기타수입납부 */
			                       ,TBBDG_BUDGET_ACNT_CODE B /* 예산계정코드 */
			                  WHERE 1 = 1
			                    AND SUBSTR(A.MDAT_DE, 0, 4) = SUBSTR(#DECSN_DE#, 0, 4)
			                    AND B.YEAR = A.BUDGET_YEAR
			                    AND B.BSNS_SE = A.BSNS_SE
			                    AND B.BUDGET_ACNT_CODE = A.BUDGET_ACNTCTGR) A) A
			      ,
			       /* 각 결의서 계정별 내역 합산 */
			       (SELECT SUM(PAY_MON_AMT) AS PAY_MON_AMT
			              ,SUM(PAY_YEAR_AMT) AS PAY_YEAR_AMT
			              ,SUM(REC_MON_AMT) AS REC_MON_AMT
			              ,SUM(REC_YEAR_AMT) AS REC_YEAR_AMT
			              ,SUM(MISU) AS MISU
			              ,BUDGET_YEAR
			              ,BSNS_SE
			              ,BUDGET_ACNT_CODE
			          FROM ( /* 조정, 수납에 대한 합산 금액   */
			                
			                SELECT BUDGET_YEAR
			                       ,DECODE(SUBSTR(DECSN_DE, 5, 2)
			                              ,SUBSTR(#DECSN_DE#, 5, 2)
			                              ,NVL(SUM(PAY_AMT), 0)) AS PAY_MON_AMT /* 조정액(월, 년) */
			                       ,SUM(PAY_AMT) AS PAY_YEAR_AMT /* 수납액(월, 년) */
			                       ,DECODE(SUBSTR(DECSN_DE, 5, 2)
			                              ,SUBSTR(#DECSN_DE#, 5, 2)
			                              ,NVL(SUM(REC_AMT), 0)) AS REC_MON_AMT
			                       ,NVL(SUM(REC_AMT), 0) AS REC_YEAR_AMT /* 미수금액 */
			                       ,(NVL(SUM(PAY_AMT), 0) - NVL(SUM(REC_AMT), 0)) AS MISU
			                       ,BSNS_SE
			                       ,BUDGET_ACNT_CODE
			                  FROM VISLS_LAD_DECSN2 A
			                 WHERE SUBSTR(DECSN_DE, 0, 6) BETWEEN
			                       (SUBSTR(#DECSN_DE#, 0, 4) || '01') AND
			                       SUBSTR(#DECSN_DE#, 0, 6)
			                 GROUP BY BUDGET_YEAR
			                          ,SUBSTR(DECSN_DE, 5, 2)
			                          ,BSNS_SE
			                          ,BUDGET_ACNT_CODE) A
			         GROUP BY BUDGET_YEAR, BSNS_SE, BUDGET_ACNT_CODE) B
			      ,
			       /* 당해 예산내역 계정별 합산 */
			       (SELECT SUM(B.ORIBDGT + B.RVSPBGT_1_ODR) AS ESTIMATE_AMT
			              ,A.YEAR AS BUDGET_YEAR
			              ,A.BSNS_SE
			              ,A.BUDGET_ACNT_CODE
			          FROM TBBDG_BUDGET_ACNT_CODE A /* 예산계정코드 */
			              ,TBBDG_EXECUT_BUDGET    B /* 실행예산 */
			         WHERE A.YEAR = SUBSTR(#DECSN_DE#, 0, 4)
			           AND B.YEAR = A.YEAR
			           AND B.BSNS_SE = A.BSNS_SE
			           AND B.BUDGET_ACNT_CODE = A.BUDGET_ACNT_CODE
			           AND B.EXPNDTR_UNIT_CODE =
			               (SELECT MAX(EXPNDTR_UNIT_CODE)
			                  FROM TBBDG_EXPNDTR_UNIT_CODE X
			                 WHERE 1 = 1
			                   AND X.YEAR = A.YEAR
			                   AND X.BSNS_SE = A.BSNS_SE
			                   AND X.BALC_SE = A.BALC_SE
			                   AND X.BALC_SE = '1'
			                   AND X.BUDGET_ACNT_CODE = A.BUDGET_ACNT_CODE)
			         GROUP BY A.YEAR, A.BSNS_SE, A.BUDGET_ACNT_CODE) C
			
			 WHERE A.BUDGET_YEAR = C.BUDGET_YEAR(+)
			   AND A.BSNS_SE = C.BSNS_SE(+)
			   AND A.BUDGET_ACNT_CODE = C.BUDGET_ACNT_CODE(+)
			   AND A.BUDGET_YEAR = B.BUDGET_YEAR
			   AND A.BSNS_SE = B.BSNS_SE
			   AND A.BUDGET_ACNT_CODE = B.BUDGET_ACNT_CODE
			
			UNION ALL
			/* 토지 코드별 */
			SELECT COL_TITLE
			      ,0 AS ESTIMATE_AMT
			      ,SUM(NVL(PAY_MON_AMT, 0)) AS PAY_MON_AMT
			      ,SUM(NVL(PAY_YEAR_AMT, 0)) AS PAY_YEAR_AMT
			      ,SUM(NVL(REC_MON_AMT, 0)) AS REC_MON_AMT
			      ,SUM(NVL(REC_YEAR_AMT, 0)) AS REC_YEAR_AMT
			      ,SUM(MISU) AS MISU
			      ,BSNS_SE
			      ,BUDGET_ACNT_CODE
			      ,LAD_CODE
			      ,PRPOS_SE
			      ,BUDGET_ACNT_NM
			      ,ALL_LAD_NM
			      ,PRPOS_SE_NM
			      ,CNT
			      ,CNT2
			      ,#IN_DECSN_DE# AS DECSN_DE
			  FROM (SELECT LPAD(' ', 10, ' ') || A.ALL_LAD_NM AS COL_TITLE
			              ,'0' AS ESTIMATE_AMT /* 조정액(월, 년) */
			              ,DECODE(SUBSTR(DECSN_DE, 5, 2)
			                     ,SUBSTR(#DECSN_DE#, 5, 2)
			                     ,NVL(SUM(PAY_AMT), 0)) AS PAY_MON_AMT
			              ,SUM(PAY_AMT) AS PAY_YEAR_AMT /* 수납액(월, 년) */
			              ,DECODE(SUBSTR(DECSN_DE, 5, 2)
			                     ,SUBSTR(#DECSN_DE#, 5, 2)
			                     ,NVL(SUM(REC_AMT), 0)) AS REC_MON_AMT
			              ,NVL(SUM(REC_AMT), 0) AS REC_YEAR_AMT /* 미수금액 */
			              ,(NVL(SUM(PAY_AMT), 0) - NVL(SUM(REC_AMT), 0)) AS MISU
			              ,BSNS_SE
			              ,BUDGET_ACNT_CODE
			              ,LAD_CODE
			              ,NULL AS PRPOS_SE
			              ,BUDGET_ACNT_NM
			              ,ALL_LAD_NM
			              ,NULL AS PRPOS_SE_NM
			              ,'3' AS CNT
			              ,'2' AS CNT2
			          FROM VISLS_LAD_DECSN2 A
			         WHERE SUBSTR(DECSN_DE, 0, 6) BETWEEN
			               (SUBSTR(#DECSN_DE#, 0, 4) || '01') AND
			               SUBSTR(#DECSN_DE#, 0, 6)
			         GROUP BY SUBSTR(DECSN_DE, 5, 2)
			                 ,BSNS_SE
			                 ,BUDGET_ACNT_CODE
			                 ,LAD_CODE
			                 ,BUDGET_ACNT_NM
			                 ,ALL_LAD_NM)
			 GROUP BY COL_TITLE
			         ,BSNS_SE
			         ,BUDGET_ACNT_CODE
			         ,LAD_CODE
			         ,PRPOS_SE
			         ,BUDGET_ACNT_NM
			         ,ALL_LAD_NM
			         ,PRPOS_SE_NM
			         ,CNT
			         ,CNT2
			
			UNION ALL
			
			/* 용도별 */
			SELECT COL_TITLE
			      ,NULL AS ESTIMATE_AMT
			      ,NVL(SUM(PAY_MON_AMT), 0) AS PAY_MON_AMT
			      ,NVL(SUM(PAY_YEAR_AMT), 0) AS PAY_YEAR_AMT
			      ,NVL(SUM(REC_MON_AMT), 0) AS REC_MON_AMT
			      ,NVL(SUM(REC_YEAR_AMT), 0) AS REC_YEAR_AMT
			      ,NVL(SUM(MISU), 0) AS MISU
			      ,BSNS_SE
			      ,BUDGET_ACNT_CODE
			      ,LAD_CODE
			      ,PRPOS_SE
			      ,BUDGET_ACNT_NM
			      ,ALL_LAD_NM
			      ,PRPOS_SE_NM
			      ,CNT
			      ,CNT2
			      ,#IN_DECSN_DE# AS DECSN_DE
			  FROM ( /* 해당토지 용도별 */
			        SELECT CASE
			                  WHEN PRPOS_SE IS NULL THEN
			                   LPAD(' ', 20, ' ') || A.BUDGET_ACNT_NM
			                  ELSE
			                   LPAD(' ', 20, ' ') || A.PRPOS_SE_NM
			                END AS COL_TITLE
			               ,'0' AS ESTIMATE_AMT /* 조정액(월,년) */
			               ,DECODE(SUBSTR(DECSN_DE, 5, 2)
			                      ,SUBSTR(#DECSN_DE#, 5, 2)
			                      ,SUM(PAY_AMT)) AS PAY_MON_AMT
			               ,NVL(SUM(PAY_AMT), 0) AS PAY_YEAR_AMT /* 수납액(월, 년) */
			               ,DECODE(SUBSTR(DECSN_DE, 5, 2)
			                      ,SUBSTR(#DECSN_DE#, 5, 2)
			                      ,SUM(REC_AMT)) AS REC_MON_AMT
			               ,NVL(SUM(REC_AMT), 0) AS REC_YEAR_AMT /* 미수금 */
			               ,(NVL(SUM(PAY_AMT), 0) - NVL(SUM(REC_AMT), 0)) AS MISU
			               ,BSNS_SE
			               ,BUDGET_ACNT_CODE
			               ,LAD_CODE
			               ,PRPOS_SE
			               ,BUDGET_ACNT_NM
			               ,ALL_LAD_NM
			               ,PRPOS_SE_NM
			               ,'4' AS CNT
			               ,'2' AS CNT2
			          FROM VISLS_LAD_DECSN2 A
			         WHERE SUBSTR(DECSN_DE, 0, 6) BETWEEN
			               (SUBSTR(#DECSN_DE#, 0, 4) || '01') AND
			               SUBSTR(#DECSN_DE#, 0, 6)
			         GROUP BY SUBSTR(DECSN_DE, 5, 2)
			                  ,BSNS_SE
			                  ,BUDGET_ACNT_CODE
			                  ,LAD_CODE
			                  ,BUDGET_ACNT_NM
			                  ,ALL_LAD_NM
			                  ,PRPOS_SE
			                  ,PRPOS_SE_NM)
			
			 GROUP BY COL_TITLE
			         ,BSNS_SE
			         ,BUDGET_ACNT_CODE
			         ,LAD_CODE
			         ,PRPOS_SE
			         ,BUDGET_ACNT_NM
			         ,ALL_LAD_NM
			         ,PRPOS_SE_NM
			         ,CNT
			         ,CNT2
			
			 ORDER BY BSNS_SE, CNT2, BUDGET_ACNT_CODE, LAD_CODE, CNT, PRPOS_SE
			         
    </select>
      
   
	<!-- 쿼리명 : 자금수입기록부 조회
	설명 : 자금수입기록부 조회
	수정일  		수정자  	수정내용
	2016.01.20	박병일	최초생성
	작성자 : 박병일
	최초작성일 : 2016.01.20
	-->
	<select id="SLS100300DAO.selectCptalIncmeList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		WITH V_LCNTRCTR AS
		(
		<include refid="COM000000.v_sls_lcntrctr_info"/>
		)
		SELECT  DECSN_DE,
		        DECODE(BLCK,'',(SUMRY || RM),
		              (SUMRY || '(' || BLCK || '-' || LOT || '-' || LOT_TY || ') ' || RM)) AS SUMRY,
		        CNAME,
		        BIZ_MISU_AMT + OUT_MISU_AMT + KE_AMT AS PAY_AMT,
		        BIZ_MISU_AMT,
		        OUT_MISU_AMT,
		        KE_NAME,
		        KE_AMT,
		        LAD_CODE,
		        BLCK,
		        LOT,
		        LOT_TY
		  FROM (SELECT A.DECSN_DE,
		               A.SUMRY,
		               V.CSTMR_NM AS CNAME,
		               A.BSNS_SE,
		               A.BUDGET_ACNT_CODE,
		               A.BLCK,
		               A.LOT,
		               A.LOT_TY,
		               A.RM,
		               (CASE WHEN DECSN_DE = #DECSN_DE#
		                      AND ((SUBSTR(BUDGET_ACNT_CODE,1,2) IN( '61','64')
		                       OR SUBSTR(BUDGET_ACNT_CODE,1,3) IN ('411','412' ))
		                       OR (BSNS_SE = '2' AND BUDGET_ACNT_CODE NOT IN ('1611000','2263000')) )
		                     THEN NVL(SUM(DECSN_AMOUNT),0) ELSE 0  END
		               ) AS BIZ_MISU_AMT,
		               (CASE WHEN DECSN_DE = #DECSN_DE#
	                          AND ((SUBSTR(BUDGET_ACNT_CODE,1,2) IN( '62','67')
	                           OR SUBSTR(BUDGET_ACNT_CODE,1,3) IN ('421','226','321','423'))
	                           OR BUDGET_ACNT_CODE IN ('1611000')
	                           OR (BSNS_SE = '3'
	                          AND SUBSTR(BUDGET_ACNT_CODE,1,3) NOT IN ('411','412')) )
		                     THEN NVL(SUM(DECSN_AMOUNT),0) ELSE 0 END
		               ) AS OUT_MISU_AMT,
		              A.LAD_CODE,
		              NULL AS KE_NAME
		              , 0 AS KE_AMT
		          FROM TBSLS_LAD_DECSN A,
		               V_LCNTRCTR V
		         WHERE 1=1
		           AND A.CNTRCTR_NO = V.CNTRCTR_NO(+)
		           AND DECSN_SE IN('2','3')
		           AND DECSN_DE BETWEEN #DECSN_DE# AND #DECSN_DE#
		         GROUP BY A.BSNS_SE,
		                  A.BUDGET_ACNT_CODE,
		                  A.LAD_CODE,
		                  A.BLCK,
		                  A.LOT,
		                  A.LOT_TY,
		                  A.SUMRY,
		                  A.RM,
		                  V.CSTMR_NM,
		                  A.DECSN_DE
		       )
		 WHERE DECSN_DE = #DECSN_DE#
		 GROUP BY SUMRY, 
		          RM, 
		          LAD_CODE, 
		          BLCK,
		          LOT, 
		          LOT_TY,
		          CNAME,
		          BIZ_MISU_AMT,
		          OUT_MISU_AMT,
		          KE_NAME,
		          KE_AMT,
		          DECSN_DE  
		UNION ALL
		SELECT  DECSN_DE,
		        SUMRY,
		        CNAME,
		        BIZ_MISU_AMT + OUT_MISU_AMT + KE_AMT AS PAY_AMT,
		        BIZ_MISU_AMT,
		        OUT_MISU_AMT,
		        DECODE(KE_AMT,0,'',KE_NAME) AS KE_NAME,
		        KE_AMT, 
		        LAD_CODE,
		        BLCK,
		        LOT,
		        LOT_TY
		  FROM (SELECT #DECSN_DE# 	AS DECSN_DE,
		               '  일    계' 	AS SUMRY,
		               NULL 		AS CNAME,
		               (NVL((SELECT NVL(SUM(DECSN_AMOUNT),0)
		                       FROM TBSLS_LAD_DECSN
		                      WHERE DECSN_SE IN('2','3')
		                        AND ((SUBSTR(BUDGET_ACNT_CODE,1,2) IN( '61','64')
		                         OR SUBSTR(BUDGET_ACNT_CODE,1,3) IN ('411','412'))
		                         OR (BSNS_SE = '2' AND BUDGET_ACNT_CODE NOT IN ('1611000','2263000'))
		                         )
		                        AND DECSN_DE = #DECSN_DE#),0)
		               ) AS BIZ_MISU_AMT,
		               (NVL((SELECT SUM(DECSN_AMOUNT)
		                       FROM TBSLS_LAD_DECSN
		                      WHERE DECSN_SE IN('2','3')
		                        AND ((SUBSTR(BUDGET_ACNT_CODE,1,2) IN( '62','67')
		                         OR SUBSTR(BUDGET_ACNT_CODE,1,3) IN ('421','226','321','423'))
		                         OR BUDGET_ACNT_CODE IN ('1611000')
		                         OR ( BSNS_SE = '3'
		                              AND SUBSTR(BUDGET_ACNT_CODE,1,3) NOT IN ('411','412')) )
		                        AND DECSN_DE = #DECSN_DE#),0)
		               ) AS OUT_MISU_AMT,
		               ' ' AS KE_NAME,
		               0  AS KE_AMT,
		               '998' AS LAD_CODE,
		               '0' AS BLCK,
		               '0' AS LOT,
		               '0' AS LOT_TY
		          FROM DUAL
		        )
		 UNION ALL
		 SELECT DECSN_DE,
		        SUMRY,
		        CNAME,
		        PAY_AMT,
		        BIZ_MISU_AMT,
		        OUT_MISU_AMT,
		        KE_NAME,
		        KE_AMT,
		        '999' AS LAD_CODE,
		        '0' AS BLCK,
		        '0' AS LOT,
		        '0' AS LOT_TY
		   FROM (SELECT #DECSN_DE#		AS DECSN_DE,
		                '  누    계'		AS SUMRY,
		                NULL 			AS CNAME,
		                (NVL((SELECT SUM(NVL(DECSN_AMOUNT,0))
		                        FROM TBSLS_LAD_DECSN
		                       WHERE DECSN_SE IN('2','3')
		                         AND DECSN_DE BETWEEN SUBSTR(#DECSN_DE#,1,4) || '0101' AND #DECSN_DE# ) ,0)
		                ) + NVL((SELECT AMOUNT FROM TBRNT_PSTYR_ATMPT_AMOUNT WHERE MDAT_DE BETWEEN SUBSTR(#DECSN_DE#,1,4)||'0101' AND #DECSN_DE# AND JOB_SE_CODE = 'LAD' AND PAY_SE = '2'),0) 
		                AS PAY_AMT,
		                (NVL((SELECT NVL(SUM(DECSN_AMOUNT),0)
		                   FROM TBSLS_LAD_DECSN
		                  WHERE DECSN_SE IN('2','3')
		                    AND ((SUBSTR(BUDGET_ACNT_CODE,1,2) IN( '61','64') OR SUBSTR(BUDGET_ACNT_CODE,1,3) IN ('411','412'))
		                     OR (BSNS_SE = '2' AND BUDGET_ACNT_CODE NOT IN ('1611000','2263000'))
		                     )
		                    AND DECSN_DE BETWEEN SUBSTR(#DECSN_DE#,1,4) || '0101' AND #DECSN_DE# ),0)
		                )   AS BIZ_MISU_AMT,
		               (NVL((SELECT SUM(DECSN_AMOUNT)
		                       FROM TBSLS_LAD_DECSN
		                      WHERE DECSN_SE IN('2','3')
		                        AND ((SUBSTR(BUDGET_ACNT_CODE,1,2) IN( '62','67')
		                         OR SUBSTR(BUDGET_ACNT_CODE,1,3) IN ('421','226','321','423'))
		                         OR BUDGET_ACNT_CODE IN ('1611000')
		                         OR ( BSNS_SE = '3'
		                              AND SUBSTR(BUDGET_ACNT_CODE,1,3) NOT IN ('411','412')) )
		                        AND DECSN_DE BETWEEN SUBSTR(#DECSN_DE#,1,4) || '0101' AND #DECSN_DE# ),0)
		               ) AS OUT_MISU_AMT,		                
		                ' ' AS KE_NAME,
		                (NVL((SELECT DECSN_AMOUNT
		                        FROM TBSLS_LAD_DECSN
		                       WHERE BUDGET_YEAR = SUBSTR(#DECSN_DE#,1,4)
		                         AND BSNS_SE = '3'
		                         AND BUDGET_ACNT_CODE = '4222000'),0)
		                ) AS KE_AMT
		           FROM DUAL
		        )
		  ORDER BY DECSN_DE, LAD_CODE, BLCK, LOT, LOT_TY, SUMRY		  
	</select>
	
	<!-- 쿼리명 : 수입예산정리부 조회
	설명 : 결의일자기준 수입예산정리부 조회
	수정일  		수정자  	수정내용
	2016.01.25	박병일	최초생성
	작성자 : 박병일
	최초작성일 : 2016.01.25
	-->	
	<select id="SLS100300DAO.selectIncmeBdgArngList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		WITH V_LCNTRCTR AS
		(
		<include refid="COM000000.v_sls_lcntrctr_info"/>
		)
		<!-- 계정과목 조회 -->
		SELECT DISTINCT NULL AS DECSN_DE,  
		       ('[' ||  
		       (SELECT C.BUDGET_ACNT_NM
		         FROM VHBDG_BUDGET_ACNT_CODE C
		        WHERE C.BSNS_SE = A.BSNS_SE
		          AND C.BUDGET_ACNT_CODE = A.BUDGET_ACNT_CODE 
		          AND C.YEAR = A.BUDGET_YEAR
		       )  || ']  ' ||  
		       (SELECT SFSLS_LAD_NM(A.LAD_CODE)
		         FROM DUAL
		       )  || ' ' ||  
		       (SELECT SFCOM_CODE_NM('LAD003',A.PRPOS_SE)
		         FROM DUAL
		       )  ) AS SUMRY,   
		       NULL AS CNAME,  
		       NULL AS TEMP1,  
		       NULL AS TEMP2,  
		       NULL AS TEMP3,  
		       NULL AS PAY_CNT,  
		       0 AS PAY_AMT,  
		       NULL AS REC_CNT,  
		       0 AS REC_AMT,  
		       0 AS JAN,  
		       (A.BSNS_SE || A.BUDGET_ACNT_CODE || A.LAD_CODE || A.PRPOS_SE) AS BG_LN_Y_CODE,  
		       '1' AS CNT,  
		       '1' AS CNT1,
		       A.BSNS_SE 			AS BSNS_SE,
		       A.BUDGET_ACNT_CODE 	AS BUDGET_ACNT_CODE,
		       A.LAD_CODE 			AS LAD_CODE,
		       A.PRPOS_SE  			AS PRPOS_SE
		  FROM 
		       (SELECT BUDGET_YEAR,
		              BUDGET_ACNT_CODE,
		              BSNS_SE,
		              LAD_CODE,
		              PRPOS_SE
		         FROM TBSLS_LAD_DECSN
		        WHERE 1=1
		          AND BUDGET_YEAR = SUBSTR(#DECSN_DE_FR#,1,4)
		          AND LAD_CODE LIKE '%' || #LAND_CODE_FR# || '%'
		          AND ( PRPOS_SE IS NULL OR PRPOS_SE LIKE '%' || #PRPOS_SE# || '%')
		       ) A
		    
		UNION ALL  
		<!-- 내역 조회  -->
		SELECT A.DECSN_DE,  
		       A.SUMRY,  
		       A.CNAME,  
		       NULL AS TEMP1,  
		       NULL AS TEMP2,  
		       NULL AS TEMP3,  
		       NULL AS PAY_CNT,  
		       A.PAY_AMT,  
		       NULL AS REC_CNT,  
		       A.REC_AMT,  
		       0 AS JAN,  
		       A.BSNS_SE || A.BUDGET_ACNT_CODE || A.LAD_CODE || A.PRPOS_SE AS BG_LN_Y_CODE,  
		       '2' AS CNT,  
		       '1' AS CNT1,
		       A.BSNS_SE 			AS BSNS_SE,
		       A.BUDGET_ACNT_CODE 	AS BUDGET_ACNT_CODE,
		       A.LAD_CODE 			AS LAD_CODE,
		       A.PRPOS_SE  			AS PRPOS_SE  
		  FROM 
		       (SELECT V.DECSN_DE,  
		              V.BUDGET_YEAR,  
		              V.BSNS_SE,  
		              V.BUDGET_ACNT_CODE,  
		              V.BKEEP_CODE,  
		              V.LAD_CODE,  
		              V.PRPOS_SE,
		              ( SELECT C.BUDGET_ACNT_NM
		                  FROM VHBDG_BUDGET_ACNT_CODE C
		                 WHERE C.BSNS_SE = V.BSNS_SE
		                   AND C.BUDGET_ACNT_CODE = V.BUDGET_ACNT_CODE 
		                   AND C.YEAR = V.BUDGET_YEAR ) AS BG_ACCT_NAME,  
		              NULL AS TEMP1,
		              NULL AS TEMP2,
		              NULL AS TEMP3,
		              V.SUMRY,
		              V1.CSTMR_NM AS CNAME,
		              V.DECSN_AMOUNT AS PAY_AMT,
		              0 AS REC_AMT
		         FROM TBSLS_LAD_DECSN V
		             ,V_LCNTRCTR V1
		        WHERE 1=1
		          AND V.DECSN_SE = '1'
		          AND V.CNTRCTR_NO = V1.CNTRCTR_NO(+)
		           UNION ALL  
		       SELECT V.DECSN_DE,  
		              V.BUDGET_YEAR,  
		              V.BSNS_SE,  
		              V.BUDGET_ACNT_CODE,  
		              V.BKEEP_CODE,  
		              V.LAD_CODE,  
		              V.PRPOS_SE,  
		              ( SELECT C.BUDGET_ACNT_NM
		                  FROM VHBDG_BUDGET_ACNT_CODE C
		                 WHERE C.BSNS_SE = V.BSNS_SE
		                   AND C.BUDGET_ACNT_CODE = V.BUDGET_ACNT_CODE 
		                   AND C.YEAR = V.BUDGET_YEAR ) AS BG_ACCT_NAME,
		              NULL AS TEMP1,  
		              NULL AS TEMP2,  
		              NULL AS TEMP3,  
		              V.SUMRY,  
		              V1.CSTMR_NM AS CNAME, 
		              0 AS PAY_AMT,  
		              DECSN_AMOUNT AS REC_AMT  
		         FROM TBSLS_LAD_DECSN V 
		             ,V_LCNTRCTR V1          
		        WHERE 1=1
		          AND V.DECSN_SE = '2'
		          AND V.CNTRCTR_NO = V1.CNTRCTR_NO(+)
		           UNION ALL
		          SELECT   #DECSN_DE_FR# AS DECSN_DE,
		                   V.BUDGET_YEAR,
		                   SUBSTR(V.BUDGET_ACNTCTGR,1,1) AS BSNS_SE,
		                   V.BUDGET_ACNTCTGR AS BUDGET_ACNT_CODE,
		                   V.BUKIP_CODE AS BKEEP_CODE,
		                   '999' AS LAD_CODE,
		                   '99' AS PRPOS_SE,
		                   (SELECT   C.BUDGET_ACNT_NM
		                      FROM   VHBDG_BUDGET_ACNT_CODE C
		                     WHERE       C.BSNS_SE = SUBSTR(V.BUDGET_ACNTCTGR,1,1)
		                             AND C.BUDGET_ACNT_CODE = V.BUDGET_ACNTCTGR
		                             AND C.YEAR = V.BUDGET_YEAR)
		                      AS BG_ACCT_NAME,
		                   NULL AS TEMP1,
		                   NULL AS TEMP2,
		                   NULL AS TEMP3,
		                   V.RM AS SUMRY,
		                   '' AS CNAME,
		                   (CASE WHEN SUBSTR(#DECSN_DE_FR#,5,2) = '01'  THEN AMOUNT ELSE 0 END) AS PAY_AMT,
		                   (CASE WHEN SUBSTR(#DECSN_DE_FR#,5,2) = '01'  THEN AMOUNT ELSE 0 END) AS REC_AMT
		            FROM   TBRNT_PSTYR_ATMPT_AMOUNT V
		           WHERE   1 = 1
		                   AND V.PAY_SE = '2'
		                   AND V.JOB_SE_CODE = 'LAD'		                        
		       ) A  
		   WHERE 1=1
		     AND A.BUDGET_YEAR = SUBSTR(#DECSN_DE_FR#,1,4)
		     AND SUBSTR(A.DECSN_DE,1,6) = SUBSTR(#DECSN_DE_FR#,1,6)
		     AND A.LAD_CODE LIKE '%' || #LAND_CODE_FR# || '%'
		     AND ( A.PRPOS_SE IS NULL OR A.PRPOS_SE LIKE '%' || #PRPOS_SE# || '%')
		     
		UNION ALL  
		<!-- 월계 조회 -->  
		SELECT NULL AS DECSN_DE,  
		       '      월    계 ' AS SUMRY,  
		       NULL AS CNAME,  
		       NULL AS TEMP1,  
		       NULL AS TEMP2,  
		       NULL AS TEMP3,  
		       SUM(PAY_CNT) AS PAY_CNT,  
		       SUM(PAY_AMT) AS PAY_AMT,  
		       SUM(REC_CNT) AS REC_CNT,  
		       SUM(REC_AMT) AS REC_AMT,  
		       (SUM(PAY_AMT) - SUM(REC_AMT)) AS JAN,  
		       A.BSNS_SE || A.BUDGET_ACNT_CODE || A.LAD_CODE || A.PRPOS_SE AS BG_LN_Y_CODE,  
		       '1' AS CNT,  
		       '2' AS CNT1,
		       A.BSNS_SE 			AS BSNS_SE,
		       A.BUDGET_ACNT_CODE 	AS BUDGET_ACNT_CODE,
		       A.LAD_CODE 			AS LAD_CODE,
		       A.PRPOS_SE  			AS PRPOS_SE  
		  FROM 
		       (SELECT BUDGET_YEAR,  
		              BSNS_SE,  
		              BUDGET_ACNT_CODE,  
		              LAD_CODE,  
		              PRPOS_SE,  
		              DECODE(DECSN_SE, '1', COUNT(*), 0) AS PAY_CNT,  
		              DECODE(DECSN_SE, '2', COUNT(*), 0) AS REC_CNT,  
		              DECODE(DECSN_SE, '1', SUM(DECSN_AMOUNT), 0) AS PAY_AMT,  
		              DECODE(DECSN_SE, '2', SUM(DECSN_AMOUNT), 0) AS REC_AMT  
		         FROM TBSLS_LAD_DECSN  
		        WHERE 1=1
		          AND SUBSTR(DECSN_DE,1,6) = SUBSTR(#DECSN_DE_FR#,1,6)
		          AND LAD_CODE LIKE '%' || #LAND_CODE_FR# || '%' 
		          AND ( PRPOS_SE IS NULL OR PRPOS_SE LIKE '%' || #PRPOS_SE# || '%' )
		        GROUP BY BUDGET_YEAR, 
		                 BSNS_SE, 
		                 BUDGET_ACNT_CODE, 
		                 LAD_CODE, 
		                 PRPOS_SE, 
		                 DECSN_SE		        
		        UNION ALL
		          SELECT   V.BUDGET_YEAR,
		                   SUBSTR(V.BUDGET_ACNTCTGR,1,1) AS BSNS_SE,
		                   V.BUDGET_ACNTCTGR AS BUDGET_ACNT_CODE,
		                   '999' AS LAD_CODE,  
		                   '99' AS PRPOS_SE, 
		                   (CASE WHEN SUBSTR(#DECSN_DE_FR#,5,2) = '01'  THEN 1 ELSE 0 END) AS PAY_CNT,
		                   (CASE WHEN SUBSTR(#DECSN_DE_FR#,5,2) = '01'  THEN 1 ELSE 0 END) AS REC_CNT,
		                   (CASE WHEN SUBSTR(#DECSN_DE_FR#,5,2) = '01'  THEN AMOUNT ELSE 0 END) AS PAY_AMT,
		                   (CASE WHEN SUBSTR(#DECSN_DE_FR#,5,2) = '01'  THEN AMOUNT ELSE 0 END) AS REC_AMT
		            FROM   TBRNT_PSTYR_ATMPT_AMOUNT V
		           WHERE   1 = 1
		                   AND V.PAY_SE = '2'
		                   AND V.JOB_SE_CODE = 'LAD'	
		                   AND V.BUDGET_YEAR = SUBSTR(#DECSN_DE_FR# ,1,4)	 
		                   AND SUBSTR(#DECSN_DE_FR#,5,2) = '01'		                 
		       ) A  
		 GROUP BY A.BUDGET_YEAR, 
		       A.BSNS_SE, 
		       A.BUDGET_ACNT_CODE, 
		       A.LAD_CODE, 
		       A.PRPOS_SE  
		UNION ALL  
		<!-- 누계조회 -->  
		SELECT NULL AS DECSN_DE,  
		       '      누    계 ' AS SUMRY,  
		       NULL AS CNAME,  
		       NULL AS TEMP1,  
		       NULL AS TEMP2,  
		       NULL AS TEMP3,  
		       MAX(A.PAY_CNT) AS PAY_CNT,  
		       MAX(A.PAY_AMT) AS PAY_AMT,  
		       MAX(A.REC_CNT) AS REC_CNT,  
		       MAX(A.REC_AMT) AS REC_AMT,  
		       (MAX(A.PAY_AMT) - MAX(A.REC_AMT)) AS JAN,  
		       ( A.BSNS_SE || A.BUDGET_ACNT_CODE || A.LAD_CODE || A.PRPOS_SE) AS BG_LN_Y_CODE,  
		       '2' AS CNT, 
		       '2' AS CNT1,
		       A.BSNS_SE 			AS BSNS_SE,
		       A.BUDGET_ACNT_CODE 	AS BUDGET_ACNT_CODE,
		       A.LAD_CODE 			AS LAD_CODE,
		       A.PRPOS_SE  			AS PRPOS_SE  
		  FROM 
		       (SELECT BUDGET_YEAR,  
		              BSNS_SE,  
		              BUDGET_ACNT_CODE,  
		              LAD_CODE,  
		              PRPOS_SE,  
		              DECODE(DECSN_SE, '1', 1, 0) AS PAY_CNT,  
		              DECODE(DECSN_SE, '2', 1, 0) AS REC_CNT,  
                      (CASE WHEN BSNS_SE = '3' 
	                        THEN (SELECT SUM(AMOUNT) 
	                                FROM TBRNT_PSTYR_ATMPT_AMOUNT 
	                               WHERE BUDGET_ACNTCTGR = BUDGET_ACNT_CODE
                                     AND JOB_SE_CODE = 'LAD'
                                     AND PRPOS_CODE = PRPOS_SE
	                                 AND SUBSTR(MDAT_DE , 1,4) = SUBSTR(#DECSN_DE_FR#,1,4))
	                                ELSE DECODE (DECSN_SE, '1', SUM(DECSN_AMOUNT), 0) END) AS PAY_AMT, 
		              DECODE(DECSN_SE, '2', SUM(DECSN_AMOUNT), 0) AS REC_AMT  
		         FROM 
		              (SELECT DECSN_DE,  
		                     LAD_CODE,  
		                     PRPOS_SE,  
		                     BUDGET_YEAR,  
		                     BSNS_SE,  
		                     BUDGET_ACNT_CODE,  
		                     DECSN_SE,  
		                     DECSN_AMOUNT  
		                FROM TBSLS_LAD_DECSN  
		               WHERE SUBSTR(DECSN_DE,1,6) <![CDATA[<=]]> SUBSTR(#DECSN_DE_FR#,1,6)
		                 AND SUBSTR(DECSN_DE,1,4) = SUBSTR(#DECSN_DE_FR#,1,4)
		                 AND LAD_CODE LIKE '%' || #LAND_CODE_FR# || '%' 
		                 AND ( PRPOS_SE IS NULL OR PRPOS_SE LIKE '%' || #PRPOS_SE# || '%' )  
		              )  
		        GROUP BY BUDGET_YEAR, 
		                 BSNS_SE, 
		                 BUDGET_ACNT_CODE, 
		                 LAD_CODE, 
		                 PRPOS_SE, 
		                 DECSN_SE   
				        UNION ALL
				          SELECT   V.BUDGET_YEAR,
				                   SUBSTR(V.BUDGET_ACNTCTGR,1,1) AS BSNS_SE,
				                   V.BUDGET_ACNTCTGR AS BUDGET_ACNT_CODE,
				                   '999' AS LAD_CODE,  
				                   '99' AS PRPOS_SE, 
				                   1 AS PAY_CNT,
				                   1 AS REC_CNT,
				                   V.AMOUNT AS PAY_AMT,
				                   V.AMOUNT AS REC_AMT
				            FROM   TBRNT_PSTYR_ATMPT_AMOUNT V
				           WHERE   1 = 1
				                   AND V.PAY_SE = '2'
				                   AND V.JOB_SE_CODE = 'LAD'	
				                   AND V.BUDGET_YEAR = SUBSTR(#DECSN_DE_FR# ,1,4)	 		                 		                 
		       ) A  
		GROUP BY A.BUDGET_YEAR, 
		          A.BSNS_SE, 
		          A.BUDGET_ACNT_CODE, 
		          A.LAD_CODE, 
		          A.PRPOS_SE    
		ORDER BY BG_LN_Y_CODE, 
		         CNT1, 
		         CNT, 
		         DECSN_DE
		         
	</select>
	
	
	
	<!-- 지구별 수입예산정리부 : 보조장부 -->
	<select id="SLS100300DAO.selectAreaIncmeBdgArngList1" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">

			/* 계정과목 조회 */
			SELECT NULL AS DECSN_DE
			      ,(SELECT '[' || C.BUDGET_ACNT_NM || ']'
			          FROM TBBDG_BUDGET_ACNT_CODE C /* 예산계정코드 */
			         WHERE C.BSNS_SE = A.BSNS_SE
			           AND C.BUDGET_ACNT_CODE = A.BUDGET_ACNT_CODE
			           AND C.YEAR = A.BUDGET_YEAR) AS REMARK
			      ,NULL AS CNAME
			      ,0 AS PAY_CNT
			      ,0 AS PAY_AMT
			      ,0 AS REC_CNT
			      ,0 AS REC_AMT
			      ,0 AS JAN
			      ,'1' AS CNT1
			      ,'1' AS CNT2
			      ,A.BUDGET_ACNT_CODE
			      ,NULL AS LAD_CODE
			  FROM (SELECT BSNS_SE, BUDGET_ACNT_CODE, BUDGET_YEAR
			          FROM TBSLS_LAD_DECSN /* 토지결의 */
			         WHERE 1 = 1
			           AND BUDGET_YEAR = SUBSTR(#DECSN_DE_FR#, 0, 4)
			          
			        <isNotEmpty property="BSNS_SE">
					   AND BSNS_SE = #BSNS_SE#
					</isNotEmpty>
					
					<isNotEmpty property="BUDGET_ACNT_CODE">
					   AND BUDGET_ACNT_CODE = #BUDGET_ACNT_CODE#
					</isNotEmpty>
					
					<isNotEmpty property="LAD_CODE_FR">
					   AND LAD_CODE <![CDATA[ >= ]]> #LAD_CODE_FR#
					</isNotEmpty>
					
					<isNotEmpty property="LAD_CODE_TO">
					   AND LAD_CODE <![CDATA[ <= ]]> #LAD_CODE_TO#
					</isNotEmpty>
					
					<isNotEmpty property="PRPOS_SE">
					   AND PRPOS_SE = #PRPOS_SE#
					</isNotEmpty>
			           
			          ) A
			 GROUP BY A.BUDGET_YEAR, A.BSNS_SE, A.BUDGET_ACNT_CODE
			
			UNION ALL
			/* 토지 지구 조회 */
			SELECT NULL AS DECSN_DE
			      ,(LPAD(' ', 5, ' ') ||
			       (SELECT LAD_NM
			           FROM TBSLS_LAD_INFO /* 토지코드정보 */
			          WHERE BUDGET_YEAR = A.BUDGET_YEAR
			            AND BSNS_SE = A.BSNS_SE
			            AND BUDGET_ACNT_CODE = A.BUDGET_ACNT_CODE
			            AND LAD_CODE = A.LAD_CODE)) AS REMARK
			      ,NULL AS CNAME
			      ,0 AS PAY_CNT
			      ,0 AS PAY_AMT
			      ,0 AS REC_CNT
			      ,0 AS REC_AMT
			      ,0 AS JAN
			      ,'2' AS CNT1
			      ,'1' AS CNT2
			      ,A.BUDGET_ACNT_CODE
			      ,A.LAD_CODE
			  FROM (SELECT BUDGET_YEAR, BSNS_SE, BUDGET_ACNT_CODE, LAD_CODE
			          FROM TBSLS_LAD_DECSN /* 토지결의 */
			         WHERE 1 = 1
			           AND DECSN_DE BETWEEN SUBSTR(#DECSN_DE_FR#, 0, 4) || '0101' AND #DECSN_DE_TO#
			        
			        <isNotEmpty property="BSNS_SE">
					   AND BSNS_SE = #BSNS_SE#
					</isNotEmpty>
					
					<isNotEmpty property="BUDGET_ACNT_CODE">
					   AND BUDGET_ACNT_CODE = #BUDGET_ACNT_CODE#
					</isNotEmpty>
					
					<isNotEmpty property="LAD_CODE_FR">
					   AND LAD_CODE <![CDATA[ >= ]]> #LAD_CODE_FR#
					</isNotEmpty>
					
					<isNotEmpty property="LAD_CODE_TO">
					   AND LAD_CODE <![CDATA[ <= ]]> #LAD_CODE_TO#
					</isNotEmpty>
					
					<isNotEmpty property="PRPOS_SE">
					   AND PRPOS_SE = #PRPOS_SE#
					</isNotEmpty>
			           
			           ) A
			 GROUP BY A.BUDGET_YEAR, A.BSNS_SE, A.BUDGET_ACNT_CODE, A.LAD_CODE
			
			UNION ALL
			/* 내역 조회 */
			SELECT A.DECSN_DE
			      ,(LPAD(' ', 10, ' ') || A.SUMRY || '(' || A.RM || ')') AS REMARK
			      ,A.CSTMR_NM
			      ,SUM(A.PAY_CNT) AS PAY_CNT
			      ,SUM(A.PAY_AMT) AS PAY_AMT
			      ,SUM(A.REC_CNT) AS REC_CNT
			      ,SUM(A.REC_AMT) AS REC_AMT
			      ,SUM(A.PAY_AMT) - SUM(A.REC_AMT) AS JAN
			      ,'3' AS CNT1
			      ,'1' AS CNT2
			      ,A.BUDGET_ACNT_CODE
			      ,A.LAD_CODE
			  FROM (
			        /* 당해년도 수입금 내역 */
			        SELECT A.BUDGET_YEAR
			               ,A.LAD_DECSN_NO
			               ,A.BSNS_SE
			               ,A.BUDGET_ACNT_CODE
			               ,A.LAD_CODE
			               ,A.PRPOS_SE
			               ,A.DECSN_DE
			               ,(SELECT CC.CSTMR_NM
			                   FROM TBSLS_LCNTRCTR C /* 토지계약자 */, TBSLS_LAD_CSTMR CC /* 토지고객 */
			                  WHERE C.LAD_CSTMR_NO = CC.LAD_CSTMR_NO
			                    AND C.LAD_CODE = A.LAD_CODE
			                    AND C.CNTRCTR_NO = A.CNTRCTR_NO
			                    AND C.BLCK = A.BLCK
			                    AND C.LOT = A.LOT
			                    AND C.LOT_TY = A.LOT_TY) AS CSTMR_NM
			               ,A.SUMRY
			               ,A.RM
			               ,B.PAY_CNT
			               ,B.REC_CNT
			               ,B.PAY_AMT
			               ,B.REC_AMT
			          FROM TBSLS_LAD_DECSN A /* 토지결의 */
			               ,(SELECT LAD_DECSN_NO
			                       ,BUDGET_YEAR
			                       ,BSNS_SE
			                       ,BUDGET_ACNT_CODE
			                       ,DECSN_SE
			                       ,LAD_CODE
			                       ,BLCK
			                       ,LOT
			                       ,LOT_TY
			                       ,DECSN_DE
			                       ,DECODE(DECSN_SE, '1', COUNT(*), 0) AS PAY_CNT
			                       ,DECODE(DECSN_SE, '2', COUNT(*), 0) AS REC_CNT
			                       ,DECODE(DECSN_SE, '1', SUM(DECSN_AMOUNT), 0) AS PAY_AMT
			                       ,DECODE(DECSN_SE, '2', SUM(DECSN_AMOUNT), 0) AS REC_AMT
			                   FROM TBSLS_LAD_DECSN /* 토지결의 */
			                  GROUP BY LAD_DECSN_NO
			                          ,BUDGET_YEAR
			                          ,BSNS_SE
			                          ,BUDGET_ACNT_CODE
			                          ,DECSN_SE
			                          ,LAD_CODE
			                          ,BLCK
			                          ,LOT
			                          ,LOT_TY
			                          ,DECSN_DE) B
			         WHERE 1 = 1
			           AND A.DECSN_DE BETWEEN #DECSN_DE_FR# AND #DECSN_DE_TO#
			        
			        <isNotEmpty property="BSNS_SE">
					   AND A.BSNS_SE = #BSNS_SE#
					</isNotEmpty>
					
					<isNotEmpty property="BUDGET_ACNT_CODE">
					   AND A.BUDGET_ACNT_CODE = #BUDGET_ACNT_CODE#
					</isNotEmpty>
					
					<isNotEmpty property="LAD_CODE_FR">
					   AND A.LAD_CODE <![CDATA[ >= ]]> #LAD_CODE_FR#
					</isNotEmpty>
					
					<isNotEmpty property="LAD_CODE_TO">
					   AND A.LAD_CODE <![CDATA[ <= ]]> #LAD_CODE_TO#
					</isNotEmpty>
					
					<isNotEmpty property="PRPOS_SE">
					   AND A.PRPOS_SE = #PRPOS_SE#
					</isNotEmpty>
					
			           AND LENGTH(A.BUDGET_ACNT_CODE) = 7
			           AND A.LAD_DECSN_NO = B.LAD_DECSN_NO
			        
			        ) A
			 GROUP BY A.BUDGET_YEAR
			         ,A.BSNS_SE
			         ,A.BUDGET_ACNT_CODE
			         ,A.LAD_CODE
			         ,A.PRPOS_SE
			         ,A.DECSN_DE
			         ,A.CSTMR_NM
			         ,A.SUMRY
			         ,A.RM
			
			UNION ALL
			/*-- 월계 */
			SELECT NULL AS DECSN_DE
			      ,LPAD(' ', 15, ' ') || ' 월  계 ' AS REMARK
			      ,NULL AS CNAME
			      ,SUM(A.PAY_CNT) AS PAY_CNT
			      ,SUM(A.PAY_AMT) AS PAY_AMT
			      ,SUM(A.REC_CNT) AS REC_CNT
			      ,SUM(A.REC_AMT) AS REC_AMT
			      ,SUM(A.PAY_AMT) - SUM(A.REC_AMT) AS JAN
			      ,'1' AS CNT1
			      ,'2' AS CNT2
			      ,A.BUDGET_ACNT_CODE
			      ,A.LAD_CODE
			  FROM (SELECT BUDGET_YEAR
			              ,BSNS_SE
			              ,BUDGET_ACNT_CODE
			              ,LAD_CODE
			              ,DECODE(DECSN_SE, '1', COUNT(*), 0) AS PAY_CNT
			              ,DECODE(DECSN_SE, '2', COUNT(*), 0) AS REC_CNT
			              ,DECODE(DECSN_SE, '1', SUM(DECSN_AMOUNT), 0) AS PAY_AMT
			              ,DECODE(DECSN_SE, '2', SUM(DECSN_AMOUNT), 0) AS REC_AMT
			          FROM (SELECT BUDGET_YEAR
			                      ,BSNS_SE
			                      ,BUDGET_ACNT_CODE
			                      ,LAD_CODE
			                      ,DECSN_SE
			                      ,DECSN_AMOUNT
			                  FROM TBSLS_LAD_DECSN /* 토지결의 */
			                 WHERE 1 = 1
			           		   AND DECSN_DE BETWEEN SUBSTR(#DECSN_DE_FR#, 0, 6) || '01' AND #DECSN_DE_TO#
			                
			                <isNotEmpty property="BSNS_SE">
							   AND BSNS_SE = #BSNS_SE#
							</isNotEmpty>
							
							<isNotEmpty property="BUDGET_ACNT_CODE">
							   AND BUDGET_ACNT_CODE = #BUDGET_ACNT_CODE#
							</isNotEmpty>
							
							<isNotEmpty property="LAD_CODE_FR">
							   AND LAD_CODE <![CDATA[ >= ]]> #LAD_CODE_FR#
							</isNotEmpty>
							
							<isNotEmpty property="LAD_CODE_TO">
							   AND LAD_CODE <![CDATA[ <= ]]> #LAD_CODE_TO#
							</isNotEmpty>
							
							<isNotEmpty property="PRPOS_SE">
							   AND PRPOS_SE = #PRPOS_SE#
							</isNotEmpty>
							
			                   AND LENGTH(BUDGET_ACNT_CODE) = 7)
			         GROUP BY BUDGET_YEAR, BSNS_SE, BUDGET_ACNT_CODE, LAD_CODE, DECSN_SE) A
			 GROUP BY A.BUDGET_YEAR, A.BSNS_SE, A.BUDGET_ACNT_CODE, A.LAD_CODE
			
			UNION ALL
			/*--  누계 */
			SELECT NULL AS DECSN_DE
			      ,LPAD(' ', 15, ' ') || ' 누  계 ' AS REMARK
			      ,NULL AS CNAME
			      ,SUM(A.PAY_CNT) AS PAY_CNT
			      ,SUM(A.PAY_AMT) AS PAY_AMT
			      ,SUM(A.REC_CNT) AS REC_CNT
			      ,SUM(A.REC_AMT) AS REC_AMT
			      ,SUM(A.PAY_AMT) - SUM(A.REC_AMT) AS JAN
			      ,'2' AS CNT1
			      ,'2' AS CNT2
			      ,A.BUDGET_ACNT_CODE
			      ,A.LAD_CODE
			  FROM (SELECT BUDGET_YEAR
			              ,BSNS_SE
			              ,BUDGET_ACNT_CODE
			              ,LAD_CODE
			              ,DECODE(DECSN_SE, '1', COUNT(*), 0) AS PAY_CNT
			              ,DECODE(DECSN_SE, '2', COUNT(*), 0) AS REC_CNT              
	                      ,(CASE WHEN BSNS_SE = '3' 
	                             THEN (SELECT SUM(AMOUNT) 
	                                     FROM TBRNT_PSTYR_ATMPT_AMOUNT 
	                                    WHERE BUDGET_ACNTCTGR = BUDGET_ACNT_CODE
	                                      AND SUBSTR(MDAT_DE , 1,4) = SUBSTR(#DECSN_DE_FR#,1,4))
	                                   ELSE DECODE (DECSN_SE, '1', SUM(DECSN_AMOUNT), 0) END) AS PAY_AMT
			              ,DECODE(DECSN_SE, '2', SUM(DECSN_AMOUNT), 0) AS REC_AMT
			          FROM (SELECT BUDGET_YEAR
			                      ,BSNS_SE
			                      ,BUDGET_ACNT_CODE
			                      ,LAD_CODE
			                      ,DECSN_SE
			                      ,DECSN_AMOUNT
			                  FROM TBSLS_LAD_DECSN /* 토지결의 */
			                 WHERE 1 = 1
			           		   AND DECSN_DE BETWEEN SUBSTR(#DECSN_DE_FR#, 0, 4) || '0101' AND #DECSN_DE_TO#
			                
			                <isNotEmpty property="BSNS_SE">
							   AND BSNS_SE = #BSNS_SE#
							</isNotEmpty>
							
							<isNotEmpty property="BUDGET_ACNT_CODE">
							   AND BUDGET_ACNT_CODE = #BUDGET_ACNT_CODE#
							</isNotEmpty>
							
							<isNotEmpty property="LAD_CODE_FR">
							   AND LAD_CODE <![CDATA[ >= ]]> #LAD_CODE_FR#
							</isNotEmpty>
							
							<isNotEmpty property="LAD_CODE_TO">
							   AND LAD_CODE <![CDATA[ <= ]]> #LAD_CODE_TO#
							</isNotEmpty>
							
							<isNotEmpty property="PRPOS_SE">
							   AND PRPOS_SE = #PRPOS_SE#
							</isNotEmpty>
							
			                   AND LENGTH(BUDGET_ACNT_CODE) = 7)
			         GROUP BY BUDGET_YEAR, BSNS_SE, BUDGET_ACNT_CODE, LAD_CODE, DECSN_SE) A
			 GROUP BY A.BUDGET_YEAR, A.BSNS_SE, A.BUDGET_ACNT_CODE, A.LAD_CODE
			
			 ORDER BY BUDGET_ACNT_CODE, LAD_CODE DESC, CNT2, CNT1, DECSN_DE

	</select>
	
	<!-- 지구별 수입예산정리부 : 집계표 -->
	<select id="SLS100300DAO.selectAreaIncmeBdgArngList2" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
	
			SELECT NULL AS DECSN_DE
			      ,(SELECT '[' || C.BUDGET_ACNT_NM || ']'
			          FROM TBBDG_BUDGET_ACNT_CODE C
			         WHERE C.BSNS_SE = A.BSNS_SE
			           AND C.BUDGET_ACNT_CODE = A.BUDGET_ACNT_CODE
			           AND C.YEAR = A.BUDGET_YEAR) AS REMARK
			      ,NULL AS CNAME
			      ,0 AS PAY_CNT
			      ,0 AS PAY_AMT
			      ,0 AS REC_CNT
			      ,0 AS REC_AMT
			      ,0 AS JAN
			      ,'1' AS CNT1
			      ,'1' AS CNT2
			      ,A.BUDGET_ACNT_CODE
			      ,NULL AS LAD_CODE
			  FROM (SELECT BSNS_SE, BUDGET_ACNT_CODE, BUDGET_YEAR
			          FROM TBSLS_LAD_DECSN /* 토지결의 */
			         WHERE 1 = 1
			           AND BUDGET_YEAR = SUBSTR(#DECSN_DE_FR#, 0, 4)
			        
			        <isNotEmpty property="BSNS_SE">
					   AND BSNS_SE = #BSNS_SE#
					</isNotEmpty>
					
					<isNotEmpty property="BUDGET_ACNT_CODE">
					   AND BUDGET_ACNT_CODE = #BUDGET_ACNT_CODE#
					</isNotEmpty>
					
					<isNotEmpty property="LAD_CODE_FR">
					   AND LAD_CODE <![CDATA[ >= ]]> #LAD_CODE_FR#
					</isNotEmpty>
					
					<isNotEmpty property="LAD_CODE_TO">
					   AND LAD_CODE <![CDATA[ <= ]]> #LAD_CODE_TO#
					</isNotEmpty>
					
					<isNotEmpty property="PRPOS_SE">
					   AND PRPOS_SE = #PRPOS_SE#
					</isNotEmpty>
					
			           AND LENGTH(BUDGET_ACNT_CODE) = 7
			        ) A
			 GROUP BY A.BUDGET_YEAR, A.BSNS_SE, A.BUDGET_ACNT_CODE
			
			UNION ALL
			
			SELECT NULL AS DECSN_DE
			      ,(LPAD(' ', 5, ' ') ||
			       (SELECT LAD_NM FROM TBSLS_LAD_INFO WHERE LAD_CODE = A.LAD_CODE)) AS REMARK
			      ,' 합    계 ' AS CNAME
			      ,MAX(A.PAY_CNT) AS PAY_CNT
			      ,MAX(A.PAY_AMT) AS PAY_AMT
			      ,MAX(A.REC_CNT) AS REC_CNT
			      ,MAX(A.REC_AMT) AS REC_AMT
			      ,(MAX(A.PAY_AMT) - MAX(A.REC_AMT)) AS JAN
			      ,'2' AS CNT1
			      ,'1' AS CNT2
			      ,A.BUDGET_ACNT_CODE
			      ,A.LAD_CODE
			  FROM (SELECT BUDGET_YEAR
			              ,BSNS_SE
			              ,BUDGET_ACNT_CODE
			              ,LAD_CODE
			              ,DECODE(DECSN_SE, '1', COUNT(*), 0) AS PAY_CNT
			              ,DECODE(DECSN_SE, '2', COUNT(*), 0) AS REC_CNT
			              ,DECODE(DECSN_SE, '1', SUM(DECSN_AMOUNT), 0) AS PAY_AMT
			              ,DECODE(DECSN_SE, '2', SUM(DECSN_AMOUNT), 0) AS REC_AMT
			          FROM (SELECT BUDGET_YEAR
			                      ,BSNS_SE
			                      ,BUDGET_ACNT_CODE
			                      ,LAD_CODE
			                      ,DECSN_SE
			                      ,DECSN_AMOUNT
			                  FROM TBSLS_LAD_DECSN /* 토지결의 */
			                 WHERE 1 = 1
			           		   AND DECSN_DE BETWEEN SUBSTR(#DECSN_DE_FR#, 0, 4) || '0101' AND #DECSN_DE_FR#
			                   
							<isNotEmpty property="BSNS_SE">
							   AND BSNS_SE = #BSNS_SE#
							</isNotEmpty>
							
							<isNotEmpty property="BUDGET_ACNT_CODE">
							   AND BUDGET_ACNT_CODE = #BUDGET_ACNT_CODE#
							</isNotEmpty>
							
							<isNotEmpty property="LAD_CODE_FR">
							   AND LAD_CODE <![CDATA[ >= ]]> #LAD_CODE_FR#
							</isNotEmpty>
							
							<isNotEmpty property="LAD_CODE_TO">
							   AND LAD_CODE <![CDATA[ <= ]]> #LAD_CODE_TO#
							</isNotEmpty>
							
							<isNotEmpty property="PRPOS_SE">
							   AND PRPOS_SE = #PRPOS_SE#
							</isNotEmpty>
					
			                   AND LENGTH(BUDGET_ACNT_CODE) = 7
			                )
			         GROUP BY BUDGET_YEAR, BSNS_SE, BUDGET_ACNT_CODE, LAD_CODE, DECSN_SE) A
			 GROUP BY A.BUDGET_YEAR, A.BSNS_SE, A.BUDGET_ACNT_CODE, A.LAD_CODE
			
			UNION ALL
			
			SELECT NULL AS DECSN_DE
			      ,(LPAD(' ', 10, ' ') || SFCMP_GET_CODENM('LAD003', A.PRPOS_SE)) AS REMARK
			      ,NULL AS CNAME
			      ,MAX(A.PAY_CNT) AS PAY_CNT
			      ,MAX(A.PAY_AMT) AS PAY_AMT
			      ,MAX(A.REC_CNT) AS REC_CNT
			      ,MAX(A.REC_AMT) AS REC_AMT
			      ,(MAX(A.PAY_AMT) - MAX(A.REC_AMT)) AS JAN
			      ,'3' AS CNT1
			      ,'1' AS CNT2
			      ,A.BUDGET_ACNT_CODE
			      ,A.LAD_CODE
			  FROM (SELECT BUDGET_YEAR
			              ,BSNS_SE
			              ,BUDGET_ACNT_CODE
			              ,LAD_CODE
			              ,PRPOS_SE
			              ,DECODE(DECSN_SE, '1', COUNT(*), 0) AS PAY_CNT
			              ,DECODE(DECSN_SE, '2', COUNT(*), 0) AS REC_CNT
			              ,DECODE(DECSN_SE, '1', SUM(DECSN_AMOUNT), 0) AS PAY_AMT
			              ,DECODE(DECSN_SE, '2', SUM(DECSN_AMOUNT), 0) AS REC_AMT
			          FROM (SELECT BUDGET_YEAR
			                      ,BSNS_SE
			                      ,BUDGET_ACNT_CODE
			                      ,LAD_CODE
			                      ,PRPOS_SE
			                      ,DECSN_SE
			                      ,DECSN_AMOUNT
			                  FROM TBSLS_LAD_DECSN /* 토지결의 */
			                 WHERE 1 = 1
			           		   AND DECSN_DE BETWEEN SUBSTR(#DECSN_DE_FR#, 0, 4) || '0101' AND #DECSN_DE_FR#
			                   
			                <isNotEmpty property="BSNS_SE">
							   AND BSNS_SE = #BSNS_SE#
							</isNotEmpty>
							
							<isNotEmpty property="BUDGET_ACNT_CODE">
							   AND BUDGET_ACNT_CODE = #BUDGET_ACNT_CODE#
							</isNotEmpty>
							
							<isNotEmpty property="LAD_CODE_FR">
							   AND LAD_CODE <![CDATA[ >= ]]> #LAD_CODE_FR#
							</isNotEmpty>
							
							<isNotEmpty property="LAD_CODE_TO">
							   AND LAD_CODE <![CDATA[ <= ]]> #LAD_CODE_TO#
							</isNotEmpty>
							
							<isNotEmpty property="PRPOS_SE">
							   AND PRPOS_SE = #PRPOS_SE#
							</isNotEmpty>
							
			                   AND LENGTH(BUDGET_ACNT_CODE) = 7
			                
			                )
			         GROUP BY BUDGET_YEAR
			                 ,BSNS_SE
			                 ,BUDGET_ACNT_CODE
			                 ,LAD_CODE
			                 ,DECSN_SE
			                 ,PRPOS_SE) A
			 GROUP BY A.BUDGET_YEAR
			         ,A.BSNS_SE
			         ,A.BUDGET_ACNT_CODE
			         ,A.LAD_CODE
			         ,A.PRPOS_SE
			
			UNION ALL
			
			SELECT NULL AS DECSN_DE
			      ,' 계정항목 집계 ' AS REMARK
			      ,NULL AS CNAME
			      ,MAX(A.PAY_CNT) AS PAY_CNT
			      ,MAX(A.PAY_AMT) AS PAY_AMT
			      ,MAX(A.REC_CNT) AS REC_CNT
			      ,MAX(A.REC_AMT) AS REC_AMT
			      ,(MAX(A.PAY_AMT) - MAX(A.REC_AMT)) AS JAN
			      ,'2' AS CNT1
			      ,'2' AS CNT2
			      ,A.BUDGET_ACNT_CODE
			      ,NULL AS LAD_CODE
			  FROM (SELECT BUDGET_YEAR
			              ,BSNS_SE
			              ,BUDGET_ACNT_CODE
			              ,DECODE(DECSN_SE, '1', COUNT(*), 0) AS PAY_CNT
			              ,DECODE(DECSN_SE, '2', COUNT(*), 0) AS REC_CNT
			              ,DECODE(DECSN_SE, '1', SUM(DECSN_AMOUNT), 0) AS PAY_AMT
			              ,DECODE(DECSN_SE, '2', SUM(DECSN_AMOUNT), 0) AS REC_AMT
			          FROM (SELECT BUDGET_YEAR
			                      ,BSNS_SE
			                      ,BUDGET_ACNT_CODE
			                      ,LAD_CODE
			                      ,DECSN_SE
			                      ,DECSN_AMOUNT
			                  FROM TBSLS_LAD_DECSN /* 토지결의 */
			                 WHERE 1 = 1
			           		   AND DECSN_DE BETWEEN SUBSTR(#DECSN_DE_FR#, 0, 4) || '0101' AND #DECSN_DE_FR#
			                
			                <isNotEmpty property="BSNS_SE">
							   AND BSNS_SE = #BSNS_SE#
							</isNotEmpty>
							
							<isNotEmpty property="BUDGET_ACNT_CODE">
							   AND BUDGET_ACNT_CODE = #BUDGET_ACNT_CODE#
							</isNotEmpty>
							
							<isNotEmpty property="LAD_CODE_FR">
							   AND LAD_CODE <![CDATA[ >= ]]> #LAD_CODE_FR#
							</isNotEmpty>
							
							<isNotEmpty property="LAD_CODE_TO">
							   AND LAD_CODE <![CDATA[ <= ]]> #LAD_CODE_TO#
							</isNotEmpty>
							
							<isNotEmpty property="PRPOS_SE">
							   AND PRPOS_SE = #PRPOS_SE#
							</isNotEmpty>
					
			                   AND LENGTH(BUDGET_ACNT_CODE) = 7)
			         GROUP BY BUDGET_YEAR, BSNS_SE, BUDGET_ACNT_CODE, DECSN_SE) A
			 GROUP BY A.BUDGET_YEAR, A.BSNS_SE, A.BUDGET_ACNT_CODE
			
			 ORDER BY BUDGET_ACNT_CODE, CNT2, LAD_CODE DESC
	
	</select>
	
</sqlMap>