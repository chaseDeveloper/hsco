<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="RNT01060400SQL">	

	<!-- 쿼리명 : 수입조정현황보고조회
	설명 : 수입조정현황보고조회
	수정일  수정자  수정내용	
	작성자 : 박병일
	최초작성일 : 2016.03.02
	-->
	<select id="RNT02060400DAO.selectIncmeMSttusR1" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        WITH V1 AS ( SELECT MDAT_DE
                           ,BUDGET_YEAR
                           ,BSNS_SE
                           ,BUDGET_ACNT_CODE
                           ,EXPNDTR_UNIT_CODE
                           ,KWAN
                           ,HANG
                           ,HANG_CODE
                           ,SEHANG
                           ,SEHANG_CODE
                           ,MOK
                           ,SUM(PAY_CNT) AS PAY_CNT
                           ,SUM(PAY_AMT) AS PAY_AMT
                           ,SUM(REC_CNT) AS REC_CNT
                           ,SUM(REC_AMT) AS REC_AMT
                      FROM (   SELECT V.MDAT_DE
                                     ,V.BUDGET_YEAR
                                     ,V.BSNS_SE
                                     ,V.BUDGET_ACNT_CODE
                                     ,V.EXPNDTR_UNIT_CODE
                                     ,D.GWAN_NM     AS KWAN
                                     ,D.HANG_NM     AS HANG
                                     ,D.HANG_CD     AS HANG_CODE
                                     ,D.SEHANG_NM     AS SEHANG
                                     ,D.SEHANG_CD     AS SEHANG_CODE
                                     ,D.MOK_NM         AS MOK
                                     ,V.OCCRRNC_CO     AS PAY_CNT
                                     ,V.ANACT_AMOUNT AS PAY_AMT
                                     ,0             AS REC_CNT
                                     ,0             AS REC_AMT
                                FROM TBRNT_PUCHAS_ANACT V,
                                     VHBDG_BUDGET_ACNT_CODE D
                               WHERE 1=1
                                 AND V.ANACT_SE IN ('1', '4')
                                 AND V.BUDGET_YEAR = D.YEAR
                                 AND V.BSNS_SE = D.BSNS_SE
                                 AND V.BUDGET_ACNT_CODE = D.BUDGET_ACNT_CODE
                               UNION ALL
                               SELECT V.MDAT_DE
                                     ,V.BUDGET_YEAR
                                     ,V.BSNS_SE
                                     ,V.BUDGET_ACNT_CODE
                                     ,V.EXPNDTR_UNIT_CODE
                                     ,D.GWAN_NM AS KWAN
                                     ,D.HANG_NM AS HANG
                                     ,D.HANG_CD AS HANG_CODE
                                     ,D.SEHANG_NM AS SEHANG
                                     ,D.SEHANG_CD AS SEHANG_CODE
                                     ,D.MOK_NM AS MOK
                                     ,0 AS PAY_CNT
                                     ,0 AS PAY_AMT
                                     ,V.OCCRRNC_CO
                                     ,V.ANACT_AMOUNT
                                FROM TBRNT_PUCHAS_ANACT V,
                                     VHBDG_BUDGET_ACNT_CODE D
                               WHERE 1=1
                                 AND V.ANACT_SE IN ('2', '3')
                                 AND V.BUDGET_YEAR = D.YEAR
                                 AND V.BSNS_SE = D.BSNS_SE
                                 AND V.BUDGET_ACNT_CODE = D.BUDGET_ACNT_CODE
                           )
                     GROUP BY MDAT_DE
                            , BUDGET_YEAR
                            , BSNS_SE
                            , BUDGET_ACNT_CODE
                            , EXPNDTR_UNIT_CODE
                            , KWAN
                            , HANG
                            , HANG_CODE
                            , SEHANG
                            , SEHANG_CODE
                            , MOK
        )
        , V2 AS ( SELECT  D.GWAN_NM AS KWAN
                         ,D.HANG_NM AS HANG
                         ,D.HANG_CD AS HANG_CODE
                         ,D.SEHANG_NM AS SEHANG
                         ,D.SEHANG_CD AS SEHANG_CODE
                         ,D.MOK_NM AS MOK
                         ,V.MDAT_DE
                         ,V.BUDGET_YEAR
                         ,SUBSTR(V.BUDGET_ACNT_SE,1,1) AS BSNS_SE
                         ,V.BUDGET_ACNTCTGR AS BUDGET_ACNT_CODE
                         ,V.BUKIP_CODE AS EXPNDTR_UNIT_CODE
                         ,V.AMOUNT AS PAY_AMT
                         ,1 AS PAY_CNT
                         ,V.PAY_SE
                    FROM TBRNT_PSTYR_ATMPT_AMOUNT V
                        ,VHBDG_BUDGET_ACNT_CODE D
                   WHERE 1=1
                     AND V.BUDGET_YEAR = D.YEAR
                     AND V.BUDGET_ACNT_SE = D.BSNS_SE || D.BALC_SE
                     AND V.BUDGET_ACNTCTGR = D.BUDGET_ACNT_CODE
                     AND V.JOB_SE_CODE = 'RN2'
        )
        SELECT ORD
              ,ORD1
              ,KWAN
              ,HANG
              ,HANG_CODE
              ,SEHANG
              ,SEHANG_CODE
              ,MOK
              ,BSNS_SE
              ,BUDGET_ACNT_CODE
              ,COL_TITLE
              ,SUM(PAY_CNT) AS PAY_CNT
              ,SUM(PAY_AMT) AS PAY_AMT
              ,SUM(REC_CNT) AS REC_CNT
              ,SUM(REC_AMT) AS REC_AMT
              ,SUM(PAY_CNTT) AS PAY_CNTT
              ,SUM(PAY_AMTT) AS PAY_AMTT
              ,SUM(REC_CNTT) AS REC_CNTT
              ,SUM(REC_AMTT) AS REC_AMTT
              ,SUM(PAY_AMTT) - SUM(REC_AMTT) AS DEL_AMT
          FROM
               (
                 SELECT '1'         AS ORD
                        ,'1'         AS ORD1
                        ,'총    계' AS KWAN
                        ,NULL         AS HANG
                        ,NULL         AS HANG_CODE
                        ,NULL         AS SEHANG
                        ,NULL         AS SEHANG_CODE
                        ,NULL         AS MOK
                        ,'1'         AS BSNS_SE
                        ,'1'         AS BUDGET_ACNT_CODE
                        ,'          총                 계' AS COL_TITLE
                        ,SUM(PAY_CNT) AS PAY_CNT
                        ,SUM(PAY_AMT) AS PAY_AMT
                        ,SUM(REC_CNT) AS REC_CNT
                        ,SUM(REC_AMT) AS REC_AMT
                        ,0 AS PAY_CNTT
                        ,0 AS PAY_AMTT
                        ,0 AS REC_CNTT
                        ,0 AS REC_AMTT
                   FROM V1
                  WHERE 1=1
                    AND MDAT_DE BETWEEN #APPLC_DE# AND #APPLC_DE_TO#
                  UNION ALL
                 SELECT '2' ORD
                        ,'2' AS ORD1
                        ,KWAN
                        ,NULL AS HANG
                        ,'1' AS HANG_CODE
                        ,NULL AS SEHANG
                        ,NULL AS SEHANG_CODE
                        ,NULL AS MOK
                        ,BSNS_SE
                        ,'1' AS BUDGET_ACNT_CODE
                        ,KWAN AS COL_TITLE
                        ,SUM(PAY_CNT) AS PAY_CNT
                        ,SUM(PAY_AMT) AS PAY_AMT
                        ,SUM(REC_CNT) AS REC_CNT
                        ,SUM(REC_AMT) AS REC_AMT
                        ,0 AS PAY_CNTT
                        ,0 AS PAY_AMTT
                        ,0 AS REC_CNTT
                        ,0 AS REC_AMTT
                   FROM V1
                  WHERE 1=1
                    AND MDAT_DE BETWEEN #APPLC_DE# AND #APPLC_DE_TO#
                  GROUP BY KWAN
                          ,BSNS_SE
                   UNION ALL
               SELECT '3' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,NULL AS SEHANG
                      ,'1' AS SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'2' AS BUDGET_ACNT_CODE
                      ,LPAD(' ',5,' ') || HANG AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,SUM(REC_CNT) AS REC_CNT
                      ,SUM(REC_AMT) AS REC_AMT
                      ,0 AS PAY_CNTT
                      ,0 AS PAY_AMTT
                      ,0 AS REC_CNTT
                      ,0 AS REC_AMTT
                 FROM V1
                WHERE 1=1
                  AND MDAT_DE BETWEEN #APPLC_DE# AND #APPLC_DE_TO#
                GROUP BY KWAN
                        ,HANG
                        ,BSNS_SE
                        ,HANG_CODE
                   UNION ALL
               SELECT '4' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,SEHANG
                      ,SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'3' AS BUDGET_ACNT_CODE
                      ,LPAD(' ',14,' ') || SEHANG AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,SUM(REC_CNT) AS REC_CNT
                      ,SUM(REC_AMT) AS REC_AMT
                      ,0 AS PAY_CNTT
                      ,0 AS PAY_AMTT
                      ,0 AS REC_CNTT
                      ,0 AS REC_AMTT
                 FROM V1
                WHERE 1=1
                  AND MDAT_DE BETWEEN #APPLC_DE# AND #APPLC_DE_TO#
                GROUP BY KWAN
                        ,HANG
                        ,HANG_CODE
                        ,SEHANG
                        ,SEHANG_CODE
                        ,BSNS_SE
                   UNION ALL
               SELECT '5' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,SEHANG
                      ,SEHANG_CODE
                      ,MOK
                      ,BSNS_SE
                      ,BUDGET_ACNT_CODE
                      ,LPAD(' ',24,' ') || MOK AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,SUM(REC_CNT) AS REC_CNT
                      ,SUM(REC_AMT) AS REC_AMT
                      ,0 AS PAY_CNTT
                      ,0 AS PAY_AMTT
                      ,0 AS REC_CNTT
                      ,0 AS REC_AMTT
                 FROM V1
                WHERE 1=1
                  AND MDAT_DE BETWEEN #APPLC_DE# AND #APPLC_DE_TO#
                GROUP BY KWAN
                        ,HANG
                        ,HANG_CODE
                        ,SEHANG
                        ,SEHANG_CODE
                        ,MOK
                        ,BSNS_SE
                        ,BUDGET_ACNT_CODE
               UNION ALL
                 SELECT '1'         AS ORD
                        ,'1'         AS ORD1
                        ,'총    계' AS KWAN
                        ,NULL         AS HANG
                        ,NULL         AS HANG_CODE
                        ,NULL         AS SEHANG
                        ,NULL         AS SEHANG_CODE
                        ,NULL         AS MOK
                        ,'1'         AS BSNS_SE
                        ,'1'         AS BUDGET_ACNT_CODE
                        ,'          총                 계' AS COL_TITLE
                        ,0 AS PAY_CNT
                        ,0 AS PAY_AMT
                        ,0 AS REC_CNT
                        ,0 AS REC_AMT
                        ,SUM(PAY_CNT) AS PAY_CNTT
                        ,SUM(PAY_AMT) AS PAY_AMTT
                        ,SUM(REC_CNT) AS REC_CNTT
                        ,SUM(REC_AMT) AS REC_AMTT
                   FROM V1
                  WHERE 1=1
                    AND MDAT_DE BETWEEN SUBSTR(#APPLC_DE#,1,4) || '0101' AND #APPLC_DE_TO#
                  UNION ALL
                 SELECT '2' ORD
                        ,'2' AS ORD1
                        ,KWAN
                        ,NULL AS HANG
                        ,'1' AS HANG_CODE
                        ,NULL AS SEHANG
                        ,NULL AS SEHANG_CODE
                        ,NULL AS MOK
                        ,BSNS_SE
                        ,'1' AS BUDGET_ACNT_CODE
                        ,KWAN AS COL_TITLE
                        ,0 AS PAY_CNT
                        ,0 AS PAY_AMT
                        ,0 AS REC_CNT
                        ,0 AS REC_AMT
                        ,SUM(PAY_CNT) AS PAY_CNTT
                        ,SUM(PAY_AMT) AS PAY_AMTT
                        ,SUM(REC_CNT) AS REC_CNTT
                        ,SUM(REC_AMT) AS REC_AMTT
                   FROM V1
                  WHERE 1=1
                    AND MDAT_DE BETWEEN SUBSTR(#APPLC_DE#,1,4) || '0101' AND #APPLC_DE_TO#
                  GROUP BY KWAN
                          ,BSNS_SE
                   UNION ALL
               SELECT '3' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,NULL AS SEHANG
                      ,'1' AS SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'2' AS BUDGET_ACNT_CODE
                      ,LPAD(' ',5,' ') || HANG AS COL_TITLE
                      ,0 AS PAY_CNT
                      ,0 AS PAY_AMT
                      ,0 AS REC_CNT
                      ,0 AS REC_AMT
                      ,SUM(PAY_CNT) AS PAY_CNTT
                      ,SUM(PAY_AMT) AS PAY_AMTT
                      ,SUM(REC_CNT) AS REC_CNTT
                      ,SUM(REC_AMT) AS REC_AMTT
                 FROM V1
                WHERE 1=1
                  AND MDAT_DE BETWEEN SUBSTR(#APPLC_DE#,1,4) || '0101' AND #APPLC_DE_TO#
                GROUP BY KWAN
                        ,HANG
                        ,BSNS_SE
                        ,HANG_CODE
                   UNION ALL
               SELECT '4' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,SEHANG
                      ,SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'3' AS BUDGET_ACNT_CODE
                      ,LPAD(' ',14,' ') || SEHANG AS COL_TITLE
                      ,0 AS PAY_CNT
                      ,0 AS PAY_AMT
                      ,0 AS REC_CNT
                      ,0 AS REC_AMT
                      ,SUM(PAY_CNT) AS PAY_CNTT
                      ,SUM(PAY_AMT) AS PAY_AMTT
                      ,SUM(REC_CNT) AS REC_CNTT
                      ,SUM(REC_AMT) AS REC_AMTT
                 FROM V1
                WHERE 1=1
                  AND MDAT_DE BETWEEN SUBSTR(#APPLC_DE#,1,4) || '0101' AND #APPLC_DE_TO#
                GROUP BY KWAN
                        ,HANG
                        ,HANG_CODE
                        ,SEHANG
                        ,SEHANG_CODE
                        ,BSNS_SE
                   UNION ALL
               SELECT '5' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,SEHANG
                      ,SEHANG_CODE
                      ,MOK
                      ,BSNS_SE
                      ,BUDGET_ACNT_CODE
                      ,LPAD(' ',24,' ') || MOK AS COL_TITLE
                      ,0 AS PAY_CNT
                      ,0 AS PAY_AMT
                      ,0 AS REC_CNT
                      ,0 AS REC_AMT
                      ,SUM(PAY_CNT) AS PAY_CNTT
                      ,SUM(PAY_AMT) AS PAY_AMTT
                      ,SUM(REC_CNT) AS REC_CNTT
                      ,SUM(REC_AMT) AS REC_AMTT
                 FROM V1
                WHERE 1=1
                  AND MDAT_DE BETWEEN SUBSTR(#APPLC_DE#,1,4) || '0101' AND #APPLC_DE_TO#
                GROUP BY KWAN
                        ,HANG
                        ,HANG_CODE
                        ,SEHANG
                        ,SEHANG_CODE
                        ,MOK
                        ,BSNS_SE
                        ,BUDGET_ACNT_CODE
               UNION ALL
               SELECT '1' ORD
                      ,'1' AS ORD1
                      ,'총    계' KWAN
                      ,NULL AS HANG
                      ,NULL AS HANG_CODE
                      ,NULL AS SEHANG
                      ,NULL AS SEHANG_CODE
                      ,NULL AS MOK
                      ,'1' AS BSNS_SE
                      ,'1' AS BUDGET_ACNT_CODE
                      ,'          총                 계' AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,(CASE WHEN PAY_SE = '2'
                             THEN SUM(PAY_CNT)
                             ELSE 0
                        END) AS REC_CNT
                      ,(CASE WHEN PAY_SE = '2'
                             THEN SUM(PAY_AMT)
                             ELSE 0
                        END) AS REC_AMT
                      ,0 AS PAY_CNTT
                      ,0 AS PAY_AMTT
                      ,0 AS REC_CNTT
                      ,0 AS REC_AMTT
                 FROM V2
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_DE#,1,4)
                GROUP BY PAY_SE
               UNION ALL
               SELECT '2' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,NULL AS HANG
                      ,'1' AS HANG_CODE
                      ,NULL AS SEHANG
                      ,NULL AS SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'1' AS BUDGET_ACNT_CODE
                      ,KWAN AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,(CASE WHEN PAY_SE = '2'
                             THEN SUM(PAY_CNT)
                             ELSE 0
                        END) AS REC_CNT
                      ,(CASE WHEN PAY_SE = '2'
                             THEN SUM(PAY_AMT)
                             ELSE 0
                        END) AS REC_AMT
                      ,0 AS PAY_CNTT
                      ,0 AS PAY_AMTT
                      ,0 AS REC_CNTT
                      ,0 AS REC_AMTT
                 FROM V2
                WHERE SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_DE#,1,4)
                GROUP BY KWAN
                        ,BSNS_SE
                        ,PAY_SE
               UNION ALL
               SELECT '3' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,NULL AS SEHANG
                      ,'1' AS SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'2' AS BUDGET_ACNT_CODE
                      ,LPAD(' ',5,' ') || HANG AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,(CASE WHEN PAY_SE = '2'
                             THEN SUM(PAY_CNT)
                             ELSE 0
                        END) AS REC_CNT
                      ,(CASE WHEN PAY_SE = '2'
                             THEN SUM(PAY_AMT)
                             ELSE 0
                        END) AS REC_AMT
                      ,0 AS PAY_CNTT
                      ,0 AS PAY_AMTT
                      ,0 AS REC_CNTT
                      ,0 AS REC_AMTT
                 FROM V2
                WHERE SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_DE#,1,4)
                GROUP BY KWAN
                        ,HANG
                        ,BSNS_SE
                        ,HANG_CODE
                        ,PAY_SE
               UNION ALL
               SELECT '4' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,SEHANG
                      ,SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'3' AS BUDGET_ACNT_CODE
                      ,LPAD(' ',14,' ') || SEHANG AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,(CASE WHEN PAY_SE = '2'
                             THEN SUM(PAY_CNT)
                             ELSE 0
                        END) AS REC_CNT
                      ,(CASE WHEN PAY_SE = '2'
                             THEN SUM(PAY_AMT)
                             ELSE 0
                        END) AS REC_AMT
                      ,0 AS PAY_CNTT
                      ,0 AS PAY_AMTT
                      ,0 AS REC_CNTT
                      ,0 AS REC_AMTT
                 FROM V2
                WHERE SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_DE#,1,4)
                GROUP BY KWAN
                        ,HANG
                        ,HANG_CODE
                        ,SEHANG
                        ,SEHANG_CODE
                        ,BSNS_SE
                        ,PAY_SE
               UNION ALL
               SELECT '5' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,SEHANG
                      ,SEHANG_CODE
                      ,MOK
                      ,BSNS_SE
                      ,BUDGET_ACNT_CODE
                      ,LPAD(' ',24,' ') || MOK AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,(CASE WHEN PAY_SE = '2'
                             THEN SUM(PAY_CNT)
                             ELSE 0
                        END) AS REC_CNT
                      ,(CASE WHEN PAY_SE = '2'
                             THEN SUM(PAY_AMT)
                             ELSE 0
                        END) AS REC_AMT
                      ,0 AS PAY_CNTT
                      ,0 AS PAY_AMTT
                      ,0 AS REC_CNTT
                      ,0 AS REC_AMTT
                 FROM V2
                WHERE SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_DE#,1,4)
                GROUP BY KWAN
                        ,HANG
                        ,HANG_CODE
                        ,SEHANG
                        ,SEHANG_CODE
                        ,MOK
                        ,BSNS_SE
                        ,BUDGET_ACNT_CODE
                        ,PAY_SE
                       )
         GROUP BY ORD
                 ,ORD1
                 ,KWAN
                 ,HANG
                 ,HANG_CODE
                 ,SEHANG
                 ,SEHANG_CODE
                 ,MOK
                 ,BSNS_SE
                 ,BUDGET_ACNT_CODE
                 ,COL_TITLE
        ORDER BY ORD1
                 ,BSNS_SE
                 ,HANG_CODE
                 ,SEHANG_CODE
                 ,ORD
                 ,BUDGET_ACNT_CODE
    </select>
    
	<!-- 쿼리명 : 당월임대료미수금현황조회
	설명 : 당월임대료미수금현황조회
	수정일  수정자  수정내용	
	작성자 : 박병일
	최초작성일 : 2016.03.02
	-->
	<select id="RNT02060400DAO.selectThsmonRntChrgAtmptList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        WITH V1 AS ( SELECT MDAT_DE
                           ,BUDGET_YEAR
                           ,BSNS_SE
                           ,BUDGET_ACNT_CODE
                           ,EXPNDTR_UNIT_CODE
                           ,KWAN
                           ,HANG
                           ,HANG_CODE
                           ,SEHANG
                           ,SEHANG_CODE
                           ,MOK
                           ,SUM(PAY_CNT) AS PAY_CNT
                           ,SUM(PAY_AMT) AS PAY_AMT
                           ,SUM(REC_CNT) AS REC_CNT
                           ,SUM(REC_AMT) AS REC_AMT
                      FROM (   SELECT V.MDAT_DE
                                     ,V.BUDGET_YEAR
                                     ,V.BSNS_SE
                                     ,V.BUDGET_ACNT_CODE
                                     ,V.EXPNDTR_UNIT_CODE
                                     ,D.GWAN_NM     AS KWAN
                                     ,D.HANG_NM     AS HANG
                                     ,D.HANG_CD     AS HANG_CODE
                                     ,D.SEHANG_NM     AS SEHANG
                                     ,D.SEHANG_CD     AS SEHANG_CODE
                                     ,D.MOK_NM         AS MOK
                                     ,V.OCCRRNC_CO     AS PAY_CNT
                                     ,V.ANACT_AMOUNT AS PAY_AMT
                                     ,0             AS REC_CNT
                                     ,0             AS REC_AMT
                                FROM TBRNT_PUCHAS_ANACT V,
                                     VHBDG_BUDGET_ACNT_CODE D
                               WHERE 1=1
                                 AND V.ANACT_SE IN ('1', '4')
                                 AND V.BUDGET_YEAR = D.YEAR
                                 AND V.BSNS_SE = D.BSNS_SE
                                 AND V.BUDGET_ACNT_CODE = D.BUDGET_ACNT_CODE
                               UNION ALL
                               SELECT V.MDAT_DE
                                     ,V.BUDGET_YEAR
                                     ,V.BSNS_SE
                                     ,V.BUDGET_ACNT_CODE
                                     ,V.EXPNDTR_UNIT_CODE
                                     ,D.GWAN_NM AS KWAN
                                     ,D.HANG_NM AS HANG
                                     ,D.HANG_CD AS HANG_CODE
                                     ,D.SEHANG_NM AS SEHANG
                                     ,D.SEHANG_CD AS SEHANG_CODE
                                     ,D.MOK_NM AS MOK
                                     ,0 AS PAY_CNT
                                     ,0 AS PAY_AMT
                                     ,V.OCCRRNC_CO
                                     ,V.ANACT_AMOUNT
                                FROM TBRNT_PUCHAS_ANACT V,
                                     VHBDG_BUDGET_ACNT_CODE D
                               WHERE 1=1
                                 AND V.ANACT_SE IN ('2', '3')
                                 AND V.BUDGET_YEAR = D.YEAR
                                 AND V.BSNS_SE = D.BSNS_SE
                                 AND V.BUDGET_ACNT_CODE = D.BUDGET_ACNT_CODE
                           )
                     GROUP BY MDAT_DE
                            , BUDGET_YEAR
                            , BSNS_SE
                            , BUDGET_ACNT_CODE
                            , EXPNDTR_UNIT_CODE
                            , KWAN
                            , HANG
                            , HANG_CODE
                            , SEHANG
                            , SEHANG_CODE
                            , MOK
        )
        , V2 AS ( SELECT  D.GWAN_NM AS KWAN
                         ,D.HANG_NM AS HANG
                         ,D.HANG_CD AS HANG_CODE
                         ,D.SEHANG_NM AS SEHANG
                         ,D.SEHANG_CD AS SEHANG_CODE
                         ,D.MOK_NM AS MOK
                         ,V.MDAT_DE
                         ,V.BUDGET_YEAR
                         ,SUBSTR(V.BUDGET_ACNT_SE,1,1) AS BSNS_SE
                         ,V.BUDGET_ACNTCTGR AS BUDGET_ACNT_CODE
                         ,V.BUKIP_CODE AS EXPNDTR_UNIT_CODE
                         ,V.AMOUNT AS PAY_AMT
                         ,1 AS PAY_CNT
                         ,V.PAY_SE
                    FROM TBRNT_PSTYR_ATMPT_AMOUNT V
                        ,VHBDG_BUDGET_ACNT_CODE D
                   WHERE 1=1
                     AND V.BUDGET_YEAR = D.YEAR
                     AND V.BUDGET_ACNT_SE = D.BSNS_SE || D.BALC_SE
                     AND V.BUDGET_ACNTCTGR = D.BUDGET_ACNT_CODE
                     AND V.JOB_SE_CODE = 'RN2'
        )
        SELECT ORD
              ,ORD1
              ,KWAN
              ,HANG
              ,HANG_CODE
              ,SEHANG
              ,SEHANG_CODE
              ,MOK
              ,BSNS_SE
              ,BUDGET_ACNT_CODE
              ,COL_TITLE
              ,SUM(PAY_CNT) AS PAY_CNT
              ,SUM(PAY_AMT) AS PAY_AMT
              ,SUM(REC_CNT) AS REC_CNT
              ,SUM(REC_AMT) AS REC_AMT
              ,SUM(PAY_CNTT) AS PAY_CNTT
              ,SUM(PAY_AMTT) AS PAY_AMTT
              ,SUM(REC_CNTT) AS REC_CNTT
              ,SUM(REC_AMTT) AS REC_AMTT
              ,SUM(PAY_AMTT) - SUM(REC_AMTT) AS DEL_AMT
          FROM
               (
                 SELECT '1'         AS ORD
                        ,'1'         AS ORD1
                        ,'총    계' AS KWAN
                        ,NULL         AS HANG
                        ,NULL         AS HANG_CODE
                        ,NULL         AS SEHANG
                        ,NULL         AS SEHANG_CODE
                        ,NULL         AS MOK
                        ,'1'         AS BSNS_SE
                        ,'1'         AS BUDGET_ACNT_CODE
                        ,'          총                 계' AS COL_TITLE
                        ,SUM(PAY_CNT) AS PAY_CNT
                        ,SUM(PAY_AMT) AS PAY_AMT
                        ,SUM(REC_CNT) AS REC_CNT
                        ,SUM(REC_AMT) AS REC_AMT
                        ,0 AS PAY_CNTT
                        ,0 AS PAY_AMTT
                        ,0 AS REC_CNTT
                        ,0 AS REC_AMTT
                   FROM V1
                  WHERE 1=1
                    AND SUBSTR(MDAT_DE,1,6) = #APPLC_MT#
                    AND ( BUDGET_ACNT_CODE LIKE '613%' OR BUDGET_ACNT_CODE LIKE '642%')
                  UNION ALL
                 SELECT '2' ORD
                        ,'2' AS ORD1
                        ,KWAN
                        ,NULL AS HANG
                        ,'1' AS HANG_CODE
                        ,NULL AS SEHANG
                        ,NULL AS SEHANG_CODE
                        ,NULL AS MOK
                        ,BSNS_SE
                        ,'1' AS BUDGET_ACNT_CODE
                        ,KWAN AS COL_TITLE
                        ,SUM(PAY_CNT) AS PAY_CNT
                        ,SUM(PAY_AMT) AS PAY_AMT
                        ,SUM(REC_CNT) AS REC_CNT
                        ,SUM(REC_AMT) AS REC_AMT
                        ,0 AS PAY_CNTT
                        ,0 AS PAY_AMTT
                        ,0 AS REC_CNTT
                        ,0 AS REC_AMTT
                   FROM V1
                  WHERE 1=1
                    AND SUBSTR(MDAT_DE,1,6) = #APPLC_MT#
                    AND ( BUDGET_ACNT_CODE LIKE '613%' OR BUDGET_ACNT_CODE LIKE '642%')
                  GROUP BY KWAN
                          ,BSNS_SE
                   UNION ALL
               SELECT '3' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,NULL AS SEHANG
                      ,'1' AS SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'2' AS BUDGET_ACNT_CODE
                      ,LPAD(' ',5,' ') || HANG AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,SUM(REC_CNT) AS REC_CNT
                      ,SUM(REC_AMT) AS REC_AMT
                      ,0 AS PAY_CNTT
                      ,0 AS PAY_AMTT
                      ,0 AS REC_CNTT
                      ,0 AS REC_AMTT
                 FROM V1
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,6) = #APPLC_MT#
                  AND ( BUDGET_ACNT_CODE LIKE '613%' OR BUDGET_ACNT_CODE LIKE '642%')
                GROUP BY KWAN
                        ,HANG
                        ,BSNS_SE
                        ,HANG_CODE
                   UNION ALL
               SELECT '4' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,SEHANG
                      ,SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'3' AS BUDGET_ACNT_CODE
                      ,LPAD(' ',14,' ') || SEHANG AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,SUM(REC_CNT) AS REC_CNT
                      ,SUM(REC_AMT) AS REC_AMT
                      ,0 AS PAY_CNTT
                      ,0 AS PAY_AMTT
                      ,0 AS REC_CNTT
                      ,0 AS REC_AMTT
                 FROM V1
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,6) = #APPLC_MT#
                  AND ( BUDGET_ACNT_CODE LIKE '613%' OR BUDGET_ACNT_CODE LIKE '642%')
                GROUP BY KWAN
                        ,HANG
                        ,HANG_CODE
                        ,SEHANG
                        ,SEHANG_CODE
                        ,BSNS_SE
                   UNION ALL
               SELECT '5' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,SEHANG
                      ,SEHANG_CODE
                      ,MOK
                      ,BSNS_SE
                      ,BUDGET_ACNT_CODE
                      ,LPAD(' ',24,' ') || MOK AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,SUM(REC_CNT) AS REC_CNT
                      ,SUM(REC_AMT) AS REC_AMT
                      ,0 AS PAY_CNTT
                      ,0 AS PAY_AMTT
                      ,0 AS REC_CNTT
                      ,0 AS REC_AMTT
                 FROM V1
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,6) = #APPLC_MT#
                  AND ( BUDGET_ACNT_CODE LIKE '613%' OR BUDGET_ACNT_CODE LIKE '642%')
                GROUP BY KWAN
                        ,HANG
                        ,HANG_CODE
                        ,SEHANG
                        ,SEHANG_CODE
                        ,MOK
                        ,BSNS_SE
                        ,BUDGET_ACNT_CODE
               UNION ALL
                 SELECT '1'         AS ORD
                        ,'1'         AS ORD1
                        ,'총    계' AS KWAN
                        ,NULL         AS HANG
                        ,NULL         AS HANG_CODE
                        ,NULL         AS SEHANG
                        ,NULL         AS SEHANG_CODE
                        ,NULL         AS MOK
                        ,'1'         AS BSNS_SE
                        ,'1'         AS BUDGET_ACNT_CODE
                        ,'          총                 계' AS COL_TITLE
                        ,0 AS PAY_CNT
                        ,0 AS PAY_AMT
                        ,0 AS REC_CNT
                        ,0 AS REC_AMT
                        ,SUM(PAY_CNT) AS PAY_CNTT
                        ,SUM(PAY_AMT) AS PAY_AMTT
                        ,SUM(REC_CNT) AS REC_CNTT
                        ,SUM(REC_AMT) AS REC_AMTT
                   FROM V1
                  WHERE 1=1
                    AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                    AND SUBSTR(MDAT_DE,1,6) <![CDATA[ <= ]]>  #APPLC_MT#
                    AND ( BUDGET_ACNT_CODE LIKE '613%' OR BUDGET_ACNT_CODE LIKE '642%')
                  UNION ALL
                 SELECT '2' ORD
                        ,'2' AS ORD1
                        ,KWAN
                        ,NULL AS HANG
                        ,'1' AS HANG_CODE
                        ,NULL AS SEHANG
                        ,NULL AS SEHANG_CODE
                        ,NULL AS MOK
                        ,BSNS_SE
                        ,'1' AS BUDGET_ACNT_CODE
                        ,KWAN AS COL_TITLE
                        ,0 AS PAY_CNT
                        ,0 AS PAY_AMT
                        ,0 AS REC_CNT
                        ,0 AS REC_AMT
                        ,SUM(PAY_CNT) AS PAY_CNTT
                        ,SUM(PAY_AMT) AS PAY_AMTT
                        ,SUM(REC_CNT) AS REC_CNTT
                        ,SUM(REC_AMT) AS REC_AMTT
                   FROM V1
                  WHERE 1=1
                    AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                    AND SUBSTR(MDAT_DE,1,6) <![CDATA[ <= ]]> #APPLC_MT#
                    AND ( BUDGET_ACNT_CODE LIKE '613%' OR BUDGET_ACNT_CODE LIKE '642%')
                  GROUP BY KWAN
                          ,BSNS_SE
                   UNION ALL
               SELECT '3' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,NULL AS SEHANG
                      ,'1' AS SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'2' AS BUDGET_ACNT_CODE
                      ,LPAD(' ',5,' ') || HANG AS COL_TITLE
                      ,0 AS PAY_CNT
                      ,0 AS PAY_AMT
                      ,0 AS REC_CNT
                      ,0 AS REC_AMT
                      ,SUM(PAY_CNT) AS PAY_CNTT
                      ,SUM(PAY_AMT) AS PAY_AMTT
                      ,SUM(REC_CNT) AS REC_CNTT
                      ,SUM(REC_AMT) AS REC_AMTT
                 FROM V1
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                  AND SUBSTR(MDAT_DE,1,6) <![CDATA[ <= ]]> #APPLC_MT#
                  AND ( BUDGET_ACNT_CODE LIKE '613%' OR BUDGET_ACNT_CODE LIKE '642%')
                GROUP BY KWAN
                        ,HANG
                        ,BSNS_SE
                        ,HANG_CODE
                   UNION ALL
               SELECT '4' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,SEHANG
                      ,SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'3' AS BUDGET_ACNT_CODE
                      ,LPAD(' ',14,' ') || SEHANG AS COL_TITLE
                      ,0 AS PAY_CNT
                      ,0 AS PAY_AMT
                      ,0 AS REC_CNT
                      ,0 AS REC_AMT
                      ,SUM(PAY_CNT) AS PAY_CNTT
                      ,SUM(PAY_AMT) AS PAY_AMTT
                      ,SUM(REC_CNT) AS REC_CNTT
                      ,SUM(REC_AMT) AS REC_AMTT
                 FROM V1
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                  AND SUBSTR(MDAT_DE,1,6) <![CDATA[ <= ]]> #APPLC_MT#
                  AND ( BUDGET_ACNT_CODE LIKE '613%' OR BUDGET_ACNT_CODE LIKE '642%')
                GROUP BY KWAN
                        ,HANG
                        ,HANG_CODE
                        ,SEHANG
                        ,SEHANG_CODE
                        ,BSNS_SE
                   UNION ALL
               SELECT '5' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,SEHANG
                      ,SEHANG_CODE
                      ,MOK
                      ,BSNS_SE
                      ,BUDGET_ACNT_CODE
                      ,LPAD(' ',24,' ') || MOK AS COL_TITLE
                      ,0 AS PAY_CNT
                      ,0 AS PAY_AMT
                      ,0 AS REC_CNT
                      ,0 AS REC_AMT
                      ,SUM(PAY_CNT) AS PAY_CNTT
                      ,SUM(PAY_AMT) AS PAY_AMTT
                      ,SUM(REC_CNT) AS REC_CNTT
                      ,SUM(REC_AMT) AS REC_AMTT
                 FROM V1
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                  AND SUBSTR(MDAT_DE,1,6) <![CDATA[ <= ]]> #APPLC_MT#
                  AND ( BUDGET_ACNT_CODE LIKE '613%' OR BUDGET_ACNT_CODE LIKE '642%')
                GROUP BY KWAN
                        ,HANG
                        ,HANG_CODE
                        ,SEHANG
                        ,SEHANG_CODE
                        ,MOK
                        ,BSNS_SE
                        ,BUDGET_ACNT_CODE
               UNION ALL
               SELECT '1' ORD
                      ,'1' AS ORD1
                      ,'총    계' KWAN
                      ,NULL AS HANG
                      ,NULL AS HANG_CODE
                      ,NULL AS SEHANG
                      ,NULL AS SEHANG_CODE
                      ,NULL AS MOK
                      ,'1' AS BSNS_SE
                      ,'1' AS BUDGET_ACNT_CODE
                      ,'          총                 계' AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,(CASE WHEN PAY_SE = '2'
                             THEN SUM(PAY_CNT)
                             ELSE 0
                        END) AS REC_CNT
                      ,(CASE WHEN PAY_SE = '2'
                             THEN SUM(PAY_AMT)
                             ELSE 0
                        END) AS REC_AMT
                      ,0 AS PAY_CNTT
                      ,0 AS PAY_AMTT
                      ,0 AS REC_CNTT
                      ,0 AS REC_AMTT
                 FROM V2
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                  AND ( BUDGET_ACNT_CODE LIKE '613%' OR BUDGET_ACNT_CODE LIKE '642%')
                GROUP BY PAY_SE
               UNION ALL
               SELECT '2' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,NULL AS HANG
                      ,'1' AS HANG_CODE
                      ,NULL AS SEHANG
                      ,NULL AS SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'1' AS BUDGET_ACNT_CODE
                      ,KWAN AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,(CASE WHEN PAY_SE = '2'
                             THEN SUM(PAY_CNT)
                             ELSE 0
                        END) AS REC_CNT
                      ,(CASE WHEN PAY_SE = '2'
                             THEN SUM(PAY_AMT)
                             ELSE 0
                        END) AS REC_AMT
                      ,0 AS PAY_CNTT
                      ,0 AS PAY_AMTT
                      ,0 AS REC_CNTT
                      ,0 AS REC_AMTT
                 FROM V2
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                  AND ( BUDGET_ACNT_CODE LIKE '613%' OR BUDGET_ACNT_CODE LIKE '642%')
                GROUP BY KWAN
                        ,BSNS_SE
                        ,PAY_SE
               UNION ALL
               SELECT '3' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,NULL AS SEHANG
                      ,'1' AS SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'2' AS BUDGET_ACNT_CODE
                      ,LPAD(' ',5,' ') || HANG AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,(CASE WHEN PAY_SE = '2'
                             THEN SUM(PAY_CNT)
                             ELSE 0
                        END) AS REC_CNT
                      ,(CASE WHEN PAY_SE = '2'
                             THEN SUM(PAY_AMT)
                             ELSE 0
                        END) AS REC_AMT
                      ,0 AS PAY_CNTT
                      ,0 AS PAY_AMTT
                      ,0 AS REC_CNTT
                      ,0 AS REC_AMTT
                 FROM V2
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                  AND ( BUDGET_ACNT_CODE LIKE '613%' OR BUDGET_ACNT_CODE LIKE '642%')
                GROUP BY KWAN
                        ,HANG
                        ,BSNS_SE
                        ,HANG_CODE
                        ,PAY_SE
               UNION ALL
               SELECT '4' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,SEHANG
                      ,SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'3' AS BUDGET_ACNT_CODE
                      ,LPAD(' ',14,' ') || SEHANG AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,(CASE WHEN PAY_SE = '2'
                             THEN SUM(PAY_CNT)
                             ELSE 0
                        END) AS REC_CNT
                      ,(CASE WHEN PAY_SE = '2'
                             THEN SUM(PAY_AMT)
                             ELSE 0
                        END) AS REC_AMT
                      ,0 AS PAY_CNTT
                      ,0 AS PAY_AMTT
                      ,0 AS REC_CNTT
                      ,0 AS REC_AMTT
                 FROM V2
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                  AND ( BUDGET_ACNT_CODE LIKE '613%' OR BUDGET_ACNT_CODE LIKE '642%')
                GROUP BY KWAN
                        ,HANG
                        ,HANG_CODE
                        ,SEHANG
                        ,SEHANG_CODE
                        ,BSNS_SE
                        ,PAY_SE
               UNION ALL
               SELECT '5' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,SEHANG
                      ,SEHANG_CODE
                      ,MOK
                      ,BSNS_SE
                      ,BUDGET_ACNT_CODE
                      ,LPAD(' ',24,' ') || MOK AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,(CASE WHEN PAY_SE = '2'
                             THEN SUM(PAY_CNT)
                             ELSE 0
                        END) AS REC_CNT
                      ,(CASE WHEN PAY_SE = '2'
                             THEN SUM(PAY_AMT)
                             ELSE 0
                        END) AS REC_AMT
                      ,0 AS PAY_CNTT
                      ,0 AS PAY_AMTT
                      ,0 AS REC_CNTT
                      ,0 AS REC_AMTT
                 FROM V2
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                  AND ( BUDGET_ACNT_CODE LIKE '613%' OR BUDGET_ACNT_CODE LIKE '642%')
                GROUP BY KWAN
                        ,HANG
                        ,HANG_CODE
                        ,SEHANG
                        ,SEHANG_CODE
                        ,MOK
                        ,BSNS_SE
                        ,BUDGET_ACNT_CODE
                        ,PAY_SE
                       )
         GROUP BY ORD
                 ,ORD1
                 ,KWAN
                 ,HANG
                 ,HANG_CODE
                 ,SEHANG
                 ,SEHANG_CODE
                 ,MOK
                 ,BSNS_SE
                 ,BUDGET_ACNT_CODE
                 ,COL_TITLE
        ORDER BY ORD1
                 ,BSNS_SE
                 ,HANG_CODE
                 ,SEHANG_CODE
                 ,ORD
                 ,BUDGET_ACNT_CODE    
    </select>
    
	<!-- 쿼리명 : 월별세입징수현황
	설명 : 월별세입징수현황조회
	수정일  수정자  수정내용	
	작성자 : 박병일
	최초작성일 : 2016.03.02
	-->
	<select id="RNT02060400DAO.selectMonthlyLevList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        WITH V1 AS ( SELECT MDAT_DE
                           ,BUDGET_YEAR
                           ,BSNS_SE
                           ,BUDGET_ACNT_CODE
                           ,EXPNDTR_UNIT_CODE
                           ,KWAN
                           ,HANG
                           ,HANG_CODE
                           ,SEHANG
                           ,SEHANG_CODE
                           ,MOK
                           ,SUM(PAY_CNT) AS PAY_CNT
                           ,SUM(PAY_AMT) AS PAY_AMT
                           ,SUM(REC_CNT) AS REC_CNT
                           ,SUM(REC_AMT) AS REC_AMT
                      FROM (   SELECT V.MDAT_DE
                                     ,V.BUDGET_YEAR
                                     ,V.BSNS_SE
                                     ,V.BUDGET_ACNT_CODE
                                     ,V.EXPNDTR_UNIT_CODE
                                     ,D.GWAN_NM     AS KWAN
                                     ,D.HANG_NM     AS HANG
                                     ,D.HANG_CD     AS HANG_CODE
                                     ,D.SEHANG_NM     AS SEHANG
                                     ,D.SEHANG_CD     AS SEHANG_CODE
                                     ,D.MOK_NM         AS MOK
                                     ,V.OCCRRNC_CO     AS PAY_CNT
                                     ,V.ANACT_AMOUNT AS PAY_AMT
                                     ,0             AS REC_CNT
                                     ,0             AS REC_AMT
                                FROM TBRNT_PUCHAS_ANACT V,
                                     VHBDG_BUDGET_ACNT_CODE D
                               WHERE 1=1
                                 AND V.ANACT_SE IN ('1', '4')
                                 AND V.BUDGET_YEAR = D.YEAR
                                 AND V.BSNS_SE = D.BSNS_SE
                                 AND V.BUDGET_ACNT_CODE = D.BUDGET_ACNT_CODE
                               UNION ALL
                               SELECT V.MDAT_DE
                                     ,V.BUDGET_YEAR
                                     ,V.BSNS_SE
                                     ,V.BUDGET_ACNT_CODE
                                     ,V.EXPNDTR_UNIT_CODE
                                     ,D.GWAN_NM AS KWAN
                                     ,D.HANG_NM AS HANG
                                     ,D.HANG_CD AS HANG_CODE
                                     ,D.SEHANG_NM AS SEHANG
                                     ,D.SEHANG_CD AS SEHANG_CODE
                                     ,D.MOK_NM AS MOK
                                     ,0 AS PAY_CNT
                                     ,0 AS PAY_AMT
                                     ,V.OCCRRNC_CO
                                     ,V.ANACT_AMOUNT
                                FROM TBRNT_PUCHAS_ANACT V,
                                     VHBDG_BUDGET_ACNT_CODE D
                               WHERE 1=1
                                 AND V.ANACT_SE IN ('2', '3')
                                 AND V.BUDGET_YEAR = D.YEAR
                                 AND V.BSNS_SE = D.BSNS_SE
                                 AND V.BUDGET_ACNT_CODE = D.BUDGET_ACNT_CODE
                           )
                     GROUP BY MDAT_DE
                            , BUDGET_YEAR
                            , BSNS_SE
                            , BUDGET_ACNT_CODE
                            , EXPNDTR_UNIT_CODE
                            , KWAN
                            , HANG
                            , HANG_CODE
                            , SEHANG
                            , SEHANG_CODE
                            , MOK
        )
        , V2 AS ( SELECT  D.GWAN_NM AS KWAN
                         ,D.HANG_NM AS HANG
                         ,D.HANG_CD AS HANG_CODE
                         ,D.SEHANG_NM AS SEHANG
                         ,D.SEHANG_CD AS SEHANG_CODE
                         ,D.MOK_NM AS MOK
                         ,V.MDAT_DE
                         ,V.BUDGET_YEAR
                         ,SUBSTR(V.BUDGET_ACNT_SE,1,1) AS BSNS_SE
                         ,V.BUDGET_ACNTCTGR AS BUDGET_ACNT_CODE
                         ,V.BUKIP_CODE AS EXPNDTR_UNIT_CODE
                         ,V.AMOUNT AS PAY_AMT
                         ,1 AS PAY_CNT
                         ,V.PAY_SE
                    FROM TBRNT_PSTYR_ATMPT_AMOUNT V
                        ,VHBDG_BUDGET_ACNT_CODE D
                   WHERE 1=1
                     AND V.BUDGET_YEAR = D.YEAR
                     AND V.BUDGET_ACNT_SE = D.BSNS_SE || D.BALC_SE
                     AND V.BUDGET_ACNTCTGR = D.BUDGET_ACNT_CODE
                     AND V.JOB_SE_CODE = 'RN2'
        )
        SELECT ORD
              ,ORD1
              ,KWAN
              ,HANG
              ,HANG_CODE
              ,SEHANG
              ,SEHANG_CODE
              ,MOK
              ,BSNS_SE
              ,BUDGET_ACNT_CODE
              ,COL_TITLE
              ,SUM(PAY_CNT) AS PAY_CNT
              ,SUM(PAY_AMT) AS PAY_AMT
              ,SUM(REC_CNT) AS REC_CNT
              ,SUM(REC_AMT) AS REC_AMT
              ,SUM(PAY_CNTT) AS PAY_CNTT
              ,SUM(PAY_AMTT) AS PAY_AMTT
              ,SUM(REC_CNTT) AS REC_CNTT
              ,SUM(REC_AMTT) AS REC_AMTT
              ,SUM(PAY_AMTT) - SUM(REC_AMTT) AS DEL_AMT
          FROM
               (
                 SELECT '1'         AS ORD
                        ,'1'         AS ORD1
                        ,'총    계' AS KWAN
                        ,NULL         AS HANG
                        ,NULL         AS HANG_CODE
                        ,NULL         AS SEHANG
                        ,NULL         AS SEHANG_CODE
                        ,NULL         AS MOK
                        ,'1'         AS BSNS_SE
                        ,'1'         AS BUDGET_ACNT_CODE
                        ,'          총                 계' AS COL_TITLE
                        ,SUM(PAY_CNT) AS PAY_CNT
                        ,SUM(PAY_AMT) AS PAY_AMT
                        ,SUM(REC_CNT) AS REC_CNT
                        ,SUM(REC_AMT) AS REC_AMT
                        ,0 AS PAY_CNTT
                        ,0 AS PAY_AMTT
                        ,0 AS REC_CNTT
                        ,0 AS REC_AMTT
                   FROM V1
                  WHERE 1=1
                    AND SUBSTR(MDAT_DE,1,6) = #APPLC_MT#
                  UNION ALL
                 SELECT '2' ORD
                        ,'2' AS ORD1
                        ,KWAN
                        ,NULL AS HANG
                        ,'1' AS HANG_CODE
                        ,NULL AS SEHANG
                        ,NULL AS SEHANG_CODE
                        ,NULL AS MOK
                        ,BSNS_SE
                        ,'1' AS BUDGET_ACNT_CODE
                        ,KWAN AS COL_TITLE
                        ,SUM(PAY_CNT) AS PAY_CNT
                        ,SUM(PAY_AMT) AS PAY_AMT
                        ,SUM(REC_CNT) AS REC_CNT
                        ,SUM(REC_AMT) AS REC_AMT
                        ,0 AS PAY_CNTT
                        ,0 AS PAY_AMTT
                        ,0 AS REC_CNTT
                        ,0 AS REC_AMTT
                   FROM V1
                  WHERE 1=1
                    AND SUBSTR(MDAT_DE,1,6) = #APPLC_MT#
                  GROUP BY KWAN
                          ,BSNS_SE
                   UNION ALL
               SELECT '3' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,NULL AS SEHANG
                      ,'1' AS SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'2' AS BUDGET_ACNT_CODE
                      ,LPAD(' ',5,' ') || HANG AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,SUM(REC_CNT) AS REC_CNT
                      ,SUM(REC_AMT) AS REC_AMT
                      ,0 AS PAY_CNTT
                      ,0 AS PAY_AMTT
                      ,0 AS REC_CNTT
                      ,0 AS REC_AMTT
                 FROM V1
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,6) = #APPLC_MT#
                GROUP BY KWAN
                        ,HANG
                        ,BSNS_SE
                        ,HANG_CODE
                   UNION ALL
               SELECT '4' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,SEHANG
                      ,SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'3' AS BUDGET_ACNT_CODE
                      ,LPAD(' ',14,' ') || SEHANG AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,SUM(REC_CNT) AS REC_CNT
                      ,SUM(REC_AMT) AS REC_AMT
                      ,0 AS PAY_CNTT
                      ,0 AS PAY_AMTT
                      ,0 AS REC_CNTT
                      ,0 AS REC_AMTT
                 FROM V1
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,6) = #APPLC_MT#
                GROUP BY KWAN
                        ,HANG
                        ,HANG_CODE
                        ,SEHANG
                        ,SEHANG_CODE
                        ,BSNS_SE
                   UNION ALL
               SELECT '5' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,SEHANG
                      ,SEHANG_CODE
                      ,MOK
                      ,BSNS_SE
                      ,BUDGET_ACNT_CODE
                      ,LPAD(' ',24,' ') || MOK AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,SUM(REC_CNT) AS REC_CNT
                      ,SUM(REC_AMT) AS REC_AMT
                      ,0 AS PAY_CNTT
                      ,0 AS PAY_AMTT
                      ,0 AS REC_CNTT
                      ,0 AS REC_AMTT
                 FROM V1
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,6) = #APPLC_MT#
                GROUP BY KWAN
                        ,HANG
                        ,HANG_CODE
                        ,SEHANG
                        ,SEHANG_CODE
                        ,MOK
                        ,BSNS_SE
                        ,BUDGET_ACNT_CODE
               UNION ALL
                 SELECT '1'         AS ORD
                        ,'1'         AS ORD1
                        ,'총    계' AS KWAN
                        ,NULL         AS HANG
                        ,NULL         AS HANG_CODE
                        ,NULL         AS SEHANG
                        ,NULL         AS SEHANG_CODE
                        ,NULL         AS MOK
                        ,'1'         AS BSNS_SE
                        ,'1'         AS BUDGET_ACNT_CODE
                        ,'          총                 계' AS COL_TITLE
                        ,0 AS PAY_CNT
                        ,0 AS PAY_AMT
                        ,0 AS REC_CNT
                        ,0 AS REC_AMT
                        ,SUM(PAY_CNT) AS PAY_CNTT
                        ,SUM(PAY_AMT) AS PAY_AMTT
                        ,SUM(REC_CNT) AS REC_CNTT
                        ,SUM(REC_AMT) AS REC_AMTT
                   FROM V1
                  WHERE 1=1
                    AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                    AND SUBSTR(MDAT_DE,1,6) <![CDATA[ <= ]]>  #APPLC_MT#
                  UNION ALL
                 SELECT '2' ORD
                        ,'2' AS ORD1
                        ,KWAN
                        ,NULL AS HANG
                        ,'1' AS HANG_CODE
                        ,NULL AS SEHANG
                        ,NULL AS SEHANG_CODE
                        ,NULL AS MOK
                        ,BSNS_SE
                        ,'1' AS BUDGET_ACNT_CODE
                        ,KWAN AS COL_TITLE
                        ,0 AS PAY_CNT
                        ,0 AS PAY_AMT
                        ,0 AS REC_CNT
                        ,0 AS REC_AMT
                        ,SUM(PAY_CNT) AS PAY_CNTT
                        ,SUM(PAY_AMT) AS PAY_AMTT
                        ,SUM(REC_CNT) AS REC_CNTT
                        ,SUM(REC_AMT) AS REC_AMTT
                   FROM V1
                  WHERE 1=1
                    AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                    AND SUBSTR(MDAT_DE,1,6) <![CDATA[ <= ]]> #APPLC_MT#
                  GROUP BY KWAN
                          ,BSNS_SE
                   UNION ALL
               SELECT '3' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,NULL AS SEHANG
                      ,'1' AS SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'2' AS BUDGET_ACNT_CODE
                      ,LPAD(' ',5,' ') || HANG AS COL_TITLE
                      ,0 AS PAY_CNT
                      ,0 AS PAY_AMT
                      ,0 AS REC_CNT
                      ,0 AS REC_AMT
                      ,SUM(PAY_CNT) AS PAY_CNTT
                      ,SUM(PAY_AMT) AS PAY_AMTT
                      ,SUM(REC_CNT) AS REC_CNTT
                      ,SUM(REC_AMT) AS REC_AMTT
                 FROM V1
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                  AND SUBSTR(MDAT_DE,1,6) <![CDATA[ <= ]]> #APPLC_MT#
                GROUP BY KWAN
                        ,HANG
                        ,BSNS_SE
                        ,HANG_CODE
                   UNION ALL
               SELECT '4' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,SEHANG
                      ,SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'3' AS BUDGET_ACNT_CODE
                      ,LPAD(' ',14,' ') || SEHANG AS COL_TITLE
                      ,0 AS PAY_CNT
                      ,0 AS PAY_AMT
                      ,0 AS REC_CNT
                      ,0 AS REC_AMT
                      ,SUM(PAY_CNT) AS PAY_CNTT
                      ,SUM(PAY_AMT) AS PAY_AMTT
                      ,SUM(REC_CNT) AS REC_CNTT
                      ,SUM(REC_AMT) AS REC_AMTT
                 FROM V1
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                  AND SUBSTR(MDAT_DE,1,6) <![CDATA[ <= ]]> #APPLC_MT#
                GROUP BY KWAN
                        ,HANG
                        ,HANG_CODE
                        ,SEHANG
                        ,SEHANG_CODE
                        ,BSNS_SE
                   UNION ALL
               SELECT '5' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,SEHANG
                      ,SEHANG_CODE
                      ,MOK
                      ,BSNS_SE
                      ,BUDGET_ACNT_CODE
                      ,LPAD(' ',24,' ') || MOK AS COL_TITLE
                      ,0 AS PAY_CNT
                      ,0 AS PAY_AMT
                      ,0 AS REC_CNT
                      ,0 AS REC_AMT
                      ,SUM(PAY_CNT) AS PAY_CNTT
                      ,SUM(PAY_AMT) AS PAY_AMTT
                      ,SUM(REC_CNT) AS REC_CNTT
                      ,SUM(REC_AMT) AS REC_AMTT
                 FROM V1
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                  AND SUBSTR(MDAT_DE,1,6) <![CDATA[ <= ]]> #APPLC_MT#
                GROUP BY KWAN
                        ,HANG
                        ,HANG_CODE
                        ,SEHANG
                        ,SEHANG_CODE
                        ,MOK
                        ,BSNS_SE
                        ,BUDGET_ACNT_CODE
               UNION ALL
               SELECT '1' ORD
                      ,'1' AS ORD1
                      ,'총    계' KWAN
                      ,NULL AS HANG
                      ,NULL AS HANG_CODE
                      ,NULL AS SEHANG
                      ,NULL AS SEHANG_CODE
                      ,NULL AS MOK
                      ,'1' AS BSNS_SE
                      ,'1' AS BUDGET_ACNT_CODE
                      ,'          총                 계' AS COL_TITLE
                      ,(CASE WHEN SUBSTR(#APPLC_MT# , 5 , 2) = '01' THEN SUM (PAY_CNT) ELSE 0 END) AS PAY_CNT
                      ,(CASE WHEN SUBSTR(#APPLC_MT# , 5 , 2) = '01' THEN SUM (PAY_AMT) ELSE 0 END) AS PAY_AMT
                      ,(CASE WHEN SUBSTR(#APPLC_MT# , 5 , 2) = '01' THEN 
                             (CASE WHEN PAY_SE = '2' THEN SUM (PAY_CNT) ELSE 0 END)
                             ELSE 0
                              	  END) AS REC_CNT
                      ,(CASE WHEN SUBSTR(#APPLC_MT# , 5 , 2) = '01' THEN
                             (CASE WHEN PAY_SE = '2' THEN SUM (PAY_AMT) ELSE 0 END)
                             ELSE 0
                              	  END) AS REC_AMT
                      ,SUM (PAY_CNT) AS PAY_CNTT 
                      ,SUM (PAY_AMT) AS PAY_AMTT
                      ,(CASE WHEN PAY_SE = '2' THEN SUM (PAY_CNT) ELSE 0 END) AS REC_CNTT
                      ,(CASE WHEN PAY_SE = '2' THEN SUM (PAY_AMT) ELSE 0 END) AS REC_AMTT
                 FROM V2
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                GROUP BY PAY_SE
               UNION ALL
               SELECT '2' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,NULL AS HANG
                      ,'1' AS HANG_CODE
                      ,NULL AS SEHANG
                      ,NULL AS SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'1' AS BUDGET_ACNT_CODE
                      ,KWAN AS COL_TITLE
                      ,(CASE WHEN SUBSTR(#APPLC_MT# , 5 , 2) = '01' THEN SUM (PAY_CNT) ELSE 0 END) AS PAY_CNT
                      ,(CASE WHEN SUBSTR(#APPLC_MT# , 5 , 2) = '01' THEN SUM (PAY_AMT) ELSE 0 END) AS PAY_AMT
                      ,(CASE WHEN SUBSTR(#APPLC_MT# , 5 , 2) = '01' THEN 
                             (CASE WHEN PAY_SE = '2' THEN SUM (PAY_CNT) ELSE 0 END)
                             ELSE 0
                              	  END) AS REC_CNT
                      ,(CASE WHEN SUBSTR(#APPLC_MT# , 5 , 2) = '01' THEN
                             (CASE WHEN PAY_SE = '2' THEN SUM (PAY_AMT) ELSE 0 END)
                             ELSE 0
                              	  END) AS REC_AMT
                      ,SUM (PAY_CNT) AS PAY_CNTT 
                      ,SUM (PAY_AMT) AS PAY_AMTT
                      ,(CASE WHEN PAY_SE = '2' THEN SUM (PAY_CNT) ELSE 0 END) AS REC_CNTT
                      ,(CASE WHEN PAY_SE = '2' THEN SUM (PAY_AMT) ELSE 0 END) AS REC_AMTT
                 FROM V2
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                GROUP BY KWAN
                        ,BSNS_SE
                        ,PAY_SE
               UNION ALL
               SELECT '3' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,NULL AS SEHANG
                      ,'1' AS SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'2' AS BUDGET_ACNT_CODE
                      ,LPAD(' ',5,' ') || HANG AS COL_TITLE
                      ,(CASE WHEN SUBSTR(#APPLC_MT# , 5 , 2) = '01' THEN SUM (PAY_CNT) ELSE 0 END) AS PAY_CNT
                      ,(CASE WHEN SUBSTR(#APPLC_MT# , 5 , 2) = '01' THEN SUM (PAY_AMT) ELSE 0 END) AS PAY_AMT
                      ,(CASE WHEN SUBSTR(#APPLC_MT# , 5 , 2) = '01' THEN 
                             (CASE WHEN PAY_SE = '2' THEN SUM (PAY_CNT) ELSE 0 END)
                             ELSE 0
                              	  END) AS REC_CNT
                      ,(CASE WHEN SUBSTR(#APPLC_MT# , 5 , 2) = '01' THEN
                             (CASE WHEN PAY_SE = '2' THEN SUM (PAY_AMT) ELSE 0 END)
                             ELSE 0
                              	  END) AS REC_AMT
                      ,SUM (PAY_CNT) AS PAY_CNTT 
                      ,SUM (PAY_AMT) AS PAY_AMTT
                      ,(CASE WHEN PAY_SE = '2' THEN SUM (PAY_CNT) ELSE 0 END) AS REC_CNTT
                      ,(CASE WHEN PAY_SE = '2' THEN SUM (PAY_AMT) ELSE 0 END) AS REC_AMTT
                 FROM V2
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                GROUP BY KWAN
                        ,HANG
                        ,BSNS_SE
                        ,HANG_CODE
                        ,PAY_SE
               UNION ALL
               SELECT '4' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,SEHANG
                      ,SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'3' AS BUDGET_ACNT_CODE
                      ,LPAD(' ',14,' ') || SEHANG AS COL_TITLE
                      ,(CASE WHEN SUBSTR(#APPLC_MT# , 5 , 2) = '01' THEN SUM (PAY_CNT) ELSE 0 END) AS PAY_CNT
                      ,(CASE WHEN SUBSTR(#APPLC_MT# , 5 , 2) = '01' THEN SUM (PAY_AMT) ELSE 0 END) AS PAY_AMT
                      ,(CASE WHEN SUBSTR(#APPLC_MT# , 5 , 2) = '01' THEN 
                             (CASE WHEN PAY_SE = '2' THEN SUM (PAY_CNT) ELSE 0 END)
                             ELSE 0
                              	  END) AS REC_CNT
                      ,(CASE WHEN SUBSTR(#APPLC_MT# , 5 , 2) = '01' THEN
                             (CASE WHEN PAY_SE = '2' THEN SUM (PAY_AMT) ELSE 0 END)
                             ELSE 0
                              	  END) AS REC_AMT
                      ,SUM (PAY_CNT) AS PAY_CNTT 
                      ,SUM (PAY_AMT) AS PAY_AMTT
                      ,(CASE WHEN PAY_SE = '2' THEN SUM (PAY_CNT) ELSE 0 END) AS REC_CNTT
                      ,(CASE WHEN PAY_SE = '2' THEN SUM (PAY_AMT) ELSE 0 END) AS REC_AMTT
                 FROM V2
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                GROUP BY KWAN
                        ,HANG
                        ,HANG_CODE
                        ,SEHANG
                        ,SEHANG_CODE
                        ,BSNS_SE
                        ,PAY_SE
               UNION ALL
               SELECT '5' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,SEHANG
                      ,SEHANG_CODE
                      ,MOK
                      ,BSNS_SE
                      ,BUDGET_ACNT_CODE
                      ,LPAD(' ',24,' ') || MOK AS COL_TITLE
                      ,(CASE WHEN SUBSTR(#APPLC_MT# , 5 , 2) = '01' THEN SUM (PAY_CNT) ELSE 0 END) AS PAY_CNT
                      ,(CASE WHEN SUBSTR(#APPLC_MT# , 5 , 2) = '01' THEN SUM (PAY_AMT) ELSE 0 END) AS PAY_AMT
                      ,(CASE WHEN SUBSTR(#APPLC_MT# , 5 , 2) = '01' THEN 
                             (CASE WHEN PAY_SE = '2' THEN SUM (PAY_CNT) ELSE 0 END)
                             ELSE 0
                              	  END) AS REC_CNT
                      ,(CASE WHEN SUBSTR(#APPLC_MT# , 5 , 2) = '01' THEN
                             (CASE WHEN PAY_SE = '2' THEN SUM (PAY_AMT) ELSE 0 END)
                             ELSE 0
                              	  END) AS REC_AMT
                      ,SUM (PAY_CNT) AS PAY_CNTT 
                      ,SUM (PAY_AMT) AS PAY_AMTT
                      ,(CASE WHEN PAY_SE = '2' THEN SUM (PAY_CNT) ELSE 0 END) AS REC_CNTT
                      ,(CASE WHEN PAY_SE = '2' THEN SUM (PAY_AMT) ELSE 0 END) AS REC_AMTT
                 FROM V2
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                GROUP BY KWAN
                        ,HANG
                        ,HANG_CODE
                        ,SEHANG
                        ,SEHANG_CODE
                        ,MOK
                        ,BSNS_SE
                        ,BUDGET_ACNT_CODE
                        ,PAY_SE
                       )
         GROUP BY ORD
                 ,ORD1
                 ,KWAN
                 ,HANG
                 ,HANG_CODE
                 ,SEHANG
                 ,SEHANG_CODE
                 ,MOK
                 ,BSNS_SE
                 ,BUDGET_ACNT_CODE
                 ,COL_TITLE
        ORDER BY ORD1
                 ,BSNS_SE
                 ,HANG_CODE
                 ,SEHANG_CODE
                 ,ORD
                 ,BUDGET_ACNT_CODE     
    </select>
    
	<!-- 쿼리명 : 조정내역서조회
	설명 : 조정내역서조회
	수정일  수정자  수정내용	
	작성자 : 박병일
	최초작성일 : 2016.03.02
	-->
	<select id="RNT02060400DAO.selectIncmeMDtlList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        SELECT  ORD
               ,DEC_NAME
               ,RENT_HOUSE_NM
               ,CASE
                   WHEN ORD LIKE '1%'
                   THEN DONGHO || TO_CHAR(SUM(OCCRRNC_CNT) -1)
                   ELSE DONGHO
                END AS DONGHO
               ,SUM(OCCRRNC_CNT) AS OCCRRNC_CNT
               ,SUM(ANACT_AMOUNT) AS ANACT_AMOUNT
          FROM
               (SELECT '1' || B.HOUSE_SE AS ORD
                      ,'□.조정' AS DEC_NAME
                      ,CASE
                          WHEN A.RENT_HOUSE_CODE LIKE '6%'
                          THEN  SUBSTR
                              ( (SELECT A.RENT_HOUSE_CODE ||''||H.RENT_HOUSE_NM
                                       FROM TBRNT_PUCHAS_HOUSE H
                                      WHERE H.RENT_HOUSE_CODE = A.RENT_HOUSE_CODE
                                     ),4,20 )
                             ELSE '매입임대주택'
                         END  AS RENT_HOUSE_NM
                       ,CASE
                             WHEN A.RENT_HOUSE_CODE LIKE '6%'
                             THEN MIN(A.DONG|| '-' ||A.HO) ||'외 '
                             ELSE '0001-0101외 '
                         END AS DONGHO
                        ,SUM(A.OCCRRNC_CO) AS OCCRRNC_CNT
                        ,SUM(A.ANACT_AMOUNT) AS ANACT_AMOUNT
                    FROM TBRNT_PUCHAS_ANACT A
                        ,TBRNT_PUCHAS_HOUSE B
                        ,TBCOM_CMMN_CODE C
                   WHERE 1=1
                     AND SUBSTR(A.MDAT_DE,1,6) = #APPLC_MT#
                     AND A.ANACT_SE IN('1')
                     AND A.OPERT_SE = 'A'
                     AND A.BSNS_SE = '1'
                     AND A.BUDGET_ACNT_CODE IN('6131000','6133000')
                     AND A.RENT_HOUSE_CODE = B.RENT_HOUSE_CODE
                     AND C.GRP_CODE = 'HOU0A2'
                     AND C.USE_AT = '1'
                     AND C.CODE IN ('R1','R3')
                     AND C.CODE = B.HOUSE_SE
                   GROUP BY B.HOUSE_SE, A.RENT_HOUSE_CODE
                  UNION ALL
                  SELECT
                         (   CASE
                                 WHEN A.OPERT_SE = 'A' AND A.ANACT_SE = '1'
                                 THEN '1'
                                 WHEN A.ANACT_SE = '4'
                                 THEN '3'
                                 ELSE '2'
                             END
                         ) || B.HOUSE_SE  AS ORD
                         ,( CASE
                                 WHEN A.OPERT_SE = 'A' AND A.ANACT_SE = '1'
                                 THEN '□.조정'
                                 WHEN A.ANACT_SE = '4'
                                 THEN '□.감액'
                                 ELSE '□.추가조정'
                             END
                         )  AS DEC_NAME
                         ,(  CASE
                                 WHEN A.OPERT_SE = 'A'
                                 THEN C.CODE_NM
                                 ELSE B.RENT_HOUSE_NM
                             END
                         )  AS RENT_HOUSE_NM
                         ,(  CASE
                                 WHEN A.OPERT_SE = 'A'
                                 THEN ''
                                 ELSE A.DONG|| '-' ||A.HO
                             END
                         )  AS DONGHO
                         ,SUM(A.OCCRRNC_CO) AS OCCRRNC_CNT
                         ,SUM(A.ANACT_AMOUNT) AS ANACT_AMOUNT
                    FROM TBRNT_PUCHAS_ANACT A
                        ,TBRNT_PUCHAS_HOUSE B
                        ,TBCOM_CMMN_CODE C
                   WHERE 1=1
                     AND SUBSTR(A.MDAT_DE,1,6) = #APPLC_MT#
                     AND A.ANACT_SE IN('1','4')
                     AND NVL(A.OPERT_SE,'B') <![CDATA[<>]]> 'A'
                     AND A.BSNS_SE = '1'
                     AND A.BUDGET_ACNT_CODE IN('6131000','6133000')
                     AND A.RENT_HOUSE_CODE = B.RENT_HOUSE_CODE
                     AND C.GRP_CODE = 'HOU0A2'
                     AND C.USE_AT = '1'
                     AND C.CODE IN ('R1','R3')
                     AND C.CODE = B.HOUSE_SE
                   GROUP BY A.ANACT_SE, A.OPERT_SE, B.RENT_HOUSE_NM, A.DONG, A.HO, B.HOUSE_SE, C.CODE_NM
                  )
         GROUP BY DEC_NAME, RENT_HOUSE_NM, DONGHO, ORD
         ORDER BY 1    
    
    </select>
    
	<!-- 쿼리명 : 자금수입기록부 조회
	설명 : 결의일자기준 자금수입기록부 조회
	수정일  		수정자  	수정내용
	2016.03.22	박병일	최초생성
	작성자 : 박병일
	최초작성일 : 2016.03.22
	-->
	<select id="RNT02060400DAO.selectCptalIncmeList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        SELECT BSNS_SE
               ,MDAT_DE
               ,BUDGET_ACNT_CODE
               ,CODE_NM
               ,SUM(AMT1) AS AMT1
               ,SUM(AMT2) AS AMT2
               ,SUM(AMT3) AS AMT3
               ,MAX(TAMT1) AS TAMT1
               ,MAX(TAMT2) AS TAMT2
               ,MAX(TAMT3) AS TAMT3
          FROM
               (SELECT V.BSNS_SE
                      ,V.MDAT_DE
                      ,V.BUDGET_ACNT_CODE
                      ,V.EXPNDTR_UNIT_CODE
                      ,( SELECT C.BUDGET_ACNT_NM
                           FROM TBBDG_BUDGET_ACNT_CODE C
                          WHERE 1=1
                            AND V.BUDGET_YEAR = C.YEAR
                            AND V.BSNS_SE = C.BSNS_SE
                            AND C.BALC_SE = '1'
                            AND V.BUDGET_ACNT_CODE = C.BUDGET_ACNT_CODE  ) || ' ' ||
                       ( SELECT D.EXPNDTR_UNIT_NM
                           FROM TBBDG_EXPNDTR_UNIT_CODE D
                          WHERE 1=1
                            AND V.BUDGET_YEAR = D.YEAR
                            AND V.BSNS_SE = D.BSNS_SE
                            AND D.BALC_SE = '1'
                            AND V.BUDGET_ACNT_CODE = D.BUDGET_ACNT_CODE
                            AND V.EXPNDTR_UNIT_CODE = D.EXPNDTR_UNIT_CODE ) AS CODE_NM
                      ,SUM (V.ANACT_AMOUNT) AS AMT1
                      ,( CASE  WHEN (( V.BSNS_SE = '1' AND SUBSTR(V.BUDGET_ACNT_CODE,1,2) IN ('62','64','67','41')) OR V.BSNS_SE = '3')
                               THEN SUM (ANACT_AMOUNT)
                               ELSE 0
                        END
                      ) AS AMT2
                      ,( CASE WHEN (( V.BSNS_SE = '1' AND SUBSTR(V.BUDGET_ACNT_CODE,1,2) NOT IN ('62','64','67','41')) OR V.BSNS_SE = '2')
                              THEN SUM (V.ANACT_AMOUNT)
                              ELSE 0
                        END
                      ) AS AMT3
                      <!-- 
                      ,SUM (V.ANACT_AMOUNT) AS TAMT1
                      ,( CASE  WHEN V.MDAT_DE <![CDATA[<=]]> #APPLC_DE# AND (( V.BSNS_SE = '1' AND SUBSTR(V.BUDGET_ACNT_CODE,1,2)  IN ('62','64','67','41')) OR V.BSNS_SE = '3')
                              THEN SUM (V.ANACT_AMOUNT)
                              ELSE 0
                        END
                      ) AS TAMT2
                      ,( CASE WHEN V.MDAT_DE <![CDATA[<=]]> #APPLC_DE# AND (( V.BSNS_SE = '1' AND SUBSTR(V.BUDGET_ACNT_CODE,1,2) NOT IN ('62','64','67','41')) OR V.BSNS_SE = '2')
                              THEN SUM (V.ANACT_AMOUNT)
                              ELSE 0
                          END
                      ) AS TAMT3
                      -->
                       ,(SELECT SUM(Z.ANACT_AMOUNT) FROM TBRNT_PUCHAS_ANACT Z WHERE 1=1 AND Z.MDAT_DE BETWEEN SUBSTR(#APPLC_DE#,1,4) || '0101' AND #APPLC_DE#  AND ANACT_SE IN ('2','3') )AS TAMT1
                       ,(SELECT SUM((CASE WHEN ((Z.BSNS_SE = '1' AND SUBSTR (Z.BUDGET_ACNT_CODE, 1, 2) IN ('62', '64', '67', '41')) OR Z.BSNS_SE = '3') THEN SUM (Z.ANACT_AMOUNT) ELSE 0 END))
                          FROM TBRNT_PUCHAS_ANACT Z 
                         WHERE 1=1 
                           AND Z.MDAT_DE BETWEEN SUBSTR(#APPLC_DE#,1,4) || '0101' AND V.MDAT_DE 
                           AND ANACT_SE IN ('2','3')
                         GROUP BY Z.MDAT_DE , BSNS_SE , Z.BUDGET_ACNT_CODE) AS TAMT2
                       ,(SELECT SUM((CASE WHEN ((Z.BSNS_SE = '1' AND SUBSTR (Z.BUDGET_ACNT_CODE, 1, 2) NOT IN ('62', '64', '67', '41'))  OR Z.BSNS_SE = '2') THEN SUM (Z.ANACT_AMOUNT) ELSE 0 END))
                          FROM TBRNT_PUCHAS_ANACT Z 
                         WHERE 1=1 
                           AND Z.MDAT_DE BETWEEN SUBSTR(#APPLC_DE#,1,4) || '0101' AND V.MDAT_DE 
                           AND ANACT_SE IN ('2','3')
                         GROUP BY Z.MDAT_dE , BSNS_SE , Z.BUDGET_ACNT_CODE) AS TAMT3                        
                 FROM TBRNT_PUCHAS_ANACT V
                WHERE 1=1
                  AND V.ANACT_SE IN ('2', '3')
                  AND V.MDAT_DE BETWEEN #APPLC_DE# AND #APPLC_DE_TO#
                GROUP BY V.BUDGET_YEAR, V.MDAT_DE, V.BSNS_SE, V.BUDGET_ACNT_CODE, V.EXPNDTR_UNIT_CODE
               )
          GROUP BY MDAT_DE, BSNS_SE, BUDGET_ACNT_CODE, CODE_NM
          HAVING SUM(AMT1) <![CDATA[<>]]> 0
        ORDER BY MDAT_DE, BSNS_SE, BUDGET_ACNT_CODE        
    </select>
    
	<!-- 쿼리명 : 수입예산정리부조회
	설명 : 수입예산정리부조회
	수정일  수정자  수정내용	
	작성자 : 박병일
	최초작성일 : 2016.03.02
	-->
	<select id="RNT02060400DAO.selectIncmeBdgArngList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        SELECT  A.ORD
               ,A.MDAT_DE
               ,A.BUDGET_YEAR
               ,A.BSNS_SE
               ,A.BUDGET_ACNT_CODE
               ,TRIM(D.BUDGET_ACNT_NM) AS BUDGET_ACNT_NM
               ,A.RENT_HOUSE_CODE
               ,B.RENT_HOUSE_NM
               ,A.DONG
               ,( CASE  WHEN ORD = '1'
                       THEN B.RENT_HOUSE_NM || ' ' || A.DONG || '외(' || SUM(A.CNT) || ')'
                       ELSE A.DONG
                       END ) AS REMARK
               ,( CASE  WHEN ORD = '1'
                       THEN A.RENT_HOUSE_CODE || '-' || A.DONG
                       ELSE ''
                       END ) AS CRT_CONF
               ,SUM(A.CNT) AS CNT
               ,SUM(NVL(A.PAY_CNT,0)) AS PAY_CNT
               ,SUM(A.PAY_AMT) AS PAY_AMT
               ,SUM(NVL(A.REC_CNT,0)) AS REC_CNT
               ,SUM(A.REC_AMT) AS REC_AMT
               ,SUM(NVL(A.PAY_AMT,0)) - SUM(NVL(A.REC_AMT,0)) AS DEL_AMT
          FROM
               (SELECT '1' AS ORD
                      ,MDAT_DE
                      ,BUDGET_YEAR
                      ,BSNS_SE
                      ,BUDGET_ACNT_CODE
                      ,RENT_HOUSE_CODE
                      ,MIN (DONG || '-' || HO) AS DONG
                      ,COUNT (1) AS CNT
                      ,( CASE  WHEN ANACT_SE IN ('1', '4')
                              THEN SUM (OCCRRNC_CO)
                              ELSE 0
                              END ) AS PAY_CNT
                      ,( CASE  WHEN ANACT_SE IN ('1', '4')
                              THEN SUM (ANACT_AMOUNT)
                              ELSE 0
                              END ) AS PAY_AMT
                      ,( CASE  WHEN ANACT_SE IN ('2', '3')
                              THEN SUM (OCCRRNC_CO)
                              ELSE 0
                              END ) AS REC_CNT
                      ,( CASE  WHEN ANACT_SE IN ('2', '3')
                              THEN SUM (ANACT_AMOUNT)
                              ELSE 0
                              END ) AS REC_AMT
                 FROM TBRNT_PUCHAS_ANACT
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,6) = #APPLC_MT#
                GROUP BY BUDGET_YEAR
                        ,MDAT_DE
                        ,ANACT_SE
                        ,BSNS_SE
                        ,BUDGET_ACNT_CODE
                        ,RENT_HOUSE_CODE
               UNION ALL
               SELECT '2' AS ORD
                      ,NULL AS MDAT_DE
                      ,BUDGET_YEAR
                      ,BSNS_SE
                      ,BUDGET_ACNT_CODE
                      ,'' AS RENT_HOUSE_CODE
                      ,'월계' AS DONG
                      ,COUNT (1) AS CNT
                      ,( CASE  WHEN ANACT_SE IN ('1', '4')
                              THEN SUM (OCCRRNC_CO)
                              ELSE 0
                              END ) AS PAY_CNT
                      ,( CASE  WHEN ANACT_SE IN ('1', '4')
                              THEN SUM (ANACT_AMOUNT)
                              ELSE 0
                              END ) AS PAY_AMT
                      ,( CASE  WHEN ANACT_SE IN ('2', '3')
                              THEN SUM (OCCRRNC_CO)
                              ELSE 0
                              END ) AS REC_CNT
                      ,( CASE  WHEN ANACT_SE IN ('2', '3')
                              THEN SUM (ANACT_AMOUNT)
                              ELSE 0
                              END ) AS REC_AMT
                 FROM TBRNT_PUCHAS_ANACT
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,6) = #APPLC_MT#
                GROUP BY BUDGET_YEAR
                        ,ANACT_SE
                        ,BSNS_SE
                        ,BUDGET_ACNT_CODE
               UNION ALL
               SELECT '3' AS ORD
                      ,NULL AS MDAT_DE
                      ,BUDGET_YEAR
                      ,BSNS_SE
                      ,BUDGET_ACNT_CODE
                      ,'' AS RENT_HOUSE_CODE
                      ,'누계' AS DONG
                      ,COUNT (1) AS CNT
                      ,( CASE  WHEN ANACT_SE IN ('1', '4')
                              THEN SUM (OCCRRNC_CO)
                              ELSE 0
                              END ) AS PAY_CNT
                      ,( CASE  WHEN ANACT_SE IN ('1', '4')
                              THEN SUM (ANACT_AMOUNT)
                              ELSE 0
                              END ) AS PAY_AMT
                      ,( CASE  WHEN ANACT_SE IN ('2', '3')
                              THEN SUM (OCCRRNC_CO)
                              ELSE 0
                              END ) AS REC_CNT
                      ,( CASE  WHEN ANACT_SE IN ('2', '3')
                              THEN SUM (ANACT_AMOUNT)
                              ELSE 0
                              END ) AS REC_AMT
                 FROM TBRNT_PUCHAS_ANACT
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,6) = #APPLC_MT#
                GROUP BY BUDGET_YEAR
                         ,MDAT_DE
                         ,ANACT_SE
                         ,BSNS_SE
                         ,BUDGET_ACNT_CODE
               UNION ALL
               SELECT '1' AS ORD
                      ,MDAT_DE
                      ,BUDGET_YEAR
                      ,SUBSTR(BUDGET_ACNT_SE,1,1)     AS BSNS_SE
                      ,BUDGET_ACNTCTGR  AS BUDGET_ACNT_CODE
                      ,'' AS RENT_HOUSE_CODE
                      ,'' AS DONG
                      ,0 AS CNT
                      ,1 AS PAY_CNT
                      ,SUM (AMOUNT) AS PAY_AMT
                      ,0 AS REC_CNT
                      ,0 AS REC_AMT
                 FROM TBRNT_PSTYR_ATMPT_AMOUNT
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                  AND JOB_SE_CODE = 'RN2'
                GROUP BY BUDGET_YEAR
                        ,MDAT_DE
                        ,BUDGET_ACNT_SE
                        ,BUDGET_ACNTCTGR
               UNION ALL
               SELECT '2' AS ORD
                      ,NULL AS MDAT_DE
                      ,BUDGET_YEAR
                      ,SUBSTR(BUDGET_ACNT_SE,1,1)     AS BSNS_SE
                      ,BUDGET_ACNTCTGR     AS BUDGET_ACNT_CODE
                      ,'' AS RENT_HOUSE_CODE
                      ,'월계' AS DONG
                      ,0 AS CNT
                      ,1 AS PAY_CNT
                      ,SUM (AMOUNT) AS PAY_AMT
                      ,0 AS REC_CNT
                      ,0 AS REC_AMT
                 FROM TBRNT_PSTYR_ATMPT_AMOUNT
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                  AND JOB_SE_CODE = 'RN2'
                GROUP BY BUDGET_YEAR
                        ,BUDGET_ACNT_SE
                        ,BUDGET_ACNTCTGR
               UNION ALL
               SELECT '3' AS ORD
                      ,NULL AS MDAT_DE
                      ,BUDGET_YEAR
                      ,SUBSTR(BUDGET_ACNT_SE,1,1)     AS BSNS_SE
                      ,BUDGET_ACNTCTGR     AS  BUDGET_ACNT_CODE
                      ,'' AS RENT_HOUSE_CODE
                      ,'누계' AS DONG
                      ,COUNT (1) AS CNT
                      ,1 AS PAY_CNT
                      ,SUM (AMOUNT) AS PAY_AMT
                      ,0 AS REC_CNT
                      ,0 AS REC_AMT
                 FROM TBRNT_PSTYR_ATMPT_AMOUNT
                WHERE 1=1
                  AND SUBSTR(MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                  AND JOB_SE_CODE = 'RN2'
                GROUP BY BUDGET_YEAR
                        ,MDAT_DE
                        ,BUDGET_ACNT_SE
                        ,BUDGET_ACNTCTGR
               ) A,
               TBRNT_PUCHAS_HOUSE B,
               VHBDG_BUDGET_ACNT_CODE D
         WHERE 1=1
           AND A.RENT_HOUSE_CODE = B.RENT_HOUSE_CODE(+)
           AND A.BUDGET_YEAR = D.YEAR(+)
           AND A.BSNS_SE = D.BSNS_SE(+)
           AND A.BUDGET_ACNT_CODE = D.BUDGET_ACNT_CODE(+)
         GROUP BY A.ORD
                  ,A.MDAT_DE
                  ,A.BUDGET_YEAR
                  ,A.BSNS_SE
                  ,A.BUDGET_ACNT_CODE
                  ,TRIM(D.BUDGET_ACNT_NM)
                  ,A.RENT_HOUSE_CODE
                  ,B.RENT_HOUSE_NM
                  ,A.DONG
        ORDER BY A.BSNS_SE
                 ,A.BUDGET_ACNT_CODE
                 ,A.ORD
                 ,A.MDAT_DE
                 ,A.RENT_HOUSE_CODE
	</select>
	
	<!-- 쿼리명 : 수입조정일계표조회
	설명 : 수입조정일계표조회
	수정일  수정자  수정내용	
	작성자 : 박병일
	최초작성일 : 2016.03.02
	-->
	<select id="RNT02060400DAO.selectIncmeMdatDailyList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
	WITH V1 AS ( SELECT V.MDAT_DE
                   ,V.BUDGET_YEAR
                   ,V.BSNS_SE
                   ,V.BUDGET_ACNT_CODE
                   ,V.EXPNDTR_UNIT_CODE
                   ,D.GWAN_NM     AS KWAN
                   ,D.HANG_NM     AS HANG
                   ,D.HANG_CD     AS HANG_CODE
                   ,D.SEHANG_NM     AS SEHANG
                   ,D.SEHANG_CD     AS SEHANG_CODE
                   ,D.MOK_NM         AS MOK
                   ,SUM(CASE WHEN ANACT_SE IN('1','4') THEN V.OCCRRNC_CO   ELSE 0 END) AS PAY_CNT
                   ,SUM(CASE WHEN ANACT_SE IN('1','4') THEN V.ANACT_AMOUNT ELSE 0 END) AS PAY_AMT
                   ,SUM(CASE WHEN ANACT_SE IN('2','3') THEN V.OCCRRNC_CO   ELSE 0 END) AS REC_CNT
                   ,SUM(CASE WHEN ANACT_SE IN('2','3') THEN V.ANACT_AMOUNT ELSE 0 END) AS REC_AMT
              FROM TBRNT_PUCHAS_ANACT V,
                   VHBDG_BUDGET_ACNT_CODE D
             WHERE V.MDAT_DE BETWEEN #APPLC_DE# AND #APPLC_DE_TO#                                 
               AND V.BUDGET_YEAR = D.YEAR
               AND V.BSNS_SE = D.BSNS_SE
               AND V.BUDGET_ACNT_CODE = D.BUDGET_ACNT_CODE
             GROUP BY V.MDAT_DE
                    , V.BUDGET_YEAR
                    , V.BSNS_SE
                    , V.BUDGET_ACNT_CODE
                    , V.EXPNDTR_UNIT_CODE
                    , D.GWAN_NM
                    , D.HANG_NM
                    , D.HANG_CD
                    , D.SEHANG_NM
                    , D.SEHANG_CD
                    , D.MOK_NM                                                   
        )
        , V2 AS ( SELECT  D.GWAN_NM AS KWAN
                         ,D.HANG_NM AS HANG
                         ,D.HANG_CD AS HANG_CODE
                         ,D.SEHANG_NM AS SEHANG
                         ,D.SEHANG_CD AS SEHANG_CODE
                         ,D.MOK_NM AS MOK
                         ,V.MDAT_DE
                         ,V.BUDGET_YEAR
                         ,SUBSTR(V.BUDGET_ACNT_SE,1,1) AS BSNS_SE
                         ,V.BUDGET_ACNTCTGR AS BUDGET_ACNT_CODE
                         ,V.BUKIP_CODE AS EXPNDTR_UNIT_CODE
                         ,V.AMOUNT AS PAY_AMT
                         ,1 AS PAY_CNT
                         ,V.PAY_SE
                    FROM TBRNT_PSTYR_ATMPT_AMOUNT V
                        ,VHBDG_BUDGET_ACNT_CODE D
                   WHERE SUBSTR(V.MDAT_DE,1,4) = SUBSTR(#APPLC_DE#,1,4)
                     AND V.BUDGET_YEAR = D.YEAR
                     AND V.BUDGET_ACNT_SE = D.BSNS_SE || D.BALC_SE
                     AND V.BUDGET_ACNTCTGR = D.BUDGET_ACNT_CODE
                     AND V.JOB_SE_CODE = 'RN1'
        )
        SELECT MDAT_DE, ORD
              ,ORD1
              ,KWAN
              ,HANG
              ,HANG_CODE
              ,SEHANG
              ,SEHANG_CODE
              ,MOK
              ,BSNS_SE
              ,BUDGET_ACNT_CODE
              ,COL_TITLE
              ,SUM(PAY_CNT) AS PAY_CNT
              ,SUM(PAY_AMT) AS PAY_AMT
              ,SUM(REC_CNT) AS REC_CNT
              ,SUM(REC_AMT) AS REC_AMT
          FROM
               (
                 SELECT MDAT_DE
                        , '1'         AS ORD
                        ,'1'         AS ORD1
                        ,'총    계' AS KWAN
                        ,NULL         AS HANG
                        ,NULL         AS HANG_CODE
                        ,NULL         AS SEHANG
                        ,NULL         AS SEHANG_CODE
                        ,NULL         AS MOK
                        ,'1'         AS BSNS_SE
                        ,'1'         AS BUDGET_ACNT_CODE
                        ,'          총                 계' AS COL_TITLE
                        ,SUM(PAY_CNT) AS PAY_CNT
                        ,SUM(PAY_AMT) AS PAY_AMT
                        ,SUM(REC_CNT) AS REC_CNT
                        ,SUM(REC_AMT) AS REC_AMT
                   FROM V1
                  GROUP BY MDAT_DE                   
                  UNION ALL
                 SELECT MDAT_DE
                        ,'2' ORD
                        ,'2' AS ORD1
                        ,KWAN
                        ,NULL AS HANG
                        ,'1' AS HANG_CODE
                        ,NULL AS SEHANG
                        ,NULL AS SEHANG_CODE
                        ,NULL AS MOK
                        ,BSNS_SE
                        ,'1' AS BUDGET_ACNT_CODE
                        ,KWAN AS COL_TITLE
                        ,SUM(PAY_CNT) AS PAY_CNT
                        ,SUM(PAY_AMT) AS PAY_AMT
                        ,SUM(REC_CNT) AS REC_CNT
                        ,SUM(REC_AMT) AS REC_AMT
                   FROM V1                  
                  GROUP BY MDAT_DE, KWAN, BSNS_SE
                   UNION ALL
               SELECT MDAT_DE
                      ,'3' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,NULL AS SEHANG
                      ,'1' AS SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'2' AS BUDGET_ACNT_CODE
                      ,LPAD(' ',5,' ') || HANG AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,SUM(REC_CNT) AS REC_CNT
                      ,SUM(REC_AMT) AS REC_AMT
                 FROM V1                
                GROUP BY MDAT_DE, KWAN, HANG, BSNS_SE, HANG_CODE
                   UNION ALL
               SELECT MDAT_DE
                      ,'4' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,SEHANG
                      ,SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'3' AS BUDGET_ACNT_CODE
                      ,LPAD(' ',14,' ') || SEHANG AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,SUM(REC_CNT) AS REC_CNT
                      ,SUM(REC_AMT) AS REC_AMT
                 FROM V1
                GROUP BY MDAT_DE, KWAN,HANG,HANG_CODE,SEHANG,SEHANG_CODE,BSNS_SE
                   UNION ALL
               SELECT MDAT_DE
                      ,'5' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,SEHANG
                      ,SEHANG_CODE
                      ,MOK
                      ,BSNS_SE
                      ,BUDGET_ACNT_CODE
                      ,LPAD(' ',24,' ') || MOK AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,SUM(REC_CNT) AS REC_CNT
                      ,SUM(REC_AMT) AS REC_AMT
                 FROM V1                
                GROUP BY MDAT_DE, KWAN,HANG,HANG_CODE,SEHANG,SEHANG_CODE,MOK,BSNS_SE,BUDGET_ACNT_CODE
               UNION ALL
               SELECT V.MDAT_DE
                      , '1' ORD
                      ,'1' AS ORD1
                      ,'총    계' KWAN
                      ,NULL AS HANG
                      ,NULL AS HANG_CODE
                      ,NULL AS SEHANG
                      ,NULL AS SEHANG_CODE
                      ,NULL AS MOK
                      ,'1' AS BSNS_SE
                      ,'1' AS BUDGET_ACNT_CODE
                      ,'          총                 계' AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,0 AS REC_CNT
                      ,0 AS REC_AMT
                 FROM (SELECT DISTINCT MDAT_DE FROM V1) V, V2                
               GROUP BY V.MDAT_DE
               UNION ALL
               SELECT V.MDAT_DE
                      ,'2' ORD,
                      '2' AS ORD1,
                      KWAN,
                      NULL AS HANG,
                      '1' AS HANG_CODE,
                      NULL AS SEHANG,
                      NULL AS SEHANG_CODE,
                      NULL AS MOK,
                      BSNS_SE,
                      '1' AS BUDGET_ACNT_CODE,
                      KWAN AS COL_TITLE,
                      SUM(PAY_CNT) AS PAY_CNT,
                      SUM(PAY_AMT) AS PAY_AMT,
                      0 AS REC_CNT,
                      0 AS REC_AMT
                 FROM (SELECT DISTINCT MDAT_DE FROM V1) V, V2                
                GROUP BY V.MDAT_DE,KWAN,BSNS_SE
               UNION ALL
               SELECT V.MDAT_DE
                      ,'3' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,NULL AS SEHANG
                      ,'1' AS SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'2' AS BUDGET_ACNT_CODE
                      ,LPAD(' ',5,' ') || HANG AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,0 AS REC_CNT
                      ,0 AS REC_AMT
                 FROM (SELECT DISTINCT MDAT_DE FROM V1) V, V2                
                GROUP BY V.MDAT_DE,KWAN
                        ,HANG
                        ,BSNS_SE
                        ,HANG_CODE
               UNION ALL
               SELECT V.MDAT_DE
                      ,'4' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,SEHANG
                      ,SEHANG_CODE
                      ,NULL AS MOK
                      ,BSNS_SE
                      ,'3' AS BUDGET_ACNT_CODE
                      ,LPAD(' ',14,' ') || SEHANG AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,0 AS REC_CNT
                      ,0 AS REC_AMT
                 FROM (SELECT DISTINCT MDAT_DE FROM V1) V, V2
                GROUP BY V.MDAT_DE,KWAN
                        ,HANG
                        ,HANG_CODE
                        ,SEHANG
                        ,SEHANG_CODE
                        ,BSNS_SE
               UNION ALL
               SELECT V.MDAT_DE
                      ,'5' ORD
                      ,'2' AS ORD1
                      ,KWAN
                      ,HANG
                      ,HANG_CODE
                      ,SEHANG
                      ,SEHANG_CODE
                      ,MOK
                      ,BSNS_SE
                      ,BUDGET_ACNT_CODE
                      ,LPAD(' ',24,' ') || MOK AS COL_TITLE
                      ,SUM(PAY_CNT) AS PAY_CNT
                      ,SUM(PAY_AMT) AS PAY_AMT
                      ,0 AS REC_CNT
                      ,0 AS REC_AMT
                 FROM (SELECT DISTINCT MDAT_DE FROM V1) V, V2
                GROUP BY V.MDAT_DE,KWAN
                        ,HANG
                        ,HANG_CODE
                        ,SEHANG
                        ,SEHANG_CODE
                        ,MOK
                        ,BSNS_SE
                        ,BUDGET_ACNT_CODE
                       )
         GROUP BY MDAT_DE, ORD
                  ,ORD1
                 ,KWAN
                 ,HANG
                 ,HANG_CODE
                 ,SEHANG
                 ,SEHANG_CODE
                 ,MOK
                 ,BSNS_SE
                 ,BUDGET_ACNT_CODE
                 ,COL_TITLE
        ORDER BY MDAT_DE, ORD1
                 ,BSNS_SE
                 ,HANG_CODE
                 ,SEHANG_CODE
                 ,ORD
                 ,BUDGET_ACNT_CODE
    </select>
    
	<!-- 쿼리명 : 지구별예산정리부상세내역 조회
	설명 : 지구별예산정리부상세내역_월계표 조회
	수정일  수정자  수정내용	
	작성자 : 박병일
	최초작성일 : 2016.03.02
	-->
	<select id="RNT02060400DAO.selectAreaIncmeBdgArngList1" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        SELECT X.SORTING                 AS ORD
               ,X.RENT_HOUSE_CODE         AS RENT_HOUSE_CODE
               ,SUBSTR(X.RENT_HOUSE_CODE || ' ' ||
               (SELECT RENT_HOUSE_NM
                 FROM TBRNT_PUCHAS_HOUSE
                WHERE RENT_HOUSE_CODE = X.RENT_HOUSE_CODE
               ),1,40)                     AS RENT_HOUSE_NM
               ,X.DONG                     AS DONG
               ,X.HO                     AS HO
               ,X.CNAME                 AS CNAME
               ,X.MDAT_DE                 AS MDAT_DE
               ,X.BUDGET_YEAR             AS BUDGET_YEAR
               ,X.BSNS_SE                 AS BSNS_SE
               ,X.BUDGET_ACNT_CODE         AS BUDGET_ACNT_CODE
               ,X.ACC_NAME                 AS BUDGET_ACNT_NM
               ,X.SUMRY_1                AS JUK
               ,X.OCCRRNC_CO             AS OCCRRNC_CO
               ,X.ANACT_AMOUNT             AS ANACT_AMOUNT
               ,X.OCCRRNC_CO2             AS OCCRRNC_CO2
               ,X.ANACT_AMOUNT2         AS ANACT_AMOUNT2
               ,(X.ANACT_AMOUNT - X.ANACT_AMOUNT2) AS OPEN_AMT
               ,0 AS BUDGET_AMT
          FROM
               (
                SELECT '1' SORTING
                      ,T.RENT_HOUSE_CODE
                      ,T.DONG
                      ,T.HO
                      ,T.MDAT_DE
                      ,T.BUDGET_YEAR
                      ,T.BSNS_SE
                      ,T.BUDGET_ACNT_CODE
                      ,( SELECT C.BUDGET_ACNT_NM
                           FROM VHBDG_BUDGET_ACNT_CODE C
                          WHERE C.BSNS_SE = T.BSNS_SE
                            AND C.BUDGET_ACNT_CODE = T.BUDGET_ACNT_CODE 
                            AND C.YEAR = T.BUDGET_YEAR ) || '(' || T.BUDGET_ACNT_CODE || ')' AS ACC_NAME
                      ,T.SUMRY_1         AS SUMRY_1
                      ,T.CNAME             AS CNAME
                      ,T.OCCRRNC_CO     AS OCCRRNC_CO
                      ,T.ANACT_AMOUNT     AS ANACT_AMOUNT
                      ,T.OCCRRNC_CO2     AS OCCRRNC_CO2
                      ,T.ANACT_AMOUNT2     AS ANACT_AMOUNT2
                 FROM
                     (
                      SELECT A.RENT_HOUSE_CODE
                             ,A.DONG
                             ,A.HO
                             ,A.MDAT_DE
                             ,A.BUDGET_YEAR
                             ,A.BSNS_SE
                             ,A.BUDGET_ACNT_CODE
                             ,A.SUMRY_1 AS SUMRY_1
                             ,( SELECT T2.NM
                                  FROM TBRNT_PUCHAS_CNTRCT T1
                                      ,TBRNT_PUCHAS_RENT_CSTMR T2
                                 WHERE 1=1
                                   AND T1.PUCHAS_CSTMR_NO = T2.PUCHAS_CSTMR_NO
                                   AND T1.CNTRCTR_NO = A.CNTRCTR_NO ) AS CNAME
                             ,(DECODE(A.ANACT_SE,'1',A.OCCRRNC_CO,'4',A.OCCRRNC_CO,0))         AS OCCRRNC_CO
                             ,(DECODE(A.ANACT_SE,'1',A.ANACT_AMOUNT,'4',A.ANACT_AMOUNT,0))     AS ANACT_AMOUNT
                             ,(DECODE(A.ANACT_SE,'2',A.OCCRRNC_CO,'3',A.OCCRRNC_CO,0))         AS OCCRRNC_CO2
                             ,(DECODE(A.ANACT_SE,'2',A.ANACT_AMOUNT,'3',A.ANACT_AMOUNT,0))     AS ANACT_AMOUNT2
                        FROM TBRNT_PUCHAS_ANACT A
                       WHERE 1=1
                         AND A.BUDGET_ACNT_CODE IN ('613100','613300','6131000','6133000')
                         AND NVL(A.RENT_HOUSE_CODE,'000') LIKE #HOUSE_CODE# || '%'
                         AND NVL(A.RENT_HOUSE_CODE,'600') IN (SELECT RENT_HOUSE_CODE
                                                                 FROM TBRNT_PUCHAS_HOUSE
                                                                WHERE 1=1
                                                                  AND HOUSE_SE LIKE #HOUSE_SE#)
                         AND A.BSNS_SE LIKE #BSNS_SE# || '%'
                         AND A.BUDGET_ACNT_CODE LIKE #BUDGET_ACNT_CODE# || '%'
                         AND A.EXPNDTR_UNIT_CODE LIKE #EXPNDTR_UNIT_CODE# || '%'
                         AND SUBSTR(A.MDAT_DE,1,6) = #APPLC_MT#
                       UNION ALL
                       SELECT A.RENT_HOUSE_CODE
                             ,A.DONG
                             ,A.HO
                             ,A.MDAT_DE
                             ,A.BUDGET_YEAR
                             ,A.BSNS_SE
                             ,A.BUDGET_ACNT_CODE
                             ,A.SUMRY_1
                             ,( SELECT T2.NM
                                  FROM TBRNT_PUCHAS_CNTRCT T1
                                      ,TBRNT_PUCHAS_RENT_CSTMR T2
                                 WHERE 1=1
                                   AND T1.PUCHAS_CSTMR_NO = T2.PUCHAS_CSTMR_NO
                                   AND T1.CNTRCTR_NO = A.CNTRCTR_NO ) AS CNAME
                             ,(DECODE(ANACT_SE,'1',A.OCCRRNC_CO,'4',A.OCCRRNC_CO,0))         AS OCCRRNC_CO
                             ,(DECODE(ANACT_SE,'1',A.ANACT_AMOUNT,'4',A.ANACT_AMOUNT,0))     AS ANACT_AMOUNT
                             ,(DECODE(ANACT_SE,'2',A.OCCRRNC_CO,'3',A.OCCRRNC_CO,0))         AS OCCRRNC_CO2
                             ,(DECODE(ANACT_SE,'2',A.ANACT_AMOUNT,'3',A.ANACT_AMOUNT,0))     AS ANACT_AMOUNT2
                        FROM TBRNT_PUCHAS_ANACT A
                       WHERE 1=1
                         AND SUBSTR(A.MDAT_DE,1,6) = #APPLC_MT#
                         AND A.BUDGET_ACNT_CODE NOT IN ('613100','613300', '6131000','6133000')
                         AND NVL(A.RENT_HOUSE_CODE,'000') LIKE #HOUSE_CODE# || '%'
                         AND NVL(RENT_HOUSE_CODE,'600') IN (SELECT RENT_HOUSE_CODE
                                                               FROM TBRNT_PUCHAS_HOUSE
                                                              WHERE HOUSE_SE LIKE #HOUSE_SE#)
                         AND A.BSNS_SE LIKE #BSNS_SE# || '%'
                         AND A.BUDGET_ACNT_CODE LIKE #BUDGET_ACNT_CODE# || '%'
                         AND A.EXPNDTR_UNIT_CODE LIKE #EXPNDTR_UNIT_CODE# || '%'
                       UNION ALL
                       SELECT A.HOUSE_CODE AS RENT_HOUSE_CODE
                             ,NULL DONG
                             ,NULL HO
                             ,A.MDAT_DE
                             ,A.BUDGET_YEAR
                             ,A.BUDGET_ACNT_SE     AS BSNS_SE
                             ,A.BUDGET_ACNTCTGR AS BUDGET_ACNT_CODE
                             ,A.RM AS SUMRY_1
                             ,'' CNAME
                             ,0 AS OCCRRNC_CO
                             ,A.AMOUNT AS ANACT_AMOUNT
                             ,0 OCCRRNC_CO2
                             ,0 ANACT_AMOUNT2
                        FROM TBRNT_PSTYR_ATMPT_AMOUNT A
                       WHERE 1=1
                         AND SUBSTR(A.MDAT_DE,1,6) = #APPLC_MT#
                         AND A.JOB_SE_CODE = 'RN2'
                         AND A.BUDGET_ACNT_SE LIKE #BSNS_SE# || '%'
                         AND A.BUDGET_ACNTCTGR LIKE #BUDGET_ACNT_CODE# || '%'
                         AND A.BUKIP_CODE LIKE #EXPNDTR_UNIT_CODE# || '%'
                         AND A.ANACT_SE = '1'
                         AND A.PAY_SE = '1'
                         AND NVL(A.HOUSE_CODE,'000') LIKE #HOUSE_CODE# || '%'
                         AND NVL(A.HOUSE_CODE,'600') IN (SELECT RENT_HOUSE_CODE
                                                             FROM TBRNT_PUCHAS_HOUSE
                                                            WHERE HOUSE_SE LIKE #HOUSE_SE# )
                      ) T
        
               UNION ALL
        
               SELECT '2' AS SORTING
                      ,Y.RENT_HOUSE_CODE AS RENT_HOUSE_CODE
                      ,'' AS DONG
                      ,'' AS HO
                      ,'' AS MDAT_DE
                      ,Y.BUDGET_YEAR
                      ,Y.BSNS_SE
                      ,Y.BUDGET_ACNT_CODE
                      ,'월  계'     AS ACC_NAME
                      ,'월계'     AS SUMRY_1
                      ,'' AS CNAME
                      ,SUM(Y.OCCRRNC_CO)     AS OCCRRNC_CO
                      ,SUM(Y.ANACT_AMOUNT)     AS ANACT_AMOUNT
                      ,SUM(Y.OCCRRNC_CO2)     AS OCCRRNC_CO2
                      ,SUM(Y.ANACT_AMOUNT2) AS ANACT_AMOUNT2
                 FROM
                      (SELECT A.RENT_HOUSE_CODE
                             ,A.BUDGET_YEAR
                             ,A.BSNS_SE
                             ,A.BUDGET_ACNT_CODE
                             ,SUM(DECODE(ANACT_SE,'1',A.OCCRRNC_CO,'4',A.OCCRRNC_CO,0))     AS OCCRRNC_CO
                             ,SUM(DECODE(ANACT_SE,'1',A.ANACT_AMOUNT,'4',A.ANACT_AMOUNT,0)) AS ANACT_AMOUNT
                             ,SUM(DECODE(ANACT_SE,'2',A.OCCRRNC_CO,'3',A.OCCRRNC_CO,0))     AS OCCRRNC_CO2
                             ,SUM(DECODE(ANACT_SE,'2',A.ANACT_AMOUNT,'3',A.ANACT_AMOUNT,0)) AS ANACT_AMOUNT2
                        FROM TBRNT_PUCHAS_ANACT A
                       WHERE 1=1
                         AND A.ANACT_SE IN ('1','2','3','4')
                         AND SUBSTR(A.MDAT_DE,1,6) = #APPLC_MT#
                         AND A.BSNS_SE LIKE #BSNS_SE# || '%'
                         AND A.BUDGET_ACNT_CODE LIKE #BUDGET_ACNT_CODE# || '%'
                         AND A.EXPNDTR_UNIT_CODE LIKE #EXPNDTR_UNIT_CODE# || '%'
                         AND NVL(A.RENT_HOUSE_CODE,'000') LIKE #HOUSE_CODE# || '%'
                         AND NVL(RENT_HOUSE_CODE,'600') IN (SELECT RENT_HOUSE_CODE
                                                             FROM TBRNT_PUCHAS_HOUSE
                                                            WHERE HOUSE_SE LIKE #HOUSE_SE#)
                       GROUP BY A.RENT_HOUSE_CODE
                               ,A.BUDGET_YEAR
                               ,A.BSNS_SE
                               ,A.BUDGET_ACNT_CODE
                      UNION ALL
                      SELECT A.HOUSE_CODE AS RENT_HOUSE_CODE
                             ,A.BUDGET_YEAR
                             ,SUBSTR(A.BUDGET_ACNT_SE,1,1) AS BSNS_SE
                             ,A.BUDGET_ACNTCTGR AS BUDGET_ACNT_CODE
                             ,1 AS OCCRRNC_CO
                             ,SUM(DECODE( SUBSTR(A.MDAT_DE ,5,2) , '01', AMOUNT, 0)) AS ANACT_AMOUNT
                             ,0 AS OCCRRNC_CO2
                             ,0 AS ANACT_AMOUNT2
                        FROM TBRNT_PSTYR_ATMPT_AMOUNT A
                       WHERE A.ANACT_SE = '1'
                         AND A.PAY_SE = '1'
                         AND A.JOB_SE_CODE = 'RN2'
                         AND SUBSTR(A.MDAT_DE,1,6) = #APPLC_MT#
                         AND SUBSTR(A.BUDGET_ACNT_SE,1,1) LIKE #BSNS_SE# || '%'
                         AND A.BUDGET_ACNTCTGR LIKE #BUDGET_ACNT_CODE# || '%'
                         AND A.BUKIP_CODE LIKE #EXPNDTR_UNIT_CODE# || '%'
                         AND NVL(A.HOUSE_CODE,'000') LIKE #HOUSE_CODE# || '%'
                         AND NVL(A.HOUSE_CODE,'600') IN (SELECT RENT_HOUSE_CODE
                                                             FROM TBRNT_PUCHAS_HOUSE
                                                            WHERE HOUSE_SE LIKE #HOUSE_SE#)
                       GROUP BY A.HOUSE_CODE
                               ,A.BUDGET_YEAR
                               ,SUBSTR(A.BUDGET_ACNT_SE,1,1)
                               ,A.BUDGET_ACNTCTGR
                      ) Y
                GROUP BY Y.RENT_HOUSE_CODE
                        ,Y.BUDGET_YEAR
                        ,Y.BSNS_SE
                        ,Y.BUDGET_ACNT_CODE
        
               UNION ALL
        
               SELECT '3' AS SORTING
                      ,Z.RENT_HOUSE_CODE
                      ,'' AS DONG
                      ,'' AS HO
                      ,'' AS MDAT_DE
                      ,Z.BUDGET_YEAR
                      ,Z.BSNS_SE
                      ,Z.BUDGET_ACNT_CODE
                      ,'누  계'     AS ACC_NAME
                      ,'누계'     AS SUMRY_1
                      ,'' CNAME
                      ,SUM(Z.OCCRRNC_CO)     AS OCCRRNC_CO
                      ,SUM(Z.ANACT_AMOUNT)     AS ANACT_AMOUNT
                      ,SUM(Z.OCCRRNC_CO2)     AS OCCRRNC_CO2
                      ,SUM(Z.ANACT_AMOUNT2) AS ANACT_AMOUNT2
                 FROM
                      (SELECT A.RENT_HOUSE_CODE
                             ,A.BUDGET_YEAR
                             ,A.BSNS_SE
                             ,A.BUDGET_ACNT_CODE
                             ,NVL(SUM(DECODE(ANACT_SE,'1',A.OCCRRNC_CO,'4',A.OCCRRNC_CO,0)),0)         AS OCCRRNC_CO
                             ,NVL(SUM(DECODE(ANACT_SE,'1',A.ANACT_AMOUNT,'4',A.ANACT_AMOUNT,0)),0)     AS ANACT_AMOUNT
                             ,NVL(SUM(DECODE(ANACT_SE,'2',A.OCCRRNC_CO,'3',A.OCCRRNC_CO,0)),0)         AS OCCRRNC_CO2
                             ,NVL(SUM(DECODE(ANACT_SE,'2',A.ANACT_AMOUNT,'3',A.ANACT_AMOUNT,0)),0)     AS ANACT_AMOUNT2
                        FROM TBRNT_PUCHAS_ANACT A
                       WHERE 1=1
                         AND SUBSTR(A.MDAT_DE,1,6) BETWEEN SUBSTR(#APPLC_MT#,1,4) || '01' AND #APPLC_MT#
                         AND NVL(A.RENT_HOUSE_CODE,'000') LIKE #HOUSE_CODE# || '%'
                         AND NVL(RENT_HOUSE_CODE,'600') IN (SELECT RENT_HOUSE_CODE
                                                               FROM TBRNT_PUCHAS_HOUSE
                                                             WHERE HOUSE_SE LIKE #HOUSE_SE# )
                         AND A.BSNS_SE LIKE #BSNS_SE# || '%'
                         AND A.BUDGET_ACNT_CODE LIKE #BUDGET_ACNT_CODE# || '%'
                         AND A.EXPNDTR_UNIT_CODE LIKE #EXPNDTR_UNIT_CODE# || '%'
                       GROUP BY A.RENT_HOUSE_CODE
                               ,A.BUDGET_YEAR
                               ,A.BSNS_SE
                               ,A.BUDGET_ACNT_CODE
                      UNION ALL
                      SELECT A.HOUSE_CODE AS RENT_HOUSE_CODE
                            ,A.BUDGET_YEAR
                            ,SUBSTR(A.BUDGET_ACNT_SE,1,1) AS BSNS_SE
                            ,A.BUDGET_ACNTCTGR AS BUDGET_ACNT_CODE
                            ,1 AS OCCRRNC_CO
                            ,NVL(SUM(DECODE(SUBSTR(A.MDAT_DE,5,2) , '01', AMOUNT, 0)),0) AS ANACT_AMOUNT
                            ,0 AS OCCRRNC_CO2
                            ,0 AS ANACT_AMOUNT2
                        FROM TBRNT_PSTYR_ATMPT_AMOUNT A
                       WHERE 1=1
                         AND A.ANACT_SE = '1'
                         AND A.PAY_SE = '1'
                         AND A.JOB_SE_CODE = 'RN2'
                         AND SUBSTR(A.BUDGET_ACNT_SE,1,1) LIKE #BSNS_SE# || '%'
                         AND A.BUDGET_ACNTCTGR LIKE #BUDGET_ACNT_CODE# || '%'
                         AND A.BUKIP_CODE LIKE #EXPNDTR_UNIT_CODE# || '%'
                         AND NVL(A.HOUSE_CODE,'000') LIKE #HOUSE_SE#
                         AND NVL(A.HOUSE_CODE,'600') IN (SELECT RENT_HOUSE_CODE
                                                           FROM TBRNT_PUCHAS_HOUSE
                                                          WHERE HOUSE_SE LIKE #HOUSE_SE#)
                         AND SUBSTR(A.MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                       GROUP BY A.HOUSE_CODE
                               ,A.BUDGET_YEAR
                               ,SUBSTR(A.BUDGET_ACNT_SE,1,1)
                               ,A.BUDGET_ACNTCTGR
                      ) Z
                GROUP BY Z.RENT_HOUSE_CODE
                        ,Z.BUDGET_YEAR
                        ,Z.BSNS_SE
                        ,Z.BUDGET_ACNT_CODE
               ) X
        ORDER BY X.BUDGET_ACNT_CODE
                ,X.RENT_HOUSE_CODE
                ,X.MDAT_DE
                ,X.DONG
                ,X.HO
                ,X.SORTING            
	</select>
	
	<!-- 쿼리명 : 지구별예산정리부집계표 조회
	설명 : 지구별예산정리부집계표 조회
	수정일  수정자  수정내용	
	작성자 : 박병일
	최초작성일 : 2016.03.02
	-->
	<select id="RNT02060400DAO.selectAreaIncmeBdgArngList2" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        SELECT MAX(X.RENT_HOUSE_CODE) AS RENT_HOUSE_CODE
              , MAX(X.RENT_HOUSE_CODE) || ' ' || NVL(MAX((SELECT RENT_HOUSE_NM
                                                            FROM TBRNT_PUCHAS_HOUSE
                                                           WHERE 1=1
                                                             AND RENT_HOUSE_CODE = X.RENT_HOUSE_CODE)),'미수금 이월') AS RENT_HOUSE_NM
              , X.BUDGET_YEAR         AS BUDGET_YEAR
              , X.BSNS_SE             AS BSNS_SE
              , X.BUDGET_ACNT_CODE     AS BUDGET_ACNT_CODE
              ,( SELECT C.BUDGET_ACNT_NM
                   FROM VHBDG_BUDGET_ACNT_CODE C
                  WHERE 1=1
                    AND C.BSNS_SE = X.BSNS_SE
                    AND C.BUDGET_ACNT_CODE = X.BUDGET_ACNT_CODE
                    AND C.YEAR = X.BUDGET_YEAR ) || '(' || X.BUDGET_ACNT_CODE || ')' AS ACC_NAME
              , SUM(X.MON_CNT)         AS MON_CNT
              , SUM(X.MON_GUM)         AS MON_GUM
              , SUM(X.TOT_MON_CNT)     AS TOT_MON_CNT
              , SUM(X.TOT_MON_GUM)     AS TOT_MON_GUM
              , SUM(X.MON_CNT2)     AS MON_CNT2
              , SUM(X.MON_GUM2)     AS MON_GUM2
              , SUM(X.TOT_MON_CNT2) AS TOT_MON_CNT2
              , SUM(X.TOT_MON_GUM2) AS TOT_MON_GUM2
              , (SUM(X.TOT_MON_GUM) - SUM(X.TOT_MON_GUM2)) AS OPEN_AMT
             FROM
                  (SELECT Y.RENT_HOUSE_CODE
                         , Y.BUDGET_YEAR
                         , Y.BSNS_SE
                         , Y.BUDGET_ACNT_CODE
                         , SUM(Y.MON_CNT) AS MON_CNT
                         , SUM(Y.MON_GUM) AS MON_GUM
                         , 0 TOT_MON_CNT
                         , 0 TOT_MON_GUM
                         , SUM(Y.MON_CNT2) AS MON_CNT2
                         , SUM(Y.MON_GUM2) AS MON_GUM2
                         , 0 TOT_MON_CNT2
                         , 0 TOT_MON_GUM2
                    FROM
                        (SELECT A.RENT_HOUSE_CODE
                                , A.BUDGET_YEAR
                                , A.BSNS_SE
                                , A.BUDGET_ACNT_CODE
                                , SUM(DECODE(ANACT_SE,'1',A.OCCRRNC_CO,'4',A.OCCRRNC_CO,0)) MON_CNT
                                , SUM(DECODE(ANACT_SE,'1',A.ANACT_AMOUNT,'4',A.ANACT_AMOUNT,0)) MON_GUM
                                , 0 TOT_MON_CNT
                                , 0 TOT_MON_GUM
                                , SUM(DECODE(ANACT_SE,'2',A.OCCRRNC_CO,'3',A.OCCRRNC_CO,0)) MON_CNT2
                                , SUM(DECODE(ANACT_SE,'2',A.ANACT_AMOUNT,'3',A.ANACT_AMOUNT,0)) MON_GUM2
                                , 0 TOT_MON_CNT2
                                , 0 TOT_MON_GUM2
                           FROM TBRNT_PUCHAS_ANACT A
                          WHERE 1=1
                            AND SUBSTR(A.MDAT_DE,1,6) = #APPLC_MT#
                            AND NVL(A.RENT_HOUSE_CODE,'000') LIKE #HOUSE_CODE# || '%'
                            AND NVL(A.RENT_HOUSE_CODE,'600') IN
                                                              (SELECT RENT_HOUSE_CODE
                                                                 FROM TBRNT_PUCHAS_HOUSE
                                                                WHERE HOUSE_SE LIKE #HOUSE_SE#
                                                              )
                            AND A.BSNS_SE LIKE #BSNS_SE# || '%'
                            AND A.BUDGET_ACNT_CODE LIKE #BUDGET_ACNT_CODE# || '%'
                            AND A.EXPNDTR_UNIT_CODE LIKE #EXPNDTR_UNIT_CODE# || '%'
                          GROUP BY A.RENT_HOUSE_CODE
                                  ,A.BUDGET_YEAR
                                  ,A.BSNS_SE
                                  ,A.BUDGET_ACNT_CODE
                         UNION ALL
                         SELECT A.HOUSE_CODE AS RENT_HOUSE_CODE,
                                A.BUDGET_YEAR,
                                SUBSTR(A.BUDGET_ACNT_SE,1,1) AS BSNS_SE,
                                A.BUDGET_ACNTCTGR AS BUDGET_ACNT_CODE,
                                0 MON_CNT,
                                SUM(A.AMOUNT) MON_GUM,
                                0 TOT_MON_CNT,
                                0 TOT_MON_GUM,
                                0 MON_CNT2,
                                0 MON_GUM2,
                                0 TOT_MON_CNT2,
                                0 TOT_MON_GUM2
                           FROM TBRNT_PSTYR_ATMPT_AMOUNT A
                          WHERE 1=1
                            AND A.JOB_SE_CODE = 'RN2'
                            AND SUBSTR(A.MDAT_DE,1,6) = #APPLC_MT#
                            AND NVL(A.HOUSE_CODE,'000') LIKE #HOUSE_CODE# || '%'
                            AND NVL(A.HOUSE_CODE,'600') IN
                                                          (SELECT RENT_HOUSE_CODE
                                                             FROM TBRNT_PUCHAS_HOUSE
                                                            WHERE HOUSE_SE LIKE #HOUSE_SE#
                                                          )
                            AND SUBSTR(A.BUDGET_ACNT_SE,1,1) LIKE #BSNS_SE# || '%'
                            AND A.BUDGET_ACNTCTGR LIKE #BUDGET_ACNT_CODE# || '%'
                            AND A.BUKIP_CODE LIKE #EXPNDTR_UNIT_CODE# || '%'
                            AND NVL(A.PAY_SE,'1') = '1'
                          GROUP BY A.HOUSE_CODE
                                  ,A.BUDGET_YEAR
                                  ,SUBSTR(A.BUDGET_ACNT_SE,1,1)
                                 ,A.BUDGET_ACNTCTGR
                         ) Y
                   GROUP BY Y.RENT_HOUSE_CODE
                           ,Y.BUDGET_YEAR
                           ,Y.BSNS_SE
                           ,Y.BUDGET_ACNT_CODE
                  UNION ALL
                  SELECT Z.RENT_HOUSE_CODE
                         , Z.BUDGET_YEAR
                         , Z.BSNS_SE
                         , Z.BUDGET_ACNT_CODE
                         , 0 MON_CNT
                         , 0 MON_GUM
                         , SUM(Z.TOT_MON_CNT) AS TOT_MON_CNT
                         , SUM(Z.TOT_MON_GUM) AS TOT_MON_GUM
                         , 0 MON_CNT2
                         , 0 MON_GUM2
                         , SUM(Z.TOT_MON_CNT2) AS TOT_MON_CNT2
                         , SUM(Z.TOT_MON_GUM2) AS TOT_MON_GUM2
                    FROM
                         (SELECT A.RENT_HOUSE_CODE
                                , A.BUDGET_YEAR
                                , A.BSNS_SE
                                , A.BUDGET_ACNT_CODE
                                , 0 MON_CNT
                                , 0 MON_GUM
                                , NVL(SUM(DECODE(ANACT_SE,'1',A.OCCRRNC_CO,'4',A.OCCRRNC_CO,0)),0) TOT_MON_CNT
                                , NVL(SUM(DECODE(ANACT_SE,'1',A.ANACT_AMOUNT,'4',A.ANACT_AMOUNT,0)),0) TOT_MON_GUM
                                , 0 MON_CNT2
                                , 0 MON_GUM2
                                , NVL(SUM(DECODE(ANACT_SE,'2',A.OCCRRNC_CO,'3',A.OCCRRNC_CO,0)),0) TOT_MON_CNT2
                                , NVL(SUM(DECODE(ANACT_SE,'2',A.ANACT_AMOUNT,'3',A.ANACT_AMOUNT,0)),0) TOT_MON_GUM2
                            FROM TBRNT_PUCHAS_ANACT A
                           WHERE 1=1
                             AND SUBSTR(A.MDAT_DE,1,6) BETWEEN SUBSTR(#APPLC_MT#,1,4) || '01' AND #APPLC_MT#
                             AND NVL(A.RENT_HOUSE_CODE,'000') LIKE #HOUSE_CODE# || '%'
                             AND NVL(A.RENT_HOUSE_CODE,'600') IN
                                                                (SELECT RENT_HOUSE_CODE
                                                                   FROM TBRNT_PUCHAS_HOUSE
                                                                  WHERE HOUSE_SE LIKE #HOUSE_SE#
                                                                )
                             AND A.BSNS_SE LIKE #BSNS_SE# || '%'
                             AND A.BUDGET_ACNT_CODE LIKE #BUDGET_ACNT_CODE# || '%'
                             AND A.EXPNDTR_UNIT_CODE LIKE '' || '%'
                          GROUP BY A.RENT_HOUSE_CODE
                                  ,A.BUDGET_YEAR
                                  ,A.BSNS_SE
                                  ,A.BUDGET_ACNT_CODE
                         UNION ALL
                         SELECT A.HOUSE_CODE AS RENT_HOUSE_CODE
                               , A.BUDGET_YEAR
                               , SUBSTR(A.BUDGET_ACNT_SE,1,1) AS BSNS_SE
                               , A.BUDGET_ACNTCTGR AS BUDGET_ACNT_CODE
                               , 0 MON_CNT
                               , 0 MON_GUM
                               , 0 TOT_MON_CNT
                               , SUM(A.AMOUNT) TOT_MON_GUM
                               , 0 MON_CNT2
                               , 0 MON_GUM2
                               , 0 TOT_MON_CNT2
                               , 0 TOT_MON_GUM2
                           FROM TBRNT_PSTYR_ATMPT_AMOUNT A
                          WHERE 1=1
                            AND A.JOB_SE_CODE = 'RN2'
                            AND SUBSTR(A.MDAT_DE,1,4) = SUBSTR(#APPLC_MT#,1,4)
                            AND NVL(A.HOUSE_CODE,'000') LIKE #HOUSE_CODE# || '%'
                            AND NVL(A.HOUSE_CODE,'600') IN
                                                          (SELECT RENT_HOUSE_CODE
                                                             FROM TBRNT_PUCHAS_HOUSE
                                                            WHERE HOUSE_SE LIKE #HOUSE_SE#
                                                          )
                            AND SUBSTR(A.BUDGET_ACNT_SE,1,1) LIKE #BSNS_SE# || '%'
                            AND A.BUDGET_ACNTCTGR LIKE #BUDGET_ACNT_CODE# || '%'
                            AND A.BUKIP_CODE LIKE #EXPNDTR_UNIT_CODE# || '%'
                            AND NVL(A.PAY_SE,'1') = '1'
                          GROUP BY A.HOUSE_CODE
                                  ,A.BUDGET_YEAR
                                  ,SUBSTR(A.BUDGET_ACNT_SE,1,1)
                                  ,A.BUDGET_ACNTCTGR
                         ) Z
                   GROUP BY Z.RENT_HOUSE_CODE
                           ,Z.BUDGET_YEAR
                           ,Z.BSNS_SE
                           ,Z.BUDGET_ACNT_CODE
                  ) X
            GROUP BY X.BUDGET_YEAR
                    ,X.BSNS_SE
                    ,X.BUDGET_ACNT_CODE
                    ,X.RENT_HOUSE_CODE
         ORDER BY X.BUDGET_ACNT_CODE, X.RENT_HOUSE_CODE
	</select>		
</sqlMap>