<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="RNT030301">

	<!-- 쿼리명 : 계약자 조회
	설명 : 계약자 조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29 
	-->
	<select id="RNT030301DAO.getList" parameterClass="java.util.Map" resultClass="java.util.HashMap">
SELECT
      TLC.CNTRCTR_NO
    , TLC.CNTRCT_CO
    , TLC.RE_CNTRCT_CO
    , TLC.AREA_SE
    , TLC.DONG
    , TLC.HO
    , TLC.LFSTS_CSTMR_NO
    , TLC.FRST_CNTRCT_DE
    , TLC.CNTRCT_CO
    , TLC.QUALF_SE
    , TLC.FAMILY_CO
    , TLC.ZIP_DM
    , TLC.ADRES_DM
    , TLC.ADRES_DETAIL_DM
    , TLC.HOUSE_POSESN_AT
    , TLC.LAD_POSESN_AT
    , TLC.BILD_POSESN_AT
    , TLC.CAR_POSESN_AT
    , TLC.BEFORE_ADRES
    , TLC.SCRT_INFO_EXAMIN_ID
    , TLC.RM
    , TLHC.ELCTRN_SANCTN_NO
    , TLHC.DECSN_YEAR
    , TLHC.EXPNDTR_DECSN_NO
    , TLHC.DECSN_YEAR2
    , TLHC.EXPNDTR_DECSN_NO2    
    , TLHC.RNTCHRG + TLHC.RSVMNEY AS SUM
    , TLC.REGISTER_ID
    , TLC.REGIST_DT
    , TLC.UPDUSR_ID
    , TLC.UPDT_DT
    , TLHC.DCSN_DE
    , TLHC.CNTRCT_DE
    , TLHC.TRNSFRN_DE
    , TLHC.CDIT_PRESV_MTHD
    , TLHC.CNTRCTR_CO
    , TLHC.HOUSE_KND
    , SFCOM_CODE_NM('RNT023' , TLHC.HOUSE_KND , 'CODE_NM') AS HOUSE_KND_NM
    , TLHC.ZIP AS ZIP_HOUSE
    , TLHC.ADRES AS ADRES_HOUSE
    , TLHC.ADRES_DETAIL AS ADRES_DETAIL_HOUSE
    , TLHC.HEAT_SE
    , TLHC.FLOOR_SE
    , TLHC.AR
    , TLHC.ALL_ROOM_CO
    , TLHC.RENT_ROOM_CO
    , TLHC.SPORT_BGNDE
    , TLHC.SPORT_ENDDE
    , TLHC.LFSTS_AMOUNT
    , TLHC.SPORT_AMOUNT
    , TLHC.RENT_ALOTM
    , TLHC.ADIT_ALOTM
    , TLHC.RNTCHRG
    , TLHC.RSVMNEY
    , TLHC.BILDNG_STRCT
    , TLRC.NM
    , SFCOM_DEC_ALL(TLRC.IHIDNUM) AS IHIDNUM 
    , TLRC.ZIP
    , TLRC.ADRES
    , TLRC.ADRES_DETAIL
    , TLRC.TELNO
    , TLRC.MBTLNO
    , TLRT.RESCI_TRMNAT_DE    
    , TLC.FILE_SN
    , TLHC.PC_DECSN_MTH
    , TLHC.HOUSE_POTVALE
    , TLHC.RCOGN_RATE
    , TLHC.HOUSE_PC
    , TLHC.DEBT_RATE
    , TLHC.HOUSE_STDPC
    , TLHC.FDLTR_ESTBS_AMOUNT
    , TLHC.RLDB_ESTBS_AMOUNT
    , TLHC.LEGACY_RENT_AMOUNT
    , TLHC.LFSTS_CONFM_AMOUNT
    , TLHC.EVL_DE    
    , TLHC.LEGACY_RENT_CNT
    , TLHC.VACANT_ROOM_CO
	, TLHC.FDLTR_ESTBS_CNT    
    , Z.NM AS NM_PSN
    , (SELECT (CASE WHEN COUNT(*) >= '1' THEN '1' ELSE '0' END)
         FROM TBRNT_LFSTS_SEIZR TLS 
     	WHERE TLC.CNTRCTR_NO = TLS.APPLCNT_CNTRCTR_NO
     	  AND TLS.RELIS_DE IS NULL) AS LOAN_POSESN_AT    
 FROM TBRNT_LFSTS_CNTRCT TLC  
 JOIN TBRNT_LFSTS_CSTMR TLRC ON TLC.LFSTS_CSTMR_NO = TLRC.LFSTS_CSTMR_NO
 JOIN TBRNT_LFSTS_HOUSE_CNTRCTR TLHC ON TLC.CNTRCTR_NO = TLHC.CNTRCTR_NO AND TLC.CNTRCT_CO = TLHC.CNTRCTR_CO
 <isEqual property="CNTRCT_GB" compareValue="%" >
 LEFT JOIN TBRNT_LFSTS_RESCI_TRMNAT TLRT ON TLC.CNTRCTR_NO = TLRT.CNTRCTR_NO AND TLC.CNTRCT_CO = TLRT.CNTRCTR_CO
 </isEqual>
 <isEqual property="CNTRCT_GB" compareValue="1" >
 LEFT JOIN TBRNT_LFSTS_RESCI_TRMNAT TLRT ON TLC.CNTRCTR_NO = TLRT.CNTRCTR_NO AND TLC.CNTRCT_CO = TLRT.CNTRCTR_CO
 </isEqual> 
 <isEqual property="CNTRCT_GB" compareValue="2">
 JOIN TBRNT_LFSTS_RESCI_TRMNAT TLRT ON TLC.CNTRCTR_NO = TLRT.CNTRCTR_NO AND TLC.CNTRCT_CO = TLRT.CNTRCTR_CO
 </isEqual>    
 LEFT JOIN TBRNT_LFSTS_RENT_PSN TLRP ON TLC.CNTRCTR_NO = TLRP.CNTRCTR_NO AND TLC.CNTRCT_CO = TLRP.CNTRCTR_CO 
 LEFT JOIN TBRNT_LFSTS_CSTMR Z ON TLRP.LFSTS_CSTMR_NO = Z.LFSTS_CSTMR_NO
WHERE 1=1    
    AND TLRP.RNTAGNT_NO =
                       (SELECT   NVL (MAX (RNTAGNT_NO), 1)
                          FROM   TBRNT_LFSTS_RENT_PSN
                         WHERE   CNTRCTR_NO = TLC.CNTRCTR_NO
                                 AND CNTRCTR_CO = TLC.CNTRCT_CO) 
<isNotEmpty property="IHIDNUM">
   AND (TLRC.IHIDNUM = #IHIDNUM#
    OR EXISTS (SELECT B.*
                 FROM TBRNT_LFSTS_FAMILY_MATTER A, TBRNT_LFSTS_CSTMR B
                WHERE A.APPLCNT_CNTRCTR_SE = '002'
                  AND A.APPLCNT_CNTRCTR_NO = TLC.CNTRCTR_NO
                  AND A.LFSTS_CSTMR_NO = B.LFSTS_CSTMR_NO
                  AND  SFCOM_DEC_ALL(B.IHIDNUM) = #IHIDNUM#)
       )          
</isNotEmpty>                                      
 <isNotEmpty property="AREA_SE">
	 AND TLC.AREA_SE = #AREA_SE#
 </isNotEmpty>
 <isNotEmpty property="NM">
 	AND TLRC.NM LIKE #NM#||'%'
 </isNotEmpty>
 <isNotEmpty property="OWNER">
 	AND Z.NM LIKE #OWNER#||'%'
 </isNotEmpty>
  <isNotEmpty property="DONG">
 	AND TLC.DONG LIKE  '%' || #DONG# || '%'
 </isNotEmpty>	
  <isNotEmpty property="HO">
 	AND TLC.HO LIKE '%' || #HO# || '%'
 </isNotEmpty>	
 <isNotEmpty property="ADRES">
 	AND TLRC.ADRES LIKE '%'||#ADRES#||'%'
 </isNotEmpty>	
 <isNotEmpty property="CSTMR_NO">
 	AND TLC.LFSTS_CSTMR_NO = #CSTMR_NO#
 </isNotEmpty> 
 <isEqual property="CNTRCT_GB" compareValue="1">
 	AND NOT EXISTS (SELECT 1 
 	                  FROM TBRNT_LFSTS_RESCI_TRMNAT A 
 	                 WHERE A.CNTRCTR_NO = TLC.CNTRCTR_NO 
 	                   AND A.CNTRCTR_CO = TLC.CNTRCT_CO)
  </isEqual>	
	ORDER BY TLC.AREA_SE , TLC.CNTRCTR_NO , TLHC.CNTRCTR_CO  
</select>

<!-- 	
	</update>
	 쿼리명 : 계약자 수정
	설명 : 계약자 수정 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29 
	-->	
	
<update id="RNT030301DAO.listU" parameterClass="java.util.Map">
BEGIN
	UPDATE TBRNT_LFSTS_CSTMR
	SET
		  NM                   = #NM#
		, IHIDNUM               = SFCOM_ENC_ALL(REPLACE(#IHIDNUM#, '-', ''))
		, ZIP                  = #ZIP#
		, ADRES                = #ADRES#
		, ADRES_DETAIL         = #ADRES_DETAIL#
		, TELNO                = #TELNO#
		, MBTLNO               = #MBTLNO#
		, UPDUSR_ID            = #S_USER_ID#
		, UPDT_DT              = SYSDATE
	WHERE LFSTS_CSTMR_NO = #LFSTS_CSTMR_NO#	
		;	
	UPDATE TBRNT_LFSTS_CNTRCT
	   SET
			  QUALF_SE	= #QUALF_SE# 
			, FAMILY_CO	= #FAMILY_CO# 
			, ZIP_DM	= #ZIP_DM# 
			, ADRES_DM	= #ADRES_DM# 
			, ADRES_DETAIL_DM	= #ADRES_DETAIL_DM# 
			, HOUSE_POSESN_AT	= #HOUSE_POSESN_AT# 
			, LAD_POSESN_AT	= #LAD_POSESN_AT# 
			, BILD_POSESN_AT	= #BILD_POSESN_AT# 
			, CAR_POSESN_AT	= #CAR_POSESN_AT# 
			, BEFORE_ADRES	= #BEFORE_ADRES# 
			, SCRT_INFO_EXAMIN_ID	= #SCRT_INFO_EXAMIN_ID# 
			, RM	= #RM# 
			, UPDUSR_ID	= #UPDUSR_ID# 
			, UPDT_DT	= SYSDATE 
			, AREA_SE	= #AREA_SE# 
			, DONG	= #DONG# 
			, HO	= #HO#  
	WHERE CNTRCTR_NO = #CNTRCTR_NO#
	  AND CNTRCT_CO  = #CNTRCT_CO#
	;
	UPDATE TBRNT_LFSTS_HOUSE_CNTRCTR
		SET
			  HOUSE_KND	=	#HOUSE_KND#
			, ZIP	=	#ZIP_HOUSE#
			, ADRES	=	#ADRES_HOUSE#
			, ADRES_DETAIL	=	#ADRES_DETAIL_HOUSE#
			, HEAT_SE	=	#HEAT_SE#
			, FLOOR_SE	=	#FLOOR_SE#
			, AR	=	#AR#
			, ALL_ROOM_CO	=	#ALL_ROOM_CO#
			, RENT_ROOM_CO	=	#RENT_ROOM_CO#
			, SPORT_BGNDE	=	#SPORT_BGNDE#
			, SPORT_ENDDE	=	#SPORT_ENDDE#
			, DCSN_DE		=	#DCSN_DE#
			, CNTRCT_DE		=	#CNTRCT_DE#
			, TRNSFRN_DE	=	#TRNSFRN_DE#						
			, LFSTS_AMOUNT	=	#LFSTS_AMOUNT#
			, SPORT_AMOUNT	=	#SPORT_AMOUNT#
			, RENT_ALOTM	=	#RENT_ALOTM#
			, ADIT_ALOTM	=	#ADIT_ALOTM#
			, RNTCHRG	=	#RNTCHRG#
			, RSVMNEY	=	#RSVMNEY#
			, BILDNG_STRCT = #BILDNG_STRCT#
		    , LEGACY_RENT_CNT = #LEGACY_RENT_CNT# 
		    , VACANT_ROOM_CO  = #VACANT_ROOM_CO#
			, FDLTR_ESTBS_CNT =	#FDLTR_ESTBS_CNT#		
			, LEGACY_RENT_AMOUNT = #LEGACY_RENT_AMOUNT#
			, FDLTR_ESTBS_AMOUNT = #FDLTR_ESTBS_AMOUNT#
			, UPDUSR_ID	=	#S_USER_ID#
			, UPDT_DT	=	SYSDATE
			, CDIT_PRESV_MTHD	= #CDIT_PRESV_MTHD# 
	WHERE CNTRCTR_NO = #CNTRCTR_NO#	
	 AND  CNTRCTR_CO = #CNTRCT_CO#
	;			
END;		
	</update>
	
	<!-- 	
	쿼리명 : 계약자 신규
	설명 : 계약자 신규 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29 
	-->
	<insert id="RNT030301DAO.listC" parameterClass="java.util.Map">
BEGIN
	INSERT INTO TBRNT_LFSTS_CNTRCT(
		  CNTRCTR_NO
		, AREA_SE
		, DONG
		, HO
		, LFSTS_CSTMR_NO
		, FRST_CNTRCT_DE
		, CNTRCT_CO
		, QUALF_SE
		, FAMILY_CO
		, ZIP_DM
		, ADRES_DM
		, ADRES_DETAIL_DM
		, HOUSE_POSESN_AT
		, LAD_POSESN_AT
		, BILD_POSESN_AT
		, CAR_POSESN_AT
		, BEFORE_ADRES
		, SCRT_INFO_EXAMIN_ID
		, RM
		, REGISTER_ID
		, REGIST_DT
		, UPDUSR_ID
		, UPDT_DT
	)VALUES(
	      #CNTRCTR_NO#
		, #AREA_SE#
		, #DONG#
		, #HO#
		, #LFSTS_CSTMR_NO#
		, #FRST_CNTRCT_DE#
		, #CNTRCT_CO#
		, #QUALF_SE#
		, #FAMILY_CO#
		, #ZIP_DM#
		, #ADRES_DM#
		, #ADRES_DETAIL_DM#
		, #HOUSE_POSESN_AT#
		, #LAD_POSESN_AT#
		, #BILD_POSESN_AT#
		, #CAR_POSESN_AT#
		, #BEFORE_ADRES#
		, #SCRT_INFO_EXAMIN_ID#
		, #RM#
		, #S_USER_ID#
		, SYSDATE
		, #S_USER_ID#
		, SYSDATE
		)
	;
	INSERT INTO TBRNT_LFSTS_HOUSE_CNTRCTR(	
		  DCSN_DE
		, CNTRCT_DE
		, TRNSFRN_DE
		, CDIT_PRESV_MTHD
		, CNTRCTR_NO
		, CNTRCTR_CO
		, HOUSE_KND
		, ZIP
		, ADRES
		, ADRES_DETAIL
		, HEAT_SE
		, FLOOR_SE
		, AR
		, ALL_ROOM_CO
		, RENT_ROOM_CO
		, SPORT_BGNDE
		, SPORT_ENDDE
		, LFSTS_AMOUNT
		, SPORT_AMOUNT
		, RENT_ALOTM
		, ADIT_ALOTM
		, RNTCHRG
		, RSVMNEY
		, BILDNG_STRCT
		, REGISTER_ID
		, REGIST_DT
		, UPDUSR_ID
		, UPDT_DT
	    , PC_DECSN_MTH
	    , HOUSE_POTVALE
	    , HOUSE_PC
	    , HOUSE_STDPC
	    , FDLTR_ESTBS_AMOUNT
	    , RLDB_ESTBS_AMOUNT
	    , LEGACY_RENT_AMOUNT
	    , LFSTS_CONFM_AMOUNT
	    , RCOGN_RATE
	    , DEBT_RATE		
		, EVL_DE
		, LEGACY_RENT_CNT
		, VACANT_ROOM_CO
		, FDLTR_ESTBS_CNT		
	)VALUES(
		  #DCSN_DE#
		, #CNTRCT_DE#
		, #TRNSFRN_DE#
		, #CDIT_PRESV_MTHD#
		, #CNTRCTR_NO#
		, #CNTRCT_CO#
		, #HOUSE_KND#
		, #ZIP_HOUSE#
		, #ADRES_HOUSE#
		, #ADRES_DETAIL_HOUSE#
		, #HEAT_SE#
		, #FLOOR_SE#
		, #AR#
		, #ALL_ROOM_CO#
		, #RENT_ROOM_CO#
		, #SPORT_BGNDE#
		, #SPORT_ENDDE#
		, #LFSTS_AMOUNT#
		, #SPORT_AMOUNT#
		, #RENT_ALOTM#
		, #ADIT_ALOTM#
		, #RNTCHRG#
		, #RSVMNEY#
		, #BILDNG_STRCT#
		, #S_USER_ID#
		, SYSDATE
		, #S_USER_ID#
		, SYSDATE	
	    , #PC_DECSN_MTH#
	    , #HOUSE_POTVALE#
	    , #HOUSE_PC#
	    , #HOUSE_STDPC#
	    , #FDLTR_ESTBS_AMOUNT#
	    , #RLDB_ESTBS_AMOUNT#
	    , #LEGACY_RENT_AMOUNT#
	    , #LFSTS_CONFM_AMOUNT#
	    , #RCOGN_RATE#
	    , #DEBT_RATE#	
		, #RCEPT_DE#
		, #LEGACY_RENT_CNT#
		, #VACANT_ROOM_CO#
		, #FDLTR_ESTBS_CNT#		
		)
		;
		UPDATE TBRNT_LFSTS_APPLCNT
		   SET CNTRCT_STTUS = '2'
		     , CNTRCTR_NO = #CNTRCTR_NO#
		     , UPDUSR_ID = #S_USER_ID#
		     , UPDT_DT = SYSDATE
		 WHERE APPLCNT_NO = #APPLCNT_NO#
		;	 	
		UPDATE TBRNT_LFSTS_RIGHT_ANALS
		   SET CNTRCT_AT = '1'
		     , APPLCNT_CNTRCTR_SE = '002' 
		     , APPLCNT_CNTRCTR_NO = #CNTRCTR_NO#
		 WHERE APPLCNT_CNTRCTR_NO = #APPLCNT_NO#
		   AND APPLCNT_CNTRCTR_SE = '001'
		   ;		
	END;		
	</insert>
	<!-- 쿼리명 : 계약자 삭제
	설명 : 계약자 삭제 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29 
	-->	
	<delete id="RNT030301DAO.listD" parameterClass="java.util.Map">
	 BEGIN
	 	<!-- 
       	 DELETE TBRNT_LFSTS_CSTMR
		  WHERE LFSTS_CSTMR_NO IN (SELECT LFSTS_CSTMR_NO 
							      FROM TBRNT_LFSTS_FAMILY_MATTER 
							     WHERE APPLCNT_CNTRCTR_NO = #CNTRCTR_NO#
							       AND APPLCNT_CNTRCTR_SE = '002')
	  	 ;
       	 DELETE TBRNT_LFSTS_CSTMR
		  WHERE LFSTS_CSTMR_NO IN (SELECT LFSTS_CSTMR_NO 
							      FROM TBRNT_LFSTS_COCNR 
							     WHERE CNTRCTR_NO = #CNTRCTR_NO# )
	  	 ;	
       	 DELETE TBRNT_LFSTS_CSTMR
		  WHERE LFSTS_CSTMR_NO IN (SELECT LFSTS_CSTMR_NO_AFTCH 
							      FROM TBRNT_LFSTS_RENT_PSN_CHANGE 
							     WHERE CNTRCTR_NO = #CNTRCTR_NO# )
	  	 ;
	  	  -->		  	   
         DELETE TBRNT_LFSTS_COCNR
		  WHERE CNTRCTR_NO	=	#CNTRCTR_NO#
	     ;
		 DELETE TBRNT_LFSTS_RENT_PSN_CHANGE
		   WHERE CNTRCTR_NO = #CNTRCTR_NO#
	      ;	     	  	  	 
		 DELETE TBRNT_LFSTS_RENT_PSN
		   WHERE CNTRCTR_NO = #CNTRCTR_NO#
	      ;
		 DELETE TBRNT_LFSTS_INSRNC
		  WHERE CNTRCTR_NO = #CNTRCTR_NO#
	      ;
		  DELETE TBRNT_LFSTS_MDIATN_JCFFR
			WHERE CNTRCTR_NO = #CNTRCTR_NO#
		  ;
		  DELETE TBRNT_LFSTS_FAMILY_MATTER
		     WHERE APPLCNT_CNTRCTR_NO = #CNTRCTR_NO#
		       AND APPLCNT_CNTRCTR_SE = '002'
       	  ;
       	  DELETE TBRNT_LFSTS_HOUSE_CNTRCTR
		     WHERE CNTRCTR_NO = #CNTRCTR_NO#
		  ;    	
		  DELETE TBRNT_LFSTS_NM_CHANGE
		   WHERE CNTRCTR_NO = #CNTRCTR_NO#
		  ;	  
 		  UPDATE TBRNT_LFSTS_APPLCNT
			 SET CNTRCT_STTUS = '1'
			   , CNTRCTR_NO = ''
			   , UPDUSR_ID = #S_USER_ID#
			   , UPDT_DT = SYSDATE
		   WHERE CNTRCTR_NO = #CNTRCTR_NO#
		   ;		  
		  DELETE TBRNT_LFSTS_CNTRCT
		  WHERE CNTRCTR_NO = #CNTRCTR_NO#
  		  ;	 
   	 END;	  
	</delete>

	<!-- 쿼리명 : 임대인 조회
	설명 : 임대인 조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.15 
	-->
	<select id="RNT030301DAO.getListR1" parameterClass="java.util.Map" resultClass="java.util.HashMap">
       SELECT
          ROW_NUMBER () OVER (ORDER BY TRPC.SN DESC) AS ROW_NUM
        , TRPC.SN  
        , TRP.CNTRCTR_NO
        , TRP.CNTRCTR_CO
        , TRP.RNTAGNT_NO
        , TRP.ACQS_DE
        , TRP.BANK_CODE
        , TRP.ACNUTNO
        , TRP.DPSTR
        , TRP.REGISTER_ID
        , TRP.REGIST_DT
        , TRP.UPDUSR_ID
        , TRP.UPDT_DT
        , TRPC.CHANGE_DE
        , TRPC.CHGHY
        , TRPC.RM
        , TRPC.SN
        , TRPC.LFSTS_CSTMR_NO_BFCHG
        , TRPC.LFSTS_CSTMR_NO_AFTCH        
        , TLRC.NM
        , SFCOM_DEC_ALL(TLRC.IHIDNUM) AS IHIDNUM  
        , TLRC.TELNO
        , TLRC.MBTLNO
        , TLRC.ZIP
        , TLRC.ADRES
        , TLRC.ADRES_DETAIL
        , TRP.LFSTS_CSTMR_NO
        , TRP.INADQC_ENTRPS_AT
        , TRP.CONFM
      FROM TBRNT_LFSTS_RENT_PSN TRP
         , TBRNT_LFSTS_RENT_PSN_CHANGE TRPC
         , TBRNT_LFSTS_CSTMR TLRC
     WHERE TRP.CNTRCTR_NO = TRPC.CNTRCTR_NO(+)
       AND TRP.CNTRCTR_CO = TRPC.CNTRCTR_CO(+)    
       AND TRP.RNTAGNT_NO = TRPC.RNTAGNT_NO(+)
       AND TRP.LFSTS_CSTMR_NO = TLRC.LFSTS_CSTMR_NO
       AND TRP.CNTRCTR_NO = #CNTRCTR_NO#
       AND TRP.CNTRCTR_CO = #CNTRCTR_CO#
       AND (TRPC.SN  <![CDATA[  <> ]]> '1' OR TRPC.SN IS NULL)
       ORDER BY ROW_NUM
	</select>
	<!-- 쿼리명 : 임대인 수정
	설명 : 임대인 수정 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29 
	-->
	<update id="RNT030301DAO.listUR1" parameterClass="java.util.Map">
	BEGIN

	 UPDATE TBRNT_LFSTS_CSTMR
		SET
			  NM                   = #NM#
			, IHIDNUM               = SFCOM_ENC_ALL(REPLACE(#IHIDNUM#, '-', ''))
			, ZIP                  = #ZIP#
			, ADRES                = #ADRES#
			, ADRES_DETAIL         = #ADRES_DETAIL#
			, TELNO                = #TELNO#
			, MBTLNO               = #MBTLNO#
			, UPDUSR_ID            = #S_USER_ID#
			, UPDT_DT              = SYSDATE
		WHERE LFSTS_CSTMR_NO = #LFSTS_CSTMR_NO#	
		;		
		UPDATE TBRNT_LFSTS_RENT_PSN
		   SET		
			  ACQS_DE			=	#ACQS_DE#
			, BANK_CODE			=	#BANK_CODE#
			, ACNUTNO			=	#ACNUTNO#
			, DPSTR				=	#DPSTR#
			, UPDUSR_ID			=	#S_USER_ID#
			, UPDT_DT			=	SYSDATE
			, LFSTS_CSTMR_NO    =   #LFSTS_CSTMR_NO#
	        , INADQC_ENTRPS_AT  =   #INADQC_ENTRPS_AT# 
	        , CONFM			    =   #CONFM#
		WHERE CNTRCTR_NO = #CNTRCTR_NO#
		  AND CNTRCTR_CO = #CNTRCTR_CO#
		  AND RNTAGNT_NO = #RNTAGNT_NO#
		 ;	
		<isNotEmpty property="SN">
		UPDATE TBRNT_LFSTS_RENT_PSN_CHANGE
		   SET		
			  CHANGE_DE			=	#CHANGE_DE#
			, CHGHY				=	#CHGHY#
			, RM				=	#RM#
			, UPDUSR_ID			=	#S_USER_ID#
			, UPDT_DT			=	SYSDATE
			, LFSTS_CSTMR_NO_AFTCH = #LFSTS_CSTMR_NO#
		WHERE CNTRCTR_NO = #CNTRCTR_NO#
		  AND CNTRCTR_CO = #CNTRCTR_CO#
		  AND RNTAGNT_NO = #RNTAGNT_NO#
		  AND SN 		 = #SN#
		 ;		
		 </isNotEmpty> 	 
	END; 
	</update>
	<!-- 쿼리명 : 임대인 신규
	설명 : 임대인 신규 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29 
	-->
	<insert id="RNT030301DAO.listCR1" parameterClass="java.util.Map">
	BEGIN
 		INSERT INTO TBRNT_LFSTS_CSTMR(
			  LFSTS_CSTMR_NO
			, NM
			, IHIDNUM
			, ZIP
			, ADRES
			, ADRES_DETAIL
			, TELNO
			, MBTLNO
			, REGISTER_ID
			, REGIST_DT
			, UPDUSR_ID
			, UPDT_DT			
		 )VALUES(		    
		      (SELECT NVL(MAX(LFSTS_CSTMR_NO),0)+1 FROM TBRNT_LFSTS_CSTMR)
		    , #NM#
		    , SFCOM_ENC_ALL(REPLACE(#IHIDNUM#, '-', ''))
		    , #ZIP#
		    , #ADRES#
		    , #ADRES_DETAIL#
		    , #TELNO#
		    , #MBTLNO#
		    , #S_USER_ID#
		    , SYSDATE
		    , #S_USER_ID#
		    , SYSDATE
		 )
		 ;	
		INSERT INTO TBRNT_LFSTS_RENT_PSN
		(
			  CNTRCTR_NO
			, CNTRCTR_CO
			, RNTAGNT_NO
			, ACQS_DE
			, BANK_CODE
			, ACNUTNO
			, DPSTR
			, REGISTER_ID
			, REGIST_DT
			, UPDUSR_ID
			, UPDT_DT		
			, LFSTS_CSTMR_NO
            , INADQC_ENTRPS_AT
	        , CONFM
			)VALUES(
			  #CNTRCTR_NO#
			, #CNTRCTR_CO#
			, (SELECT NVL(MAX(RNTAGNT_NO)  , 0) + 1 
			     FROM TBRNT_LFSTS_RENT_PSN
			    WHERE CNTRCTR_NO = #CNTRCTR_NO#
			      AND CNTRCTR_CO = #CNTRCTR_CO#)
			, #ACQS_DE#
			, #BANK_CODE#
			, #ACNUTNO#
			, #DPSTR#
			, #S_USER_ID#
			, SYSDATE
			, #S_USER_ID#
			, SYSDATE		
			, (SELECT MAX(LFSTS_CSTMR_NO) FROM TBRNT_LFSTS_CSTMR)
            , #INADQC_ENTRPS_AT#
	        , #CONFM#			
		)
		;
	INSERT INTO TBRNT_LFSTS_RENT_PSN_CHANGE
		(
			  CNTRCTR_NO
			, CNTRCTR_CO
            , RNTAGNT_NO
			, SN
			, CHANGE_DE
			, CHGHY
			, RM
			, REGISTER_ID
			, REGIST_DT
			, UPDUSR_ID
			, UPDT_DT
			, LFSTS_CSTMR_NO_AFTCH
			, LFSTS_CSTMR_NO_BFCHG				
			)VALUES(
			  #CNTRCTR_NO#
			, #CNTRCTR_CO#
			, (SELECT NVL(MAX(RNTAGNT_NO) , 0) 
			     FROM TBRNT_LFSTS_RENT_PSN
			    WHERE CNTRCTR_NO = #CNTRCTR_NO#
			      AND CNTRCTR_CO = #CNTRCTR_CO#)
			, NVL((SELECT MAX(SN) +1 
			     FROM TBRNT_LFSTS_RENT_PSN_CHANGE 
			    WHERE CNTRCTR_NO = #CNTRCTR_NO#
			      AND CNTRCTR_CO = #CNTRCTR_CO#), 0)			      
			, #CHANGE_DE#
			, #CHGHY#
			, #RM#
			, #S_USER_ID#
			, SYSDATE
			, #S_USER_ID#
			, SYSDATE	
			, (SELECT MAX(LFSTS_CSTMR_NO) FROM TBRNT_LFSTS_CSTMR)
			, #LFSTS_CSTMR_NO#		
		)		
		; 
END;
	</insert>
	<!-- 쿼리명 : 임대인 삭제
	설명 : 임대인 삭제 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29 
	-->	
	<delete id="RNT030301DAO.listDR1" parameterClass="java.util.Map">
	BEGIN

		DELETE TBRNT_LFSTS_COCNR
		WHERE CNTRCTR_NO	=	#CNTRCTR_NO#
		  AND LFSTS_CSTMR_NO_RENT_PSN	=	#LFSTS_CSTMR_NO#
		;

		DELETE TBRNT_LFSTS_RENT_PSN_CHANGE 
 		 WHERE CNTRCTR_NO = #CNTRCTR_NO#
 		   AND LFSTS_CSTMR_NO_AFTCH	= #LFSTS_CSTMR_NO#
 		   AND CNTRCTR_CO = '0'
		;
		<!-- 		
		DELETE TBRNT_LFSTS_CSTMR
		 WHERE LFSTS_CSTMR_NO = (SELECT LFSTS_CSTMR_NO 
		                           FROM TBRNT_LFSTS_RENT_PSN_CHANGE
								  WHERE CNTRCTR_NO	=	#CNTRCTR_NO#
								    AND CNTRCTR_CO  =   #CNTRCTR_CO#
								    AND RNTAGNT_NO = #RNTAGNT_NO#)
	    ;
		 -->						     
				
		
		DELETE TBRNT_LFSTS_RENT_PSN
  	     WHERE CNTRCTR_NO	=	#CNTRCTR_NO#
		   AND CNTRCTR_CO   =   #CNTRCTR_CO#
		   AND RNTAGNT_NO   =   #RNTAGNT_NO#		
		;   
		
	END;	   
	</delete>


	<!-- 쿼리명 : 공유자 조회
	설명 : 공유자 조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29 
	-->
	<select id="RNT030301DAO.getListR2" parameterClass="java.util.Map" resultClass="java.util.HashMap">
     SELECT
          ROW_NUMBER() OVER(ORDER BY TC.CNTRCTR_NO) AS ROW_NUM 
        , TC.CNTRCTR_NO
        , TC.CNTRCTR_CO
        , TC.SN
        , TC.RELIS_DE
        , TC.RM
        , TC.LFSTS_CSTMR_NO
        , TC.LFSTS_CSTMR_NO_RENT_PSN
        , TC.REGISTER_ID
        , TC.REGIST_DT
        , TC.UPDUSR_ID
        , TC.UPDT_DT
        , TRP.ACQS_DE
        , TLRC.NM
        , SFCOM_DEC_ALL(TLRC.IHIDNUM) AS IHIDNUM  
        , TLRC.TELNO
        , TLRC.MBTLNO
        , TLRC.ZIP
        , TLRC.ADRES
        , TLRC.ADRES_DETAIL
        , TRP.NM_PH
        , SFCOM_DEC_ALL(TRP.IHIDNUM_PH) AS IHIDNUM_PH 
        , TRP.TELNO_PH
        , TRP.MBTLNO_PH
      FROM TBRNT_LFSTS_COCNR TC
         , TBRNT_LFSTS_CSTMR TLRC
         , (SELECT B.NM AS NM_PH
                 , B.IHIDNUM AS IHIDNUM_PH
                 , B.TELNO AS TELNO_PH
                 , B.MBTLNO AS MBTLNO_PH
                 , A.LFSTS_CSTMR_NO
                 , A.CNTRCTR_NO
                 , A.ACQS_DE
              FROM TBRNT_LFSTS_RENT_PSN A
                 , TBRNT_LFSTS_CSTMR B
             WHERE A.LFSTS_CSTMR_NO = B.LFSTS_CSTMR_NO
               AND A.CNTRCTR_NO = #CNTRCTR_NO#
               AND A.CNTRCTR_CO = #CNTRCTR_CO#) TRP     
     WHERE TC.LFSTS_CSTMR_NO = TLRC.LFSTS_CSTMR_NO
       AND TC.CNTRCTR_NO = TRP.CNTRCTR_NO
       AND TC.LFSTS_CSTMR_NO_RENT_PSN = TRP.LFSTS_CSTMR_NO 
       
       ORDER BY TC.CNTRCTR_NO
	</select>
	<!-- 쿼리명 : 공유자 수정
	설명 : 공유자 수정 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29 
	-->
	<update id="RNT030301DAO.listUR2" parameterClass="java.util.Map">
BEGIN
	UPDATE TBRNT_LFSTS_CSTMR
	SET
		  NM                   = #NM#
		, IHIDNUM               = SFCOM_ENC_ALL(REPLACE(#IHIDNUM#, '-', ''))
		, ZIP                  = #ZIP#
		, ADRES                = #ADRES#
		, ADRES_DETAIL         = #ADRES_DETAIL#
		, TELNO                = #TELNO#
		, MBTLNO               = #MBTLNO#
		, UPDUSR_ID            = #S_USER_ID#
		, UPDT_DT              = SYSDATE
	WHERE LFSTS_CSTMR_NO = #LFSTS_CSTMR_NO#	
		;	
	UPDATE TBRNT_LFSTS_COCNR
	   SET
		  RELIS_DE		=	#RELIS_DE#
		, RM			=	#RM#
		, UPDUSR_ID		=	#S_USER_ID#
		, UPDT_DT		=	#UPDT_DT#
	WHERE CNTRCTR_NO	=	#CNTRCTR_NO#
	  AND SN	=	#SN#	
	  ;
END;	  	
	</update>
	<!-- 쿼리명 : 공유자 신규
	설명 : 공유자 신규 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29 
	-->

	<insert id="RNT030301DAO.listCR2" parameterClass="java.util.Map">
BEGIN
 		INSERT INTO TBRNT_LFSTS_CSTMR(
			  LFSTS_CSTMR_NO
			, NM
			, IHIDNUM
			, ZIP
			, ADRES
			, ADRES_DETAIL
			, TELNO
			, MBTLNO
			, REGISTER_ID
			, REGIST_DT
			, UPDUSR_ID
			, UPDT_DT
		 )VALUES(		    
		      (SELECT NVL(MAX(LFSTS_CSTMR_NO),0)+1 FROM TBRNT_LFSTS_CSTMR)
		    , #NM#
		    , SFCOM_ENC_ALL(REPLACE(#IHIDNUM#, '-', ''))
		    , #ZIP#
		    , #ADRES#
		    , #ADRES_DETAIL#
		    , #TELNO#
		    , #MBTLNO#
		    , #S_USER_ID#
		    , SYSDATE
		    , #S_USER_ID#
		    , SYSDATE
		 )
		 ;
		INSERT INTO TBRNT_LFSTS_COCNR(
			  CNTRCTR_NO
			, CNTRCTR_CO  
			, SN
			, RELIS_DE
			, RM
			, REGISTER_ID
			, REGIST_DT
			, UPDUSR_ID
			, UPDT_DT		
			, LFSTS_CSTMR_NO
			, LFSTS_CSTMR_NO_RENT_PSN
			)VALUES(
			  #CNTRCTR_NO#
			, #CNTRCTR_CO#  
			, (SELECT NVL(MAX(SN),0)+1 FROM TBRNT_LFSTS_COCNR)
			, #RELIS_DE#
			, #RM#
			, #S_USER_ID#
			, SYSDATE
			, #S_USER_ID#
			, SYSDATE		
			, (SELECT MAX(LFSTS_CSTMR_NO) FROM TBRNT_LFSTS_CSTMR)	
			, (SELECT MAX(LFSTS_CSTMR_NO) 
			     FROM TBRNT_LFSTS_RENT_PSN 
			    WHERE CNTRCTR_NO = #CNTRCTR_NO#
			      AND CNTRCTR_CO = #CNTRCTR_CO#)
		)
		;
END;		
	</insert>
	<!-- 쿼리명 : 공유자 삭제
	설명 : 공유자 삭제 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29 
	-->	
	<delete id="RNT030301DAO.listDR2" parameterClass="java.util.Map">
BEGIN
		DELETE TBRNT_LFSTS_CSTMR
		WHERE LFSTS_CSTMR_NO	=	#LFSTS_CSTMR_NO#
		;
		DELETE TBRNT_LFSTS_COCNR
		WHERE CNTRCTR_NO	=	#CNTRCTR_NO#
		  AND LFSTS_CSTMR_NO	=	#LFSTS_CSTMR_NO#
		  AND SN	=	#SN#
		;
END;		  
	</delete>

	<!-- 쿼리명 : 보증보험 조회
	설명 : 보증보험  조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29 
	-->
<select id="RNT030301DAO.getListR3" parameterClass="java.util.Map" resultClass="java.util.HashMap">
	   SELECT
	          ROW_NUMBER() OVER(ORDER BY CNTRCTR_NO) AS ROW_NUM 
			, INSRNC_SE
			, CNTRCTR_NO
			, CNTRCTR_CO
			, CNTRCT_BGNDE
			, CNTRCT_ENDDE
			, SCRITS_NO
			, ENDRS_NO
			, MANAGE_NO
			, PC_DECSN_MTH
			, PC_DECSN_DE
			, ESTATE_DECSN_PC
			, MRTGG_RATE
			, INSRNC_AMOUNT
			, EXCCLC_AMOUNT
			, RM
			, REGISTER_ID
			, REGIST_DT
			, UPDUSR_ID
			, UPDT_DT
	  FROM TBRNT_LFSTS_INSRNC
	 WHERE INSRNC_SE = '1'
	    AND CNTRCTR_NO = #CNTRCTR_NO#
	    AND CNTRCTR_CO = #CNTRCTR_CO#   
	    ORDER BY CNTRCTR_NO
	</select>
	<!-- 쿼리명 : 보증보험  수정
	설명 : 보증보험  수정 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29 
	-->
	<update id="RNT030301DAO.listUR3" parameterClass="java.util.Map">
		UPDATE TBRNT_LFSTS_INSRNC
		   SET
			 INSRNC_SE	=	#INSRNC_SE#
			,CNTRCT_BGNDE	=	#CNTRCT_BGNDE#
			,CNTRCT_ENDDE	=	#CNTRCT_ENDDE#
			,SCRITS_NO	=	#SCRITS_NO#
			,ENDRS_NO	=	#ENDRS_NO#
			,MANAGE_NO	=	#MANAGE_NO#
			,PC_DECSN_MTH	=	#PC_DECSN_MTH#
			,PC_DECSN_DE	=	#PC_DECSN_DE#
			,ESTATE_DECSN_PC	=	#ESTATE_DECSN_PC#
			,MRTGG_RATE	=	#MRTGG_RATE#
			,INSRNC_AMOUNT	=	#INSRNC_AMOUNT#
			,EXCCLC_AMOUNT	=	#EXCCLC_AMOUNT#
			,RM	=	#RM#
			,REGISTER_ID	=	#S_USER_ID#
			,REGIST_DT	=	SYSDATE
			,UPDUSR_ID	=	#S_USER_ID#
			,UPDT_DT	=	SYSDATE
		WHERE INSRNC_SE = '1'
		  AND CNTRCTR_NO = #CNTRCTR_NO#
		  AND CNTRCTR_CO = #CNTRCTR_CO#
	</update>
	<!-- 쿼리명 : 보증보험  신규
	설명 : 보증보험  신규 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29
	-->
	<insert id="RNT030301DAO.listCR3" parameterClass="java.util.Map">
		INSERT INTO TBRNT_LFSTS_INSRNC
		(
				  INSRNC_SE
				, CNTRCTR_NO
				, CNTRCTR_CO
				, CNTRCT_BGNDE
				, CNTRCT_ENDDE
				, SCRITS_NO
				, ENDRS_NO
				, MANAGE_NO
				, PC_DECSN_MTH
				, PC_DECSN_DE
				, ESTATE_DECSN_PC
				, MRTGG_RATE
				, INSRNC_AMOUNT
				, EXCCLC_AMOUNT
				, RM
				, REGISTER_ID
				, REGIST_DT
				, UPDUSR_ID
				, UPDT_DT			
				)
				VALUES
				(
				  '1'
				, #CNTRCTR_NO#
				, #CNTRCTR_CO#
				, #CNTRCT_BGNDE#
				, #CNTRCT_ENDDE#
				, #SCRITS_NO#
				, #ENDRS_NO#
				, #MANAGE_NO#
				, #PC_DECSN_MTH#
				, #PC_DECSN_DE#
				, #ESTATE_DECSN_PC#
				, #MRTGG_RATE#
				, #INSRNC_AMOUNT#
				, #EXCCLC_AMOUNT#
				, #RM#
				, #S_USER_ID#
				, SYSDATE
				, #S_USER_ID#
				, SYSDATE
		)
	</insert>
	<!-- 쿼리명 : 보증보험  삭제
	설명 : 보증보험  삭제 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29
	-->	
	<delete id="RNT030301DAO.listDR3" parameterClass="java.util.Map">
		DELETE TBRNT_LFSTS_INSRNC
		WHERE INSRNC_SE = '1'
		  AND CNTRCTR_NO = #CNTRCTR_NO#
		  AND CNTRCTR_CO = #CNTRCTR_CO# 
	</delete>


	<!-- 쿼리명 : 화재보험 조회
	설명 : 화재보험 조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29 
	-->
	<select id="RNT030301DAO.getListR4" parameterClass="java.util.Map" resultClass="java.util.HashMap">
	   SELECT
	          ROW_NUMBER() OVER(ORDER BY CNTRCTR_NO) AS ROW_NUM 
			, INSRNC_SE
			, CNTRCTR_NO
			, CNTRCTR_CO
			, CNTRCT_BGNDE
			, CNTRCT_ENDDE
			, SCRITS_NO
			, ENDRS_NO
			, MANAGE_NO
			, PC_DECSN_MTH
			, PC_DECSN_DE
			, ESTATE_DECSN_PC
			, MRTGG_RATE
			, INSRNC_AMOUNT
			, EXCCLC_AMOUNT
			, RM
			, REGISTER_ID
			, REGIST_DT
			, UPDUSR_ID
			, UPDT_DT
	  FROM TBRNT_LFSTS_INSRNC
	 WHERE INSRNC_SE = '2'
	   AND CNTRCTR_NO = #CNTRCTR_NO#
	   AND CNTRCTR_CO = #CNTRCTR_CO#
	   
	  ORDER BY CNTRCTR_NO  
	</select>
	<!-- 쿼리명 : 화재보험 수정
	설명 : 화재보험 수정 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29
	-->
	<update id="RNT030301DAO.listUR4" parameterClass="java.util.Map">
		UPDATE TBRNT_LFSTS_INSRNC
		   SET
			 INSRNC_SE	=	#INSRNC_SE#
			,CNTRCT_BGNDE	=	#CNTRCT_BGNDE#
			,CNTRCT_ENDDE	=	#CNTRCT_ENDDE#
			,SCRITS_NO	=	#SCRITS_NO#
			,ENDRS_NO	=	#ENDRS_NO#
			,MANAGE_NO	=	#MANAGE_NO#
			,PC_DECSN_MTH	=	#PC_DECSN_MTH#
			,PC_DECSN_DE	=	#PC_DECSN_DE#
			,ESTATE_DECSN_PC	=	#ESTATE_DECSN_PC#
			,MRTGG_RATE	=	#MRTGG_RATE#
			,INSRNC_AMOUNT	=	#INSRNC_AMOUNT#
			,EXCCLC_AMOUNT	=	#EXCCLC_AMOUNT#
			,RM	=	#RM#
			,REGISTER_ID	=	#S_USER_ID#
			,REGIST_DT	=	SYSDATE
			,UPDUSR_ID	=	#S_USER_ID#
			,UPDT_DT	=	SYSDATE
		WHERE INSRNC_SE = '2'
		  AND CNTRCTR_NO = #CNTRCTR_NO#
		  AND CNTRCTR_CO = #CNTRCTR_CO#
			
	</update>
	<!-- 쿼리명 : 화재보험 신규
	설명 : 화재보험 신규 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29
	-->
	<insert id="RNT030301DAO.listCR4" parameterClass="java.util.Map">
		INSERT INTO TBRNT_LFSTS_INSRNC
		(
				  INSRNC_SE
				, CNTRCTR_NO
				, CNTRCTR_CO
				, CNTRCT_BGNDE
				, CNTRCT_ENDDE
				, SCRITS_NO
				, ENDRS_NO
				, MANAGE_NO
				, PC_DECSN_MTH
				, PC_DECSN_DE
				, ESTATE_DECSN_PC
				, MRTGG_RATE
				, INSRNC_AMOUNT
				, EXCCLC_AMOUNT
				, RM
				, REGISTER_ID
				, REGIST_DT
				, UPDUSR_ID
				, UPDT_DT			
				)
				VALUES
				(
				  '2'
				, #CNTRCTR_NO#
				, #CNTRCTR_CO#
				, #CNTRCT_BGNDE#
				, #CNTRCT_ENDDE#
				, #SCRITS_NO#
				, #ENDRS_NO#
				, #MANAGE_NO#
				, #PC_DECSN_MTH#
				, #PC_DECSN_DE#
				, #ESTATE_DECSN_PC#
				, #MRTGG_RATE#
				, #INSRNC_AMOUNT#
				, #EXCCLC_AMOUNT#
				, #RM#
				, #S_USER_ID#
				, SYSDATE
				, #S_USER_ID#
				, SYSDATE
		)
	</insert>
	<!-- 쿼리명 : 화재보험 삭제
	설명 : 화재보험 삭제 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29
	-->	
	<delete id="RNT030301DAO.listDR4" parameterClass="java.util.Map">
		DELETE TBRNT_LFSTS_INSRNC
		WHERE INSRNC_SE = '2'
		  AND CNTRCTR_NO = #CNTRCTR_NO#
		  AND CNTRCTR_CO = #CNTRCTR_CO#
	</delete>

	<!-- 쿼리명 : 법무사 조회
	설명 : 법무사 조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29
	-->
	<select id="RNT030301DAO.getListR5" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		  SELECT 
		          ROW_NUMBER() OVER(ORDER BY TE.CNTRCTR_NO) AS ROW_NUM
			    , TE.CNTRCTR_NO
			    , TE.CNTRCTR_CO
			    , TEC.MDIATN_JCFFR_SE
			    , TEC.MDIATN_JCFFR_CODE
			    , TE.FEE
			    , TE.PYMNT_DE
			    , TE.DPSTR
			    , TE.RM
			    , TE.REGISTER_ID
			    , TE.REGIST_DT
			    , TE.UPDUSR_ID
			    , TE.UPDT_DT
			    , TEC.AREA_SE
			    , TEC.MTLTY
			    , TEC.BIZRNO
			    , TEC.RPRSNTV
			    , TEC.ZIP
			    , TEC.ADRES
			    , TEC.ADRES_DETAIL
			    , TEC.TELNO_1
			    , TEC.TELNO_2
			    , TEC.CNTRCT_AMOUNT
			    , TEC.DPSTR
			    , TEC.BANK_CODE
			    , TEC.ACNUTNO
		 FROM TBRNT_LFSTS_MDIATN_JCFFR_INFO TEC
		    , TBRNT_LFSTS_MDIATN_JCFFR TE     
		WHERE TEC.MDIATN_JCFFR_CODE = TE.MDIATN_JCFFR_CODE
		  AND TEC.MDIATN_JCFFR_SE = TE.MDIATN_JCFFR_SE
  		<isNotEmpty property="CNTRCTR_NO">
		  AND TE.CNTRCTR_NO = #CNTRCTR_NO# 
		  AND TEC.MDIATN_JCFFR_SE = '001'
		  AND TE.CNTRCTR_CO = #CNTRCTR_CO#
 		</isNotEmpty>			  
  		<isNotEmpty property="AREA_SE">
		  AND TEC.AREA_SE = (SELECT CHRCTR_PREPAR_VALUE_2 FROM TBCOM_CMMN_CODE WHERE GRP_CODE = 'RNT004' AND CODE_ORDR = #AREA_SE#)
 		</isNotEmpty>	  
		  
		  ORDER BY TE.CNTRCTR_NO
	</select>


	<!-- 쿼리명 : 법무사 조회 팝업용
	설명 : 법무사 조회 팝업용
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2016.03.16
	-->
	<select id="RNT030301DAO.getListT5" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		  SELECT 
			      TEC.MDIATN_JCFFR_SE
			    , TEC.MDIATN_JCFFR_CODE
			    , TEC.AREA_SE
			    , TEC.MTLTY
			    , TEC.BIZRNO
			    , TEC.RPRSNTV
			    , TEC.ZIP
			    , TEC.ADRES
			    , TEC.ADRES_DETAIL
			    , TEC.TELNO_1
			    , TEC.TELNO_2
			    , TEC.CNTRCT_AMOUNT
			    , TEC.DPSTR
			    , TEC.BANK_CODE
			    , TEC.ACNUTNO
			    , TEC.AGENT
		 FROM TBRNT_LFSTS_MDIATN_JCFFR_INFO TEC   
		WHERE 1=1
		  AND TEC.MDIATN_JCFFR_SE = '001'		  
		  AND TEC.MDIATN_JCFFR_CODE = #MDIATN_JCFFR_CODE#	  

	</select>


<!-- 쿼리명 : 법무사 수정
설명 : 법무사 수정 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.06.29
-->
<update id="RNT030301DAO.listUR5" parameterClass="java.util.Map">
BEGIN
	UPDATE TBRNT_LFSTS_MDIATN_JCFFR_INFO
	   SET  MTLTY = #MTLTY#
	      , BIZRNO = #BIZRNO#
	      , RPRSNTV = #RPRSNTV#
	      , ZIP = #ZIP#
	      , ADRES = #ADRES#
	      , ADRES_DETAIL = #ADRES_DETAIL#
	      , TELNO_1 = #TELNO_1#
	      , TELNO_2 = #TELNO_2#
	      , BANK_CODE = #BANK_CODE#
	      , ACNUTNO = #ACNUTNO#
	      , AREA_SE = #AREA_SE#
	      , RM = #RM#
	WHERE MDIATN_JCFFR_SE = '001'
	  AND MDIATN_JCFFR_CODE = #MDIATN_JCFFR_CODE#
	  ;	

	UPDATE TBRNT_LFSTS_MDIATN_JCFFR
	   SET
			 FEE	=	#FEE#
			,PYMNT_DE	=	#PYMNT_DE#
			,BANK_CODE	=	#BANK_CODE#
			,ACNUTNO	=	#ACNUTNO#
			,DPSTR	=	#DPSTR#
			,RM	=	#RM#
			,UPDUSR_ID	=	#S_USER_ID#
			,UPDT_DT	=	SYSDATE
			,MDIATN_JCFFR_CODE = #MDIATN_JCFFR_CODE#
	WHERE MDIATN_JCFFR_SE = '001'
	  AND CNTRCTR_NO = #CNTRCTR_NO#
	  AND CNTRCTR_CO = #CNTRCTR_CO#
	  ;

END;	  
</update>

<!-- 쿼리명 : 법무사 신규
설명 : 법무사 신규 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.06.29
-->
<insert id="RNT030301DAO.listCR5" parameterClass="java.util.Map">
		INSERT INTO TBRNT_LFSTS_MDIATN_JCFFR
		(
				  CNTRCTR_NO
				, MDIATN_JCFFR_SE
				, MDIATN_JCFFR_CODE
				, FEE
				, PYMNT_DE
				, BANK_CODE
				, ACNUTNO
				, DPSTR
				, RM
				, REGISTER_ID
				, REGIST_DT
				, UPDUSR_ID
				, UPDT_DT	
				, CNTRCTR_CO			
				)
				VALUES
				(
				  #CNTRCTR_NO#
				, '001'
				, #MDIATN_JCFFR_CODE#
				, #FEE#
				, #PYMNT_DE#
				, #BANK_CODE#
				, #ACNUTNO#
				, #DPSTR#
				, #RM#
				, #S_USER_ID#
				, SYSDATE
				, #S_USER_ID#
				, SYSDATE	
				, #CNTRCTR_CO#			
		)
</insert>

<!-- 쿼리명 : 법무사 삭제
설명 : 법무사 삭제 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.06.29
-->	
<delete id="RNT030301DAO.listDR5" parameterClass="java.util.Map">
		DELETE TBRNT_LFSTS_MDIATN_JCFFR
		WHERE MDIATN_JCFFR_SE = '001'
		  AND CNTRCTR_NO = #CNTRCTR_NO#
		  AND CNTRCTR_CO = #CNTRCTR_CO#
		  AND MDIATN_JCFFR_CODE = #MDIATN_JCFFR_CODE#
</delete>

	<!-- 쿼리명 : 부동산 조회
	설명 : 부동산 조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.29
	-->
	<select id="RNT030301DAO.getListR6" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		  SELECT 
		          TE.CNTRCTR_NO
			    , TE.CNTRCTR_CO			    
			    , TEC.MDIATN_JCFFR_SE
			    , TEC.MDIATN_JCFFR_CODE
			    , TE.FEE
                , (CASE WHEN TEC.TAXT_SE = 1 THEN TE.FEE ELSE TE.FEE * 1.0 END) AS AMT1 
                , (CASE WHEN TEC.TAXT_SE = 1 THEN TE.FEE * 0.1 ELSE 0 END) AS AMT2
			    , TE.PYMNT_DE
			    , TE.DPSTR
			    , TE.RM
			    , TE.REGISTER_ID
			    , TE.REGIST_DT
			    , TE.UPDUSR_ID
			    , TE.UPDT_DT
			    , TEC.MTLTY
			    , TEC.BIZRNO
			    , TEC.RPRSNTV
			    , TEC.ZIP
			    , TEC.ADRES
			    , TEC.ADRES_DETAIL
			    , TEC.TELNO_1
			    , TEC.TELNO_2
			    , TEC.CNTRCT_AMOUNT
			    , TEC.DPSTR
			    , TEC.BANK_CODE
			    , TEC.ACNUTNO
			    , TEC.TAXT_SE
		 FROM TBRNT_LFSTS_MDIATN_JCFFR_INFO TEC
		    , TBRNT_LFSTS_MDIATN_JCFFR TE       
		WHERE TEC.MDIATN_JCFFR_CODE = TE.MDIATN_JCFFR_CODE
		  AND TEC.MDIATN_JCFFR_SE = TE.MDIATN_JCFFR_SE
  		<isNotEmpty property="CNTRCTR_NO">
		   AND TE.CNTRCTR_NO = #CNTRCTR_NO#
		   AND TEC.MDIATN_JCFFR_SE = '002'
		   AND TE.CNTRCTR_CO = #CNTRCTR_CO#
 		</isNotEmpty>			  
  		<isNotEmpty property="MDIATN_JCFFR_CODE">
		  AND TEC.MDIATN_JCFFR_CODE = #MDIATN_JCFFR_CODE#
 		</isNotEmpty>			  
		  ORDER BY TE.CNTRCTR_NO   
	</select>

	<!-- 쿼리명 : 부동산 조회 팝업용
	설명 : 부동산 조회 쿼리 팝업용
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2016.03.16
	-->
	<select id="RNT030301DAO.getListT6" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		  SELECT 
		          TEC.MDIATN_JCFFR_SE
			    , TEC.MDIATN_JCFFR_CODE
			    , TEC.MTLTY
			    , TEC.BIZRNO
			    , TEC.RPRSNTV
			    , TEC.ZIP
			    , TEC.ADRES
			    , TEC.ADRES_DETAIL
			    , TEC.TELNO_1
			    , TEC.TELNO_2
			    , TEC.CNTRCT_AMOUNT
			    , TEC.DPSTR
			    , TEC.BANK_CODE
			    , TEC.ACNUTNO
			    , TEC.TAXT_SE
		 FROM TBRNT_LFSTS_MDIATN_JCFFR_INFO TEC      
		WHERE 1=1
		   AND TEC.MDIATN_JCFFR_SE = '002'
  		<isNotEmpty property="MDIATN_JCFFR_CODE">
		  AND TEC.MDIATN_JCFFR_CODE = #MDIATN_JCFFR_CODE#
 		</isNotEmpty>			  
		     
	</select>

<!-- 쿼리명 : 부동산 수정
설명 : 부동산 수정 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.06.29
-->
<update id="RNT030301DAO.listUR6" parameterClass="java.util.Map">
BEGIN
	
	UPDATE TBRNT_LFSTS_MDIATN_JCFFR_INFO
	   SET  MTLTY = #MTLTY#
	      , BIZRNO = #BIZRNO#
	      , RPRSNTV = #RPRSNTV#
	      , ZIP = #ZIP#
	      , ADRES = #ADRES#
	      , ADRES_DETAIL = #ADRES_DETAIL#
	      , TELNO_1 = #TELNO_1#
	      , TELNO_2 = #TELNO_2#
	      , BANK_CODE = #BANK_CODE#
	      , ACNUTNO = #ACNUTNO#
	      , AREA_SE = #AREA_SE#
	      , RM = #RM#
	      , TAXT_SE = #TAXT_SE#
	WHERE MDIATN_JCFFR_SE = '002'
	  AND MDIATN_JCFFR_CODE = #MDIATN_JCFFR_CODE#
	  ;			

	UPDATE TBRNT_LFSTS_MDIATN_JCFFR
	   SET
			 FEE	=	#FEE#
			,PYMNT_DE	=	#PYMNT_DE#
			,BANK_CODE	=	#BANK_CODE#
			,ACNUTNO	=	#ACNUTNO#
			,DPSTR	=	#DPSTR#
			,RM	=	#RM#
			,UPDUSR_ID	=	#S_USER_ID#
			,UPDT_DT	=	SYSDATE
			,MDIATN_JCFFR_CODE = #MDIATN_JCFFR_CODE#
	WHERE MDIATN_JCFFR_SE = '002'
	  AND CNTRCTR_NO = #CNTRCTR_NO#
	  AND CNTRCTR_CO = #CNTRCTR_CO#
	  ;
END;  
</update>

<!-- 쿼리명 : 부동산 신규
설명 : 부동산 신규 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.06.29
-->
<insert id="RNT030301DAO.listCR6" parameterClass="java.util.Map">
		INSERT INTO TBRNT_LFSTS_MDIATN_JCFFR
		(
				  CNTRCTR_NO
				, MDIATN_JCFFR_SE
				, MDIATN_JCFFR_CODE
				, FEE
				, PYMNT_DE
				, BANK_CODE
				, ACNUTNO
				, DPSTR
				, RM
				, REGISTER_ID
				, REGIST_DT
				, UPDUSR_ID
				, UPDT_DT		
				, CNTRCTR_CO		
				)
				VALUES
				(
				  #CNTRCTR_NO#
				, '002'
				, #MDIATN_JCFFR_CODE#
			    , (SELECT MAX(BGMS)
			         FROM TBRNT_LFSTS_MDIATN_FEE
			        WHERE #LFSTS_AMOUNT# >= LFSTS_AMOUNT)
				, #PYMNT_DE#
				, #BANK_CODE#
				, #ACNUTNO#
				, #DPSTR#
				, #RM#
				, #S_USER_ID#
				, SYSDATE
				, #S_USER_ID#
				, SYSDATE		
				, #CNTRCTR_CO#		
		)
</insert>

<!-- 쿼리명 : 부동산 삭제
설명 : 부동산 삭제 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.06.29
-->	
<delete id="RNT030301DAO.listDR6" parameterClass="java.util.Map">
		DELETE TBRNT_LFSTS_MDIATN_JCFFR
		WHERE MDIATN_JCFFR_SE = '002'
		  AND CNTRCTR_NO = #CNTRCTR_NO#
		  AND CNTRCTR_CO = #CNTRCTR_CO#
		  AND MDIATN_JCFFR_CODE = #MDIATN_JCFFR_CODE#
</delete>


<!-- 쿼리명 : 세대원 조회
설명 : 세대원 조회 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.06.29
-->
<select id="RNT030301DAO.getListR7" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		SELECT
              ROW_NUMBER() OVER(ORDER BY TFM.SN) AS ROW_NUM
		    , TFM.APPLCNT_CNTRCTR_SE
		    , TFM.APPLCNT_CNTRCTR_NO
		    , TFM.SN
		    , SFCOM_DEC_ALL(TLRC.IHIDNUM) AS IHIDNUM 
		    , TLRC.NM
		    , TFM.FAMILY_RELATE
		    , TLRC.TELNO
		    , TLRC.MBTLNO
		    , TFM.SCRT_INFO_EXAMIN_ID
		    , TFM.RM
		    , TFM.REGISTER_ID
		    , TFM.REGIST_DT
		    , TFM.UPDUSR_ID
		    , TFM.UPDT_DT
		    , TLRC.LFSTS_CSTMR_NO
		 FROM TBRNT_LFSTS_FAMILY_MATTER TFM
		    , TBRNT_LFSTS_CSTMR TLRC
		WHERE TFM.LFSTS_CSTMR_NO = TLRC.LFSTS_CSTMR_NO		
		  AND APPLCNT_CNTRCTR_NO = #APPLCNT_CNTRCTR_NO#	
		  AND APPLCNT_CNTRCTR_SE = #APPLCNT_CNTRCTR_SE#
		ORDER BY APPLCNT_CNTRCTR_NO
	</select>
	
<!-- 쿼리명 : 세대원 신규
설명 : 세대원 신규 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.06.29
-->
<insert id="RNT030301DAO.listCR7" parameterClass="java.util.Map">	
BEGIN	
 		INSERT INTO TBRNT_LFSTS_CSTMR(
			  LFSTS_CSTMR_NO
			, NM
			, IHIDNUM
			, ZIP
			, ADRES
			, ADRES_DETAIL
			, TELNO
			, MBTLNO
			, REGISTER_ID
			, REGIST_DT
		    , UPDUSR_ID
		    , UPDT_DT	
		 )VALUES(		    
		      (SELECT NVL(MAX(LFSTS_CSTMR_NO),0)+1 FROM TBRNT_LFSTS_CSTMR)
		    , #NM#
		    , SFCOM_ENC_ALL(REPLACE(#IHIDNUM#, '-', ''))
		    , #ZIP#
		    , #ADRES#
		    , #ADRES_DETAIL#
		    , #TELNO#
		    , #MBTLNO#
		    , #S_USER_ID#
		    , SYSDATE
		    , #S_USER_ID#
		    , SYSDATE  
		 )
		 ;
		 INSERT INTO TBRNT_LFSTS_FAMILY_MATTER(
		      APPLCNT_CNTRCTR_SE
		    , APPLCNT_CNTRCTR_NO
		    , SN
		    , FAMILY_RELATE
		    , SCRT_INFO_EXAMIN_ID
		    , RM
		    , REGISTER_ID
		    , REGIST_DT
		    , UPDUSR_ID
		    , UPDT_DT
			, LFSTS_CSTMR_NO	    
		 )VALUES(
		      '002'
		    , #APPLCNT_CNTRCTR_NO#
		    , (SELECT NVL(MAX(SN),0)+1 FROM TBRNT_LFSTS_FAMILY_MATTER)
		    , #FAMILY_RELATE#
		    , #SCRT_INFO_EXAMIN_ID#
		    , #RM#
		    , #S_USER_ID#
		    , SYSDATE	
		    , #S_USER_ID#
		    , SYSDATE	
			, (SELECT MAX(LFSTS_CSTMR_NO) FROM TBRNT_LFSTS_CSTMR)    
		    )
		 	;		 
END;	 	
</insert>

<!-- 쿼리명 : 세대원 신규 (기존 고객정보 존재시)
설명 : 세대원 신규 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2016.06.24
-->
<insert id="RNT030301DAO.listCR77" parameterClass="java.util.Map">	

			 INSERT INTO TBRNT_LFSTS_FAMILY_MATTER(
		      APPLCNT_CNTRCTR_SE
		    , APPLCNT_CNTRCTR_NO
		    , SN
		    , FAMILY_RELATE
		    , SCRT_INFO_EXAMIN_ID
		    , RM
		    , REGISTER_ID
		    , REGIST_DT
		    , UPDUSR_ID
		    , UPDT_DT
			, LFSTS_CSTMR_NO	    
		 )VALUES(
		      '002'
		    , #APPLCNT_CNTRCTR_NO#
		    , (SELECT NVL(MAX(SN),0)+1 FROM TBRNT_LFSTS_FAMILY_MATTER)
		    , #FAMILY_RELATE#
		    , #SCRT_INFO_EXAMIN_ID#
		    , #RM#
		    , #S_USER_ID#
		    , SYSDATE	
		    , #S_USER_ID#
		    , SYSDATE	
			, #LFSTS_CSTMR_NO#    
		    )	 
		 	 	
</insert>

<!-- 쿼리명 : 세대원 수정
설명 : 세대원 수정 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.06.29
-->
<update id="RNT030301DAO.listUR7" parameterClass="java.util.Map">
 BEGIN
		 UPDATE TBRNT_LFSTS_FAMILY_MATTER
		 SET
		   FAMILY_RELATE       =   #FAMILY_RELATE#
		 , SCRT_INFO_EXAMIN_ID =   #SCRT_INFO_EXAMIN_ID#
		  ,RM                  =   #RM#
		 , UPDUSR_ID           =   #S_USER_ID#
		 , UPDT_DT             =  SYSDATE
		WHERE APPLCNT_CNTRCTR_NO = #APPLCNT_CNTRCTR_NO#
		  AND APPLCNT_CNTRCTR_SE = #APPLCNT_CNTRCTR_SE#
		  AND SN = #SN#
		  ;
	UPDATE TBRNT_LFSTS_CSTMR
	SET
		  NM                   = #NM#
		, IHIDNUM               = SFCOM_ENC_ALL(REPLACE(#IHIDNUM#, '-', ''))
		, ZIP                  = #ZIP#
		, ADRES                = #ADRES#
		, ADRES_DETAIL         = #ADRES_DETAIL#
		, TELNO                = #TELNO#
		, MBTLNO               = #MBTLNO#
		, UPDUSR_ID            = #S_USER_ID#
		, UPDT_DT              = SYSDATE
	WHERE LFSTS_CSTMR_NO = #LFSTS_CSTMR_NO#	
		;		  
END;
</update>	
<!-- 쿼리명 : 세대원 삭제
설명 : 세대원 삭제 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.06.29
-->	
<delete id="RNT030301DAO.listDR7" parameterClass="java.util.Map">
  BEGIN
    DELETE TBRNT_LFSTS_FAMILY_MATTER
     WHERE APPLCNT_CNTRCTR_NO = #APPLCNT_CNTRCTR_NO#
       AND SN = #SN#
    ;
    DELETE TBRNT_LFSTS_CSTMR
   	WHERE 1=1
   	  AND LFSTS_CSTMR_NO = #LFSTS_CSTMR_NO#
   	;
   END;  
</delete>

<!-- 쿼리명 : 지원내역 조회
설명 : 지원내역 조회 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.06.29
-->
<select id="RNT030301DAO.getListR8" parameterClass="java.util.Map" resultClass="java.util.HashMap">
SELECT
      TLHC.CNTRCTR_NO
    , TLHC.CNTRCTR_CO
    , TLHC.LFSTS_AMOUNT
    , TLHC.SPORT_AMOUNT
    , TLHC.RENT_ALOTM
    , TLHC.ADIT_ALOTM
    , TLHC.RNTCHRG
    , TLHC.RSVMNEY
    , TLHC.CDIT_PRESV_MTHD
    , TLHC.RM
    , TLHC.REGISTER_ID
    , TLHC.REGIST_DT
    , TLHC.UPDUSR_ID
    , TLHC.UPDT_DT
    , TLHC.HOUSE_KND
    , TLHC.ZIP
    , TLHC.ADRES
    , TLHC.ADRES_DETAIL
    , ADRES || ADRES_DETAIL AS TOTAL_ADRES
    , TLHC.HEAT_SE
    , TLHC.FLOOR_SE
    , TLHC.AR
    , TLHC.ALL_ROOM_CO
    , TLHC.RENT_ROOM_CO
    , TLHC.PC_DECSN_MTH
    , TLHC.HOUSE_POTVALE
    , TLHC.RCOGN_RATE
    , TLHC.HOUSE_PC
    , TLHC.DEBT_RATE
    , TLHC.HOUSE_STDPC
    , TLHC.FDLTR_ESTBS_AMOUNT
    , TLHC.RLDB_ESTBS_AMOUNT
    , TLHC.LEGACY_RENT_AMOUNT
    , TLHC.LFSTS_CONFM_AMOUNT
    , TLHC.EVL_DE
    , TLHC.DCSN_DE
    , TLHC.CNTRCT_DE
    , TLHC.SPORT_BGNDE
    , TLHC.SPORT_ENDDE
    , TLHC.TRNSFRN_DE
    , TLRT.RESCI_TRMNAT_DE
    , TLRT.RESCI_TRMNAT_RESN
    , C.RETURN_DE
    , C.RETURN_AMOUNT
FROM TBRNT_LFSTS_HOUSE_CNTRCTR TLHC
   , TBRNT_LFSTS_RESCI_TRMNAT TLRT
   , (SELECT CNTRCTR_NO, CNTRCTR_CO
           , MAX(RETURN_DE) AS RETURN_DE, SUM(SPORT_RETURN_AMOUNT) AS RETURN_AMOUNT
        FROM TBRNT_LFSTS_SPRMNY_RETURN
       WHERE CNTRCTR_NO = #CNTRCTR_NO#
       GROUP BY CNTRCTR_NO, CNTRCTR_CO  
     ) C
WHERE TLHC.CNTRCTR_NO = TLRT.CNTRCTR_NO(+) 
  AND TLHC.CNTRCTR_CO = TLRT.CNTRCTR_CO(+)
  AND TLHC.CNTRCTR_NO = C.CNTRCTR_NO(+) 
  AND TLHC.CNTRCTR_CO = C.CNTRCTR_CO(+)
  AND TLHC.CNTRCTR_NO = #CNTRCTR_NO#

ORDER BY TLHC.CNTRCT_DE DESC


</select>

<!-- 쿼리명 : 계약자번호생성
설명 : 계약자번호생성 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.11.24
-->
<select id="RNT030301DAO.CNTRCTRNO" parameterClass="java.util.Map" resultClass="java.util.HashMap">
SELECT #AREA_SE#||TO_CHAR(SYSDATE , 'YYYY')||LPAD(NVL(1+MAX(SUBSTR(CNTRCTR_NO , 8 , 3)),1), 3 ,'0') AS CNTRCTR_NO
      , TO_CHAR(SYSDATE , 'YYYY') AS DONG
      , LPAD(NVL(1+MAX(SUBSTR(CNTRCTR_NO , 8 , 3)),1), 4 ,'0') AS HO
  FROM TBRNT_LFSTS_CNTRCT 
 WHERE DONG = TO_CHAR(SYSDATE, 'YYYY')
   AND AREA_SE = #AREA_SE#
</select>

<!-- 쿼리명 : 신청자 선택 팝업 조회
	설명 : 신청자 선택 조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.30
-->
<select id="RNT030301DAO.getListT02" parameterClass="java.util.Map" resultClass="java.util.HashMap">
        SELECT
              ROW_NUMBER() OVER(ORDER BY TA.APPLCNT_NO) AS ROW_NUM
            , TA.APPLCNT_NO
            , TA.AREA_SE
            , TA.RCEPT_DE
            , TA.WAIT_NO
            , TLRC.NM
            , SFCOM_DEC_ALL(TLRC.IHIDNUM) AS IHIDNUM 
            , TA.QUALF_SE
            , TA.FAMILY_CO
            , TLRC.ZIP
            , TLRC.ADRES
            , TLRC.ADRES_DETAIL
            , TLRC.TELNO
            , TLRC.MBTLNO
            , TA.HOUSE_POSESN_AT
            , TA.LAD_POSESN_AT
            , TA.BILD_POSESN_AT
            , TA.CAR_POSESN_AT
            , TA.SCORE
            , TA.SCRT_INFO_EXAMIN_ID
            , TA.CNTRCT_STTUS
            , TA.CNTRCTR_NO
            , TA.TRNSFRN_DE
            , TA.APPLCNT_RELATE
            , TA.REGISTER_ID
            , TA.REGIST_DT
            , TA.UPDUSR_ID
            , TA.UPDT_DT
            , TA.RM
            , TA.LFSTS_CSTMR_NO
            , (SELECT (CASE WHEN COUNT(*) >= '1' THEN '1' ELSE '0' END)
                 FROM TBRNT_LFSTS_SEIZR TLS 
                 WHERE TA.APPLCNT_NO = TLS.APPLCNT_CNTRCTR_NO
                   AND TLS.RELIS_DE IS NULL) AS LOAN_POSESN_AT               
         FROM TBRNT_LFSTS_APPLCNT TA
            , TBRNT_LFSTS_CSTMR TLRC
        WHERE TA.LFSTS_CSTMR_NO = TLRC.LFSTS_CSTMR_NO	
		  AND TA.CNTRCT_STTUS = '1'
		 <isNotEmpty property="AREA_SE">
			 AND TA.AREA_SE = #AREA_SE#
		 </isNotEmpty>
		 <isNotEmpty property="NM">
		 	AND TLRC.NM LIKE #NM#||'%'
		 </isNotEmpty>
		    AND TA.APPLCNT_NO IN ( SELECT DISTINCT APPLCNT_CNTRCTR_NO 
		                                    FROM TBRNT_LFSTS_RIGHT_ANALS TRA 
		                                   WHERE TA.APPLCNT_NO = TRA.APPLCNT_CNTRCTR_NO
		                                     AND TRA.APPLCNT_CNTRCTR_SE = '001'
		                                     AND TRA.CONFM_AT = '1')   
		ORDER BY APPLCNT_NO
</select>
	<!-- 쿼리명 : 권리분석 선택 팝업 조회
	설명 : 신청자 선택 조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2015.06.30
	-->	
<select id="RNT030301DAO.getListT03" parameterClass="java.util.Map" resultClass="java.util.HashMap">
        SELECT
              ROW_NUMBER() OVER(ORDER BY TRA.APPLCNT_CNTRCTR_NO) AS ROW_NUM
            , TRA.APPLCNT_CNTRCTR_SE
            , TRA.APPLCNT_CNTRCTR_NO
            , TRA.SN
            , TRA.RCEPT_DE
            , TRA.MDIATN_JCFFR_SE
            , TRA.MDIATN_JCFFR_CODE
            , TRA.MDIATN_JCFFR_CODE2
            , TRA.ZIP
            , TRA.ADRES
            , TRA.ADRES_DETAIL
            , TRA.OWNER
            , TRA.AR
            , TRA.PC_DECSN_MTH
            , TRA.HOUSE_POTVALE
            , TRA.HOUSE_STDPC
            , TRA.RCOGN_RATE
            , TRA.HOUSE_PC
            , TRA.DEBT_RATE
            , TRA.FDLTR_ESTBS_AMOUNT
            , TRA.RLDB_ESTBS_AMOUNT
            , TRA.LEGACY_RENT_AMOUNT
            , TRA.LFSTS_CONFM_AMOUNT
            , TRA.CDIT_PRESV_MTHD
            , TRA.CONFM_AT
            , TRA.ANALS_RESULT
            , TRA.RM
            , TRA.CNTRCT_AT
            , TRA.HOUSE_KND
            , TRA.HEAT_SE
            , TRA.FLOOR_SE
            , TRA.AR
            , TRA.ALL_ROOM_CO
            , TRA.RENT_ROOM
            , TRA.BILDNG_STRCT
            , TEC.MTLTY
            , TEC.RPRSNTV
            , TEC.TELNO_1
            , TEC.ZIP      
            , TRA.LEGACY_RENT_CNT
            , TRA.VACANT_ROOM_CO
            , TRA.FDLTR_ESTBS_CNT            
         FROM TBRNT_LFSTS_RIGHT_ANALS TRA  
            , TBRNT_LFSTS_MDIATN_JCFFR_INFO TEC
        WHERE TRA.MDIATN_JCFFR_CODE = TEC.MDIATN_JCFFR_CODE
          AND TRA.MDIATN_JCFFR_SE = TEC.MDIATN_JCFFR_SE
          AND TRA.APPLCNT_CNTRCTR_NO = #APPLCNT_CNTRCTR_NO#
          AND TRA.APPLCNT_CNTRCTR_SE = '001'
          AND TRA.CONFM_AT = '1'
          ORDER BY APPLCNT_CNTRCTR_NO
</select>	

<!-- 쿼리명 : 첨부파일 조회
설명 : 첨부파일 조회
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.11.12
-->	
<select id="RNT030301DAO.ATCH" parameterClass="java.util.Map" resultClass="java.util.HashMap">
 SELECT  FILE_SN
       , FILE_ORDR
       , ORGINL_FILE_NM AS FILE_NM       
       , FILE_EXTSN
   FROM TBCOM_CMMN_ATCHMNFL
  WHERE 1=1
    AND FILE_SN = #FILE_SN#   
</select>	

<select id="RNT030301DAO.FILECNT" parameterClass="java.util.Map" resultClass="java.lang.Integer">
 SELECT COUNT(*) AS CNT
   FROM TBCOM_CMMN_ATCHMNFL
  WHERE 1=1
    AND FILE_SN = #FILE_SN#   
</select>	

<!-- 쿼리명 : 파일 첨부
설명 : 파일 첨부
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 :  2015.11.12
-->
<insert id="RNT030301DAO.atchCUD" parameterClass="java.util.Map">	
 UPDATE TBRNT_LFSTS_CNTRCT
    SET FILE_SN = #FILE_SN#
  WHERE 1=1
    AND CNTRCTR_NO = #CNTRCTR_NO#     	 	
</insert>
<!-- 쿼리명 : 첨부파일 삭제
설명 : 첨부파일 삭제
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.06.29
-->	
<delete id="RNT030301DAO.atchDelete" parameterClass="java.util.Map">
<!-- 
    DELETE TBRNT_LFSTS_CTRTC_ATCH
     WHERE CNTRCTR_NO = #CNTRCTR_NO#
       AND CNTRCT_SE = '1'
       AND CNTRCT_DE = #CNTRCT_DE#
       AND SEQ = #SEQ#
-->

	UPDATE TBRNT_LFSTS_CNTRCT
	   SET FILE_SN = null
	 WHERE 1=1
	   AND CNTRCTR_NO = #CNTRCTR_NO# 
   
</delete>	

<update id="RNT030301DAO.approveU" parameterClass="java.util.HashMap">
	 UPDATE TBRNT_LFSTS_HOUSE_CNTRCTR A
	    SET	 ELCTRN_SANCTN_NO  = (SELECT SANCTN_NO FROM TBCOM_ELCTRN_SANCTN_MASTR WHERE INTRLCK_IDNTFR = #KEY#)
	 	   , UPDUSR_ID  =  #S_USER_ID#
	 	   , UPDT_DT	=  SYSDATE			  
	    WHERE CNTRCTR_NO = #CNTRCTR_NO#
	      AND CNTRCTR_CO = #CNTRCT_CO#
</update>

<!-- 쿼리명 : 출력물
설명 : 출력물 조회
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2016.04.14
-->	
<select id="RNT030301DAO.PRT" parameterClass="java.util.Map" resultClass="java.util.HashMap">
SELECT  ROWNUM AS SN
      , A.CNTRCTR_NO
      , SUBSTR(B.CNTRCT_DE , 1,4) AS TODAY
      , SUBSTR(B.CNTRCT_DE , 3,2) || '.' || SUBSTR(B.CNTRCT_DE , 5,2) || '.' || SUBSTR(B.CNTRCT_DE , 7,2) AS CNTRCT_DE
      , SUBSTR(B.SPORT_BGNDE , 3,2) || '.' || SUBSTR(B.SPORT_BGNDE , 5,2) || '.' || SUBSTR(B.SPORT_BGNDE , 7,2) || '~' || SUBSTR(B.SPORT_ENDDE , 3,2) || '.' || SUBSTR(B.SPORT_ENDDE , 5,2) || '.' || SUBSTR(B.SPORT_ENDDE , 7,2) AS SPORT_DE
      , C.NM
      , B.TRNSFRN_DE
      , C.ADRES || C.ADRES_DETAIL AS ADRES
      , SFCOM_CODE_NM('RNT012' , B.HOUSE_KND) AS HOUSE_KND
      , B.AR || '(' || B.RENT_ROOM_CO || ')' AS AR
      , B.SPORT_AMOUNT
      , E.NM AS NM_PSN
      , SFCOM_CODE_NM( 'COM021' , D.BANK_CODE) AS BANK_PSN
      , D.ACNUTNO AS ACNUTNO_PSN
      , G.MTLTY
      , F.DPSTR
      , NVL(F.FEE , 0) AS FEE
      , SFCOM_CODE_NM( 'COM021' , F.BANK_CODE) AS BANK_JCFFR
      , F.ACNUTNO AS ACNUTNO_JCFFR
      , B.SPORT_AMOUNT + NVL(F.FEE , 0) AS TOTAL_AMT
  FROM TBRNT_LFSTS_CNTRCT A
  JOIN TBRNT_LFSTS_HOUSE_CNTRCTR B ON A.CNTRCTR_NO = B.CNTRCTR_NO AND A.CNTRCT_CO = B.CNTRCTR_CO 
  JOIN TBRNT_LFSTS_CSTMR C ON A.LFSTS_CSTMR_NO = C.LFSTS_CSTMR_NO
  LEFT JOIN TBRNT_LFSTS_RENT_PSN D ON A.CNTRCTR_NO = D.CNTRCTR_NO AND A.CNTRCT_CO = D.CNTRCTR_CO
  LEFT JOIN TBRNT_LFSTS_CSTMR E ON D.LFSTS_CSTMR_NO = E.LFSTS_CSTMR_NO
  LEFT JOIN TBRNT_LFSTS_MDIATN_JCFFR F ON A.CNTRCTR_NO = F.CNTRCTR_NO AND A.CNTRCT_CO = F.CNTRCTR_CO AND MDIATN_JCFFR_SE = '002' 
  LEFT JOIN TBRNT_LFSTS_MDIATN_JCFFR_INFO G ON F.MDIATN_JCFFR_CODE = G.MDIATN_JCFFR_CODE
 WHERE 1=1
   AND A.CNTRCTR_NO = #CNTRCTR_NO#
</select>

<!-- 쿼리명 : 전세임대료 요율
설명 : 전세임대료 요율 조회
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2016.06.29
-->	
<select id="RNT030301DAO.INTRT" parameterClass="java.util.Map" resultClass="java.util.HashMap">

SELECT  APPLC_DE
      , ARRRG_LIMIT
      , ARRRG_SCOPE_BEGIN
      , ARRRG_SCOPE_END
      , ARRRG_INTRT
       FROM TBRNT_LFSTS_ARRRG_INTRT
      WHERE 1=1
        AND APPLC_DE = (SELECT MAX(APPLC_DE)
                          FROM TBRNT_LFSTS_ARRRG_INTRT
                         WHERE 1=1
						   <isNotEmpty property="SPORT_AMOUNT">           
                           AND #SPORT_AMOUNT# BETWEEN ARRRG_SCOPE_BEGIN AND ARRRG_SCOPE_END
                           </isNotEmpty>
                           <![CDATA[                         
                           AND APPLC_DE <= #CNTRCT_DE#)
						   ]]>                      
		<isNotEmpty property="SPORT_AMOUNT">     				   
        AND #SPORT_AMOUNT# BETWEEN ARRRG_SCOPE_BEGIN AND ARRRG_SCOPE_END
        </isNotEmpty>                 
      ORDER BY  ARRRG_SCOPE_BEGIN	
</select>

<!-- 쿼리명 : 전세면제
설명 : 전세면제 조회
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2016.07.01
-->	
<select id="RNT030301DAO.exemptionList" parameterClass="java.util.Map" resultClass="java.util.HashMap">
SELECT A.CNTRCTR_NO
	 , A.CNTRCTR_CO
     , A.RECEP_DE
     , A.DEATH_DATE
     , A.APPLY_DATE
     , A.LFSTS_CSTMR_NO
     , A.EXEMPTION_RM
     , A.FILE_SN
     , C.FILE_ORDR
     , C.ORGINL_FILE_NM AS FILE_NM  
     , B.NM
     , B.TELNO
     , B.MBTLNO
 FROM TBRNT_LFSTS_EXEMPTION A
 JOIN TBRNT_LFSTS_CSTMR B ON A.LFSTS_CSTMR_NO = B.LFSTS_CSTMR_NO
 LEFT JOIN TBCOM_CMMN_ATCHMNFL C ON A.FILE_SN = C.FILE_SN
WHERE 1=1
  AND CNTRCTR_NO = #CNTRCTR_NO#
</select>

<!-- 쿼리명 : 전세면제 수정
설명 : 전세면제 수정 쿼리
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.07.01
-->
<update id="RNT030301DAO.exemptionU" parameterClass="java.util.Map">
UPDATE TBRNT_LFSTS_EXEMPTION
   SET RECEP_DE      = #RECEP_DE#
     , DEATH_DATE    = #DEATH_DATE#
     , APPLY_DATE    = #APPLY_DATE#
     , EXEMPTION_RM  = #EXEMPTION_RM#
 WHERE 1=1
   AND CNTRCTR_NO = #CNTRCTR_NO#
   AND CNTRCTR_CO = #CNTRCTR_CO#
</update>

<!-- 쿼리명 : 전세면제 신규
설명 : 전세면제 신규
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 :  2016.07.01
-->
<insert id="RNT030301DAO.exemptionI" parameterClass="java.util.Map">	
INSERT INTO TBRNT_LFSTS_EXEMPTION(
       CNTRCTR_NO
     , CNTRCTR_CO
     , RECEP_DE
     , DEATH_DATE
     , APPLY_DATE
     , LFSTS_CSTMR_NO
     , EXEMPTION_RM
     , REGISTER_ID
     , REGIST_DT
     , UPDUSR_ID
     , UPDT_DT     
     ) VALUES (
       #CNTRCTR_NO#
     , #CNTRCTR_CO#
     , #RECEP_DE#
     , #DEATH_DATE#
     , #APPLY_DATE#
     , #LFSTS_CSTMR_NO#
     , #EXEMPTION_RM#
     , #S_USER_ID#
     , SYSDATE
     , #S_USER_ID#
     , SYSDATE     
     )
</insert>

<!-- 쿼리명 : 전세면제 삭제
설명 : 전세면제 삭제
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2015.06.29
-->	
<delete id="RNT030301DAO.exemptionD" parameterClass="java.util.Map">
DELETE TBRNT_LFSTS_EXEMPTION   
 WHERE 1=1
   AND CNTRCTR_NO = #CNTRCTR_NO#
   AND CNTRCTR_CO = #CNTRCTR_CO#   
</delete>

<!-- 쿼리명 : 전세면제 파일첨부
설명 : 파일 첨부
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 :  2016.07.01
-->
<insert id="RNT030301DAO.atchCUD2" parameterClass="java.util.Map">	
 UPDATE TBRNT_LFSTS_EXEMPTION
    SET FILE_SN = #FILE_SN#
  WHERE 1=1
    AND CNTRCTR_NO = #CNTRCTR_NO#     	 	
</insert>


<!-- 쿼리명 : 전자결재 상태
설명 : 전자결재 상태 조회
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2016.07.25
-->	
<select id="RNT030301DAO.sancKnd" parameterClass="java.util.Map" resultClass="java.util.HashMap">

SELECT SFCOM_GET_DRFTSTS(#SANCTN_NO# , TO_DATE(#REGIST_DT#)) AS SANCTN_KND
  FROM DUAL 
</select>

<!-- 쿼리명 : 보증/화재 보험 일괄등록 조회
설명 : 보증/화재 보험 일괄등록 조회
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2016.08.15
-->	
<select id="RNT030301DAO.insrncList" parameterClass="java.util.Map" resultClass="java.util.HashMap">
SELECT 
     A.INSRNC_SE
   , A.CNTRCTR_NO
   , A.CNTRCTR_CO
   , A.CNTRCT_BGNDE
   , A.CNTRCT_ENDDE
   , A.SCRITS_NO
   , A.ENDRS_NO
   , A.MANAGE_NO
   , A.INSRNC_AMOUNT
   , A.RM
   , C.NM
   , D.ZIP
   , D.ADRES
   , D.ADRES_DETAIL
   , B.RE_CNTRCT_CO
 FROM TBRNT_LFSTS_INSRNC A
 JOIN TBRNT_LFSTS_CNTRCT B ON A.CNTRCTR_NO = B.CNTRCTR_NO AND A.CNTRCTR_CO = B.CNTRCT_CO
 JOIN TBRNT_LFSTS_CSTMR C ON B.LFSTS_CSTMR_NO = C.LFSTS_CSTMR_NO
 JOIN TBRNT_LFSTS_HOUSE_CNTRCTR D ON A.CNTRCTR_NO = D.CNTRCTR_NO AND A.CNTRCTR_CO = D.CNTRCTR_CO
WHERE 1=1
  AND INSRNC_SE = #INSRNC_SE#  
  AND SUBSTR(D.SPORT_BGNDE , 1 , 6) BETWEEN #ST_DATE# AND #EN_DATE#
 /* AND SCRITS_NO IS NULL */   
</select>

<!-- 쿼리명 : 보증/화재 보험 일괄등록 조회
설명 : 보증/화재 보험 일괄등록 조회
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2016.08.15
-->	
<update id="RNT030301DAO.insrncU" parameterClass="java.util.Map">
	UPDATE TBRNT_LFSTS_INSRNC
	   SET SCRITS_NO = #SCRITS_NO#
	     , CNTRCT_BGNDE = #CNTRCT_BGNDE#
         , CNTRCT_ENDDE = #CNTRCT_ENDDE#
	 WHERE 1=1
	   AND CNTRCTR_NO = #CNTRCTR_NO#
	   AND CNTRCTR_CO = #CNTRCTR_CO#
	   AND INSRNC_SE = #INSRNC_SE#
</update>

<!-- 쿼리명 : 가상계좌 조회
설명 : 가상계좌 조회
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2016.09.20
-->	
<select id="RNT030301DAO.vacct" parameterClass="java.util.Map" resultClass="java.util.HashMap">

SELECT   JOB_SE
       , CNTRCTR_NO
       , ATCNG_SN
       , ATCNG_REQST_DE
       , ATCNG_CANCL_DE
       , CPTAL_SE
       , BANK_CODE
       , ACNUTNO
       , DPSTR
       , REGISTER_ID
       , REGIST_DT
       , UPDUSR_ID
       , UPDT_DT
       , PAY_SE
  FROM TBPMS_ATCNG
 WHERE JOB_SE = #JOB_SE#
   AND CNTRCTR_NO = #CNTRCTR_NO#

</select>


<!-- 쿼리명 : 지출내역 조회
설명 : 지출내역 조회
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2016.09.22
-->	
<select id="RNT030301DAO.expndtr" parameterClass="java.util.Map" resultClass="java.util.HashMap">

SELECT A.CNTRCTR_NO
     , A.CNTRCT_CO
     , B.NM
     , TO_CHAR (TO_DATE (C.CNTRCT_DE), 'YY.MM.DD') AS CNTRCT_DE
     , TO_CHAR(TO_DATE(C.SPORT_BGNDE), ' YY.MM.DD') || ' ~ ' || TO_CHAR(TO_DATE(SPORT_ENDDE), ' YY.MM.DD') AS SPORT_DATE
     , TO_CHAR(TO_DATE(C.SPORT_BGNDE), ' YY.MM.DD') AS SPORT_BGNDE
     , TO_CHAR(TO_DATE(C.TRNSFRN_DE),'YY.MM.DD') AS TRNSFRN_DE
     , C.ADRES
     , SFCOM_CODE_NM('RNT023' , C.HOUSE_KND , 'CODE_NM') AS HOUSE_KND
     , C.AR||'('|| C.RENT_ROOM_CO ||')' AS AR
     , E.NM AS NM_PSN 
     , G.RPRSNTV
     , NVL((CASE WHEN G.TAXT_SE = '1' THEN F.FEE * 1.1 ELSE F.FEE END),0) AS FEE
     , C.SPORT_AMOUNT
     , SFCOM_CODE_NM('COM021' , F.BANK_CODE , 'CODE_NM') || '(' || DECODE(G.TAXT_SE , '1' , '일반' , '간이' ) ||')' AS BANK_JCFFR 
     , F.ACNUTNO AS ACNUTNO_JCFFR
     , SFCOM_CODE_NM('COM021' , D.BANK_CODE , 'CODE_NM') AS BANK_PSN 
     , D.ACNUTNO AS ACNUTNO_PSN 
  FROM TBRNT_LFSTS_CNTRCT A
  JOIN TBRNT_LFSTS_CSTMR B ON A.LFSTS_CSTMR_NO = B.LFSTS_CSTMR_NO
  JOIN TBRNT_LFSTS_HOUSE_CNTRCTR C ON A.CNTRCTR_NO = C.CNTRCTR_NO AND A.CNTRCT_CO = C.CNTRCTR_CO
  JOIN TBRNT_LFSTS_RENT_PSN D ON A.CNTRCTR_NO = D.CNTRCTR_NO AND A.CNTRCT_CO = D.CNTRCTR_CO
  JOIN TBRNT_LFSTS_CSTMR E ON D.LFSTS_CSTMR_NO = E.LFSTS_CSTMR_NO
  JOIN TBRNT_LFSTS_MDIATN_JCFFR F ON A.CNTRCTR_NO = F.CNTRCTR_NO AND A.CNTRCT_CO = F.CNTRCTR_CO AND MDIATN_JCFFR_SE = '002'
  JOIN TBRNT_LFSTS_MDIATN_JCFFR_INFO G ON F.MDIATN_JCFFR_CODE = G.MDIATN_JCFFR_CODE
 WHERE 1=1
   AND A.CNTRCTR_NO = #CNTRCTR_NO#   
   AND A.CNTRCT_CO = #CNTRCT_CO#

</select>


<!--  지출결의번호 , 결의년도 업데이트 -->
	<update id="RNT030301DAO.updateExpndtrDecsnNo" parameterClass="java.util.Map">
	
	
		UPDATE TBRNT_LFSTS_HOUSE_CNTRCTR SET
		<isEqual property="DECSN_GB" compareValue="1">
			 DECSN_YEAR = #DSNMASTR.DECSN_YEAR#
			,EXPNDTR_DECSN_NO  	= #DSNMASTR.DECSN_NO#
		</isEqual>
		<isEqual property="DECSN_GB" compareValue="2">
			 DECSN_YEAR2 = #DSNMASTR.DECSN_YEAR#
			,EXPNDTR_DECSN_NO2  	= #DSNMASTR.DECSN_NO#
		</isEqual>	
		WHERE CNTRCTR_NO = #CNTRCTR_NO#
		  AND CNTRCTR_CO = #CNTRCT_CO#
		  
		  
	</update>

<!-- 쿼리명 : 명의변경 건수 조회
설명 : 명의변경 건수 조회
수정일  수정자  수정내용

작성자 : 이광원
최초작성일 : 2016.09.22
-->	
<select id="RNT030301DAO.changeCNT" parameterClass="java.util.Map" resultClass="java.util.HashMap">
	SELECT COUNT(*) AS CNT
	  FROM TBRNT_LFSTS_NM_CHANGE
	 WHERE CNTRCTR_NO = #CNTRCTR_NO#
</select>
</sqlMap>