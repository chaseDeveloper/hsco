<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="SLS020208_SQL">
<typeAlias alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>	

	<!-- 쿼리명 : 계약상세 조회
	설명 : 계약상세 조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 최승락
	최초작성일 : 2015.08.18
	-->
	<select id="SLS020208DAO.selectHcntrctrInfo" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[
			WITH tab_01
         AS (SELECT t2.house_cstmr_no AS cntrctr_cstmr_no,
                    t2.cstmr_nm AS cntrctr_nm,
                    t2.cntrctr_ihidnum,
                    t2.cstmr_nm,
                    t2.ihidnum,
                    t2.zip,
                    t2.adres,
                    t2.adres_detail,
                    t2.telno,
                    t2.mbtlno,
                    t2.email,
                    t2.cntrctr_no,
                    t1.house_code,
                    t1.ho,
                    t1.dong,
                    t2.house_cstmr_no,
                    t2.bdnbr,
                    t2.etc_cttpc,
                    t2.rqest_estbs_dm,
                    t2.zip_dm,
                    t2.bdnbr_dm,
                    t2.bass_adres_dm,
                    t2.detail_adres_dm,
                    t2.cntrctr_sttus_code,
                    t2.lttot_qualf_se,
                    t2.rent_qualf_se,
                    t2.cntrct_de,
                    t2.ctrtc_file_cours,
                    t2.ctrtc_file,
                    t2.rent_bgnde,
                    t2.rent_endde,
                    t2.rent_mvn_prarnde,
                    t2.rent_mvn_time,
                    t2.rent_lvhs_de,
                    t2.rent_lttot_cnvrs_de,
                    t2.vat_at,
                    t2.resale_at,
                    t2.nmchange_cnnc_code,
                    t2.cancl_de,
                    t2.rm,
                    t2.biz_owner_name,
                    t2.HOUSE_POSESN_AT,
                    t2.TRANSFE_AT,  
                    t1.FLOOR,
                    t1.house_ty_code,
                    t1.lttot_ty_code,
                    t1.rent_ty_code,
                    t1.bass_lttot_amount,
                    t1.bass_gtn,
                    t1.bass_rntchrg,
                    t1.lttot_amount,
                    t1.rntchrg,
                    t1.gtn,
                     t2.FILE_SN,
                    (SELECT house_nm
                       FROM tbsls_house_info
                      WHERE house_code = t1.house_code)
                       AS house_nm,
                    (SELECT resci_resn_code
                       FROM tbsls_hcntrctr_cancl
                      WHERE cntrctr_no = t2.cntrctr_no)
                       AS resci_resn_code,
	                (SELECT aea
	                   FROM tbsls_house_ty
	                  WHERE     house_code = t1.house_code
	                        AND house_ty_code = t1.house_ty_code)
	                   AS aea,                        
                    (SELECT suply_amount
                       FROM tbsls_house_ty
                      WHERE     house_code = t1.house_code
                            AND house_ty_code = t1.house_ty_code)
                       AS suply_amount,
                    (SELECT plot_ct
                       FROM tbsls_house_ty
                      WHERE     house_code = t1.house_code
                            AND house_ty_code = t1.house_ty_code)
                       AS plot_ct,
                    (SELECT bildng_ct
                       FROM tbsls_house_ty
                      WHERE     house_code = t1.house_code
                            AND house_ty_code = t1.house_ty_code)
                       AS bildng_ct
               FROM tbsls_house_dong_ho t1,
                    (SELECT t1.house_cstmr_no AS cntrctr_cstmr_no,
                            t1.cstmr_nm AS cntrctr_nm,
                            sfcom_dec_all (t1.ihidnum) AS cntrctr_ihidnum,
                            t1.cstmr_nm,
                            sfcom_dec_all (t1.ihidnum) AS ihidnum,
                            t1.zip,
                            t1.adres,
                            t1.adres_detail,
                            t1.telno,
                            t1.mbtlno,
                            t1.email,
                            t2.cntrctr_no,
                            t2.house_code,
                            t2.ho,
                            t2.dong,
                            t2.house_cstmr_no,
                            t2.bdnbr,
                            t1.etc_cttpc,
                            t2.rqest_estbs_dm,
                            t2.zip_dm,
                            t2.bdnbr_dm,
                            t2.bass_adres_dm,
                            t2.detail_adres_dm,
                            t2.cntrctr_sttus_code,
                            t2.lttot_qualf_se,
                            t2.rent_qualf_se,
                            t2.cntrct_de,
                            t2.ctrtc_file_cours,
                            t2.ctrtc_file,
                            t2.rent_bgnde,
                            t2.rent_endde,
                            t2.rent_mvn_prarnde,
                            t2.rent_mvn_time,
                            t2.rent_lvhs_de,
                            t2.rent_lttot_cnvrs_de,
                            t2.FILE_SN,
                            t2.vat_at,
                            t2.resale_at,
                            t2.nmchange_cnnc_code,
                            t2.cancl_de,
                            t2.rm,
                            t2.biz_owner_name,
                            t2.HOUSE_POSESN_AT,
                            t2.TRANSFE_AT,                            
                            (SELECT resci_resn_code
                               FROM tbsls_hcntrctr_cancl
                              WHERE cntrctr_no = t2.cntrctr_no)
                               AS resci_resn_code
                       FROM tbsls_house_cstmr t1, tbsls_hcntrctr t2
                      WHERE     t1.house_cstmr_no = t2.house_cstmr_no
                    ]]>
                    	<isEqual property="CNTRCTR_STTUS_CODE" compareValue="01">
                            AND t2.cancl_de IS NULL          
                        </isEqual>
                        <isEqual property="CNTRCTR_STTUS_CODE" compareValue="02">
                            AND t2.cancl_de IS NOT NULL      
                        </isEqual>
<!--                         <isNotEmpty property="CSTMR_NM">
							AND t1.cstmr_nm LIKE '%' || #CSTMR_NM# || '%'
						</isNotEmpty> -->
			            <isNotEmpty property="CNTRCTR_NO">
			               AND t2.CNTRCTR_NO = #CNTRCTR_NO#
			            </isNotEmpty>						                   
                   <![CDATA[
                                                       ) t2
              WHERE     t1.house_code = t2.house_code(+)
                    AND t1.dong = t2.dong(+)
                    AND t1.ho = t2.ho(+)),
         tab_02
	         AS (SELECT t1.house_cstmr_no AS cntrctr_cstmr_no,
	                t1.house_cstmr_no_sub AS spouse_cstmr_no,
	                t2.cstmr_nm AS spouse_nm,
	                sfcom_dec_all (t2.ihidnum) AS spouse_ihidnum
	           FROM tbsls_hcntrctr t1, tbsls_house_cstmr t2
	          WHERE     t1.house_cstmr_no_sub = t2.house_cstmr_no)
	          
         /* 계약자2 수정 */
         /* AS (SELECT t1.cntrctr_cstmr_no,
                    t1.family_sn,
                    t1.family_relate,
                    t1.cntrctr_relate,
                    t1.house_cstmr_no AS spouse_cstmr_no,
                    t2.cstmr_nm AS spouse_nm,
                    sfcom_dec_all (t2.ihidnum) AS spouse_ihidnum
               FROM tbsls_hcntrctr_family t1, tbsls_house_cstmr t2
              WHERE     t1.house_cstmr_no = t2.house_cstmr_no
                    AND t1.family_relate IN ('005', '006'))*/
    SELECT a.cntrctr_cstmr_no,
           a.cntrctr_nm,
           a.cntrctr_ihidnum,
           a.cstmr_nm,
           a.ihidnum,
           a.zip,
           a.adres,
           a.adres_detail,
           a.telno,
           a.mbtlno,
           a.email,
           a.cntrctr_no,
           a.aea,
           SFSLS_HOUSE_NM(a.house_code, 'ALL_HOUSE_NM') AS ALL_CODE_NM,   		
           a.house_code,
           a.ho,
           a.dong,
           a.house_cstmr_no,
           a.bdnbr,
           a.etc_cttpc,
           a.rqest_estbs_dm,
           a.zip_dm,
           a.bdnbr_dm,
           a.bass_adres_dm,
           a.detail_adres_dm,
           a.cntrctr_sttus_code,
           a.lttot_qualf_se,
           a.rent_qualf_se,
           a.cntrct_de,
           a.ctrtc_file_cours,
           a.ctrtc_file,
           a.rent_bgnde,
           a.rent_endde,
           a.rent_mvn_prarnde,
           a.rent_mvn_time,
           a.rent_lvhs_de,
           a.rent_lttot_cnvrs_de,
           a.vat_at,
           a.resale_at,
           a.nmchange_cnnc_code,
           a.cancl_de,
           a.rm,
           a.biz_owner_name,
           a.HOUSE_POSESN_AT,
           a.TRANSFE_AT,             
           a.FLOOR,
           a.house_ty_code,
           a.lttot_ty_code,
           a.rent_ty_code,
           a.bass_lttot_amount,
           a.bass_gtn,
           a.bass_rntchrg,
			(SELECT NVL(SUM(PAYAMT), 0)              
			    FROM TBSLS_HOUSE_LTTOT_PAY
			   WHERE CNTRCTR_NO = a.CNTRCTR_NO     
			     AND LTTOT_RENT_SE = 'R'              
			     AND RCIV_DE IS NOT NULL              
			 ) AS RCIV_AMOUNT,
			(SELECT NVL(SUM(PAYAMT), 0) 
			    FROM TBSLS_HOUSE_LTTOT_PAY
			   WHERE CNTRCTR_NO    = a.CNTRCTR_NO     
			     AND LTTOT_RENT_SE = 'R'              
			     AND RCIV_DE IS NULL              
			 ) AS NPYAMOUNT, 
			(SELECT NVL (RNTCHRG, 0)
			  FROM TBSLS_HOUSE_RNTCHRG
			 WHERE     CNTRCTR_NO = a.CNTRCTR_NO
			       AND APPLC_DE = (SELECT MAX (APPLC_DE)
			                         FROM TBSLS_HOUSE_RNTCHRG
			                        WHERE CNTRCTR_NO = a.CNTRCTR_NO)
			                     ) AS MT_RNTCHRG,           /* 월임대료  */                
           a.lttot_amount,
           a.rntchrg,
           a.gtn,
           a.house_nm,
           a.suply_amount,
           a.plot_ct,
           a.bildng_ct,
           (SELECT CASE
                      WHEN t.lttot_cnvrs_se IN ('01') THEN '분향전환대기'
                      WHEN t.lttot_cnvrs_se IN ('02') THEN '분양전환'
                      WHEN t.house_se IN ('S1', 'S3', 'S5', 'S9') THEN '분양'
                      WHEN t.house_se IN ('S2', 'S4') THEN '임대'
                      ELSE '영구임대'
                   END
                      AS house_se_nm
              FROM tbsls_house_info t
             WHERE t.house_code = a.house_code)
              AS house_se_nm,
           (SELECT MAX ('자동이체')
              FROM tbsls_house_setle_info s
             WHERE s.cntrctr_no = a.cntrctr_no AND s.setle_se = '02')
              AS auto_chk,
           b.spouse_cstmr_no,
           b.spouse_nm,
           b.spouse_ihidnum,
           a.FILE_SN,
           /* b.family_sn,
           b.family_relate, */
           /* (SELECT file_sn
              FROM tbcom_cmmn_atchmnfl z
             WHERE     TO_CHAR (file_sn) = a.ctrtc_file
                   AND TO_CHAR (file_ordr) = a.ctrtc_file_cours)
              file_sn,*/
           (SELECT file_ordr
              FROM tbcom_cmmn_atchmnfl z
             WHERE     TO_CHAR (file_sn) = a.FILE_SN
                   AND TO_CHAR (file_ordr) = '1')
              file_ordr,
           (SELECT file_extsn
              FROM tbcom_cmmn_atchmnfl z
             WHERE     TO_CHAR (file_sn) = a.ctrtc_file
                   AND TO_CHAR (file_ordr) = a.ctrtc_file_cours)
              file_extsn,
           (SELECT stre_file_nm
              FROM tbcom_cmmn_atchmnfl z
             WHERE     TO_CHAR (file_sn) = a.ctrtc_file
                   AND TO_CHAR (file_ordr) = a.ctrtc_file_cours)
              stre_file_nm,
           (SELECT orginl_file_nm
              FROM tbcom_cmmn_atchmnfl z
             WHERE     TO_CHAR (file_sn) = a.ctrtc_file
                   AND TO_CHAR (file_ordr) = a.ctrtc_file_cours)
              orginl_file_nm,
           (SELECT REGEXP_SUBSTR (file_ty,
                                  '[^/]+',
                                  1,
                                  1)
              FROM tbcom_cmmn_atchmnfl z
             WHERE     TO_CHAR (file_sn) = a.ctrtc_file
                   AND TO_CHAR (file_ordr) = a.ctrtc_file_cours)
              file_ty
              , nvl((select count(1) from va_receipt v where v.crt_id = a.cntrctr_no),0) 
              + nvl((select count(1) from tbsls_house_rciv_pstmrk v where v.cntrctr_no = a.cntrctr_no),0)
                as rec_cnt
      FROM tab_01 a, tab_02 b
     WHERE     1 = 1
    ]]>
           AND a.cntrctr_cstmr_no = b.cntrctr_cstmr_no(+)
          <isNotEmpty property="HOUSE_CODE">
           AND a.house_code = #HOUSE_CODE#
          </isNotEmpty>
          <isNotEmpty property="DONG">
           AND a.dong = #DONG#
          </isNotEmpty>
          <isNotEmpty property="HO">
           AND a.ho = #HO#
          </isNotEmpty>
           
	</select>
	
	
	<!-- 압류/대출/국민주택기금 정보  2016.03.08 -->
	<select id="SLS020208DAO.selectHcntrctrInfo2" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">	
		SELECT *
			  FROM (SELECT '1' AS F_LINK
			              ,MAX(CDIT_GRNTE_BANK) AS F_CDIT_GRNTE_BANK
			              ,MAX(TRNSFR_DE) AS F_TRNSFR_DE
			              ,SUM(CDIT_TRNSFR_AMOUNT) AS F_CDIT_TRNSFR_AMOUNT
			              ,TO_CHAR(SUM(CDIT_TRNSFR_AMOUNT), '999G999G999') AS F_CDIT_TRNSFRS_AMOUNT
			          FROM TBSLS_HCNTRCTR_LON /* 주택계약자대출 */
			         WHERE CNTRCTR_NO = #CNTRCTR_NO#
			           AND RELIS_DE IS NULL) A
			      ,(SELECT '1' AS F_LINK
			              ,MAX(CRDTR_NM) AS F_CRDTR_NM
			              ,MAX(CDIT_DECSN_DE) AS F_CDIT_DECSN_DE
			              ,SUM(DET_AMOUNT) AS F_DET_AMOUNT
			              ,TO_CHAR(SUM(DET_AMOUNT), '999G999G999') AS F_DETS_AMOUNT
			          FROM TBSLS_HCNTRCTR_SEIZR /* 주택계약자압류 */
			         WHERE CNTRCTR_NO = #CNTRCTR_NO#
			           AND RELIS_DE IS NULL) B
			      ,(SELECT '1' AS F_LINK
			              ,MAX(ALTRV_LON_DE) AS F_ALTRV_LON_DE
			              ,SUM(KJF) AS F_KJF_AMT
			              ,TO_CHAR(SUM(KJF), '999G999G999') AS F_KJFS_AMT
			          FROM TBSLS_HCNTRCTR_KJF_PAY_CNFIRM /* 주택계약자국민주택기금납부확인 */  
			         WHERE CNTRCTR_NO = #CNTRCTR_NO#) C
			
			 WHERE A.F_LINK = B.F_LINK
			   AND A.F_LINK = C.F_LINK    		
	</select>
	
		
	<!-- 계약번호  -->
	<select id="SLS020208DAO.selectCntrctrNo" parameterClass="java.util.Map" resultClass="String">	
		SELECT SUBSTR(NVL(MAX(CNTRCTR_NO),#HOUSE_CODE#),1,3)||LPAD(NVL(SUBSTR(MAX(CNTRCTR_NO),4,5),0)+1,5,0)||'01' AS CNTRCTR_NO
		  FROM TBSLS_HCNTRCTR
         WHERE 1 = 1
           AND HOUSE_CODE = #HOUSE_CODE#           		
	</select>
	

	<!-- 쿼리명 : 계약정보 입력
	설명 : 계약정보 입력 쿼리
	수정일  수정자  수정내용
	
	작성자 : 최승락
	최초작성일 : 2015.08.27
	-->
	<insert id="SLS020208DAO.insertHcntrctrInfo" parameterClass="java.util.Map">
		INSERT INTO TBSLS_HCNTRCTR
		(
			  CNTRCTR_NO
			, HOUSE_CODE
			, HO
			, DONG
			, HOUSE_CSTMR_NO
			, BDNBR						/* 건물번호 */		
			, RQEST_ESTBS_DM            /* 청구설정_DM */
			, ZIP_DM
			, BDNBR_DM                  /*건물번호_DM*/
			, BASS_ADRES_DM
			, DETAIL_ADRES_DM
			, CNTRCTR_STTUS_CODE
			, LTTOT_QUALF_SE
			, RENT_QUALF_SE
			, CNTRCT_DE
			, CTRTC_FILE_COURS
			, CTRTC_FILE
			, RENT_BGNDE
			, RENT_ENDDE
			, RENT_MVN_PRARNDE
			, RENT_MVN_TIME
			, RENT_LVHS_DE
			, RENT_LTTOT_CNVRS_DE
			, VAT_AT
			, RESALE_AT
			, NMCHANGE_CNNC_CODE
			, CANCL_DE
			, RM
			, BIZ_OWNER_NAME
			, HOUSE_CSTMR_NO_SUB
			, REGISTER_ID
			, REGIST_DT
			, UPDUSR_ID
			, UPDT_DT

			
		)
		VALUES
		(
			  #CNTRCTR_NO#
			, #HOUSE_CODE#
			, #HO#
			, #DONG#
			, #CNTRCTR_CSTMR_NO#
			, #BDNBR#
			, #RQEST_ESTBS_DM#
			, #ZIP_DM#
			, #BDNBR_DM#
			, #BASS_ADRES_DM#
			, #DETAIL_ADRES_DM#
			, #CNTRCTR_STTUS_CODE#
			, #LTTOT_QUALF_SE#
			, #RENT_QUALF_SE#
			, NVL(#CNTRCT_DE#, TO_CHAR(SYSDATE, 'YYYYMMDD'))
			, #CTRTC_FILE_COURS#
			, #CTRTC_FILE#
			, #RENT_BGNDE#
			, #RENT_ENDDE#
			, #RENT_MVN_PRARNDE#
			, #RENT_MVN_TIME#
			, #RENT_LVHS_DE#
			, #RENT_LTTOT_CNVRS_DE#
			, #VAT_AT#
			, #RESALE_AT#
			, #NMCHANGE_CNNC_CODE#
			, #CANCL_DE#
			, #RM#
			, #BIZ_OWNER_NAME#
			, #SPOUSE_CSTMR_NO#
			, #S_USER_ID#
			, SYSDATE
			, #S_USER_ID#
			, SYSDATE
		)
	</insert>
	

	<!-- 쿼리명 : 주택동호 테이블 수정
	설명 : 주택동호 테이블 수정 쿼리
	수정일  수정자  수정내용
	
	작성자 : 최승락
	최초작성일 : 2015.08.27
	-->	
	<update id="SLS020208DAO.updateDongHoInfo" parameterClass="java.util.Map">
		MERGE INTO TBSLS_HOUSE_DONG_HO T1
		USING (
			SELECT MIN(HOUSE_CODE) AS HOUSE_CODE
				 , MIN(DONG) AS DONG
				 , MIN(HO) AS HO
				 , SUM(PAYAMT) AS PAYAMT
			  FROM TBSLS_HOUSE_TYBY_PAY_DETAIL
			 WHERE PAY_CODE LIKE 'R%'
			   AND NVL(OPTN_IEM_AT, 'N') = 'N'
			   AND HOUSE_CODE = #HOUSE_CODE#
			   AND DONG = #DONG#
			   AND HO = #HO#
			) S1
			ON (
					    T1.HOUSE_CODE = S1.HOUSE_CODE
					AND T1.DONG = S1.DONG
					AND T1.HO = S1.HO
				)
		WHEN MATCHED
			THEN
				UPDATE
				SET LTTOT_AMOUNT = S1.PAYAMT
	</update>


	<!-- 쿼리명 : 주택계약자 수정
	설명 : 주택계약자 수정 쿼리
	수정일  수정자  수정내용
	
	작성자 : 최승락
	최초작성일 : 2015.09.01
	-->
	<update id="SLS020208DAO.updateHcntrctrInfo" parameterClass="java.util.Map">
		UPDATE TBSLS_HCNTRCTR
		   SET
			  HOUSE_CSTMR_NO      = #CNTRCTR_CSTMR_NO#
			, BDNBR               = #BDNBR#
			, RQEST_ESTBS_DM      = #RQEST_ESTBS_DM#
			, ZIP_DM              = #ZIP_DM#
			, BDNBR_DM            = #BDNBR_DM#
			, BASS_ADRES_DM       = #BASS_ADRES_DM#
			, DETAIL_ADRES_DM     = #DETAIL_ADRES_DM#
			, CNTRCTR_STTUS_CODE  = #CNTRCTR_STTUS_CODE#
			, LTTOT_QUALF_SE      = #LTTOT_QUALF_SE#
			, RENT_QUALF_SE       = #RENT_QUALF_SE#
			, CNTRCT_DE           = #CNTRCT_DE#
			, CTRTC_FILE_COURS    = #CTRTC_FILE_COURS#
			, CTRTC_FILE          = #CTRTC_FILE#
			, RENT_BGNDE          = #RENT_BGNDE#
			, RENT_ENDDE          = #RENT_ENDDE#
			, RENT_MVN_PRARNDE    = #RENT_MVN_PRARNDE#
			, RENT_MVN_TIME       = #RENT_MVN_TIME#
			, RENT_LVHS_DE        = #RENT_LVHS_DE#
			, RENT_LTTOT_CNVRS_DE = #RENT_LTTOT_CNVRS_DE#
			, VAT_AT              = #VAT_AT#
			, RESALE_AT           = #RESALE_AT#
			, NMCHANGE_CNNC_CODE  = #NMCHANGE_CNNC_CODE#
			, CANCL_DE            = #CANCL_DE#
			, RM                  = #RM#
			, BIZ_OWNER_NAME      = #BIZ_OWNER_NAME#
			, HOUSE_CSTMR_NO_SUB  = #SPOUSE_CSTMR_NO#
			, UPDUSR_ID           = #S_USER_ID#
			, UPDT_DT             = SYSDATE
		 WHERE 1 = 1
		   AND CNTRCTR_NO = #CNTRCTR_NO#
	</update>
	
	<!-- 쿼리명 : 주택기본보증금 , 임대료 수정
	설명 : 주택기본보증금 , 임대료
	수정일  수정자  수정내용
	
	작성자 : 이광원
	최초작성일 : 2016.12.06
	-->
	<update id="SLS020208DAO.updateHcntrctrInfo2" parameterClass="java.util.Map">
		UPDATE TBSLS_HOUSE_DONG_HO
		   SET
			  BASS_LTTOT_AMOUNT   = #BASS_LTTOT_AMOUNT#
			, BASS_RNTCHRG        = #BASS_RNTCHRG#
			, UPDUSR_ID           = #S_USER_ID#
			, UPDT_DT             = SYSDATE
		 WHERE 1 = 1
		   AND HOUSE_CODE = #HOUSE_CODE#
		   AND DONG       = #DONG#
		   AND HO	      = #HO#
	</update>	
	
<!-- 쿼리명     : 주택계약 입주 대기자 수정
	        설명       : 주택계약 입주 대기자 수정 쿼리문
	        작성자     : 정윤원
	        최초작성일 : 2015.10.13

	        수정일  수정자  수정내용
	   -->
	  <update id="SLS020208DAO.updateHouseMvnWaitrList" parameterClass="java.util.Map" >
	    UPDATE TBSLS_HOUSE_MVN_WAITR
          SET DONG                = #DONG#                  /*  동            */
             ,HO                  = #HO#                    /* 호             */
             ,CNTRCT_DE           = #CNTRCT_DE#             /* 계약일자       */
             ,WAIT_PROCESS_SE     = #CNTRCTR_STTUS_CODE#       /* 대기처리구분   */
             ,UPDUSR_ID           = #S_USER_ID#             /* 수정자ID       */
             ,UPDT_DT             = SYSDATE                 /* 수정일시       */
        WHERE 1 = 1
          AND HOUSE_CODE  = #HOUSE_CODE#                    
          AND HOUSE_SN    = #HOUSE_SN#                             
          AND HOUSE_CSTMR_NO  = #HOUSE_CSTMR_NO#                
          AND AEA    = #AEA#                                       
	  </update>	
	
	<!-- 첨부파일 정보 업데이트 -->
	<update id="SLS020208DAO.updateFileInfo" parameterClass="java.util.Map">
		UPDATE TBSLS_HCNTRCTR
		   SET CTRTC_FILE_COURS    = #CTRTC_FILE_COURS#
			, CTRTC_FILE          = #CTRTC_FILE#
			, UPDUSR_ID           = #S_USER_ID#
			, UPDT_DT             = SYSDATE
		 WHERE 1 = 1
		   AND CNTRCTR_NO = #CNTRCTR_NO#
	</update>
		
	
	<!-- 수납정보 존재여부 체크  -->
	<select id="SLS020208DAO.selectExistYn" parameterClass="java.util.Map" resultClass="String">
		SELECT DECODE(COUNT(CNTRCTR_NO),0,'N','Y') AS EXIST_YN
		  FROM TBSLS_HOUSE_LTTOT_PAY 
		 WHERE 1 = 1
		   AND CNTRCTR_NO = #CNTRCTR_NO#
		   AND RCIV_DE IS NOT NULL
	</select>
	
	
	<!-- 쿼리명 : 주택분양납부 테이블 정보 삭제
	설명 : 주택분양납부 테이블 정보를 삭제한다.
	수정일  수정자  수정내용
	
	작성자 : 최승락
	최초작성일 : 2015.09.14
	-->	
	<delete id="SLS020208DAO.deleteHouseLttotPay" parameterClass="java.util.Map">
		DELETE
		  FROM TBSLS_HOUSE_LTTOT_PAY
		 WHERE 1 = 1
		   AND CNTRCTR_NO = #CNTRCTR_NO#
	</delete>
	
	
	
	
	<!-- 쿼리명 : 주택계약자사업자 테이블 정보 삭제
	설명 : 주택계약자사업자 테이블 정보 삭제 쿼리
	수정일  		수정자  	수정내용
	2015.12.08	최승락	최초작성
	작성자 : 최승락
	최초작성일 : 2015.12.08
	-->
	<delete id="SLS020208DAO.deleteHcntrctrBsnm" parameterClass="java.util.Map"> 
		DELETE 
		  FROM TBSLS_HCNTRCTR_BSNM
		 WHERE 1 = 1
		   AND CNTRCTR_NO = #CNTRCTR_NO#
	</delete>
	

	<!-- 쿼리명 : 가상계좌 삭제
	설명 : 가상계좌 정보를 삭제한다.
	수정일  수정자  수정내용
	
	작성자 : 최승락
	최초작성일 : 2015.11.27
	-->	
	<update id="SLS020208DAO.updateVaMast" parameterClass="java.util.Map">
		UPDATE VA_MAST
		   SET CUST_CD = NULL
		 WHERE 1 = 1
		   AND CUST_CD = #CNTRCTR_NO#
	</update>
	

	<!-- 쿼리명 : 주택계약자 삭제
	설명 : 주택계약자 정보를 삭제한다 (계약정보 삭제)
	수정일  수정자  수정내용
	
	작성자 : 최승락
	최초작성일 : 2015.09.03
	-->	
	<delete id="SLS020208DAO.deleteHcntrctr" parameterClass="java.util.Map">
		DELETE 
		  FROM TBSLS_HCNTRCTR
		 WHERE 1 = 1
		   AND CNTRCTR_NO = #CNTRCTR_NO#
	</delete>
		

	<!-- 쿼리명 : 주택분양납부 약정사항(tabpage1) /임대보증금 (tabpage5)조회
	설명 : 주택분양납부 약정사항(tabpage1) /임대보증금 (tabpage5)조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 최승락
	최초작성일 : 2015.08.29
	-->
	<select id="SLS020208DAO.selectHcntrctrPayList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[
			SELECT '0' AS CHK
			      ,T1.CNTRCTR_NO               /* 계약자번호       */
			      ,T1.PAY_NO                   /* 납부번호         */
			      ,T1.PAY_CODE                 /* 납부코드         */
			      ,T1.PAY_SE                   /* 납부구분         */
			      ,T1.PAY_SN                   /* 납부일련번호     */
			      ,T1.PAYAMT                   /* 납부금액         */
			      ,T1.PAY_SUPLY_AMOUNT         /* 납부공급가액     */
			      ,T1.PAY_VAT                  /* 납부부가세       */
			      ,T1.ARRRG_AMOUNT             /* 연체할인이자금액     */
			      ,T1.ARRRG_DSCNT_AMOUNT       /* 선납할인금액     */	
			      ,(NVL(T1.ARRRG_AMOUNT, 0) + NVL(T1.ARRRG_DSCNT_AMOUNT, 0)) AS ARRRG_DSCNT_AMOUNT2	 /* 연체할인금액     */	      
			      ,T1.YRINS_SALE_INTR          /* 연부매각이자     */
			      ,T1.RQEST_YM                 /* 청구년월         */
			      ,T1.PAY_TMLMT                /* 납부기한         */
			      ,T1.PAY_PRARNDE              /* 납부예정일       */
			      ,T1.MDAT_DE                  /* 조정일자         */
			      ,T1.OUTPT_DE                 /* 출력일자         */
			      ,T1.PAYMTHD                  /* 납부방법         */
			      ,T1.PAY_BANK_CODE            /* 납부은행코드     */
			      ,T1.OCR_NO                   /* OCR밴드          */
			      ,T1.LEV_DECSN_NO             /* 징수결의번호     */
			      ,T1.TRMNAT_UNUSED_AT         /* 해지미사용여부   */
			      ,T1.RCIV_DECSN_NO            /* 수납결의번호     */
			      ,T1.LTTOT_RENT_SE            /* 분양임화성분     */
			      ,T1.TMPR_RCIV_AMOUNT         /* 임시수납금액     */
			      ,T1.TMPR_RCIV_NO             /* 임시수납번호     */
			      ,T1.RCIV_DE                  /* 수납일자         */
			      ,T1.RCIV_AMOUNT              /* 수납금액         */
			      ,T1.CNTRCT_ODR               /* 계약차수         */
			      ,T1.POINT_DSCNT_AM           /* 포인트할인액     */
			      ,T1.RM                       /* 비고             */
			      ,T1.ARRRG_DSCNT_SE           /* 연체할인구분     */
			      ,T1.ARRRG_DSCNT_SUPLY_AMOUNT /* 연체할인공급금액 */
			      ,T1.ARRRG_DSCNT_VAT          /* 연체할인부가세   */
			      ,T1.ARRRG_DSCNT_DAYCNT       /* 연체할인일수     */
			      ,T1.ARRRG_DSCNT_INTRT        /* 연체할인이율     */
			      ,T1.RCIV_PREARNGE_DE         /* 수납예정일자     */
			      ,T1.REGISTER_ID              /* 등록자ID         */
			      ,T1.REGIST_DT                /* 등록일시         */
			      ,T1.UPDUSR_ID                /* 수정자ID         */
			      ,T1.UPDT_DT                  /* 수정일시         */
			      ,T1.ELCTRN_SANCTN_NO         /* 전자결재번호     */
			      ,T1.SANCTN_STTUS             /* 결재상태         */
			      ,T1.ARRRG_DSCNT_AMOUNT AS PREPAY_DSCNT_AMOUNT   /* 선납금액         */
                  ,(CASE WHEN RCIV_DE IS NULL THEN (NVL(T1.PAYAMT, 0) + NVL(T1.ARRRG_AMOUNT,0) + NVL(T1.ARRRG_DSCNT_AMOUNT, 0)) ELSE 0 END)  AS UNCLAMT   /* 미수금액         */			      
			      ,(NVL(T1.PAYAMT, 0) + NVL(T1.ARRRG_AMOUNT,0) + NVL(T1.ARRRG_DSCNT_AMOUNT, 0)) AS NPYAMOUNT /* 납부합계 */
			      
			  FROM TBSLS_HOUSE_LTTOT_PAY T1 	/* 주택분양납부 */
			 WHERE 1 = 1
		]]>
			   AND T1.CNTRCTR_NO = #CNTRCTR_NO#   
			<isNotEmpty property="LTTOT_RENT_SE">
			   AND T1.LTTOT_RENT_SE = #LTTOT_RENT_SE#            /* 분양임화성분 - S:분양  R:임대  */
			</isNotEmpty>
			
             ORDER BY T1.PAY_TMLMT, T1.PAY_CODE, T1.PAY_SN				 
	</select>
	
<!-- 주택임대료납부 (tabpage6) 2016.03.08 -->
	<select id="SLS020208DAO.selectHcntrctrRentPay" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[
			SELECT 
                 A.CNTRCTR_NO        /* 계약자번호 */
                ,A.PAY_CODE          /* 납부코드 */
                ,A.PAY_TMLMT         /* 납입기한 */
                ,A.MT_RNTCHRG        /* 월임대료= 납입금액 */
                ,A.ARRRG_AMOUNT      /* 연체이자 */
                ,A.DFNNT_AMOUNT      /* 차액금액 */
                ,A.RCIV_DE           /* 수납일자 */
                ,A.RCIV_AMOUNT       /* 수납금액 */ 
                ,A.CASH_RCIPT_RGSDE  /* 현금영수증등록일 */         
                ,C.CODE_NM
                ,(CASE
                     WHEN A.RCIV_DE IS NULL THEN
                      (A.MT_RNTCHRG + A.ARRRG_AMOUNT + A.DFNNT_AMOUNT)
                     ELSE
                      0
                   END) AS NPYAMOUNT  /* 미수금액 */            
             FROM TBSLS_HOUSE_RENT_PAY A
                , TBSLS_HCNTRCTR B
                , TBCOM_CMMN_CODE C 
             WHERE 1 = 1
               AND A.CNTRCTR_NO = B.CNTRCTR_NO
               AND A.PAY_CODE = C.CODE
               AND C.GRP_CODE = 'HOU0A1'
		]]>
			   AND A.CNTRCTR_NO = #CNTRCTR_NO#
             ORDER BY A.PAY_TMLMT DESC
	</select>	
	
	
	<!-- 주택임대료납부 (tabpage6) 2016.03.08 -->
	<select id="SLS020208DAO.selectHcntrctrRentPayList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[
			SELECT '0' AS CHK
			      ,T1.CNTRCTR_NO               /* 계약자번호         */
			      ,T1.PAY_NO                   /* 납부번호           */
			      ,T1.PAY_CODE                 /* 납부코드           */
			      ,T1.RQEST_YM                 /* 청구년월           */
			      ,T1.MT_RNTCHRG               /* 월임대료           */
			      ,T1.ARRRG_AMOUNT             /* 연체금액           */
			      ,T1.DFNNT_AMOUNT             /* 차액금액           */
			      ,T1.PAY_TMLMT                /* 납부기한           */
			      ,T1.PAY_PRARNDE              /* 납부예정일         */
			      ,T1.CANCL_DE                 /* 해약일자           */
			      ,T1.PAYMTHD                  /* 납부방법           */
			      ,T1.PAY_BANK_CODE            /* 납부은행코드       */
			      ,T1.OCR_NO                   /* OCR밴드            */
			      ,T1.MDAT_DE                  /* 조정일자           */
			      ,T1.LEV_DECSN_NO             /* 징수결의번호       */
			      ,T1.RCIV_DECSN_NO            /* 수납결의번호       */
			      ,T1.LTTOT_RENT_SE            /* 분양임화성분       */
			      ,T1.MDAT_YM                  /* 조정년월           */
			      ,T1.MDAT_SE                  /* 조정구분           */
			      ,T1.TMPR_RCIV_AMOUNT         /* 임시수납금액       */
			      ,T1.TMPR_RCIV_NO             /* 임시수납번호       */
			      ,T1.RCIV_DE                  /* 수납일자           */
			      ,T1.RCIV_AMOUNT              /* 수납금액           */
			      ,T1.OPERT_SE                 /* 작업구분           */
			      ,T1.CASH_RCIPT_RGSDE         /* 현금영수증등록일   */
			      ,T1.CASH_RCIPT_SN            /* 현금영수증일련번호 */
			      ,T1.RM                       /* 비고               */
			      ,T1.ARRRG_DSCNT_SE           /* 연체할인구분       */
			      ,T1.ARRRG_DSCNT_AMOUNT       /* 연체할인금액       */
			      ,T1.ARRRG_DSCNT_SUPLY_AMOUNT /* 연체할인공급금액   */
			      ,T1.ARRRG_DSCNT_VAT          /* 연체할인부가세     */
			      ,T1.ARRRG_DSCNT_DAYCNT       /* 연체할인일수       */
			      ,T1.ARRRG_DSCNT_INTRT        /* 연체할인이율       */
			      ,T1.RCIV_PREARNGE_DE         /* 수납예정일자       */
			      ,T1.REGISTER_ID              /* 등록자ID           */
			      ,T1.REGIST_DT                /* 등록일시           */
			      ,T1.UPDUSR_ID                /* 수정자ID           */
			      ,T1.UPDT_DT                  /* 수정일시           */
			      ,T1.MT_RNTCHRG + T1.ARRRG_AMOUNT + T1.DFNNT_AMOUNT AS TOT_AMOUNT
			      ,(CASE
			         WHEN T1.RCIV_DE IS NULL THEN
			          (T1.MT_RNTCHRG + T1.ARRRG_AMOUNT + T1.DFNNT_AMOUNT)
			         ELSE
			          0
			       END) AS NPYAMOUNT /* 미수금액 */
			      ,T1.RCIV_AMOUNT AS PAYAMT_SUM /* 수납금액 = 납부금액 합 */
			      ,T2.BANK_CODE AS RCIV_BANK_CODE    /* 수납은행 */
			  FROM TBSLS_HOUSE_RENT_PAY T1  	/* 주택임대납부 */
			  		, TBSLS_HOUSE_RCIV_PSTMRK T2
			 WHERE 1 = 1
			   AND T1.CNTRCTR_NO = T2.CNTRCTR_NO(+)
               AND T1.PAY_NO = T2.PAY_NO(+)
		]]>
			   AND T1.CNTRCTR_NO = #CNTRCTR_NO#
             ORDER BY T1.PAY_TMLMT DESC
	</select>


	<!-- 쿼리명 : 공유자(tabpage2) 조회
	설명 : 공유자(tabpage2) 조회 쿼리
	수정일  수정자  수정내용

	작성자 : 최승락
	최초작성일 : 2015.10.04
	-->
	<select id="SLS020208DAO.selectHcntrctrCocnrList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[
			SELECT
				  T2.CSTMR_NM
				, SFCOM_DEC_ALL(T2.IHIDNUM) AS IHIDNUM
				, T2.ZIP
				, T2.ADRES
				, T2.ADRES_DETAIL
				, T2.TELNO
				, T2.MBTLNO
				, T1.RELIS_DE
				, T1.RM
				, T1.HOUSE_CSTMR_NO
				, T1.CNTRCTR_NO
				, T1.COCNR_SN
			  FROM TBSLS_HCNTRCTR_COCNR T1
				, TBSLS_HOUSE_CSTMR T2
			 WHERE 1 = 1
		]]>
			   AND T1.HOUSE_CSTMR_NO = T2.HOUSE_CSTMR_NO
			   AND T1.CNTRCTR_NO = #CNTRCTR_NO#
	</select>


	<!-- 쿼리명 : 사업자(tabpage3) 조회
	설명 : 사업자(tabpage3) 조회 쿼리
	수정일  수정자  수정내용

	작성자 : 최승락
	최초작성일 : 2015.10.04
	-->
	<select id="SLS020208DAO.selectHouseCstmrBsnmList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[
			SELECT 
				  T1.BSNM_SN
				, T1.CNTRCTR_NO
				, T1.BIZRNO
				, T1.MTLTY_NM
				, T2.CSTMR_NM
				, SFCOM_DEC_ALL(T2.IHIDNUM) AS IHIDNUM
				, T1.BIZCND
				, T1.INDUTY
				, T1.BSNS_CONFM_DE     
				, T1.ADRES
			    ,(CASE WHEN T1.USE_AT = 'Y'
		           THEN T1.USE_AT  
		           ELSE 'N'
		       END) AS USE_AT    					
			  FROM TBSLS_HCNTRCTR_BSNM T1
				, TBSLS_HOUSE_CSTMR T2
			 WHERE 1 = 1
		]]>
			   AND T1.HOUSE_CSTMR_NO = T2.HOUSE_CSTMR_NO
			   AND T1.CNTRCTR_NO = #CNTRCTR_NO#
	</select>
	

	<!-- 쿼리명 : 가상계좌(tabpage4) 조회
	설명 : 가상계좌(tabpage4) 조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 최승락
	최초작성일 : 2015.09.07
	-->
	<select id="SLS020208DAO.selectVirtlAcnutList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[
			SELECT 
			       '0' AS CHK
				 , BANK_CD
				 , VACCT_NO
				 , STAT_CD
				 , NVL(OPT1,'0') AS OPT1 /* 입대료지정계좌 */
				 , NVL(OPT2,'0') AS OPT2 /* 보증금지정계좌 */
				 , NVL(OPT3,'0') AS OPT3 /* 주거급여전용계좌 */
				 , LAST_ENTRY
				 , LAST_DATE
			  FROM VA_MAST
			 WHERE 1 = 1
		]]>
			   AND CUST_CD = #CNTRCTR_NO#
	</select>
	
	
	<!-- 공급금액정보(tabpage7) 2016.03.09 -->
	<select id="SLS020208DAO.selectHcntrctrSuplyAmtList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
			
			SELECT A.*, SFCOM_CODE_NM('HOU0A1', A.PAY_CODE, 'ALL_CODE_NM') AS PAY_CODE_NM
			  FROM TBSLS_HOUSE_TYBY_PAY A /* 주택타입별납부 */
			 WHERE HOUSE_CODE = #HOUSE_CODE#
			   AND HOUSE_TY_CODE = #HOUSE_TY_CODE#
			 ORDER BY PAY_NO
			 		
	</select>
	
	
	<!-- 쿼리명 : 납부코드 조회
	설명 : 납부코드 조회 쿼리
	수정일  		수정자  	수정내용
	2015.12.01	최승락	최초작성
	작성자 : 최승락
	최초작성일 : 2015.12.01
	-->
	<select id="SLS020208DAO.selectHouPayCodeList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
			WITH
			TAB_01 AS
			(
			SELECT
				  CODE
				, GRP_CODE_SN
				, CODE_NM
				, '['||CODE||']'||CODE_NM AS ALL_CODE_NM
				, GRP_CODE
				, OLD_GRP_CODE
				, CODE_CN
				, CODE_ORDR
				, CHRCTR_PREPAR_VALUE_0
				, CHRCTR_PREPAR_VALUE_1
				, CHRCTR_PREPAR_VALUE_2
				, CHRCTR_PREPAR_VALUE_3
				, CHRCTR_PREPAR_VALUE_4
				, INTGR_PREPAR_VALUE
				, MSTK_PREPAR_VALUE
				, CODE_ETC_1
				, CODE_ETC_2
				, CODE_ETC_3
				, USE_AT
			  FROM TBCOM_CMMN_CODE
			 WHERE 1 = 1
			 <isNotEmpty property="GRP_CODE">
			   AND GRP_CODE = #GRP_CODE#
			 </isNotEmpty>
			 <isNotEmpty property="CHRCTR_PREPAR_VALUE_1">
			   AND CHRCTR_PREPAR_VALUE_1 = #CHRCTR_PREPAR_VALUE_1#
			 </isNotEmpty>
			 <isNotEmpty property="USE_AT">
			   AND USE_AT = #USE_AT#
			 </isNotEmpty>
			)
			,
			TAB_02 AS
			(
			SELECT
				  #CNTRCTR_NO# AS CNTRCTR_NO
				, W1.HOUSE_CODE
				, W1.DONG
				, W1.HO
				, W1.HOUSE_TY_CODE
				, W1.PAY_CODE
				, '0' AS PAY_SE
				, '0' AS PAY_SN
				, W1.PAY_TMLMT
				, W1.PAY_TMLMT AS PAY_PRARNDE
				, W1.PAYAMT
				, W1.PAYAMT AS NPYAMOUNT
			  FROM TBSLS_HOUSE_TYBY_PAY_DETAIL W1
			 WHERE 1 = 1
			 <isNotEmpty property="HOUSE_CODE">
			   AND W1.HOUSE_CODE = #HOUSE_CODE#
			 </isNotEmpty>
			 <isNotEmpty property="DONG">
			   AND W1.DONG = #DONG#
			 </isNotEmpty>
			 <isNotEmpty property="HO">
			   AND W1.HO = #HO#
			 </isNotEmpty>
			   AND NVL(W1.OPTN_IEM_AT, '0') = '0'
			   AND W1.PAY_CODE NOT IN ('D1', 'D2', 'D3')
			)
			SELECT
				  T1.CODE
				, T1.GRP_CODE_SN
				, T1.CODE_NM
				, T1.ALL_CODE_NM
				, T1.GRP_CODE
				, T1.OLD_GRP_CODE
				, T1.CODE_CN
				, T1.CODE_ORDR
				, T1.CHRCTR_PREPAR_VALUE_0
				, T1.CHRCTR_PREPAR_VALUE_1
				, T1.CHRCTR_PREPAR_VALUE_2
				, T1.CHRCTR_PREPAR_VALUE_3
				, T1.CHRCTR_PREPAR_VALUE_4
				, T1.INTGR_PREPAR_VALUE
				, T1.MSTK_PREPAR_VALUE
				, T1.CODE_ETC_1
				, T1.CODE_ETC_2
				, T1.CODE_ETC_3
				, T1.USE_AT
				, T2.CNTRCTR_NO
				, T2.HOUSE_CODE
				, T2.DONG
				, T2.HO
				, T2.HOUSE_TY_CODE
				, T2.PAY_CODE
				, T2.PAY_SE
				, T2.PAY_SN
				, T2.PAY_TMLMT
				, T2.PAY_PRARNDE
				, T2.PAYAMT
				, T2.NPYAMOUNT
			  FROM TAB_01 T1
				, TAB_02 T2
			 WHERE 1 = 1
			   AND T1.CODE = T2.PAY_CODE(+)
			 ORDER BY T1.CODE_ORDR
	</select>
	
	<!-- 쿼리명 : 기준정보 조회
	설명 : 기준정보 조회 쿼리
	수정일  		수정자  	수정내용
	2015.12.01	최승락	최초작성
	작성자 : 최승락
	최초작성일 : 2015.12.01
	-->
	<select id="SLS020208DAO.selectHouPayBaisList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[
			SELECT
			      '0' AS CHK
				, T1.CNTRCTR_NO
				, T1.PAY_NO
				, T1.PAY_CODE
				, T1.PAY_SE
				, T1.PAY_SN
				, T1.PAYAMT
				, T1.PAY_SUPLY_AMOUNT
				, T1.PAY_VAT
				, T1.ARRRG_AMOUNT
				, T1.YRINS_SALE_INTR
				, T1.RQEST_YM
				, T1.PAY_TMLMT
				, T1.PAY_PRARNDE
				, T1.MDAT_DE
				, T1.OUTPT_DE
				, T1.PAYMTHD
				, T1.PAY_BANK_CODE
				, T1.OCR_NO
				, T1.LEV_DECSN_NO
				, T1.TRMNAT_UNUSED_AT
				, T1.RCIV_DECSN_NO
				, T1.LTTOT_RENT_SE
				, T1.TMPR_RCIV_AMOUNT
				, T1.TMPR_RCIV_NO
				, T1.RCIV_DE
				, T1.RCIV_AMOUNT
				, T1.CNTRCT_ODR
				, T1.POINT_DSCNT_AM
				, T1.RM
				, T1.ARRRG_DSCNT_SE
				, T1.ARRRG_DSCNT_AMOUNT
				, T1.ARRRG_DSCNT_SUPLY_AMOUNT
				, T1.ARRRG_DSCNT_VAT
				, T1.ARRRG_DSCNT_DAYCNT
				, T1.ARRRG_DSCNT_INTRT
				, T1.RCIV_PREARNGE_DE
				, T1.REGISTER_ID
				, T1.REGIST_DT
				, T1.UPDUSR_ID
				, T1.UPDT_DT
				, (
					 CASE
						WHEN T1.RCIV_DE IS NULL
						THEN (NVL(T1.PAYAMT,0) + NVL(T1.ARRRG_AMOUNT,0) + NVL(YRINS_SALE_INTR,0) + NVL(POINT_DSCNT_AM, 0))
						ELSE 0
						END
				  ) AS NPYAMOUNT
				 , T2.HOUSE_CODE
				 , T2.DONG
				 , T2.HO
			  FROM TBSLS_HOUSE_LTTOT_PAY T1
			     , TBSLS_HCNTRCTR T2
			 WHERE 1 = 1
		]]>
		       AND T1.CNTRCTR_NO = T2.CNTRCTR_NO
			   AND T1.CNTRCTR_NO = #CNTRCTR_NO#
			   AND T1.LTTOT_RENT_SE = 'S'
			   AND T1.RCIV_DE IS NULL
			 ORDER BY T1.PAY_TMLMT , T1.PAY_CODE, T1.PAY_SN
	</select>


	<!-- 주택분양납부 삭제여부 체크 -->
	<select id="SLS020208DAO.selectHouseLttotPayExistYn" parameterClass="java.util.Map" resultClass="String">
		SELECT DECODE(COUNT(*), 0, 'N', 'Y') AS EXIST_YN
		  FROM TBSLS_HOUSE_LTTOT_PAY
		 WHERE 1 = 1
			 AND CNTRCTR_NO = #CNTRCTR_NO#
			 AND LTTOT_RENT_SE = 'S'
			 AND RCIV_DE IS NULL
	</select>
	
	
	<!-- 쿼리명 : 기준정보 삭제
	설명 : 기준정보 삭제 쿼리
	수정일  		수정자  	수정내용
	2015.12.01	최승락	최초작성
	작성자 : 최승락
	최초작성일 : 2015.12.01
	-->
	<delete id="SLS020208DAO.deleteHouPayBaisList" parameterClass="java.util.Map">
		DELETE 
		  FROM TBSLS_HOUSE_LTTOT_PAY 
		 WHERE 1 = 1
		   AND CNTRCTR_NO = #CNTRCTR_NO#
		   AND PAY_NO = #PAY_NO#
		   AND LTTOT_RENT_SE = 'S'
		   AND RCIV_DE IS NULL
	</delete>


	<!-- 쿼리명 : 기준정보 생성
	설명 : 기준정보 조회 쿼리
	수정일  		수정자  	수정내용
	2015.11.30	최승락	최초작성
	작성자 : 최승락
	최초작성일 : 2015.11.30
	-->
	<select id="SLS020208DAO.selectCreatHouPayBaisList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[
			SELECT
			       R1.CNTRCTR_NO  				/* 계약번호 */
			     , NULL AS PAY_NO               /* 납부번호 */               
	  			 , R1.HOUSE_CODE				/* 주택코드 */
				 , R1.DONG						/* 동 */
				 , R1.HO						/* 호 */
				 , R1.HOUSE_TY_CODE				/* 주택코드 */
				 , MAX(R1.PAY_CODE) AS PAY_CODE	/* 납부코드 */
				 , R1.PAY_SE					/* 납부구분 */
				 , R1.PAY_SN             		/* 납부순번 */
				 , R1.PAY_TMLMT					/* 납부기한일 */
				 , R1.PAY_TMLMT AS PAY_PRARNDE	/* 납부에정일 */
				 , SUM(R1.PAYAMT) AS PAYAMT		/* 납부금액 */
				 , SUM(R1.PAYAMT) AS NPYAMOUNT	/* 미납금액 */
				 , NULL AS RM					/* 비고 */
				 , MAX(PAY_NO) AS REC_SEQ       /* 회수 */			
			  FROM (
					SELECT
					      #CNTRCTR_NO# AS CNTRCTR_NO
						, T1.HOUSE_CODE
						, T1.HOUSE_TY_CODE
						, T1.PAY_CODE
						, T1.PAY_NO
						, T1.DONG
						, T1.HO
						, '0' AS PAY_SE				
						, '0' AS PAY_SN
						, CASE
							WHEN SUBSTR(T1.PAY_TMLMT, 1, 4) = '1899'
								THEN TO_CHAR(SYSDATE,'YYYYMMDD')
							WHEN SUBSTR(T1.PAY_TMLMT, 1, 4) = '1900'
								THEN NULL
							WHEN T1.PAY_TMLMT < TO_CHAR(SYSDATE,'YYYYMMDD')
								THEN CASE
									WHEN #RETN# = '1'
										THEN T2.MAX_DATE
									ELSE (
											CASE
												WHEN T1.HOUSE_CODE IN ('135', '136', '137', '911')  /* 911 삭제 테스트코드 */
													THEN T2.MIN_DATE
												ELSE T2.MAX_DATE
												END
											)
									END
							ELSE T1.PAY_TMLMT
							END AS PAY_TMLMT
						, DECODE(#RENT_QUALF_SE#,'28', T1.INHBTNT_PAYAMT, T1.PAYAMT) AS PAYAMT
					FROM TBSLS_HOUSE_TYBY_PAY_DETAIL T1
						, (
						SELECT
							  S1.HOUSE_CODE
							, S1.DONG
							, S1.HO
							, MAX(CASE
									WHEN SUBSTR(S1.PAY_TMLMT,1,4) = '1899'
										THEN TO_CHAR(SYSDATE, 'YYYYMMDD')
									WHEN S1.PAY_TMLMT < TO_CHAR(SYSDATE, 'YYYYMMDD')
										THEN NULL
									ELSE S1.PAY_TMLMT
									END) AS MAX_DATE
							, MIN(CASE
									WHEN S1.PAY_TMLMT < TO_CHAR(SYSDATE, 'YYYYMMDD')
										THEN NULL
									ELSE S1.PAY_TMLMT
									END) AS MIN_DATE
							FROM TBSLS_HOUSE_TYBY_PAY_DETAIL S1
						WHERE 1 = 1
		]]>
						   <isNotEmpty property="HOUSE_CODE">
							AND S1.HOUSE_CODE = #HOUSE_CODE#
						   </isNotEmpty>
						   <isNotEmpty property="DONG">
							AND S1.DONG = #DONG#
						   </isNotEmpty>
						   <isNotEmpty property="HO">
							AND S1.HO = #HO#
						   </isNotEmpty>
						   <isNotEmpty property="HOUSE_TY_CODE">
							AND S1.HOUSE_TY_CODE = #HOUSE_TY_CODE#
						   </isNotEmpty>
							AND NVL(S1.OPTN_IEM_AT, '0') = '0'
							AND S1.PAY_CODE NOT IN ('D1', 'D2', 'D3')
						GROUP BY S1.HOUSE_CODE, S1.DONG, S1.HO
						) T2
					WHERE 1 = 1
					AND T1.HOUSE_CODE = T2.HOUSE_CODE
					AND T1.DONG = T2.DONG
					AND T1.HO = T2.HO
				   <isNotEmpty property="HOUSE_CODE">
					AND T1.HOUSE_CODE = #HOUSE_CODE#
				   </isNotEmpty>
				   <isNotEmpty property="DONG">
					AND T1.DONG = #DONG#
				   </isNotEmpty>
				   <isNotEmpty property="HO">
					AND T1.HO = #HO#
				   </isNotEmpty>
				   <isNotEmpty property="HOUSE_TY_CODE">
					AND T1.HOUSE_TY_CODE = #HOUSE_TY_CODE#
				   </isNotEmpty>
					AND NVL(T1.OPTN_IEM_AT, '0') = '0'
					AND T1.PAY_CODE NOT IN ('D1', 'D2', 'D3')
				  ) R1
			 GROUP BY R1.CNTRCTR_NO, R1.HOUSE_CODE, R1.DONG, R1.HO, R1.HOUSE_TY_CODE, R1.PAY_TMLMT, R1.PAY_SN
			 ORDER BY PAY_TMLMT, PAY_CODE, REC_SEQ
	</select>
	
	
	<!-- 쿼리명 : 기준정보 입력
	설명 : 기준정보 입력 쿼리
	수정일		수정자  	수정내용
	2015.11.30	최승락	최초작성
	작성자 : 최승락
	최초작성일 : 2015.11.30
	-->	
	<update id="SLS020208DAO.updateHouPayBaisList" parameterClass="java.util.Map">
		MERGE INTO TBSLS_HOUSE_LTTOT_PAY
		USING DUAL
			ON (
				CNTRCTR_NO = #CNTRCTR_NO#
				AND PAY_NO = #PAY_NO#
			   )
		WHEN MATCHED
			THEN
				UPDATE
				SET
				   PAY_CODE = #PAY_CODE#
				 , PAY_SE = #PAY_SE#
				 , PAY_SN = #PAY_SN#
				 , PAYAMT = #PAYAMT#
				 , PAY_SUPLY_AMOUNT = ROUND((#PAYAMT# / 1.1))
				 , PAY_VAT = ROUND((#PAYAMT# / 11))
				 , ARRRG_AMOUNT = #ARRRG_AMOUNT#
				 , YRINS_SALE_INTR = #YRINS_SALE_INTR#
				 , RQEST_YM = #RQEST_YM#
				 , PAY_TMLMT = #PAY_TMLMT#
				 , PAY_PRARNDE = #PAY_PRARNDE#
				 , MDAT_DE = #MDAT_DE#
				 , OUTPT_DE = #OUTPT_DE#
				 , PAYMTHD = #PAYMTHD#
				 , PAY_BANK_CODE = #PAY_BANK_CODE#
				 , OCR_NO = #OCR_NO#
				 , LEV_DECSN_NO = #LEV_DECSN_NO#
				 , TRMNAT_UNUSED_AT = #TRMNAT_UNUSED_AT#
				 , RCIV_DECSN_NO = #RCIV_DECSN_NO#
				 , LTTOT_RENT_SE = #LTTOT_RENT_SE#
				 , TMPR_RCIV_AMOUNT = #TMPR_RCIV_AMOUNT#
				 , TMPR_RCIV_NO = #TMPR_RCIV_NO#
				 , RCIV_DE = #RCIV_DE#
				 , RCIV_AMOUNT = #RCIV_AMOUNT#
				 , CNTRCT_ODR = #CNTRCT_ODR#
				 , POINT_DSCNT_AM = #POINT_DSCNT_AM#
				 , RM = #RM#
				 , ARRRG_DSCNT_SE = #ARRRG_DSCNT_SE#
				 , ARRRG_DSCNT_AMOUNT = #ARRRG_DSCNT_AMOUNT#
				 , ARRRG_DSCNT_SUPLY_AMOUNT = #ARRRG_DSCNT_SUPLY_AMOUNT#
				 , ARRRG_DSCNT_VAT = #ARRRG_DSCNT_VAT#
				 , ARRRG_DSCNT_DAYCNT = #ARRRG_DSCNT_DAYCNT#
				 , ARRRG_DSCNT_INTRT = #ARRRG_DSCNT_INTRT#
				 , RCIV_PREARNGE_DE = #RCIV_PREARNGE_DE#
				 , UPDUSR_ID = #S_USER_ID#
				 , UPDT_DT = SYSDATE
		WHEN NOT MATCHED
			THEN
				INSERT (
				  CNTRCTR_NO
				, PAY_NO
				, PAY_CODE
				, PAY_SE
				, PAY_SN
				, PAYAMT
				, PAY_SUPLY_AMOUNT
				, PAY_VAT
				, ARRRG_AMOUNT
				, YRINS_SALE_INTR
				, RQEST_YM
				, PAY_TMLMT
				, PAY_PRARNDE
				, MDAT_DE
				, OUTPT_DE
				, PAYMTHD
				, PAY_BANK_CODE
				, OCR_NO
				, LEV_DECSN_NO
				, TRMNAT_UNUSED_AT
				, RCIV_DECSN_NO
				, LTTOT_RENT_SE
				, TMPR_RCIV_AMOUNT
				, TMPR_RCIV_NO
				, RCIV_DE
				, RCIV_AMOUNT
				, CNTRCT_ODR
				, POINT_DSCNT_AM
				, RM
				, ARRRG_DSCNT_SE
				, ARRRG_DSCNT_AMOUNT
				, ARRRG_DSCNT_SUPLY_AMOUNT
				, ARRRG_DSCNT_VAT
				, ARRRG_DSCNT_DAYCNT
				, ARRRG_DSCNT_INTRT
				, RCIV_PREARNGE_DE
				, REGISTER_ID
				, REGIST_DT
				, UPDUSR_ID
				, UPDT_DT
				)
				VALUES 
				(
				  #CNTRCTR_NO#
				, #PAY_NO#
				, #PAY_CODE#
				, #PAY_SE#
				, #PAY_SN#
				, #PAYAMT#
				, ROUND((#PAYAMT# / 1.1))
				, ROUND((#PAYAMT# / 11))
				, #ARRRG_AMOUNT#
				, #YRINS_SALE_INTR#
				, #RQEST_YM#
				, #PAY_TMLMT#
				, #PAY_PRARNDE#
				, #MDAT_DE#
				, #OUTPT_DE#
				, #PAYMTHD#
				, #PAY_BANK_CODE#
				, #OCR_NO#
				, #LEV_DECSN_NO#
				, #TRMNAT_UNUSED_AT#
				, #RCIV_DECSN_NO#
				, #LTTOT_RENT_SE#
				, #TMPR_RCIV_AMOUNT#
				, #TMPR_RCIV_NO#
				, #RCIV_DE#
				, #RCIV_AMOUNT#
				, #CNTRCT_ODR#
				, #POINT_DSCNT_AM#
				, #RM#
				, #ARRRG_DSCNT_SE#
				, #ARRRG_DSCNT_AMOUNT#
				, #ARRRG_DSCNT_SUPLY_AMOUNT#
				, #ARRRG_DSCNT_VAT#
				, #ARRRG_DSCNT_DAYCNT#
				, #ARRRG_DSCNT_INTRT#
				, #RCIV_PREARNGE_DE#
				, #S_USER_ID#
				, SYSDATE
				, #S_USER_ID#
				, SYSDATE
				)
	</update>


	<!-- 납부번호 첫자리  -->
	<select id="SLS020208DAO.selectHeadPayNo" parameterClass="java.util.Map" resultClass="String">
		SELECT CHRCTR_PREPAR_VALUE_0
		  FROM TBCOM_CMMN_CODE
		 WHERE GRP_CODE = 'HOU0A1'
		  AND CODE = #PAY_CODE#
	</select>


	<!-- 납부번호 뒷자리  -->
	<select id="SLS020208DAO.selectTailPayNo" parameterClass="java.util.Map" resultClass="String">
		SELECT LPAD((NVL(MAX(SUBSTR(PAY_NO, 2,3)),0) + 1),3,0)||'0'
		  FROM TBSLS_HOUSE_LTTOT_PAY
		 WHERE CNTRCTR_NO = #CNTRCTR_NO#
	</select>
	
	<!-- 분납 납부번호 -->
	<select id="SLS020208DAO.selectInspyPayNo" parameterClass="java.util.Map" resultClass="String">
		SELECT SUBSTR(MAX(PAY_NO), 1, 4)|| NVL(MAX(SUBSTR(PAY_NO,5,1)),0) + 1 
		  FROM TBSLS_HOUSE_LTTOT_PAY
		 WHERE 1 = 1
		   AND CNTRCTR_NO = #CNTRCTR_NO#
		   AND PAY_NO LIKE SUBSTR(#PAY_NO#, 1, 4)||'%'
	</select>
	
	
	<!-- 쿼리명 : 납부금액계산 및 적용
	설명 : 납부금액계산 및 적용 쿼리
	수정일  		수정자  	수정내용
	2015.12.07	최승락	최초작성
	작성자 : 최승락
	최초작성일 : 2015.12.07
	-->
	<select id="SLS020208DAO.selectInspyIntrInfo" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT SFSLS_HOUSE_INSTALLMENT(#SE#, #HOUSE_CODE#, #TO_DAY#, #PAY_TMLMT#, #PAYAMT#, #RATIO#, #SL_SE#) AS PAYAMT
		  FROM DUAL
	</select>
	

	<!-- 쿼리명 : 잔금납부일 수정
	설명 : 잔금납부일 수정 쿼리
	수정일  수정자  수정내용
	
	작성자 : 최승락
	최초작성일 : 2015.10.05
	-->
	<update id="SLS020208DAO.updateRemndrPayDe" parameterClass="java.util.Map">
		UPDATE TBSLS_HOUSE_LTTOT_PAY T1
		   SET T1.PAY_TMLMT = #PAY_TMLMT#
		 WHERE 1 = 1
		   AND T1.CNTRCTR_NO IN (
							 SELECT S1.CNTRCTR_NO
							   FROM TBSLS_HCNTRCTR S1
							  WHERE 1 = 1
							    AND S1.HOUSE_CODE = #HOUSE_CODE#
							    AND S1.CNTRCTR_STTUS_CODE = '01'
						    )
		   AND T1.PAY_CODE IN ('S9', 'R9')
		   AND T1.RCIV_DE IS NULL
	</update>
	
	
	<!-- 쿼리명 : 연체/선납계산
		설명 : 가상계좌 미납내역
		수정일  수정자  수정내용
		
		작성자 : 이광원
		최초작성일 : 2016.0.3.09 
	-->	
	<select id="SLS020208DAO.LadCalList" parameterClass="java.util.Map" resultClass="java.util.HashMap">
            SELECT
                  T1.CNTRCTR_NO
                , T1.PAY_NO
                , T1.RQEST_YM
                , T1.PAY_CODE
                , T1.PAY_SE
                , T1.PAYAMT
                , T1.PAY_SUPLY_AMOUNT
                , T1.PAY_VAT
                , T1.ARRRG_AMOUNT
                , SFSLS_LAD_APAY_CAL(  #LAD_CODE#  /* 토지코드  */
                					 , NVL(T1.PAY_TMLMT , #IN_TO_DAY#) /* 납입기한이 없으면 변경기한일로 대체 */ 
                					 , #IN_TO_DAY# /* 변경기한일(수납예정일자)  */ 
                					 , T1.PAYAMT  /* 납부금액  */
                					 , T1.CNTRCTR_NO /* 계약자번호 */
                					 ) AS  APAY_CAL /* 토지코드가 국가산단 이고 용도구분이 산업시설용지 구분  */
          	   , TO_DATE(T1.PAY_TMLMT , 'YYYYMMDD')  - TO_DATE(#IN_TO_DAY# , 'YYYYMMDD') AS CNT_DAY
       		   , SFSLS_LAD_RATIO(  ' ' 
                           , #LAD_CODE# 
                           , #IN_TO_DAY# 
                           , T1.PAY_TMLMT 
                           , '0' 
                           , CASE WHEN #LAD_CODE# = '024' AND #PRPOS_SE# = '12' 
                                  THEN '1' 
                                  ELSE '0' END
                           ,  '0'       ) as RATIO                  
                , NVL(T1.PAY_TMLMT , #IN_TO_DAY#) AS PAY_TMLMT
                , T1.PAYMTHD
                , T1.OCR_NO
                , T1.MDAT_DE
                , T1.LEV_DECSN_NO
                , T1.RM
                , T1.RCIV_DECSN_NO
                , T1.LTTOT_RENT_SE
                , T1.TMPR_RCIV_AMOUNT
                , T1.ARRRG_DSCNT_SE
                , T1.ARRRG_DSCNT_AMOUNT
                , T1.ARRRG_DSCNT_SUPLY_AMOUNT
                , T1.ARRRG_DSCNT_VAT
                , T1.ARRRG_DSCNT_DAYCNT
                , T1.ARRRG_DSCNT_INTRT
                , T1.RCIV_DE
                , T2.RCIV_AMOUNT AS R_RCIV_AMOUNT
                , T2.RCIV_DE AS R_RCIV_DE
                , T2.PAYMTHD AS R_RCIV_MTH
                , T2.BANK_CODE AS R_BANK_CODE
              FROM TBSLS_HOUSE_LTTOT_PAY T1
                , TBSLS_HOUSE_RCIV_PSTMRK T2
             WHERE 1 = 1
              AND T1.CNTRCTR_NO = T2.CNTRCTR_NO(+)
              AND T1.PAY_NO = T2.PAY_NO(+)
              AND T1.CNTRCTR_NO = #CNTRCTR_NO#
              AND T1.LTTOT_RENT_SE = #LTTOT_RENT_SE#
             ORDER BY T1.PAY_CODE, T1.PAY_TMLMT,  T1.PAY_SE	    
    </select>
    
<!-- 전대정보 목록 -->
	<select id="SLS020208DAO.selectHouseSublsList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
			 0 AS CHK
			,A.CNTRCTR_NO 		/*계약자고객번호*/
			,(SELECT DONG FROM TBSLS_HCNTRCTR WHERE 1=1 AND CNTRCTR_NO = A.CNTRCTR_NO) AS DONG
            ,(SELECT HO FROM TBSLS_HCNTRCTR WHERE 1=1 AND CNTRCTR_NO = A.CNTRCTR_NO) AS HO
			,A.SUBLS_SN			/*전대차일련번호*/
		    ,A.HOUSE_CSTMR_NO	/*주택고객번호*/
		    ,TO_CHAR(A.REGIST_DT, 'YYYYMMDD') AS REGIST_DT	/*등록일자*/
			,A.BGNDE			/*시작일자*/
		    ,A.ENDDE			/*종료일자*/
		    ,A.CHGHY_CODE		/*변경사유코드*/
		    ,B.CSTMR_NM				/*이름*/
		    ,SFCOM_DEC_ALL(B.IHIDNUM) AS IHIDNUM   /*주민등록번호*/
		    <!-- ,B.IHIDNUM			/*주민등록번호*/ -->
		    ,B.TELNO			/*전화번호*/
		    ,B.MBTLNO			/*휴대폰번호*/
		    ,A.RM				/*비고*/
		    ,A.RELIS_DE			/*해제일자*/
		    ,A.FILE_NM			/*파일명*/
		    ,A.COURS_NM			/*경로명*/
		    ,A.CONFM_COMPT_AT	/*승인완료여부*/
		    ,A.SANCTN_NO		/*결재번호*/
	        ,(SELECT FILE_SN FROM TBCOM_CMMN_ATCHMNFL Z WHERE TO_CHAR (FILE_SN) = A.FILE_SN) AS FILE_SN
	        ,(SELECT FILE_ORDR FROM TBCOM_CMMN_ATCHMNFL Z WHERE TO_CHAR (FILE_SN) = A.FILE_SN) AS FILE_ORDR
	        ,(SELECT FILE_EXTSN FROM TBCOM_CMMN_ATCHMNFL Z WHERE TO_CHAR (FILE_SN) = A.FILE_SN) AS FILE_EXTSN
	        ,(SELECT STRE_FILE_NM FROM TBCOM_CMMN_ATCHMNFL Z WHERE TO_CHAR (FILE_SN) = A.FILE_SN) AS STRE_FILE_NM
	        ,(SELECT ORGINL_FILE_NM FROM TBCOM_CMMN_ATCHMNFL Z WHERE TO_CHAR (FILE_SN) = A.FILE_SN) AS ORGINL_FILE_NM
	        ,(SELECT REGEXP_SUBSTR (FILE_TY, '[^/]+', 1, 1) FROM TBCOM_CMMN_ATCHMNFL Z WHERE TO_CHAR (FILE_SN) = A.FILE_SN) AS FILE_TY   		    
		FROM 
			 TBSLS_HOUSE_SUBLS A
		    ,TBSLS_HOUSE_CSTMR B
		WHERE CNTRCTR_NO = #CNTRCTR_NO#
		AND   A.HOUSE_CSTMR_NO = B.HOUSE_CSTMR_NO
	</select>
	
	<!-- 전대정보 생성 -->
	<insert id="SLS020208DAO.houseSublsC" parameterClass="java.util.HashMap">
		INSERT INTO TBSLS_HOUSE_SUBLS(
			 CNTRCTR_NO			/*계약자고객번호*/
			,SUBLS_SN			/*전대차일련번호*/
			,HOUSE_CSTMR_NO		/*주택고객번호*/
			,BGNDE				/*시작일자*/
			,ENDDE				/*종료일자*/
			,CHGHY_CODE			/*변경사유코드*/
			,RM					/*비고*/
			,RELIS_DE			/*해제일자*/
			,FILE_NM			/*파일명*/
		    ,COURS_NM			/*경로명*/
			,REGISTER_ID		/*등록자ID*/
			,REGIST_DT			/*등록일시*/
			,UPDUSR_ID			/*수정자ID*/
			,UPDT_DT)			/*수정일시*/
		VALUES(
			 #CNTRCTR_NO#		/*계약자고객번호*/
			,SQ_TBSLS_HOUSE_SUBLS.NEXTVAL	/*전대차일련번호*/
			,#HOUSE_CSTMR_NO#	/*주택고객번호*/
			,#BGNDE#			/*시작일자*/
			,#ENDDE#			/*종료일자*/
			,#CHGHY_CODE#		/*변경사유코드*/
			,#RM#				/*비고*/
			,#RELIS_DE#			/*해제일자*/
			,#FILE_NM#			/*파일명*/
		    ,#COURS_NM#			/*경로명*/
			,#S_USER_ID#		/*등록자ID*/
			,SYSDATE			/*등록일시*/
			,#S_USER_ID#		/*수정자ID*/
			,SYSDATE			/*수정일시*/
		)
	</insert>
	
	<!-- 전대정보 수정 -->
	<update id="SLS020208DAO.houseSublsU" parameterClass="java.util.HashMap">
		UPDATE TBSLS_HOUSE_SUBLS SET
			 HOUSE_CSTMR_NO = #HOUSE_CSTMR_NO#	/*주택고객번호*/
			,BGNDE = #BGNDE#					/*시작일자*/
			,ENDDE = #ENDDE#					/*종료일자*/
			,CHGHY_CODE = #CHGHY_CODE#			/*변경사유코드*/
			,RM = #RM#							/*비고*/
			,RELIS_DE = #RELIS_DE# 				/*해제일자*/
			,FILE_NM = #FILE_NM#				/*파일명*/
		    ,COURS_NM = #COURS_NM#				/*경로명*/
			,UPDUSR_ID = #S_USER_ID#			/*수정자ID*/
			,UPDT_DT = SYSDATE					/*수정일시*/
		WHERE CNTRCTR_NO = #CNTRCTR_NO#
		AND   SUBLS_SN = #SUBLS_SN#
	</update>
	
	<!-- 전대정보 삭제 -->
	<delete id="SLS020208DAO.houseSublsD" parameterClass="java.util.HashMap">
		DELETE FROM TBSLS_HOUSE_SUBLS
		WHERE CNTRCTR_NO = #CNTRCTR_NO#
		AND   SUBLS_SN = #SUBLS_SN#
	</delete>
	
	
	<!-- 전대정보 모두 삭제 -->
	<delete id="SLS020208DAO.deleteAllSublsList" parameterClass="java.util.HashMap">
		DELETE FROM TBSLS_HOUSE_SUBLS
		WHERE CNTRCTR_NO = #CNTRCTR_NO#
	</delete>
	
      <!-- 주택 임대코드  신청서 -->
	<select id="SLS020208DAO.selectNmchangeReqstdoc" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		WITH V_SLS_HOUSE_INFO AS
	  	(
	  	<include refid="COM000000.v_sls_house_info"/>
	  	)
			
		SELECT T1.CNTRCTR_NO                          AS CNTRCTR_NO         /*계약자번호*/
		      ,#TYPE_CODE#                            AS TYPE_CODE          /* 클릭버튼 TEXT*/
		      ,T2.HOUSE_NM                            AS HOUSE_NM           /*주택명*/
		      ,TO_CHAR(TO_NUMBER(T2.DONG))            AS DONG               /*동*/
		      ,TO_CHAR(TO_NUMBER(T2.HO))              AS HO                 /*호*/
		      ,T2.TY_AEA                              AS TY_AEA             /*타입평형*/
		      ,T2.HOUSE_DVR_AR                        AS HOUSE_DVR_AR       /*전용면적*/
		      ,T2.HOUSE_CMNUSE_AR                     AS HOUSE_CMNUSE_AR    /*공용면적*/
		      ,(T2.HOUSE_DVR_AR + T2.HOUSE_CMNUSE_AR) AS SUM_AR             /*계*/
		      <!-- ,(
		          SELECT SUM(p.PAYAMT)                                      /*납부금액-실제납부한금액*/
                       FROM TBSLS_HCNTRCTR_PAY o                               /*주택계약자 납부*/
                            ,TBSLS_HCNTRCTR_PAY_DETAIL p                       /*주택계약자납부상세  계약자 납부정보(분양보증금)*/
                       WHERE 1 = 1
                         AND o.CNTRCTR_NO = p.CNTRCTR_NO(+)
                         AND o.PAY_NO     = p.PAY_NO(+)
                         AND o.PAY_CODE LIKE 'R%'
                         AND p.RCIV_DE(+) IS NOT NULL/*수납일자*/
                         AND o.CNTRCTR_NO = T1.CNTRCTR_NO
                )                                    AS PAYAMT              /*보증금 납부금액*/  -->
                 ,( SELECT  NVL(SUM(PAYAMT),0)                    /*임대보증금*/
                     FROM TBSLS_HOUSE_LTTOT_PAY
                    WHERE 1 = 1
                      AND CNTRCTR_NO = T1.CNTRCTR_NO
                      AND PAY_CODE IN ( 'R0', 'R1', 'R2', 'R3', 'R4', 'R5', 'R9', 'RP')  /* 임대 보증금/ 분양납부금액 : ( 'S0','S1','S2','S3','S4','S5','S9','SA','SB','SC','SD','SE')*/
                      <!-- AND PAY_CODE LIKE 'R%' -->
                      AND RCIV_DE IS NOT NULL                   /*수납일자*/
                 ) AS PAYAMT                  
                 , NVL( (
			          SELECT RNTCHRG
			              FROM TBSLS_HOUSE_RNTCHRG
			             WHERE     CNTRCTR_NO = T1.CNTRCTR_NO
			                   AND APPLC_DE = (SELECT MAX (APPLC_DE) FROM TBSLS_HOUSE_RNTCHRG WHERE CNTRCTR_NO = T1.CNTRCTR_NO)
                   
                  	 ), T2.BASS_RNTCHRG 
                          )                              AS RENT_AMT            /*임대료*/     
                          
                 ,T2.LOCPLC_BASS_ADRES
          		 ,T2.LOCPLC_DETAIL_ADRES  
                 ,T3.CSTMR_NM                                /*고객명*/
         		 ,SFCOM_DEC_ALL(T3.IHIDNUM) AS IHIDNUM       /*고객주민번호*/
         		 ,T3.ADRES                                   /*고객주소*/
       			 ,T3.ADRES_DETAIL                            /*고객주소상세*/
 
 			  FROM TBSLS_HCNTRCTR T1                                 /*계약자정보*/
 			      ,V_SLS_HOUSE_INFO T2                               /*주택정보*/
 			      , TBSLS_HOUSE_CSTMR T3                             /*주택고객정보*/
             WHERE 1 = 1
               AND T1.CNTRCTR_NO = #CNTRCTR_NO#                     /*주택계약자번호*/
               AND T1.HOUSE_CODE = T2.HOUSE_CODE(+)
               AND T1.DONG       = T2.DONG(+)
               AND T1.HO         = T2.HO(+)
               AND T1.HOUSE_CSTMR_NO = T3.HOUSE_CSTMR_NO(+)
                    
	  </select>	
	  
	  	<!-- 븐양전환조회 -->
	<select id="SLS020208DAO.changeHouseList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT A.CNTRCTR_NO,
		       A.RENT_LTTOT_CNVRS_DE,
		       A.HOUSE_CODE,
		       A.DONG,
		       A.HO,
		       A.REGISTER_ID,
		       D.CSTMR_NM,
		       C.TY_AEA,
		       C.KJF,
		       J.HOUSE_NM,		       
		       (SELECT ALTRV_LON_DE  FROM TBSLS_HCNTRCTR_KJF_PAY_CNFIRM WHERE CNTRCTR_NO = A.CNTRCTR_NO) ALTRV_LON_DE,
		       (SELECT DELNG_BANK  FROM TBSLS_HCNTRCTR_KJF_PAY_CNFIRM WHERE CNTRCTR_NO = A.CNTRCTR_NO) DELNG_BANK,
		       NVL (E.PAYAMT, 0) AS PAYAMT,
		       NVL (B.BASS_LTTOT_AMOUNT, 0) AS BASS_LTTOT_AMOUNT,
		       NVL (C.SUPLY_AMOUNT, 0) AS SUPLY_AMOUNT2,
		       NVL (K.PAYAMT, 0) AS SUPLY_AMOUNT,
		       (NVL (K.PAYAMT, 0) - NVL (E.PAYAMT, 0)) AS JAN_PAYAMT,
		       G.PAY_TMLMT,
		       (NVL (E.PAYAMT, 0) - NVL (B.BASS_LTTOT_AMOUNT, 0)) AS CHA_PAYAMT,
		       B.HOUSE_TY_CODE,
		       B.LTTOT_TY_CODE,
		       B.RENT_TY_CODE,
		       A.RENT_LTTOT_CNVRS_DE,
		       A.RENT_BGNDE,
		       A.RENT_ENDDE,
		       A.UPDUSR_ID,
		       C.PBNCD_NO,
		       (SELECT BRRW_ACNUT_NM FROM TBFUN_PBNCD WHERE PBNCD_NO = C.PBNCD_NO) AS BRRW_ACNUT_NM
		        ,NVL((SELECT SUM (NVL(M.PAYAMT,0)) FROM TBSLS_HOUSE_LTTOT_PAY M 
		          WHERE M.CNTRCTR_NO = A.CNTRCTR_NO AND M.PAY_CODE LIKE 'R%' AND M.RCIV_DE IS NULL
		         ), 0) AS GTN_M_AMOUNT
		       ,NVL((SELECT SUM (NVL(M.MT_RNTCHRG,0)+NVL(M.DFNNT_AMOUNT,0)) FROM TBSLS_HOUSE_RENT_PAY M 
		          WHERE M.CNTRCTR_NO = A.CNTRCTR_NO AND M.RCIV_DE IS NULL
		         ), 0) AS RNTCHRG_M_AMOUNT
		  FROM TBSLS_HCNTRCTR A,
		       TBSLS_HOUSE_DONG_HO B,
		       TBSLS_HOUSE_TY C,
		       TBSLS_HOUSE_CSTMR D,
		       TBSLS_HOUSE_INFO J,
       		   TBSLS_HOUSE_TYBY_PAY K,		       
		       (  SELECT CNTRCTR_NO, NVL (SUM (PAYAMT), 0) AS PAYAMT
		            FROM TBSLS_HOUSE_LTTOT_PAY
		           WHERE PAY_CODE LIKE 'R%' AND RCIV_DE IS NOT NULL
		        GROUP BY CNTRCTR_NO) E,
		       (  SELECT CNTRCTR_NO, PAY_TMLMT
		            FROM TBSLS_HOUSE_LTTOT_PAY
		           WHERE 1 = 1 AND PAY_CODE = 'S9'
		        GROUP BY CNTRCTR_NO, PAY_TMLMT) G		        
		 WHERE     1 = 1
		       AND A.HOUSE_CODE = B.HOUSE_CODE
		       AND A.DONG = B.DONG
		       AND A.HO = B.HO
		       AND B.HOUSE_CODE = C.HOUSE_CODE
		       AND A.HOUSE_CODE = J.HOUSE_CODE
		       AND B.HOUSE_TY_CODE = C.HOUSE_TY_CODE
		       AND C.HOUSE_CODE = K.HOUSE_CODE
		       AND B.LTTOT_TY_CODE = K.HOUSE_TY_CODE		       
		       AND A.CNTRCTR_NO = E.CNTRCTR_NO (+)
		       AND A.CNTRCTR_NO = G.CNTRCTR_NO (+)
		       AND A.HOUSE_CSTMR_NO = D.HOUSE_CSTMR_NO
		       AND A.CNTRCTR_NO = #CNTRCTR_NO# 
		       AND A.HOUSE_CODE = #HOUSE_CODE# 
		       AND A.DONG = #DONG# 
		       AND A.HO = #HO#         			              
	  </select>
			 
		<!-- 
		쿼리명 : 타입코드 전환
		설명 : 타입코드 전환
		수정일  		수정자  	수정내용
		작성자 : 이광원
		최초작성일 : 2016.1.19
		-->
		<update id="SLS020208DAO.typeCodeUpdate" parameterClass="java.util.HashMap" >
		UPDATE TBSLS_HOUSE_DONG_HO
		   SET   HOUSE_TY_CODE = LTTOT_TY_CODE
		       , UPDUSR_ID = #S_USER_ID#
		       , UPDT_DT = SYSDATE
		 WHERE 1=1
		   AND HOUSE_CODE = #HOUSE_CODE#
		   AND DONG = #DONG#
		   AND HO = #HO#
		</update>
		
		<!-- 
		쿼리명 : 타입코드 복구 전환
		설명 : 타입코드 복구 전환
		수정일  		수정자  	수정내용
		작성자 : 이광원
		최초작성일 : 2016.1.19
		-->
		<update id="SLS020208DAO.typeCodeCancle" parameterClass="java.util.HashMap" >
		UPDATE TBSLS_HOUSE_DONG_HO
		   SET   HOUSE_TY_CODE = RENT_TY_CODE
		       , UPDUSR_ID = #S_USER_ID#
		       , UPDT_DT = SYSDATE
		 WHERE 1=1
		   AND HOUSE_CODE = #HOUSE_CODE#
		   AND DONG = #DONG#
		   AND HO = #HO#
		</update>
	 
<!-- 
쿼리명 : 임대주택 분양전환 프로시저
설명 : 임대주택 분양전환 프로시저
수정일  		수정자  	수정내용
작성자 : 이광원
최초작성일 : 2016.1.19
-->
<parameterMap id="spsls_house_270_sr_change_param" class="java.util.HashMap">
	<parameter property="IN_HOUSE_CODE"		jdbcType="VARCHAR"	javaType="string" 	mode="IN" />
	<parameter property="IN_DONG"			jdbcType="VARCHAR"	javaType="string" 	mode="IN" />
	<parameter property="IN_HO"			    jdbcType="VARCHAR"	javaType="string" 	mode="IN" />	
	<parameter property="IN_CHK_KJF"		jdbcType="VARCHAR"	javaType="string" 	mode="IN" />
	<parameter property="IN_ALTRV_LON_DE"	jdbcType="VARCHAR"	javaType="string" 	mode="IN" />
	<parameter property="IN_DELNG_BANK"		jdbcType="VARCHAR"	javaType="string" 	mode="IN" />
	<parameter property="IN_PBNCD_NO"		jdbcType="VARCHAR"	javaType="string" 	mode="IN" />	
	<parameter property="IN_KJF"			jdbcType="VARCHAR"	javaType="string" 	mode="IN" />	
	<parameter property="IN_RENT_LTTOT_CNVRS_DE"		jdbcType="VARCHAR"	javaType="string" 	mode="IN" />
	<parameter property="IN_PAY_TMLMT"		jdbcType="VARCHAR"	javaType="string" 	mode="IN" />
	<parameter property="S_USER_ID"		    jdbcType="VARCHAR"	javaType="string" 	mode="IN" />
</parameterMap>

<procedure id="SLS020208DAO.SPSLS_HOUSE_270_SR_CHANGE" parameterMap="spsls_house_270_sr_change_param">
	{ call SPSLS_HOUSE_270_SR_CHANGE(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }
</procedure>

<!-- 
쿼리명 : 임대주택 분양전환  취소 프로시저
설명 : 임대주택 분양전환  취소 프로시저
수정일  		수정자  	수정내용
작성자 : 이광원
최초작성일 : 2016.1.19
-->
<parameterMap id="spsls_house_270_sr_cancle_param" class="java.util.HashMap">
	<parameter property="IN_HOUSE_CODE"		jdbcType="VARCHAR"	javaType="string" 	mode="IN" />
	<parameter property="IN_DONG"			jdbcType="VARCHAR"	javaType="string" 	mode="IN" />
	<parameter property="IN_HO"			    jdbcType="VARCHAR"	javaType="string" 	mode="IN" />	
	<parameter property="S_USER_ID"		    jdbcType="VARCHAR"	javaType="string" 	mode="IN" />
</parameterMap>

<procedure id="SLS020208DAO.SPSLS_HOUSE_270_SR_CANCEL" parameterMap="spsls_house_270_sr_cancle_param">
	{ call SPSLS_HOUSE_270_SR_CANCEL(?, ?, ?, ?) }
</procedure>
	  <!-- 쿼리명     : 주택계약자 해약리스트
           설명       : 주택계약자 해약리스트 조회
	       작성자     : 정윤원
	       최초작성일 : 2015.10.26

	       수정일  수정자  수정내용
	   -->        
      <select id="SLS020208DAO.selectHouseCancelList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
/*  공통정보  */
            SELECT      
                 '1' AS CHK
			    ,T1.CNTRCTR_NO                                  /* 계약자번호 */
                ,T1.HOUSE_CODE                                  /* 주택코드 */
                ,SFSLS_HOUSE_NM(T1.HOUSE_CODE, 'HOUSE_NM') AS HOUSE_NM  /* 주택명 */
                ,T1.DONG                                        /* 동 */
                ,T1.HO                                          /* 호 */
                ,T1.CANCL_DE                                    /* 해약일자 */
                ,T1.RESCI_RESN_CODE                             /* 해약사유코드 */
                ,T1.RESCI_RESN_DETAIL                           /* 해약사유상세 */
                ,T1.BANK_CODE                                   /* 은행코드 */
                ,SFCOM_CODE_NM('COM021', T1.BANK_CODE, 'CODE_NM') AS BANK_CODE_NM                
                ,T1.DPSTR                                       /* 예금주 */
                ,T1.ACNUTNO                                     /* 계좌번호 */
                ,T1.LVHS_DE                                     /* 퇴거일자 */
                ,T1.LVHS_ADRES                                  /* 퇴거주소 */
                ,T1.LVHS_TELNO                                  /* 퇴거전화번호 */
                ,T1.LVHS_MOBLPHON                               /* 퇴거휴대폰 */
                ,NVL(T1.PENLTY_APPLC_AT,0) AS PENLTY_APPLC_AT   /* 위약금적용여부 */
                ,T1.PENLTY                                      /* 위약금 */
                ,T1.PENLTY_INTRT                                /* 위약금이율 */      
                ,T1.ELCTRN_SANCTN_NO                            /* 전자결재번호 */
                ,T1.CANCL_EXPNDTR_DECSN_NO                      /* 해약지출결의번호 */
                ,T1.RM                                          /* 비고-참고사항 */
                ,T1.REGISTER_ID                                 /* 등록자ID */
                ,TO_CHAR(T1.REGIST_DT,'YYYYMMDD') AS REGIST_DT  /* 등록일시 */
                ,T1.UPDUSR_ID                                   /* 수정자ID */                        
                ,TO_CHAR(T1.UPDT_DT, 'YYYYMMDD') AS UPDT_DT     /* 수정일시 */    
                ,'' AS RENT_BGNDE                               /* 임대시자일 */
                ,'' AS RENT_ENDDE                               /* 임대종료일 */
                ,'' AS LTTOT_RENT_SE                            /* 주택 분양(01), 임대(02) 구분  */
                ,'' AS PAY_CODE_SE                              /* 납부코드 구분 분양(R), 임대(S) */
                   
/* 압류정보 */
                ,T2.SEIZR_TOT_AMOUNT                            /* 압류금액 */
                ,T2.CRDTR_NM                                    /* 채권자명 */
                
                ,T1.ELCTRN_SANCTN_NO
		        ,T1.EXPNDTR_DECSN_DE
		  	    ,T1.DECSN_YEAR
		  	    ,T1.EXPNDTR_DECSN_NO
		  	    ,T1.SANCTN_AT
                ,T3.BANK_CD AS VBANK_CD
                ,T3.VACCT_NO AS VACCT_NO
            FROM TBSLS_HCNTRCTR_CANCL    T1                     /* 주택계약 해약 */
/* 주택계약자압류 */  
                , ( SELECT MAX(CNTRCTR_NO) AS CNTRCTR_NO
                          ,NVL(SUM(DET_AMOUNT),0) AS SEIZR_TOT_AMOUNT /* 압류금액 */
                          ,MAX(CRDTR_NM) AS CRDTR_NM                  /* 채권자명 */
                     FROM TBSLS_HCNTRCTR_SEIZR
                    WHERE 1=1
                      AND CNTRCTR_NO = #CNTRCTR_NO#
                      AND RELIS_DE IS NULL
                  ) T2
                , ( SELECT CUST_CD, BANK_CD, VACCT_NO FROM VA_MAST
                    WHERE CUST_CD = #CNTRCTR_NO#
                      AND BANK_CD = '031'
                      AND OPT1 = 1
                      AND ROWNUM = 1) T3 
           WHERE 1 = 1
             AND T1.CNTRCTR_NO     = #CNTRCTR_NO#
             AND T1.CNTRCTR_NO     = T2.CNTRCTR_NO(+) 
             AND T1.CNTRCTR_NO     = T3.CUST_CD(+)
                 
	  </select>
	  
	  	      <!-- 쿼리명     : 주택계약(분양) 해약 반환 금액 목록 
           설명       : 주택계약(분양) 해약 반환 금액 목록 조회
	       작성자     : 정윤원
	       최초작성일 : 2015.10.27

	       수정일  수정자  수정내용
	   -->        
      <select id="SLS020208DAO.selectHouseLttotCancelReturnAmtList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		    SELECT '1'              AS ORD
			      ,( SELECT T2.CSTMR_NM
			           FROM TBSLS_HCNTRCTR T1 
			               ,TBSLS_HOUSE_CSTMR T2
			           WHERE 1 = 1
			             AND T1.CNTRCTR_NO     = #CNTRCTR_NO#
			             AND T1.HOUSE_CSTMR_NO = T2.HOUSE_CSTMR_NO(+)
			       ) AS CNAME                         /* 계약자명  */

			     ,NULL              AS PAY_CODE      /* 납부코드                      */
			     ,T2.TOT_AMT        AS TOT_AMT       /* 분양금액:총납부금액(청구금액) */
			     ,'계 '              AS PAY_CODE_NM   /* 납부코드명                    */
			     ,SUM(PAYAMT)       AS PAYAMT        /* 납부금액:실납부금액           */
			     ,SUM(ARRRG_AMOUNT) AS ARRRG_AMOUNT  /* 연체(-할인)금액               */
			     ,NULL              AS RCIV_DE       /* 수납일자                      */
			     ,NULL              AS BET_DAY       /* 기산일                        */
			     ,SUM(RAMT1)        AS INT_AMT       /* 지급이자                      */
			     ,TRUNC(SUM(RAMT1) * 0.2,-1) + TRUNC((SUM(RAMT1) * 0.2) * 0.1,-1) + MAX(P_AMT) AS RT_AMT  /* 공제금액 합계: (납부금액 이자의 소득세/주민세합)+위약금=공제금액   */
			     ,TRUNC(SUM(RAMT1) * 0.2,-1)                                                   AS SO_AMT  /*  소득세        */
			     ,TRUNC((SUM(RAMT1) * 0.2) * 0.1,-1)                                           AS JU_AMT  /*  주민세        */
			     ,MAX(P_AMT)                                                                   AS P_AMT   /*  위약금        */
			     ,( SUM(PAYAMT) + SUM(ARRRG_AMOUNT) + SUM(RAMT1) )                                        /* 반환금액 : 실납부금액합 + 연체금액합 + 실납부금액이자합  */
			          /* 차감금액:  실납부금액이자의 소득세+주민세+위약금 */
			        - ( TRUNC(SUM(RAMT1) * 0.2,-1) + TRUNC((SUM(RAMT1) * 0.2) * 0.1,-1) + MAX(P_AMT) ) AS PAY_AMT  /*  실지급액  */
			  FROM
			       (
			         SELECT CNTRCTR_NO   /*  계약번호          */
			            , PAY_CODE_NM    /*  납부코드명        */
			            , PAY_CODE       /*  납부코드          */
			            , PAYAMT         /*  납부금액          */
			            , ARRRG_AMOUNT   /*  연체(-할인)금액   */
			            , RCIV_DE        /*  수납일자          */
			            , BET_DAY        /*  기산일            */
			
			          /* (1) 계약금이자 지급여부에 따른 쿼리조건 (S0:계약금)  */
			           
			            <isNotEmpty property="CNTRCTAMOUNT_RETURN_INTR_YN">
			                <isEqual property="CNTRCTAMOUNT_RETURN_INTR_YN" compareValue="0">
			                    ,( CASE
			                      WHEN PAY_CODE != 'S0'
			                        THEN  TRUNC((PAYAMT * #RETURN_AMT_INTRT# * BET_DAY ) / 365,-1)  /* 실납부금액 이자 , 반환이자지급율  */
			                        ELSE 0
			                   END
			                  )   AS RAMT1
			                </isEqual>
			                <isEqual property="CNTRCTAMOUNT_RETURN_INTR_YN" compareValue="1">
			                , TRUNC((PAYAMT * #RETURN_AMT_INTRT# * BET_DAY ) / 365,-1)  /* 실납부금액 이자   */
			                  AS RAMT1
			                </isEqual>
			            </isNotEmpty>
			            
 
			          /* 지급이자 소득세:반환이자율 적용  */
			            ,TRUNC(TRUNC((PAYAMT * #RETURN_AMT_INTRT# * BET_DAY ) / 365,-1) * 0.2,-1)         AS RAMT2  /* 실납부금액 소득세, 반환이자지급율:3.5% ,소득세:20%              */
			          /* 지급이자 주민세:반환이자율 적용   */
			            ,TRUNC((TRUNC((PAYAMT * #RETURN_AMT_INTRT# * BET_DAY) / 365,-1) * 0.2) * 0.1,-1)  AS RAMT3  /* 실납부금액 주민세, 반환이자지급율:3.5% ,소득세:20%, 주민세:10%  */
			            
			            ,/* (2) 위약금:적용시, 위약금 적용 이율및 계산방식 협의 필요:계약금, 확장 이율 0%적용   */
			             <isNotEmpty property="PENLTY_APPLC_YN">
			             
			               <isEqual property="PENLTY_APPLC_YN" compareValue="0">
			                 0 AS P_AMT
			               </isEqual>
			               <isEqual property="PENLTY_APPLC_YN" compareValue="1">
			                (
			                   
			                  SELECT  ( SELECT NVL(SUM(PAYAMT),0) FROM TBSLS_HOUSE_LTTOT_PAY WHERE  CNTRCTR_NO = #CNTRCTR_NO# AND PAY_CODE ='S0' )  /* 계약금:기본이율 */
			                        + ( SELECT NVL(SUM(PAYAMT),0) FROM TBSLS_HOUSE_LTTOT_PAY WHERE  CNTRCTR_NO = #CNTRCTR_NO# AND PAY_CODE ='SB' ) * #ESTN_AMT_INTRT#    /* 확장  :확장이율 */
			                    FROM DUAL
			              )  AS P_AMT
			              
			               </isEqual>
			               
			              </isNotEmpty>
			     	              
			              
			         FROM
			              (
			                SELECT CNTRCTR_NO                                           /*  계약번호               */
			                      ,PAY_CODE                                             /*  납부코드               */
			                      , SFCMP_GET_CODENM('HOU0A1',PAY_CODE) AS PAY_CODE_NM  /*  주택납부코드명:HOU0A1  */
			                     ,(
			                         CASE
			                             <![CDATA[ WHEN ARRRG_AMOUNT >= 0 ]]>           /*  연체(-할인)금액         */
			                             THEN PAYAMT                                    /*  납부금액                */
			                             ELSE RCIV_AMOUNT                               /*  수납금액 (할인금액)     */
			                         END
			                     ) AS PAYAMT                                            /*  AS 납부금액             */
			                   ,(
			                         CASE
			                             <![CDATA[ WHEN ARRRG_AMOUNT >= 0   ]]>         /* 연체(-할인)금액          */
			                             THEN ARRRG_AMOUNT                              /*  연체(-할인)금액         */
			                             ELSE 0
			                         END
			                     ) AS ARRRG_AMOUNT                                       /*  연체(-할인)금액        */
			                   ,  RCIV_DE                                                /*  수납일자               */
			                   
			                   
			                   <isNotEmpty property="CANCL_DE">
		                       , ( TO_DATE(#CANCL_DE#,'YYYY-MM-DD') - TO_DATE(RCIV_DE,'YYYY-MM-DD') ) AS BET_DAY  /*  기산일 : 해약일 - 수납일  */
			                   </isNotEmpty>
			                   <isEmpty property="CANCL_DE">
			                   , ( TO_DATE(TO_CHAR(SYSDATE,'YYYY-MM-DD'),'YYYY-MM-DD') - TO_DATE(RCIV_DE,'YYYY-MM-DD') ) AS BET_DAY  /*  기산일 : 현재날짜 - 수납일  */
			                   </isEmpty>
			                   
			                FROM TBSLS_HOUSE_LTTOT_PAY            /*  계약납부정보(분양보증금)  */
			               WHERE CNTRCTR_NO = #CNTRCTR_NO#
			                     AND RCIV_DE IS NOT NULL          /* 수납일자                   */
			              )
			
			       ) T1
			
			     , /*  총납부금액: 분양금액  */
			       (  SELECT CNTRCTR_NO                           /* 계약번호           */
			            , SUM(PAYAMT) AS TOT_AMT                  /*  총 납부금액       */
			         FROM TBSLS_HOUSE_LTTOT_PAY                   /* 주택분양납부       */
			        WHERE PAY_CODE LIKE 'R%'                      /*  분양(S), 임대(R)  */
			              AND CNTRCTR_NO = #CNTRCTR_NO#           /* 계약번호           */
			        GROUP BY CNTRCTR_NO
			       ) T2
			 WHERE T1.CNTRCTR_NO = T2.CNTRCTR_NO
			 GROUP BY T2.TOT_AMT
			
			   UNION ALL
			
			/* ** 세부항목 합계 **** */
			
			SELECT '2' AS ORD
			     , '' AS CNAME            /* 주택고객명:총합계에서 구함        */
			     , PAY_CODE               /* 납부코드                          */
			     , NULL AS TOT_AMT        /* 분양금액:총납부금액(청구금액)     */
			     , PAY_CODE_NM            /* 납부코드명                        */
			     , PAYAMT                 /* 납부금액:실납부금액               */
			     , ARRRG_AMOUNT           /* 연체(-할인)금액                   */
			     , RCIV_DE                /* 수납일자                          */
			     , BET_DAY                /* 기산일                            */
			     , RAMT1                  /* 지급이자                          */
			     , NULL AS RAMT4
			     , 0    AS RAMT2          /* 공제금액: 소득세, 총합계에서 구함 */
			     , 0    AS RAMT3          /* 공제금액: 주민세, 총합계에서 구함 */
			     , NULL AS RAMT5          /*  위약금 , 총합계에서 구함         */
			     , NULL AS RAMT6          /* 실 반환금액 , 총합계에서 구함     */
			
			  FROM
			       (SELECT PAY_CODE       /*  납부코드          */
			              ,PAY_CODE_NM    /*  납부코드명        */
			              ,PAYAMT         /*  납부금액          */
			              ,ARRRG_AMOUNT   /* 연체(-할인)금액    */
			              ,RCIV_DE        /* 수납일자           */
			              ,BET_DAY
			              
			               /* (1) 계약금이자 지급여부에 따른 쿼리조건  */
			              <isNotEmpty property="CNTRCTAMOUNT_RETURN_INTR_YN">
			              <isEqual property="CNTRCTAMOUNT_RETURN_INTR_YN" compareValue="0">
			              	,( CASE
                            	  <![CDATA[ WHEN PAY_CODE != 'S0' ]]> /* 계약금 이자  제외 */
			                    	THEN  TRUNC((PAYAMT * #RETURN_AMT_INTRT# * BET_DAY ) / 365,-1)  /* 실납부금액 이자 , 반환이자지급율  */
			                    	ELSE 0
			               	END
			             	)   AS RAMT1
			              
			              </isEqual>
			              <isEqual property="CNTRCTAMOUNT_RETURN_INTR_YN" compareValue="1">
			              	,	TRUNC((PAYAMT * #RETURN_AMT_INTRT# * BET_DAY ) / 365,-1)  /* 실납부금액 이자 , 반환이자지급율:3.5%  */
			              		AS RAMT1
			              </isEqual>
			              
			              </isNotEmpty>
			            
			              
			
			              ,TRUNC(TRUNC((PAYAMT * #RETURN_AMT_INTRT#  * BET_DAY ) / 365,-1) * 0.2,-1)        AS RAMT2 /* 실납부금액 소득세, 반환이자지급율 ,소득세:20%              */
			              ,TRUNC((TRUNC((PAYAMT * #RETURN_AMT_INTRT# * BET_DAY ) / 365,-1) * 0.2) * 0.1,-1) AS RAMT3 /* 실납부금액 주민세, 반환이자지급율 ,소득세:20%, 주민세:10%  */
			
			         FROM
			             ( SELECT PAY_CODE /* 납부코드 */
			                   , SFCMP_GET_CODENM('HOU0A1',PAY_CODE) AS PAY_CODE_NM  /*  주택납부코드명:HOU0A1  */
			                   , (
			                         CASE
			                            <![CDATA[  WHEN ARRRG_AMOUNT >= 0 ]]>     /*  연체(-할인)금액        */
			                             THEN PAYAMT                              /*  납부금액               */
			                             ELSE RCIV_AMOUNT                         /*  수납금액 (할인금액)    */
			                         END
			                     ) AS PAYAMT                                      /*  실 납부금액            */
			                   ,(
			                         CASE
			                             <![CDATA[ WHEN ARRRG_AMOUNT >= 0  ]]>   /* 연체(-할인)금액         */
			                             THEN ARRRG_AMOUNT                       /*  연체(-할인)금액        */
			                             ELSE 0
			                         END
			                     ) AS ARRRG_AMOUNT                               /*  연체금액               */
			                   , RCIV_DE                                         /*  수납일자               */
			                   
			                   <isNotEmpty property="CANCL_DE">
		                       , ( TO_DATE(#CANCL_DE#,'YYYY-MM-DD') - TO_DATE(RCIV_DE,'YYYY-MM-DD') ) AS BET_DAY  /*  기산일 : 현재날짜 - 수납일  */
			                   </isNotEmpty>
			                   <isEmpty property="CANCL_DE">
			                   , ( TO_DATE(TO_CHAR(SYSDATE,'YYYY-MM-DD'),'YYYY-MM-DD') - TO_DATE(RCIV_DE,'YYYY-MM-DD') ) AS BET_DAY  /*  기산일 : 현재날짜 - 수납일  */
			                   </isEmpty>
			                   
			                FROM TBSLS_HOUSE_LTTOT_PAY
			               WHERE CNTRCTR_NO = #CNTRCTR_NO#                       /* 계약번호                */
			                     AND RCIV_DE IS NOT NULL                         /* 수납일자                */
			                     AND PAY_CODE LIKE 'R%'                          /*  임대                   */
			              ) T1
			       )
			ORDER BY 1
			     ,2
			     ,3
		  
	  </select>	  	  
	  
 
       <!-- 쿼리명    : 주택계약 압류정보 
           설명       : 주택계약 압류정보 조회
	       작성자     : 정윤원
	       최초작성일 : 2015.10.27

	       수정일  수정자  수정내용
	   -->        
      <select id="SLS020208DAO.selectHcntrctrSeizrInfo" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
         SELECT  MAX(CNTRCTR_NO) AS CNTRCTR_NO 
                ,TO_CHAR(SUM(DET_AMOUNT),'999,999,999') TOT_AMOUNT  /* 압류금액 */
                ,MAX(CRDTR_NM)                          CRDTR_NM    /* 채권자명 */
           FROM TBSLS_HCNTRCTR_SEIZR
          WHERE 1=1
            AND CNTRCTR_NO = #CNTRCTR_NO#
            AND RELIS_DE IS NULL
      
      </select>
      
       <!-- 쿼리명    : 주택분양 이율정보 조회(신규시) 
           설명       : 주택분양 이율정보 조회(신규시)
	       작성자     : 정윤원
	       최초작성일 : 2015.12.15

	       수정일  수정자  수정내용
	   -->        
      <select id="SLS020208DAO.selectLttotRatioInfo" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
         SELECT 
              SFPMS_GET_INTRT_RATE('HOU', #HOUSE_CODE# ,'S2', #CANCL_DE#, 0) RAT2   /*  반환이자 이율  */
             ,SFPMS_GET_INTRT_RATE('HOU', #HOUSE_CODE# ,'S3', #CANCL_DE#, 0) RAT3   /*  기본,분양위약금 이율 */
             ,SFPMS_GET_INTRT_RATE('HOU', #HOUSE_CODE# ,'S4', #CANCL_DE#, 0) RAT4   /*  발코니 확장 이율  */
         FROM DUAL
      
      </select> 
<!--  계약해약처리      -->	 
   
	  <!-- 쿼리명      : 주택계약자 해약정보 저장
	        설명       : 주택계약자 해약정보 저장 쿼리문
	        작성자     : 정윤원
	        최초작성일 : 2015.10.29

	        수정일  수정자  수정내용
	   -->
	  
	  <insert id="SLS020208DAO.insertHouseCancelInfo" parameterClass="java.util.Map">
	  /*  (1) 주택계약 해약정보 등록  */
	      INSERT INTO TBSLS_HCNTRCTR_CANCL
		  (    
		     CNTRCTR_NO                              /* 계약자번호        */   
            ,HOUSE_CODE                              /* 주택코드          */   
            ,DONG                                    /* 동                */   
            ,HO                                      /* 호                */   
            ,CANCL_DE                                /* 해약일자          */   
            ,RESCI_RESN_CODE                         /* 해약사유코드 */
            ,RESCI_RESN_DETAIL                       /* 해약사유상세 */
            ,BANK_CODE                               /* 은행코드          */  
            ,DPSTR                                   /* 예금주            */
            ,ACNUTNO                                 /* 계좌번호          */   
            ,LVHS_DE                                 /* 퇴거일자          */  
            ,LVHS_ADRES                              /* 퇴거주소          */  
            ,LVHS_TELNO                              /* 퇴거전화번호      */   
            ,LVHS_MOBLPHON                           /* 퇴거휴대폰        */  
            ,PENLTY_APPLC_AT                         /* 위약금적용여부 */
            ,PENLTY                                  /* 위약금            */  
            ,PENLTY_INTRT                            /* 위약금이율        */
            ,ELCTRN_SANCTN_NO                        /* 전자결재번호      */ 
            ,CANCL_EXPNDTR_DECSN_NO                  /* 해약지출결의번호  */  
            ,RM                                      /* 비고              */
            ,REGISTER_ID                             /* 등록자ID          */
            ,REGIST_DT                               /* 등록일시          */
            ,UPDUSR_ID                               /* 수정자ID          */
            ,UPDT_DT                                 /* 수정일시          */

		  ) VALUES (
		     #CNTRCTR_NO#                              /* 계약자번호        */          
			,#HOUSE_CODE#                              /* 주택코드          */   
			,#DONG#                                    /* 동                */   
			,#HO#                                      /* 호                */   
			,#CANCL_DE#                                /* 해약일자          */   
			,#RESCI_RESN_CODE#                         /* 해약사유코드      */   
			,#RESCI_RESN_DETAIL#                       /* 해약사유상세      */
			,#BANK_CODE#                               /* 은행코드          */   
			,#DPSTR#                                   /* 예금주            */   
			,#ACNUTNO#                                 /* 계좌번호          */   
			,#LVHS_DE#                                 /* 퇴거일자          */   
			,#LVHS_ADRES#                              /* 퇴거주소          */   
			,#LVHS_TELNO#                              /* 퇴거전화번호      */   
			,#LVHS_MOBLPHON#                           /* 퇴거휴대폰        */   
		    ,#PENLTY_APPLC_AT#                         /* 위약금적용여부    */
		    ,#PENLTY#                                  /* 위약금            */
		    ,#PENLTY_INTRT#                            /* 위약금이율        */   
		    ,#ELCTRN_SANCTN_NO#                        /* 전자결재번호      */  
		    ,#CANCL_EXPNDTR_DECSN_NO#                  /* 해약지출결의번호  */   
			,#RM#                                      /* 비고              */   
			,#S_USER_ID#                               /* 등록자ID          */   
			,SYSDATE                                   /* 등록일시          */   
			,#S_USER_ID#                               /* 수정자ID          */   
			,SYSDATE                                   /* 수정일시          */
		  )
	  </insert>   
   <!-- 쿼리명     : 주택 분양 해약정보 저장
	        설명       : 주택 분양 해약정보 저장 쿼리문
	        작성자     : 정윤원
	        최초작성일 : 2015.12.24

	        수정일  수정자  수정내용
	   -->
	  
	  <insert id="SLS020208DAO.insertHouseLttotCancelInfo" parameterClass="java.util.Map">
	  /*  (1-1) 주택분양 해약정보 등록  */
	      INSERT INTO TBSLS_HOUSE_LTTOT_CANCL
		  (    
		     CNTRCTR_NO               /* 계약자번호 */   
            ,TOT_ENGG_AMOUNT          /* 총약정금액 */
            ,TOT_PAYAMT               /* 총납부금액 */
            ,RETURN_PAYAMT            /* 반환납부금액 */
            ,RETURN_ARRRG_AMOUNT      /* 반환연체금액 */
            ,RETURN_PAY_INTR          /* 반환납부이자 */
            ,INCMTAX                  /* 소득세 */
            ,IHNTS                    /* 주민세 */
            ,RETURN_INTRT             /* 반환이자이율 */
            ,ESTN_INTRT               /* 확장이율 */
            ,RETURN_INTR_PYMNT_AT     /* 반환이자지급여부 */
            ,REGISTER_ID              /* 등록자ID */
            ,REGIST_DT                /* 등록일시 */
            ,UPDUSR_ID                /* 수정자ID */
            ,UPDT_DT                  /* 수정일시 */
            
		  ) VALUES (
		     #CNTRCTR_NO#             /* 계약자번호 */   
            ,#TOT_ENGG_AMOUNT#        /* 총약정금액 */
            ,#TOT_PAYAMT#             /* 총납부금액 */
            ,#RETURN_PAYAMT#          /* 반환납부금액 */
            ,#RETURN_ARRRG_AMOUNT#    /* 반환연체금액 */
            ,#RETURN_PAY_INTR#        /* 반환납부이자 */
            ,#INCMTAX#                /* 소득세 */
            ,#IHNTS#                  /* 주민세 */
            ,#RETURN_INTRT#           /* 반환이자이율 */
            ,#ESTN_INTRT#             /* 확장이율 */
            ,#RETURN_INTR_PYMNT_AT#   /* 반환이자지급여부 */
			,#S_USER_ID#              /* 등록자ID */   
			,SYSDATE                  /* 등록일시 */   
			,#S_USER_ID#              /* 수정자ID */   
			,SYSDATE                  /* 수정일시 */
		  )
	  </insert>   
	  
    <!-- 쿼리명    : 주택계약 해약 납부정보 해약처리
	        설명       : 주택계약 해약 납부정보 해약처리 쿼리문
	        작성자     : 정윤원
	        최초작성일 : 2015.11.02

	        수정일  수정자  수정내용
	   -->
	   
	  <update id="SLS020208DAO.updateCancelLttotPayList" parameterClass="java.util.Map" >
	    /*  (2) 해지가 발생하며 입금되지 않은 납부정보에 대해서는 조회되지 않게 처리한다.   */
	    UPDATE TBSLS_HOUSE_LTTOT_PAY
           SET TRMNAT_UNUSED_AT = '1'                                                   /*  해지미사용여부   */
         WHERE CNTRCTR_NO = #CNTRCTR_NO#                                            /*  계약번호         */
           AND PAY_CODE LIKE 'R%'                                                    /*  납부코드 : 분양  */
           AND NOT EXISTS( SELECT RCPT_NO FROM TBSLS_HOUSE_RCIV T1
                            WHERE T1.CNTRCTR_NO    = #CNTRCTR_NO#  
                              AND T1.LTTOT_RENT_SE = #LTTOT_RENT_SE#                 /* 분양:01, 임대:02   */
                              AND T1.RCPT_NO       = TBSLS_HOUSE_LTTOT_PAY.PAY_NO )  /*  영수번호          */
	  </update>
	  
	  
	   <!-- 쿼리명    : 주택계약 해약 - 주택계약자 정보 해약처리
	        설명       : 주택계약 해약- 주택계약자 정보 해약처리 쿼리문
	        작성자     : 정윤원
	        최초작성일 : 2015.11.02

	        수정일  수정자  수정내용
	   --> 
	  
	  <update id="SLS020208DAO.updateCancelHcntrctrInfo" parameterClass="java.util.Map" >
	     /*  (3) 주택계약정보 해약처리   */
	     UPDATE TBSLS_HCNTRCTR
            SET CNTRCTR_STTUS_CODE = '02'    /* 계약상태코드:01(계약), 02(해약)  */
               ,UPDUSR_ID   = #S_USER_ID#     /* 최종수정자    */
               ,UPDT_DT     = SYSDATE         /* 최종수정일자  */
          WHERE CNTRCTR_NO = #CNTRCTR_NO#    /* 계약번호      */     
	  </update>
	  
	  
	    <!-- 쿼리명     : 주택계약 해약 주택결제정보 해지(자동이체)
	        설명       : 주택계약 해약 주택결제정보 해지(자동이체) 쿼리문
	        작성자     : 정윤원
	        최초작성일 : 2015.11.02

	        수정일  수정자  수정내용
	     -->   
	   <insert id="SLS020208DAO.insertHouseCancelSetleInfo" parameterClass="java.util.Map">
	     /*  (4-1) 자동이체 주택결제정보 해지 등록:기존 히스토리 테이블이 없으므로 마지막에 이체 정보(미사용)를 한건 추가함, (4-2)번 항목과 같이 실행함   */
		   INSERT INTO TBSLS_HOUSE_SETLE_INFO
			 (
				 CNTRCTR_NO          /* 계약자번호      */
				,SETLE_SN            /* 결제일련번호    */
				,SETLE_SE            /* 결제구분        */
				,REQST_DE            /* 신청일자        */
				,RELIS_DE            /* 해제일자        */
				,BANK_CODE           /* 은행코드        */
				,ACNUTNO             /* 계좌번호        */
				,DPSTR               /* 예금주          */
				,CHANGE_DE           /* 변경일자        */
				,SETLE_STTUS         /* 결제상태        */
				,PAY_SE              /* 납부구분        */
				,USE_AT              /* 사용여부        */
				,REGISTER_ID         /* 등록자ID        */
				,REGIST_DT           /* 등록일시        */
				,UPDUSR_ID           /* 수정자ID        */
				,UPDT_DT             /* 수정일시        */
				) 
				
				SELECT 
				     CNTRCTR_NO          /* 계약자번호      */
				    ,SETLE_SN +1         /* 결제일련번호    */
				    ,SETLE_SE            /* 결제구분        */
				    ,REQST_DE            /* 신청일자        */
				    ,#CANCL_DE#          /* 해제일자        */
				    ,BANK_CODE           /* 은행코드        */
				    ,ACNUTNO             /* 계좌번호        */
				    ,DPSTR               /* 예금주          */
				    ,CHANGE_DE           /* 변경일자        */
				    ,SETLE_STTUS         /* 결제상태        */
				    ,PAY_SE              /* 납부구분        */
				    ,'0'                 /* 사용여부        */
				    ,#S_USER_ID#         /* 등록자ID        */
				    ,SYSDATE             /* 등록일시        */
				    ,#S_USER_ID#         /* 수정자ID        */
				    ,SYSDATE             /* 수정일시        */
				 FROM TBSLS_HOUSE_SETLE_INFO        
				WHERE SETLE_SN =  ( SELECT MAX(SETLE_SN) FROM TBSLS_HOUSE_SETLE_INFO WHERE CNTRCTR_NO = #CNTRCTR_NO#)
			      AND CNTRCTR_NO = #CNTRCTR_NO#       /*    */
				   
	   
	   </insert>
	   
	    
	   <!-- 쿼리명     : 주택계약 해약 주택결제정보 해지(자동이체)사용중지
	        설명       : 주택계약 해약 주택결제정보 해지(자동이체) 쿼리문
	        작성자     : 정윤원
	        최초작성일 : 2015.11.02

	        수정일  수정자  수정내용
	    -->
	  
	  <update id="SLS020208DAO.updateCancelSetleInfo" parameterClass="java.util.Map" >
	   /* (4-2)  자동이체 - 이체 정보수정:히스토리 테이블 없으므로 기존 이제 정보를 모두 미사용으로 바꾼다.  */
        UPDATE TBSLS_HOUSE_SETLE_INFO 
             SET USE_AT     = '0'            /* 사용유무           */
                ,UPDUSR_ID  = #S_USER_ID#    /* 최종수정자         */
                ,UPDT_DT    = SYSDATE        /* 최종수정일         */
           WHERE CNTRCTR_NO = #CNTRCTR_NO#   /* 계약번호           */
	  
	  </update>
	  
	 
	 <!-- (5) 기타수입납부 등록 위약금 2016.03.29 -->
	 <insert id="SLS020208DAO.insertEtcIncmePay" parameterClass="java.util.Map">
	     	     
	     <selectKey keyProperty="SL_CLASS" resultClass="string">
			SELECT R.CHRCTR_PREPAR_VALUE_0 AS SL_CLASS
              FROM TBCOM_CMMN_CODE R
             WHERE R.GRP_CODE = 'HOU0A1'
               AND R.CODE = 'HC'
    	</selectKey>
    	
	     /*  (5) 기타수입납부 등록  */
		INSERT INTO TBSLS_ETC_INCME_PAY /* 기타수입납부 */ 
		         (
				  JOB_SE		         
		         ,CNTRCTR_NO
		         ,PAY_NO
		         ,PAY_CODE
		         ,MDAT_DE
		         ,RQEST_YM
		         ,PAY_TMLMT
		         ,PAYAMT
		         ,PROCESS_CN
		         ,REGISTER_ID         /* 등록자ID        */
				 ,REGIST_DT           /* 등록일시        */
				 ,UPDUSR_ID           /* 수정자ID        */
				 ,UPDT_DT             /* 수정일시        */
				 )
		       VALUES
		         (
		          'HOU'
		         ,#CNTRCTR_NO#
		         ,( SELECT #SL_CLASS# || LPAD(TO_CHAR(NVL(MAX(SUBSTR(PAY_NO, 2, 3)), 0) + 1), 3, '0') || '0'
					  FROM TBSLS_ETC_INCME_PAY  /* 기타수입납부 */					      
					 WHERE CNTRCTR_NO = #CNTRCTR_NO#
					   AND PAY_NO LIKE #SL_CLASS# || '%'
				  )
		         ,'T1'
		         ,#CANCL_DE#
		         ,SUBSTR(#CANCL_DE#, 0,6)
		         ,#CANCL_DE#
		         ,#PENLTY# /* 위약금 */
		         ,#RM#
		         ,#S_USER_ID#         /* 등록자ID        */
				 ,SYSDATE             /* 등록일시        */
				 ,#S_USER_ID#         /* 수정자ID        */
				 ,SYSDATE             /* 수정일시        */
				 )
	   
	   </insert>
	   
	   
	   	<!-- (6)해약처리/해약취소 시 월 임대료 조정 -->
		<procedure id="SLS020208DAO.SPSLS_HOUSE_RENT_PAY_CANCEL_UI" parameterClass="java.util.Map">
			{ call SPSLS_HOUSE_RENT_PAY_CANCEL_UI(#IN_FLAG#, #IN_FLAG1#, #IN_CNTRCTR_NO#, #IN_APPLY_DATE#, #IN_MDAT_DE#, #S_USER_ID#, #IN_HOUSE_CODE#, #IN_CAL_DATE# , #OUT_RESULT_CD#, #OUT_RESULT_MSG#) }
		</procedure>
	  
	    
<!--  계약해약      -->	    


	  
<!-- 주택 계약 해약 정보 삭제  -->	  
	  
	   <!-- 쿼리명    : 주택계약 해약 - 주택계약자 정보 해약처리 삭제
	        설명       : 주택계약 해약- 주택계약자 정보 해약처리 삭제 쿼리문
	        작성자     : 정윤원
	        최초작성일 : 2015.11.02

	        수정일  수정자  수정내용
	   --> 
	  
	<!--   <update id="SLS020208DAO.updateHcntrctrInfo" parameterClass="java.util.Map" >
	     /*  (1) 주택계약정보 해약처리   */
	     UPDATE TBSLS_HCNTRCTR
             SET CNTRCTR_STTUS_CODE = '01'    /* 계약상태코드  */
               ,UPDUSR_ID   = #S_USER_ID#     /* 최종수정자    */
               ,UPDT_DT     = SYSDATE         /* 최종수정일자  */
           WHERE CNTRCTR_NO = #CNTRCTR_NO#    /* 계약번호      */     
	  </update> -->
	  
	  
	   <!-- 쿼리명    : 주택계약 해약 납부정보 해약처리 취소
	        설명       : 주택계약 해약 납부정보 해약처리 취소 쿼리문
	        작성자     : 정윤원
	        최초작성일 : 2015.11.02

	        수정일  수정자  수정내용
	   -->
	   
	  <update id="SLS020208DAO.updateLttotPayList" parameterClass="java.util.Map" >
	    /*  (2) 해지가 발생하며 입금되지 않은 납부정보에 대해서는 조회되게 처리한다.   */
	    UPDATE TBSLS_HOUSE_LTTOT_PAY
          SET TRMNAT_UNUSED_AT = NULL                                                  /*  해지미사용여부   */
            WHERE CNTRCTR_NO = #CNTRCTR_NO#                                            /*  계약번호         */
             AND PAY_CODE LIKE #PAY_CODE_SE#||'%'                                      /*  납부코드 : 분양(S), 임대(R)  */
             AND NOT EXISTS( SELECT RCPT_NO FROM TBSLS_HOUSE_RCIV T1
                              WHERE T1.CNTRCTR_NO    = #CNTRCTR_NO#  
                                AND T1.LTTOT_RENT_SE = #LTTOT_RENT_SE#                 /* 분양:01, 임대:02   */
                                AND T1.RCPT_NO       = TBSLS_HOUSE_LTTOT_PAY.PAY_NO )  /*  영수번호          */
	  </update>
	  
	  
	  
	  <!-- 쿼리명      : 주택분양 해약정보 삭제
	        설명       : 주택분양 해약정보 삭제 쿼리문
	        작성자     : 정윤원
	        최초작성일 : 2015.12.24

	        수정일  수정자  수정내용
	   -->
	   
	  <delete id="SLS020208DAO.deleteHouseLttotCancelInfo" parameterClass="java.util.Map" >
	    /*  (3)주택 분양 해약정보 삭제 */
	    
	     DELETE FROM TBSLS_HOUSE_LTTOT_CANCL 
	      WHERE CNTRCTR_NO  = #CNTRCTR_NO# 
	     
	  </delete>
	  
	  
	  <!-- (4)기타수입납부 삭제 2016.03.30  -->
	  <delete id="SLS020208DAO.deleteEtcIncmePay" parameterClass="java.util.Map" >
	    
	    /*  (5)기타수입납부 삭제   */	    
	     DELETE FROM TBSLS_ETC_INCME_PAY 
	      WHERE CNTRCTR_NO  = #CNTRCTR_NO#
	      	AND PAY_TMLMT 	=  #CANCL_DE#
	       	AND JOB_SE 		= 'HOU'
	       	AND PAY_CODE 	= 'T1'	       	
	     
	  </delete>
	 

 <!-- 쿼리명          : 주택 임대 해약 리스트
           설명       : 주택 임대 해약 리스트 조회
	       작성자     : 정윤원
	       최초작성일 : 2015.12.23

	       수정일  수정자  수정내용
	   -->  	  

      <select id="SLS020208DAO.selectHouseRentCancelList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">

            SELECT      
/* 주택임대해약 상세  */                 
                '0' AS CHK
                ,T1.CNTRCTR_NO                                  /* 계약자번호 */
                ,NVL(T1.RNTCHRG_APPLC_AT,0) AS RNTCHRG_APPLC_AT /* 임대료적용여부 */
                ,NVL(T1.RNTCHRG ,0)         AS RNTCHRG          /* 임대료계 */
                ,NVL(T1.RESRVE_AMOUNT,0)    AS RESRVE_AMOUNT    /* 유보금액 */
                ,NVL(T1.INDMNTY_APPLC_AT,0) AS INDMNTY_APPLC_AT /* 배상금적용여부 */
                ,NVL(T1.INDMNTY ,0)         AS INDMNTY          /* 배상금 */
                ,T1.BANK_CODE_FCLTS                             /* 은행코드시설물 */
                ,SFCOM_CODE_NM ('COM021', T1.BANK_CODE_FCLTS, 'CODE_NM' ) AS BANK_NAME_FCLTS                             /* 은행코드시설물 */
                ,T1.DPSTR_FCLTS                                 /* 예금주시설물 */
                ,T1.ACNUT_NO_FCLTS                              /* 계좌번호시설물 */
                ,T1.RESRVE_AMOUNT_TREDE                         /* 유보금액처리일 */
                ,T1.RESRVE_AMOUNT_EXPNDTR_DECSN_NO              /* 유보금액지출결의번호 */
                ,T1.RESRVE_AMOUNT_BANK_CODE                     /* 유보금액은행코드 */
                ,T1.RESRVE_AMOUNT_DPSTR                         /* 유보금액예금주 */
                ,T1.RESRVE_AMOUNT_ACNUTNO                       /* 유보금액계좌번호 */
                ,T1.FCLTS_ELCTRN_SANCTN_NO                      /* 시설물전자결재번호 */
                ,NVL(T1.FCLTS_ABNRML_AT,0) AS FCLTS_ABNRML_AT   /* 시설물이상여부 */
                ,NVL(T1.INTR_INTRT,0)      AS INTR_INTRT        /* 이자이율 */
                ,T1.PAY_GTN                                     /* 납부보증금 */
                ,T1.PAY_TMLMT                                   /* 납부기한 */
                ,T1.OVDINTR                                     /* 연체이자 */
                ,T1.ARRRG_AMOUNT                                /* 연체금액 */
                ,T1.IDRK_CO                                     /* 기산일수 */
                ,T1.RNTCHRG_THSMON                              /* 임대료_당월 */
                ,T1.REGISTER_ID                                 /* 등록자ID */
                ,TO_CHAR(T1.REGIST_DT,'YYYYMMDD')  AS REGIST_DT /* 등록일시 */
                ,T1.UPDUSR_ID                                   /* 수정자ID */
                ,TO_CHAR(T1.UPDT_DT,'YYYYMMDD')    AS UPDT_DT   /* 수정일시 */
/* 주택해약정보 */
                ,NVL(T2.PENLTY_APPLC_AT,0) AS PENLTY_APPLC_AT   /* 위약금적용여부 */      
                ,T2.PENLTY                                      /* 위약금 */
                ,NVL(T2.PENLTY_INTRT,0) AS PENLTY_INTRT         /* 위약금이율 */            
            FROM TBSLS_HOUSE_RENT_CANCL   T1                    /* 주택임대해약 */
                ,TBSLS_HCNTRCTR_CANCL     T2                    /* 주택해약정보 */ 
           WHERE 1 = 1
             AND T1.CNTRCTR_NO     = #CNTRCTR_NO#
             AND T1.CNTRCTR_NO     = T2.CNTRCTR_NO    
	  </select>	  	  
	  
    <!-- 쿼리명    : 주택임대 이율정보 조회(신규시) 
           설명       : 주택임대 이율정보 조회(신규시)
	       작성자     : 정윤원
	       최초작성일 : 2015.12.15

	       수정일  수정자  수정내용
	   -->        
      <select id="SLS020208DAO.selectRentRatioInfo" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
         SELECT 
              SFPMS_GET_INTRT_RATE('HOU', #HOUSE_CODE# ,'R1', #CANCL_DE#, 0) RAT1   /*  임대해약- 위약금이율  */
             ,SFPMS_GET_INTRT_RATE('HOU', #HOUSE_CODE# ,'S1', #CANCL_DE#, 0) RAT2   /*  임대해약- 이자지율 */
         FROM DUAL
      
      </select> 
  
       <!-- 쿼리명    : 주택계약 해약(임대) 반환 금액 목록 
           설명       : 주택계약 해약(임대) 반환 금액 목록 조회
	       작성자     : 정윤원
	       최초작성일 : 2015.10.27

	       수정일  수정자  수정내용
	   -->        
      <select id="SLS020208DAO.selectHouseCancelRentReturnAmtList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		    
	      SELECT
			   NVL(S_BASS_GTN, 0) AS S_BASS_GTN             		/* (1)주택 기본 임대보증금 */
			  ,S_CONT_AMT                                           /* (2)주택 기본 계약금 */
			  ,S_RNTCHRG                                            /* (3)주택 기본 월임대료 */
			  ,NVL(SUM_PAYAMT, 0) AS SUM_PAYAMT                     /* (6)주택임대 납부보증금 합계(실 납부 보증금합계금액) (Bind:납부보증금(a)) */
			  ,S_PAY_TMLMT                                          /* (7)주택임대 납부기한일: 해약일 기준 당월 납부기한일 (Bind:납부기한일) */
			  ,S_RENT_AMT                                           /* (10-1) 미납임대료                                   (Bind:미납금액(b)) */
			  ,S_APPAY_AMT                                          /* (10-2) 연체이자 금액                                (Bind:연체이자) */
			  ,S_THSMON_RENT_AMT                                    /* (10-3) 당월임대료                                   (Bind:납부금액) */
			  
			  /* (10-4) 임대료계(임대료계산결과,공제금액,임대적용시대입):미납임대료 + 연체이자 + 당월임대료  */
			  <isNotEmpty property="RNTCHRG_APPLC_AT">
			      <isEqual property="RNTCHRG_APPLC_AT" compareValue="0">
	                ,0 AS S_RENT_SUM_AMT                                 /*  임대료계  */
			      </isEqual>
			      
			      <isEqual property="RNTCHRG_APPLC_AT" compareValue="1">
	                ,NVL(S_RENT_AMT + S_APPAY_AMT + S_THSMON_RENT_AMT,0) 
			           AS S_RENT_SUM_AMT                                 
			      </isEqual>
			      
			  </isNotEmpty>  
			 
			  /* (11) 위약금: */
			  /* 위약금 적용여부 0,1  */
			  /* 위약금 : 월간총임대료 * 24 * 위약금이율*0.01 */
		      /* 월간총임대료 : (임대보증금 * 이자이율*0.01 /12) + 월임대료 */ 
			  <isNotEmpty property="PENLTY_APPLC_AT">
			      <isEqual property="PENLTY_APPLC_AT" compareValue="0">
	                 , 0 AS S_PENLTY_AMT                                         /* 위약금  */
			      </isEqual>
			      <isEqual property="PENLTY_APPLC_AT" compareValue="1">
	                 , TRUNC( ( ( S_BASS_GTN * #INTR_INTRT# * 0.01 / 12) + S_RNTCHRG ) * 24 * #PENLTY_INTRT# * 0.01 ,-1) AS S_PENLTY_AMT  
			      </isEqual>
			  </isNotEmpty>  
			 
			  ,S_IDRK                                               /* (12) 기산일  */
			  ,DECODE(S_RNTCHRG,0,0
			          ,TRUNC( (S_RNTCHRG / S_MONTH_DD) * S_IDRK ,-1) 
			         ) AS S_RENT_AMT_C                              /* 임대료(C), (월임대료/월 총일수) * 기산일  */
			  ,S_INDMNTY                                            /* (13) 배상금: 임대종료일이 있는 경우만 해당  */
			  ,S_RESRVE_AMT                                         /* (14) 유보금  */
			  ,FCLTY_AMOUNT AS S_FCLTS_AMT                          /* (15)시설물  */
			  ,BND_AMOUNT AS S_BND_AMOUNT                          /* (15)시설물  */
			  , DSPTH_DE
			  ,'0' AS S_PYMNTAMT                                    /* (16)실지급액 */
			  ,'0' AS DDCAMOUNT                                     /* (17)공제금액 계 */
			  , S_MONTH_DD                                          /* (18)해약월 총일수 */			                         			
		  FROM (
			       SELECT
			        /*  (1)임대보증금  */
			            NVL( b.BASS_GTN
			                  ,(
			                       SELECT NVL(SUM(PAYAMT),0)
			                         FROM TBSLS_HOUSE_TYBY_PAY
			                        WHERE HOUSE_CODE   = b.HOUSE_CODE
			                          AND PAY_CODE LIKE 'R%'
			                          AND HOUSE_TY_CODE = b.HOUSE_TY_CODE
			                    )
			                ) AS S_BASS_GTN
			                
			
	                /*  (2)계약금  */
			                  ,(
			                       SELECT PAYAMT
			                         FROM  TBSLS_HOUSE_TYBY_PAY t10
			                        WHERE t1.HOUSE_CODE    = b.HOUSE_CODE
			                          AND t1.HOUSE_TY_CODE = b.HOUSE_TY_CODE
			                          AND t1.PAY_CODE IN('R0','S0')
			                   ) AS S_CONT_AMT
			
	                /*  (3)월임대료  */
			                ,NVL( b.BASS_RNTCHRG
			                       ,(
			                          SELECT NVL(RNTCHRG,0)
			                            FROM TBSLS_HOUSE_RNTCHRG t1
			                            WHERE CNTRCTR_NO   = a.CNTRCTR_NO
			                              AND t1.APPLC_DE  = ( SELECT MAX(APPLC_DE) FROM TBSLS_HOUSE_RNTCHRG WHERE CNTRCTR_NO = t1.CNTRCTR_NO)
			                        )
			                    ) AS S_RNTCHRG
			
			       /*  (6) 납부보증금 합계(실 납부 보증금합계금액)  */
			               ,(
			                    SELECT SUM( CASE
			                                <![CDATA[ WHEN ARRRG_AMOUNT >= 0  ]]>   /* 연체할인금액이 - 인경우 수납금액 */
			                                    THEN PAYAMT             /* 납부금액 */
			                                 ELSE RCIV_AMOUNT           /* 수납금액 */
			                            END )
			                      FROM TBSLS_HOUSE_LTTOT_PAY
			                     WHERE CNTRCTR_NO    = a.CNTRCTR_NO     /* 계약번호 */
			                       AND LTTOT_RENT_SE = 'R'              /* 분양,임화성분 */
			                       AND RCIV_DE IS NOT NULL              /* 수납일자 */
			                ) AS SUM_PAYAMT
			
	               /*  (7) 납부기한일: 해약일 기준 당월 납부기한일  */
			               ,(
			                    SELECT TO_CHAR(TO_DATE(PAY_TMLMT),'YYYYMMDD')
			                      FROM TBSLS_HOUSE_RENT_PAY       /* TBL:주택임대납부 */
			                     WHERE 1=1
			                       AND CNTRCTR_NO = a.CNTRCTR_NO
			                       AND TO_CHAR(TO_DATE(PAY_TMLMT),'YYYYMM') = TO_CHAR(TO_DATE(#CANCL_DE#),'YYYYMM')
			                 ) AS S_PAY_TMLMT
			
			
			       /*  (10-1) 미납임대료  */
			              ,NVL(
			                    ( SELECT NVL(SUM(MT_RNTCHRG + DFNNT_AMOUNT),0)  /* 월임대료 + 차액금액  */
			                       /*  삭제:         , NVL (SFSLS_HOUSE_APAY_CALC('A', a.HOUSE_CODE, 임대종료일,  PAY_TMLMT, MT_RNTCHRG + DFNNT_AMOUNT, 0, 'L' ), 0  ) AS APPAY_AMT  */
			                        FROM TBSLS_HOUSE_RENT_PAY
			                       WHERE CNTRCTR_NO = a.CNTRCTR_NO
			                         AND RCIV_DE IS NULL
			                        <![CDATA[ AND TO_CHAR(TO_DATE(PAY_TMLMT),'YYYYMM') < TO_CHAR(TO_DATE(#CANCL_DE#),'YYYYMM') ]]>
			                     )
			                 ,0) AS S_RENT_AMT
			
			       /*  (10-2) 연체이자 금액 : SUM   추가  */
			              ,NVL(
			                    ( SELECT SUM(
								             NVL(SFSLS_HOUSE_APAY_CALC('A', a.HOUSE_CODE, #CANCL_DE#,  PAY_TMLMT, MT_RNTCHRG + DFNNT_AMOUNT, 0, 'L' ), 0  ) 
											 ) AS APPAY_AMT
			                        FROM TBSLS_HOUSE_RENT_PAY
			                       WHERE CNTRCTR_NO = a.CNTRCTR_NO
			                         AND RCIV_DE IS NULL
			                        <![CDATA[ AND TO_CHAR(TO_DATE(PAY_TMLMT),'YYYYMM') < TO_CHAR(TO_DATE(#CANCL_DE#),'YYYYMM') ]]>
			                     )
			                 ,0) AS S_APPAY_AMT
			
			       /*  (10-3) 당월임대료  */
			              ,NVL( 
			                     (
			                       SELECT NVL(SFSLS_HOUSE_THSMON_RENT_CAL(a.CNTRCTR_NO, #CANCL_DE#),0) FROM DUAL
			                     )
			                  ,0)  AS S_THSMON_RENT_AMT
			
			        /*  (10-4) 임대료계:미납임대료 + 연체이자 + 당월임대료  */
			              /* , (S_RENT_AMT + S_APPAY_AMT + S_THSMON_RENT_AMT ) AS S_RENT_SUM_AMT  */
			
			        /*  (11) 위약금액  */
			              ,'0' AS S_PENLTY_AMT
			       
			        /*  (12) 기산일  */
			              ,(
			                 TO_CHAR(  TO_DATE(#CANCL_DE#) - TO_DATE( TO_CHAR( TO_DATE(#CANCL_DE#)  ,'YYYYMM'  )||'01') + 1 )
			                ) AS S_IDRK
			
			        /* (13) 배상금: 임대종료일이 있는 경우만 해당  */
		               <isNotEmpty property="INDMNTY_APPLC_AT">
		                   <isEqual property="INDMNTY_APPLC_AT" compareValue="0">
		                   , 0 AS S_INDMNTY
		                   </isEqual>
		                   <isEqual property="INDMNTY_APPLC_AT" compareValue="1">
		                     NVL( (
			                        CASE WHEN #RENT_ENDDE# IS NOT NULL
			                            THEN DECODE(a.HOUSE_CODE,'123'
			                                         ,SFSLS_270_DAMAGE_123(#CNTRCTR_NO#, #RENT_ENDDE#, #RENT_LTTOT_CNVRS_DE#)
			                                         ,SFSLS_270_DAMAGE(#CNTRCTR_NO#, #RENT_ENDDE#, #RENT_LTTOT_CNVRS_DE#)
			                                        )
			                         END
			                   ) ,0) AS S_INDMNTY
			                   
		                   </isEqual>
		               </isNotEmpty>

			       
			        /*  (14) 유보금  */
			                /*  
			                ,NVL(
			                      ( 
			                       SELECT NVL(RESRVE_AMOUNT,0)
			                         FROM  TBSLS_HOUSE_RENT_CANCL
			                        WHERE  CNTRCTR_NO = a.CNTRCTR_NO
			                       )
			                   ,0) AS S_RESRVE_AMT
			                  */   
			                   
                       ,NVL(#RESRVE_AMT# ,0) AS S_RESRVE_AMT
			       
			        /*  (15) 시설물 수선금액 */
			           
                               ,NVL(
                                       ( 
                                         SELECT NVL(FCLTY_RPAIRS_AMOUNT,0)  
                                           FROM TBSLS_CHCK_DSPTH
                                          WHERE HOUSE_CODE = a.HOUSE_CODE
                                            AND DONG       = a.DONG
                                            AND HO         = a.HO
                                            AND CNTRCTR_NO = a.CNTRCTR_NO    
                                        )
                                  ,0 ) AS FCLTY_AMOUNT     
			       
			        /*  (16)부담금액 */
			           
                               ,NVL(
                                       ( 
                                         SELECT NVL(BND_AMOUNT,0) 
                                           FROM TBSLS_CHCK_DSPTH
                                          WHERE HOUSE_CODE = a.HOUSE_CODE
                                            AND DONG       = a.DONG
                                            AND HO         = a.HO
                                            AND CNTRCTR_NO = a.CNTRCTR_NO    
                                        )
                                  ,0 ) AS BND_AMOUNT     

			        /*  (17) 점검통지일자 */
			           
                               ,NVL(
                                       ( 
                                         SELECT TO_CHAR(DSPTH_DE, 'YYYYMMDD') 
                                           FROM TBSLS_CHCK_DSPTH
                                          WHERE HOUSE_CODE = a.HOUSE_CODE
                                            AND DONG       = a.DONG
                                            AND HO         = a.HO
                                            AND CNTRCTR_NO = a.CNTRCTR_NO    
                                        )
                                  , '' ) AS DSPTH_DE     
			       
			       /*  (18) 해약월 총일수 */
			                   , TO_CHAR(LAST_DAY(#CANCL_DE#),'DD') AS S_MONTH_DD
			       
			            FROM
			                 TBSLS_HCNTRCTR      a         /* TBL:주택계약자 */
			               , TBSLS_HOUSE_DONG_HO b         /* TBL:주택동호  */
			
			           WHERE 1 = 1
			             AND a.CNTRCTR_NO  = #CNTRCTR_NO#  /* 계약번호 */
			             AND a.HOUSE_CODE  = b.HOUSE_CODE  /* 주택코드 */
			             AND a.DONG        = b.DONG        /* 동 */
			             AND a.HO          = b.HO          /* 호 */
			
			      )
			           
	  </select>
	  
	  		           
   <!-- 쿼리명    : 주택계약 임대 보증금 조회
       설명       : 주택계약 임대 보증금 조회
	   작성자     : 정윤원
	       최초작성일 : 2015.10.27

	       수정일  수정자  수정내용
	   -->        
      <select id="SLS020208DAO.selectRenLttotPayList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
         SELECT  
              CNTRCTR_NO                                           /* 계약번호 */
             ,SFCMP_GET_CODENM('HOU0A1',PAY_CODE) AS PAY_CODE_NM   /* 납부코드 */
             ,PAY_TMLMT                                            /* 납부기한일 */
            , <![CDATA[ 
               ( CASE WHEN ARRRG_AMOUNT >= 0    
               ]]>                                                 /* 연체할인금액이 - 인경우 수납금액 */
                    THEN PAYAMT                                    /* 납부금액 */
               ELSE RCIV_AMOUNT                                    /* 수납금액 */
                END ) AS PAYAMT
           FROM TBSLS_HOUSE_LTTOT_PAY WHERE CNTRCTR_NO = #CNTRCTR_NO#
            AND LTTOT_RENT_SE = 'R'                                /* 분양,임화성분 */
            AND RCIV_DE IS NOT NULL                                /* 수납일자      */
          ORDER BY PAY_TMLMT,PAY_CODE,RCIV_DE                      /* 납부기한일, 납부코드,수납일자 */
      
      </select>
	  
  <!-- 쿼리명     : 주택계약 해약정보(임대) -시설점검의뢰 조회
           설명       : 주택계약 해약정보(임대) -시설점검의뢰 조회
	       작성자     : 정윤원
	       최초작성일 : 2015.12.30

	       수정일  수정자  수정내용
	   -->  	  

      <select id="SLS020208DAO.selectRentCancelChckReqestInfo" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">

            SELECT 
                HOUSE_CODE                  /* 주택코드 */
               ,DONG                        /* 동 */
               ,HO                          /* 호 */
               ,CHCK_SN                     /* 점검순번 */
               ,CANCL_DE                    /* 해약일자 */
               ,CHCK_EMPNO                  /* 점검사번 */
               ,CNTRCTR_NO                  /* 계약자번호 */
               ,HOUSE_NM                    /* 주택명 */
               ,CNTRCTR_NM                  /* 계약자명 */
               ,HOUSE_SUPLY_SE              /* 주택공급구분 */
               ,CNTRCTR_CTTPC               /* 계약자연락처 */
               ,LVHS_PREARNGE_DE            /* 퇴거예정일자 */
               ,CHCK_BGNDE                  /* 점검시작일자 */
               ,CHCK_ENDDE                  /* 점검종료일자 */
               ,DLIV_MATTER                 /* 전달사항 */
               ,REFER_MATTER                /* 참고사항 */
               ,REGISTER_ID                 /* 등록자ID */
               ,REGIST_DT                   /* 등록일시 */
               ,UPDUSR_ID                   /* 수정자ID */
               ,UPDT_DT                     /* 수정일시 */
               ,ELCTRN_SANCTN_NO
		  	   ,SANCTN_AT 
          FROM TBSLS_CHCK_REQEST            /* 검검의뢰 */
         WHERE HOUSE_CODE = #HOUSE_CODE#    /* 주택코드 */
           AND DONG       = #DONG#          /* 동 */
           AND HO         = #HO#            /* 호 */
           AND CNTRCTR_NO = #CNTRCTR_NO#    /* 계약번호 */   
           <isNotEmpty property="SANCTN_AT">
           AND SANCTN_AT = #SANCTN_AT#
           </isNotEmpty>   

	  </select>	  	  
  <!-- 쿼리명    : 주택계약 해약정보(임대) -시설점검 통보 조회
           설명       : 주택계약 해약정보(임대) -시설점검 통보 조회
	       작성자     : 정윤원
	       최초작성일 : 2015.12.30

	       수정일  수정자  수정내용
	   -->  	  

      <select id="SLS020208DAO.selectRentCancelChckDspthInfo" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">

            SELECT 
                HOUSE_CODE                        /* 주택코드  */
               ,DONG                              /* 동 */
               ,HO                                /* 호 */
               ,CHCK_SN                           /* 점검순번 */
               ,RCEPT_DE                          /* 접수일자 */
               ,CHCK_EMPNO                        /* 점검사번 */
               ,CNTRCTR_NO                        /* 계약자번호 */
               ,HOUSE_NM                          /* 주택명 */
               ,CNTRCTR_NM                        /* 계약자명 */
               ,HOUSE_SUPLY_SE                    /* 주택공급구분 */
               ,CNTRCTR_CTTPC                     /* 계약자연락처 */
               ,LVHS_DE                           /* 퇴거일자 */
               ,CHCK_DE                           /* 점검일자 */
               ,BND_AMOUNT                        /* 부담금액 */
               ,CHCK_DTLS                         /* 점검내역 */
               ,RPAIRS_DTLS                       /* 보수내역 */
               ,FCLTY_RPAIRS_AMOUNT               /* 시설수선금액 */
               ,REGISTER_ID                       /* 등록자ID */
               ,REGIST_DT                         /* 등록일시 */
               ,UPDUSR_ID                         /* 수정자ID */
               ,UPDT_DT                           /* 수정일시 */
		  	     
            FROM TBSLS_CHCK_DSPTH                 /* 점검통보 */
           WHERE HOUSE_CODE       = #HOUSE_CODE#  /* 주택코드 */
             AND DONG             = #DONG#        /* 동 */
             AND HO               = #HO#          /* 호 */
             AND CNTRCTR_NO       = #CNTRCTR_NO#  /* 계약번호 */         
	  </select>	 
	  
      <!-- 쿼리명      : 주택계약 해약정보(임대) -시설점검의뢰 저장
	        설명       : 주택계약 해약정보(임대) -시설점검의뢰 저장 쿼리문
	        작성자     : 정윤원
	        최초작성일 : 2015.12.24

	        수정일  수정자  수정내용
	   -->
	  <insert id="SLS020208DAO.insertRentCancelReqestInfo" parameterClass="java.util.Map">
/* 시설점검의뢰  */
	      INSERT INTO TBSLS_CHCK_REQEST
		  (    
		     HOUSE_CODE          /* 주택코드       */
            ,DONG                /* 동             */
            ,HO                  /* 호             */
            ,CHCK_SN             /* 점검순번       */
            ,CANCL_DE            /* 해약일자       */
            ,CHCK_EMPNO          /* 점검사번       */
            ,CNTRCTR_NO          /* 계약자번호     */
            ,HOUSE_NM            /* 주택명         */
            ,CNTRCTR_NM          /* 계약자명       */
            ,HOUSE_SUPLY_SE      /* 주택공급구분   */
            ,CNTRCTR_CTTPC       /* 계약자연락처   */
            ,LVHS_PREARNGE_DE    /* 퇴거예정일자   */
            ,CHCK_BGNDE          /* 점검시작일자   */
            ,CHCK_ENDDE          /* 점검종료일자   */
            ,DLIV_MATTER         /* 전달사항       */
            ,REFER_MATTER        /* 참고사항       */
            ,REGISTER_ID         /* 등록자ID       */
            ,REGIST_DT           /* 등록일시       */
            ,UPDUSR_ID           /* 수정자ID       */
            ,UPDT_DT             /* 수정일시       */
            
		  ) VALUES (
		     #HOUSE_CODE#          /* 주택코드       */
            ,#DONG#                /* 동             */
            ,#HO#                  /* 호             */
            ,(
                SELECT NVL(MAX(CHCK_SN),0) + 1 
                  FROM TBSLS_CHCK_REQEST
                 WHERE HOUSE_CODE = #HOUSE_CODE#
                   AND DONG       = #DONG#
                   AND HO         = #HO#          /* 점검순번 */
             )     
            ,#CANCL_DE#            /* 해약일자       */
            ,#S_USER_ID#          /* 점검사번       */
            ,#CNTRCTR_NO#          /* 계약자번호     */
            ,#HOUSE_NM#            /* 주택명         */
            ,#CNTRCTR_NM#          /* 계약자명       */
            ,#HOUSE_SUPLY_SE#      /* 주택공급구분   */
            ,#CNTRCTR_CTTPC#       /* 계약자연락처   */
            ,#LVHS_PREARNGE_DE#    /* 퇴거예정일자   */
            ,#CHCK_BGNDE#          /* 점검시작일자   */
            ,#CHCK_ENDDE#          /* 점검종료일자   */
            ,#DLIV_MATTER#         /* 전달사항       */
            ,#REFER_MATTER#        /* 참고사항       */
            ,#S_USER_ID#           /* 등록자ID       */
            ,SYSDATE               /* 등록일시       */
            ,#S_USER_ID#           /* 수정자ID       */
            ,SYSDATE               /* 수정일시       */
		  )
	  </insert>
 
	  <!-- 쿼리명      : 주택 임대 해약정보 저장
	        설명       : 주택 분양 해약정보 저장 쿼리문
	        작성자     : 정윤원
	        최초작성일 : 2015.12.29

	        수정일  수정자  수정내용
	   -->
	  <insert id="SLS020208DAO.insertHouseRentCancelInfo" parameterClass="java.util.Map">
	  /*  (1-2) 주택임대 해약정보 등록  */
	    INSERT INTO TBSLS_HOUSE_RENT_CANCL
		(
		    CNTRCTR_NO         /* 계약자번호 */          
		   ,RNTCHRG_APPLC_AT   /* 임대료적용여부 */
		   ,RNTCHRG            /* 임대료 */
		   ,RESRVE_AMOUNT      /* 유보금액 */
		   ,INDMNTY_APPLC_AT   /* 배상금적용여부 */
		   ,INDMNTY            /* 배상금 */
		   ,INTR_INTRT         /* 이자이율 */
		   ,PAY_GTN            /* 납부보증금 */
		   ,PAY_TMLMT          /* 납부기한 */
		   ,OVDINTR            /* 연체이자 */
		   ,ARRRG_AMOUNT       /* 연체금액 */
		   ,IDRK_CO            /* 기산일수 */
		   ,RNTCHRG_THSMON     /* 임대료_당월 */
		   ,REGISTER_ID        /* 등록자ID */
		   ,REGIST_DT          /* 등록일시 */
		   ,UPDUSR_ID          /* 수정자ID */
		   ,UPDT_DT            /* 수정일시 */
		   
		) VALUES(
		
		   #CNTRCTR_NO#        /* 계약자번호 */          
		  ,#RNTCHRG_APPLC_AT#  /* 임대료적용여부 */
		  ,#RNTCHRG#           /* 임대료 */
		  ,#RESRVE_AMOUNT#     /* 유보금액 */
		  ,#INDMNTY_APPLC_AT#  /* 배상금적용여부 */
		  ,#INDMNTY#           /* 배상금 */
		  ,#INTR_INTRT#        /* 이자이율 */
		  ,#PAY_GTN#           /* 납부보증금 */
		  ,#PAY_TMLMT#         /* 납부기한 */
		  ,#OVDINTR#           /* 연체이자 */
		  ,#ARRRG_AMOUNT#      /* 연체금액 */
		  ,#IDRK_CO#           /* 기산일수 */
		  ,#RNTCHRG_THSMON#    /* 임대료_당월 */
		  ,#S_USER_ID#         /* 등록자ID */
		  ,SYSDATE             /* 등록일시 */
		  ,#S_USER_ID#         /* 수정자ID */
		  ,SYSDATE             /* 수정일시 */
		)
	  </insert>   
	  
	  
	  <!-- 시설점검의뢰 수정 -->
	  <update id="SLS020208DAO.updateRentCancelReqestInfo" parameterClass="java.util.Map" >
	     
	     UPDATE TBSLS_CHCK_REQEST
            SET LVHS_PREARNGE_DE = #LVHS_PREARNGE_DE#   /* 퇴거예정일자   */
	           ,CHCK_BGNDE       = #CHCK_BGNDE#   /* 점검시작일자   */
	           ,CHCK_ENDDE       = #CHCK_ENDDE#   /* 점검종료일자   */
	           ,DLIV_MATTER      = #DLIV_MATTER#   /* 전달사항       */
	           ,REFER_MATTER     = #REFER_MATTER#   /* 참고사항       */
               ,UPDUSR_ID   	 = #S_USER_ID#     /* 최종수정자    */
               ,UPDT_DT     	 = SYSDATE         /* 최종수정일자  */
         WHERE  HOUSE_CODE 		 = #HOUSE_CODE#    /* 주택코드 */
           AND DONG       		 = #DONG#          /* 동 */
           AND HO         		 = #HO#            /* 호 */
           AND CHCK_SN 			 = #CHCK_SN#    /* 점검순번 */
           
           
	  </update>
	  
	  
	  <!-- 시설점검의뢰 삭제 -->
	  <delete id="SLS020208DAO.deleteRentCancelReqestInfo" parameterClass="java.util.Map" >

	      DELETE FROM TBSLS_CHCK_REQEST      
           WHERE HOUSE_CODE = #HOUSE_CODE#   /* 주택코드 */
             AND DONG       = #DONG#         /* 동 */
             AND HO         = #HO#           /* 호 */
             AND CHCK_SN 	= #CHCK_SN#   /* 점검순번 */
             
	  </delete>  
	  
	  
	  
       <!-- 쿼리명    : 주택계약 해약정보(임대) -시설점검 통보 조회
           설명       : 주택계약 해약정보(임대) -시설점검 통보 조회
	       작성자     : 정윤원
	       최초작성일 : 2015.12.30

	       수정일  수정자  수정내용
	   -->  	  

	<!-- 전자결재 결재번호 업데이트  -->
	<update id="SLS020208DAO.approveU" parameterClass="java.util.HashMap">
		UPDATE TBSLS_HCNTRCTR_CANCL A
		   SET ELCTRN_SANCTN_NO  = (SELECT SANCTN_NO FROM TBCOM_ELCTRN_SANCTN_MASTR WHERE INTRLCK_IDNTFR = #KEY#)
			  ,UPDUSR_ID  	=  #S_USER_ID#
			  ,UPDT_DT		=  SYSDATE			  
		 WHERE CNTRCTR_NO   = #CNTRCTR_NO#
	</update>
	
	<!-- 전자결재 결재번호 업데이트  -->
	<update id="SLS020208DAO.approveU2" parameterClass="java.util.HashMap">
		UPDATE TBSLS_CHCK_REQEST A
		   SET ELCTRN_SANCTN_NO  = (SELECT SANCTN_NO FROM TBCOM_ELCTRN_SANCTN_MASTR WHERE INTRLCK_IDNTFR = #KEY#)
			  ,UPDUSR_ID  	=  #S_USER_ID#
			  ,UPDT_DT		=  SYSDATE			  
		 WHERE CNTRCTR_NO   = #CNTRCTR_NO#
          
	</update>	  
	
	  
	   <!-- 쿼리명     : 주택 임대 해약 정보 삭제
	        설명       : 주택 분양 해약 정보 삭제 삭제 쿼리문
	        작성자     : 정윤원
	        최초작성일 : 2015.11.02

	        수정일  수정자  수정내용
	   -->
	   
	  <delete id="SLS020208DAO.deleteHouseRentCancelInfo" parameterClass="java.util.Map" >
	    /*  (3-C)주택 임대 해약정보 삭제 */
	    
	     DELETE FROM TBSLS_HOUSE_RENT_CANCL 
	      WHERE CNTRCTR_NO  = #CNTRCTR_NO# 
	     
	  </delete>
	  
	   <!-- 쿼리명     : 주택계약 해약 삭제
	        설명       : 주택계약 해약 삭제 쿼리문
	        작성자     : 정윤원
	        최초작성일 : 2015.11.02

	        수정일  수정자  수정내용
	   -->
	   
	  <delete id="SLS020208DAO.deleteHcntrctrCancelInfo" parameterClass="java.util.Map" >
	    /*  (5)주택 해약정보 삭제 */
	    
	     DELETE FROM TBSLS_HCNTRCTR_CANCL 
	      WHERE CNTRCTR_NO  = #CNTRCTR_NO# 
	     
	  </delete>
  
	<!--(7) 차액금액 가져오기 2016.04.01  -->
	<select id="SLS020208DAO.selectDfnntAmount" parameterClass="java.util.Map" resultClass="String">
		 SELECT NVL(DFNNT_AMOUNT, 0) AS DFNNT_AMOUNT
		   FROM TBSLS_HOUSE_RENT_PAY
		  WHERE CNTRCTR_NO 	= #CNTRCTR_NO#
		    AND RQEST_YM 	= SUBSTR(#CANCL_DE#, 0,6)
		    AND RCIV_DE IS NULL
	</select>
	  
	<!-- 차액금액 수정 -->
	<update id="SLS020208DAO.updateDfnntAmount" parameterClass="java.util.Map" >
	     /*  (7) 차액금액 수정   */
		UPDATE TBSLS_HOUSE_RENT_PAY
		   SET DFNNT_AMOUNT = 0
		 WHERE CNTRCTR_NO 	= #CNTRCTR_NO#
		   AND RQEST_YM 	= SUBSTR(#CANCL_DE#, 0,6)
		   AND RCIV_DE IS NULL
	</update>
	  
	<!-- 주택결의 삭제 -->
	<delete id="SLS020208DAO.deleteHouseDecsn" parameterClass="java.util.Map" >
	     /*  (7) 주택결의 삭제   */
		DELETE TBSLS_HOUSE_DECSN
         WHERE DECSN_SE = #DECSN_SE#
           AND DECSN_DE = #CANCL_DE#
           AND PAY_SE   = '2'
           AND CNTRCTR_NO = #CNTRCTR_NO#
	</delete>	  
	  
	<!-- 당월임대료 삭제 -->
	<delete id="SLS020208DAO.deleteHouseRentPay" parameterClass="java.util.Map" >
	     /*  (7) 당월임대료 삭제   */
		DELETE TBSLS_HOUSE_RENT_PAY
         WHERE CNTRCTR_NO	= #CNTRCTR_NO#
           AND RQEST_YM  	= SUBSTR(#CANCL_DE#, 0,6)
           AND RCIV_DE IS NULL
	</delete>
	  
  <!-- 쿼리명     : 주택 임대 점검통보 내용삭제
	        설명       : 주택 임대 점검통보 내용삭제
	        작성자     : 정윤원
	        최초작성일 : 2015.12.29

	        수정일  수정자  수정내용
	   -->
	  <delete id="SLS020208DAO.deleteHouseCheckDspth" parameterClass="java.util.Map" >
	    /*  (3-B)주택 임대 점검통보 삭제 */
	      DELETE FROM TBSLS_CHCK_DSPTH       /* 점검통보  */
           WHERE HOUSE_CODE = #HOUSE_CODE#   /* 주택코드 */
             AND DONG       = #DONG#         /* 동 */
             AND HO         = #HO#           /* 호 */
             AND CNTRCTR_NO = #CNTRCTR_NO#   /* 계약번호 */
	  </delete>
	  
<!-- 쿼리명     : 주택 임대 점검의뢰 내용삭제
	        설명       : 주택 임대 점검의뢰 내용삭제
	        작성자     : 정윤원
	        최초작성일 : 2015.12.29

	        수정일  수정자  수정내용
	   -->
	  <delete id="SLS020208DAO.deleteHouseCheckReqest" parameterClass="java.util.Map" >
	    /*  (3-A)주택 임대 점검의뢰 삭제 */
	      DELETE FROM TBSLS_CHCK_REQEST       /* 점검통보  */
           WHERE HOUSE_CODE = #HOUSE_CODE#   /* 주택코드 */
             AND DONG       = #DONG#         /* 동 */
             AND HO         = #HO#           /* 호 */
           
             AND CNTRCTR_NO = #CNTRCTR_NO#    /* 계약번호 */
           
	  </delete>  


<!-- 쿼리명 : 계약상세 조회
	설명 : 계약상세 조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 박태혁
	최초작성일 : 2016.07.27
	-->
	<select id="SLS020208DAO.selectCountDate" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT TO_CHAR(TO_DATE(#CHG_DE#, 'YYYYMMDD') + #DAY_CNT1#, 'YYYYMMDD') AS IN_DATE1,
		       TO_CHAR(TO_DATE(#CHG_DE#, 'YYYYMMDD') + #DAY_CNT2#, 'YYYYMMDD') AS IN_DATE2,
		       TO_CHAR(TO_DATE(#CHG_DE#, 'YYYYMMDD') + #DAY_CNT3#, 'YYYYMMDD') AS IN_DATE3,
		       #DAY_CNT1# AS DAY_CNT1,
		       #DAY_CNT2# AS DAY_CNT2, 
		       #DAY_CNT3# AS DAY_CNT3,
		       #CHG_DE# AS CHG_DE  
		FROM DUAL
	</select>
	
	<select id="SLS020208DAO.selectChangeInfo" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT (SELECT RENT_LTTOT_CNVRS_DE FROM TBSLS_HCNTRCTR WHERE CNTRCTR_NO = #CNTRCTR_NO#) AS RENT_LTTOT_CNVRS_DE, 
		       (SELECT SUM (a.PAYAMT) AS PAYAMT
		          FROM TBSLS_HOUSE_TYBY_PAY a, TBSLS_HOUSE_TY c
		         WHERE EXISTS (
		                  SELECT 1
		                    FROM TBSLS_HCNTRCTR h, TBSLS_HOUSE_DONG_HO dh
		                   WHERE CNTRCTR_NO = #CNTRCTR_NO#
		                     AND H.HOUSE_CODE = dh.HOUSE_CODE
		                     AND H.DONG = dh.DONG
		                     AND H.HO = dh.HO
		                     AND dh.HOUSE_CODE = a.HOUSE_CODE
		                     AND dh.HOUSE_TY_CODE = a.HOUSE_TY_CODE
		                     )
		           AND a.PAY_CODE LIKE 'R%'
		           AND a.ENGG_SE = '01'
		           AND a.HOUSE_CODE = c.HOUSE_CODE
		           AND a.HOUSE_TY_CODE = c.HOUSE_TY_CODE) AS PAY_AMT,		           
	  <![CDATA[(SELECT NVL(SUM(CASE
		                       WHEN ARRRG_AMOUNT < 0
		                          THEN RCIV_AMOUNT
		                       WHEN ARRRG_AMOUNT >= 0
		                          THEN PAYAMT
		                       ELSE 0
		                    END
		                   ), 0)  ]]>		                  
		          FROM TBSLS_HOUSE_LTTOT_PAY
		         WHERE CNTRCTR_NO = #CNTRCTR_NO#
		           AND PAY_CODE LIKE 'R%'
		           AND RCIV_DE IS NOT NULL) REC_AMT
		  FROM dual	
	</select>
	
<!-- 
쿼리명 : 전세주택 분양전환  및 취소 프로시저
설명 : 전세주택 분양전환 및 취소 프로시저
수정일  		수정자  	수정내용
작성자 : 이광원
최초작성일 : 2016.1.19
-->
<parameterMap id="spsls_house_sr_change_jun_param" class="java.util.HashMap">
	<parameter property="IN_FLAG"		    jdbcType="VARCHAR"	javaType="string" 	mode="IN" />
	<parameter property="IN_CNTRCTR_NO"		jdbcType="VARCHAR"	javaType="string" 	mode="IN" />
	<parameter property="IN_SR_CHG_DATE"	jdbcType="VARCHAR"	javaType="string" 	mode="IN" />
	<parameter property="IN_PAYEND_DATE_S1"	jdbcType="VARCHAR"	javaType="string" 	mode="IN" />	
	<parameter property="IN_PAYEND_DATE_S9"	jdbcType="VARCHAR"	javaType="string" 	mode="IN" />
	<parameter property="IN_APPLY_DATE_S9"	jdbcType="VARCHAR"	javaType="string" 	mode="IN" />
	<parameter property="S_USER_ID"		    jdbcType="VARCHAR"	javaType="string" 	mode="IN" />
</parameterMap>

<procedure id="SLS020208DAO.SPSLS_HOUSE_SR_CHANGE_JUN" parameterMap="spsls_house_sr_change_jun_param">
	{ call SPSLS_HOUSE_SR_CHANGE_JUN(?, ?, ?, ?, ?, ?, ?) }
</procedure>
 <!-- 쿼리명     : 주택계약자변경 리스트
	        설명       : 주택계약변경 조회
	        작성자     : 정윤원
	        최초작성일 : 2015.09.04

	        수정일  수정자  수정내용
	   -->        
      <select id="SLS020208DAO.selectHcntrctrChangeList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		
			SELECT 
			    '0'                  AS   CHK        /* 체크및 박스             */

/* 기본 정보 */
			    ,T1.CNTRCTR_NO                        /*계약자번호               */ 
			    ,T1.CHANGE_SE                         /*변경구분                 */
			    ,T1.CHANGE_SN                         /*변경일련번호             */
			    ,T1.CHANGE_DE                         /*변경일자                 */
			    ,T1.CHGHY_CODE                        /*변경사유코드             */
			    ,T1.CHANGE_ATCHMNFL_COURS             /*변경첨부파일경로         */
			    ,T1.CHANGE_ATCHMNFL                   /*변경첨부파일             */
			    ,T1.CONFM_COMPT_AT                    /*승인완료여부             */
			    ,T1.HOUSE_CSTMR_NO_BFCHG              /*주택고객번호_변경전      */
			    ,T1.BFCHG_BDNBR                       /*변경전건물번호           */
			    ,T1.BFCHG_NMCHANGE_SN                 /*변경전명의변경일련번호   */
			    ,T1.BFCHG_QUALF_SE                    /*변경전자격구분           */
		        ,T1.BFCHG_SEIZR_DE                    /*변경전압류일             */
			    ,T1.BFCHG_SEIZR_AMOUNT                /*변경전압류금액           */
			    ,T1.BFCHG_SEIZR_RCIV_AMOUNT           /*변경전압류수납금액       */
			    ,T1.BFCHG_LON_DE                      /*변경전대출일             */
			    ,T1.BFCHG_LON_AMOUNT                  /*변경전대출금액           */
			    ,T1.BFCHG_LON_BANK                    /*변경전대출은행           */
			    ,T1.BFCHG_KJF_DE                      /*변경전국민주택기금일     */
			    ,T1.BFCHG_KJF_AMOUNT                  /*변경전국민주택기금금액   */
			    ,T1.BFCHG_SEIZR_CRDTR_NM              /*변경전압류채권자명       */
			    ,T1.BFCHG_RM                          /*변경전 비고              */ 
			    ,T1.SANCTN_NO                         /*결재번호                 */
			    ,T1.HOUSE_CSTMR_NO                    /*주택고객번호             */
			    ,T1.APPLC_AT                          /*적용여부                 */
			    ,T1.CTTPC_BFCHG                       /*연락처_변경전(기타연락처)*/
			    ,T1.CTTPC_AFTCH                       /*연락처_변경후(기타연락처)*/
			    ,T1.RM                                /*비고(변경후)             */
			    ,T1.REGISTER_ID                       /*등록자ID                 */
			    ,T1.REGIST_DT                         /*등록일시                 */
			    ,T1.UPDUSR_ID                         /*수정자ID                 */
			    ,T1.UPDT_DT                           /*수정일시                 */
			    
/* 고객정보(변경전) */              
   
			    ,T2.HOUSE_CSTMR_NO AS HOUSE_CSTMR_NO_BF /*주택고객번호            */
			    ,T2.CSTMR_NM             AS NM_BF             /*성명                    */
			    ,SFCOM_DEC_ALL(T2.IHIDNUM)        AS IHIDNUM_BF        /*주민등록번호            */
			    ,T2.ZIP            AS ZIP_BF            /*우편번호                */
			    ,T2.ADRES          AS ADRES_BF          /*주소                    */
			    ,T2.ADRES_DETAIL   AS ADRES_DETAIL_BF   /*상세주소                */
			    ,T2.TELNO          AS TELNO_BF          /*전화번호                */
			    ,T2.MBTLNO         AS MBTLNO_BF         /*휴대전화번호            */
			    ,T2.EMAIL          AS EMAIL_BF          /*이메일                  */

/* 고객정보(변경후) */

			    ,T3.HOUSE_CSTMR_NO AS HOUSE_CSTMR_NO_AF /*주택고객번호            */
			    ,T3.CSTMR_NM             AS NM_AF             /*성명                    */
			    ,SFCOM_DEC_ALL(T3.IHIDNUM)        AS IHIDNUM_AF        /*주민등록번호            */
			    ,T3.ZIP            AS ZIP_AF            /*우편번호                */
			    ,T3.ADRES          AS ADRES_AF          /*주소                    */
			    ,T3.ADRES_DETAIL   AS ADRES_DETAIL_AF   /*상세주소                */
			    ,T3.TELNO          AS TELNO_AF          /*전화번호                */
			    ,T3.MBTLNO         AS MBTLNO_AF         /*휴대전화번호            */
			    ,T3.EMAIL          AS EMAIL_AF          /*이메일                  */
			    
	    <![CDATA[		
			    ,T2.ZIP||' '||T2.ADRES||' '||T2.ADRES_DETAIL AS ADRES_TT_BF
			    ,T3.ZIP||' '||T3.ADRES||' '||T3.ADRES_DETAIL AS ADRES_TT_AF
			  FROM TBSLS_HCNTRCTR_CHANGE T1
			      ,TBSLS_HOUSE_CSTMR T2
			      ,TBSLS_HOUSE_CSTMR T3
			  WHERE 1 = 1      
			   AND T1.HOUSE_CSTMR_NO_BFCHG = T2.HOUSE_CSTMR_NO(+)
			   AND T1.HOUSE_CSTMR_NO       = T3.HOUSE_CSTMR_NO(+)
			   AND T1.CNTRCTR_NO           = #CNTRCTR_NO#
			   ORDER BY T1.CNTRCTR_NO
			           ,T1.CHANGE_SN
            
		]]>
		    
                    
	  </select>	  
	  
  <!-- 쿼리명     : 주택계약자변경 신규
	        설명       : 주택계약변경 조회
	        작성자     : 정윤원
	        최초작성일 : 2015.09.05

	        수정일  수정자  수정내용
	   -->        
      <select id="SLS020208DAO.selectHcntrctrChangeInsert" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		
			SELECT 
			      '0'                            AS CHK
			       ,T1.CNTRCTR_NO                AS CNTRCTR_NO                 /*계약자번호              */
/* 명의변경(분양,임대) */
			       ,'01'                         AS CHANGE_SE                  /*변경구분:명의변경       */
			       ,TO_CHAR(SYSDATE,'YYYYMMDD')  AS CHANGE_DE                  /*변경일자                */
			       ,'0'                          AS CONFM_COMPT_AT             /*승인완료여부            */
			       ,T1.HOUSE_CSTMR_NO            AS HOUSE_CSTMR_NO_BFCHG       /*변경전_주택고객번호     */
			       ,T1.BDNBR                     AS BFCHG_BDNBR                /*변경전_건물번호         */
			       ,T1.NMCHANGE_CNNC_CODE        AS BFCHG_NMCHANGE_SN          /*변경전_명의변경연결코드 */
/*분양자격구분(분양,임대)*/			       
			       ,T1.LTTOT_QUALF_SE            AS BFCHG_QUALF_SE             /*변경전_자격구분         */
			       ,T1.CTRTC_FILE_COURS          AS BFCHG_CTRTC_FILE_COURS     /*변경전_첨부파일경로     */
			       ,T1.CTRTC_FILE                AS BFCHG_CTRTC_FILE           /*변경전_첨부파일         */
			/*압류정보*/       
			       ,T3.CDIT_DECSN_DE             AS BFCHG_SEIZR_DE             /*변경전_압류일           */
			       ,T3.DET_AMOUNT                AS BFCHG_SEIZR_AMOUNT         /*변경전_압류금액         */
			       ,T3.CRDTR_NM                  AS BFCHG_SEIZR_CRDTR_NM       /*변경전_압류채권자명     */
			       ,T3.DET_RCIV_AMOUNT           AS BFCHG_SEIZR_RCIV_AMOUNT    /*변경전_압류수납금액     */
			/*대출정보*/      
			       ,T4.TRNSFR_DE                 AS BFCHG_LON_DE               /*변경전_대출일           */
			       ,T4.CDIT_TRNSFR_AMOUNT        AS BFCHG_LON_AMOUNT           /*변경전_대출금액         */
			       ,T4.CDIT_GRNTE_BANK           AS BFCHG_LON_BANK             /*변경전_대출은행         */
			/*국민주택기금 정보*/       
			       ,T5.ALTRV_LON_DE              AS BFCHG_KJF_DE               /*변경전_국민주택기금일   */
			       ,T5.KJF                       AS BFCHG_KJF_AMOUNT           /*변경전_국민주택기금금액 */
			       , '0'                         AS APPLC_AT                   /*적용여부                */
			       , T2.ETC_CTTPC                AS CTTPC_BFCHG                /*변경전_연락처           */
			       , T1.RM                       AS BFCHG_RM                   /*변경전_비고             */
			/*고객정보:변경전*/
			       ,T2.CSTMR_NM                        AS NM_BF                      /*변경전_주택고객명       */
			       ,T2.IHIDNUM                   AS IHIDNUM_BF                 /*변경전_고객주민등록번호 */
			       ,T2.ZIP                       AS ZIP_BF                     /*변경전_고객 우편번호    */
			       ,T2.ADRES                     AS ADRES_BF                   /*변경전_고객주소         */
			       ,T2.ADRES_DETAIL              AS ADRES_DETAIL_BF            /*변경전_고객상세주소     */
			       ,T2.TELNO                     AS TELNO_BF                   /*변경전_고객전화번호    */
			       ,T2.MBTLNO                    AS MBTLNO_BF                  /*변경전_고객휴대전화번호 */
			       ,T2.EMAIL                     AS EMAIL_BF                   /*변경전_고객이메일       */
			       ,T2.ZIP||' '||T2.ADRES||' '||T2.ADRES_DETAIL AS ADRES_TT_BF /*변경전_고객상세주소전체 */
			FROM    TBSLS_HCNTRCTR    T1  /*주택계약자*/
			       ,TBSLS_HOUSE_CSTMR T2  /*주택고객*/
			       
			       /* 압류정보*/
			       ,(
			          SELECT  ( SELECT MAX(CNTRCTR_NO)          FROM TBSLS_HCNTRCTR_SEIZR WHERE CNTRCTR_NO = #CNTRCTR_NO#  )                      AS SEIZR_CNTRCTR_NO
			                , ( SELECT MAX(CRDTR_NM)            FROM TBSLS_HCNTRCTR_SEIZR WHERE CNTRCTR_NO = #CNTRCTR_NO#  )                      AS CRDTR_NM
			                , ( SELECT MAX(CDIT_DECSN_DE)       FROM TBSLS_HCNTRCTR_SEIZR WHERE CNTRCTR_NO = #CNTRCTR_NO#  )                      AS CDIT_DECSN_DE
			                , ( SELECT NVL(SUM(DET_AMOUNT),0)   FROM TBSLS_HCNTRCTR_SEIZR WHERE CNTRCTR_NO = #CNTRCTR_NO#  AND RELIS_DE IS NULL ) AS DET_AMOUNT
			                , ( SELECT NVL(SUM(DET_AMOUNT),0)   FROM TBSLS_HCNTRCTR_SEIZR WHERE CNTRCTR_NO = #CNTRCTR_NO#  )                      AS DET_RCIV_AMOUNT
			          FROM DUAL     
			        ) T3     
			        
			        /* 대출정보*/ 
			       ,(         
			          SELECT MAX(CNTRCTR_NO)         AS LON_CNTRCTR_NO
			                ,MAX(CDIT_GRNTE_BANK)    AS CDIT_GRNTE_BANK
			                ,MAX(TRNSFR_DE)          AS TRNSFR_DE
			                ,SUM(CDIT_TRNSFR_AMOUNT) AS CDIT_TRNSFR_AMOUNT
			            FROM TBSLS_HCNTRCTR_LON 
			           WHERE   CNTRCTR_NO = #CNTRCTR_NO#   
			             AND RELIS_DE IS NULL
			          ) T4  
			          
			        /*국민주택기금*/   
			       ,(
			            SELECT MAX(CNTRCTR_NO)         AS KJF_CNTRCTR_NO 
			                  ,MAX(ALTRV_LON_DE)       AS ALTRV_LON_DE
			                  ,SUM(KJF)                AS KJF
			              FROM TBSLS_HCNTRCTR_KJF_PAY_CNFIRM  
			             WHERE  ( PAY_CNFIRM_AT IS NULL  OR PAY_CNFIRM_AT= '0' )  
			               AND CNTRCTR_NO = #CNTRCTR_NO#
			         )  T5 
			<![CDATA[	
			WHERE 1                 = 1
			  AND T1.CNTRCTR_NO     = #CNTRCTR_NO#  
			  AND T1.HOUSE_CSTMR_NO = T2.HOUSE_CSTMR_NO(+)
			  AND T1.CNTRCTR_NO     = T3.SEIZR_CNTRCTR_NO(+)
			  AND T1.CNTRCTR_NO     = T4.LON_CNTRCTR_NO(+)
			  AND T1.CNTRCTR_NO     = T5.KJF_CNTRCTR_NO(+)
			         
					]]>
	  </select>	  
	
<!-- 쿼리명      : 주택계약자명의변경 신규 등록
	        설명       : 주택계약자명의변경 신규 등록 쿼리문
	        작성자     : 정윤원
	        최초작성일 : 2015.09.06

	        수정일  수정자  수정내용
	   -->
	   
	  <insert id="SLS020208DAO.insertHcntrctrChange" parameterClass="java.util.Map">
	      INSERT INTO TBSLS_HCNTRCTR_CHANGE
		  (    
		     CNTRCTR_NO                  
			,CHANGE_SE                   
			,CHANGE_SN                   
			,CHANGE_DE                   
			,CHGHY_CODE                  
			,CHANGE_ATCHMNFL_COURS       
			,CHANGE_ATCHMNFL             
			,CONFM_COMPT_AT              
			,HOUSE_CSTMR_NO_BFCHG        
			,BFCHG_BDNBR                 
			,BFCHG_NMCHANGE_SN           
			,BFCHG_QUALF_SE              
			,BFCHG_SEIZR_DE              
			,BFCHG_SEIZR_AMOUNT          
			,BFCHG_SEIZR_RCIV_AMOUNT     
			,BFCHG_LON_DE                
			,BFCHG_LON_AMOUNT            
			,BFCHG_LON_BANK              
			,BFCHG_KJF_DE                
			,BFCHG_KJF_AMOUNT            
			,HOUSE_CSTMR_NO              
			,APPLC_AT                    
			,CTTPC_BFCHG                 
			,CTTPC_AFTCH                 
			,RM                          
			,REGISTER_ID                 
			,REGIST_DT                   
			,UPDUSR_ID                   
			,UPDT_DT                     
			,BFCHG_SEIZR_CRDTR_NM        
			,BFCHG_CTRTC_FILE_COURS      
			,BFCHG_CTRTC_FILE            
			,SANCTN_NO                   
			,BFCHG_RM                    

		  ) VALUES (
		         	     
			 	#CNTRCTR_NO#                    /*계약자번호                  */          
				,#CHANGE_SE#                    /*변경구분 : 공통코드 'HOU018'*/    
				
				,( SELECT NVL(MAX(CHANGE_SN),0) + 1
                     FROM TBSLS_HCNTRCTR_CHANGE
                    WHERE 1 = 1
                      AND CNTRCTR_NO = #CNTRCTR_NO#
                      AND CHANGE_SE  = #CHANGE_SE#
                 )     	     
				,#CHANGE_DE#                     /*변경일자                    */          
				,#CHGHY_CODE#                    /*변경사유코드                */          
				,#CHANGE_ATCHMNFL_COURS#         /*변경첨부파일경로            */          
				,#CHANGE_ATCHMNFL#               /*변경첨부파일                */          
				,#CONFM_COMPT_AT#                /*승인완료여부                */          
				,#HOUSE_CSTMR_NO_BFCHG#          /*변경전_주택고객번호         */          
				,#BFCHG_BDNBR#                   /*변경전건물번호              */          
				,#BFCHG_NMCHANGE_SN#             /*변경전명의변경일련번호      */          
				,#BFCHG_QUALF_SE#                /*변경전자격구분              */          
				,#BFCHG_SEIZR_DE#                /*변경전압류일                */          
				,#BFCHG_SEIZR_AMOUNT#            /*변경전압류금액              */          
				,#BFCHG_SEIZR_RCIV_AMOUNT#       /*변경전압류수납금액          */          
				,#BFCHG_LON_DE#                  /*변경전대출일                */          
				,#BFCHG_LON_AMOUNT#              /*변경전대출금액              */          
				,#BFCHG_LON_BANK#                /*변경전대출은행              */          
				,#BFCHG_KJF_DE#                  /*변경전국민주택기금일        */          
				,#BFCHG_KJF_AMOUNT#              /*변경전국민주택기금금액      */          
				,#HOUSE_CSTMR_NO#                /*주택고객번호                */          
				,#APPLC_AT#                      /*적용여부                    */          
				,#CTTPC_BFCHG#                   /*연락처_변경전               */          
				,#CTTPC_AFTCH#                   /*연락처_변경후               */          
				,#RM#                            /*비고                        */          
				,#S_USER_ID#                     /*등록자ID                    */        
				,SYSDATE                         /*등록일시                    */      
				,#S_USER_ID#                     /*수정자ID                    */          
				,SYSDATE                         /*수정일시                    */          
				,#BFCHG_SEIZR_CRDTR_NM#          /*변경전압류채권자명          */          
				,#BFCHG_CTRTC_FILE_COURS#        /*변경전계약서파일경로        */          
				,#BFCHG_CTRTC_FILE#              /*변경전계약서파일            */          
				,#SANCTN_NO#                     /*결재번호                    */          
				,#BFCHG_RM#                      /*변경전비고                  */          

		  )
	  
	  </insert>   
	  
 <!-- 쿼리명     : 주택계약자명의변경 수정
	        설명       : 주택계약자명의변경 수정 쿼리문
	        작성자     : 박태혁
	        최초작성일 : 2016.07.25

	        수정일  수정자  수정내용
	   -->
	  <statement id="SLS020208DAO.updateHcntrctrAfter" parameterClass="java.util.Map" resultClass="java.util.Map" remapResults="true">
	     UPDATE TBSLS_HCNTRCTR  
	        SET HOUSE_CSTMR_NO  = #HOUSE_CSTMR_NO#
	          , BDNBR           = #BFCHG_BDNBR#
	          , ZIP_DM          = #ZIP_AF#
	          , BASS_ADRES_DM   = #ADRES_AF#
	          , DETAIL_ADRES_DM = #DETAIL_ADRES_AF#
	          , BDNBR_DM        = #BFCHG_BDNBR#
	          , LTTOT_QUALF_SE   = '31'
	          , RENT_QUALF_SE   = '31' 
	          , UPDUSR_ID       = #S_USER_ID#
	          , UPDT_DT         = sysdate  
	     WHERE  CNTRCTR_NO      = #CNTRCTR_NO# 	  	  
	  </statement>
  <!-- 쿼리명     : 주택계약자명의변경 수정
	        설명       : 주택계약자명의변경 수정 쿼리문
	        작성자     : 정윤원
	        최초작성일 : 2015.09.05

	        수정일  수정자  수정내용
	   -->
	  <statement id="SLS020208DAO.updateHcntrctrChange" parameterClass="java.util.Map" resultClass="java.util.Map" remapResults="true">
	    UPDATE TBSLS_HCNTRCTR_CHANGE
          SET CHANGE_DE             = #CHANGE_DE#             /*변경일자        */
             ,CHGHY_CODE            = #CHGHY_CODE#            /*변경사유코드    */
             ,CHANGE_ATCHMNFL_COURS = #CHANGE_ATCHMNFL_COURS# /*변경첨부파일경로*/
             ,CHANGE_ATCHMNFL       = #CHANGE_ATCHMNFL#       /*변결첨부파일    */
             ,CTTPC_AFTCH           = #CTTPC_AFTCH#           /*연락처 변경후   */
             ,RM                    = #RM#                    /*비고            */
             ,UPDUSR_ID             = #S_USER_ID#
             ,UPDT_DT               = SYSDATE
        WHERE 1 = 1
          AND CNTRCTR_NO   = #CNTRCTR_NO#
          AND CHANGE_SE     = #CHANGE_SE#
          AND CHANGE_SN    = #CHANGE_SN#
	  	  
	  </statement>
 <!-- 쿼리명     : 주택계약자명의변경 리스트 삭제
	        설명       : 주택계약자명의변경 리스트 삭제 쿼리문
	        작성자     : 정윤원
	        최초작성일 : 2015.09.05

	        수정일  수정자  수정내용
	   -->
	  <delete id="SLS020208DAO.deleteHcntrctrChange" parameterClass="java.util.Map">
		
	      DELETE TBSLS_HCNTRCTR_CHANGE
		    WHERE 1 = 1
              AND CNTRCTR_NO   = #CNTRCTR_NO#
              AND CHANGE_SE    = #CHANGE_SE#
              AND CHANGE_SN    = #CHANGE_SN#
	  	  
		   
	  </delete>   
	  
<!-- 쿼리명 : 공유자 등록
	설명 : 공유자 등록
	수정일  수정자  수정내용
	
	작성자 : 최승락
	최초작성일 : 2015.12.20
	-->
	<insert id="SLS020208DAO.insertHcntrctrCocnr" parameterClass="java.util.Map">
		INSERT INTO TBSLS_HCNTRCTR_COCNR(
<!-- 		     CNTRCTR_CSTMR_NO	/*계약자고객번호*/ -->
	 		 COCNR_SN     		/*공유자일련번호*/
		    ,CNTRCTR_NO  		/*계약자번호*/
		    ,HOUSE_CSTMR_NO		/*주택고객번호*/
		    ,RM                 /*비고*/
		    ,RELIS_DE           /*해제일자*/
			,REGISTER_ID		/*등록자ID*/
			,REGIST_DT			/*등록일시*/
			,UPDUSR_ID			/*수정자ID*/
			,UPDT_DT			/*수정일시*/
		) 
	 	VALUES(
<!-- 			 #CNTRCTR_CSTMR_NO# /*계약자고객  번호*/    -->        
	 		SQ_TBSLS_HCNTRCTR_COCNR_1.NEXTVAL	/*공유자일련번호*/
	 		,#CNTRCTR_NO#		/*계약자번호*/
	 		,#HOUSE_CSTMR_NO#	/*주택고객번호*/
	 		,#RM#				/*비고*/
	 		,#RELIS_DE#			/*해제일자*/
			,#S_USER_ID#		/*등록자ID*/
			,SYSDATE			/*등록일시*/
			,#S_USER_ID#		/*수정자ID*/
			,SYSDATE 			/*수정일시*/
	 		)
	</insert>	
	
	  <!-- 주택계약자 공유자 수정 -->
	<update id="SLS020208DAO.updateHcntrctrCocnr" parameterClass="java.util.HashMap">
		UPDATE TBSLS_HCNTRCTR_COCNR SET
			 HOUSE_CSTMR_NO = #HOUSE_CSTMR_NO#	/*주택고객번호*/
			,UPDUSR_ID = #S_USER_ID#			/*수정자ID*/
			,UPDT_DT = SYSDATE					/*수정일시*/
		WHERE 1=1
		<!-- AND   CNTRCTR_CSTMR_NO = #CNTRCTR_CSTMR_NO# -->
		AND   COCNR_SN = #COCNR_SN#
		AND   CNTRCTR_NO = #CNTRCTR_NO#
		AND   HOUSE_CSTMR_NO = #HOUSE_CSTMR_NO#
	</update>
	
	<!-- 쿼리명 : 주택계약자공유자 테이블 정보 삭제
	설명 : 주택계약자공유자 테이블 정보 삭제 쿼리
	수정일  		수정자  	수정내용
	2015.12.08	최승락	최초작성
	작성자 : 최승락
	최초작성일 : 2015.12.08
	-->
	<delete id="SLS020208DAO.deleteHcntrctrCocnr" parameterClass="java.util.Map"> 
		DELETE 
		  FROM TBSLS_HCNTRCTR_COCNR
		 WHERE 1 = 1
		   AND CNTRCTR_NO = #CNTRCTR_NO#
	</delete>
	
	<!-- 쿼리명 : 주택계약자공유자  삭제
	설명 : 주택계약자공유자  삭제
	수정일  		수정자  	수정내용
	2015.12.08	최승락	최초작성
	작성자 : 최승락
	최초작성일 : 2015.12.08
	-->
	<delete id="SLS020208DAO.deleteOneHcntrctrCocnr" parameterClass="java.util.Map"> 
		DELETE 
		  FROM TBSLS_HCNTRCTR_COCNR
		 WHERE 1 = 1
<!-- 		   AND CNTRCTR_CSTMR_NO = #CNTRCTR_CSTMR_NO# -->
		   AND   CNTRCTR_NO = #CNTRCTR_NO#
		   AND COCNR_SN = #COCNR_SN#
	</delete>
	
		<!-- 주택계약자압류 조회  -->
	<select id="SLS020208DAO.selectLcntrctrSeizrList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		
		SELECT '0' AS CHK
				,'SEIZR' AS GBN
		      	,CNTRCTR_NO              
				,SEIZR_SN                
				,CRDTR_NM                
				,CRDTR_ADRES             
				,CRDTR_TELNO             
				,CRDTR_TELNO_2           
				,CDIT_DECSN_DE           
				,CDIT_RCEPT_DE           
				,INCDNT_CN               
				,CDIT_CN                 
				,SEIZR_SE                
				,DET_AMOUNT              
				,RELIS_RCEPT_DE          
				,RELIS_DE                
				,PRCAFS_CHARGER          
				,PRCAFS_CHRG_DEPT        
				,PRCAFS_CHRG_CTTPC       
				,PRCAFS_CHRG_EMAIL       
				,RM
				,SEIZR_ATCHMNFL_COURS                      
				,SEIZR_ATCHMNFL
			    ,SEIZR_ATCHMNFL_COURS AS FILE_ORDR                     
				,SEIZR_ATCHMNFL
				,REGISTER_ID             
				,REGIST_DT              
				,UPDUSR_ID               
				,UPDT_DT                
				,FILE_SN           
		  FROM TBSLS_HCNTRCTR_SEIZR /* 주택계약자압류 */
		 WHERE 1 = 1      
		   AND CNTRCTR_NO = #CNTRCTR_NO#
           
	</select>
	
<!-- 주택계약자대출 조회  -->
	<select id="SLS020208DAO.selectLcntrctrLonList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT '0' AS CHK
				,'LON' AS GBN
		      	,CNTRCTR_NO        
				,LON_SN            
				,LON_SE            
				,TRNSFR_DE         
				,CDIT_TRNSFR_AMOUNT
				,CDIT_GRNTE_BANK   
				,BANK_ADRES        
				,RELIS_DE          
				,RM                
				,PRCAFS_CHARGER    
				,PRCAFS_CHRG_DEPT  
				,PRCAFS_CHRG_CTTPC
				,'' AS PRCAFS_CHRG_EMAIL 
				,LON_ATCHMNFL_COURS				
				,LON_ATCHMNFL  
			    ,LON_ATCHMNFL_COURS AS FILE_ORDR                     
				,LON_ATCHMNFL
				,REGISTER_ID       
				,REGIST_DT         
				,UPDUSR_ID         
				,UPDT_DT      
				,FILE_SN     
		  FROM TBSLS_HCNTRCTR_LON /* 주택계약자대출 */
		 WHERE 1 = 1      
		   AND CNTRCTR_NO = #CNTRCTR_NO#
           
	</select>	
	
<!-- 쿼리명 : 연체/선납계산
		설명 : 가상계좌 미납내역
		수정일  수정자  수정내용
		
		작성자 : 이광원
		최초작성일 : 2016.0.3.09 
	-->	
	<select id="SLS020208DAO.houseCalList" parameterClass="java.util.Map" resultClass="java.util.HashMap">
            SELECT
                  T1.CNTRCTR_NO
                , T1.PAY_NO
                , T1.RQEST_YM
                , T1.PAY_CODE
                , T1.PAY_SE
                , T1.PAYAMT
                , T1.PAY_SUPLY_AMOUNT
                , T1.PAY_VAT
                , T1.ARRRG_AMOUNT
                , SFSLS_LAD_APAY_CAL(  #LAD_CODE#  /* 토지코드  */
                					 , NVL(T1.PAY_TMLMT , #IN_TO_DAY#) /* 납입기한이 없으면 변경기한일로 대체 */ 
                					 , #IN_TO_DAY# /* 변경기한일(수납예정일자)  */ 
                					 , T1.PAYAMT  /* 납부금액  */
                					 , T1.CNTRCTR_NO /* 계약자번호 */
                					 ) AS  APAY_CAL /* 토지코드가 국가산단 이고 용도구분이 산업시설용지 구분  */
          	   , TO_DATE(T1.PAY_TMLMT , 'YYYYMMDD')  - TO_DATE(#IN_TO_DAY# , 'YYYYMMDD') AS CNT_DAY
       		   , SFSLS_LAD_RATIO(  ' ' 
                           , #LAD_CODE# 
                           , #IN_TO_DAY# 
                           , T1.PAY_TMLMT 
                           , '0' 
                           , CASE WHEN #LAD_CODE# = '024' AND #PRPOS_SE# = '12' 
                                  THEN '1' 
                                  ELSE '0' END
                           ,  '0'       ) as RATIO                  
                , NVL(T1.PAY_TMLMT , #IN_TO_DAY#) AS PAY_TMLMT
                , T1.PAYMTHD
                , T1.OCR_NO
                , T1.MDAT_DE
                , T1.LEV_DECSN_NO
                , T1.RM
                , T1.RCIV_DECSN_NO
                , T1.LTTOT_RENT_SE
                , T1.TMPR_RCIV_AMOUNT
                , T1.ARRRG_DSCNT_SE
                , T1.ARRRG_DSCNT_AMOUNT
                , T1.ARRRG_DSCNT_SUPLY_AMOUNT
                , T1.ARRRG_DSCNT_VAT
                , T1.ARRRG_DSCNT_DAYCNT
                , T1.ARRRG_DSCNT_INTRT
                , T1.RCIV_DE
                
                , #IN_TO_DAY# AS PAY_STDR_DE
                <![CDATA[ 
				, CASE WHEN T1.ARRRG_DSCNT_AMOUNT < 0 
					THEN T1.ARRRG_DSCNT_AMOUNT  END AS PREPAY_DSCNT_AMOUNT
                ]]>
                , (NVL(T1.PAYAMT, 0)  + NVL(T1.ARRRG_AMOUNT, 0) ) AS PAYAMT_SM
         		, (NVL(T1.PAYAMT, 0) + NVL(T1.ARRRG_DSCNT_AMOUNT, 0) - NVL(T2.RCIV_AMOUNT, 0))  AS UNCLAMT
         		
                , T2.RCIV_AMOUNT AS R_RCIV_AMOUNT
                , T2.RCIV_DE AS R_RCIV_DE
                , T2.PAYMTHD AS R_RCIV_MTH
                , T2.BANK_CODE AS R_BANK_CODE
              FROM TBSLS_HOUSE_LTTOT_PAY T1
                , TBSLS_HOUSE_RCIV_PSTMRK T2
             WHERE 1 = 1
              AND T1.CNTRCTR_NO = T2.CNTRCTR_NO(+)
              AND T1.PAY_NO = T2.PAY_NO(+)
              AND T1.CNTRCTR_NO = #CNTRCTR_NO#
              AND T1.LTTOT_RENT_SE = #LTTOT_RENT_SE#
             ORDER BY T1.PAY_CODE, T1.PAY_TMLMT,  T1.PAY_SE	    
    </select>
<!-- 쿼리명 : 연체/선납 저장
	설명 : 연체/선납 저장 쿼리
	수정일  수정자  수정내용
	
	작성자 : 최승락
	최초작성일 : 2015.12.20
	-->
	<update id="SLS020208DAO.saveHouseCalPay" parameterClass="java.util.Map">
		UPDATE TBSLS_HOUSE_LTTOT_PAY
		   SET
			  RQEST_YM = #RQEST_YM#
			, PAYAMT = #PAYAMT#
			, PAY_SUPLY_AMOUNT = #PAY_SUPLY_AMOUNT#
			, PAY_VAT = #PAY_VAT#
			, ARRRG_AMOUNT = #ARRRG_AMOUNT#
			, PAY_TMLMT = #PAY_TMLMT#
			, MDAT_DE = #MDAT_DE#
			, OUTPT_DE = #OUTPT_DE#
			, PAYMTHD = #PAYMTHD#
			, PAY_BANK_CODE = #PAY_BANK_CODE#
			, OCR_NO = #OCR_NO#
			, LEV_DECSN_NO = #LEV_DECSN_NO#
			, TRMNAT_UNUSED_AT = #TRMNAT_UNUSED_AT#
			, RCIV_DECSN_NO = #RCIV_DECSN_NO#
			, LTTOT_RENT_SE = #LTTOT_RENT_SE#
			, TMPR_RCIV_AMOUNT = #TMPR_RCIV_AMOUNT#
			, ARRRG_DSCNT_SE = #ARRRG_DSCNT_SE#
			, ARRRG_DSCNT_AMOUNT = #ARRRG_DSCNT_AMOUNT#
			, ARRRG_DSCNT_SUPLY_AMOUNT = #ARRRG_DSCNT_SUPLY_AMOUNT#
			, ARRRG_DSCNT_VAT = #ARRRG_DSCNT_VAT#
			, ARRRG_DSCNT_DAYCNT = #ARRRG_DSCNT_DAYCNT#
			, ARRRG_DSCNT_INTRT = #ARRRG_DSCNT_INTRT#
			, UPDUSR_ID = #S_USER_ID#
			, UPDT_DT = SYSDATE
		 WHERE 1 = 1
		   AND CNTRCTR_NO = #CNTRCTR_NO#
		   AND PAY_NO = #PAY_NO#
	</update>


	<insert id="SLS020208DAO.insertLcntrctrPayPopList" parameterClass="java.util.Map">
		INSERT INTO TBSLS_HOUSE_LTTOT_PAY
		(
			  CNTRCTR_NO
			, PAY_NO
			, PAY_CODE
			, PAY_SE
			, PAY_SN
			, PAYAMT
			, PAY_SUPLY_AMOUNT
			, PAY_VAT
			, ARRRG_AMOUNT
			, YRINS_SALE_INTR
			, RQEST_YM
			, PAY_TMLMT
			, PAY_PRARNDE
			, MDAT_DE
			, OUTPT_DE
			, PAYMTHD
			, PAY_BANK_CODE
			, OCR_NO
			, LEV_DECSN_NO
			, TRMNAT_UNUSED_AT
			, RCIV_DECSN_NO
			, LTTOT_RENT_SE
			, TMPR_RCIV_AMOUNT
			, TMPR_RCIV_NO
			, RCIV_DE
			, RCIV_AMOUNT
			, CNTRCT_ODR
			, POINT_DSCNT_AM
			, RM
			, ARRRG_DSCNT_SE
			, ARRRG_DSCNT_AMOUNT
			, ARRRG_DSCNT_SUPLY_AMOUNT
			, ARRRG_DSCNT_VAT
			, ARRRG_DSCNT_DAYCNT
			, ARRRG_DSCNT_INTRT
			, RCIV_PREARNGE_DE
			, ELCTRN_SANCTN_NO
			,SANCTN_STTUS 
			,REGISTER_ID 
			,REGIST_DT 
			,UPDUSR_ID 
			,UPDT_DT 
			
		) VALUES (
			  #CNTRCTR_NO#
			, #PAY_NO#
			, #PAY_CODE#
			, #PAY_SE#
			, #PAY_SN#
			, #PAYAMT#
			, #PAY_SUPLY_AMOUNT#
			, #PAY_VAT#
			, #ARRRG_AMOUNT#
			, #YRINS_SALE_INTR#
			, #RQEST_YM#
			, #PAY_TMLMT#
			, #PAY_PRARNDE#
			, #MDAT_DE#
			, #OUTPT_DE#
			, #PAYMTHD#
			, #PAY_BANK_CODE#
			, #OCR_NO#
			, #LEV_DECSN_NO#
			, #TRMNAT_UNUSED_AT#
			, #RCIV_DECSN_NO#
			, #LTTOT_RENT_SE#
			, #TMPR_RCIV_AMOUNT#
			, #TMPR_RCIV_NO#
			, #RCIV_DE#
			, #RCIV_AMOUNT#
			, #CNTRCT_ODR#
			, #POINT_DSCNT_AM#
			, #RM#
			, #ARRRG_DSCNT_SE#
			, #PREPAY_DSCNT_AMOUNT#
			, #ARRRG_DSCNT_SUPLY_AMOUNT#
			, #ARRRG_DSCNT_VAT#
			, #ARRRG_DSCNT_DAYCNT#
			, #ARRRG_DSCNT_INTRT#
			, #RCIV_PREARNGE_DE#
			, #ELCTRN_SANCTN_NO#
			, #SANCTN_STTUS#
			, #S_USER_ID#
			, SYSDATE
			, #S_USER_ID#
			, SYSDATE
			

		)
	</insert>
	
<!-- 쿼리명 : 납부정보 수정
	설명 : 납부정보 수정 쿼리
	수정일  수정자  수정내용
	
	작성자 : 최승락
	최초작성일 : 2015.12.20
	-->
	<update id="SLS020208DAO.updateLcntrctrPayPopList" parameterClass="java.util.Map">
		UPDATE TBSLS_HOUSE_LTTOT_PAY
		   SET
			  RQEST_YM = #RQEST_YM#
			, PAY_CODE = #PAY_CODE#
			, PAY_SE = #PAY_SE#
			, PAY_SN = #PAY_SN#
			, PAYAMT = #PAYAMT#
			, PAY_SUPLY_AMOUNT = #PAY_SUPLY_AMOUNT#
			, PAY_VAT = #PAY_VAT#			
			, ARRRG_AMOUNT = #ARRRG_AMOUNT#			
			, YRINS_SALE_INTR = #YRINS_SALE_INTR#
			, PAY_TMLMT = #PAY_TMLMT#
			, PAY_PRARNDE = #PAY_PRARNDE#
			, MDAT_DE = #MDAT_DE#
			, OUTPT_DE = #OUTPT_DE#
			, PAYMTHD = #PAYMTHD#
			, PAY_BANK_CODE = #PAY_BANK_CODE#
			, OCR_NO = #OCR_NO#
			, LEV_DECSN_NO = #LEV_DECSN_NO#
			, TRMNAT_UNUSED_AT = #TRMNAT_UNUSED_AT#
			, RCIV_DECSN_NO = #RCIV_DECSN_NO#
			, LTTOT_RENT_SE = #LTTOT_RENT_SE#
			, TMPR_RCIV_AMOUNT = #TMPR_RCIV_AMOUNT#
			, TMPR_RCIV_NO = #TMPR_RCIV_NO#
			, RCIV_DE = #RCIV_DE#
			, RCIV_AMOUNT = #RCIV_AMOUNT#
			, CNTRCT_ODR = #CNTRCT_ODR#
			, POINT_DSCNT_AM = #POINT_DSCNT_AM#
			, RM = #RM#
			, ARRRG_DSCNT_SE = #ARRRG_DSCNT_SE#
			, ARRRG_DSCNT_AMOUNT = #PREPAY_DSCNT_AMOUNT#
			, ARRRG_DSCNT_SUPLY_AMOUNT = #ARRRG_DSCNT_SUPLY_AMOUNT#
			, ARRRG_DSCNT_VAT = #ARRRG_DSCNT_VAT#
			, ARRRG_DSCNT_DAYCNT = #ARRRG_DSCNT_DAYCNT#
			, ARRRG_DSCNT_INTRT = #ARRRG_DSCNT_INTRT#
			, RCIV_PREARNGE_DE = #RCIV_PREARNGE_DE#
			, ELCTRN_SANCTN_NO = #ELCTRN_SANCTN_NO#
			, SANCTN_STTUS = #SANCTN_STTUS#
			, UPDUSR_ID = #S_USER_ID#
			, UPDT_DT = SYSDATE
		 WHERE 1 = 1
		   AND CNTRCTR_NO = #CNTRCTR_NO#
		   AND PAY_NO = #PAY_NO#
	</update>
	
	<!-- 쿼리명 : 납부정보 삭제
	설명 : 납부정보 삭제 쿼리
	수정일  수정자  수정내용
	
	작성자 : 최승락
	최초작성일 : 2015.12.20
	-->
	<delete id="SLS020208DAO.deleteLcntrctrPayPopList" parameterClass="java.util.Map">
		DELETE
		  FROM TBSLS_HOUSE_LTTOT_PAY
		 WHERE 1 = 1
		   AND CNTRCTR_NO = #CNTRCTR_NO#
		   AND PAY_NO = #PAY_NO#
	</delete>
	
<!-- 주택계약자압류 단일 조회  -->
	<select id="SLS020208DAO.selectSeizeOne" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		
		SELECT 
		        '0' AS LON_INFO_DEL
		        ,'0' AS LON_INFO_ADD
		        ,'0' AS CHK
				,'SEIZR' AS GBN
		      	,CNTRCTR_NO              
				,SEIZR_SN                
				,CRDTR_NM                
				,CRDTR_ADRES             
				,CRDTR_TELNO             
				,CRDTR_TELNO_2           
				,CDIT_DECSN_DE           
				,CDIT_RCEPT_DE           
				,INCDNT_CN               
				,CDIT_CN                 
				,SEIZR_SE                
				,DET_AMOUNT              
				,RELIS_RCEPT_DE          
				,RELIS_DE                
				,PRCAFS_CHARGER          
				,PRCAFS_CHRG_DEPT        
				,PRCAFS_CHRG_CTTPC       
				,PRCAFS_CHRG_EMAIL       
				,RM
				,SEIZR_ATCHMNFL_COURS                      
				,SEIZR_ATCHMNFL
			    ,SEIZR_ATCHMNFL_COURS AS FILE_ORDR                     
				,SEIZR_ATCHMNFL
				,REGISTER_ID             
				,REGIST_DT              
				,UPDUSR_ID               
				,UPDT_DT                
				,FILE_SN           
		  FROM TBSLS_HCNTRCTR_SEIZR /* 주택계약자압류 */
		 WHERE 1 = 1      
		   AND CNTRCTR_NO = #CNTRCTR_NO#
           AND SEIZR_SN = #SEIZR_SN#
	</select>	
		
		

	<!-- 주택계약자압류 추가  -->
	<insert id="SLS020208DAO.insertHcntrctrSeizr" parameterClass="java.util.Map">
	      INSERT INTO TBSLS_HCNTRCTR_SEIZR
		  (    
		     CNTRCTR_NO                  
			,SEIZR_SN                   
			,CRDTR_NM                   
			,CRDTR_ADRES                   
			,CRDTR_TELNO         
			,CRDTR_TELNO_2       
			,CDIT_DECSN_DE             
			,CDIT_RCEPT_DE              
			,INCDNT_CN
			,CDIT_CN        
			,SEIZR_SE
			,DET_AMOUNT                 
			,RELIS_RCEPT_DE           
			,RELIS_DE
			,PRCAFS_CHARGER              
			,PRCAFS_CHRG_DEPT               
			,PRCAFS_CHRG_CTTPC
			,PRCAFS_CHRG_EMAIL
			,RM                          
			,SEIZR_ATCHMNFL_COURS
			,SEIZR_ATCHMNFL
			,REGISTER_ID                 
			,REGIST_DT
			,UPDUSR_ID                   
			,UPDT_DT          
			                
		  ) VALUES (
		         	     
		 	#CNTRCTR_NO#                    /*계약자번호 */
		 	,( SELECT NVL(MAX(SEIZR_SN),0) + 1 FROM TBSLS_HCNTRCTR_SEIZR WHERE 1 = 1 AND CNTRCTR_NO = #CNTRCTR_NO# )          
			,#CRDTR_NM#                    /* */			     	     
			,#CRDTR_ADRES#                    	 /*  */          
			,#CRDTR_TELNO#         /*  */          
			,#CRDTR_TELNO_2#               /* */          
			,#CDIT_DECSN_DE#                /*   */          
			,#CDIT_RCEPT_DE#            /*   */
			,#INCDNT_CN#           /*   */
			,#CDIT_CN#                   /*  */
			,#SEIZR_SE#                   /* */         
			,#DET_AMOUNT#                  /* */          
			,#RELIS_RCEPT_DE#                 /*  */          
			,#RELIS_DE#                     /* */
			,#PRCAFS_CHARGER#                     	 /*  */          
			,#PRCAFS_CHRG_DEPT#             /* */
			,#PRCAFS_CHRG_CTTPC#                   /*  */
			,#PRCAFS_CHRG_EMAIL#                   /*  */
			,#RM#                            /* */ 
			,#SEIZR_ATCHMNFL_COURS#                            /*    */ 
			,#SEIZR_ATCHMNFL#                            /*    */          
			,#S_USER_NM#                     /*등록자명                   */        
			,SYSDATE       					 /*등록일시                    */
			,#S_USER_NM#                     /*수정자명                    */          
			,SYSDATE                         /*수정일시                    */      
		  )
	  
	  </insert>
	  	
	  	
	  			<!-- 주택계약자압류 Max 일련번호 조회  -->
	<select id="SLS020208DAO.selectMaxSeizrSn" parameterClass="java.util.HashMap" resultClass="String">
		
		SELECT             
				MAX(SEIZR_SN) AS   SEIZR_SN             
      
		  FROM TBSLS_HCNTRCTR_SEIZR /* 주택계약자압류 */
		 WHERE 1 = 1      
		   AND CNTRCTR_NO = #CNTRCTR_NO#
           
	</select>
	

	  <!-- 주택계약자압류 수정  -->
	  <update id="SLS020208DAO.updateHcntrctrSeizr" parameterClass="java.util.Map">
		  UPDATE TBSLS_HCNTRCTR_SEIZR
		     SET CRDTR_NM             = #CRDTR_NM#             /*  */
		     	,CRDTR_ADRES          = #CRDTR_ADRES#             /*   */
		        ,CRDTR_TELNO          = #CRDTR_TELNO#            	  /*   */
		        ,CRDTR_TELNO_2        = #CRDTR_TELNO_2#            	  /*     */
		        ,CDIT_DECSN_DE        = #CDIT_DECSN_DE#            	  /*    */
		        ,CDIT_RCEPT_DE        = #CDIT_RCEPT_DE#            	  /*    */
		        ,INCDNT_CN            = #INCDNT_CN#            	  /*   */
		        ,CDIT_CN              = #CDIT_CN#            	  /*    */
		        ,SEIZR_SE          	  = #SEIZR_SE#            	  /*    */
		        ,DET_AMOUNT           = #DET_AMOUNT#            	  /*  */
		        ,RELIS_RCEPT_DE       = #RELIS_RCEPT_DE#            	  /*    */
		        ,RELIS_DE          	  = #RELIS_DE#            	  /*   */
		        ,PRCAFS_CHARGER       = #PRCAFS_CHARGER#            	  /*    */
		        ,PRCAFS_CHRG_DEPT     = #PRCAFS_CHRG_DEPT#            	  /*   */
		        ,PRCAFS_CHRG_CTTPC    = #PRCAFS_CHRG_CTTPC#            	  /*   */
		        ,PRCAFS_CHRG_EMAIL    = #PRCAFS_CHRG_EMAIL#            	  /*   */
		        ,RM                   = #RM#                    /*    */
		        ,SEIZR_ATCHMNFL_COURS = #SEIZR_ATCHMNFL_COURS# /* 첨부파일경로*/
		        ,SEIZR_ATCHMNFL       = #SEIZR_ATCHMNFL#       /* 첨부파일    */
		        ,UPDUSR_ID            = #S_USER_ID#
		        ,UPDT_DT              = SYSDATE
		   WHERE 1 = 1
		     AND CNTRCTR_NO  = #CNTRCTR_NO#
		     AND SEIZR_SN    = #SEIZR_SN#
	  	  
	  </update>
	  	
 
	 <!-- 주택계약자압류 삭제  -->
	 <delete id="SLS020208DAO.deleteHcntrctrSeizr" parameterClass="java.util.Map">
	      DELETE TBSLS_HCNTRCTR_SEIZR
		   WHERE 1 = 1
             AND CNTRCTR_NO  = #CNTRCTR_NO#
             AND SEIZR_SN    = #SEIZR_SN#
		   
	  </delete>
	  
	  	  	
  
	 <!-- 주택계약자대출 추가  -->
	<insert id="SLS020208DAO.insertHcntrctrSeizrToLon" parameterClass="java.util.Map">
		  INSERT INTO TBSLS_HCNTRCTR_LON
		  (    
		     CNTRCTR_NO                  
			,LON_SN                   
			,LON_SE                   
			,TRNSFR_DE                   
			,CDIT_TRNSFR_AMOUNT         
			,CDIT_GRNTE_BANK       
			,BANK_ADRES             
			,RELIS_DE              
			,PRCAFS_CHARGER              
			,PRCAFS_CHRG_DEPT               
			,PRCAFS_CHRG_CTTPC
			,RM                          
			,LON_ATCHMNFL_COURS
			,LON_ATCHMNFL
			,REGISTER_ID                 
			,REGIST_DT
			,UPDUSR_ID                   
			,UPDT_DT          
			                
		  ) VALUES (
		         	     
		 	#CNTRCTR_NO#                    /*계약자번호                  */
		 	,( SELECT NVL(MAX(LON_SN),0) + 1 FROM TBSLS_HCNTRCTR_LON WHERE 1 = 1 AND CNTRCTR_NO = #CNTRCTR_NO# )          
			,( select CHRCTR_PREPAR_VALUE_0 from TBCOM_CMMN_CODE a
				 where grp_code = 'HOU006'
   						and code = #SEIZR_SE#
  			)     	     
			,#CDIT_RCEPT_DE#                    	 /*     */          
			,#DET_AMOUNT#         /*        */          
			,#CRDTR_NM#               /*              */          
			,#CRDTR_ADRES#                /*           */          
			,#RELIS_DE#            /*      */
			,#PRCAFS_CHARGER#                     	 /*    */          
			,#PRCAFS_CHRG_DEPT#             /*      */
			,#PRCAFS_CHRG_CTTPC#                   /*          */
			,#RM#                            /*      */ 
			,#SEIZR_ATCHMNFL_COURS#                            /*             */ 
			,#SEIZR_ATCHMNFL#                            /*                  */          
			,#S_USER_ID#                     /*등록자ID                    */        
			,SYSDATE       					 /*등록일시                    */
			,#S_USER_ID#                     /*수정자ID                    */          
			,SYSDATE                         /*수정일시                    */      
		  )
	  
	  </insert>
	  	  	
	  	  	
	  	  	  	
	<!-- 주택계약자대출 Max 일련번호 조회  -->
	<select id="SLS020208DAO.selectMaxLonSn" parameterClass="java.util.HashMap" resultClass="String">
		
		SELECT             
				MAX(LON_SN) AS   LON_SN             
      
		  FROM TBSLS_HCNTRCTR_LON /* 주택계약자대출 */
		 WHERE 1 = 1      
		   AND CNTRCTR_NO = #CNTRCTR_NO#
           
	</select>

	  
	  <!-- 주택계약자대출 해제일자 update  -->
	  <update id="SLS020208DAO.insertHcntrctrLonAddRelisDe" parameterClass="java.util.Map">
		  UPDATE TBSLS_HCNTRCTR_LON
		     SET RELIS_DE          	  = #RELIS_DE#            	 
		        ,UPDUSR_ID            = #S_USER_ID#
		        ,UPDT_DT              = SYSDATE
		   WHERE 1 = 1
		     AND CNTRCTR_NO = #CNTRCTR_NO#
		     AND LON_SN     = #LON_SN#
	  </update>
	  

	<!-- 주택계약자대출 단일 조회  -->
	<select id="SLS020208DAO.selectLonOne" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT '0' AS CHK
				,'LON' AS GBN
		      	,CNTRCTR_NO        
				,LON_SN            
				,LON_SE            
				,TRNSFR_DE         
				,CDIT_TRNSFR_AMOUNT
				,CDIT_GRNTE_BANK   
				,BANK_ADRES        
				,RELIS_DE          
				,RM                
				,PRCAFS_CHARGER    
				,PRCAFS_CHRG_DEPT  
				,PRCAFS_CHRG_CTTPC
				,'' AS PRCAFS_CHRG_EMAIL 
				,LON_ATCHMNFL_COURS				
				,LON_ATCHMNFL  
			    ,LON_ATCHMNFL_COURS AS FILE_ORDR                     
				,LON_ATCHMNFL   
				,REGISTER_ID       
				,REGIST_DT         
				,UPDUSR_ID         
				,UPDT_DT      
				,FILE_SN     
		  FROM TBSLS_HCNTRCTR_LON /* 주택계약자대출 */
		 WHERE 1 = 1      
		   AND CNTRCTR_NO = #CNTRCTR_NO#
           AND LON_SN = #LON_SN#
	</select>
		  
      
	 <!-- 주택계약자대출 추가  -->
	<insert id="SLS020208DAO.insertHcntrctrLon" parameterClass="java.util.Map">
		  INSERT INTO TBSLS_HCNTRCTR_LON
		  (    
		     CNTRCTR_NO                  
			,LON_SN                   
			,LON_SE                   
			,TRNSFR_DE                   
			,CDIT_TRNSFR_AMOUNT         
			,CDIT_GRNTE_BANK       
			,BANK_ADRES             
			,RELIS_DE              
			,PRCAFS_CHARGER              
			,PRCAFS_CHRG_DEPT               
			,PRCAFS_CHRG_CTTPC
			,RM                          
			,LON_ATCHMNFL_COURS
			,LON_ATCHMNFL
			,REGISTER_ID                 
			,REGIST_DT
			,UPDUSR_ID                   
			,UPDT_DT          
			                
		  ) VALUES (
		         	     
		 	#CNTRCTR_NO#                    /*계약자번호                  */
		 	,( SELECT NVL(MAX(LON_SN),0) + 1 FROM TBSLS_HCNTRCTR_LON WHERE 1 = 1 AND CNTRCTR_NO = #CNTRCTR_NO# )          
			,#LON_SE#                    /* */			     	     
			,#TRNSFR_DE#                    	 /*     */          
			,#CDIT_TRNSFR_AMOUNT#         /*        */          
			,#CDIT_GRNTE_BANK#               /*              */          
			,#BANK_ADRES#                /*           */          
			,#RELIS_DE#            /*      */
			,#PRCAFS_CHARGER#                     	 /*    */          
			,#PRCAFS_CHRG_DEPT#             /*      */
			,#PRCAFS_CHRG_CTTPC#                   /*          */
			,#RM#                            /*      */ 
			,#LON_ATCHMNFL_COURS#                            /*             */ 
			,#LON_ATCHMNFL#                            /*                  */          
			,#S_USER_NM#                     /*등록자명                   */        
			,SYSDATE       					 /*등록일시                    */
			,#S_USER_NM#                     /*수정자명                    */          
			,SYSDATE                         /*수정일시                    */      
		  )
	  
	  </insert>
	  
	  
	 
	
	  <!-- 주택계약자대출 수정  -->
	  <update id="SLS020208DAO.updateHcntrctrLon" parameterClass="java.util.Map">
		  UPDATE TBSLS_HCNTRCTR_LON
		     SET LON_SE               = #LON_SE#             /*    */
		     	,TRNSFR_DE            = #TRNSFR_DE#             /*       */
		        ,CDIT_TRNSFR_AMOUNT   = #CDIT_TRNSFR_AMOUNT#            	  /*    */
		        ,CDIT_GRNTE_BANK      = #CDIT_GRNTE_BANK#            	  /*    */
		        ,BANK_ADRES           = #BANK_ADRES#            	  /*    */
		        ,RELIS_DE          	  = #RELIS_DE#            	  /*     */
		        ,PRCAFS_CHARGER       = #PRCAFS_CHARGER#            	  /*   */
		        ,PRCAFS_CHRG_DEPT     = #PRCAFS_CHRG_DEPT#            	  /*    */
		        ,PRCAFS_CHRG_CTTPC    = #PRCAFS_CHRG_CTTPC#            	  /*   */
		        ,RM                   = #RM#                    /*   */
		        ,LON_ATCHMNFL_COURS   = #LON_ATCHMNFL_COURS# /* 첨부파일경로*/
		        ,LON_ATCHMNFL         = #LON_ATCHMNFL#       /* 첨부파일    */
		        ,UPDUSR_ID            = #S_USER_ID#
		        ,UPDT_DT              = SYSDATE
		   WHERE 1 = 1
		     AND CNTRCTR_NO = #CNTRCTR_NO#
		     AND LON_SN     = #LON_SN#
	  </update>
	  
	  
	   
	<!-- 주택계약자대출 삭제  -->
	<delete id="SLS020208DAO.deleteHcntrctrLon" parameterClass="java.util.Map">
	      DELETE TBSLS_HCNTRCTR_LON
		   WHERE 1 = 1
             AND CNTRCTR_NO  = #CNTRCTR_NO#
             AND SEIZR_SN    = #LON_SN#
		   
	</delete>
	  
	  
	<!-- 쿼리명 : 압류 파일정보 수정
	설명 : 압류 파일정보 수정
	수정일  		수정자  	수정내용
	2016.07.28	최인석		최초생성
	작성자 : 최인석
	최초작성일 : 2016.07.28
	-->
    <insert id="SLS020208DAO.atchSeizrCUD" parameterClass="java.util.HashMap">
    	UPDATE /* SLS020208DAO.atchSeizrCUD */
    	       TBSLS_HCNTRCTR_SEIZR  		
    	   SET SEIZR_ATCHMNFL_COURS = #ATCH_FLPTH#	
             , SEIZR_ATCHMNFL = #ATCH_FILE#		
             , FILE_SN = #FILE_SN#			
             , UPDT_DT = SYSDATE			
             , UPDUSR_ID = #S_USER_ID#		
    	 WHERE 1 = 1
    	   AND CNTRCTR_NO = #CNTRCTR_NO#	
    	   AND SEIZR_SN = #SEIZR_SN#	
    </insert>
    
	  	

    <!-- 쿼리명 : 대출 파일정보 수정
	설명 : 대출  파일정보 수정
	수정일  		수정자  	수정내용
	2016.07.28	최인석		최초생성
	작성자 : 최인석
	최초작성일 : 2016.07.28
	-->
    <insert id="SLS020208DAO.atchLonCUD" parameterClass="java.util.HashMap">
    	UPDATE /* SLS020208DAO.atchLonCUD */
    	       TBSLS_HCNTRCTR_LON  		
    	   SET LON_RELIS_ATCHMNFL_COURS = #ATCH_FLPTH#	
             , LON_ATCHMNFL = #ATCH_FILE#		
             , FILE_SN = #FILE_SN#			
             , UPDT_DT = SYSDATE			
             , UPDUSR_ID = #S_USER_ID#		
    	 WHERE 1 = 1
    	   AND CNTRCTR_NO = #CNTRCTR_NO#	
    	   AND LON_SN = #LON_SN#	
    </insert>
    
    	  	
	<!-- 쿼리명 : 주택계약자사업자 목록 조회
	설명 : 주택계약자사업자 조회 쿼리
	수정일  		수정자  	수정내용
	2015.10.08	변승우	최초생성
	작성자 : 변승우
	최초작성일 : 2015.10.08
	-->
	<select id="SLS020208DAO.selectHouseLcntrctrBnsmList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
			      A.CNTRCTR_NO
			      ,A.BIZRNO
			      ,A.MTLTY_NM
			      ,B.CSTMR_NM
			      ,SFCOM_DEC_ALL(B.IHIDNUM) AS IHIDNUM
			      ,A.BIZCND
			      ,A.INDUTY
			      ,'['||B.ZIP||']' ||' '|| B.ADRES ||' '|| B.ADRES_DETAIL AS FULL_ADRES
			      ,B.ZIP
                  ,B.ADRES
                  ,B.ADRES_DETAIL
                  ,B.EMAIL
				  ,(CASE WHEN A.USE_AT = 'Y'
			           THEN A.USE_AT  /* 실납부금액 이자 , 반환이자지급율  */
			           ELSE 'N'
			       END) AS USE_AT    
			      ,A.BSNM_SN
			      ,A.HOUSE_CSTMR_NO
		FROM TBSLS_HCNTRCTR_BSNM A, TBSLS_HOUSE_CSTMR B
		WHERE 1 = 1 
		<isNotEmpty property="CNTRCTR_NO">
		AND A.CNTRCTR_NO = #CNTRCTR_NO#
		</isNotEmpty>
		<isNotEmpty property="BSNM_SN">
		AND A.BSNM_SN = #BSNM_SN#
		</isNotEmpty>
		AND A.HOUSE_CSTMR_NO = B.HOUSE_CSTMR_NO
	</select>
	


	
	<!-- 쿼리명 : 주택고객 목록 조회
	설명 : 주택고객 목록 조회 쿼리
	수정일  		수정자  	수정내용
	2015.10.07	최승락	최초생성
	작성자 : 최승락
	최초작성일 : 2015.10.07
	-->
	<select id="SLS020208DAO.selectHouseCstmrbyIhidnum" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[
			SELECT 
				  T1.HOUSE_CSTMR_NO
				, T1.CSTMR_NM
				, SFCOM_DEC_ALL(T1.IHIDNUM) AS IHIDNUM
				, T1.ZIP
				, T1.ADRES
				, T1.ADRES_DETAIL
				, T1.TELNO
				, T1.MBTLNO
				, T1.EMAIL
			  FROM TBSLS_HOUSE_CSTMR T1
			 WHERE 1 = 1
		]]>
			<isNotEmpty property="IHIDNUM">
			   AND T1.IHIDNUM = SFCOM_ENC_ALL(#IHIDNUM#)
			</isNotEmpty>
	</select>
	
	

	<!-- 쿼리명 : 주택고객 정보 수정
	설명 : 주택고객 정보 쿼리
	수정일  수정자  수정내용
	
	작성자 : 최승락
	최초작성일 : 2015.10.08
	-->
	<update id="SLS020208DAO.updateHouseCstmr" parameterClass="java.util.Map">
		UPDATE TBSLS_HOUSE_CSTMR
		   SET
			  CSTMR_NM = #CSTMR_NM#
			, IHIDNUM = SFCOM_ENC_ALL(#IHIDNUM#)
			, ZIP = #ZIP#
			, ADRES = #ADRES#
			, ADRES_DETAIL = #ADRES_DETAIL#
			, TELNO = #TELNO#
			, MBTLNO = #MBTLNO#
			, EMAIL = #EMAIL#
			, UPDUSR_ID = #S_USER_ID#
			, UPDT_DT = SYSDATE
		 WHERE 1 = 1
		   AND HOUSE_CSTMR_NO = #HOUSE_CSTMR_NO#
	</update>
		
 <select id="SLS020208DAO.houseRntchrgList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
	    SELECT 
		A.*
	    ,CEIL(TRUNC(A.BASS_RNTCHRG - (A.INDVDL_ADIT_AMT * (5.5 / 100) / 12)) * 0.1) / 0.1 AS RENT_AMT	/* 이율적용임대료 */
	    ,A.RNTCHRG - CEIL(TRUNC(A.BASS_RNTCHRG - (A.INDVDL_ADIT_AMT * (5.5 / 100) / 12)) * 0.1) / 0.1 AS RENT_CHA_AMT /* 차액 */
	    ,(SELECT INTRT FROM TBPMS_INTRT_INFO 
	    			  WHERE INTRT_KND = 'PMS' 
	    			    AND INTRT_SE = 'R2'
				        AND APPLC_DE = (SELECT MAX (APPLC_DE)
				                         FROM TBPMS_INTRT_INFO
				                        WHERE INTRT_KND = 'PMS' AND INTRT_SE = 'R2')) AS INTRT   /*R2 상호전환 , I1 보증금 , I2 임대료  */
		FROM(
		SELECT 
			 A.CNTRCTR_NO		/* 계약자번호 */
		    ,B.HOUSE_NM			/* 주택명 */
		    ,A.DONG				/* 동 */
		    ,A.HO				/* 호 */
		    ,C.CSTMR_NM				/* 계약자명 */
		    ,D.BASS_LTTOT_AMOUNT/* 기본분양금액 */
		    ,F.PAYAMT			/* 실보증금 */
		    ,F.PAYAMT - D.BASS_LTTOT_AMOUNT AS INDVDL_ADIT_AMT/* 개인증액보증금 */
		    ,D.BASS_RNTCHRG 	    /* 기본임대료 */
		    ,E.RNTCHRG			    /* 실임대료 */
            ,A.RENT_LTTOT_CNVRS_DE   /* 전환일자 */
            ,B.LTTOT_CNVRS_SE       /*분양전환구분*/
            ,B.LTTOT_CNVRS_DE      /*분양전환일자*/  		    
		FROM
			TBSLS_HCNTRCTR A
		    ,TBSLS_HOUSE_INFO B
		    ,TBSLS_HOUSE_CSTMR C
		    ,TBSLS_HOUSE_DONG_HO D
		    ,(
		      SELECT 
		      	 CNTRCTR_NO     
				,APPLC_DE       
				,RNTCHRG        
				,IRDS_INTRT     
				,BASS_IRDS_AM   
				,INDVDL_IRDS_AM 
				,RM             
		      FROM TBSLS_HOUSE_RNTCHRG A
		      WHERE APPLC_DE = (	
		    				SELECT MAX (B.APPLC_DE)
							FROM TBSLS_HOUSE_RNTCHRG B
		                    WHERE A.CNTRCTR_NO = B.CNTRCTR_NO
		                    AND   B.APPLC_DE <![CDATA[<=]]> TO_CHAR(SYSDATE, 'YYYYMMDD')
		                 	)
		    )E
		    ,(
		      SELECT CNTRCTR_NO, SUM(PAYAMT) AS PAYAMT
		      FROM TBSLS_HOUSE_LTTOT_PAY
		      WHERE PAY_CODE LIKE 'R%' AND RCIV_DE IS NOT NULL
		      GROUP BY CNTRCTR_NO
		    )F
		WHERE A.CNTRCTR_STTUS_CODE = '01' 
		AND   B.HOUSE_CODE = A.HOUSE_CODE
		AND   C.HOUSE_CSTMR_NO = A.HOUSE_CSTMR_NO
		AND   D.HOUSE_CODE = A.HOUSE_CODE
		AND   D.DONG = A.DONG
		AND   D.HO = A.HO
		AND   E.CNTRCTR_NO = A.CNTRCTR_NO
		AND   F.CNTRCTR_NO = A.CNTRCTR_NO
        AND   A.CNTRCTR_NO = #CNTRCTR_NO# 		
        AND   A.HOUSE_CODE = #HOUSE_CODE#
        AND   A.DONG = #DONG#
        AND   A.HO = #HO#
		ORDER BY A.DONG, A.HO
		) A
    </select>
    		
    		
	  <!-- 쿼리명 : 주택 임대료 등록
		설명 : 주택 임대료 등록
		수정일  수정자  수정내용
		
		작성자 : 최인석
		최초작성일 : 2016.08.19
		-->	
    <insert id="SLS020208DAO.insertHouseRntchng" parameterClass="java.util.Map">
		INSERT INTO TBSLS_HOUSE_RNTCHRG
		(
			  CNTRCTR_NO
			, APPLC_DE
			, RNTCHRG
			, IRDS_INTRT
			, BASS_IRDS_AM
			, INDVDL_IRDS_AM
			, RM
			, REGISTER_ID
			, REGIST_DT
			, UPDUSR_ID
			, UPDT_DT

		) VALUES (
			  #CNTRCTR_NO#
			, #APPLC_DE#
			, #RNTCHRG#
			, #IRDS_INTRT#
			, #BASS_IRDS_AM#
			, #INDVDL_IRDS_AM#
			, #RM#
			, #S_USER_ID#
			, SYSDATE
			, #S_USER_ID#
			, SYSDATE
	 )
	</insert>
	
	  <!-- 쿼리명 : 전출입목록 정보 조회
		설명 : 전출입목록 정보 조회
		수정일  수정자  수정내용
		
		작성자 : 최인석
		최초작성일 : 2016.08.19
		-->		
    <select id="SLS020208DAO.selectTransfe" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        SELECT 
               A.CNTRCTR_NO
              ,B.TRANSFE_AT 
              ,C.CSTMR_NM
              ,SFCOM_DEC_ALL(C.IHIDNUM) AS IHIDNUM              
              ,A.TRANSFE_SN   
              ,A.TRANSFE_DE   
              ,A.ZIP          
              ,A.BASS_ADRES    
              ,A.DETAIL_ADRES  
              ,A.RM 
              ,A.FILE_SN            
          FROM TBSLS_HCNTRCTR_TRANSFE A, TBSLS_HCNTRCTR B, TBSLS_HOUSE_CSTMR C
          WHERE 1=1
             AND A.CNTRCTR_NO = B.CNTRCTR_NO 
             AND B.HOUSE_CSTMR_NO = C.HOUSE_CSTMR_NO             
             AND A.CNTRCTR_NO = #CNTRCTR_NO# 	
		ORDER BY A.TRANSFE_SN 
    </select>	
    
    <select id="SLS020208DAO.rentPosesnThingList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        SELECT A.CNTRCTR_NO,
        	   B.HOUSE_POSESN_AT,
	           C.CSTMR_NM AS CNTRCTR_NM,
               <!-- SFCOM_DEC_ALL(C.IHIDNUM) AS IHIDNUM,  -->
               (SELECT SFCOM_DEC_ALL (IHIDNUM) FROM TBSLS_HOUSE_CSTMR S WHERE S.HOUSE_CSTMR_NO = A.HOUSE_CSTMR_NO) AS IHIDNUM, 
	           A.SN,
	           A.INQIRE_DE,
	           A.HOUSE_CSTMR_NO,
	           (SELECT CSTMR_NM  FROM TBSLS_HOUSE_CSTMR S WHERE S.HOUSE_CSTMR_NO =  A.HOUSE_CSTMR_NO) AS CSTMR_NM,
	           A.FAMILY_RELATE,
	           A.ADRES,
	           A.AR,
	           A.ACQS_DE,
	           A.TRNSFR_DE,
	           A.PRPOS,
	           A.EXPLN_SE,
	           A.PRESENTN_DE,
	           A.EXPLN_DTLS,
	           A.RM,
	           A.FILE_SN
        FROM TBSLS_POSESN_THING A, TBSLS_HCNTRCTR B, TBSLS_HOUSE_CSTMR C
        WHERE 1=1
             AND A.CNTRCTR_NO = B.CNTRCTR_NO 
             AND B.HOUSE_CSTMR_NO = C.HOUSE_CSTMR_NO
             AND A.CNTRCTR_NO = #CNTRCTR_NO# 	
		ORDER BY A.SN 
    </select> 
    
       <!-- 전출입목록 생성 -->
	<insert id="SLS020208DAO.hcntrctrTransfeC" parameterClass="java.util.HashMap">
	INSERT INTO TBSLS_HCNTRCTR_TRANSFE (
					CNTRCTR_NO,
                    TRANSFE_SN,
                    TRANSFE_DE,
                    ZIP,
                    BASS_ADRES,
                    DETAIL_ADRES,
                    RM,
                    FILE_SN,
                    REGISTER_ID,
                    REGIST_DT,
                    UPDUSR_ID,
                    UPDT_DT)
		     VALUES (
		     		 #CNTRCTR_NO#,
                     (SELECT NVL(MAX(TRANSFE_SN), 0) + 1 FROM TBSLS_HCNTRCTR_TRANSFE ),
		             #TRANSFE_DE#,
		             #ZIP#,
		             #BASS_ADRES#,
		             #DETAIL_ADRES#,
		             #RM#,
		             #FILE_SN#,
					 #S_USER_ID#,
					 SYSDATE,
					 #S_USER_ID#,
					 SYSDATE    
		             )		
	</insert>
	
		<!-- 전출입목록 수정 -->
	<update id="SLS020208DAO.hcntrctrTransfeU" parameterClass="java.util.HashMap">
		UPDATE TBSLS_HCNTRCTR_TRANSFE
		   SET CNTRCTR_NO = #CNTRCTR_NO#,
		       TRANSFE_DE = #TRANSFE_DE#,
		       ZIP = #ZIP#,
		       BASS_ADRES = #BASS_ADRES#,
		       DETAIL_ADRES = #DETAIL_ADRES#,
		       RM = #RM#,
		       FILE_SN = #FILE_SN#,
		       REGISTER_ID = #S_USER_ID#,
		       REGIST_DT = SYSDATE,
			   UPDUSR_ID = #S_USER_ID#, 
			   UPDT_DT = SYSDATE	
		WHERE TRANSFE_SN = #TRANSFE_SN#
	</update>
	
	<!-- 전출입목록 삭제 -->
	<delete id="SLS020208DAO.hcntrctrTransfeD" parameterClass="java.util.HashMap">
		DELETE FROM TBSLS_HCNTRCTR_TRANSFE
		WHERE TRANSFE_SN = #TRANSFE_SN#
	</delete>	
	
	<!-- 전출입목록 수정(주태소유 유무) 0:무, 1:유 -->
	<update id="SLS020208DAO.transfeATU" parameterClass="java.util.HashMap">
		UPDATE TBSLS_HCNTRCTR A
		   SET TRANSFE_AT =
		          NVL (
		             (SELECT SIGN(COUNT(CNTRCTR_NO))
		                FROM TBSLS_HCNTRCTR_TRANSFE B
		               WHERE     B.CNTRCTR_NO = A.CNTRCTR_NO
		             ),
		             '0')  
		   WHERE A.CNTRCTR_NO = #CNTRCTR_NO#
	</update>		
	
	<!-- 소유물건정보 생성 -->
	<insert id="SLS020208DAO.rentPosesnThingC" parameterClass="java.util.HashMap">
	 	   INSERT INTO TBSLS_POSESN_THING (
					CNTRCTR_NO,
                             SN,
                             INQIRE_DE,
                             HOUSE_CSTMR_NO,
                             FAMILY_RELATE,
                             ADRES,
                             AR,
                             ACQS_DE,
                             TRNSFR_DE,
                             PRPOS,
                             EXPLN_SE,
                             PRESENTN_DE,
                             EXPLN_DTLS,
                             RM,
                             FILE_SN,
                             REGISTER_ID,
                             REGIST_DT,
                             UPDUSR_ID,
                             UPDT_DT                              
                             )
                  	VALUES (
                  			#CNTRCTR_NO#,
                          	(SELECT NVL(MAX(SN), 0) + 1 FROM TBSLS_POSESN_THING ),
                          	#INQIRE_DE#,
                          	#HOUSE_CSTMR_NO#,
                          	#FAMILY_RELATE#,
                          	#ADRES#,
                          	#AR#,
                          	#ACQS_DE#,
                          	#TRNSFR_DE#,
                          	#PRPOS#,
                          	#EXPLN_SE#,
                          	#PRESENTN_DE#,
                          	#EXPLN_DTLS#,
                          	#RM#,
                          	#FILE_SN#,
							#S_USER_ID#,
							SYSDATE,
							#S_USER_ID#,
							SYSDATE                             	
                          	)		
	</insert>
	
			<!-- 소유물건정보 수정 -->
	<update id="SLS020208DAO.rentPosesnThingU" parameterClass="java.util.HashMap">
		
		UPDATE TBSLS_POSESN_THING
		   SET CNTRCTR_NO = #CNTRCTR_NO#,
		       INQIRE_DE = #INQIRE_DE#,
		       HOUSE_CSTMR_NO = #HOUSE_CSTMR_NO#,
		       FAMILY_RELATE = #FAMILY_RELATE#,
		       ADRES = #ADRES#,
		       AR = #AR#,
		       ACQS_DE = #ACQS_DE#,
		       TRNSFR_DE = #TRNSFR_DE#,
		       PRPOS = #PRPOS#,
		       EXPLN_SE = #EXPLN_SE#,
		       PRESENTN_DE = #PRESENTN_DE#,
		       EXPLN_DTLS = #EXPLN_DTLS#,
		       RM = #RM#,
		       FILE_SN = #FILE_SN#,
		       REGISTER_ID = #S_USER_ID#,
		       REGIST_DT = SYSDATE,		       
			   UPDUSR_ID = #S_USER_ID#, 
			   UPDT_DT = SYSDATE	
		WHERE SN = #SN#
	</update>
	
	<!-- 소유물건정보 삭제 -->
	<delete id="SLS020208DAO.rentPosesnThingD" parameterClass="java.util.HashMap">
		DELETE FROM TBSLS_POSESN_THING
		WHERE SN = #SN#
	</delete>	
	
	<!-- 소유물건정보 수정(주태소유 유무) 0:무, 1:유 -->
	<update id="SLS020208DAO.housePosesnAtU" parameterClass="java.util.HashMap">
        UPDATE TBSLS_HCNTRCTR A 
               SET HOUSE_POSESN_AT = NVL( 
                      (SELECT DISTINCT CHRCTR_PREPAR_VALUE_0 
                        FROM TBSLS_POSESN_THING B, 
                             (SELECT * 
                               FROM TBCOM_CMMN_CODE 
                              WHERE GRP_CODE = 'RNT013' 
                                    AND CHRCTR_PREPAR_VALUE_0 = 1 
                             ) C 
                       WHERE B.CNTRCTR_NO     = A.CNTRCTR_NO
                         AND C.CODE         = NVL(B.EXPLN_SE, '02') 
                      ), '0') 
            WHERE A.CNTRCTR_NO = #CNTRCTR_NO#
	</update>	

<!-- 영구임대고객 가족 목록
	작성자 : 한상훈
	 -->
	<select id="SLS020208DAO.selectRentCstmrFamilyList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		/* SLS020208DAO.selectRentCstmrFamilyList[주택고객 가족 목록] */
        SELECT 
             A.FAMILY_SN        /*가족일련번호*/
            ,A.CNTRCTR_CSTMR_NO    /*계약자고객번호*/
            ,A.FAMILY_RELATE    /*가족관계*/ 
            ,A.CNTRCTR_RELATE    /*가족관계*/             
            ,A.RM                            /* 비고 */                       
            ,A.CNTRCTR_NO        /*계약자번호*/
            ,A.PORTAL_REGIST_AT                /* 포털등록여부 */            
            ,A.HOUSE_CSTMR_NO    /*주택고객번호*/
            ,B.CSTMR_NM                /*성명*/
            ,SFCOM_DEC_ALL(B.IHIDNUM) AS IHIDNUM           /*주민등록번호*/
            ,B.ZIP               /*우편번호*/
            ,B.ADRES             /*주소*/
            ,B.ADRES_DETAIL      /*상세_주소*/
            ,B.TELNO             /*전화번호*/
            ,B.MBTLNO            /*휴대폰번호*/
            ,B.EMAIL            /*이메일*/
        FROM TBSLS_HCNTRCTR_FAMILY A, TBSLS_HOUSE_CSTMR B
        WHERE 1=1 
        AND   A.HOUSE_CSTMR_NO = B.HOUSE_CSTMR_NO
        AND   A.CNTRCTR_NO  = #CNTRCTR_NO#
       ORDER BY A.FAMILY_RELATE   		 
	</select>
<!-- 소유물건 정보 첨부파일 등록시 파일일련번호 업데이트 -->	
	<insert id="SLS020208DAO.atchCUD2" parameterClass="java.util.Map">		
	 UPDATE TBSLS_POSESN_THING
	    SET FILE_SN 			= #FILE_SN#
	  WHERE SN					= #P_SN#
	</insert>
	
	<insert id="SLS020208DAO.atchCUD3" parameterClass="java.util.Map">		
	 UPDATE TBSLS_HCNTRCTR_TRANSFE
	    SET FILE_SN 			= #FILE_SN#
	  WHERE SN					= #P_SN#
	</insert>	

	<!-- 첨부파일 상세 건수 조회 -->
	<select id="SLS020208DAO.FILECNT" parameterClass="java.util.Map" resultClass="java.lang.Integer">
	 SELECT COUNT(*) AS CNT
	   FROM TBCOM_CMMN_ATCHMNFL
	  WHERE 1=1
	    AND FILE_SN = #FILE_SN#   
	</select>	

	<!-- 첨부파일 목록조회(팝업) -->	
	<select id="SLS020208DAO.ATCH_DOWN_LIST" parameterClass="java.util.Map" resultClass="java.util.HashMap">
	 SELECT  FILE_SN
	       , FILE_ORDR
	       , ORGINL_FILE_NM AS FILE_NM       
	       , FILE_EXTSN
	   FROM TBCOM_CMMN_ATCHMNFL
	  WHERE 1=1
	    AND FILE_SN = #FILE_SN#   
	</select>	

	<!-- 소유물건 정보 첨부파일 삭제 -->
	<delete id="SLS020208DAO.ATCH_FILE_DEL" parameterClass="java.util.Map">
		UPDATE TBSLS_POSESN_THING
		   SET FILE_SN 			= null
	  WHERE SN					= #P_SN#
	</delete>
	
	<!-- 소유물건 정보 첨부파일 삭제 -->
	<delete id="SLS020208DAO.ATCH_FILE_DEL3" parameterClass="java.util.Map">
		UPDATE TBSLS_HCNTRCTR_TRANSFE
		   SET FILE_SN 			= null
	  WHERE SN					= #P_SN#
	</delete>
	
	<parameterMap id="SPSLS_HOU_CTR_CANCEL_param" class="java.util.HashMap">
		<parameter property="IN_CNTRCTR_NO"		jdbcType="VARCHAR"	javaType="string" 	mode="IN" />
		<parameter property="IN_REGISTER_ID"		jdbcType="VARCHAR"	javaType="string" 	mode="IN" />					
	</parameterMap>	
	
	<procedure id="SLS020208DAO.SPSLS_HOU_CTR_CANCEL" parameterMap="SPSLS_HOU_CTR_CANCEL_param">
		{ call SPSLS_HOU_CTR_CANCEL(?,?) }
	</procedure>		
</sqlMap>