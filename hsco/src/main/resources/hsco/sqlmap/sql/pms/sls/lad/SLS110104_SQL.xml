<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="SLS110104DAO">	

<!--
SQL File Name : SLS110104_SQL.xml
Description : 토지현황조회
Modification Information
수정일			수정자		Version	Query Id
2015.10.04	이상준		1.0		최초 생성
-->

   <!-- 쿼리명 : 토지공급기초내역조회
	설명 : 토지상세정보 조회
	수정일  		수정자  	수정내용
	2015.10.04	이상준		최초생성
	작성자 : 이상준
	최초작성일 : 2015.10.04
	-->
	<select id="SLS110104DAO.selectLadSuplyDtlsList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		WITH V_LCNTRCTR_PAY AS
		(
		   SELECT x1.CNTRCTR_NO
		   		/* 계약금(S0), 임대보증금(R0) */
		        , SUM(x1.PAYAMT_0) AS PAYAMT_0
		        , MAX(x1.PAY_TMLMT_0) AS PAY_TMLMT_0
		        , SUM(x1.ARRRG_AMOUNT_0) AS ARRRG_AMOUNT_0
		        , SUM(x1.PREPAY_DSCNT_AMOUNT_0) AS PREPAY_DSCNT_AMOUNT_0
		        , MAX(x1.RCIV_DE_0) AS RCIV_DE_0
		        , SUM(x1.RCIV_AMOUNT_0) AS RCIV_AMOUNT_0
		        , SUM(x1.INSTLMT_INTR_0) AS INSTLMT_INTR_0
		        /* 1차중도금(S1), 재.보증금(1차)(R1) */
		        , SUM(x1.PAYAMT_1) AS PAYAMT_1
		        , MAX(x1.PAY_TMLMT_1) AS PAY_TMLMT_1
		        , SUM(x1.ARRRG_AMOUNT_1) AS ARRRG_AMOUNT_1
		        , SUM(x1.PREPAY_DSCNT_AMOUNT_1) AS PREPAY_DSCNT_AMOUNT_1
		        , MAX(x1.RCIV_DE_1) AS RCIV_DE_1
		        , SUM(x1.RCIV_AMOUNT_1) AS RCIV_AMOUNT_1
		        , SUM(x1.INSTLMT_INTR_1) AS INSTLMT_INTR_1
		        /* 2차중도금(S2), 재.보증금(2차)(R2) */
		        , SUM(x1.PAYAMT_2) AS PAYAMT_2
		        , MAX(x1.PAY_TMLMT_2) AS PAY_TMLMT_2
		        , SUM(x1.ARRRG_AMOUNT_2) AS ARRRG_AMOUNT_2
		        , SUM(x1.PREPAY_DSCNT_AMOUNT_2) AS PREPAY_DSCNT_AMOUNT_2
		        , MAX(x1.RCIV_DE_2) AS RCIV_DE_2
		        , SUM(x1.RCIV_AMOUNT_2) AS RCIV_AMOUNT_2
		        , SUM(x1.INSTLMT_INTR_2) AS INSTLMT_INTR_2
		        /* 3차중도금(S3), 재.보증금(3차)(R3) */
		        , SUM(x1.PAYAMT_3) AS PAYAMT_3
		        , MAX(x1.PAY_TMLMT_3) AS PAY_TMLMT_3
		        , SUM(x1.ARRRG_AMOUNT_3) AS ARRRG_AMOUNT_3
		        , SUM(x1.PREPAY_DSCNT_AMOUNT_3) AS PREPAY_DSCNT_AMOUNT_3
		        , MAX(x1.RCIV_DE_3) AS RCIV_DE_3
		        , SUM(x1.RCIV_AMOUNT_3) AS RCIV_AMOUNT_3
		        , SUM(x1.INSTLMT_INTR_3) AS INSTLMT_INTR_3
		        /* 4차중도금(S4), 재.보증금(4차)(R4) */
		        , SUM(x1.PAYAMT_4) AS PAYAMT_4
		        , MAX(x1.PAY_TMLMT_4) AS PAY_TMLMT_4
		        , SUM(x1.ARRRG_AMOUNT_4) AS ARRRG_AMOUNT_4
		        , SUM(x1.PREPAY_DSCNT_AMOUNT_4) AS PREPAY_DSCNT_AMOUNT_4
		        , MAX(x1.RCIV_DE_4) AS RCIV_DE_4
		        , SUM(x1.RCIV_AMOUNT_4) AS RCIV_AMOUNT_4
		        , SUM(x1.INSTLMT_INTR_4) AS INSTLMT_INTR_4
		        /* 5차중도금(S5), 재.보증금(5차)(R5) */
		        , SUM(x1.PAYAMT_5) AS PAYAMT_5
		        , MAX(x1.PAY_TMLMT_5) AS PAY_TMLMT_5
		        , SUM(x1.ARRRG_AMOUNT_5) AS ARRRG_AMOUNT_5
		        , SUM(x1.PREPAY_DSCNT_AMOUNT_5) AS PREPAY_DSCNT_AMOUNT_5
		        , MAX(x1.RCIV_DE_5) AS RCIV_DE_5
		        , SUM(x1.RCIV_AMOUNT_5) AS RCIV_AMOUNT_5
		        , SUM(x1.INSTLMT_INTR_5) AS INSTLMT_INTR_5
		        /* 잔금(S9), 잔금(임대)(R9) */
		        , SUM(x1.PAYAMT_9) AS PAYAMT_9
		        , MAX(x1.PAY_TMLMT_9) AS PAY_TMLMT_9
		        , SUM(x1.ARRRG_AMOUNT_9) AS ARRRG_AMOUNT_9
		        , SUM(x1.PREPAY_DSCNT_AMOUNT_9) AS PREPAY_DSCNT_AMOUNT_9
		        , MAX(x1.RCIV_DE_9) AS RCIV_DE_9
		        , SUM(x1.RCIV_AMOUNT_9) AS RCIV_AMOUNT_9
		        , SUM(x1.INSTLMT_INTR_9) AS INSTLMT_INTR_9
		        /* 정산금(SE) */
		        , SUM(x1.PAYAMT_E) AS PAYAMT_E
		        , MAX(x1.PAY_TMLMT_E) AS PAY_TMLMT_E
		        , SUM(x1.ARRRG_AMOUNT_E) AS ARRRG_AMOUNT_E
		        , SUM(x1.PREPAY_DSCNT_AMOUNT_E) AS PREPAY_DSCNT_AMOUNT_E
		        , MAX(x1.RCIV_DE_E) AS RCIV_DE_E
		        , SUM(x1.RCIV_AMOUNT_E) AS RCIV_AMOUNT_E
		        , SUM(x1.INSTLMT_INTR_E) AS INSTLMT_INTR_E
		        /* 할부(분양금)(SA) */
		        , SUM(x1.PAYAMT_A) AS PAYAMT_A
		        , MAX(x1.PAY_TMLMT_A) AS PAY_TMLMT_A
		        , SUM(x1.ARRRG_AMOUNT_A) AS ARRRG_AMOUNT_A
		        , SUM(x1.PREPAY_DSCNT_AMOUNT_A) AS PREPAY_DSCNT_AMOUNT_A
		        , MAX(x1.RCIV_DE_A) AS RCIV_DE_A
		        , SUM(x1.RCIV_AMOUNT_A) AS RCIV_AMOUNT_A
		        , SUM(x1.INSTLMT_INTR_A) AS INSTLMT_INTR_A
		        /* 철거이행보증금(RR) */
		        , SUM(x1.PAYAMT_C) AS PAYAMT_C
		        , MAX(x1.PAY_TMLMT_C) AS PAY_TMLMT_C
		        , SUM(x1.ARRRG_AMOUNT_C) AS ARRRG_AMOUNT_C
		        , SUM(x1.PREPAY_DSCNT_AMOUNT_C) AS PREPAY_DSCNT_AMOUNT_C
		        , MAX(x1.RCIV_DE_C) AS RCIV_DE_C
		        , SUM(x1.RCIV_AMOUNT_C) AS RCIV_AMOUNT_C
		        , SUM(x1.INSTLMT_INTR_C) AS INSTLMT_INTR_C
		    FROM (
		          SELECT x.CNTRCTR_NO
		               /* 계약금(S0), 임대보증금(R0) */
		               , (CASE WHEN x.PAY_CODE IN('S0','R0') THEN SUM(NVL(x.PAYAMT,0) + NVL(x.RDCAMT_AMOUNT,0)) ELSE 0 END)	AS PAYAMT_0		/* 납부급액(납부금액 + 감액금액) */
		               , (CASE WHEN x.PAY_CODE IN('S0','R0') THEN MAX(x.PAY_TMLMT) ELSE NULL END)						AS PAY_TMLMT_0			/* 납부기한일 */
		               , (CASE WHEN x.PAY_CODE IN('S0','R0') THEN SUM(NVL(x.ARRRG_AMOUNT,0)) ELSE 0 END)				AS ARRRG_AMOUNT_0		/* 연체금액 */
		               , (CASE WHEN x.PAY_CODE IN('S0','R0') THEN SUM(NVL(x.PREPAY_DSCNT_AMOUNT,0)) ELSE 0 END)		AS PREPAY_DSCNT_AMOUNT_0	/* 선납할인금액 */
		               , (CASE WHEN x.PAY_CODE IN('S0','R0') THEN MAX(y.RCIV_DE) ELSE NULL END)						AS RCIV_DE_0				/* 수납일자 */
		               , (CASE WHEN x.PAY_CODE IN('S0','R0') THEN SUM(NVL(y.RCIV_AMOUNT,0)) ELSE 0 END)				AS RCIV_AMOUNT_0			/* 수납금액(계약) */
		               , (CASE WHEN x.PAY_CODE IN('S0','R0') THEN SUM(NVL(x.INSTLMT_INTR,0)) ELSE 0 END)				AS INSTLMT_INTR_0		/* 할부이자금액 */
		               /* 1차중도금(S1), 재.보증금(1차)(R1) */
		               , (CASE WHEN x.PAY_CODE IN('S1','R1') THEN SUM(NVL(x.PAYAMT,0) + NVL(x.RDCAMT_AMOUNT,0)) ELSE 0 END)	AS PAYAMT_1
		               , (CASE WHEN x.PAY_CODE IN('S1','R1') THEN MAX(x.PAY_TMLMT) ELSE NULL END)						AS PAY_TMLMT_1
		               , (CASE WHEN x.PAY_CODE IN('S1','R1') THEN SUM(NVL(x.ARRRG_AMOUNT,0)) ELSE 0 END)				AS ARRRG_AMOUNT_1
		               , (CASE WHEN x.PAY_CODE IN('S1','R1') THEN SUM(NVL(x.PREPAY_DSCNT_AMOUNT,0)) ELSE 0 END)		AS PREPAY_DSCNT_AMOUNT_1
		               , (CASE WHEN x.PAY_CODE IN('S1','R1') THEN MAX(y.RCIV_DE) ELSE NULL END)						AS RCIV_DE_1
		               , (CASE WHEN x.PAY_CODE IN('S1','R1') THEN SUM(NVL(y.RCIV_AMOUNT,0)) ELSE 0 END)				AS RCIV_AMOUNT_1
		               , (CASE WHEN x.PAY_CODE IN('S1','R1') THEN SUM(NVL(x.INSTLMT_INTR,0)) ELSE 0 END)				AS INSTLMT_INTR_1
		               /* 2차중도금(S2), 재.보증금(2차)(R2) */
		               , (CASE WHEN x.PAY_CODE IN('S2','R2') THEN SUM(NVL(x.PAYAMT,0) + NVL(x.RDCAMT_AMOUNT,0)) ELSE 0 END)	AS PAYAMT_2
		               , (CASE WHEN x.PAY_CODE IN('S2','R2') THEN MAX(x.PAY_TMLMT) ELSE NULL END)					AS PAY_TMLMT_2
		               , (CASE WHEN x.PAY_CODE IN('S2','R2') THEN SUM(NVL(x.ARRRG_AMOUNT,0)) ELSE 0 END)			AS ARRRG_AMOUNT_2
		               , (CASE WHEN x.PAY_CODE IN('S2','R2') THEN SUM(NVL(x.PREPAY_DSCNT_AMOUNT,0)) ELSE 0 END)		AS PREPAY_DSCNT_AMOUNT_2
		               , (CASE WHEN x.PAY_CODE IN('S2','R2') THEN MAX(y.RCIV_DE) ELSE NULL END)						AS RCIV_DE_2
		               , (CASE WHEN x.PAY_CODE IN('S2','R2') THEN SUM(NVL(y.RCIV_AMOUNT,0)) ELSE 0 END)				AS RCIV_AMOUNT_2
		               , (CASE WHEN x.PAY_CODE IN('S2','R2') THEN SUM(NVL(x.INSTLMT_INTR,0)) ELSE 0 END)			AS INSTLMT_INTR_2
		               /* 3차중도금(S3), 재.보증금(3차)(R3) */
		               , (CASE WHEN x.PAY_CODE IN('S3','R3') THEN SUM(NVL(x.PAYAMT,0) + NVL(x.RDCAMT_AMOUNT,0)) ELSE 0 END)	AS PAYAMT_3
		               , (CASE WHEN x.PAY_CODE IN('S3','R3') THEN MAX(x.PAY_TMLMT) ELSE NULL END)					AS PAY_TMLMT_3
		               , (CASE WHEN x.PAY_CODE IN('S3','R3') THEN SUM(NVL(x.ARRRG_AMOUNT,0)) ELSE 0 END)			AS ARRRG_AMOUNT_3
		               , (CASE WHEN x.PAY_CODE IN('S3','R3') THEN SUM(NVL(x.PREPAY_DSCNT_AMOUNT,0)) ELSE 0 END)		AS PREPAY_DSCNT_AMOUNT_3
		               , (CASE WHEN x.PAY_CODE IN('S3','R3') THEN MAX(y.RCIV_DE) ELSE NULL END)						AS RCIV_DE_3
		               , (CASE WHEN x.PAY_CODE IN('S3','R3') THEN SUM(NVL(y.RCIV_AMOUNT,0)) ELSE 0 END)				AS RCIV_AMOUNT_3
		               , (CASE WHEN x.PAY_CODE IN('S3','R3') THEN SUM(NVL(x.INSTLMT_INTR,0)) ELSE 0 END)			AS INSTLMT_INTR_3
		               /* 4차중도금(S4), 재.보증금(4차)(R4) */
		               , (CASE WHEN x.PAY_CODE IN('S4','R4') THEN SUM(NVL(x.PAYAMT,0) + NVL(x.RDCAMT_AMOUNT,0)) ELSE 0 END)	AS PAYAMT_4
		               , (CASE WHEN x.PAY_CODE IN('S4','R4') THEN MAX(x.PAY_TMLMT) ELSE NULL END)					AS PAY_TMLMT_4
		               , (CASE WHEN x.PAY_CODE IN('S4','R4') THEN SUM(NVL(x.ARRRG_AMOUNT,0)) ELSE 0 END)			AS ARRRG_AMOUNT_4
		               , (CASE WHEN x.PAY_CODE IN('S4','R4') THEN SUM(NVL(x.PREPAY_DSCNT_AMOUNT,0)) ELSE 0 END)		AS PREPAY_DSCNT_AMOUNT_4
		               , (CASE WHEN x.PAY_CODE IN('S4','R4') THEN MAX(y.RCIV_DE) ELSE NULL END)						AS RCIV_DE_4
		               , (CASE WHEN x.PAY_CODE IN('S4','R4') THEN SUM(NVL(y.RCIV_AMOUNT,0)) ELSE 0 END)				AS RCIV_AMOUNT_4
		               , (CASE WHEN x.PAY_CODE IN('S4','R4') THEN SUM(NVL(x.INSTLMT_INTR,0)) ELSE 0 END)			AS INSTLMT_INTR_4
		               /* 5차중도금(S5), 재.보증금(5차)(R5) */
		               , (CASE WHEN x.PAY_CODE IN('S5','R5') THEN SUM(NVL(x.PAYAMT,0) + NVL(x.RDCAMT_AMOUNT,0)) ELSE 0 END)	AS PAYAMT_5
		               , (CASE WHEN x.PAY_CODE IN('S5','R5') THEN MAX(x.PAY_TMLMT) ELSE NULL END)					AS PAY_TMLMT_5
		               , (CASE WHEN x.PAY_CODE IN('S5','R5') THEN SUM(NVL(x.ARRRG_AMOUNT,0)) ELSE 0 END)			AS ARRRG_AMOUNT_5
		               , (CASE WHEN x.PAY_CODE IN('S5','R5') THEN SUM(NVL(x.PREPAY_DSCNT_AMOUNT,0)) ELSE 0 END)		AS PREPAY_DSCNT_AMOUNT_5
		               , (CASE WHEN x.PAY_CODE IN('S5','R5') THEN MAX(y.RCIV_DE) ELSE NULL END)						AS RCIV_DE_5
		               , (CASE WHEN x.PAY_CODE IN('S5','R5') THEN SUM(NVL(y.RCIV_AMOUNT,0)) ELSE 0 END)				AS RCIV_AMOUNT_5
		               , (CASE WHEN x.PAY_CODE IN('S5','R5') THEN SUM(NVL(x.INSTLMT_INTR,0)) ELSE 0 END)			AS INSTLMT_INTR_5
		               /* 잔금(S9), 잔금(임대)(R9) */
		               , (CASE WHEN x.PAY_CODE IN('S9','R9') THEN SUM(NVL(x.PAYAMT,0) + NVL(x.RDCAMT_AMOUNT,0)) ELSE 0 END)	AS PAYAMT_9
		               , (CASE WHEN x.PAY_CODE IN('S9','R9') THEN MAX(x.PAY_TMLMT) ELSE NULL END)					AS PAY_TMLMT_9
		               , (CASE WHEN x.PAY_CODE IN('S9','R9') THEN SUM(NVL(x.ARRRG_AMOUNT,0)) ELSE 0 END)			AS ARRRG_AMOUNT_9
		               , (CASE WHEN x.PAY_CODE IN('S9','R9') THEN SUM(NVL(x.PREPAY_DSCNT_AMOUNT,0)) ELSE 0 END)		AS PREPAY_DSCNT_AMOUNT_9
		               , (CASE WHEN x.PAY_CODE IN('S9','R9') THEN MAX(y.RCIV_DE) ELSE NULL END)						AS RCIV_DE_9
		               , (CASE WHEN x.PAY_CODE IN('S9','R9') THEN SUM(NVL(y.RCIV_AMOUNT,0)) ELSE 0 END)				AS RCIV_AMOUNT_9
		               , (CASE WHEN x.PAY_CODE IN('S9','R9') THEN SUM(NVL(x.INSTLMT_INTR,0)) ELSE 0 END)			AS INSTLMT_INTR_9
		               /* 정산금(SE) */
		               , (CASE WHEN x.PAY_CODE = 'SE' THEN SUM(NVL(x.PAYAMT,0) + NVL(x.RDCAMT_AMOUNT,0)) ELSE 0 END)	AS PAYAMT_E
		               , (CASE WHEN x.PAY_CODE = 'SE' THEN MAX(x.PAY_TMLMT) ELSE NULL END)							AS PAY_TMLMT_E
		               , (CASE WHEN x.PAY_CODE = 'SE' THEN SUM(NVL(x.ARRRG_AMOUNT,0)) ELSE 0 END)					AS ARRRG_AMOUNT_E
		               , (CASE WHEN x.PAY_CODE = 'SE' THEN SUM(NVL(x.PREPAY_DSCNT_AMOUNT,0)) ELSE 0 END)			AS PREPAY_DSCNT_AMOUNT_E
		               , (CASE WHEN x.PAY_CODE = 'SE' THEN MAX(y.RCIV_DE) ELSE NULL END)							AS RCIV_DE_E
		               , (CASE WHEN x.PAY_CODE = 'SE' THEN SUM(NVL(y.RCIV_AMOUNT,0)) ELSE 0 END)					AS RCIV_AMOUNT_E
		               , (CASE WHEN x.PAY_CODE = 'SE' THEN SUM(NVL(x.INSTLMT_INTR,0)) ELSE 0 END)					AS INSTLMT_INTR_E
		               /* 할부(분양금)(SA) */
		               , (CASE WHEN x.PAY_CODE = 'SA' THEN SUM(NVL(x.PAYAMT,0) + NVL(x.RDCAMT_AMOUNT,0)) ELSE 0 END)	AS PAYAMT_A
		               , (CASE WHEN x.PAY_CODE = 'SA' THEN MAX(x.PAY_TMLMT) ELSE NULL END)							AS PAY_TMLMT_A
		               , (CASE WHEN x.PAY_CODE = 'SA' THEN SUM(NVL(x.ARRRG_AMOUNT,0)) ELSE 0 END)					AS ARRRG_AMOUNT_A
		               , (CASE WHEN x.PAY_CODE = 'SA' THEN SUM(NVL(x.PREPAY_DSCNT_AMOUNT,0)) ELSE 0 END)			AS PREPAY_DSCNT_AMOUNT_A
		               , (CASE WHEN x.PAY_CODE = 'SA' THEN MAX(y.RCIV_DE) ELSE NULL END)							AS RCIV_DE_A
		               , (CASE WHEN x.PAY_CODE = 'SA' THEN SUM(NVL(y.RCIV_AMOUNT,0)) ELSE 0 END)					AS RCIV_AMOUNT_A
		               , (CASE WHEN x.PAY_CODE = 'SA' THEN SUM(NVL(x.INSTLMT_INTR,0)) ELSE 0 END)					AS INSTLMT_INTR_A
		               /* 철거이행보증금(RR) */
		               , (CASE WHEN x.PAY_CODE = 'RR' THEN SUM(NVL(x.PAYAMT,0) + NVL(x.RDCAMT_AMOUNT,0)) ELSE 0 END)	AS PAYAMT_C
		               , (CASE WHEN x.PAY_CODE = 'RR' THEN MAX(x.PAY_TMLMT) ELSE NULL END)							AS PAY_TMLMT_C
		               , (CASE WHEN x.PAY_CODE = 'RR' THEN SUM(NVL(x.ARRRG_AMOUNT,0)) ELSE 0 END)					AS ARRRG_AMOUNT_C
		               , (CASE WHEN x.PAY_CODE = 'RR' THEN SUM(NVL(x.PREPAY_DSCNT_AMOUNT,0)) ELSE 0 END)			AS PREPAY_DSCNT_AMOUNT_C
		               , (CASE WHEN x.PAY_CODE = 'RR' THEN MAX(y.RCIV_DE) ELSE NULL END)							AS RCIV_DE_C
		               , (CASE WHEN x.PAY_CODE = 'RR' THEN SUM(NVL(y.RCIV_AMOUNT,0)) ELSE 0 END)					AS RCIV_AMOUNT_C
		               , (CASE WHEN x.PAY_CODE = 'RR' THEN SUM(NVL(x.INSTLMT_INTR,0)) ELSE 0 END)					AS INSTLMT_INTR_C
		            FROM TBSLS_LCNTRCTR_PAY x		/* 토지계약자납부 : lnt_ct_vote 계약자 납부정보(일반) */
		               , TBSLS_LAD_RCIV_PSTMRK y			/* 토지수납 : lnt_ct_receipt 계약자 수납정보_징수 */
		           WHERE 1 = 1
		             AND x.CNTRCTR_NO = y.CNTRCTR_NO(+)
		             AND x.PAY_NO = y.PAY_NO(+)
		             AND x.PAY_CODE LIKE 'S%'
		           GROUP BY x.CNTRCTR_NO
		                  , x.PAY_CODE
		         ) x1
		   WHERE 1 = 1
		     /* 각 납부코드별 납부금액(납부금액 + 감액금액)의 합이 0이 아닌 건 */
		     <![CDATA[
		     AND (x1.PAYAMT_0 + x1.PAYAMT_1 + x1.PAYAMT_2 + x1.PAYAMT_3 + x1.PAYAMT_4 + x1.PAYAMT_5 + x1.PAYAMT_9 + x1.PAYAMT_A + x1.PAYAMT_E) <> 0
		     ]]>
		   GROUP BY x1.CNTRCTR_NO
		)
		, V_LCNTRCTR AS
		(
			<include refid="COM000000.v_sls_lcntrctr_info"/>
		)
		SELECT /* SLS110104DAO.selectLadSuplyDtlsList 토지공급기초내역 조회 */
			   b2.LAD_NM	/* 토지명 */
		     , a2.LAD_CODE			, a2.BLCK			, a2.LOT				, a2.LOT_TY
		     , a2.LOCPLC_ZIP		, a2.LOCPLC_BASS_ADRES     	, a2.LOCPLC_DETAIL_ADRES
		     , a2.LOCPLC_ADRES
		     , a2.LOCPLC_ZIP_LNM	, a2.LOCPLC_BASS_ADRES_LNM	, a2.LOCPLC_DETAIL_ADRES_LNM
		     , a2.LOCPLC_ADRES_LNM
		     , DECODE(a2.LOCPLC_ADRES_LNM, NULL, a2.LOCPLC_ADRES, a2.LOCPLC_ADRES_LNM) AS LAD_ADRES
		     , a2.BGNN_UNTPC    	, a2.BGNN_AMOUNT	, a2.DCSN_UNTPC			, a2.DCSN_AMOUNT
		     , a2.IRDS_UNTPC		, a2.IRDS_AMT    	, a2.BGNN_AR    		, a2.DCSN_AR
		     , a2.IRDS_AR	    	, a2.LAD_SE	 	   	, a2.LAD_SE_NM    		, a2.CNTRCT_STTUS
		     , a2.CNTRCT_STTUS_NM	, a2.REMNDR_LAD_SE	, a2.REMNDR_LAD_SE_NM	, a2.CNTNT_SE
		     , a2.CNTNT_SE_NM    	, a2.BLCK_SUM    	, a2.CNTRCTR_NO    		, a2.CNTRCT_DE
		     , a2.LAD_CSTMR_NO    	, a2.CSTMR_NM    			, a2.TELNO    			, a2.MBTLNO
		     <isEqual property="IHIDNUM_STTUS_AT" compareValue = "N">							
		         ,DECODE(a2.IHIDNUM, NULL, '', SUBSTR(a2.IHIDNUM,0,6)||'*******') AS IHIDNUM                  /* 주민번호 */			         
		      </isEqual>	
	          <isEqual property="IHIDNUM_STTUS_AT" compareValue = "Y">							
		         ,DECODE(a2.IHIDNUM, NULL, '', a2.IHIDNUM) AS IHIDNUM      /* 주민번호 */					
	          </isEqual>
		     , a2.CNTRCTR_MTLTY	, a2.PRPOS_SE    		, a2.PRPOS_SE_NM
		     , a2.SUPLY_CODE    	, a2.SUPLY_CODE_NM	, a2.ZIP    			, a2.ADRES
		     , a2.ZIP_DM    		, a2.ADRES_DM
		     , a2.PAYAMT_0    		, a2.PAY_TMLMT_0	, a2.ARRRG_AMOUNT_0     , a2.PREPAY_DSCNT_AMOUNT_0
		     , a2.RCIV_DE_0    		, a2.RCIV_AMOUNT_0	, a2.INSTLMT_INTR_0
		     , a2.PAYAMT_1     		, a2.PAY_TMLMT_1    , a2.ARRRG_AMOUNT_1     , a2.PREPAY_DSCNT_AMOUNT_1
		     , a2.RCIV_DE_1     	, a2.RCIV_AMOUNT_1  , a2.INSTLMT_INTR_1
		     , a2.PAYAMT_2     		, a2.PAY_TMLMT_2    , a2.ARRRG_AMOUNT_2     , a2.PREPAY_DSCNT_AMOUNT_2
		     , a2.RCIV_DE_2     	, a2.RCIV_AMOUNT_2  , a2.INSTLMT_INTR_2
		     , a2.PAYAMT_3     		, a2.PAY_TMLMT_3    , a2.ARRRG_AMOUNT_3     , a2.PREPAY_DSCNT_AMOUNT_3
		     , a2.RCIV_DE_3     	, a2.RCIV_AMOUNT_3  , a2.INSTLMT_INTR_3
		     , a2.PAYAMT_4     		, a2.PAY_TMLMT_4    , a2.ARRRG_AMOUNT_4     , a2.PREPAY_DSCNT_AMOUNT_4
		     , a2.RCIV_DE_4     	, a2.RCIV_AMOUNT_4  , a2.INSTLMT_INTR_4
		     , a2.PAYAMT_5     		, a2.PAY_TMLMT_5    , a2.ARRRG_AMOUNT_5     , a2.PREPAY_DSCNT_AMOUNT_5
		     , a2.RCIV_DE_5     	, a2.RCIV_AMOUNT_5  , a2.INSTLMT_INTR_5
		     , a2.PAYAMT_9     		, a2.PAY_TMLMT_9    , a2.ARRRG_AMOUNT_9     , a2.PREPAY_DSCNT_AMOUNT_9
		     , a2.RCIV_DE_9     	, a2.RCIV_AMOUNT_9  , a2.INSTLMT_INTR_9
		     , a2.PAYAMT_E     		, a2.PAY_TMLMT_E    , a2.ARRRG_AMOUNT_E     , a2.PREPAY_DSCNT_AMOUNT_E
		     , a2.RCIV_DE_E     	, a2.RCIV_AMOUNT_E  , a2.INSTLMT_INTR_E
		     , a2.PAYAMT_A     		, a2.PAY_TMLMT_A    , a2.ARRRG_AMOUNT_A     , a2.PREPAY_DSCNT_AMOUNT_A
		     , a2.RCIV_DE_A     	, a2.RCIV_AMOUNT_A  , a2.INSTLMT_INTR_A
		     , a2.PAYAMT_C     		, a2.PAY_TMLMT_C    , a2.ARRRG_AMOUNT_C     , a2.PREPAY_DSCNT_AMOUNT_C
		     , a2.RCIV_DE_C     	, a2.RCIV_AMOUNT_C  , a2.INSTLMT_INTR_C
		     , a2.UNCLAMT_9
		     , a2.LON_AT
		     , a2.REPRCHS_RGIST_DE  , a2.OWNSHIP_BEFORE_DE
		     , a2.OWNSHIP_BEFORE_AT
		     , a2.USE_CONFM_ISSU_DE	, a2.USE_CONFM_ISSU_PRPOS
		  FROM (SELECT a1.LAD_CODE			/* 토지코드 */
		             , a1.BLCK				/* 블록 */
		             , a1.LOT				/* 롯트 */
		             , a1.LOT_TY			/* 롯트구분 */
		             , a1.LOCPLC_ZIP		/* 소재지우편번호 */
		             , a1.LOCPLC_BASS_ADRES	/* 소재지기본주소 */
		             , a1.LOCPLC_DETAIL_ADRES	/* 소재지상세주소 */
		             , a1.LOCPLC_BASS_ADRES || a1.LOCPLC_DETAIL_ADRES AS LOCPLC_ADRES	/* 소재지주소 */
		             , a1.LOCPLC_ZIP_LNM	/* 소재지우편번호지번 */
		             , a1.LOCPLC_BASS_ADRES_LNM	/* 소재지기본주소지번 */
		             , a1.LOCPLC_DETAIL_ADRES_LNM	/* 소재지상세주소지번 */
		             , a1.LOCPLC_BASS_ADRES_LNM || a1.LOCPLC_DETAIL_ADRES_LNM AS LOCPLC_ADRES_LNM	/* 소재지주소지번 */
		             , a1.BGNN_UNTPC		/* 당초단가 */
		             , a1.BGNN_AMOUNT  		/* 당초금액[권리금액] */
		             , a1.DCSN_UNTPC 		/* 확정단가 defin_cost */
		             , a1.DCSN_AMOUNT		/* 확정금액 defin_amt */
		             , CASE WHEN NVL(a1.DCSN_UNTPC, 0) > 0 THEN (a1.DCSN_UNTPC - a1.BGNN_UNTPC)
		                    ELSE 0
		               END AS IRDS_UNTPC	/* 증감단가 */
		             , CASE WHEN NVL(a1.DCSN_AMOUNT, 0) > 0 THEN (a1.DCSN_AMOUNT - a1.BGNN_AMOUNT)
		                    ELSE 0
		               END AS IRDS_AMT		/* 증감금액 sen_amt */
		             , a1.BGNN_AR			/* 당초면적[권리면적] before_area */
		             , a1.DCSN_AR			/* 확정면적 defin_area */
		             , CASE WHEN NVL(a1.DCSN_AR, 0) > 0 THEN (a1.DCSN_AR - a1.BGNN_AR)
		                    ELSE 0
		               END AS IRDS_AR					/* 증감면적 IRDS_ */
		             , a1.LAD_SE						/* 토지구분(상태)(LAD0A3) */
		             , e1.CODE_NM AS LAD_SE_NM			/* 토지구분(상태)코드명 */
		             , a1.CNTRCT_STTUS					/* 계약상태(LAD0A4) */
		             , f1.CODE_NM AS CNTRCT_STTUS_NM	/* 계약상태코드명 */
		             , a1.REMNDR_LAD_SE					/* 잔여토지구분(LAD0A2) */
		             , g1.CODE_NM AS REMNDR_LAD_SE_NM	/* 잔여토지구분코드명 */
		             , a1.CNTNT_SE						/* 목차구분(LAD002) */
		             , h1.CODE_NM AS CNTNT_SE_NM		/* 목차구분코드명 */
		             , LPAD(a1.BLCK, 3,'0')||LPAD(a1.LOT, 3, '0')||LPAD(a1.LOT_TY, 2, '0') AS BLCK_SUM	/* 조회용 B.L.T 값 */
		             /*[BEGIN] 계약자정보 */
		             , b1.CNTRCTR_NO		/* 계약자번호 */
		             , b1.CNTRCT_DE			/* 계약일자 */
		             , b1.LAD_CSTMR_NO		/* 토지고객번호(SQ_TBSLS_LAD_CSTMR_1) */
		             , b1.CSTMR_NM				/* 계약자_성명 */
		             , b1.TELNO				/* 전화번호 */
		             , b1.MBTLNO			/* 휴대폰번호 */
		             , DECODE(SFCOM_DEC_ALL(b1.IHIDNUM), NULL, '', SFCOM_DEC_ALL(b1.IHIDNUM)) AS IHIDNUM	/* 주민등록번호 */
		             , b1.CNTRCTR_MTLTY		/* 계약자상호 */
		             , a1.PRPOS_SE					/* 용도구분 */
		             , c1.CODE_NM AS PRPOS_SE_NM	/* 용도구분코드명 */
		             , a1.SUPLY_CODE				/* 공급코드 */
		             , d1.CODE_NM AS SUPLY_CODE_NM	/* 공급코드명 */
		             , b1.ZIP						/* 계약자_우편번호 */
		             , b1.ADRES || b1.ADRES_DETAIL AS ADRES	/* 계약자_주소 */
		             , b1.ZIP_DM					/* 계약자_DM우편번호 */
		             , b1.BASS_ADRES_DM || b1.DETAIL_ADRES_DM AS ADRES_DM	/* 계약자_DM주소 */
		             /* [ END ] 계약자정보 */
		             /* [BEGIN] 금액 */
		             /* 계약금(S0), 임대보증금(R0) */
		             , NVL(b1.PAYAMT_0, 0) AS PAYAMT_0								/* 납부급액(납부금액 + 감액금액) */
		             , b1.PAY_TMLMT_0												/* 납부기한일 */
		             , NVL(b1.ARRRG_AMOUNT_0, 0) AS ARRRG_AMOUNT_0					/* 연체금액 */
		             , NVL(b1.PREPAY_DSCNT_AMOUNT_0, 0) AS PREPAY_DSCNT_AMOUNT_0	/* 선납할인금액 */
		             , b1.RCIV_DE_0													/* 수납일자 */
		             , NVL(b1.RCIV_AMOUNT_0, 0) AS RCIV_AMOUNT_0					/* 수납금액(계약) */
		             , NVL(b1.INSTLMT_INTR_0, 0) AS INSTLMT_INTR_0					/* 할부이자금액 */
		             /* 1차중도금(S1), 재.보증금(1차)(R1) */
		             , NVL(b1.PAYAMT_1, 0) AS PAYAMT_1
		             , b1.PAY_TMLMT_1
		             , NVL(b1.ARRRG_AMOUNT_1, 0) AS ARRRG_AMOUNT_1
		             , NVL(b1.PREPAY_DSCNT_AMOUNT_1, 0) AS PREPAY_DSCNT_AMOUNT_1
		             , b1.RCIV_DE_1
		             , NVL(b1.RCIV_AMOUNT_1, 0) AS RCIV_AMOUNT_1
		             , NVL(b1.INSTLMT_INTR_1, 0) AS INSTLMT_INTR_1
		             /* 2차중도금(S2), 재.보증금(2차)(R2) */
		             , NVL(b1.PAYAMT_2, 0) AS PAYAMT_2
		             , b1.PAY_TMLMT_2
		             , NVL(b1.ARRRG_AMOUNT_2, 0) AS ARRRG_AMOUNT_2
		             , NVL(b1.PREPAY_DSCNT_AMOUNT_2, 0) AS PREPAY_DSCNT_AMOUNT_2
		             , b1.RCIV_DE_2
		             , NVL(b1.RCIV_AMOUNT_2, 0) AS RCIV_AMOUNT_2
		             , NVL(b1.INSTLMT_INTR_2, 0) AS INSTLMT_INTR_2
		             /* 3차중도금(S3), 재.보증금(3차)(R3) */
		             , NVL(b1.PAYAMT_3, 0) AS PAYAMT_3
		             , b1.PAY_TMLMT_3
		             , NVL(b1.ARRRG_AMOUNT_3, 0) AS ARRRG_AMOUNT_3
		             , NVL(b1.PREPAY_DSCNT_AMOUNT_3, 0) AS PREPAY_DSCNT_AMOUNT_3
		             , b1.RCIV_DE_3
		             , NVL(b1.RCIV_AMOUNT_3, 0) AS RCIV_AMOUNT_3
		             , NVL(b1.INSTLMT_INTR_3, 0) AS INSTLMT_INTR_3
		             /* 4차중도금(S4), 재.보증금(4차)(R4) */
		             , NVL(b1.PAYAMT_4, 0) AS PAYAMT_4
		             , b1.PAY_TMLMT_4
		             , NVL(b1.ARRRG_AMOUNT_4, 0) AS ARRRG_AMOUNT_4
		             , NVL(b1.PREPAY_DSCNT_AMOUNT_4, 0) AS PREPAY_DSCNT_AMOUNT_4
		             , b1.RCIV_DE_4
		             , NVL(b1.RCIV_AMOUNT_4, 0) AS RCIV_AMOUNT_4
		             , NVL(b1.INSTLMT_INTR_4, 0) AS INSTLMT_INTR_4
		             /* 5차중도금(S5), 재.보증금(5차)(R5) */
		             , NVL(b1.PAYAMT_5, 0) AS PAYAMT_5
		             , b1.PAY_TMLMT_5
		             , NVL(b1.ARRRG_AMOUNT_5, 0) AS ARRRG_AMOUNT_5
		             , NVL(b1.PREPAY_DSCNT_AMOUNT_5, 0) AS PREPAY_DSCNT_AMOUNT_5
		             , b1.RCIV_DE_5
		             , NVL(b1.RCIV_AMOUNT_5, 0) AS RCIV_AMOUNT_5
		             , NVL(b1.INSTLMT_INTR_5, 0) AS INSTLMT_INTR_5
		             /* 잔금(S9), 잔금(임대)(R9) */
		             , NVL(b1.PAYAMT_9, 0) AS PAYAMT_9
		             , b1.PAY_TMLMT_9
		             , NVL(b1.ARRRG_AMOUNT_9, 0) AS ARRRG_AMOUNT_9
		             , NVL(b1.PREPAY_DSCNT_AMOUNT_9, 0) AS PREPAY_DSCNT_AMOUNT_9
		             , b1.RCIV_DE_9
		             , NVL(b1.RCIV_AMOUNT_9, 0) AS RCIV_AMOUNT_9
		             , NVL(b1.INSTLMT_INTR_9, 0) AS INSTLMT_INTR_9
		             /* 정산금(SE) */
		             , NVL(b1.PAYAMT_E, 0) AS PAYAMT_E
		             , b1.PAY_TMLMT_E
		             , NVL(b1.ARRRG_AMOUNT_E, 0) AS ARRRG_AMOUNT_E
		             , NVL(b1.PREPAY_DSCNT_AMOUNT_E, 0) AS PREPAY_DSCNT_AMOUNT_E
		             , b1.RCIV_DE_E
		             , NVL(b1.RCIV_AMOUNT_E, 0) AS RCIV_AMOUNT_E
		             , NVL(b1.INSTLMT_INTR_E, 0) AS INSTLMT_INTR_E
		             /* 할부(분양금)(SA) */
		             , NVL(b1.PAYAMT_A, 0) AS PAYAMT_A
		             , b1.PAY_TMLMT_A
		             , NVL(b1.ARRRG_AMOUNT_A, 0) AS ARRRG_AMOUNT_A
		             , NVL(b1.PREPAY_DSCNT_AMOUNT_A, 0) AS PREPAY_DSCNT_AMOUNT_A
		             , b1.RCIV_DE_A
		             , NVL(b1.RCIV_AMOUNT_A, 0) AS RCIV_AMOUNT_A
		             , NVL(b1.INSTLMT_INTR_A, 0) AS INSTLMT_INTR_A
		             /* 철거이행보증금(RR) */
		             , NVL(b1.PAYAMT_C, 0) AS PAYAMT_C
		             , b1.PAY_TMLMT_C
		             , NVL(b1.ARRRG_AMOUNT_C, 0) AS ARRRG_AMOUNT_C
		             , NVL(b1.PREPAY_DSCNT_AMOUNT_C, 0) AS PREPAY_DSCNT_AMOUNT_C
		             , b1.RCIV_DE_C
		             , NVL(b1.RCIV_AMOUNT_C, 0) AS RCIV_AMOUNT_C
		             , NVL(b1.INSTLMT_INTR_C, 0) AS INSTLMT_INTR_C
		             , NVL(b1.UNCLAMT, 0) AS UNCLAMT_9		/* 잔금미수금액 */
		             /* [ END ] 금액 */
		             , (SELECT DISTINCT '대출'
		                  FROM TBSLS_LCNTRCTR_LON z /* 토지계약자대출 : LNT_CT_LENDOUT 계약자 대출정보 */
		                 WHERE z.CNTRCTR_NO = b1.CNTRCTR_NO
		                   AND z.RELIS_DE IS NULL	/* 해제일자 */
		               ) AS LON_AT				/* 대출여부 */
		             /* 계약자기타정보 */
		             , b1.REPRCHS_RGIST_DE		/* 환매특약유무(환매특약일자) */
		             , b1.OWNSHIP_BEFORE_DE		/* 소유권이전일 */
		             , DECODE(b1.OWNSHIP_BEFORE_DE, NULL, 'N', 'Y') AS OWNSHIP_BEFORE_AT	/* 소유권이전여부 */
		             , b1.USE_CONFM_ISSU_DE		/* 승낙서발급일 */
		             , b1.USE_CONFM_ISSU_PRPOS	/* 사용승낙발급용도 */
		          FROM TBSLS_LAD_DETAIL_INFO a1	/* 토지상세정보 : LNT_LN_INFOMST 공급토지상세정보 */
		             , (SELECT a.*
		                     , b.PAYAMT_0
		                     , b.PAY_TMLMT_0
		                     , b.ARRRG_AMOUNT_0
		                     , b.PREPAY_DSCNT_AMOUNT_0
		                     , b.RCIV_DE_0
		                     , b.RCIV_AMOUNT_0
		                     , b.INSTLMT_INTR_0
		                     , b.PAYAMT_1
		                     , b.PAY_TMLMT_1
		                     , b.ARRRG_AMOUNT_1
		                     , b.PREPAY_DSCNT_AMOUNT_1
		                     , b.RCIV_DE_1
		                     , b.RCIV_AMOUNT_1
		                     , b.INSTLMT_INTR_1
		                     , b.PAYAMT_2
		                     , b.PAY_TMLMT_2
		                     , b.ARRRG_AMOUNT_2
		                     , b.PREPAY_DSCNT_AMOUNT_2
		                     , b.RCIV_DE_2
		                     , b.RCIV_AMOUNT_2
		                     , b.INSTLMT_INTR_2
		                     , b.PAYAMT_3
		                     , b.PAY_TMLMT_3
		                     , b.ARRRG_AMOUNT_3
		                     , b.PREPAY_DSCNT_AMOUNT_3
		                     , b.RCIV_DE_3
		                     , b.RCIV_AMOUNT_3
		                     , b.INSTLMT_INTR_3
		                     , b.PAYAMT_4
		                     , b.PAY_TMLMT_4
		                     , b.ARRRG_AMOUNT_4
		                     , b.PREPAY_DSCNT_AMOUNT_4
		                     , b.RCIV_DE_4
		                     , b.RCIV_AMOUNT_4
		                     , b.INSTLMT_INTR_4
		                     , b.PAYAMT_5
		                     , b.PAY_TMLMT_5
		                     , b.ARRRG_AMOUNT_5
		                     , b.PREPAY_DSCNT_AMOUNT_5
		                     , b.RCIV_DE_5
		                     , b.RCIV_AMOUNT_5
		                     , b.INSTLMT_INTR_5
		                     , b.PAYAMT_9
		                     , b.PAY_TMLMT_9
		                     , b.ARRRG_AMOUNT_9
		                     , b.PREPAY_DSCNT_AMOUNT_9
		                     , b.RCIV_DE_9
		                     , b.RCIV_AMOUNT_9
		                     , b.INSTLMT_INTR_9
		                     , b.PAYAMT_E
		                     , b.PAY_TMLMT_E
		                     , b.ARRRG_AMOUNT_E
		                     , b.PREPAY_DSCNT_AMOUNT_E
		                     , b.RCIV_DE_E
		                     , b.RCIV_AMOUNT_E
		                     , b.INSTLMT_INTR_E
		                     , b.PAYAMT_A
		                     , b.PAY_TMLMT_A
		                     , b.ARRRG_AMOUNT_A
		                     , b.PREPAY_DSCNT_AMOUNT_A
		                     , b.RCIV_DE_A
		                     , b.RCIV_AMOUNT_A
		                     , b.INSTLMT_INTR_A
		                     , b.PAYAMT_C
		                     , b.PAY_TMLMT_C
		                     , b.ARRRG_AMOUNT_C
		                     , b.PREPAY_DSCNT_AMOUNT_C
		                     , b.RCIV_DE_C
		                     , b.RCIV_AMOUNT_C
		                     , b.INSTLMT_INTR_C
		                     , c.OWNSHIP_BEFORE_DE			/* 소유권이전일자 */
		                     , c.OWNSHIP_RPRSNTV_NM			/* 소유권대표자명 */
		                     , c.OWNSHIP_LNDCGR				/* 소유권지목 */
		                     , c.REPRCHS_SPCCNTR_RELIS_DE	/* 환매특약해제일자 */
		                     , c.REPRCHS_RGHPSN				/* 환매권리자 */
		                     , c.REPRCHS_RGIST_DE			/* 환매등기일자 */
		                     , c.REPRCHS_RGIST_NO			/* 환매등기번호 */
		                     , c.REPRCHS_ADRES				/* 환매주소 */
		                     , c.REPRCHS_RPRSNTV_NM			/* 환매대표자명 */
		                     , c.USE_CONFM_ISSU_DE			/* 사용승낙발급일자 */
		                     , c.USE_CONFM_ISSU_PRPOS		/* 사용승낙발급용도 */
		                     , d.UNCLAMT					/* 미수금액 */
		                  FROM V_LCNTRCTR a		/* 토지계약자 정보 */
		                     , V_LCNTRCTR_PAY b	/* 토지계약자 납부/수납정보 */
		                     , TBSLS_LCNTRCTR_ETC_INFO c	/* 토지계약자기타정보 */
		                     , (SELECT j.CNTRCTR_NO
		                             , SUM(PAYAMT) AS UNCLAMT	/* 미수금액 */
		                          FROM TBSLS_LCNTRCTR_PAY j	/* 토지계약자 납부 lnt_ct_vote 계약자 납부정보(일반) */
		                         WHERE j.PAY_CODE = 'S9'
		                           AND NOT EXISTS (SELECT 1
		                                             FROM TBSLS_LAD_RCIV_PSTMRK k	/* 토지수납 lnt_ct_receipt : 계약자 수납정보_징수 */
		                                            WHERE k.CNTRCTR_NO = j.CNTRCTR_NO
		                                              AND k.PAY_NO = j.PAY_NO)
		                         GROUP BY j.CNTRCTR_NO
		                       ) d	/* 계약자 미수금 정보 */
		                 WHERE 1 = 1		                 
		                   AND a.CNTRCTR_NO = b.CNTRCTR_NO(+)
		                   AND a.CNTRCTR_NO = c.CNTRCTR_NO(+)
		                   AND a.CNTRCTR_NO = d.CNTRCTR_NO(+)
		               <isNotEmpty property="LAD_CODE">
		           		   AND a.LAD_CODE = #LAD_CODE#	  /* 토지코드 */
		       		   </isNotEmpty>
		               <isNotEmpty property="CNTRCT_DE_FM">
		           		   AND a.CNTRCT_DE >= #CNTRCT_DE_FM#	  /* 계약일자 */
		       		   </isNotEmpty>		       		   
		       		   <isNotEmpty property="CNTRCT_DE_TO">
		           		   AND a.CNTRCT_DE <![CDATA[<= ]]>#CNTRCT_DE_TO#	  /* 계약일자 */
		       		   </isNotEmpty>
		       		      AND a.cancl_de IS NULL		               
		               ) b1
		             , (SELECT CODE
		                     , CODE_NM
		                  FROM TBCOM_CMMN_CODE
		                 WHERE GRP_CODE = 'LAD003'	/* 토지용도구분 */
		               ) c1
		             , (SELECT CODE
		                     , CODE_NM
		                  FROM TBCOM_CMMN_CODE
		                 WHERE GRP_CODE = 'LAD004'	/* 공급구분 */
		               ) d1
		             , (SELECT CODE
		                     , CODE_NM
		                  FROM TBCOM_CMMN_CODE
		                 WHERE GRP_CODE = 'LAD0A3'	/* 토지구분(상태) */
		               ) e1
		             , (SELECT CODE
		                     , CODE_NM
		                  FROM TBCOM_CMMN_CODE
		                 WHERE GRP_CODE = 'LAD0A4'	/* 계약상태 */
		               ) f1
		             , (SELECT CODE
		                     , CODE_NM
		                  FROM TBCOM_CMMN_CODE
		                 WHERE GRP_CODE = 'LAD0A2'	/* 잔여토지구분 */
		               ) g1
		             , (SELECT CODE
		                     , CODE_NM
		                  FROM TBCOM_CMMN_CODE
		                 WHERE GRP_CODE = 'LAD002'	/* 목차구분 */
		               ) h1
		         WHERE 1 = 1
		           
		           <isNotEmpty property="CNTRCT_DE_FM" >
		                 AND a1.LAD_CODE = b1.LAD_CODE
					     AND a1.BLCK = b1.BLCK
					     AND a1.LOT = b1.LOT	           
					     AND a1.LOT_TY = b1.LOT_TY                         
		           </isNotEmpty>
		           
		           <isEmpty property="CNTRCT_DE_FM" >
		                 AND a1.LAD_CODE = b1.LAD_CODE(+)
					     AND a1.BLCK = b1.BLCK(+)
					     AND a1.LOT = b1.LOT(+)	           
					     AND a1.LOT_TY = b1.LOT_TY(+)                         
		           </isEmpty>		           
		           AND a1.PRPOS_SE = c1.CODE(+)
		           AND a1.SUPLY_CODE = d1.CODE(+)
		           AND a1.LAD_SE = e1.CODE(+)
		           AND a1.CNTRCT_STTUS = f1.CODE(+)
		           AND a1.REMNDR_LAD_SE = g1.CODE(+)
		           AND a1.CNTNT_SE = h1.CODE(+)		           
		         <isNotEmpty property="LAD_CODE">
		           AND a1.LAD_CODE = #LAD_CODE#		/* 토지코드 */
		       	 </isNotEmpty>
		       	 <isNotEmpty property="CNTRCT_STTUS">
		           AND NVL(a1.CNTRCT_STTUS, 'SL') = #CNTRCT_STTUS#	/* 계약상태(계약구분) */
		       	 </isNotEmpty>	   
		       		   
		         <isNotEmpty property="LAD_SE">
		           AND a1.LAD_SE = #LAD_SE#	/* 토지구분(계약상태) */
		         </isNotEmpty>
		         <isNotEmpty property="PRPOS_SE">
		           AND a1.PRPOS_SE = #PRPOS_SE#	/* 용도구분 */
		         </isNotEmpty>
		         <isNotEmpty property="SUPLY_CODE">
		           AND a1.SUPLY_CODE = #SUPLY_CODE#	/* 공급구분 */
		         </isNotEmpty>
		         <isNotEmpty property="REMNDR_LAD_SE">
		           AND a1.REMNDR_LAD_SE = #REMNDR_LAD_SE#	/* 토지구분 */
		         </isNotEmpty>  
			   ) a2
		 	 , TBSLS_LAD_INFO b2
		 WHERE 1 = 1
		   AND a2.LAD_CODE = b2.LAD_CODE
		 <isNotEmpty property="OWNSHIP_BEFORE_AT">
		   AND a2.OWNSHIP_BEFORE_AT = #OWNSHIP_BEFORE_AT#	/* 소유권이전여부 */
		 </isNotEmpty>
		 
	   <!--  2016.06.20 -->
   	   <isNotEmpty property="BLCK_FM">
   	  	   AND a2.BLCK = #BLCK_FM#
   	   </isNotEmpty>
   	   <isNotEmpty property="LOT_FM">
   	  	   AND a2.LOT = #LOT_FM#
   	   </isNotEmpty>
   	   <isNotEmpty property="LOT_TY_FM">
   	  	   AND a2.LOT_TY = #LOT_TY_FM#
   	   </isNotEmpty>
   	   
   	   <!--  
	   <isNotEmpty property="BLT_FM">
	     <isNotEmpty property="BLT_TO">
	       AND a2.BLCK_SUM BETWEEN #BLT_FM# AND #BLT_TO#	/* BLT 조회조건 */
	     </isNotEmpty>
	   </isNotEmpty>
	   -->
	   
		 ORDER BY a2.lad_code
		        ,LPAD(a2.BLCK, 3, '0')
		        , LPAD(a2.LOT, 3, '0')
		        , LPAD(a2.LOT_TY, 2, '0')
    </select>
    
    <!-- 쿼리명 : 토지별미분양조회
	설명 : 토지별 미분양 목록 조회
	수정일  		수정자  	수정내용
	2015.10.05	이상준		최초생성
	작성자 : 이상준
	최초작성일 : 2015.10.05
	-->
    <select id="SLS110104DAO.selectLadNotLttotList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
    	SELECT /* SLS110104DAO.selectLadNotLttotList 토지현황-토지별미분양 조회 */
			   a1.LAD_CODE						/* 토지코드 */
		     , b1.LAD_NM						/* 토지명 */
		     , a1.BLCK							/* 블록 */
		     , a1.LOT							/* 롯트 */
		     , a1.LOT_TY						/* 롯트구분 */
		     , a1.PRPOS_SE						/* 용도구분 */
		     , c1.CODE_NM AS PRPOS_SE_NM		/* 용도구분명 */
		     , a1.SUPLY_CODE					/* 공급코드 */
		     , d1.CODE_NM AS SUPLY_CODE_NM		/* 공급코드명 */
		     , a1.LAD_SE						/* 토지구분(계약구분) */
		     , e1.CODE_NM AS LAD_SE_NM			/* 토지구분명 */
		     , a1.CNTRCT_STTUS					/* 계약상태(계약타입) */
		     , f1.CODE_NM AS CNTRCT_STTUS_NM	/* 계약상태명 */
		     , a1.REMNDR_LAD_SE					/* 잔여토지구분(토지구분) */
		     , g1.CODE_NM AS REMNDR_LAD_SE_NM	/* 잔여토지구분명 */
		     , a1.LOCPLC_ZIP					/* 소재지우편번호 */
		     , a1.LOCPLC_BASS_ADRES				/* 소재지기본주소 */
		     , a1.LOCPLC_DETAIL_ADRES			/* 소재지상세주소 */
		     , a1.LOCPLC_ADRES					/* 소재지주소 */
		     , a1.LOCPLC_ZIP_LNM				/* 소재지우편번호지번 */
		     , a1.LOCPLC_BASS_ADRES_LNM			/* 소재지기본주소지번 */
		     , a1.LOCPLC_DETAIL_ADRES_LNM		/* 소재지상세주소지번 */
		     , a1.LOCPLC_ADRES_LNM				/* 소재지주소지번 */
		     , DECODE(a1.LOCPLC_ADRES_LNM, NULL, a1.LOCPLC_ADRES, a1.LOCPLC_ADRES_LNM) AS LAD_ADRES	/* 토지주소 */
		     , a1.DCSN_AR						/* 확정면적 */
		     , a1.DCSN_UNTPC					/* 확정단가 */
		     , a1.DCSN_AMOUNT					/* 확정금액 */
		     , a1.RM							/* 비고 */
		     , a1.BLCK_SUM						/* 조회용 B.L.T 값 */
		  FROM (SELECT a.LAD_CODE
		             , a.BLCK
		             , a.LOT
		             , a.LOT_TY
		             , a.PRPOS_SE
		             , a.SUPLY_CODE
		             , a.CNTRCT_STTUS
		             , a.LAD_SE
		             , a.REMNDR_LAD_SE
		             , a.LOCPLC_ZIP
		             , a.LOCPLC_BASS_ADRES
		             , a.LOCPLC_DETAIL_ADRES
		             , a.LOCPLC_BASS_ADRES || a.LOCPLC_DETAIL_ADRES AS LOCPLC_ADRES
		             , a.LOCPLC_ZIP_LNM
		             , a.LOCPLC_BASS_ADRES_LNM
		             , a.LOCPLC_DETAIL_ADRES_LNM
		             , a.LOCPLC_BASS_ADRES_LNM || a.LOCPLC_DETAIL_ADRES_LNM AS LOCPLC_ADRES_LNM
		             , DECODE(NVL(a.DCSN_AR, 0), 0, a.BGNN_AR, a.DCSN_AR) AS DCSN_AR
		             , DECODE(NVL(a.DCSN_UNTPC, 0), 0, a.BGNN_UNTPC, a.DCSN_UNTPC) AS DCSN_UNTPC
		             , DECODE(NVL(a.DCSN_AMOUNT, 0), 0, a.BGNN_AMOUNT, a.DCSN_AMOUNT) AS DCSN_AMOUNT
		             , a.RM
		             , LPAD(a.BLCK, 3,'0')||LPAD(a.LOT, 3, '0')||LPAD(a.LOT_TY, 2, '0') AS BLCK_SUM	/* 조회용 B.L.T 값 */
		          FROM TBSLS_LAD_DETAIL_INFO a	/* LNT_LN_INFOMST 공급토지상세정보 */
		         WHERE 1 = 1
		           AND NOT EXISTS (SELECT 1
		                             FROM TBSLS_LCNTRCTR x /* 토지계약자 : lnt_ct_info 계약자정보 */
		                            WHERE x.LAD_CODE = a.LAD_CODE
		                              AND x.BLCK = a.BLCK
		                              AND x.LOT = a.LOT
		                              AND x.LOT_TY = a.LOT_TY
		                              AND x.CANCL_DE IS NULL	/* 계약자_해약일자 */
		                          )
		         <![CDATA[
		           AND NVL(a.LAD_SE, '00') <> '99'					/* 토지구분(토지상태)(A3) : 계약불가 제외 */
		         ]]>
		         
		         
		         <isNotEmpty property="LAD_CODE">
		           AND a.LAD_CODE = #LAD_CODE#
		         </isNotEmpty>
		         <isNotEmpty property="CNTRCT_STTUS">
		           AND NVL(a.CNTRCT_STTUS, 'SL') = #CNTRCT_STTUS#	/* 계약상태(계약구분)(A4) */
		         </isNotEmpty>
        
		         <isNotEmpty property="PRPOS_SE">
		           AND a.PRPOS_SE = #PRPOS_SE#						/* 용도구분(03) */
		         </isNotEmpty>
		         <isNotEmpty property="SUPLY_CODE">
		           AND a.SUPLY_CODE = #SUPLY_CODE#					/* 공급구분(04) */
		         </isNotEmpty>
		         <isNotEmpty property="REMNDR_LAD_SE">
		           AND a.REMNDR_LAD_SE = #REMNDR_LAD_SE#			/* 잔여토지구분(A2) */
		         </isNotEmpty>
		  	   ) a1
		     , TBSLS_LAD_INFO b1	/* 토지정보 */
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD003'	/* 토지용도구분 */
		       ) c1
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD004'	/* 공급구분 */
		       ) d1
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD0A3'	/* 토지구분(상태) */
		       ) e1
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD0A4'	/* 계약상태 */
		       ) f1
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD0A2'	/* 잔여토지구분 */
		       ) g1
		 WHERE 1 = 1
		   AND a1.LAD_CODE = b1.LAD_CODE
		   AND a1.PRPOS_SE = c1.CODE(+)
		   AND a1.SUPLY_CODE = d1.CODE(+)
		   AND a1.LAD_SE = e1.CODE(+)
		   AND a1.CNTRCT_STTUS = f1.CODE(+)
		   AND a1.REMNDR_LAD_SE = g1.CODE(+)		   
	   <!--  2016.06.20 -->
   	   <isNotEmpty property="BLCK_FM">
   	  	   AND a1.BLCK = #BLCK_FM#
   	   </isNotEmpty>
   	   <isNotEmpty property="LOT_FM">
   	  	   AND a1.LOT = #LOT_FM#
   	   </isNotEmpty>
   	   <isNotEmpty property="LOT_TY_FM">
   	  	   AND a1.LOT_TY = #LOT_TY_FM#
   	   </isNotEmpty>
   	   
   	   <!-- 
	   <isNotEmpty property="BLT_FM">
	     <isNotEmpty property="BLT_TO">
	       AND a1.BLCK_SUM BETWEEN #BLT_FM# AND #BLT_TO#
	     </isNotEmpty>
	   </isNotEmpty>
	    -->
	    
		 ORDER BY LPAD(a1.BLCK, 3, '0')
		        , LPAD(a1.LOT, 3, '0')
		        , LPAD(a1.LOT_TY, 2, '0')
    </select>
    
    <!-- 쿼리명 : 토지별공유자조회
	설명 : 토지별 공유자 목록 조회
	수정일  		수정자  	수정내용
	2015.10.05	이상준		최초생성
	작성자 : 이상준
	최초작성일 : 2015.10.05
	-->
    <select id="SLS110104DAO.selectLadCocnrList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
    	WITH V_LCNTRCTR AS		/* 토지 계약자 */
		(
			<include refid="COM000000.v_sls_lcntrctr_info"/>
		)
		, V_LCNTRCTR_COCNR AS	/* 토지 계약자 공유자 */
		(
			<include refid="COM000000.v_sls_lcntrctr_cocnr_info"/>
		)
		SELECT /* SLS110104DAO.selectLadCocnrList 토지별 공유자목록 조회 */
			   a1.LAD_CODE					/* 토지코드 */
			 , b1.LAD_NM					/* 토지명 */
		     , a1.BLCK						/* 블럭 */
		     , a1.LOT						/* 롯트 */
		     , a1.LOT_TY					/* 롯트구분 */
		     , a1.LOCPLC_ZIP				/* 소재지우편번호 */
		     , a1.LOCPLC_BASS_ADRES			/* 소재지기본주소 */
		     , a1.LOCPLC_DETAIL_ADRES		/* 소재지상세주소 */
		     , a1.LOCPLC_ADRES				/* 소재지주소 */
		     , a1.LOCPLC_ZIP_LNM			/* 소재지우편번호지번 */
		     , a1.LOCPLC_BASS_ADRES_LNM		/* 소재지기본주소지번 */
		     , a1.LOCPLC_DETAIL_ADRES_LNM	/* 소재지상세주소지번 */
		     , a1.LOCPLC_ADRES_LNM			/* 소재지주소지번 */
		     , NVL(a1.LOCPLC_ADRES_LNM, a1.LOCPLC_ADRES) AS LAD_ADRES	/* 토지주소 */
		     , a1.BGNN_AR					/* 당초면적 */
		     , a1.BGNN_UNTPC				/* 당초단가 */
		     , a1.BGNN_AMOUNT				/* 당초금액 */
		     , a1.DCSN_AR					/* 확정면적 */
		     , a1.DCSN_UNTPC				/* 확정단가 */
		     , a1.DCSN_AMOUNT				/* 확정금액 */
		     , a1.IRDS_AR					/* 증감면적 */
		     , a1.IRDS_UNTPC				/* 증감단가 */
		     , a1.IRDS_AMT					/* 증감금액 */
		     , a1.CSTMR_NM						/* 성명 */
		    <isEqual property="IHIDNUM_STTUS_AT" compareValue = "N">							
		         ,DECODE(a1.IHIDNUM, NULL, '', SUBSTR(a1.IHIDNUM,0,6)||'*******') AS IHIDNUM                  /* 주민번호 */			         
		    </isEqual>	
	        <isEqual property="IHIDNUM_STTUS_AT" compareValue = "Y">							
		         ,DECODE(a1.IHIDNUM, NULL, '', a1.IHIDNUM) AS IHIDNUM      /* 주민번호 */					
	        </isEqual>
		     , a1.ZIP						/* 우편번호 */
		     , a1.ADRES						/* 주소 */
		     , a1.ADRES_DETAIL				/* 주소_상세 */
		     , a1.ADRES_ALL					/* 주소 */
		     , a1.TELNO						/* 전화번호 */
		     , a1.MBTLNO					/* 휴대폰번호 */
		     , a1.CNTRCT_DE					/* 계약일자 */
		     , a1.RCIV_DE					/* 수납일자 */
		     , a1.PRPOS_SE					/* 용도구분 */
		     , c1.CODE_NM AS PRPOS_SE_NM	/* 용도구분명 */
		     , a1.SUPLY_CODE				/* 공급구분 */
		     , d1.CODE_NM AS SUPLY_CODE_NM	/* 공급구분명 */
		     , a1.LAD_SE					/* 토지구분 */
		     , e1.CODE_NM AS LAD_SE_NM		/* 토지구분명 */
		     , a1.CNTRCT_STTUS				/* 계약상태 */
		     , f1.CODE_NM AS CNTRCT_STTUS_NM	/* 계약상태명 */
		     , a1.REMNDR_LAD_SE				/* 잔여토지구분 */
		     , g1.CODE_NM AS REMNDR_LAD_SE_NM	/* 잔여토지구분명 */
		  FROM (SELECT /* 계약자 목록 */
		     		   '0' AS CSTMR_TY
		             , a.CNTRCTR_NO					/* 계약자번호 */
		             , a.LAD_CODE					/* 토지코드 */
		             , a.BLCK						/* 블록 */
		             , a.LOT						/* 롯트 */
		             , a.LOT_TY						/* 롯트타입 */
		             , LPAD(a.BLCK, 3,'0')||LPAD(a.LOT, 3, '0')||LPAD(a.LOT_TY, 2, '0') AS BLCK_SUM	/* 조회용 B.L.T 값 */
		             /* 소재지 */
		             , b.LOCPLC_ZIP					/* 소재지우편번호 */
		             , b.LOCPLC_BASS_ADRES			/* 소재지기본주소 */
		             , b.LOCPLC_DETAIL_ADRES		/* 소재지상세주소 */
		             , b.LOCPLC_BASS_ADRES || b.LOCPLC_DETAIL_ADRES AS LOCPLC_ADRES	/* 소재지주소 */
		             , b.LOCPLC_ZIP_LNM				/* 소재지우편번호지번 */
		             , b.LOCPLC_BASS_ADRES_LNM		/* 소재지기본주소지번 */
		             , b.LOCPLC_DETAIL_ADRES_LNM	/* 소재지상세주소지번 */
		             , b.LOCPLC_BASS_ADRES_LNM || b.LOCPLC_DETAIL_ADRES_LNM AS LOCPLC_ADRES_LNM	/* 소재지주소지번 */
		             /* 금액 */
		             , b.BGNN_AR				/* 당초면적 */
		             , b.BGNN_UNTPC				/* 당초단가 */
		             , b.BGNN_AMOUNT			/* 당초금액 */
		             , b.DCSN_AR				/* 확정면적 */
		             , b.DCSN_UNTPC				/* 확정단가 */
		             , b.DCSN_AMOUNT			/* 확정금액 */
		             , CASE WHEN NVL(b.DCSN_AR, 0) > 0 THEN (b.DCSN_AR - b.BGNN_AR) ELSE 0 END AS IRDS_AR				/* 증감면적 */
		             , CASE WHEN NVL(b.DCSN_UNTPC, 0) > 0 THEN (b.DCSN_UNTPC - b.BGNN_UNTPC) ELSE 0 END AS IRDS_UNTPC	/* 증감단가 */
		             , CASE WHEN NVL(b.DCSN_AMOUNT, 0) > 0 THEN (b.DCSN_AMOUNT - b.BGNN_AMOUNT) ELSE 0 END AS IRDS_AMT	/* 증감금액 */
		             /* 조건코드 */
		             , b.PRPOS_SE				/* 용도구분 */
		             , b.SUPLY_CODE				/* 공급구분 */
		             , b.LAD_SE					/* 토지구분 */
		             , b.CNTRCT_STTUS			/* 계약상태 */
		             , b.REMNDR_LAD_SE			/* 잔여토지구분 */
		             /* 계약자정보 */
		             , a.CSTMR_NM						/* 성명 */
		             , DECODE(SFCOM_DEC_ALL(a.IHIDNUM), NULL, '', SFCOM_DEC_ALL(a.IHIDNUM)) AS IHIDNUM	/* 주민등록번호 */
		             , a.ZIP					/* 우편번호 */
		             , a.ADRES					/* 주소 */
		             , a.ADRES_DETAIL			/* 주소_상세 */
		             , a.ADRES || a.ADRES_DETAIL AS ADRES_ALL
		             , a.TELNO					/* 전화번호 */
		             , a.MBTLNO					/* 휴대전화번호 */
		             , a.CNTRCT_DE				/* 계약일자 */
		             , (SELECT MIN(z.RCIV_DE) 	/* 수납일자 */
		                  FROM TBSLS_LAD_RCIV_PSTMRK z		/* 토지수납 : LNT_CT_RECEIPT 계약자 수납정보_징수 */
		                 WHERE z.CNTRCTR_NO = a.CNTRCTR_NO
		               ) AS RCIV_DE				/* 수납일자 */
		          FROM V_LCNTRCTR a
		             , TBSLS_LAD_DETAIL_INFO b	/* LNT_LN_INFOMST 공급토지상세정보 */
		         WHERE 1 = 1
		           AND a.CANCL_DE IS NULL       /* 계약자_해약일자 */
		           AND EXISTS (SELECT 1
		                         FROM TBSLS_LCNTRCTR_COCNR x	/* 토지계약자공유자 : LNT_CT_COWONER 계약자 공유자정보 */
		                        WHERE x.CNTRCTR_NO = a.CNTRCTR_NO
		                      )
		           AND a.LAD_CODE = b.LAD_CODE
		           AND a.BLCK = b.BLCK
		           AND a.LOT = b.LOT
		           AND a.LOT_TY	= b.LOT_TY
		         <isNotEmpty property="LAD_CODE">
		           AND a.LAD_CODE = #LAD_CODE#	/* 토지코드 */
		         </isNotEmpty>
		         <isNotEmpty property="CNTRCT_STTUS">
		           AND NVL(b.CNTRCT_STTUS, 'SL') = #CNTRCT_STTUS#   /* 계약상태 */
		         </isNotEmpty>
		         <isNotEmpty property="LAD_SE">
		           AND b.LAD_SE = #LAD_SE#   					/* 토지구분(상태) */
		         </isNotEmpty>
		         <isNotEmpty property="PRPOS_SE">
		           AND b.PRPOS_SE = #PRPOS_SE#   				/* 용도구분 */
		         </isNotEmpty>
		         <isNotEmpty property="SUPLY_CODE">
		           AND b.SUPLY_CODE = #SUPLY_CODE#   			/* 계약자_공급구분 */
		         </isNotEmpty>
		         <isNotEmpty property="REMNDR_LAD_SE">
		           AND b.REMNDR_LAD_SE = #REMNDR_LAD_SE#		/* 잔여토지구분(A2) */		           
		         </isNotEmpty>
		         <isNotEmpty property="CNTRCT_DE_FM">
		           		   AND a.CNTRCT_DE >= #CNTRCT_DE_FM#	  /* 계약일자 */
		       	 </isNotEmpty>		       		   
		       	<isNotEmpty property="CNTRCT_DE_TO">
		        		   AND a.CNTRCT_DE <![CDATA[<= ]]>#CNTRCT_DE_TO#	  /* 계약일자 */
		       	</isNotEmpty>
				UNION ALL
				SELECT /* 공유자 목록 */
		               '1' AS CSTMR_TY
		             , a.CNTRCTR_NO
		             , b.LAD_CODE				/* 토지코드 */
		             , b.BLCK					/* 블록 */
		             , b.LOT					/* 롯트 */
		             , b.LOT_TY					/* 롯트타입 */
		             , LPAD(b.BLCK, 3,'0')||LPAD(b.LOT, 3, '0')||LPAD(b.LOT_TY, 2, '0') AS BLCK_SUM	/* 조회용 B.L.T 값 */
		             /* 소재지 */
		             , NULL, NULL, NULL, NULL
		             , NULL, NULL, NULL, NULL
		             /* 금액 */
		             , NULL, NULL, NULL
		             , NULL, NULL, NULL
		             , NULL, NULL, NULL
		             /* 조건정보 */
		             , NULL PRPOS_SE				/* 용도구분 */
		             , NULL SUPLY_CODE				/* 공급구분 */
		             , NULL LAD_SE					/* 토지구분 */
		             , NULL CNTRCT_STTUS			/* 계약상태 */
		             , NULL REMNDR_LAD_SE			/* 잔여토지구분 */
		             /* 계약자_공유자정보 */
		             , a.CSTMR_NM						/* 성명 */
		             , DECODE(SFCOM_DEC_ALL(a.IHIDNUM), NULL, '', SFCOM_DEC_ALL(a.IHIDNUM)) AS IHIDNUM	/* 주민등록번호 */
		             , a.ZIP					/* 우편번호 */
		             , a.ADRES					/* 주소 */
		             , a.ADRES_DETAIL			/* 주소_상세 */
		             , a.ADRES || a.ADRES_DETAIL AS ADRES_ALL
		             , a.TELNO					/* 전화번호 */
		             , a.MBTLNO					/* 휴대전화번호 */
		             , NULL						/* 계약일자 */
		             , NULL						/* 수납일자 */
		          FROM V_LCNTRCTR_COCNR a		/* 토지공유자 */
		             , TBSLS_LCNTRCTR b			/* 토지계약자 */
		             , TBSLS_LAD_DETAIL_INFO c	/* LNT_LN_INFOMST 공급토지상세정보 */
		         WHERE 1 = 1
		         <![CDATA[
		           AND a.LAD_CSTMR_NO_COCNR <> (SELECT x.LAD_CSTMR_NO
		                                          FROM TBSLS_LCNTRCTR x		/* 계약자정보 */
		                                         WHERE x.CNTRCTR_NO = b.CNTRCTR_NO)
		         ]]>
		           AND a.CNTRCTR_NO = b.CNTRCTR_NO
		           AND b.CANCL_DE IS NULL       /* 계약자_해약일자 */
		           AND c.LAD_CODE = b.LAD_CODE
		           AND c.BLCK = b.BLCK
		           AND c.LOT = b.LOT
		           AND c.LOT_TY = b.LOT_TY
		           
		         <isNotEmpty property="LAD_CODE">
		           AND b.LAD_CODE = #LAD_CODE#
		         </isNotEmpty>
		         <isNotEmpty property="CNTRCT_STTUS">
		           AND NVL(c.CNTRCT_STTUS, 'SL') = #CNTRCT_STTUS#   /* 계약상태 */
		         </isNotEmpty>
		         <isNotEmpty property="LAD_SE">
		           AND c.LAD_SE = #LAD_SE#   					/* 토지구분(상태) */
		         </isNotEmpty>
		         <isNotEmpty property="PRPOS_SE">
		           AND c.PRPOS_SE = #PRPOS_SE#   				/* 용도구분 */
		         </isNotEmpty>
		         <isNotEmpty property="SUPLY_CODE">
		           AND c.SUPLY_CODE = #SUPLY_CODE#   			/* 계약자_공급구분 */
		         </isNotEmpty>
		         <isNotEmpty property="REMNDR_LAD_SE">
		           AND c.REMNDR_LAD_SE = #REMNDR_LAD_SE#		/* 잔여토지구분(A2) */
		         </isNotEmpty>
		         <isNotEmpty property="CNTRCT_DE_FM">
		           		   AND b.CNTRCT_DE >= #CNTRCT_DE_FM#	  /* 계약일자 */
		       	 </isNotEmpty>		       		   
		       	<isNotEmpty property="CNTRCT_DE_TO">
		        		   AND b.CNTRCT_DE <![CDATA[<= ]]>#CNTRCT_DE_TO#	  /* 계약일자 */
		       	</isNotEmpty>
		       ) a1
		     , TBSLS_LAD_INFO b1	/* 토지정보 */
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD003'	/* 토지용도구분 */
		       ) c1
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD004'	/* 공급구분 */
		       ) d1
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD0A3'	/* 토지구분(상태) */
		       ) e1
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD0A4'	/* 계약상태 */
		       ) f1
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD0A2'	/* 잔여토지구분 */
		       ) g1
		 WHERE 1 = 1
		   AND a1.LAD_CODE = b1.LAD_CODE
		   AND a1.PRPOS_SE = c1.CODE(+)
		   AND a1.SUPLY_CODE = d1.CODE(+)
		   AND a1.LAD_SE = e1.CODE(+)
		   AND a1.CNTRCT_STTUS = f1.CODE(+)
		   AND a1.REMNDR_LAD_SE = g1.CODE(+)
		   
	  <!--  2016.06.20 -->
   	   <isNotEmpty property="BLCK_FM">
   	  	   AND a1.BLCK = #BLCK_FM#
   	   </isNotEmpty>
   	   <isNotEmpty property="LOT_FM">
   	  	   AND a1.LOT = #LOT_FM#
   	   </isNotEmpty>
   	   <isNotEmpty property="LOT_TY_FM">
   	  	   AND a1.LOT_TY = #LOT_TY_FM#
   	   </isNotEmpty>
   	   
   	   <!--    
	   <isNotEmpty property="BLT_FM">
		 <isNotEmpty property="BLT_TO">
		   AND a1.BLCK_SUM BETWEEN #BLT_FM# AND #BLT_TO#
		 </isNotEmpty>
	   </isNotEmpty>
	   -->
		 ORDER BY LPAD(a1.BLCK, 3, '0')
		        , LPAD(a1.LOT, 3, '0')
		        , LPAD(a1.LOT_TY, 2, '0')
		        , a1.CSTMR_TY
    </select>
    
    <!-- 쿼리명 : 공유자변경내역조회
	설명 : 토지별 공유자 변경내역 목록 조회
	수정일  		수정자  	수정내용
	2015.10.06	이상준		최초생성
	작성자 : 이상준
	최초작성일 : 2015.10.06
	-->
    <select id="SLS110104DAO.selectLadCocnrChangeDtlsList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
    	WITH V_LCNTRCTR AS		/* 토지 계약자 */
		(
			<include refid="COM000000.v_sls_lcntrctr_info"/>
		)
		, V_LCNTRCTR_COCNR AS	/* 토지 계약자 공유자 */
		(
			<include refid="COM000000.v_sls_lcntrctr_cocnr_info"/>
		)
		SELECT /* SLS110104DAO.selectLadCocnrChangeDtlsList 공유자변경내역 조회 */
		       a1.LAD_CODE						/* 토지코드 */
			 , b1.LAD_NM						/* 토지명 */
		     , a1.BLCK							/* 블럭 */
		     , a1.LOT							/* 롯트 */
		     , a1.LOT_TY						/* 롯트구분 */
		     , a1.BLCK_SUM						/* 조회용 B.L.T 값 */
		     , a1.DCSN_AR						/* 분양면적 */
		     , a1.DCSN_UNTPC					/* 분양단가 */
		     , a1.DCSN_AMOUNT					/* 분양금액 */
		     , a1.CNTRCT_DE						/* 계약일자 */
		     , a1.PRPOS_SE						/* 토지용도구분 */
		     , c1.CODE_NM AS PRPOS_SE_NM		/* 토지용도구분명 */
		     , a1.SUPLY_CODE					/* 공급구분 */
		     , d1.CODE_NM AS SUPLY_CODE_NM		/* 공급구분명 */
		     , a1.LAD_SE						/* 토지구분(상태) */
		     , e1.CODE_NM AS LAD_SE_NM			/* 토지구분(상태)명 */
		     , a1.CNTRCT_STTUS					/* 계약상태 */
		     , f1.CODE_NM AS CNTRCT_STTUS_NM	/* 계약상태명 */
		     , a1.REMNDR_LAD_SE					/* 잔여토지구분 */
		     , g1.CODE_NM AS REMNDR_LAD_SE_NM	/* 잔여토지구분명 */
		     /* 당초분양자(매도인) */
		     , a1.COCNR_CNNC_SN					/* 공유자연결일련번호 */
		     , a1.LAD_CSTMR_NO_SLER				/* 토지고객번호_매도자 */
		     , a1.SLER_NM						/* 매도자_성명 */
		     <isEqual property="IHIDNUM_STTUS_AT" compareValue = "N">							
		         ,DECODE(a1.SLER_IHIDNUM, NULL, '', SUBSTR(a1.SLER_IHIDNUM,0,6)||'*******') AS SLER_IHIDNUM                  /* 주민번호 */			         
		      </isEqual>	
	          <isEqual property="IHIDNUM_STTUS_AT" compareValue = "Y">							
		         ,DECODE(a1.SLER_IHIDNUM, NULL, '', a1.SLER_IHIDNUM) AS SLER_IHIDNUM      /* 주민번호 */					
	          </isEqual>
	         , a1.SLER_ZIP						/* 매도자_우편번호 */
		     , a1.SLER_ADRES					/* 매도자_주소 */
		     , a1.SLER_ADRES_DETAIL				/* 매도자_상세주소 */
		     , a1.SLER_ADRES_ALL				/* 매도자_전체주소 */
		     , a1.SLER_TELNO					/* 매도자_전화번호 */
		     , a1.SLER_MBTLNO					/* 매도자_휴대폰번호 */
		     /* 명의변경자(공유자) */
		     , a1.COCNR_SN						/* 공유자일련번호 */
		     , a1.LAD_CSTMR_NO_COCNR			/* 토지고객번호(SQ_TBSLS_LAD_CSTMR_1) */
		     , a1.COCNR_NM						/* 공유자_성명 */
		     <isEqual property="IHIDNUM_STTUS_AT" compareValue = "N">							
		         ,DECODE(a1.COCNR_IHIDNUM, NULL, '', SUBSTR(a1.COCNR_IHIDNUM,0,6)||'*******') AS COCNR_IHIDNUM                  /* 주민번호 */			         
		      </isEqual>	
	          <isEqual property="IHIDNUM_STTUS_AT" compareValue = "Y">							
		         ,DECODE(a1.COCNR_IHIDNUM, NULL, '', a1.COCNR_IHIDNUM) AS COCNR_IHIDNUM      /* 주민번호 */					
	          </isEqual>
	         , a1.COCNR_ZIP						/* 공유자_우편번호 */
		     , a1.COCNR_ADRES					/* 공유자_주소 */
		     , a1.COCNR_ADRES_DETAIL			/* 공유자_상세주소 */
		     , a1.COCNR_ADRES_ALL				/* 공유자_전체주소 */
		     , a1.COCNR_TELNO					/* 공유자_전화 */
		     , a1.COCNR_MBTLNO					/* 공유자_휴대폰번호 */
		     /* 변경정보 */
		     , a1.CHANGE_DE						/* 변경일자 */
		     , a1.CHGHY							/* 변경사유 */
		  FROM (SELECT b.LAD_CODE
		             , b.BLCK
		             , b.LOT
		             , b.LOT_TY
		             , LPAD(b.BLCK, 3,'0')||LPAD(b.LOT, 3, '0')||LPAD(b.LOT_TY, 2, '0') AS BLCK_SUM	/* 조회용 B.L.T 값 */
		             , DECODE(NVL(c.DCSN_AR, 0), 0, c.BGNN_AR, c.DCSN_AR) AS DCSN_AR
		             , DECODE(NVL(c.DCSN_UNTPC, 0), 0, c.BGNN_UNTPC, c.DCSN_UNTPC) AS DCSN_UNTPC
		             , DECODE(NVL(c.DCSN_AMOUNT, 0), 0, c.BGNN_AMOUNT, c.DCSN_AMOUNT) AS DCSN_AMOUNT
		             , b.CNTRCT_DE
		             , c.PRPOS_SE
		             , c.SUPLY_CODE				/* b.SUPLY_SE */
		             , c.CNTRCT_STTUS
		             , c.LAD_SE
		             , c.REMNDR_LAD_SE
		             /* 당초분양자(매도인) */
		             , a.COCNR_CNNC_SN			/* 공유자연결일련번호 */
		             , a.LAD_CSTMR_NO_SLER
		             , d.CSTMR_NM AS SLER_NM
		             , DECODE(SFCOM_DEC_ALL(d.IHIDNUM), NULL, '', SFCOM_DEC_ALL(d.IHIDNUM)) AS SLER_IHIDNUM
		             , d.ZIP AS SLER_ZIP
		             , d.ADRES AS SLER_ADRES
		             , d.ADRES_DETAIL AS SLER_ADRES_DETAIL
		             , d.ADRES || d.ADRES_DETAIL AS SLER_ADRES_ALL
		             , d.TELNO AS SLER_TELNO
		             , d.MBTLNO AS SLER_MBTLNO
		             /* 명의변경자(공유자) */
		             , a.COCNR_SN				/* 공유자일련번호 */
		             , a.LAD_CSTMR_NO_COCNR
		             , a.CSTMR_NM AS COCNR_NM
		             , DECODE(SFCOM_DEC_ALL(a.IHIDNUM), NULL, '', SFCOM_DEC_ALL(a.IHIDNUM)) AS COCNR_IHIDNUM
		             , a.ZIP AS COCNR_ZIP
		             , a.ADRES AS COCNR_ADRES
		             , a.ADRES_DETAIL AS COCNR_ADRES_DETAIL
		             , a.ADRES || a.ADRES_DETAIL AS COCNR_ADRES_ALL
		             , a.TELNO AS COCNR_TELNO
		             , a.MBTLNO AS COCNR_MBTLNO
		             , a.CHANGE_DE				/* 변경일자 */
		             , a.CHGHY					/* 변경사유 */
		             /* 계약자 */
		             , b.CSTMR_NM AS BGNN_NM
		             , DECODE(SFCOM_DEC_ALL(a.IHIDNUM), NULL, '', SFCOM_DEC_ALL(b.IHIDNUM)) AS BGNN_IHIDNUM
		             , b.ZIP AS BGNN_ZIP
		             , b.ADRES AS BGNN_ADRES
		             , b.ADRES_DETAIL AS BGNN_ADRES_DETAIL
		             , b.ADRES || a.ADRES_DETAIL AS BGNN_ADRES_ALL
		             , b.TELNO AS BGNN_TELNO
		             , b.MBTLNO AS BGNN_MBTLNO
		          FROM V_LCNTRCTR_COCNR a		/* 토지계약자공유자정보 : lnt_ct_cowoner 계약자 공유자정보 */
		             , V_LCNTRCTR b				/* 토지계약자정보 : lnt_ct_info 계약자정보 */
		             , TBSLS_LAD_DETAIL_INFO c	/* 토지상세정보 : LNT_LN_INFOMST 공급토지상세정보 */
		             , TBSLS_LAD_CSTMR d		/* 토지고객 */
		         WHERE 1 = 1
		           AND a.CNTRCTR_NO = b.CNTRCTR_NO
		           AND b.LAD_CODE = c.LAD_CODE
		           AND b.BLCK = c.BLCK
		           AND b.LOT = c.LOT
		           AND b.LOT_TY = c.LOT_TY
		           AND a.LAD_CSTMR_NO_SLER = d.LAD_CSTMR_NO
		           /* 조회조건 */
		           
		         <isNotEmpty property="LAD_CODE">
		           AND b.LAD_CODE = #LAD_CODE#
		         </isNotEmpty>
		         AND a.CHANGE_DE BETWEEN #CHANGE_DE_FM# AND #CHANGE_DE_TO#
		         <isNotEmpty property="CNTRCT_STTUS">
		           AND NVL(c.CNTRCT_STTUS, 'SL') = #CNTRCT_STTUS#   	/* 계약상태 */
		         </isNotEmpty>
		         <isNotEmpty property="LAD_SE">
		           AND c.LAD_SE = #LAD_SE#   						/* 토지구분(상태) */
		         </isNotEmpty>
		         <isNotEmpty property="PRPOS_SE">
		           AND c.PRPOS_SE = #PRPOS_SE#   					/* 용도구분 */
		         </isNotEmpty>
		         <isNotEmpty property="SUPLY_CODE">
		           AND c.SUPLY_CODE = #SUPLY_CODE#   				/* 계약자_공급구분 */
		         </isNotEmpty>
		         <isNotEmpty property="REMNDR_LAD_SE">
		           AND c.REMNDR_LAD_SE = #REMNDR_LAD_SE#			/* 잔여토지구분(A2) */
		         </isNotEmpty>
		         <isNotEmpty property="CNTRCT_DE_FM">
		           		   AND b.CNTRCT_DE >= #CNTRCT_DE_FM#	  /* 계약일자 */
		       	 </isNotEmpty>		       		   
		       	<isNotEmpty property="CNTRCT_DE_TO">
		        		   AND b.CNTRCT_DE <![CDATA[<= ]]>#CNTRCT_DE_TO#	  /* 계약일자 */
		       	</isNotEmpty>
		       ) a1
		     , TBSLS_LAD_INFO b1
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD003'	/* 토지용도구분 */
		       ) c1
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD004'	/* 공급구분 */
		       ) d1
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD0A3'	/* 토지구분(상태) */
		       ) e1
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD0A4'	/* 계약상태 */
		       ) f1
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD0A2'	/* 잔여토지구분 */
		       ) g1
		 WHERE 1 = 1
		   AND a1.LAD_CODE = b1.LAD_CODE
		   AND a1.PRPOS_SE = c1.CODE(+)
		   AND a1.SUPLY_CODE = d1.CODE(+)
		   AND a1.LAD_SE = e1.CODE(+)
		   AND a1.CNTRCT_STTUS = f1.CODE(+)
		   AND a1.REMNDR_LAD_SE = g1.CODE(+)
	   
	   <!--  2016.06.20 -->
   	   <isNotEmpty property="BLCK_FM">
   	  	   AND a1.BLCK = #BLCK_FM#
   	   </isNotEmpty>
   	   <isNotEmpty property="LOT_FM">
   	  	   AND a1.LOT = #LOT_FM#
   	   </isNotEmpty>
   	   <isNotEmpty property="LOT_TY_FM">
   	  	   AND a1.LOT_TY = #LOT_TY_FM#
   	   </isNotEmpty>
   	   
   	   <!--
	   <isNotEmpty property="BLT_FM">
		 <isNotEmpty property="BLT_TO">
		   AND a1.BLCK_SUM BETWEEN #BLT_FM# AND #BLT_TO#
		 </isNotEmpty>
	   </isNotEmpty>
	   -->
		 ORDER BY a1.LAD_CODE
		        , LPAD(a1.BLCK, 3, '0')
		        , LPAD(a1.LOT, 3, '0')
		        , LPAD(a1.LOT_TY, 2, '0')
		        , a1.COCNR_CNNC_SN
    </select>
    
    <!-- 쿼리명 : 토지별명의변경조회
	설명 : 토지별 명의변경 목록 조회
	수정일  		수정자  	수정내용
	2015.10.06	이상준		최초생성
	작성자 : 이상준
	최초작성일 : 2015.10.06
	-->
    <select id="SLS110104DAO.selectLadNmChangeList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
    	SELECT /* SLS110104DAO.selectLadNmChangeList 토지별명의변경 조회 */
		       a2.LAD_CODE						/* 토지코드 */
		     , b2.LAD_NM						/* 토지명 */
		     , a2.BLCK							/* 블럭 */
		     , a2.LOT							/* 롯트 */
		     , a2.LOT_TY						/* 롯트구분 */
		     , a2.BLCK_SUM						/* 조회용 B.L.T */
		     , a2.LOCPLC_ZIP					/* 소재지우편번호 */
		     , a2.LOCPLC_BASS_ADRES				/* 소재지기본주소 */
		     , a2.LOCPLC_DETAIL_ADRES			/* 소재지상세주소 */
		     , a2.LOCPLC_ADRES					/* 소재지주소 */
		     , a2.LOCPLC_ZIP_LNM				/* 소재지우편번호지번 */
		     , a2.LOCPLC_BASS_ADRES_LNM			/* 소재지기본주소지번 */
		     , a2.LOCPLC_DETAIL_ADRES_LNM		/* 소재지상세주소지번 */
		     , a2.LOCPLC_ADRES_LNM				/* 소재지주소지번 */
		     , NVL(a2.LOCPLC_ADRES_LNM, a2.LOCPLC_ADRES) AS LAD_ADRES	/* 토지주소 */
		     , a2.PRPOS_SE						/* 용도구분 */
		     , c2.CODE_NM AS PRPOS_SE_NM		/* 용도구분명 */
		     , a2.SUPLY_CODE					/* 공급구분 */
		     , d2.CODE_NM AS SUPLY_CODE_NM		/* 공급구분명 */
		     , a2.LAD_SE						/* 토지구분 */
		     , e2.CODE_NM AS LAD_SE_NM			/* 토지구분명 */
		     , a2.CNTRCT_STTUS					/* 계약상태 */
		     , f2.CODE_NM AS CNTRCT_STTUS_NM	/* 계약상태명 */
		     , a2.REMNDR_LAD_SE					/* 잔여토지구분 */
		     , g2.CODE_NM AS REMNDR_LAD_SE_NM	/* 잔여토지구분명 */
			 , a2.CNTRCT_DE						/* 계약일자 */
		     , a2.DCSN_AR						/* 확정면적 */
		     , a2.DCSN_UNTPC					/* 확정단가 */
		     , a2.DCSN_AMOUNT					/* 확정금액 */
		     , a2.CHANGE_SN						/* 변경일련번호 */
		     , a2.CHANGE_DE						/* 변경일 */
		     , a2.CHANGE_SE						/* 변경구분(05) */
		     , h2.CODE_NM AS CHANGE_SE_NM		/* 변경구분명 */
		     , a2.CHGHY							/* 변경사유 */
			 /* 당초분양자(변경전) */
		     , a2.LAD_CSTMR_NO_BFCHG			/* 변경전_토지고객번호 */
		     , a2.BFCHG_NM						/* 변경전_성명 */
		     
		     <isEqual property="IHIDNUM_STTUS_AT" compareValue = "N">							
		         ,DECODE(a2.BFCHG_IHIDNUM, NULL, '', SUBSTR(a2.BFCHG_IHIDNUM,0,6)||'*******') AS BFCHG_IHIDNUM                  /* 변경전_주민등록번호 */			         
		    </isEqual>	
	        <isEqual property="IHIDNUM_STTUS_AT" compareValue = "Y">							
		         ,DECODE(a2.BFCHG_IHIDNUM, NULL, '', a2.BFCHG_IHIDNUM) AS BFCHG_IHIDNUM      /* 변경전_주민등록번호 */					
	        </isEqual>
	         , a2.BFCHG_ZIP						/* 변경전_우편번호 */
		     , a2.BFCHG_ADRES					/* 변경전_주소 */
		     , a2.BFCHG_ADRES_DETAIL			/* 변경전_상세주소 */
		     , a2.BFCHG_ADRES_ALL				/* 변경전_전체주소 */
		     , a2.BFCHG_TELNO					/* 변경전_전화번호호 */
		     , a2.BFCHG_MBTLNO					/* 변경전_휴대폰번호 */
		     /* 명의변경자(변경후) */
		     , a2.LAD_CSTMR_NO					/* 변경후_토지고객번호 */
		     , a2.CSTMR_NM							/* 변경후_성명 */
		      <isEqual property="IHIDNUM_STTUS_AT" compareValue = "N">							
		         ,DECODE(a2.IHIDNUM, NULL, '', SUBSTR(a2.IHIDNUM,0,6)||'*******') AS IHIDNUM                  /* 변경후_주민등록번호 */			         
		      </isEqual>	
	          <isEqual property="IHIDNUM_STTUS_AT" compareValue = "Y">							
		         ,DECODE(a2.IHIDNUM, NULL, '', a2.IHIDNUM) AS IHIDNUM      /* 변경후_주민등록번호 */					
	          </isEqual>
		     , a2.ZIP							/* 변경후_우편번호 */
		     , a2.ADRES							/* 변경후_주소 */
		     , a2.ADRES_DETAIL					/* 변경후_상세주소 */
		     , a2.ADRES_ALL						/* 변경후_전체주소 */
		     , a2.TELNO							/* 변경후_전화번호 */
		     , a2.MBTLNO						/* 변경후_휴대폰번호 */
		     /* 변경전 수납정보 */
		     , i2.PAYAMT						/* 납부금액 */
		     , i2.RCIV_AMOUNT					/* 수납금액 */
			 , i2.RCIV_DE						/* 수납일자 */
		  FROM (SELECT c1.LAD_CODE
		             /* 토지정보 */
		             , c1.BLCK
		             , c1.LOT
		             , c1.LOT_TY
		             , LPAD(c1.BLCK, 3,'0')||LPAD(c1.LOT, 3, '0')||LPAD(c1.LOT_TY, 2, '0') AS BLCK_SUM	/* 조회용 B.L.T 값 */
		             , DECODE(NVL(c1.DCSN_AR, 0), 0, c1.BGNN_AR, c1.DCSN_AR) AS DCSN_AR
		             , DECODE(NVL(c1.DCSN_UNTPC, 0), 0, c1.BGNN_UNTPC, c1.DCSN_UNTPC) AS DCSN_UNTPC
		             , DECODE(NVL(c1.DCSN_AMOUNT, 0), 0, c1.BGNN_AMOUNT, c1.DCSN_AMOUNT) AS DCSN_AMOUNT
		             , c1.LOCPLC_ZIP
		             , c1.LOCPLC_BASS_ADRES
		             , c1.LOCPLC_DETAIL_ADRES
		             , c1.LOCPLC_BASS_ADRES || c1.LOCPLC_DETAIL_ADRES AS LOCPLC_ADRES
		             , c1.LOCPLC_ZIP_LNM
		             , c1.LOCPLC_BASS_ADRES_LNM
		             , c1.LOCPLC_DETAIL_ADRES_LNM
		             , c1.LOCPLC_BASS_ADRES_LNM || c1.LOCPLC_DETAIL_ADRES_LNM AS LOCPLC_ADRES_LNM
		             , c1.PRPOS_SE
		             , c1.SUPLY_CODE			/* b.SUPLY_SE */
		             , c1.CNTRCT_STTUS
		             , c1.LAD_SE
		             , c1.REMNDR_LAD_SE
		             /* 계약(자)정보 */
		             , a1.CNTRCTR_NO
		             , b1.CNTRCT_DE
		             /* 변경정보 */
		             , a1.CHANGE_SN
		             , a1.CHANGE_DE
		             , a1.CHANGE_SE
		             , a1.CHGHY
		             /* 당초분양자(변경전) */
		             , a1.LAD_CSTMR_NO_BFCHG
		             , a1.BFCHG_NM
		             , a1.BFCHG_IHIDNUM
		             , a1.BFCHG_ZIP
		             , a1.BFCHG_ADRES
		             , a1.BFCHG_ADRES_DETAIL
		             , a1.BFCHG_ADRES_ALL
		             , a1.BFCHG_TELNO
		             , a1.BFCHG_MBTLNO
		             /* 명의변경자(변경후) */
		             , a1.LAD_CSTMR_NO
		             , a1.CSTMR_NM
		             , a1.IHIDNUM
		             , a1.ZIP
		             , a1.ADRES
		             , a1.ADRES_DETAIL
		             , a1.ADRES_ALL
		             , a1.TELNO
		             , a1.MBTLNO
		          FROM (SELECT a.CNTRCTR_NO	/* 계약자번호 */
		                     , a.CHANGE_SN	/* 변경일련번호 */
		                     , a.CHANGE_DE	/* 변경일 */
		                     , a.CHANGE_SE	/* 변경구분 */
		                     , a.CHGHY		/* 변경사유 */
		                     /* 변경전 */
		                     , a.BFCHG_NMCHANGE_SN	/* 변경전_변경일련번호 */
		                     , a.LAD_CSTMR_NO_BFCHG	/* 변경전_토지고객번호 */
		                     , b.CSTMR_NM AS BFCHG_NM		/* 변경전_성명 */
		                     , DECODE(SFCOM_DEC_ALL(b.IHIDNUM), NULL, '', SFCOM_DEC_ALL(b.IHIDNUM)) AS BFCHG_IHIDNUM	/* 변경전_주민등록번호 */
		                     , b.ZIP AS BFCHG_ZIP
		                     , b.ADRES AS BFCHG_ADRES
		                     , b.ADRES_DETAIL AS BFCHG_ADRES_DETAIL
		                     , b.ADRES || b.ADRES_DETAIL AS BFCHG_ADRES_ALL
		                     , b.TELNO AS BFCHG_TELNO	/* 변경전_전화번호 */
		                     , b.MBTLNO AS BFCHG_MBTLNO	/* 변경전_휴대폰번호 */
		                     /* 변경후 */
		                     , a.LAD_CSTMR_NO		/* 토지고객번호 */
		                     , c.CSTMR_NM					/* 변경후_성명 */
		                     , DECODE(SFCOM_DEC_ALL(c.IHIDNUM), NULL, '', SFCOM_DEC_ALL(c.IHIDNUM)) AS IHIDNUM	/* 변경후_주민등록번호 */
		                     , c.ZIP
		                     , c.ADRES
		                     , c.ADRES_DETAIL
		                     , c.ADRES || c.ADRES_DETAIL AS ADRES_ALL
		                     , c.TELNO				/* 변경전_전화번호 */
		                     , c.MBTLNO				/* 변경전_휴대폰번호 */
		                  FROM TBSLS_LCNTRCTR_NMCHANGE a	/* 토지계약자명의변경 : LNT_CT_CHGE_NAME 계약자 명의변경내역 */
		                     , TBSLS_LAD_CSTMR b			/* 토지고객 : 변경 전 */
		                     , TBSLS_LAD_CSTMR c			/* 토지고객 : 변경 후 */
		                 WHERE 1 = 1
		                   AND a.LAD_CSTMR_NO_BFCHG = b.LAD_CSTMR_NO
		                   AND a.LAD_CSTMR_NO = c.LAD_CSTMR_NO
		                   AND a.CHANGE_DE BETWEEN #CHANGE_DE_FM# AND #CHANGE_DE_TO#	/* 변경일 */
		               ) a1	/* 명의 변경자 정보 */
		             , TBSLS_LCNTRCTR b1			/* 토지계약자 */
		             , TBSLS_LAD_DETAIL_INFO c1		/* 토지상세정보 : LNT_LN_INFOMST 공급토지상세정보 */
		         WHERE 1 = 1
		           AND a1.CNTRCTR_NO = b1.CNTRCTR_NO
		           AND b1.LAD_CODE = c1.LAD_CODE
		           AND b1.BLCK = c1.BLCK
		           AND b1.LOT = c1.LOT
		           AND b1.LOT_TY = c1.LOT_TY
		           /* 조회조건 */
		           
		         <isNotEmpty property="LAD_CODE">
		           AND c1.LAD_CODE = #LAD_CODE#							/* 토지코드 */
		         </isNotEmpty>
		         <isNotEmpty property="CNTRCT_STTUS">
		           AND NVL(c1.CNTRCT_STTUS, 'SL') = #CNTRCT_STTUS#   	/* 계약상태 */
		         </isNotEmpty>
		         <isNotEmpty property="LAD_SE">
		           AND c1.LAD_SE = #LAD_SE#   						/* 토지구분(상태) */
		         </isNotEmpty>
		         <isNotEmpty property="PRPOS_SE">
		           AND c1.PRPOS_SE = #PRPOS_SE#   					/* 용도구분 */
		         </isNotEmpty>
		         <isNotEmpty property="SUPLY_CODE">
		           AND c1.SUPLY_CODE = #SUPLY_CODE#   				/* 계약자_공급구분 */
		         </isNotEmpty>
		         <isNotEmpty property="REMNDR_LAD_SE">
		           AND c1.REMNDR_LAD_SE = #REMNDR_LAD_SE#			/* 잔여토지구분(A2) */
		         </isNotEmpty>
		         <isNotEmpty property="CNTRCT_DE_FM">
		           		   AND b1.CNTRCT_DE >= #CNTRCT_DE_FM#	  /* 계약일자 */
		       	 </isNotEmpty>		       		   
		       	<isNotEmpty property="CNTRCT_DE_TO">
		        		   AND b1.CNTRCT_DE <![CDATA[<= ]]>#CNTRCT_DE_TO#	  /* 계약일자 */
		       	</isNotEmpty>
		       ) a2
		     , TBSLS_LAD_INFO b2	/* 토지정보 */
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD003'	/* 토지용도구분 */
		       ) c2
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD004'	/* 공급구분 */
		       ) d2
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD0A3'	/* 토지구분(상태) */
		       ) e2
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD0A4'	/* 계약상태 */
		       ) f2
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD0A2'	/* 잔여토지구분 */
		       ) g2
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD005'	/* 토지명의변경구분 */
		       ) h2
		     , (SELECT v.CNTRCTR_NO
		     		 , SUM(v.PAYAMT + v.PREPAY_DSCNT_AMOUNT) AS PAYAMT	/* 납부금액(납부_납부금액 + 납부_선납할인금액) */
		             , SUM(w.RCIV_AMOUNT) AS RCIV_AMOUNT				/* 수납금액 */
		     		 , MAX(w.RCIV_DE) AS RCIV_DE						/* 수납일자 */
		          FROM TBSLS_LCNTRCTR_PAY v	/* 토지계약자납부 : lnt_ct_vote 계약자 납부정보(일반) */
		             , TBSLS_LAD_RCIV_PSTMRK w 	/* 토지수납 : lnt_ct_receipt 계약자 수납정보_징수 */
		         WHERE v.CNTRCTR_NO = w.CNTRCTR_NO
		           AND v.PAY_NO = w.PAY_NO
		         GROUP BY v.CNTRCTR_NO
		       ) i2
		 WHERE 1 = 1
		   AND a2.LAD_CODE = b2.LAD_CODE
		   AND a2.PRPOS_SE = c2.CODE(+)
		   AND a2.SUPLY_CODE = d2.CODE(+)
		   AND a2.LAD_SE = e2.CODE(+)
		   AND a2.CNTRCT_STTUS = f2.CODE(+)
		   AND a2.REMNDR_LAD_SE = g2.CODE(+)
		   AND a2.CHANGE_SE = h2.CODE(+)
		   AND a2.CNTRCTR_NO = i2.CNTRCTR_NO(+)
		   AND a2.CHANGE_DE > i2.RCIV_DE(+)
	   
	   <!--  2016.06.20 -->
   	   <isNotEmpty property="BLCK_FM">
   	  	   AND a2.BLCK = #BLCK_FM#
   	   </isNotEmpty>
   	   <isNotEmpty property="LOT_FM">
   	  	   AND a2.LOT = #LOT_FM#
   	   </isNotEmpty>
   	   <isNotEmpty property="LOT_TY_FM">
   	  	   AND a2.LOT_TY = #LOT_TY_FM#
   	   </isNotEmpty>
   	   
   	   <!--
	   <isNotEmpty property="BLT_FM">
	     <isNotEmpty property="BLT_TO">
		   AND a2.BLCK_SUM BETWEEN #BLT_FM# AND #BLT_TO#
		 </isNotEmpty>
	   </isNotEmpty>
	   -->
		 ORDER BY a2.LAD_CODE
		        , LPAD(a2.BLCK, 3, '0')
		        , LPAD(a2.LOT, 3, '0')
		        , LPAD(a2.LOT_TY, 2, '0')
    </select>
    
	<!-- 쿼리명 : 소유권이전현황조회
	설명 : 토지별 소유권이전현황 목록 조회
	수정일  		수정자  	수정내용
	2015.10.06	이상준		최초생성
	작성자 : 이상준
	최초작성일 : 2015.10.06
	-->
    <select id="SLS110104DAO.selectLadOwnShipTransrSttusList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
    	SELECT /* SLS110104DAO.selectLadOwnShipTransrSttusList 소유권이전현황 조회 */
		       a2.LAD_CODE						/* 토지코드 */
		     , b2.LAD_NM						/* 토지명 */
		     , a2.PRPOS_SE						/* 용도구분 */
		     , c2.CODE_NM AS PRPOS_SE_NM		/* 용도구분명 */
		     , CNT1 AS OWNSHIP_TRANSR_CNT		/* 소유권이전수 */
		     , CNT2	AS OWNSHIP_NOT_TRANSR_CNT	/* 소유권미이전수 */
		     , CNT1 + CNT2 AS TOTAL_LOT_CNT		/* 총 필지수 */
		  FROM (
		        SELECT a1.LAD_CODE
		             , a1.PRPOS_SE
		             , SUM(DECODE(b1.OWNSHIP_BEFORE_DE, NULL, 0, 1)) AS CNT1
		             , SUM(DECODE(b1.OWNSHIP_BEFORE_DE, NULL, 1, 0)) AS CNT2
		          FROM (SELECT a.LAD_CODE
		                     , a.BLCK
		                     , a.LOT
		                     , a.LOT_TY
		                     , a.PRPOS_SE
		                     , a.SUPLY_CODE
		                     , b.CNTRCTR_NO
		                  FROM TBSLS_LAD_DETAIL_INFO a	/* LNT_LN_INFOMST 공급토지상세정보 */
		                     , TBSLS_LCNTRCTR b			/* 토지계약자 */
		                 WHERE 1 = 1
		                   AND a.LAD_CODE = b.LAD_CODE
		                   AND a.BLCK = b.BLCK
		                   AND a.LOT = b.LOT
		                   AND a.LOT_TY = b.LOT_TY
		                   AND b.CANCL_DE IS NULL
		                   
		                 <isNotEmpty property="LAD_CODE">
				           AND a.LAD_CODE = #LAD_CODE#			/* 토지코드 */
				         </isNotEmpty>
				         <isNotEmpty property="CNTRCT_STTUS">
				           AND b.CNTRCT_TY = #CNTRCT_STTUS#   	/* 계약상태 */
				         </isNotEmpty>        
				         <isNotEmpty property="CNTRCT_DE_FM">
		           		   AND b.CNTRCT_DE >= #CNTRCT_DE_FM#	  /* 계약일자 */
				       	 </isNotEmpty>		       		   
				       	<isNotEmpty property="CNTRCT_DE_TO">
				        		   AND b.CNTRCT_DE <![CDATA[<= ]]>#CNTRCT_DE_TO#	  /* 계약일자 */
				       	</isNotEmpty>
		               ) a1
		             , TBSLS_LCNTRCTR_ETC_INFO b1		/* 토지계약자기타정보 : LNT_CT_ETCINFO 계약자기타내역 */
		         WHERE 1 = 1
		           AND a1.CNTRCTR_NO = b1.CNTRCTR_NO(+)
		         GROUP BY a1.LAD_CODE
		                , a1.PRPOS_SE
		       ) a2
		     , TBSLS_LAD_INFO b2	/* 토지정보 : LNT_LN_CODE 토지코드정보 */
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD003'	/* 토지용도구분 */
		       ) c2
		 WHERE 1 = 1
		   AND a2.LAD_CODE = b2.LAD_CODE
		   AND a2.PRPOS_SE = c2.CODE(+)
		 ORDER BY a2.PRPOS_SE
    </select>
    
    <!-- 쿼리명 : 압류현황조회
	설명 : 토지별 압류현황 목록 조회
	수정일  		수정자  	수정내용
	2015.10.07	이상준		최초생성
	작성자 : 이상준
	최초작성일 : 2015.10.07
	-->
    <select id="SLS110104DAO.selectLadSeizrSttusList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
    	WITH V_LCNTRCTR AS		/* 토지 계약자 */
		(
		    <include refid="COM000000.v_sls_lcntrctr_info"/>
		)
		SELECT /* SLS110104DAO.selectLadSeizrSttusList 압류현황 조회 */
		       a1.CNTRCTR_NO		/* 계약자번호 */
		     , a1.SEIZR_SN			/* 압류일련번호 */
		     , a1.LAD_CODE			/* 토지코드 */
		     , b1.LAD_NM			/* 토지명 */
		     , a1.BLCK				/* 계약자_블록 */
		     , a1.LOT				/* 계약자_롯트 */
		     , a1.LOT_TY			/* 계약자_롯트구분 */
		     , a1.BLCK_SUM			/* B.L.T */
		     , a1.CSTMR_NM				/* 계약자_성명 */
		     , a1.TELNO				/* 계약자_전화번호 */
		     , a1.MBTLNO			/* 계약자_휴대폰번호 */
			 , a1.CDIT_DECSN_DE		/* 채권결정일 */
		     , a1.CDIT_RCEPT_DE		/* 채권접수일 */
		     , a1.RELIS_RCEPT_DE	/* 해제접수일 */
		     , a1.RELIS_DE			/* 해제일자 */
		     , a1.CRDTR_NM			/* 채권자명 */
		     , a1.CRDTR_TELNO		/* 채권자전화번호 */
		     , a1.CRDTR_TELNO_2		/* 채권자전화번호2 */
		     , a1.DET_AMOUNT		/* 채무금액 */
		     , a1.INCDNT_CN			/* 사건내용 */
		     , a1.CDIT_CN			/* 채권내용 */
		     , a1.SEIZR_SE			/* 압류구분 */
		     , h1.CODE_NM AS SEIZR_SE_NM	/* 압류구분명 */
		     , a1.RM				/* 비고 */
		     /* 기타정보 */
		     , a1.PRPOS_SE						/* 용도구분 */
		     , c1.CODE_NM AS PRPOS_SE_NM		/* 용도구분명 */
		     , a1.SUPLY_CODE					/* 공급구분 */
		     , d1.CODE_NM AS SUPLY_CODE_NM		/* 공급구분명 */
		     , a1.LAD_SE						/* 토지구분 */
		     , e1.CODE_NM AS LAD_SE_NM			/* 토지구분명 */
		     , a1.CNTRCT_STTUS					/* 계약상태 */
		     , f1.CODE_NM AS CNTRCT_STTUS_NM	/* 계약상태명 */
		     , a1.REMNDR_LAD_SE					/* 잔여토지구분 */
		     , g1.CODE_NM AS REMNDR_LAD_SE_NM	/* 잔여토지구분명 */
		  FROM (SELECT a.CNTRCTR_NO		/* 계약자번호 */
		             , a.SEIZR_SN		/* 압류일련번호 */
		             , b.CSTMR_NM				/* 계약자_성명 */
		             , b.TELNO			/* 계약자_전화번호 */
		             , b.MBTLNO			/* 계약자_휴대폰번호 */
		             , b.LAD_CODE		/* 계약자_토지코드 */
		             , b.BLCK			/* 계약자_블록 */
		             , b.LOT			/* 계약자_롯트 */
		             , b.LOT_TY			/* 계약자_롯트구분 */
		             , LPAD(b.BLCK, 3,'0')||LPAD(b.LOT, 3, '0')||LPAD(b.LOT_TY, 2, '0') AS BLCK_SUM	/* 조회용 B.L.T 값 */
		             , b.CNTRCT_TY AS CNTRCT_STTUS
		             , c.LAD_SE
		             , c.PRPOS_SE
		             , c.SUPLY_CODE
		             , c.REMNDR_LAD_SE
		             , a.CDIT_DECSN_DE	/* 채권결정일 */
		             , a.CDIT_RCEPT_DE	/* 채권접수일 */
		             , a.RELIS_RCEPT_DE	/* 해제접수일 */
		             , a.RELIS_DE		/* 해제일자 */
		             , a.CRDTR_NM		/* 채권자명 */
		             , a.CRDTR_TELNO	/* 채권자전화번호 */
		             , a.CRDTR_TELNO_2	/* 채권자전화번호2 */
		             , a.DET_AMOUNT		/* 채무금액 */
		             , a.INCDNT_CN		/* 사건내용 */
		             , a.CDIT_CN		/* 채권내용 */
		             , a.SEIZR_SE		/* 압류구분 */
		             , a.RM				/* 비고 */
		          FROM TBSLS_LCNTRCTR_SEIZR a	/* 토지계약자압류 : LNT_CT_ATTACH 계약자 압류정보내역 */
		             , V_LCNTRCTR b				/* 토지계약자정보 LNT_CT_INFO 계약자정보 */
		             , TBSLS_LAD_DETAIL_INFO c	/* LNT_LN_INFOMST 공급토지상세정보 */
		         WHERE 1 = 1
		           AND a.CNTRCTR_NO IS NOT NULL	/* 압류_계약자번호 */
		           AND a.SEIZR_SN > 0  			/* 압류_압류일련번호 */
		           AND a.CNTRCTR_NO = b.CNTRCTR_NO
		           AND b.LAD_CODE = c.LAD_CODE
		           AND b.BLCK = c.BLCK
		           AND b.LOT = c.LOT
		           AND b.LOT_TY = c.LOT_TY
		           
		         <isNotEmpty property="LAD_CODE">
		           AND b.LAD_CODE = #LAD_CODE#			/* 계약자_토지코드 */
		         </isNotEmpty>
		           
		         <isNotEmpty property="CNTRCT_STTUS">
		           AND b.CNTRCT_TY = #CNTRCT_STTUS#		/* 계약자_계약타입(상태) */
		         </isNotEmpty>

		         <isNotEmpty property="LAD_SE">
		           AND c.LAD_SE = #LAD_SE#   				/* 토지구분(상태) */
		         </isNotEmpty>
		         <isNotEmpty property="PRPOS_SE">
		           AND c.PRPOS_SE = #PRPOS_SE#   			/* 용도구분 */
		         </isNotEmpty>
		         <isNotEmpty property="SUPLY_CODE">
		           AND c.SUPLY_CODE = #SUPLY_CODE#  		/* 계약자_공급구분 */
		         </isNotEmpty>
		         <isNotEmpty property="REMNDR_LAD_SE">
		           AND c.REMNDR_LAD_SE = #REMNDR_LAD_SE#	/* 잔여토지구분(A2) */
		         </isNotEmpty>
		         <isNotEmpty property="CNTRCT_DE_FM">
		           		   AND b.CNTRCT_DE >= #CNTRCT_DE_FM#	  /* 계약일자 */
		       	 </isNotEmpty>		       		   
		       	<isNotEmpty property="CNTRCT_DE_TO">
		        		   AND b.CNTRCT_DE <![CDATA[<= ]]>#CNTRCT_DE_TO#	  /* 계약일자 */
		       	</isNotEmpty>
		       ) a1
			 , TBSLS_LAD_INFO b1	/* 토지정보 */
			 , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD003'	/* 토지용도구분 */
		       ) c1
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD004'	/* 공급구분 */
		       ) d1
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD0A3'	/* 토지구분(상태) */
		       ) e1
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD0A4'	/* 계약상태 */
		       ) f1
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD0A2'	/* 잔여토지구분 */
		       ) g1
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD006'	/* 압류구분 */
		       ) h1
		 WHERE 1 = 1
		   AND a1.LAD_CODE = b1.LAD_CODE
		   AND b1.USE_AT = '1'
		   AND a1.PRPOS_SE = c1.CODE(+)
		   AND a1.SUPLY_CODE = d1.CODE(+)
		   AND a1.LAD_SE = e1.CODE(+)
		   AND a1.CNTRCT_STTUS = f1.CODE(+)
		   AND a1.REMNDR_LAD_SE = g1.CODE(+)
		   AND a1.SEIZR_SE = h1.CODE
		   
	   <!--  2016.06.20 -->
   	   <isNotEmpty property="BLCK_FM">
   	  	   AND a1.BLCK = #BLCK_FM#
   	   </isNotEmpty>
   	   <isNotEmpty property="LOT_FM">
   	  	   AND a1.LOT = #LOT_FM#
   	   </isNotEmpty>
   	   <isNotEmpty property="LOT_TY_FM">
   	  	   AND a1.LOT_TY = #LOT_TY_FM#
   	   </isNotEmpty>
   	   
   	   <!--
	   <isNotEmpty property="BLT_FM">
		 <isNotEmpty property="BLT_TO">
		   AND a1.BLCK_SUM BETWEEN #BLT_FM# AND #BLT_TO#
		 </isNotEmpty>
	   </isNotEmpty>
	   -->
		 ORDER BY LPAD(a1.BLCK, 3, '0')
		        , LPAD(a1.LOT, 3, '0')
		        , LPAD(a1.LOT_TY, 2, '0')
    </select>
    
    <!-- 쿼리명 : 대출현황조회
	설명 : 토지별 대출현황 목록 조회
	수정일  		수정자  	수정내용
	2015.10.07	이상준		최초생성
	작성자 : 이상준
	최초작성일 : 2015.10.07
	-->
    <select id="SLS110104DAO.selectLadLonSttusList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
    	WITH V_LCNTRCTR AS		/* 토지 계약자 */
		(
		     <include refid="COM000000.v_sls_lcntrctr_info"/>
		)
		SELECT /* SLS110104DAO.selectLadLonSttusList 대출현황 조회 */
			   a1.LAD_CODE				/* 토지코드 */
			 , b1.LAD_NM				/* 토지명 */
		     , a1.BLCK					/* 블록 */
		     , a1.LOT					/* 롯트 */
		     , a1.LOT_TY				/* 롯트구분 */
		     , a1.BLCK_SUM				/* 조회용 B.L.T 값 */
		     , a1.SUPLY_CODE			/* 용도구분 */
		     , c1.CODE_NM AS SUPLY_CODE_NM	/* 용도구분명 */
		     , a1.DCSN_AR				/* 확정면적 */
		     , a1.DCSN_UNTPC			/* 확정단가 */
		     , a1.DCSN_AMOUNT			/* 확정금액 */
		     /* 계약자정보 */
		     , a1.CNTRCTR_NO			/* 계약자번호 */
		     , a1.CSTMR_NM					/* 계약자_성명 */
		     , a1.CNTRCT_STTUS			/* 계약자_계약타입(구분) */
		     , d1.CODE_NM AS CNTRCT_STTUS_NM	/* 계약자_계약타입(구분)명 */
		     /* 대출정보 */
		     , a1.LON_SE				/* 대출구분 */
		     , e1.CODE_NM AS LON_SE_NM	/* 대출구분명 */
		     , a1.TRNSFR_DE				/* 양도일자 */
		     , a1.CDIT_TRNSFR_AMOUNT	/* 채권양도금액 */
		     , a1.CDIT_GRNTE_BANK		/* 채권양수인은행 */
		     , a1.RELIS_DE				/* 해제일자 */
		     , a1.RM					/* 비고 */
		  FROM (SELECT a.LAD_CODE
		             , a.BLCK
		             , a.LOT
		             , a.LOT_TY
		             , LPAD(b.BLCK, 3,'0')||LPAD(b.LOT, 3, '0')||LPAD(b.LOT_TY, 2, '0') AS BLCK_SUM	/* 조회용 B.L.T 값 */
		             , a.SUPLY_CODE
		             , a.DCSN_AR
		             , a.DCSN_UNTPC
		             , a.DCSN_AMOUNT
		             , b.CNTRCTR_NO
		             , b.CSTMR_NM
		             , b.CNTRCT_TY AS CNTRCT_STTUS
		             , c.LON_SE
		             , c.TRNSFR_DE
		             , c.CDIT_TRNSFR_AMOUNT
		             , c.CDIT_GRNTE_BANK
		             , c.RELIS_DE
		             , c.RM
		          FROM TBSLS_LAD_DETAIL_INFO a	/* 토지상세정보 : LNT_LN_INFOMST 공급토지상세정보 */
		             , V_LCNTRCTR b				/* 토지계약자정보 : LNT_CT_INFO 계약자정보 */
		             , TBSLS_LCNTRCTR_LON c		/* 주택계약자대출 : LNT_CT_LENDOUT 계약자 대출정보 */
		         WHERE 1 = 1
		           AND a.LAD_CODE = b.LAD_CODE
		           AND a.BLCK = b.BLCK
		           AND a.LOT = b.LOT
		           AND a.LOT_TY = b.LOT_TY
		           AND b.CNTRCTR_NO = c.CNTRCTR_NO
		           
		          <isNotEmpty property="LAD_CODE">
		           AND a.LAD_CODE = #LAD_CODE#   				
		         </isNotEmpty>
		         <isNotEmpty property="CNTRCT_STTUS">
		           AND b.CNTRCT_TY = #CNTRCT_STTUS#   				
		         </isNotEmpty>
		           
		         <isNotEmpty property="LAD_SE">
		           AND a.LAD_SE = #LAD_SE#   				/* 토지구분(상태) */
		         </isNotEmpty>
		         <isNotEmpty property="SUPLY_CODE">
		           AND a.SUPLY_CODE = #SUPLY_CODE#  		/* 계약자_공급구분 */
		         </isNotEmpty>
		         <isNotEmpty property="PRPOS_SE">
		           AND a.PRPOS_SE = #PRPOS_SE#   			/* 용도구분 */
		         </isNotEmpty>
		         <isNotEmpty property="REMNDR_LAD_SE">
		           AND a.REMNDR_LAD_SE = #REMNDR_LAD_SE#	/* 잔여토지구분(A2) */
		         </isNotEmpty>
		         <isNotEmpty property="CNTRCT_DE_FM">
		           		   AND b.CNTRCT_DE >= #CNTRCT_DE_FM#	  /* 계약일자 */
		       	 </isNotEmpty>		       		   
		       	<isNotEmpty property="CNTRCT_DE_TO">
		        		   AND b.CNTRCT_DE <![CDATA[<= ]]>#CNTRCT_DE_TO#	  /* 계약일자 */
		       	</isNotEmpty>
		       ) a1
		     , TBSLS_LAD_INFO b1			/* 토지정보 */
			 , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD003'	/* 토지용도구분 */
		       ) c1
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD0A4'	/* 계약상태 */
		       ) d1
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD0A5'	/* 대출구분 */
		       ) e1
		 WHERE 1 = 1
		   AND a1.LAD_CODE = b1.LAD_CODE
		   AND b1.USE_AT = '1'
		   AND a1.SUPLY_CODE = c1.CODE(+)
		   AND a1.CNTRCT_STTUS = d1.CODE(+)
		   AND a1.LON_SE = e1.CODE(+)
		   
	   <!--  2016.06.20 -->
   	   <isNotEmpty property="BLCK_FM">
   	  	   AND a1.BLCK = #BLCK_FM#
   	   </isNotEmpty>
   	   <isNotEmpty property="LOT_FM">
   	  	   AND a1.LOT = #LOT_FM#
   	   </isNotEmpty>
   	   <isNotEmpty property="LOT_TY_FM">
   	  	   AND a1.LOT_TY = #LOT_TY_FM#
   	   </isNotEmpty>
   	   
   	   <!--
	   <isNotEmpty property="BLT_FM">
		 <isNotEmpty property="BLT_TO">
		   AND a1.BLCK_SUM BETWEEN #BLT_FM# AND #BLT_TO#
		 </isNotEmpty>
	   </isNotEmpty>
	   -->
		 ORDER BY LPAD(a1.BLCK, 3, '0')
		        , LPAD(a1.LOT, 3, '0')
		        , LPAD(a1.LOT_TY, 2, '0')
    </select>
    
    <!-- 쿼리명 : 미수금현황조회
	설명 : 토지별 미수금현황 목록 조회
	수정일  		수정자  	수정내용
	2015.10.08	이상준		최초생성
	작성자 : 이상준
	최초작성일 : 2015.10.08
	-->
    <select id="SLS110104DAO.selectLadUnclamtSttusList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap" remapResults="true">
WITH V_LCNTRCTR_UNCAMT AS
        (
               SELECT /* SLS110104DAO.selectLadUnclamtSttusList 미수금현황 조회 */
                        b1.CNTRCTR_NO,
                        b1.LAD_CODE,
                        d1.LAD_NM  ,
                        b1.BLCK,
                        b1.LOT,
                        b1.LOT_TY,
                        LPAD (b1.BLCK, 3, '0')|| LPAD (b1.LOT, 3, '0')|| LPAD (b1.LOT_TY, 2, '0') AS BLCK_SUM,
                        e1.SUPLY_CODE,
                        e1.PRPOS_SE,
                        m1.CODE_NM AS PRPOS_SE_NM,
                        e1.LOCPLC_ZIP,
                        e1.LOCPLC_BASS_ADRES,
                        e1.LOCPLC_DETAIL_ADRES,
                        e1.LOCPLC_BASS_ADRES || e1.LOCPLC_DETAIL_ADRES AS LOCPLC_ADRES,
                        e1.LOCPLC_ZIP_LNM,
                        e1.LOCPLC_BASS_ADRES_LNM,
                        e1.LOCPLC_DETAIL_ADRES_LNM,
                        e1.LOCPLC_BASS_ADRES_LNM || e1.LOCPLC_DETAIL_ADRES_LNM AS LOCPLC_ADRES_LNM,
                        NVL (e1.LOCPLC_BASS_ADRES || e1.LOCPLC_DETAIL_ADRES,
                             e1.LOCPLC_BASS_ADRES_LNM || e1.LOCPLC_DETAIL_ADRES_LNM) AS LAD_ADRES,
                        DECODE (NVL (e1.DCSN_AR, 0), 0, e1.BGNN_AR, e1.DCSN_AR) AS DCSN_AR,
                        DECODE (NVL (e1.DCSN_UNTPC, 0), 0, e1.BGNN_UNTPC, e1.DCSN_UNTPC) AS DCSN_UNTPC,
                        DECODE (NVL (e1.DCSN_AMOUNT, 0), 0, e1.BGNN_AMOUNT, e1.DCSN_AMOUNT) AS DCSN_AMOUNT,
                        c1.CSTMR_NM,
                        DECODE (SFCOM_DEC_ALL (c1.IHIDNUM),NULL, '',SFCOM_DEC_ALL (c1.IHIDNUM)) AS IHIDNUM ,
                        c1.TELNO,
                        c1.MBTLNO,
                        c1.ZIP,
                        c1.ADRES,
                        c1.ADRES_DETAIL,
                        c1.ADRES || c1.ADRES_DETAIL AS ADRES_ALL,
                        a1.PAY_CODE,
                        m2.CODE_NM AS PAY_CODE_NM,
                        a1.PAYAMT,
                        a1.PAY_TMLMT
		                  FROM (
				                  	    /* 조회구분 : 분양[01], 임대[02] */
				                  		SELECT a.CNTRCTR_NO			/* 계약자번호 */
				                  		     , a.PAY_TMLMT			/* 납부기한일 */		                  			 
				                             , a.PAY_CODE			/* 납부코드 */
				                             , SUM(NVL(a.PAYAMT, 0) + NVL(a.INSTLMT_INTR, 0) + NVL(a.RDCAMT_AMOUNT, 0)) AS PAYAMT		/* 납부정보_금액 */		                               		                            
				                  		  FROM TBSLS_LCNTRCTR_PAY a		/* 토지계약자납부 : LNT_CT_VOTE 계약자 납부정보(일반) */
				                         WHERE  (NVL(a.PAYAMT, 0) + NVL(a.INSTLMT_INTR, 0)  + NVL(a.RDCAMT_AMOUNT, 0)) <![CDATA[ > ]]> 0
										   <isNotEmpty property="PAY_TMLMT_FM">
										     <isNotEmpty property="PAY_TMLMT_TO">
										       AND a.PAY_TMLMT BETWEEN #PAY_TMLMT_FM# AND #PAY_TMLMT_TO#
										     </isNotEmpty>
										   </isNotEmpty>
										   <isNotEmpty property="RCIV_DE">
										       AND (a.RCIV_DE is null or  a.RCIV_DE <![CDATA[ > ]]> #RCIV_DE#)  
										   </isNotEmpty>	                                	                      
				                       GROUP BY a.CNTRCTR_NO, a.PAY_CODE, a.PAY_TMLMT
		                          ) a1
		                       , TBSLS_LCNTRCTR b1			/* 토지계약자 */
		                       , TBSLS_LAD_CSTMR c1          /* 토지고객 */
		                       , TBSLS_LAD_INFO d1              /* 토지정보 */
		                       , TBSLS_LAD_DETAIL_INFO e1  /* 공급토지상세정보 */
		                       , (SELECT   CODE, CODE_NM FROM   TBCOM_CMMN_CODE WHERE   GRP_CODE = 'LAD003') m1 /* 공급구분 */
		                       , (SELECT   CODE, CODE_NM FROM   TBCOM_CMMN_CODE WHERE   GRP_CODE = 'LAD0A1') m2 /* 납부코드 */
		        WHERE  a1.CNTRCTR_NO = b1.CNTRCTR_NO
	                 AND b1.CANCL_DE IS NULL
	                 AND b1.LAD_CSTMR_NO = c1.LAD_CSTMR_NO                                          
	                 AND b1.LAD_CODE = d1.LAD_CODE
	                 AND b1.LAD_CODE = e1.LAD_CODE
	                 AND b1.BLCK = e1.BLCK
	                 AND b1.LOT = e1.LOT
	                 AND b1.LOT_TY = e1.LOT_TY                                          
	                 <isNotEmpty property="LAD_CODE">
		                   AND b1.LAD_CODE = #LAD_CODE#
		             </isNotEmpty>	
		             <isNotEmpty property="SUPLY_CODE">
		                   AND e1.SUPLY_CODE = #SUPLY_CODE#                   /*공급구분 */
		             </isNotEmpty>			                                    
		              <isNotEmpty property="PRPOS_SE">
		                   AND e1.PRPOS_SE = #PRPOS_SE#		/* 용도구분 */
		              </isNotEmpty>
	                 AND e1.PRPOS_SE = m1.CODE(+)
	                 AND a1.PAY_CODE = m2.CODE(+)                        		                      
             ) 
    SELECT A.*
         , decode(rownum,1, (SELECT COUNT(DISTINCT CNTRCTR_NO) FROM V_LCNTRCTR_UNCAMT B),0) AS TCNT
      FROM V_LCNTRCTR_UNCAMT A                 
             ORDER BY   A.LAD_CODE,
                        A.PRPOS_SE,
                        LPAD (A.BLCK, 3, '0'),
                        LPAD (A.LOT, 3, '0'),
                        LPAD (A.LOT_TY, 2, '0'),
                        A.PAY_CODE

    </select>
    
<!-- 쿼리명 : 토지수납내역조회
	설명 : 토지별 토지수납내역 목록 조회
	수정일  		수정자  	수정내용
	2015.10.08	이상준		최초생성
	작성자 : 이상준
	최초작성일 : 2015.10.08
	-->
    <select id="SLS110104DAO.selectLadRcivAmtList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap" remapResults="true">
    	SELECT A.CNTRCTR_NO                    /* 계약자번호 */
		     , A.LAD_CODE  					   /* 토지코드 */
		     , C.LAD_NM   					   /* 토지명 */
		     , A.BLCK      					   /* 블록 */
		     , A.LOT       /* 롯트 */
		     , D.LOT_TY    /* 구분 */
		     , D.PRPOS_SE  /* 용도코드 */ 
		     , A.CANCL_DE  /*해약자포함여부 */ 
		     , SFCOM_CODE_NM('LAD003',D.PRPOS_SE,'CODE_NM') AS PRPOS_SE_NM   /* 용드구분명 */     
		     , C.LAD_NM || ' ' || DECODE(D.BLCK, NULL,'',D.BLCK || DECODE(D.LOT,NULL, '', '-'|| D.LOT || DECODE(D.LOT_TY, NULL, '', '-'|| D.LOT_TY))) || 
		         DECODE(D.REAL_BLCK, NULL,'','(' || D.REAL_BLCK || DECODE(D.REAL_LOT,NULL, '', '-'|| D.REAL_LOT || DECODE(D.REAL_LOT_TY, NULL, '', '-'|| D.REAL_LOT_TY)) ||')' ) AS BLCK_LOT   /* 블록롯트 */
		     , D.LOCPLC_BASS_ADRES ||' ' || D.LOCPLC_DETAIL_ADRES LAD_ADRES                                /* 즈소 */
		     , (CASE WHEN NVL(D.DCSN_AR,0) = 0 THEN D.BGNN_AR ELSE D.DCSN_AR END) DCSN_AR                  /* 면적(확정면적) */
		     , (CASE WHEN NVL(D.DCSN_AMOUNT,0) = 0 THEN D.BGNN_AMOUNT ELSE D.DCSN_AMOUNT END) DCSN_AMOUNT  /* 분양금액(확정금액) */
		     , P.PAY_CODE                                                                                  /* 납부구분 */
		     , M.CODE_NM AS PAY_CODE_NM                                                                     /* 납부구분명 */ 
		     , P.RCIV_DE                                                                                      			   /* 수납일자 */ 
		     , NVL(P.PAYAMT,0) + NVL(P.RDCAMT_AMOUNT,0) + NVL(P.ARRRG_AMOUNT,0) + NVL(P.PREPAY_DSCNT_AMOUNT,0)  RCIV_AMT   /* 수납금액 */       
		     , B.CSTMR_NM AS CSTMR_NM                                                                                      /* 고객명 */  
		     , DECODE(SFCOM_DEC_ALL(B.IHIDNUM), NULL, '', SFCOM_DEC_ALL(B.IHIDNUM)) AS IHIDNUM/* 주민등록번호 */
		     , B.TELNO                            /* 전화 */
		     , B.MBTLNO                           /* 휴대폰번호 */
		     , B.ZIP                              /* 우편번호 */
		     , B.ADRES                            /* 주소 */
		     , B.ADRES_DETAIL                     /* 상세주소 */
		     , B.ADRES || B.ADRES_DETAIL AS ADRES_ALL    /* 전체주소 */                                          /* 주민번호 */          
		  FROM TBSLS_LCNTRCTR A
		     , TBSLS_LAD_CSTMR B
		     , TBSLS_LAD_INFO C
		     , TBSLS_LAD_DETAIL_INFO D
		     , TBSLS_LCNTRCTR_PAY P
		     , TBCOM_CMMN_CODE M     
		 WHERE A.LAD_CSTMR_NO = B.LAD_CSTMR_NO   
		   AND A.LAD_CODE = C.LAD_CODE 
		   AND A.CNTRCTR_NO = P.CNTRCTR_NO
		   AND A.LAD_CODE = D.LAD_CODE
		   AND A.BLCK     = D.BLCK
		   AND A.LOT      = D.LOT
		   AND A.LOT_TY   = D.LOT_TY       
		   AND M.GRP_CODE = 'HOU0A1'
		   AND M.CODE = P.PAY_CODE
		<isNotEmpty property="LAD_CODE">
		    AND A.LAD_CODE = #LAD_CODE# /* 토지코드 */
		</isNotEmpty>
		<isEqual property="CNTRCTR_STTUS_CODE" compareValue="01">
		    AND A.CANCL_DE IS NULL       /* 해약자포함하지 않음 */   
		</isEqual>
<!-- 		<isEqual property="CNTRCTR_STTUS_CODE" compareValue="02">
		    AND A.CANCL_DE IS NOT NULL   /* 해약자포함 */   
		</isEqual> -->
		<isNotEmpty property="RCIV_DE_FM">
		 <isNotEmpty property="RCIV_DE_TO">
		    AND P.RCIV_DE BETWEEN #RCIV_DE_FM# AND #RCIV_DE_TO# /* 수납일자 */
		 </isNotEmpty>
		</isNotEmpty>
		<isNotEmpty property="PRPOS_SE">
		    AND D.PRPOS_SE = #PRPOS_SE#        /* 용도구분 */
		</isNotEmpty>                                
		ORDER BY  C.LAD_CODE
		         , D.PRPOS_SE
		         , LPAD(A.BLCK, 3, '0')
		         , LPAD(A.LOT, 3, '0')
		         , LPAD(A.LOT_TY, 2, '0')
		         , P.PAY_CODE
		         , A.CANCL_DE 
    </select>  
    
<!-- 쿼리명 : 토지잔금수납내역
	설명 : 토지별 토지잔금수납내역 목록 조회
	수정일  		수정자  	수정내용
	2015.10.08	이상준		최초생성
	작성자 : 이상준
	최초작성일 : 2015.10.08
	-->
    <select id="SLS110104DAO.selectLadPayList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap" remapResults="true">
    	SELECT A.CNTRCTR_NO                    /* 계약자번호 */
		     , A.LAD_CODE                       /* 토지코드 */
		     , C.LAD_NM                         /* 토지명 */
		     , A.BLCK                             /* 블록 */
		     , A.LOT                              /* 롯트 */
		     , A.LOT_TY                              /* 구분 */
		     , C.LAD_NM || ' ' || DECODE(D.BLCK, NULL,'',D.BLCK || DECODE(D.LOT,NULL, '', '-'|| D.LOT || DECODE(D.LOT_TY, NULL, '', '-'|| D.LOT_TY)))
		       || 
		       DECODE(D.REAL_BLCK, NULL,'','(' || D.REAL_BLCK || DECODE(D.REAL_LOT,NULL, '', '-'|| D.REAL_LOT || DECODE(D.REAL_LOT_TY, NULL, '', '-'|| D.REAL_LOT_TY)) ||')' ) AS BLCK_LOT /* 블록롯트 */
		     , D.LOCPLC_BASS_ADRES ||' ' || D.LOCPLC_DETAIL_ADRES LAD_ADRES                             /* 즈소 */
		     , (CASE WHEN NVL(D.DCSN_AR,0) = 0 THEN D.BGNN_AR ELSE D.DCSN_AR END) DCSN_AR               /* 면적(확정면적) */
		     , B.CSTMR_NM AS CSTMR_NM
		     , DECODE(SFCOM_DEC_ALL(B.IHIDNUM), NULL, '', SFCOM_DEC_ALL(B.IHIDNUM)) AS IHIDNUM/* 주민등록번호 */  
		     , P.TPAY_AMT
		     , P.PAY_AMT      /* 납부금액 */
		     , P.RCIV_AMT     /* 수납금액 */
		     , P.PAY_TMLMT    /* 납부기한일 */
		     , P.RCIV_DE      /* 수납일자 */           
		     , E.ISSU_DT    
		     , B.TELNO
		     , B.MBTLNO       
		  FROM TBSLS_LCNTRCTR A
		     , TBSLS_LAD_CSTMR B
		     , TBSLS_LAD_INFO C
		     , TBSLS_LAD_DETAIL_INFO D
		     , (SELECT CNTRCTR_NO, MAX(ISSU_DT) AS ISSU_DT
	              FROM TBPMS_FORMAT_ISSU_LOG
	             WHERE FORMAT_CODE = 'C01'
	          GROUP BY cntrctr_no) E
		     , (SELECT CNTRCTR_NO
		             , MAX(PAY_TMLMT) AS PAY_TMLMT             
		             , SUM( NVL(PAYAMT,0) + NVL(RDCAMT_AMOUNT,0) + NVL(ARRRG_AMOUNT,0) + NVL(PREPAY_DSCNT_AMOUNT,0)) AS TPAY_AMT 
		             , SUM( CASE WHEN PAY_CODE IN('R9','S9') THEN NVL(PAYAMT,0) + NVL(RDCAMT_AMOUNT,0) + NVL(ARRRG_AMOUNT,0) + NVL(PREPAY_DSCNT_AMOUNT,0) ELSE 0 END) AS PAY_AMT     /* 납부금액 */                                                                                                /* 납부금액 */      
		             , SUM( CASE WHEN PAY_CODE IN('R9','S9') 
		                     AND RCIV_DE BETWEEN #RCIV_DE_FM# AND #RCIV_DE_TO# 
		                    THEN NVL(PAYAMT,0) + NVL(RDCAMT_AMOUNT,0) + NVL(ARRRG_AMOUNT,0) + NVL(PREPAY_DSCNT_AMOUNT,0) 
		                    ELSE 0 END) AS RCIV_AMT /* 수납금액 */
		             , MAX( CASE WHEN PAY_CODE IN('R9','S9') 
		                     AND RCIV_DE BETWEEN #RCIV_DE_FM# AND #RCIV_DE_TO# 
		                    THEN RCIV_DE 
		                    ELSE '' END) AS RCIV_DE    /* 수납일자 */          
		          FROM TBSLS_LCNTRCTR_PAY
		         GROUP BY CNTRCTR_NO
		       ) P    
		 WHERE A.LAD_CSTMR_NO = B.LAD_CSTMR_NO   
		   AND A.LAD_CODE = C.LAD_CODE 
		   AND A.CNTRCTR_NO = P.CNTRCTR_NO  
		   AND A.LAD_CODE = D.LAD_CODE
		   AND A.BLCK     = D.BLCK
		   AND A.LOT      = D.LOT
		   AND A.LOT_TY   = D.LOT_TY
		   AND A.CNTRCTR_NO = E.CNTRCTR_NO(+)          
		    <isNotEmpty property="LAD_CODE">
		        AND A.LAD_CODE = #LAD_CODE# /* 토지코드 */
		    </isNotEmpty>
		    <isEqual property="CNTRCTR_STTUS_CODE" compareValue="01">
		        AND A.CANCL_DE IS NULL       /* 해약자포함하지 않음 */   
		    </isEqual>    
		    <isNotEmpty property="PRPOS_SE">
		        AND D.PRPOS_SE = #PRPOS_SE#        /* 용도구분 */
		    </isNotEmpty>  
		   AND P.RCIV_AMT > 0                          
		ORDER BY  C.LAD_CODE
		         , D.PRPOS_SE
		         , LPAD(A.BLCK, 3, '0')
		         , LPAD(A.LOT, 3, '0')
		         , LPAD(A.LOT_TY, 2, '0')
    </select>        
    
     <!-- 쿼리명 : 잔금납부현황조회
	설명 : 토지별 잔금납부현황 목록 조회
	수정일  		수정자  	수정내용
	2015.10.09	이상준		최초생성
	작성자 : 이상준
	최초작성일 : 2015.10.09
	-->
    <select id="SLS110104DAO.selectLadRemndrAmtPaySttusList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
    	WITH V_LCNTRCTR AS		/* 토지 계약자 */
		(
		     <include refid="COM000000.v_sls_lcntrctr_info"/>
		)
		SELECT /* SLS110104DAO.selectLadRemndrAmtPaySttusList 잔금납부현황조회 */
			   a2.CNTRCTR_NO				/* 계약자번호 */
			 /* 잔금정보 */
		     , a2.PAY_TMLMT					/* 납부기한일 */
		     , a2.PAY_CODE					/* 수납코드 */
		     , b2.RCIV_DE					/* 최종수납일 */
		     , a2.PAYAMT					/* 납부금액 */
		     , b2.RCIV_AMOUNT				/* 수납금액 */
		     , a2.TOTAL_PAYAMT				/* 총납부금액(분양금액) */
		     /* 토지정보 */
		     , d2.LAD_CODE					/* 토지코드 */
		     ,SFSLS_LAD_NM(d2.LAD_CODE, 'ALL_LAD_NM') AS ALL_CODE_NM   		/*토지코드명*/ 
		     , e2.LAD_NM					/* 토지명 */
		     , d2.BLCK						/* 블록 */
		     , d2.LOT						/* 롯트 */
		     , d2.LOT_TY					/* 롯트구분 */
		     , d2.LOCPLC_ZIP				/* 소재지우편번호 */
		     , d2.LOCPLC_BASS_ADRES			/* 소재지기본주소 */
		     , d2.LOCPLC_DETAIL_ADRES		/* 소재지상세주소 */
		     , d2.LOCPLC_BASS_ADRES || d2.LOCPLC_DETAIL_ADRES AS LOCPLC_ADRES	/* 소재지주소 */
		     , d2.LOCPLC_ZIP_LNM			/* 소재지우편번호지번 */
		     , d2.LOCPLC_BASS_ADRES_LNM		/* 소재지기본주소지번 */
		     , d2.LOCPLC_DETAIL_ADRES_LNM	/* 소재지상세주소지번 */
		     , d2.LOCPLC_BASS_ADRES_LNM || d2.LOCPLC_DETAIL_ADRES_LNM AS LOCPLC_ADRES_LNM	/* 소재지주소지번 */
		     , NVL(d2.LOCPLC_BASS_ADRES || d2.LOCPLC_DETAIL_ADRES, d2.LOCPLC_BASS_ADRES_LNM || d2.LOCPLC_DETAIL_ADRES_LNM) AS LAD_ADRES	/* 토지주소 */
		     , DECODE(NVL(d2.DCSN_AR,0), 0, d2.BGNN_AR, d2.DCSN_AR) AS DCSN_AR					/* 면적(확정면적) */
		     , DECODE(NVL(d2.DCSN_UNTPC,0), 0, d2.BGNN_UNTPC, d2.DCSN_UNTPC) AS DCSN_UNTPC		/* 분양단가(확정단가) */
		     , DECODE(NVL(d2.DCSN_AMOUNT,0), 0, d2.BGNN_AMOUNT, d2.DCSN_AMOUNT) AS DCSN_AMOUNT	/* 분양금액(확정금액) */
		     , d2.PRPOS_SE					/* 용도구분 */
		     , f2.CODE_NM AS PRPOS_SE_NM	/* 용도구분명 */
		     , c2.SUPLY_SE					/* 공급구분 */
		     , g2.CODE_NM AS SUPLY_SE_NM	/* 공급구분명 */
		     , d2.REMNDR_LAD_SE				/* 토지구분(잔여지구분) */
		     , h2.CODE_NM AS REMNDR_LAD_SE_NM	/* 토지구분(잔여지구분)명 */
		     /* 계약정보 */
		     , c2.LAD_CSTMR_NO				/* 토지고객번호(SQ_TBSLS_LAD_CSTMR_1) */
		     , c2.CSTMR_NM						/* 성명 */
		     , DECODE(SFCOM_DEC_ALL(c2.IHIDNUM), NULL, '', SFCOM_DEC_ALL(c2.IHIDNUM)) AS IHIDNUM	/* 주민등록번호 */
		     , c2.ZIP						/* 우편번호 */
		     , c2.ADRES						/* 주소 */
		     , c2.ADRES_DETAIL				/* 주소_상세 */
		     , c2.ADRES || c2.ADRES_DETAIL AS ADRES_ALL	/* 전체주소 */
		     , c2.TELNO						/* 전화번호 */
		     , c2.MBTLNO					/* 휴대폰번호 */
		  FROM (SELECT a1.CNTRCTR_NO
		             , a1.PAY_TMLMT
		             , 'S9' AS PAY_CODE
		             , SUM(a1.PAYAMT) AS PAYAMT
		             , SUM(a1.TOTAL_PAYAMT) AS TOTAL_PAYAMT
		          FROM (SELECT a.CNTRCTR_NO
		                     , MAX(DECODE(b.ROW_NUM, 1, a.PAY_TMLMT, '')) AS PAY_TMLMT
		                     , DECODE(b.ROW_NUM, 1, a.PAY_CODE, 'S9') AS PAY_CODE
		                     , SUM(DECODE(b.ROW_NUM, 1, NVL(a.PAYAMT, 0), 0)) AS PAYAMT
		                     , SUM(DECODE(b.ROW_NUM, 1, 0, NVL(a.PAYAMT, 0))) AS TOTAL_PAYAMT
		                  FROM (SELECT CNTRCTR_NO		/* 계약자납부 */
		                             , PAY_TMLMT		/* 납부기한일 */
		                             , DECODE(PAY_CODE, 'R9', 'S9', PAY_CODE) AS PAY_CODE	/* 납부코드 */
		                             , NVL(PAYAMT, 0) + NVL(INSTLMT_INTR, 0) + NVL(ARRRG_AMOUNT, 0) + NVL(PREPAY_DSCNT_AMOUNT, 0) AS PAYAMT	/* 납부금액 : 납부금액 + 할부이자 + 연체금액 + 선납할인금액 */
		                          FROM TBSLS_LCNTRCTR_PAY	/* 토지계약자납부 : lnt_ct_vote : 계약자 납부정보(일반) */
		                       ) a
		                     , (SELECT ROWNUM AS ROW_NUM
		                          FROM USER_TABLES
		                       <![CDATA[
		                         WHERE ROWNUM <= 2
		                       ]]>
		                       ) b
		                 GROUP BY a.CNTRCTR_NO
		                        , DECODE(b.ROW_NUM, 1, a.PAY_CODE, 'S9')
		               ) a1
		         WHERE a1.PAY_CODE = 'S9'
		         GROUP BY a1.CNTRCTR_NO
		                , a1.PAY_TMLMT
		  	   ) a2
		     , (SELECT c.CNTRCTR_NO
		           	 , MAX(c.RCIV_DE) AS RCIV_DE
		             , 'S9' AS PAY_CODE
		             , SUM(NVL(c.RCIV_AMOUNT, 0)) AS RCIV_AMOUNT
		          FROM TBSLS_LAD_RCIV_PSTMRK c	/* 토지수납 : lnt_ct_receipt 계약자 수납정보_징수 */
		         WHERE 1 = 1
				   <isNotEmpty property="RCIV_DE_FM">
				     <isNotEmpty property="RCIV_DE_TO">
				       AND c.RCIV_DE BETWEEN #RCIV_DE_FM# AND #RCIV_DE_TO#
				     </isNotEmpty>
				   </isNotEmpty>		         
		           AND c.PAY_CODE IN ('S9', 'R9')
		         GROUP BY c.CNTRCTR_NO
		       ) b2
			 , V_LCNTRCTR c2				/* 토지계약자정보 LNT_CT_INFO 계약자정보 */
		     , TBSLS_LAD_DETAIL_INFO d2		/* 토지상세정보 LNT_LN_INFOMST 공급토지상세정보 */
		     , TBSLS_LAD_INFO e2			/* 토지정보 */
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD003'	/* 토지용도구분 */
		       ) f2
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD004'	/* 공급구분 */
		       ) g2
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD0A2'	/* 잔여토지구분 */
		       ) h2
		 WHERE 1 = 1
		   AND a2.CNTRCTR_NO = b2.CNTRCTR_NO
		   AND a2.CNTRCTR_NO = c2.CNTRCTR_NO
		   AND d2.LAD_CODE = c2.LAD_CODE
		   AND d2.BLCK = c2.BLCK
		   AND d2.LOT = c2.LOT
		   AND d2.LOT_TY = c2.LOT_TY
		   AND e2.LAD_CODE = d2.LAD_CODE
		   AND d2.PRPOS_SE = f2.CODE(+)
   		   AND c2.SUPLY_SE = g2.CODE(+)
           AND d2.REMNDR_LAD_SE = h2.CODE(+)
		   AND c2.CANCL_DE IS NULL
		 <isNotEmpty property="LAD_CODE">
		   AND c2.LAD_CODE = #LAD_CODE#		/* 토지코드 */
		 </isNotEmpty>		   
		 <isNotEmpty property="CNTRCT_STTUS">
		   AND c2.CNTRCT_TY = #CNTRCT_STTUS#	/* 계약자_계약타입(상태) */
		 </isNotEmpty>		
		 <isNotEmpty property="CSTMR_NM">
		   AND c2.CSTMR_NM LIKE '%'||#CSTMR_NM#||'%'		/* 성명 */
		 </isNotEmpty>
		 <isNotEmpty property="PRPOS_SE">
		   AND d2.PRPOS_SE = #PRPOS_SE#			/* 용도구분 */
		 </isNotEmpty>
		 <isNotEmpty property="REMNDR_LAD_SE">
		   AND d2.REMNDR_LAD_SE = #REMNDR_LAD_SE#	/* 토지구분(잔여토지구분) */
		 </isNotEmpty>
		   AND NOT EXISTS (SELECT 1
		                     FROM TBSLS_LCNTRCTR_PAY x	/* 토지계약자납부 : lnt_ct_vote : 계약자 납부정보(일반) */
		                    WHERE x.CNTRCTR_NO = a2.CNTRCTR_NO
		                      AND x.PAY_CODE IN ('S9', 'R9')
		                      AND NOT EXISTS (SELECT 1
		                                        FROM TBSLS_LAD_RCIV_PSTMRK y	/* 토지수납 : lnt_ct_receipt 계약자 수납정보_징수 */
		                                       WHERE y.CNTRCTR_NO = x.CNTRCTR_NO
		                                         AND y.PAY_NO = x.PAY_NO))
		 ORDER BY d2.LAD_CODE
			    , d2.PRPOS_SE
		 		, LPAD(d2.BLCK, 3, '0')
		        , LPAD(d2.LOT, 3, '0')
		        , LPAD(d2.LOT_TY, 2, '0')
    </select>
 
    
    <!-- 쿼리명 : 수납내역(수납일기준)조회
	설명 : 토지별 수납내역(수납일기준) 목록 조회
	수정일  		수정자  	수정내용
	2015.10.10	이상준		최초생성
	작성자 : 이상준
	최초작성일 : 2015.10.10
	-->
    <select id="SLS110104DAO.selectLadRcivDtlsRcivDtList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap" remapResults="true">
    	SELECT /* SLS110104DAO.selectLadRcivDtlsRcivDtList 수납내역(수납일기준) 조회 */
			   a1.CNTRCTR_NO				/* 계약자번호 */
		     /* 토지정보 */
		     , a1.LAD_CODE					/* 토지코드 */
		     , b1.LAD_NM					/* 토지명 */
		     , a1.BLCK						/* 블록 */
		     , a1.LOT						/* 롯트 */
		     , a1.LOT_TY					/* 롯트구분 */
		     , LPAD(a1.BLCK, 3,'0')||LPAD(a1.LOT, 3, '0')||LPAD(a1.LOT_TY, 2, '0') AS BLCK_SUM	/* 조회용 B.L.T 값 */
		     , c1.PRPOS_SE					/* 용도구분 */
		     , e1.CODE_NM AS PRPOS_SE_NM	/* 용도구분명 */
		     , c1.LOCPLC_ZIP				/* 소재지우편번호 */
		     , c1.LOCPLC_BASS_ADRES			/* 소재지기본주소 */
		     , c1.LOCPLC_DETAIL_ADRES		/* 소재지상세주소 */
		     , c1.LOCPLC_BASS_ADRES || c1.LOCPLC_DETAIL_ADRES AS LOCPLC_ADRES	/* 소재지주소 */
		     , c1.LOCPLC_ZIP_LNM			/* 소재지우편번호지번 */
		     , c1.LOCPLC_BASS_ADRES_LNM		/* 소재지기본주소지번 */
		     , c1.LOCPLC_DETAIL_ADRES_LNM	/* 소재지상세주소지번 */
		     , c1.LOCPLC_BASS_ADRES_LNM || c1.LOCPLC_DETAIL_ADRES_LNM AS LOCPLC_ADRES_LNM	/* 소재지주소지번 */
		     , NVL(c1.LOCPLC_BASS_ADRES || c1.LOCPLC_DETAIL_ADRES, c1.LOCPLC_BASS_ADRES_LNM || c1.LOCPLC_DETAIL_ADRES_LNM) AS LAD_ADRES	/* 토지주소 */
		     , DECODE(NVL(c1.DCSN_AR,0), 0, c1.BGNN_AR, c1.DCSN_AR) AS DCSN_AR					/* 면적(확정면적) */
		     , DECODE(NVL(c1.DCSN_UNTPC,0), 0, c1.BGNN_UNTPC, c1.DCSN_UNTPC) AS DCSN_UNTPC		/* 분양단가(확정단가) */
		     , DECODE(NVL(c1.DCSN_AMOUNT,0), 0, c1.BGNN_AMOUNT, c1.DCSN_AMOUNT) AS DCSN_AMOUNT	/* 분양금액(확정금액) */
		     , c1.RM						/* 비고 */
		     /* 납부정보 */
		     , a1.PAY_CODE					/* 납부코드 */
		     , f1.CODE_NM AS PAY_CODE_NM	/* 납부코드명 */
		     , a1.RCIV_DE					/* 수납일자 */
		     , a1.RCIV_AMOUNT				/* 수납금액 */
		     /* 계약정보 */
		     , a1.LAD_CSTMR_NO 				/* 토지고객번호 */
		     , d1.CSTMR_NM						/* 성명 */
		     , DECODE(SFCOM_DEC_ALL(d1.IHIDNUM), NULL, '', SFCOM_DEC_ALL(d1.IHIDNUM)) AS IHIDNUM	/* 주민등록번호 */
		     , d1.TELNO						/* 전화번호 */
		     , d1.MBTLNO					/* 핸드폰번호 */
		     , d1.ZIP						/* 우편번호 */
		     , d1.ADRES						/* 주소 */
		     , d1.ADRES_DETAIL				/* 상세주소 */
		     , d1.ADRES || d1.ADRES_DETAIL AS ADRES_ALL	/* 전체주소 */
		  FROM (SELECT a.CNTRCTR_NO			/* 계약자번호 */
		             , b.LAD_CSTMR_NO		/* 토지고객번호 */
		             , c.LAD_CODE
		             , c.BLCK
		             , c.LOT
		             , c.LOT_TY
		             , a.RCIV_DE
		             , a.PAY_CODE
		             , SUM(a.RCIV_AMOUNT) AS RCIV_AMOUNT
		          FROM (
					  <isEqual property="STDDE_SE" compareValue="01">
		          		/* 기준일구분(STDDE_SE) : 수납일(01) */
		          		SELECT CNTRCTR_NO
		                     , PAY_NO
		                     , RCIV_DE
		                     , PAY_CODE
		                     , RCIV_AMOUNT
		                  FROM TBSLS_LAD_RCIV_PSTMRK		/* 토지수납 : LNT_CT_RECEIPT 계약자 수납정보_징수 */
		                 WHERE CNTRCTR_NO IS NOT NULL
		                   AND PAY_NO IS NOT NULL
		                   AND RCIV_AMOUNT > 0
		                   AND RCIV_DE BETWEEN #RCIV_DE_FM# AND #RCIV_DE_TO#
					  </isEqual>
					  <isEqual property="STDDE_SE" compareValue="02">
		                /* 기준일구분(STDDE_SE) : 기타고지(02) */
		                 SELECT y.CNTRCTR_NO
                             , y.PAY_NO
                             , y.RCIV_DE
                             , y.PAY_CODE
                             , y.RCIV_AMOUNT
                          FROM TBSLS_ETC_INCME_PAY y    /* 기타수입납부 : LNT_ETC_VOTE 계약자 기타납부정보 */
                         WHERE y.JOB_SE = 'LAD'                         
                           AND y.RCIV_DE BETWEEN #RCIV_DE_FM#  AND  #RCIV_DE_TO#
					  </isEqual>
		               ) a
		             , TBSLS_LCNTRCTR b				/* 토지계약자 */
		             , TBSLS_LAD_DETAIL_INFO c		/* LNT_LN_INFOMST 공급토지상세정보 */
		         WHERE 1 = 1
		           AND a.CNTRCTR_NO = b.CNTRCTR_NO
		           
		         <isNotEmpty property="LAD_CODE">
		           AND b.LAD_CODE = #LAD_CODE#
		         </isNotEmpty>
		         <isNotEmpty property="CNTRCT_STTUS">
		           AND b.CNTRCT_TY = #CNTRCT_STTUS#	/* 계약자_계약타입(상태) */
		         </isNotEmpty>
		         <isNotEmpty property="PRPOS_SE">
		           AND c.PRPOS_SE = #PRPOS_SE#		/* 토지상세_용도구분 */
		         </isNotEmpty>
		         <isEqual property="CANCL_SE" compareValue="N">
		           /* 해약자조회구분(CANCL_SE) : N 계약자만 , Y 해약자포함 */
		           AND b.CANCL_DE IS NULL
		         </isEqual>
		           AND c.LAD_CODE = b.LAD_CODE
		           AND c.BLCK = b.BLCK
		           AND c.LOT = b.LOT
		           AND c.LOT_TY = b.LOT_TY
		         GROUP BY a.CNTRCTR_NO
		                , b.LAD_CSTMR_NO
		                , c.LAD_CODE
		                , c.BLCK
		                , c.LOT
		                , c.LOT_TY
		                , a.PAY_CODE
		                , a.RCIV_DE
		       ) a1
		     , TBSLS_LAD_INFO b1			/* 토지정보 */
		     , TBSLS_LAD_DETAIL_INFO c1		/* 토지상세정보 : LNT_LN_INFOMST 공급토지상세정보 */
		     , TBSLS_LAD_CSTMR d1			/* 토지고객 */
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD003'	/* 토지용도구분 */
		       ) e1
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD0A1'	/* 납부구분 */
		       ) f1
		 WHERE 1 = 1
		   AND a1.LAD_CODE = b1.LAD_CODE
		   AND a1.LAD_CODE = c1.LAD_CODE
		   AND a1.BLCK = c1.BLCK
		   AND a1.LOT = c1.LOT
		   AND a1.LOT_TY = c1.LOT_TY
		   AND a1.LAD_CSTMR_NO = d1.LAD_CSTMR_NO
		   AND c1.PRPOS_SE = e1.CODE(+)
		   AND a1.PAY_CODE = f1.CODE(+)
		 <isNotEmpty property="CSTMR_NM">
		   AND d1.CSTMR_NM LIKE '%'||#CSTMR_NM#||'%'
		 </isNotEmpty>
		 ORDER BY a1.LAD_CODE
		 		, LPAD(a1.BLCK, 3, '0')
		        , LPAD(a1.LOT, 3, '0')
		        , LPAD(a1.LOT_TY, 2, '0')
		        , a1.PAY_CODE
    </select>
    
    <!-- 쿼리명 : 수납내역(수납실적)조회
	설명 : 토지별 수납내역(수납실적) 목록 조회
	수정일  		수정자  	수정내용
	2015.10.10	이상준		최초생성
	작성자 : 이상준
	최초작성일 : 2015.10.10
	-->
    <select id="SLS110104DAO.selectLadRcivDtlsRcivAcmsltList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
    	WITH V_IN_SALE_PLAN AS	/* 수납실적 */
		(
		  SELECT a1.CNTRCTR_NO			/* 계약자번호 */
		       , a1.LAD_CSTMR_NO		/* 토지고객번호 */
		       , a1.CNTRCT_DE			/* 계약일자 */
		       , a1.CANCL_DE			/* 해약일자 */
		       , a1.LAD_CODE			/* 토지코드 */
		       , a1.BLCK				/* 블록 */
		       , a1.LOT					/* 롯트 */
		       , a1.LOT_TY				/* 롯트구분 */
		       , a1.PRPOS_SE			/* 용도구분 */
		       , a1.PAY_CODE			/* 납부코드 */
		       , a1.PAY_TMLMT			/* 납부기한일 */
		       , a1.RCIV_DE				/* 수납일자 */
		       , a1.PAYAMT				/* 납부금액 */
		       , a1.PREPAY_DSCNT_AMOUNT	/* 선납할인금액 */
		       , a1.ARRRG_AMOUNT		/* 연체금액 */
		       , a1.LAD_AR				/* 토지_면적 */
		       , a1.SUPLY_CODE			/* 공급코드 */
		       , a1.CNTRCT_STTUS		/* 계약상태 */
		       , CASE WHEN a1.RCIV_DE IS NOT NULL
		              THEN a1.PAYAMT + NVL(a1.PREPAY_DSCNT_AMOUNT, 0) + NVL(a1.ARRRG_AMOUNT, 0)
		              ELSE 0
		         END AS RCIV_AMOUNT		/* 수납금액 */
		       , a1.DCSN_AR				/* 확정면적 */
		       , a1.DCSN_UNTPC			/* 확정단가 */
		       , a1.DCSN_AMOUNT			/* 확정금액 */
		    FROM (SELECT a.CNTRCTR_NO		/* 계약자번호 */
		               , a.LAD_CSTMR_NO		/* 토지고객번호 */
		               , a.CNTRCT_DE		/* 계약일자 */
		               , a.CANCL_DE			/* 해약일자 */
		               , a.LAD_CODE			/* 토지코드 */
		               , a.BLCK				/* 블록 */
		               , a.LOT				/* 롯트 */
		               , a.LOT_TY			/* 롯트구분 */
		               , b.PRPOS_SE			/* 용도구분 */
		               , c.PAY_CODE			/* 납부코드 */
		               , c.PAY_TMLMT		/* 납부기한일 */
		               , (SELECT x.RCIV_DE
		                    FROM TBSLS_LAD_RCIV_PSTMRK x /* 토지수납 : lnt_ct_receipt 계약자 수납정보_징수 */
		                   WHERE x.CNTRCTR_NO = c.CNTRCTR_NO
		                     AND x.PAY_NO = c.PAY_NO
		                 ) AS RCIV_DE								/* 수납일자 */
		               , c.PAYAMT									/* 납부금액 */
		               , c.PREPAY_DSCNT_AMOUNT						/* 선납할인금액 */
		               , c.ARRRG_AMOUNT								/* 연체금액 */
		               , CASE WHEN c.PAY_CODE IN ('R0', 'S0')
		                      THEN DECODE(NVL(b.DCSN_AR, 0), 0, b.BGNN_AR, b.DCSN_AR)
		                      ELSE 0
		                 END AS LAD_AR								/* 토지_면적 */
		               , NVL(b.SUPLY_CODE, '00') AS SUPLY_CODE		/* 공급코드 */
		               , NVL(b.CNTRCT_STTUS, NVL (a.CNTRCT_TY, 'SL')) AS CNTRCT_STTUS	/* 계약상태 */
		               , DECODE(NVL(b.DCSN_AR, 0), 0, b.BGNN_AR, b.DCSN_AR) AS DCSN_AR					/* 확정면적 */
		               , DECODE(NVL(b.DCSN_UNTPC, 0), 0, b.BGNN_UNTPC, b.DCSN_UNTPC) AS DCSN_UNTPC		/* 확정단가 */
		               , DECODE(NVL(b.DCSN_AMOUNT, 0), 0, b.BGNN_AMOUNT, b.DCSN_AMOUNT) AS DCSN_AMOUNT	/* 확정금액 */
		            FROM TBSLS_LCNTRCTR a			/* 토지계약자 : lnt_ct_info 계약자정보 */
		               , TBSLS_LAD_DETAIL_INFO b	/* 토지상세정보 : lnt_ln_infomst 공급토지상세정보 */
		               , TBSLS_LCNTRCTR_PAY c		/* 토지계약자납부 : lnt_ct_vote 계약자 납부정보(일반) */
		               , TBSLS_LAD_INFO d			/* 토지정보 : lnt_ln_code 토지코드정보 */
		           WHERE 1 = 1
		             AND a.LAD_CODE = b.LAD_CODE
		             AND a.BLCK = b.BLCK
		             AND a.LOT = b.LOT
		             AND a.LOT_TY = b.LOT_TY
		             AND a.CANCL_DE IS NULL
		             AND a.CNTRCTR_NO = c.CNTRCTR_NO
		           <![CDATA[
		             AND c.PAY_CODE <> 'RN'
		           ]]>
		             AND c.PAYAMT > 0
		             AND d.LAD_CODE = b.LAD_CODE
		             AND d.USE_AT = 1
		         ) a1
		)
		SELECT /* SLS110104DAO.selectLadRcivDtlsRcivAcmsltList 수납내역(수납실적) 조회 */
			   a.CNTRCTR_NO				/* 계약자번호 */
			 /* 토지정보 */
		     , a.LAD_CODE				/* 토지코드 */
			 , b.LAD_NM					/* 토지명 */
		     , a.BLCK					/* 블록 */
		     , a.LOT					/* 롯트 */
		     , a.LOT_TY					/* 롯트구분 */
		     , LPAD(a.BLCK, 3,'0')||LPAD(a.LOT, 3, '0')||LPAD(a.LOT_TY, 2, '0') AS BLCK_SUM	/* 조회용 B.L.T 값 */
		     , a.PRPOS_SE				/* 용도구분 */
		     , d.CODE_NM AS PRPOS_SE_NM	/* 용도구분명 */
		     , a.DCSN_AR				/* 확정면적 */
		     , a.DCSN_UNTPC				/* 확정단가 */
		     , a.DCSN_AMOUNT			/* 확정금액 */
			 /* 계약정보 */
		     , a.LAD_CSTMR_NO			/* 토지고객번호 */
		     , c.CSTMR_NM						/* 성명 */
		     , c.TELNO					/* 전화번호 */
		     , c.MBTLNO					/* 휴대폰번호 */
		     , a.SUPLY_CODE				/* 공급구분 */
		     , e.CODE_NM AS SUPLY_CODE_NM	/* 공급구분명 */
		     /* 납부정보 */
		     , a.PAY_CODE				/* 납부코드 */
		     , f.CODE_NM AS PAY_CODE_NM	/* 납부코드명 */
		     , a.PAY_TMLMT				/* 납부기한일 */
		     , a.PAYAMT					/* 납부금액 */
		     , a.PREPAY_DSCNT_AMOUNT	/* 선납할인금액 */
		     , a.ARRRG_AMOUNT			/* 연체이자 */
		     /* 수납정보 */
		     , a.RCIV_DE				/* 수납일자 */
		     , a.RCIV_AMOUNT			/* 수납금액 */
		  FROM V_IN_SALE_PLAN a
		     , TBSLS_LAD_INFO b			/* 토지정보 */
		     , TBSLS_LAD_CSTMR c		/* 토지고객 */
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD003'	/* 토지용도구분 */
		           AND NVL(CHRCTR_PREPAR_VALUE_1, '0') = '1'
		       ) d
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD004'	/* 공급구분 */
		       ) e
		     , (SELECT CODE
		             , CODE_NM
		          FROM TBCOM_CMMN_CODE
		         WHERE GRP_CODE = 'LAD0A1'	/* 납부구분 */
		       ) f
		 WHERE 1 = 1
		   AND a.LAD_CODE = b.LAD_CODE
		   AND a.LAD_CSTMR_NO = c.LAD_CSTMR_NO
		   AND a.PRPOS_SE = d.CODE(+)
		   AND a.SUPLY_CODE = e.CODE(+)
		   AND a.PAY_CODE = f.CODE(+)
		 <![CDATA[
		   AND a.SUPLY_CODE <> '11'		/* 공급코드 : 자체공급 */
		 ]]>
		   AND a.CNTRCT_STTUS = 'SL'	/* 계약상태 : 분양(SL)고정 */
		   /* 조회조건 */
		   AND a.LAD_CODE = #LAD_CODE#
		 <isNotEmpty property="PRPOS_SE">
	       AND a.PRPOS_SE = #PRPOS_SE#
		 </isNotEmpty>
		 <isNotEmpty property="SUPLY_CODE">
		   AND a.SUPLY_CODE = #SUPLY_CODE#
		 </isNotEmpty>
		   AND a.CNTRCT_DE BETWEEN #CNTRCT_DE_FM# AND #CNTRCT_DE_TO#	/* 계약일자 */
		   AND a.RCIV_DE BETWEEN #RCIV_DE_FM# AND #RCIV_DE_TO#			/* 수납일자 */
		  ORDER BY a.LAD_CODE
		 		, LPAD(a.BLCK, 3, '0')
		        , LPAD(a.LOT, 3, '0')
		        , LPAD(a.LOT_TY, 2, '0')
		        , a.PAY_CODE
		        , a.RCIV_DE
    </select>
    
</sqlMap>