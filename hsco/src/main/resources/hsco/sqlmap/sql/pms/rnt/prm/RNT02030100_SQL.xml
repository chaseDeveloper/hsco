<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="RNT02030100_SQL">	

	<!-- 쿼리명 : 매입임대 고객정보 조회
			 설명 : 매입임대 고객정보 조회 쿼리
		  수정일 : 수정자  수정내용	
		  작성자 : 변승우
	 최초작성일 : 2015.10.30
	-->
	<select id="RNT02030100DAO.selectPuchasRentCntrctList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT DISTINCT
					A.RENT_HOUSE_CODE
					,B.PUCHAS_CSTMR_NO
					,B.CNTRCTR_NO
					,A.RENT_HOUSE_NM
					,B.DONG
					,B.HO
					,C.NM
					/*,D.RCEPT_DE*/
					,B.CANCL_DE
					,C.TELNO
					,C.MBTLNO
					, (
			         CASE
			                  WHEN B.CNTRCT_CO = 1
			                  THEN 'Y'
			                  ELSE ''
			         END) AS NEW_SE
			        ,B.RM
		FROM		TBRNT_PUCHAS_HOUSE A
					,TBRNT_PUCHAS_CNTRCT B
					,TBRNT_PUCHAS_RENT_CSTMR C
					/*,TBRNT_PUCHAS_RESCI D*/
          			,TBRNT_PUCHAS_SEIZR E					
		WHERE	A.RENT_HOUSE_CODE		=	B.RENT_HOUSE_CODE
		AND		B.PUCHAS_CSTMR_NO	=	C.PUCHAS_CSTMR_NO
    	AND  		B.CNTRCTR_NO        = E.CNTRCTR_NO(+)		
		/*AND		B.CNTRCTR_NO				=	D.CNTRCTR_NO(+)*/
		AND		A.HOUSE_SE					=	'R2'
		<isNotEmpty property="canclSe">
		AND		DECODE(B.CANCL_DE, NULL,'1','0')	LIKE	#canclSe#
		</isNotEmpty>
		<isNotEmpty property="seizureRgt">
			<isNotEqual property="seizureRgt" compareValue="0">
				AND   E.SN IS NOT NULL
			</isNotEqual>
		</isNotEmpty>
		<isNotEmpty property="houseCode">
			AND	A.RENT_HOUSE_CODE		LIKE	#houseCode#
		</isNotEmpty>
		<isNotEmpty property="dong">
			AND	B.DONG	= LPAD(#dong#, 4, '0')
		</isNotEmpty>
		<isNotEmpty property="ho">
			AND	B.HO	= LPAD(#ho#, 4, '0')
		</isNotEmpty>
		<isNotEmpty property="nm">
			AND	C.NM	LIKE	'%' || #nm# || '%'
		</isNotEmpty>
		<isNotEmpty property="CSTMR_NO">
			AND	B.PUCHAS_CSTMR_NO	=	#CSTMR_NO#
		</isNotEmpty>
			ORDER	BY A.RENT_HOUSE_CODE,	DONG,	HO
	</select>	



	<!-- 쿼리명 : 매입임대 고객정보 상세사항 조회
			 설명 : 매입임대 고객정보 상세사항 조회 쿼리
		  수정일 : 수정자  수정내용	
		  작성자 : 변승우
	 최초작성일 : 2015.11.02
	-->
	<select id="RNT02030100DAO.selectPuchasRentCntrctDetailList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">	
		SELECT
					A.CNTRCTR_NO													/*계약자번호*/
					,A.RENT_HOUSE_CODE												/*임대주택코드*/
					,A.DONG															/*동*/
					,A.HO															/*호*/
					,NVL(A.HOUSE_POSESN_AT, '0') AS HOUSE_POSESN_AT					/*주택소유여부*/
					,A.FAMILY_CO													/*가족수*/
					,A.FRST_CNTRCT_DE												/*최초계약일*/
					,A.CNTRCT_DE													/*계약일자*/
					,NVL(A.DEATH_AT, '0') AS DEATH_AT								/*사망여부*/
					,NVL(A.TROBL_AT, '0') AS TROBL_AT								/*장애여부*/
					,NVL(A.LWST_PROGRS_AT, '0') AS LWST_PROGRS_AT					/*소송진행여부*/
					,A.INCOME_EXCESS												/*소득초과여부*/
					,A.RM															/*비고*/
					,A.RENT_BGNDE													/*임대시작일자*/
					,A.RENT_ENDDE													/*임대종료일자*/
					/*,A.RENT_BGNDE_2	*/											/*임대시작일자2*/
					/*,A.RENT_ENDDE_2 */											/*임대종료일자2*/
					,A.QUALF_SE														/*자격구분*/
					/*,A.PAY_TMLMT */												/*납부기한*/
					/*,A.RCIV_DE	*/												/*수납일자*/
					,NVL(A.RNTCHRG, 0) AS RNTCHRG									/*월임대료*/
					/*,A.SURLUS	*/													/*잔금*/
					/*,A.CNTRCT_AMOUNT		*/										/*계약금*/
					/*,A.SURLUS + A.CNTRCT_AMOUNT AS GTN */							/*보증금*/
					,NVL(A.GTN, 0) AS GTN											/*보증금*/
					,A.NPYM_INTR_EXEMPT_AT											/*체납이자면제*/
					/*,A.RECPTN_CHRGE_EXEMPT_AT */									/*수신료면제*/
					,A.MANAGECT_RDCXPT_AT											/*관리비감면*/
					/*,A.RNTCHRG_PREPAY_RQEST_AT	*/								/*임대료선납청구여부*/
					/*,A.RNTCHRG_PREPAY_RQEST_CYCLE*/								/*임대료선납청구주기*/
					,B.RENT_HOUSE_NM												/*임대주택명*/
					,B.ADRES || ' ' || B.ADRES_DETAIL AS RENT_HOUSE_ADRES			/*소재지 주소*/
					,B.ADRES														/*소재지 주소*/
					,C.FLOOR														/*층*/
					,C.DVR_AR														/*전용면적*/
					,C.CMNUSE_AR													/*공용면적*/
					,(C.CMNUSE_AR + C.DVR_AR) AS TOT_AR								/*총면적*/
					,C.ROOM_STRUCTURE												/*방구조(룸형태)*/
					,SFCMP_GET_CODENM('RNT027', C.ROOM_STRUCTURE) AS ROOM_STRUCTURE_NM	/*방구조명*/
					,B.ENTRC_PASSWORD												/*출입구비밀번호*/
					,C.HSHLD_PASSWORD												/*세대비밀번호*/
					,A.MANAGECT_PRECDNT												/*관리비선수금*/
					,D.NM															/*계약자명*/
					,SFCOM_DEC_ALL(D.IHIDNUM) AS IHIDNUM							/*주민번호*/
					,D.TELNO														/*전화번호*/
					,D.MBTLNO														/*휴대폰번호*/
					,E.CANCL_DE														/*해약일자*/
					,NVL(G.CDIT_AMOUNT, 0) AS CDIT_AMOUNT							/*압류금액*/
					,H.NM_CHANGE_DE													/*명의변경일자*/
					,I.QUALF_CHANGE_DE												/*자격변경일자*/
					,J.HOUSE_CHANGE_DE												/*동호변경일자*/
					,C.KEY_AT														/*열쇠여부*/
					,B.CLN_CT_LEVY_AT												/*청소용역여부*/
					,A.PUCHAS_CSTMR_NO												/*매입고객번호*/
		          ,B.RENT_HOUSE_NM || ' ' || A.HO || '호' AS ADDR
		          ,SUBSTR(A.CNTRCT_DE, 1, 4) AS YYYY
		          ,SUBSTR(A.CNTRCT_DE, 5, 2) AS MM
		          ,SUBSTR(A.CNTRCT_DE, 7, 8) AS DD	
       			  ,SFCMP_GET_CODENM('RNT008', C.FLOOR) AS FLOOR_NM					/*층구분*/
       			  ,B.HOUSE_SE
       			  ,D.ADRES || ' ' || D.ADRES_DETAIL AS CSTMR_ADRES
		FROM		TBRNT_PUCHAS_CNTRCT A
					,TBRNT_PUCHAS_HOUSE B
					,TBRNT_PUCHAS_HOUSE_BILD C
					,TBRNT_PUCHAS_RENT_CSTMR D
					,(SELECT
								CNTRCTR_NO
								,MAX(CANCL_DE)	AS	CANCL_DE
					  FROM	TBRNT_PUCHAS_RESCI
					  GROUP	BY	CNTRCTR_NO
					  )E
					,(SELECT
								CNTRCTR_NO
								,SUM(CDIT_AMOUNT)	AS	CDIT_AMOUNT
					  FROM	TBRNT_PUCHAS_SEIZR
					  WHERE RELIS_DE IS NULL
					  GROUP	BY	CNTRCTR_NO
					  )G
					,(SELECT
								CNTRCTR_NO
								,MAX(CHANGE_DE)	AS	NM_CHANGE_DE
					  FROM	TBRNT_PUCHAS_NM_CHANGE
					  GROUP	BY	CNTRCTR_NO
					  )H
					,(SELECT
								CNTRCTR_NO
								,MAX(CHANGE_DE)	AS	 QUALF_CHANGE_DE
					  FROM	TBRNT_PUCHAS_QUALF_CHANGE
					  GROUP	BY	CNTRCTR_NO
					  )I
					,(SELECT
								CNTRCTR_NO
								,MAX(CHANGE_DE)	AS	HOUSE_CHANGE_DE
					  FROM	TBRNT_PUCHAS_HOUSE_CHANGE
					  GROUP BY CNTRCTR_NO
					  )J
		WHERE	A.CNTRCTR_NO	=	#CNTRCTR_NO#
		AND	A.RENT_HOUSE_CODE	=	B.RENT_HOUSE_CODE
		AND	C.RENT_HOUSE_CODE	=	A.RENT_HOUSE_CODE
		AND	C.DONG				=	A.DONG
		AND	C.HO				=	A.HO
		AND	D.PUCHAS_CSTMR_NO	=	A.PUCHAS_CSTMR_NO
		AND	A.CNTRCTR_NO		=	E.CNTRCTR_NO(+)
		AND	A.CNTRCTR_NO		=	G.CNTRCTR_NO(+)
		AND	A.CNTRCTR_NO		=	H.CNTRCTR_NO(+)
		AND	A.CNTRCTR_NO		=	I.CNTRCTR_NO(+)
		AND	A.CNTRCTR_NO		=	J.CNTRCTR_NO(+)	
	</select>



	<!-- 쿼리명 : 매입임대 고객정보 상세사항 수정
			설명 : 매입임대 고객정보 상세사항 수정 쿼리
		  수정일 : 수정자  수정내용	
		  작성자 : 변승우
	 최초작성일 : 2015.11.05
	-->
	<update id="RNT02030100DAO.savePuchasRentCntrctU" parameterClass="java.util.HashMap">
		UPDATE TBRNT_PUCHAS_CNTRCT SET														/*매입계약 테이블*/
					HOUSE_POSESN_AT	 =	#HOUSE_POSESN_AT#									/*주택유무*/
					,FAMILY_CO	=	#FAMILY_CO#												/*가족수*/
					,FRST_CNTRCT_DE = #FRST_CNTRCT_DE#										/*최초계약일*/
					,CNTRCT_DE = #CNTRCT_DE#												/*계약일자*/
					,LWST_PROGRS_AT = #LWST_PROGRS_AT#										/*소송진행여부*/
					,INCOME_EXCESS = #INCOME_EXCESS#										/*소득초과여부*/
					,RM = #RM#																/*비고*/
					,MANAGECT_PRECDNT = #MANAGECT_PRECDNT#									/*선수금*/
					,NPYM_INTR_EXEMPT_AT = #NPYM_INTR_EXEMPT_AT#							/*체납이자면제여부*/
					,MANAGECT_RDCXPT_AT = #MANAGECT_RDCXPT_AT#								/*관리비감면여부*/
					,TROBL_AT = #TROBL_AT#													/*장애여부*/
					,DEATH_AT = #DEATH_AT#													/*사망여부*/
					,UPDUSR_ID				=	#S_USER_ID#									/*수정자ID*/
					,UPDT_DT				=	SYSDATE										/*수정일시*/
		WHERE	CNTRCTR_NO =	#CNTRCTR_NO#
		AND 		RENT_HOUSE_CODE = #RENT_HOUSE_CODE#
		AND		DONG	=	#DONG#
		AND 		HO = #HO#
	</update>



	<!-- 쿼리명 : 매입임대 고객정보 상세사항 수정
			설명 : 매입임대 고객정보 상세사항 수정 쿼리
		  수정일 : 수정자  수정내용	
		  작성자 : 변승우
	 최초작성일 : 2015.11.05
	-->
	<update id="RNT02030100DAO.savePuchasCstmrtU" parameterClass="java.util.HashMap">
		UPDATE TBRNT_PUCHAS_RENT_CSTMR SET									/*매입고객 테이블*/
					TELNO	 =	#TELNO#													/*전화번호*/
					,MBTLNO	=	#MBTLNO#												/*휴대전화*/
		WHERE	PUCHAS_CSTMR_NO	=	#PUCHAS_CSTMR_NO#
	</update>
	

	<!-- 쿼리명 : 매입임대 임대료정보 조회
			 설명 : 매입임대 임대료정보 조회 쿼리
		  수정일 : 수정자  수정내용	
		  작성자 : 변승우
	 최초작성일 : 2015.11.02
	-->
	<select id="RNT02030100DAO.selectPuchasRentMtRntchrgList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
			SELECT   ROWNUM ,
					 '1' AS CHK,
			         A.CNTRCTR_NO ,
			         A.MDAT_YM,
			         A.MDAT_DE,
			         A.NHT_SN,
			         A.PAY_TMLMT                                                     AS PAY_TMLMT ,
			         NVL(A.RNTCHRG, 0)                                               AS RNTCHRG ,
			         NVL(A.OVDINTR, 0)                                               AS OVDINTR ,
			         NVL(A.RDCAMT_AMOUNT, 0)                                         AS RDCAMT_AMOUNT ,
			         NVL(A.RNTCHRG, 0) + NVL(A.RDCAMT_AMOUNT, 0) + NVL(A.OVDINTR, 0) AS TOT_AMOUNT ,
			         A.RCIV_DE,
			         NVL(A.RCIV_AMOUNT, 0) AS RCIV_AMOUNT,
			         A.CASH_RCIPT_RGSDE,
			         (SELECT USER_NM
			         FROM    TBCOM_USER
			         WHERE   USER_ID = A.REGISTER_ID
			         )
			         AS REGISTER_NM
			FROM TBRNT_PUCHAS_MT_RNTCHRG A
			WHERE A.CNTRCTR_NO = #CNTRCTR_NO#
				<isNull property="gubun">
				AND A.RCIV_DE IS NULL
				</isNull>
				<isEqual property="gubun" compareValue="1">
				AND		 SUBSTR(A.PAY_TMLMT, 1, 6) BETWEEN #stTrDe# AND #edTrDe#
				AND      A.RCIV_DE IS NOT NULL
				</isEqual>
				<isEqual property="gubun" compareValue="2">
				AND		 A.PAY_TMLMT BETWEEN #stTrDe# AND #edTrDe#
				AND      A.RCIV_DE IS NOT NULL
				</isEqual>
				AND nvl(A.RNTCHRG, 0) + nvl(A.RDCAMT_AMOUNT, 0) + nvl(A.OVDINTR, 0) > 0
			ORDER BY A.PAY_TMLMT DESC
	</select>		



	<!-- 쿼리명 : 매입임대 채납정보 조회
			 설명 : 매입임대 채납정보 조회 쿼리
		  수정일 : 수정자  수정내용	
		  작성자 : 변승우
	 최초작성일 : 2015.11.02
	-->
	<select id="RNT02030100DAO.selectPuchasNpymList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
					NPYM_AMOUNT																		/*고지금액*/
					,OVDINTR																				/*연체이자*/
					,PAY_TMLMT																			/*납부기한*/
					,NPYM_AMOUNT + OVDINTR AS TOTAL_AMOUNT						/*합계*/
		FROM	TBRNT_PUCHAS_NPYM
		WHERE	CNTRCTR_NO	=	#CNTRCTR_NO#
	</select>		
	
	
	
	<!-- 쿼리명 : 매입임대 압류정보 조회
			 설명 : 매입임대 임대료정보 조회 쿼리
		  수정일 : 수정자  수정내용	
		  작성자 : 변승우
	 최초작성일 : 2015.11.03
	-->
	<select id="RNT02030100DAO.selectPuchasRentGtnSeizrList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
					A.SEIZR_SE																	/*압류구분*/
					,A.CDIT_AMOUNT															/*채권금액*/
					,A.DECSN_RCEPT_DE														/*결정접수일*/
					,A.CDIT_DECSN_DE															/*채권결정일*/
					,A.RELIS_RCEPT_DE															/*해제접수일*/
					,A.RELIS_DE																	/*해제일*/
					,A.CDIT_SE																	/*채권구분*/
					,A.CRDTR_NM																/*채권자*/
					,C.NM																			/*계약자*/
					,SFCOM_DEC_ALL(C.IHIDNUM) AS IHIDNUM											/*주민번호*/
					,A.CNTRCTR_NO
					,A.SN
					,A.CRDTR_TELNO_1
					,A.CRDTR_TELNO_2
					,A.CRDTR_ADRES
					,A.CDIT_CN
					,A.RM
					,A.FILE_SN
		FROM		TBRNT_PUCHAS_SEIZR A
					,TBRNT_PUCHAS_CNTRCT B
					,TBRNT_PUCHAS_RENT_CSTMR C
		WHERE	A.CNTRCTR_NO			=	#CNTRCTR_NO#
		AND	A.CNTRCTR_NO				=	B.CNTRCTR_NO
		AND	B.PUCHAS_CSTMR_NO	=	C.PUCHAS_CSTMR_NO
		ORDER BY A.DECSN_RCEPT_DE DESC
	</select>
	
	
	
	<!-- 쿼리명 : 매입임대 명의정보 조회
			 설명 : 매입임대 명의정보 조회 쿼리
		  수정일 : 수정자  수정내용	
		  작성자 : 변승우
	 최초작성일 : 2015.11.03
	-->
	<select id="RNT02030100DAO.selectPuchasRentNmchangeList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
					A.NM	AS	BF_NM									/*계약자(전)*/
					,B.NM	AS	AF_NM									/*계약자(후)*/
					,SFCOM_DEC_ALL(A.IHIDNUM)	AS	BF_IHIDNUM					/*주민번호(전)*/
					,SFCOM_DEC_ALL(B.IHIDNUM)	AS	AF_IHIDNUM					/*주민번호(후)*/
					,A.MBTLNO	AS	BF_MBTLNO						/*연락처(전)*/
					,B.MBTLNO	AS	AF_MBTLNO						/*연락처(후)*/
					,C.CHGHY											/*변경사유*/
					,C.CHANGE_DE										/*변경일자*/
					,C.CNTRCTR_RELATE								/*관계*/
		FROM		TBRNT_PUCHAS_RENT_CSTMR A
					,TBRNT_PUCHAS_RENT_CSTMR B
					,TBRNT_PUCHAS_NM_CHANGE C
		WHERE	C.CNTRCTR_NO				=	#CNTRCTR_NO#
		AND		A.PUCHAS_CSTMR_NO	=	C.PUCHAS_CSTMR_NO_BFCHG
		AND		B.PUCHAS_CSTMR_NO	=	C.PUCHAS_CSTMR_NO_AFTCH	
	</select>



	<!-- 쿼리명 : 매입임대 자격정보 조회
			 설명 : 매입임대 자격정보 조회 쿼리
		  수정일 : 수정자  수정내용	
		  작성자 : 변승우
	 최초작성일 : 2015.11.03
	-->
	<select id="RNT02030100DAO.selectPuchasRentQualfChangeList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
					CHANGE_DE								/*변경일자*/
					,QUALF_SE_BFCHG							/*자격(전)*/
					,QUALF_SE_AFTCH							/*자격(후)*/
					,GTN_BFCHG								/*보증금(전)*/
					,GTN_AFTCH								/*보증금(후)*/
					,RNTCHRG_BFCHG							/*임대료(전)*/
					,RNTCHRG_AFTCH							/*임대료(후)*/
					,CNTRCT_CHANGE_SE						/*변경구분*/
					,GTN_DFNNT								/*차액*/
					,CHGHY									/*변경사유*/
					,PYMNT_DE								/*지급일자*/
					,ACNUTNO								/*계좌번호*/
					,(GTN_BFCHG - GTN_AFTCH)  AS GTN_BILL
		FROM		TBRNT_PUCHAS_QUALF_CHANGE
		WHERE	CNTRCTR_NO	=	#CNTRCTR_NO#
	</select>



	<!-- 쿼리명 : 매입임대 해약정보 조회
			 설명 : 매입임대 해약정보 조회 쿼리
		  수정일 : 수정자  수정내용	
		  작성자 : 변승우
	 최초작성일 : 2015.11.03
	-->
	<select id="RNT02030100DAO.selectPuchasRentResciList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT 
		     A.CNTRCTR_NO        					/*계약자번호*/  
		    ,A.RCEPT_DE            					/*접수일자*/
		    ,A.BANK_CODE           					/*은행코드*/
			,SFCMP_GET_CODENM('COM021', A.BANK_CODE) AS BANK_NM		/*은행명*/
		    ,A.ACNUTNO             					/*계좌번호*/
		    ,A.DPSTR               					/*예금주*/
		    ,A.CANCL_DE            					/*해약일자*/
		    ,A.RESCI_RESN_CODE     					/*해약사유코드*/
		    ,A.INNER_FCLTY_CNFIRM  					/*내부시설확인*/
		    ,A.LVHS_DE             					/*퇴거일자*/
		    ,A.ADRES               					/*주소*/
		    ,A.TELNO               					/*전화번호*/
		    ,A.GTN_EXCCLC_DE       					/*보증금정산일자*/
		    ,A.RESCI_RESN          					/*해약사유*/
		    ,A.RESCI_APPLCNT_RELATE					/*해약신청자_관계*/
		    ,SFCMP_GET_CODENM('RNT005', RESCI_RESN_CODE)  AS RESCI_RESN_CODE_NM
		    ,B.RENT_HOUSE_CODE						/*주택코드*/
		    ,(SELECT RENT_HOUSE_NM FROM TBRNT_RENT_HOUSE WHERE RENT_HOUSE_CODE = B.RENT_HOUSE_CODE) AS RENT_HOUSE_NM
		    ,B.DONG									/*동*/
		    ,B.HO									/*호*/
		    ,C.NM									/*신청자이름*/
		    ,SFCOM_DEC_ALL(C.IHIDNUM) AS IHIDNUM	/*신청자주민번호*/
		    ,A.FILE_SN								/*파일일련번호*/
		    ,NVL(A.DDCAMOUNT, 0) AS DDCAMOUNT		/*공제금액*/
		    ,NVL(A.REFND_AMOUNT, 0) AS REFND_AMOUNT	/*환불금액*/
		    ,A.GTN_DFNNT							/*보증금차액*/
		    ,A.RESCI_APPLCNT						/*해약신청자*/
		    ,LH_LFSTS_RENT							/*LH전세임대*/
		    ,ELCTRN_SANCTN_NO						/*전자결재번호*/
		    ,DECSN_YEAR								/*지출년도*/
		    ,EXPNDTR_DECSN_NO						/*지출결의번호*/
		    ,DFNNT_PYMNT_DE							/*차액지급일자*/
		FROM 
			TBRNT_PUCHAS_RESCI A
			,TBRNT_PUCHAS_CNTRCT B
			,TBRNT_PUCHAS_RENT_CSTMR C
		WHERE A.CNTRCTR_NO = #CNTRCTR_NO#
		AND   A.CNTRCTR_NO = B.CNTRCTR_NO
		AND  NVL(A.RESCI_APPLCNT, B.PUCHAS_CSTMR_NO) = C.PUCHAS_CSTMR_NO
	</select>



	<!-- 쿼리명 : 매입임대 보증금정보 조회
			 설명 : 매입임대 보증금정보 조회 쿼리
		  수정일 : 수정자  수정내용	
		  작성자 : 변승우
	 최초작성일 : 2015.11.03
	-->
	<select id="RNT02030100DAO.selectPuchasRentGtnList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
					CNTRCT_YEAR										/*계약년도*/
					,GTN_SN											/*보증금순번*/
					,GTN_SE											/*보증금구분*/
					,GTN											/*보증금*/
					,PAY_TMLMT										/*납부기한*/
					,RCIV_DE										/*수납일자*/
					,CASE
			              WHEN RCIV_DE IS NOT NULL
			              THEN NVL(GTN,0)
			              ELSE 0
				     END  AS RCIV_AMT /*수납금액*/
		FROM TBRNT_PUCHAS_GTN
		WHERE	CNTRCTR_NO	=	#CNTRCTR_NO#
		AND GTN_SE IN (
			SELECT   CODE
			FROM     TBCOM_CMMN_CODE
			WHERE    GRP_CODE              = 'RNT009'
			AND      USE_AT                = '1'
			AND      CHRCTR_PREPAR_VALUE_0 = 'S')
		AND CNTRCT_YEAR =
	        (SELECT MAX(CNTRCT_YEAR)
	         FROM    TBRNT_PUCHAS_GTN
	         WHERE   CNTRCTR_NO = #CNTRCTR_NO#
	         AND     GTN_SE IN
	                 ( SELECT CODE
	                 FROM    TBCOM_CMMN_CODE
	                 WHERE   GRP_CODE              = 'RNT009'
	                 AND     USE_AT                = '1'
	                 AND     CHRCTR_PREPAR_VALUE_0 = 'S'
	                 )
	        )
		ORDER BY PAY_TMLMT DESC
	</select>



	<!-- 쿼리명 : 매입임대 자동이체정보 조회
			 설명 : 매입임대 자동이체정보 조회 쿼리
		  수정일 : 수정자  수정내용	
		  작성자 : 변승우
	 최초작성일 : 2015.11.03
	-->
	<select id="RNT02030100DAO.selectAtcngList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT 
			DECODE(PAY_SE, '03', '임대료', '04', '관리비') AS GUBUN
		    ,CNTRCTR_NO			/*계약자번호*/
		    ,ATCNG_REQST_DE		/*자동이체신청일자*/
		    ,ACNUTNO			/*계좌번호*/
		    ,DPSTR				/*예금주*/
		    ,ATCNG_CANCL_DE		/*자동이체취소일자*/
		FROM TBPMS_ATCNG
		WHERE CNTRCTR_NO = #cntrctrNo#
		AND   PAY_SE IN ('03', '04')
		ORDER BY PAY_SE
	</select>



	<!-- 쿼리명 : 매입임대 관리비정보
	설명 : 매입임대 관리비정보 조회 쿼리
	수정일  수정자  수정내용
	
	작성자 : 변승우
	최초작성일 : 2015.11.03
	-->
	<select id="RNT02030100DAO.selectPuchasRentManageCostList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
					a.CNTRCTR_NO																					/*매입고객번호*/
					,OCCRRNC_YM																					/*발생년월*/
					,PAY_TMLMT																					/*납부기한*/
					,max(RCIV_DE) AS RCIV_DE																	/*수납일자*/
					,sum(nvl(a.TOTAL, 0)) - sum(nvl(a.MANAGECT, 0)) AS MINAB_AMT				/*미납금*/
					,trunc(sum(nvl(a.TOTAL, 0)), - 1) AS TOTAL_AMT										/*계*/
					,sum(PAY_AMT01) AS PAY_AMT01															/*수도료*/
					,sum(PAY_AMT02) AS PAY_AMT02															/*전기료*/
					,sum(PAY_AMT03) AS PAY_AMT03															/*유선TV*/
					,sum(PAY_AMT04) AS PAY_AMT04															/*정화조*/
					,sum(PAY_AMT05) AS PAY_AMT05															/*청소요금*/
					,sum(PAY_AMT06) AS PAY_AMT06															/*감액금액*/
					,sum(PAY_ETC) AS PAY_ETC																	/*기타금액*/
					,sum(RDCAMT_AMOUNT) AS RDCAMT_AMOUNT
					,trunc(sum(MANAGECT), - 1) AS MANAGECT
					,sum(nvl(a.TOTAL, 0)) - trunc(sum(nvl(a.TOTAL, 0)), - 1) AS TRUNC_AMT		/*절사액*/
		FROM (SELECT
							CNTRCTR_NO
							,PAY_TMLMT
							,OCCRRNC_YM
							,RCIV_DE
							,(
								CASE 
									WHEN MANAGECT_CODE = '06'
										THEN NVL(MANAGECT, 0) + NVL(OVDINTR, 0) + nvl(RDCAMT_AMOUNT, 0)
									ELSE 0
									END
								) AS pay_amt01
							,(
								CASE 
									WHEN MANAGECT_CODE = '05'
										THEN NVL(MANAGECT, 0) + NVL(OVDINTR, 0) + nvl(RDCAMT_AMOUNT, 0)
									ELSE 0
									END
								) AS pay_amt02
							,(
								CASE 
									WHEN MANAGECT_CODE = '07'
										THEN NVL(MANAGECT, 0) + NVL(OVDINTR, 0) + nvl(RDCAMT_AMOUNT, 0)
									ELSE 0
									END
								) AS pay_amt03
							,(
								CASE 
									WHEN MANAGECT_CODE = '10'
										THEN NVL(MANAGECT, 0) + NVL(OVDINTR, 0) + nvl(RDCAMT_AMOUNT, 0)
									ELSE 0
									END
								) AS pay_amt04
							,(
								CASE 
									WHEN MANAGECT_CODE = '02'
										THEN NVL(MANAGECT, 0) + NVL(OVDINTR, 0) + nvl(RDCAMT_AMOUNT, 0)
									ELSE 0
									END
								) AS pay_amt05
							,(
								CASE 
									WHEN MANAGECT_CODE = '04'
										THEN NVL(MANAGECT, 0) + NVL(OVDINTR, 0) + nvl(RDCAMT_AMOUNT, 0)
									ELSE 0
									END
								) AS pay_amt06
							,(
								CASE 
									WHEN MANAGECT_CODE NOT IN (
											'06'
											,'05'
											,'07'
											,'10'
											,'02'
											,'04'
											)
										THEN NVL(MANAGECT, 0) + NVL(OVDINTR, 0) + nvl(RDCAMT_AMOUNT, 0)
									ELSE 0
									END
								) AS PAY_ETC
							,nvl(RDCAMT_AMOUNT, 0) AS RDCAMT_AMOUNT
							,(
								CASE 
									WHEN RCIV_DE IS NOT NULL
										THEN NVL(MANAGECT, 0) + NVL(OVDINTR, 0) + nvl(RDCAMT_AMOUNT, 0)
									ELSE 0
									END
								) AS MANAGECT
							,NVL(MANAGECT, 0) + NVL(OVDINTR, 0) + nvl(RDCAMT_AMOUNT, 0) AS TOTAL
				FROM TBRNT_MT_MANAGECT 
				WHERE CNTRCTR_NO = #CNTRCTR_NO#
				) a
		<isNull property="gubun">
		WHERE  	 a.RCIV_DE IS NULL
		</isNull>
		<isEqual property="gubun" compareValue="1">
		WHERE	 SUBSTR(a.PAY_TMLMT, 1, 6) BETWEEN #stTrDe# AND #edTrDe#
		AND		 A.RCIV_DE IS NOT NULL
		</isEqual>
		<isEqual property="gubun" compareValue="2">
		WHERE	 a.PAY_TMLMT BETWEEN #stTrDe# AND #edTrDe#
		AND		 A.RCIV_DE IS NOT NULL
		</isEqual>
		GROUP BY a.CNTRCTR_NO, PAY_TMLMT, OCCRRNC_YM
		ORDER BY OCCRRNC_YM DESC
	</select>



	<!-- 쿼리명 : 매입임대 소유물건정보 조회
			 설명 : 매입임대 소유물건정보 조회 쿼리
		  수정일 : 수정자  수정내용	
		  작성자 : 변승우
	 최초작성일 : 2015.11.03
	-->
	<select id="RNT02030100DAO.selectPuchasRentPosesnThingList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT 
					A.INQIRE_DE										/*조회일자*/
					,B.NM													/*소유자*/
					,SFCOM_DEC_ALL(B.IHIDNUM) AS IHIDNUM					/*주민번호*/
					,A.FAMILY_RELATE									/*관계*/
					,A.ACQS_DE											/*취득일자*/
					,A.TRNSFR_DE										/*양도일자*/
					,A.EXPLN_SE											/*소명여부*/
					,A.PRESENTN_DE									/*소명일자*/
					,A.AR													/*면적*/
					,A.PRPOS												/*용도*/
					,B.ADRES												/*주소*/
		FROM		TBRNT_PUCHAS_POSESN_THING A
					,TBRNT_PUCHAS_RENT_CSTMR B
		WHERE	A.PUCHAS_CSTMR_NO	=	#PUCHAS_CSTMR_NO#
		AND		A.PUCHAS_CSTMR_NO	=	B.PUCHAS_CSTMR_NO
		ORDER BY A.INQIRE_DE DESC
	</select>	



	<!-- 쿼리명 : 매입임대 소송정보 조회
			 설명 : 매입임대 소송정보 조회 쿼리
		  수정일 : 수정자  수정내용	
		  작성자 : 변승우
	 최초작성일 : 2015.11.05
	-->
	<select id="RNT02030100DAO.selectPuchasRentLwstList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
					CNTRCTR_NO																						/*계약자번호*/
					,SN																									/*일련번호*/
					,LWST_DE																							/*소송일자*/
					,SEIZR_INCDNT_NO																				/*사건번호*/
					,JUDMN_DE																							/*판결일자*/
					,LWST_AMOUNT																					/*소송금액*/
					,RCIV_DE																								/*수납일자*/
					,RCIV_AMOUNT																						/*수납금액*/
					,RM																									/*비고*/
					,WTHDRW_DE																						/*취하일자*/
					,WTHDRW_PRVONSH																				/*취하사유*/
					,NVL(LWST_AMOUNT,0)	-	NVL(RCIV_AMOUNT,0) AS MINAB_AMOUNT			/*미납금액*/
		FROM		TBRNT_PUCHAS_LWST
		WHERE	CNTRCTR_NO	=	#CNTRCTR_NO#
		ORDER BY LWST_DE DESC
	</select>	



	<!-- 쿼리명 : 매입임대 소송정보 입력
			 설명 : 매입임대 소송정보 입력 쿼리
		  수정일 : 수정자  수정내용	
		  작성자 : 변승우
	 최초작성일 : 2015.11.05
	-->
	<insert id="RNT02030100DAO.savePuchasRentLwstC" parameterClass="java.util.HashMap">
		INSERT INTO TBRNT_PUCHAS_LWST(
					CNTRCTR_NO																	/*계약자번호*/
					,SN																				/*일련번호*/
					,LWST_DE																		/*소송일자*/
					,SEIZR_INCDNT_NO															/*사건번호*/
					,JUDMN_DE																		/*판결일자*/
					,LWST_AMOUNT																/*소송금액*/
					,RCIV_DE																			/*수납일자*/
					,RCIV_AMOUNT																	/*수납금액*/
					,RM																				/*비고*/
					,WTHDRW_DE																	/*취하일자*/
					,WTHDRW_PRVONSH															/*취하사유*/
					,REGISTER_ID																	/*등록자ID*/
					,REGIST_DT																		/*등록일시*/
					,UPDUSR_ID																		/*수정자ID*/
					,UPDT_DT																		/*수정일시*/
					)
		VALUES(
					#CNTRCTR_NO#																/*계약자번호*/   
					,(SELECT
								NVL(MAX(SN),0)+1
					  FROM	TBRNT_PUCHAS_LWST)											/*일련번호*/
					,#LWST_DE#																		/*소송일자*/
					,#SEIZR_INCDNT_NO#														/*사건번호*/
					,#JUDMN_DE#																	/*판결일자*/
					,#LWST_AMOUNT#															/*소송금액*/
					,#RCIV_DE#																		/*수납일자*/
					,#RCIV_AMOUNT#																/*수납금액*/
					,#RM#																			/*비고*/
					,#WTHDRW_DE#																/*취하일자*/
					,#WTHDRW_PRVONSH#														/*취하사유*/
					,#S_USER_ID#																	/*등록자ID*/
					,SYSDATE																		/*등록일시*/
					,#S_USER_ID#																	/*수정자ID*/
					,SYSDATE																		/*수정일시*/
					)
	</insert>



	<!-- 쿼리명 : 매입임대 소송정보 수정
			 설명 : 매입임대 소송정보 수정 쿼리
		  수정일 : 수정자  수정내용	
		  작성자 : 변승우
	 최초작성일 : 2015.11.05
	-->
	<update id="RNT02030100DAO.savePuchasRentLwstU" parameterClass="java.util.HashMap">
		UPDATE TBRNT_PUCHAS_LWST SET													/*매입소송 테이블*/
					LWST_DE					=	#LWST_DE#										/*소송일자*/
					,SEIZR_INCDNT_NO	=	#SEIZR_INCDNT_NO#							/*사건번호*/
					,JUDMN_DE				=	#JUDMN_DE#									/*판결일자*/
					,LWST_AMOUNT		=	#LWST_AMOUNT#								/*소송금액*/
					,RCIV_DE					=	#RCIV_DE#										/*수납일자*/
					,RCIV_AMOUNT			=	#RCIV_AMOUNT#								/*수납금액*/
					,RM						=	#RM#												/*비고*/
					,WTHDRW_DE			=	#WTHDRW_DE#								/*취하일자*/
					,WTHDRW_PRVONSH	=	#WTHDRW_PRVONSH#						/*취하사유*/
					,UPDUSR_ID				=	#S_USER_ID#									/*수정자ID*/
					,UPDT_DT				=	SYSDATE											/*수정일시*/
		WHERE	CNTRCTR_NO			=	#CNTRCTR_NO#
		AND		SN	=	#SN#
	</update>



	<!-- 쿼리명 : 매입임대 소송정보 삭제
			 설명 : 매입임대 소송정보 삭제 쿼리
		  수정일 : 수정자  수정내용	
		  작성자 : 변승우
	 최초작성일 : 2015.11.05
	-->
	<delete id="RNT02030100DAO.savePuchasRentLwstD" parameterClass="java.util.HashMap">
		DELETE
		FROM		TBRNT_PUCHAS_LWST
		WHERE	CNTRCTR_NO	=	#CNTRCTR_NO#
		AND		SN					=	#SN#
	</delete>



	<!-- 쿼리명 : 매입임대 재계약정보 조회
			 설명 : 매입임대 재계약정보 조회 쿼리
		  수정일 : 수정자  수정내용	
		  작성자 : 변승우
	 최초작성일 : 2015.11.05
	-->
	<select id="RNT02030100DAO.selectPuchasRentReCntrctList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
			SELECT '1' AS Save_YN
				,a.CNTRCTR_NO
				,r.RENT_HOUSE_CODE
				,r.DONG
				,r.HO
				,d.ROOM_STRUCTURE
				,CASE 
					WHEN h.HOUSE_SE = 'R2'
						THEN TO_NUMBER(d.FLOOR)
					ELSE 0
					END AS FLOOR
				,(
					SELECT HOUSE_POSESN_AT
					FROM TBRNT_PUCHAS_CNTRCT b
					WHERE a.CNTRCTR_NO = b.CNTRCTR_NO
					) AS HOUSE_POSESN_AT
				,m.NM
				,SFCOM_DEC_ALL(m.IHIDNUM) AS IHIDNUM
				,a.CNTRCT_DE
				,
				<!-- 이전계약정보 -->
				a.RENT_ENDDE_BFCHG AS RENT_ENDDE_BFCHG
				,a.RENT_BGNDE_BFCHG AS RENT_BGNDE_BFCHG
				,a.CNTRCT_DE_BFCHG AS CNTRCT_DE_BFCHG
				,a.QUALF_SE_BFCHG AS QUALF_SE_BFCHG
				,(
					SELECT CODE_NM
					FROM TBCOM_CMMN_CODE
					WHERE GRP_CODE = 'RNT001'
						AND CODE = a.QUALF_SE_BFCHG
					) AS QUALF_SE_BFCHG_NM
				,a.GTN_BFCHG AS GTN_BFCHG
				,a.RNTCHRG_BFCHG AS RNTCHRG_BFCHG
				,
				<!-- 1년차 계약정보 -->
				a.QUALF_SE
				,(
					SELECT CODE_NM
					FROM TBCOM_CMMN_CODE
					WHERE GRP_CODE = 'RNT001'
						AND CODE = a.QUALF_SE
					) AS QUALF_SE_NM 
				,a.RENT_BGNDE
				,a.RENT_ENDDE
				/*,a.CNTRCT_AMOUNT_1*/
				/*,a.SURLUS_1*/
				,a.GTN
				,a.RNTCHRG
				,a.PAY_TMLMT
				,0 AS RCIV_AMOUNT
				/*,a.RCIV_DE*/
				/*,a.APPLC_DE*/
				,a.GDCC_SNDNG_DE
				,a.REGISTER_ID
				,a.REGIST_DT
				,a.UPDUSR_ID
				,a.UPDT_DT
				/*,((a.CNTRCT_AMOUNT_1 + a.SURLUS_1) - a.GTN_BFCHG) AS INC_SEC_AMT1*/
				/*,((a.CNTRCT_AMOUNT_2 + a.SURLUS_2) - (a.CNTRCT_AMOUNT_1 + a.SURLUS_1)) AS INC_SEC_AMT2*/
				,c.SEIZR_CHECK
				,c.SEIZR_CNT
				/*,(a.CNTRCT_AMOUNT_1 + a.SURLUS_1) AS SEC_AMT*/
				/*,(a.CNTRCT_AMOUNT_2 + a.SURLUS_2) AS AF_SEC_AMT*/
				,(
					SELECT RENT_HOUSE_NM
					FROM TBRNT_PUCHAS_HOUSE h
					WHERE h.RENT_HOUSE_CODE = r.RENT_HOUSE_CODE
					) AS RENT_HOUSE_NM
				,substr(replace(g.ZIP, '-', ''), 1, 3) || '-' || substr(replace(g.ZIP, '-', ''), 4, 3) AS ZIP
				,g.ADRES || ' ' || g.ADRES_DETAIL AS ADRES
				,g.ADRES || ' ' || g.ADRES_DETAIL AS HOUSE_ADRES
				,nvl(d.DVR_AR, 0) AS DVR_AR
				,nvl(d.CMNUSE_AR, 0) AS CMNUSE_AR
				,nvl(d.DVR_AR, 0) + nvl(d.CMNUSE_AR, 0) AS TOTAL_AR
		    	,nvl(f.DEL_AMT, 0) AS DEL_AMT
				,h.HOUSE_SE
         		,CASE 
					WHEN A.CNTRCT_DE IS NULL
						THEN CASE 
								WHEN TO_CHAR(SYSDATE, 'YYYYMMDD') <![CDATA[<=]]> A.RENT_ENDDE THEN '계약가능'
								ELSE '계약불가'
								END
					ELSE '계약완료'
					END AS CNTRCTR_NO_YN
				, A.UPDUSR_ID
		        , (SELECT USER_NM FROM TBCOM_USER WHERE USER_ID = A.UPDUSR_ID) AS UPDUSR_NM
		        , A.UPDT_DT
		        , A.FILE_SN
			FROM TBRNT_PUCHAS_RE_CNTRCT a
				,TBRNT_PUCHAS_HOUSE_BILD d
				,VIRNT_DELAY_INFO f
				,TBRNT_PUCHAS_HOUSE_DONG g
		    ,TBRNT_PUCHAS_CNTRCT r
		    ,TBRNT_PUCHAS_RENT_CSTMR m
				,(
					SELECT CNTRCTR_NO
						,CASE 
							WHEN sum(cnt1) > 0
								THEN '압류(' || sum(cnt1) || ')'
							END || CASE 
							WHEN sum(cnt2) > 0
								THEN '가압류(' || sum(cnt2) || ')'
							END || CASE 
							WHEN sum(cnt3) > 0
								THEN '기타압류(' || sum(cnt3) || ')'
							END AS SEIZR_CHECK
						,sum(cnt1) AS SEIZR_CNT
					FROM (
						SELECT CNTRCTR_NO
							,CASE 
								WHEN SEIZR_SE IN (
										'00'
										,'02'
										,'03'
										)
									THEN 1
								ELSE 0
								END AS cnt1
							,CASE 
								WHEN SEIZR_SE IN ('01')
									THEN 1
								ELSE 0
								END AS cnt2
							,CASE 
								WHEN nvl(SEIZR_SE, '99') NOT IN (
										'00'
										,'01'
										,'02'
										,'03'
										)
									THEN 1
								ELSE 0
								END AS cnt3
						FROM TBRNT_PUCHAS_SEIZR
						WHERE (
								RELIS_DE IS NULL
								OR RELIS_DE = ''
								)
						)
					GROUP BY CNTRCTR_NO
					) c
				,TBRNT_PUCHAS_HOUSE h
			WHERE a.CNTRCTR_NO = #CNTRCTR_NO#
		    AND a.CNTRCTR_NO = r.CNTRCTR_NO
		    AND r.PUCHAS_CSTMR_NO = m.PUCHAS_CSTMR_NO
				AND r.RENT_HOUSE_CODE = d.RENT_HOUSE_CODE(+)
				AND r.DONG = d.DONG(+)
				AND r.HO = d.HO(+)
				AND a.CNTRCTR_NO = f.CNTRCTR_NO(+)
				AND a.CNTRCTR_NO = c.CNTRCTR_NO(+)
				AND r.RENT_HOUSE_CODE = g.RENT_HOUSE_CODE(+)
				AND r.DONG = g.DONG(+)
				AND a.CNTRCTR_NO = r.CNTRCTR_NO
				AND r.RENT_HOUSE_CODE = h.RENT_HOUSE_CODE
				<isEqual property="cancl" compareValue="1" >				
		    	AND a.CNTRCT_DE IS NOT NULL
		    	</isEqual>
		    	<isEqual property="cancl" compareValue="0" >
		    	AND a.CNTRCT_DE IS NULL
		    	</isEqual>
			ORDER BY a.RENT_ENDDE_BFCHG DESC 
	</select>
	
	<update id="RNT02030100DAO.puchasReCntrctU" parameterClass="java.util.HashMap">
	UPDATE TBRNT_PUCHAS_RE_CNTRCT
	SET    CNTRCT_DE		= #CNTRCT_DE# ,
		   <isNotEmpty property="RNTCHRG">
		   RNTCHRG          = #RNTCHRG# ,
		   </isNotEmpty>
		   <isNotEmpty property="GTN">
		   GTN				= #GTN#,
		   </isNotEmpty>
		   <isNotEmpty property="QUALF_SE">
	       QUALF_SE         = #QUALF_SE# ,
	       </isNotEmpty>
	       <isNotEmpty property="RENT_BGNDE">
	       RENT_BGNDE		= #RENT_BGNDE#,
	       </isNotEmpty>
	       <isNotEmpty property="RENT_ENDDE">
	       RENT_ENDDE		= #RENT_ENDDE#,
	       </isNotEmpty>
	       <isNotEmpty property="FILE_SN">
	       FILE_SN			= #FILE_SN#,
	       </isNotEmpty>
	       UPDUSR_ID		= #S_USER_ID#,  
		   UPDT_DT			= SYSDATE
	WHERE  CNTRCTR_NO       = #CNTRCTR_NO#
	AND    RENT_ENDDE_BFCHG = #RENT_ENDDE_BFCHG#
	</update>
	
	<update id="RNT02030100DAO.puchasCntrctDeU" parameterClass="java.util.HashMap">
	UPDATE TBRNT_PUCHAS_CNTRCT
	SET    CNTRCT_DE		= #CNTRCT_DE# ,
		   <isNotEmpty property="QUALF_SE">
	       QUALF_SE         = #QUALF_SE# ,
	       </isNotEmpty>
	       <isNotEmpty property="RENT_BGNDE">
	       RENT_BGNDE		= #RENT_BGNDE#,
	       </isNotEmpty>
		   <isNotEmpty property="RENT_ENDDE">
	       RENT_ENDDE		= #RENT_ENDDE#,
	       </isNotEmpty>
	       <isNotEmpty property="GTN">
	       GTN           = #GTN# ,
	       </isNotEmpty>
	       <isNotEmpty property="RNTCHRG">
	       RNTCHRG          = #RNTCHRG# ,
	       </isNotEmpty>
	       UPDUSR_ID		= #S_USER_ID#,  
		   UPDT_DT			= SYSDATE
	WHERE  CNTRCTR_NO       = #CNTRCTR_NO#
	</update>
	
	
	<!-- 쿼리명 : 매입임대 재계약 고지서 조회
			 설명 : 매입임대 재계약정보 조회 쿼리
		  수정일 : 수정자  수정내용	
		  작성자 : 변승우
	 최초작성일 : 2015.11.05
	-->
	<select id="RNT02030100DAO.selectReCntrctTax01" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
			SELECT 
			  a.CNTRCTR_NO
				,e.RENT_HOUSE_CODE
				,e.DONG
				,e.HO
				,b.RENT_HOUSE_NM
				,c.ADRES || c.ADRES_DETAIL AS ADRES1
				,c.ZiP
				,d.NM
				,b.RENT_HOUSE_NM || ' ' || e.DONG || '동 ' || e.HO || '호' AS ADDR
				,e.DONG || '동 ' || e.HO || '호' AS DONGHO
				,substr(a.PAY_TMLMT,1,4) AS YYYY_1
				,substr(a.PAY_TMLMT, 5,2) AS MM_1
				,substr(a.PAY_TMLMT,1,4) AS YYYY
				,substr(a.PAY_TMLMT, 5,2) AS MM
				,substr(a.PAY_TMLMT, 7,2) AS DD
			  ,a.PAY_TMLMT
				,0 AS RENT_AMT
				,0 AS DEL_AMT
				,0 AS DEL_INT
				,(a.CNTRCT_AMOUNT_1 + a.SURLUS_1) - a.GTN_BFCHG AS SEC_AMT
				,(a.CNTRCT_AMOUNT_1 + a.SURLUS_1) - a.GTN_BFCHG AS TOTAL_AMT
				,('5' || e.RENT_HOUSE_CODE || e.DONG || e.HO || a.PAY_TMLMT) || lpad((a.CNTRCT_AMOUNT_1 + a.SURLUS_1) - a.GTN_BFCHG, 10, '0') || substr(SFRNT_OCR_CODE_CHECK('5' || e.RENT_HOUSE_CODE || e.DONG || e.HO || a.PAY_TMLMT || lpad(nvl((a.CNTRCT_AMOUNT_1 + a.SURLUS_1) - a.GTN_BFCHG, 0), 10, '0')), 1, 50) || '500' AS OCRBand
			  ,e.RENT_HOUSE_CODE||'-'||e.DONG||'-'||e.HO AS AUTO_CODE
			FROM TBRNT_PUCHAS_RE_CNTRCT a
				,TBRNT_PUCHAS_HOUSE b
				,TBRNT_PUCHAS_HOUSE_DONG c
			  ,TBRNT_PUCHAS_RENT_CSTMR d
			  ,TBRNT_PUCHAS_CNTRCT e
			WHERE e.RENT_HOUSE_CODE = b.RENT_HOUSE_CODE
			  AND a.CNTRCTR_NO = e.CNTRCTR_NO
			  AND e.PUCHAS_CSTMR_NO = d.PUCHAS_CSTMR_NO
				AND e.RENT_HOUSE_CODE = c.RENT_HOUSE_CODE(+)
				AND e.DONG = c.DONG(+)
				AND a.RENT_ENDDE_BFCHG = #RENT_ENDDE_BFCHG#
				AND (a.CNTRCT_AMOUNT_1 + a.SURLUS_1) - a.GTN_BFCHG > 0
				AND a.CNTRCTR_NO = #CNTRCTR_NO#
	</select>
	
	
	
	<!-- 쿼리명 : 매입임대 재계약 고지서 조회
			 설명 : 매입임대 재계약정보 조회 쿼리
		  수정일 : 수정자  수정내용	
		  작성자 : 변승우
	 최초작성일 : 2015.11.05
	-->
	<select id="RNT02030100DAO.selectReCntrctTax02" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		  SELECT CNTRCTR_NO
			,max(decode(rownum, 1, decode(BANK_NM, '', '', BANK_NM || ' - '))) || max(decode(rownum, 1, VACCT_NO)) AS BANK1
			,max(decode(rownum, 2, decode(BANK_NM, '', '', BANK_NM || ' - '))) || max(decode(rownum, 2, VACCT_NO)) AS BANK2
			,max(decode(rownum, 3, decode(BANK_NM, '', '', BANK_NM || ' - '))) || max(decode(rownum, 3, VACCT_NO)) AS BANK3
			,max(decode(rownum, 4, decode(BANK_NM, '', '', BANK_NM || ' - '))) || max(decode(rownum, 4, VACCT_NO)) AS BANK4
			,max(decode(rownum, 5, decode(BANK_NM, '', '', BANK_NM || ' - '))) || max(decode(rownum, 5, VACCT_NO)) AS BANK5
			,max(decode(rownum, 6, decode(BANK_NM, '', '', BANK_NM || ' - '))) || max(decode(rownum, 6, VACCT_NO)) AS BANK6
		FROM (
			SELECT a.CUST_CD AS CNTRCTR_NO
				,a.BANK_CD
				,a.VACCT_NO
				,b.BANK_NM
			FROM VA_MAST a
				,(
					SELECT CODE AS BANK_CD
						,CODE_NM AS BANK_NM
					FROM TBCOM_CMMN_CODE
					WHERE GRP_CODE = 'COM021'
					) b
			WHERE a.CRT_DIV = 'RN'
				AND a.CUST_CD = #CNTRCTR_NO#
				AND a.BANK_CD= b.BANK_CD(+)
				AND nvl(a.OPT2, '0') LIKE '1'
			ORDER BY 2
			)
		GROUP BY CNTRCTR_NO
	</select>
	
	<!-- 매입임대고객 매입고객번호 조회 -->
	<select id="RNT02030100DAO.puchasRentCstmr" parameterClass="java.util.HashMap" resultClass="java.lang.String">
		SELECT PUCHAS_CSTMR_NO
		FROM   TBRNT_PUCHAS_RENT_CSTMR
		WHERE  NM      = #NM#
		AND    IHIDNUM = SFCOM_ENC_ALL(REPLACE(#IHIDNUM#, '-', ''))
	</select>
	
	<!-- 매입임대고객가족생성 -->
	<insert id="RNT02030100DAO.puchasRentCstmrC" parameterClass="java.util.HashMap">
		INSERT
		INTO   TBRNT_PUCHAS_RENT_CSTMR(
		              PUCHAS_CSTMR_NO,
		              NM,
		              IHIDNUM,
		              ZIP,
		              ADRES,
		              ADRES_DETAIL,
		              TELNO,
		              MBTLNO,
		              EMAIL,
		              REGISTER_ID,
		              REGIST_DT,
		              UPDUSR_ID,
		              UPDT_DT
		       )
		       VALUES(
		              SQ_TBRNT_PRMANENT_RENT_CSTMR_1.NEXTVAL,
		              #NM#,
		              SFCOM_ENC_ALL(REPLACE(#IHIDNUM#, '-', '')),
		              #ZIP#,
		              #ADRES#,
		              #ADRES_DETAIL#,
		              #TELNO#,
		              #MBTLNO#,
		              #EMAIL#,
		              #S_USER_ID#,
		              SYSDATE,
		              #S_USER_ID#,
		              SYSDATE
		       )
	</insert>
	
	<update id="RNT02030100DAO.puchasRentCstmrU" parameterClass="java.util.HashMap">
		UPDATE TBRNT_PUCHAS_RENT_CSTMR SET
			 NM = #NM#          
			,IHIDNUM = SFCOM_ENC_ALL(REPLACE(#IHIDNUM#, '-', ''))         
			,TELNO = #TELNO#
			,MBTLNO = #MBTLNO#
			,UPDUSR_ID = #S_USER_ID# 
			,UPDT_DT = SYSDATE
		WHERE PUCHAS_CSTMR_NO = #PUCHAS_CSTMR_NO#
	</update>
	
	<!-- 임대고객가족생성 -->
	<insert id="RNT02030100DAO.rentCstmrFamilyC" parameterClass="java.util.HashMap">
		INSERT INTO TBRNT_PUCHAS_FAMILY_MATTER(
		 	 SN               
			,PUCHAS_CSTMR_NO
			,AREA_CODE
			,RCEPT_DE
			,WAIT_RCEPT_SN
			,FAMILY_RELATE
			,RM
			,EXAMIN_ID
			,FAMILY_NO
			,PORTAL_REGIST_AT
			,CNTRCTR_NO
			,WAITR_CSTMR_NO
			,CNTRCTR_CSTMR_NO
			,REGISTER_ID
			,REGIST_DT  
			,UPDUSR_ID  
			,UPDT_DT
		)
		VALUES(
			 (SELECT NVL(MAX(SN),0) + 1 FROM TBRNT_PUCHAS_FAMILY_MATTER)      
			,#PUCHAS_CSTMR_NO#
			,#AREA_CODE#
			,#RCEPT_DE#
			,#WAIT_RCEPT_SN#
			,#FAMILY_RELATE#
			,#RM#
			,#EXAMIN_ID#
			,(SELECT NVL(MAX(FAMILY_NO),0) + 1 FROM TBRNT_PUCHAS_FAMILY_MATTER)
			,#PORTAL_REGIST_AT#
			,#CNTRCTR_NO#
			,#WAITR_CSTMR_NO#
			,#CNTRCTR_CSTMR_NO#
			,#S_USER_ID#
			,SYSDATE
			,#S_USER_ID#
			,SYSDATE
		)
	</insert>
	
	<insert id="RNT02030100DAO.atchCUD" parameterClass="java.util.Map">		
	 UPDATE TBRNT_PUCHAS_SEIZR
	    SET FILE_SN = #FILE_SN#
	  WHERE CNTRCTR_NO = #CNTRCTR_NO#
	  	AND SN = #GTN_SEIZR_SN#         	    	 	
	</insert>
	
	<update id="RNT02030100DAO.fileSnU" parameterClass="java.util.HashMap">
	 UPDATE TBRNT_PUCHAS_SEIZR
	    SET FILE_SN = NULL
	  WHERE CNTRCTR_NO = #CNTRCTR_NO#
	    AND SN = #SN#
	</update>
	
	<insert id="RNT02030100DAO.reCntrctAtchCUD" parameterClass="java.util.Map">		
	 UPDATE TBRNT_PUCHAS_RE_CNTRCT
	    SET FILE_SN = #FILE_SN#
	  WHERE CNTRCTR_NO = #CNTRCTR_NO#
	  	AND RENT_ENDDE_BFCHG = #RENT_ENDDE_BFCHG#         	    	 	
	</insert>
	
	<insert id="RNT02030100DAO.qualfChangeAtchCUD" parameterClass="java.util.Map">		
	 UPDATE TBRNT_PUCHAS_QUALF_CHANGE
	    SET FILE_SN = #FILE_SN#
	  WHERE CNTRCTR_NO = #CNTRCTR_NO#
	  	AND CHANGE_DE = #CHANGE_DE#
	  	AND CHANGE_NO = #CHANGE_NO#         	    	 	
	</insert>
	
	<insert id="RNT02030100DAO.nmChangeAtchCUD" parameterClass="java.util.Map">		
	 UPDATE TBRNT_PUCHAS_NM_CHANGE
	    SET FILE_SN = #FILE_SN#
	  WHERE CNTRCTR_NO = #CNTRCTR_NO#
	  	AND CHANGE_DE = #CHANGE_DE#
	  	AND CHANGE_NO = #CHANGE_NO#         	    	 	
	</insert>
	
	
	<insert id="RNT02030100DAO.houseChangeAtchCUD" parameterClass="java.util.Map">		
	 UPDATE TBRNT_PUCHAS_HOUSE_CHANGE
	    SET FILE_SN = #FILE_SN#
	  WHERE CNTRCTR_NO = #CNTRCTR_NO#
	  	AND CHANGE_DE = #CHANGE_DE#
	  	AND CHANGE_NO = #CHANGE_NO#         	    	 	
	</insert>
	
	<insert id="RNT02030100DAO.resciAtchCUD" parameterClass="java.util.Map">		
	 UPDATE TBRNT_PUCHAS_RESCI
	    SET FILE_SN = #FILE_SN#
	  WHERE CNTRCTR_NO = #CNTRCTR_NO#
	  	AND RCEPT_DE = #RCEPT_DE#       	    	 	
	</insert>
	
	<select id="RNT02030100DAO.selectNonPaymentList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
	SELECT 'RN'                    AS CHK ,
	       NVL(SUM(TOT_AMOUNT), 0) AS TOT_AMOUNT
	FROM   ( SELECT NVL(A.RNTCHRG, 0) + NVL(A.RDCAMT_AMOUNT, 0) + NVL(A.OVDINTR, 0) AS TOT_AMOUNT
	       FROM    TBRNT_PUCHAS_MT_RNTCHRG A
	       WHERE   A.CNTRCTR_NO                                                    = #CNTRCTR_NO#
	       AND     NVL(A.RNTCHRG, 0) + NVL(A.RDCAMT_AMOUNT, 0) + NVL(A.OVDINTR, 0) > 0
	       AND     A.RCIV_DE                                                 IS NULL
	       )
	       AA
	
	UNION ALL
	
	SELECT 'T2'                    AS CHK ,
	       NVL(SUM(TOT_AMOUNT), 0) AS TOT_AMOUNT
	FROM   ( SELECT NVL(B.LWST_AMOUNT, 0) AS TOT_AMOUNT
	       FROM    TBRNT_PUCHAS_LWST B
	       WHERE   B.CNTRCTR_NO          = #CNTRCTR_NO#
	       AND     NVL(B.LWST_AMOUNT, 0) > 0
	       AND     B.RCIV_DE       IS NULL
	       )
	       BB
	
	UNION ALL
	
	SELECT 'MA'                     AS CHK,
	       SUM(TOTAL_AMT) 			AS TOTAL_AMT
	FROM   ( SELECT  a.CNTRCTR_NO ,
	                TRUNC(SUM(NVL(a.TOTAL, 0)), - 1)                               AS TOTAL_AMT,
	                SUM(NVL(a.TOTAL, 0))        - TRUNC(SUM(NVL(a.TOTAL, 0)), - 1) AS TRUNC_AMT
	       FROM     (SELECT CNTRCTR_NO ,
	                        PAY_TMLMT ,
	                        OCCRRNC_YM ,
	                        RCIV_DE ,(
	                        CASE
	                                WHEN MANAGECT_CODE = '06'
	                                THEN NVL(MANAGECT, 0) + NVL(OVDINTR, 0) + NVL(RDCAMT_AMOUNT, 0)
	                                ELSE 0
	                        END ) AS pay_amt01 ,(
	                        CASE
	                                WHEN MANAGECT_CODE = '05'
	                                THEN NVL(MANAGECT, 0) + NVL(OVDINTR, 0) + NVL(RDCAMT_AMOUNT, 0)
	                                ELSE 0
	                        END ) AS pay_amt02 ,(
	                        CASE
	                                WHEN MANAGECT_CODE = '07'
	                                THEN NVL(MANAGECT, 0) + NVL(OVDINTR, 0) + NVL(RDCAMT_AMOUNT, 0)
	                                ELSE 0
	                        END ) AS pay_amt03 ,(
	                        CASE
	                                WHEN MANAGECT_CODE = '10'
	                                THEN NVL(MANAGECT, 0) + NVL(OVDINTR, 0) + NVL(RDCAMT_AMOUNT, 0)
	                                ELSE 0
	                        END ) AS pay_amt04 ,(
	                        CASE
	                                WHEN MANAGECT_CODE = '02'
	                                THEN NVL(MANAGECT, 0) + NVL(OVDINTR, 0) + NVL(RDCAMT_AMOUNT, 0)
	                                ELSE 0
	                        END ) AS pay_amt05 ,(
	                        CASE
	                                WHEN MANAGECT_CODE = '04'
	                                THEN NVL(MANAGECT, 0) + NVL(OVDINTR, 0) + NVL(RDCAMT_AMOUNT, 0)
	                                ELSE 0
	                        END ) AS pay_amt06 ,(
	                        CASE
	                                WHEN MANAGECT_CODE NOT IN ( '06' ,
	                                                           '05' ,
	                                                           '07' ,
	                                                           '10' ,
	                                                           '02' ,
	                                                           '04' )
	                                THEN NVL(MANAGECT, 0) + NVL(OVDINTR, 0) + NVL(RDCAMT_AMOUNT, 0)
	                                ELSE 0
	                        END )                 AS PAY_ETC ,
	                        NVL(RDCAMT_AMOUNT, 0) AS RDCAMT_AMOUNT ,(
	                        CASE
	                                WHEN RCIV_DE IS NOT NULL
	                                THEN NVL(MANAGECT, 0) + NVL(OVDINTR, 0) + NVL(RDCAMT_AMOUNT, 0)
	                                ELSE 0
	                        END )                                                      AS MANAGECT ,
	                        NVL(MANAGECT, 0) + NVL(OVDINTR, 0) + NVL(RDCAMT_AMOUNT, 0) AS TOTAL
	                FROM    TBRNT_MT_MANAGECT
	                WHERE   CNTRCTR_NO = #CNTRCTR_NO#
	                )
	                a
	       WHERE    a.RCIV_DE IS NULL
	       GROUP BY a.CNTRCTR_NO,
	                PAY_TMLMT,
	                OCCRRNC_YM
	       ORDER BY OCCRRNC_YM DESC
	       )
	
	UNION ALL
	
	SELECT 'PC'                     AS CHK,
	       NVL(MANAGECT_PRECDNT, 0) AS TOT_AMOUNT
	FROM   TBRNT_PUCHAS_CNTRCT
	WHERE  CNTRCTR_NO = #CNTRCTR_NO#
	</select>
	
	<select id="RNT02030100DAO.rentReCntrctR2" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT	CNTRCTR_NO
				,TO_CHAR(REGIST_DT, 'YYYYMMDD') AS CHANGE_DE
				,(GTN - GTN_BFCHG) AS GTN_DFNNT
		FROM	TBRNT_PUCHAS_RE_CNTRCT
		WHERE	CNTRCTR_NO = #CNTRCTR_NO#
		AND		RENT_ENDDE_BFCHG = #RENT_ENDDE_BFCHG# 
	</select>
	
	<select id="RNT02030100DAO.puchasRentCntrctCancelCheck" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT NVL(A.RNTCHRG, 0) + NVL(A.RDCAMT_AMOUNT, 0) + NVL(A.OVDINTR, 0) AS TOT_AMOUNT
		FROM   TBRNT_PUCHAS_MT_RNTCHRG A
		WHERE  A.CNTRCTR_NO        = #CNTRCTR_NO#
		AND    A.RCIV_DE IS NOT NULL
		
		UNION ALL
		
		SELECT NVL(B.LWST_AMOUNT, 0) AS TOT_AMOUNT
		FROM   TBRNT_PUCHAS_LWST B
		WHERE  B.CNTRCTR_NO        = #CNTRCTR_NO#
		AND    B.RCIV_DE IS NOT NULL
	</select>
	
	<!-- 보증금삭제 -->
	<delete id="RNT02030100DAO.rentGtnD" parameterClass="java.util.HashMap">
		DELETE
		FROM TBRNT_PUCHAS_GTN
		WHERE CNTRCTR_NO = #CNTRCTR_NO#
	</delete>
	
	<!-- 건축물정보 변경 -->
	<update id="RNT02030100DAO.rentHouseBildU" parameterClass="java.util.HashMap">
		UPDATE TBRNT_PUCHAS_HOUSE_BILD
		SET    CNTRCTR_NO      = '' ,
		       SUPLY_SE        = '1',
		       SUPLY_POSBL_DE  = TO_CHAR(SYSDATE, 'YYYYMMDD')
		WHERE  RENT_HOUSE_CODE = #RENT_HOUSE_CODE#
		AND    DONG            = #DONG#
		AND    HO              = #HO#
	</update>
	
	<!-- 가족정보 변경 -->
	<update id="RNT02030100DAO.rentFamilyMatterU" parameterClass="java.util.HashMap">
		UPDATE TBRNT_PUCHAS_FAMILY_MATTER
		SET    CNTRCTR_NO = ''
		WHERE  CNTRCTR_NO = #CNTRCTR_NO#
	</update>
	
	<!-- 소유물건정보 변경 -->
	<update id="RNT02030100DAO.rentPosesnThingU" parameterClass="java.util.HashMap">
		UPDATE TBRNT_PUCHAS_POSESN_THING
		SET    CNTRCTR_NO = ''
		WHERE  CNTRCTR_NO = #CNTRCTR_NO#
	</update>
	
	<!-- 입주대기자정보 변경 -->
	<update id="RNT02030100DAO.mvnWaitrU" parameterClass="java.util.HashMap">
		UPDATE TBRNT_PUCHAS_WAITR
		SET    CNTRCTR_NO = ''
		WHERE  CNTRCTR_NO = #CNTRCTR_NO#
	</update>
	
	<!-- 계약삭제 -->
	<delete id="RNT02030100DAO.rentCntrctD" parameterClass="java.util.HashMap">
		DELETE
		FROM TBRNT_PUCHAS_CNTRCT
		WHERE CNTRCTR_NO = #CNTRCTR_NO#
	</delete>
	
	<!-- 가상계좌정보 변경 -->
	<update id="RNT02030100DAO.vaMastU" parameterClass="java.util.HashMap">
		UPDATE va_mast
		SET    cust_cd = '' ,
		       cust_nm = '' ,
		       stat_cd = '0' ,
		       OPT1    = '0' ,
		       OPT2    = '0' ,
		       OPT3    = '0' ,
		       inp_dt  = '',
		       last_date = SYSDATE
		WHERE  cust_cd   = #CNTRCTR_NO#
		AND    crt_div IN('RN',
		                  'MA',
		                  'BS')
		AND    stat_cd = '1'
	</update>
	
</sqlMap>